/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall sub_140001000(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6);
__int64 __fastcall sub_140001230(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6);
__int64 sub_140001450();
__int64 sub_140001520();
__int64 __fastcall sub_1400015F0(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, int a6, _DWORD *a7);
__int64 sub_140001850();
__int64 __fastcall sub_1400018E0(__int16 *a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6);
__int64 __fastcall sub_140001C20(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6);
__int64 sub_140001DC0();
__int64 sub_140001E50();
__int64 __fastcall sub_140001F20(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, _DWORD *a6);
__int64 __fastcall sub_140002000(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, _DWORD *a6);
__int64 sub_1400020E0();
__int64 sub_1400021B0();
__int64 __fastcall sub_140002280(__int16 *a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6);
__int64 __fastcall sub_140002610(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6);
__int64 sub_1400027B0();
__int64 sub_140002840();
__int64 __fastcall sub_140002910(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6);
__int64 sub_140002AF0();
char __fastcall sub_140002BC0(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6);
__int64 sub_140002E80();
__int64 __fastcall sub_140002F34(void *a1);
int sub_1400039D0();
__int64 __fastcall sub_140003B78(__int16 a1);
__int64 __fastcall sub_140003BF4(__int16 *a1, __int64 a2, __int64 a3);
_DWORD *__fastcall sub_140003D3C(unsigned __int16 a1, _DWORD *a2, _DWORD *a3, _DWORD *a4, _DWORD *a5, _DWORD *a6);
__int64 __fastcall sub_140003E84(__int64 a1, _QWORD *a2);
__int64 __fastcall sub_140003FA4(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_140004340(_QWORD *a1, GUID *a2, void *a3, int *a4);
__int64 __fastcall sub_140004C3C(__int64 a1);
__int64 sub_140005060();
__int64 sub_14000513C();
__int64 __fastcall sub_1400051C4(PDRIVER_OBJECT DriverObject); // idb
int __fastcall sub_140005380(__int64 a1, __int64 a2, const NET_BUFFER_LIST *a3, __int64 a4, __int64 a5, _DWORD *a6);
__int64 sub_140005560();
void sub_1400055E4();
void __fastcall callback(void *context, FWPM_SERVICE_STATE newState);
__int64 __fastcall sub_1400059A0(__int64 a1, unsigned __int16 a2, __int64 a3);
__int64 __fastcall sub_1400059D0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_140005A0C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_140005B30(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_140005B78(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_140005BE0(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
bool sub_140005C1C();
__int64 __fastcall sub_140005CB8(unsigned __int8 a1);
__int64 sub_140005D9C();
bool sub_140005E68();
__int64 sub_140005E74();
__int64 sub_140005F34();
__int64 __fastcall sub_14000615C(int a1, void *a2, void *a3, unsigned int a4, ULONG Type, void *Src, ULONG MaxCount, void *a8, unsigned int DstSize, const wchar_t *SourceString);
__int64 __fastcall sub_140006514(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4);
__int64 __fastcall sub_140006580(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4, __int64 a5);
__int64 __fastcall sub_140006644(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4);
__int64 __fastcall sub_1400066C8(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, const wchar_t *a5);
__int64 __fastcall sub_140006754(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 sub_1400067C0();
__int64 __fastcall sub_140006898(__int64 a1, __int64 a2);
__int64 __fastcall sub_140006BF0(unsigned __int8 *a1, _QWORD *a2, _QWORD *a3);
__int64 __fastcall sub_140006E00(PLARGE_INTEGER Timeout); // idb
__int64 __fastcall sub_14000706C(__int64 a1);
__int64 __fastcall sub_14000722C(PDRIVER_OBJECT DriverObject); // idb
__int64 __fastcall sub_1400075C0(__int64 a1);
__int64 __fastcall sub_1400076A0(__int64 a1, __int64 a2);
__int64 __fastcall sub_140007780(unsigned int a1, __int64 a2, unsigned int a3);
__int64 __fastcall sub_140007930(unsigned __int8 a1);
void sub_1400079CC();
__int64 __fastcall sub_140007BB8(int a1);
__int64 __fastcall sub_140007C20(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 *a4);
__int64 __fastcall sub_140007C90(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_140007CF0(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_140007D44();
void __fastcall completionFn(void *context, NET_BUFFER_LIST *netBufferList, BOOLEAN dispatchLevel);
__int64 sub_140007FF0();
__int64 __fastcall sub_140008178(__int64 a1);
__int64 __fastcall sub_1400087A4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_14000884C(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_1400088A4(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_140008908(PDRIVER_OBJECT DriverObject); // idb
void sub_140008B40();
void *__fastcall sub_140008BF8(_QWORD *a1);
void __fastcall sub_140008CB0(__int64 a1, unsigned __int8 a2, __int64 *a3, __int64 a4);
__int64 __fastcall sub_140008CE0(__int64 a1, __int64 a2);
__int64 __fastcall sub_140009080(__int64 a1);
__int64 __fastcall sub_140009264(__int64 a1);
__int64 __fastcall sub_140009430(__int64 a1, __int64 a2);
__int64 __fastcall sub_140009630(_QWORD *a1);
__int64 __fastcall sub_140009780(__int64 a1);
__int64 sub_14000987C();
__int64 sub_140009A94();
__int64 __fastcall sub_140009C04(unsigned __int8 *a1);
__int64 __fastcall sub_140009F44(__int64 a1);
__int64 sub_14000A1C8(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_14000A214(void *a1);
void __fastcall sub_14000A2B8(PVOID P);
__int64 __fastcall sub_14000A358(PCWSTR SourceString, void **a2);
__int64 __fastcall sub_14000A560(HANDLE KeyHandle, PCWSTR SourceString, void **a3, unsigned int *a4, __int64 a5);
__int64 __fastcall sub_14000A8DC(HANDLE KeyHandle, PCWSTR SourceString, PVOID Data, ULONG DataSize, ULONG Type); // idb
__int64 __fastcall sub_14000AB00(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, __int64 a5);
__int64 __fastcall sub_14000ABA4(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4);
__int64 __fastcall sub_14000AC28(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4, __int64 a5);
__int64 __fastcall sub_14000AD2C(__int64 a1, __int64 a2);
// PNDIS_GENERIC_OBJECT __stdcall NdisAllocateGenericObject(PDRIVER_OBJECT DriverObject, ULONG Tag, USHORT Size);
// void __stdcall NdisFreeGenericObject(PNDIS_GENERIC_OBJECT NdisObject);
// void __stdcall NdisFreeMemory(PVOID VirtualAddress, UINT Length, UINT MemoryFlags);
// PVOID __stdcall NdisAllocateMemoryWithTagPriority(NDIS_HANDLE NdisHandle, UINT Length, ULONG Tag, EX_POOL_PRIORITY Priority);
// NDIS_HANDLE __stdcall NdisAllocateNetBufferListPool(NDIS_HANDLE NdisHandle, PNET_BUFFER_LIST_POOL_PARAMETERS Parameters);
// void __stdcall NdisFreeNetBufferListPool(NDIS_HANDLE PoolHandle);
// PMDL __stdcall NdisAllocateMdl(NDIS_HANDLE NdisHandle, PVOID VirtualAddress, UINT Length);
// void __stdcall NdisFreeMdl(PMDL Mdl);
// NTSTATUS __stdcall FwpsCalloutRegister0(void *deviceObject, const FWPS_CALLOUT0 *callout, UINT32 *calloutId);
// NTSTATUS __stdcall FwpsCalloutRegister1(void *deviceObject, const FWPS_CALLOUT1 *callout, UINT32 *calloutId);
// NTSTATUS __stdcall FwpsCalloutUnregisterById0(const UINT32 calloutId);
// FWPS_PACKET_INJECTION_STATE __stdcall FwpsQueryPacketInjectionState0(HANDLE injectionHandle, const NET_BUFFER_LIST *netBufferList, HANDLE *injectionContext);
// FWPM_SERVICE_STATE __stdcall FwpmBfeStateGet0();
// NTSTATUS __stdcall FwpmBfeStateSubscribeChanges0(void *deviceObject, FWPM_SERVICE_STATE_CHANGE_CALLBACK0 callback, void *context, HANDLE *changeHandle);
// NTSTATUS __stdcall FwpmBfeStateUnsubscribeChanges0(HANDLE changeHandle);
// NTSTATUS __stdcall FwpmEngineOpen0(const wchar_t *serverName, UINT32 authnService, SEC_WINNT_AUTH_IDENTITY_W *authIdentity, const FWPM_SESSION0 *session, HANDLE *engineHandle);
// NTSTATUS __stdcall FwpmEngineClose0(HANDLE engineHandle);
// NTSTATUS __stdcall FwpmTransactionBegin0(HANDLE engineHandle, UINT32 flags);
// NTSTATUS __stdcall FwpmTransactionCommit0(HANDLE engineHandle);
// NTSTATUS __stdcall FwpmTransactionAbort0(HANDLE engineHandle);
// NTSTATUS __stdcall FwpmProviderAdd0(HANDLE engineHandle, const FWPM_PROVIDER0 *provider, PSECURITY_DESCRIPTOR sd);
// NTSTATUS __stdcall FwpmSubLayerAdd0(HANDLE engineHandle, const FWPM_SUBLAYER0 *subLayer, PSECURITY_DESCRIPTOR sd);
// NTSTATUS __stdcall FwpmCalloutAdd0(HANDLE engineHandle, const FWPM_CALLOUT0 *callout, PSECURITY_DESCRIPTOR sd, UINT32 *id);
// NTSTATUS __stdcall FwpmFilterAdd0(HANDLE engineHandle, const FWPM_FILTER0 *filter, PSECURITY_DESCRIPTOR sd, UINT64 *id);
// NTSTATUS __stdcall FwpsInjectionHandleCreate0(ADDRESS_FAMILY addressFamily, UINT32 flags, HANDLE *injectionHandle);
// NTSTATUS __stdcall FwpsAllocateNetBufferAndNetBufferList0(NDIS_HANDLE poolHandle, USHORT contextSize, USHORT contextBackFill, MDL *mdlChain, ULONG dataOffset, SIZE_T dataLength, NET_BUFFER_LIST **netBufferList);
// void __stdcall FwpsFreeNetBufferList0(NET_BUFFER_LIST *netBufferList);
// __int64 __fastcall FwpsInjectMacSendAsync0(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _DWORD, _QWORD, _QWORD, _QWORD); weak
// NTSTATUS __stdcall FwpsStreamInjectAsync0(HANDLE injectionHandle, HANDLE injectionContext, UINT32 flags, UINT64 flowId, UINT32 calloutId, UINT16 layerId, UINT32 streamFlags, NET_BUFFER_LIST *netBufferList, SIZE_T dataLength, FWPS_INJECT_COMPLETE0 completionFn, HANDLE completionContext);
void __fastcall sub_14000AE50(PVOID P, __int64 a2, __int64 a3);
bool __fastcall sub_14000AEC0(struct _KEVENT **a1, char a2, BOOLEAN a3, __int64 a4, __int64 a5);
int __fastcall sub_14000AF50(PRKEVENT Event, __int64 a2, __int64 a3);
int __fastcall sub_14000AFC0(PRKEVENT Event, __int64 a2, __int64 a3);
void __fastcall sub_14000B030(PFAST_MUTEX FastMutex, __int64 a2, __int64 a3);
void __fastcall sub_14000B0A0(__int64 a1, __int64 a2, __int64 a3);
void __fastcall sub_14000B110(PFAST_MUTEX FastMutex, __int64 a2, __int64 a3);
void __fastcall sub_14000B180(PKSPIN_LOCK SpinLock, KIRQL *a2, __int64 a3, __int64 a4);
void __fastcall sub_14000B200(PKSPIN_LOCK SpinLock, __int64 a2, __int64 a3);
void __fastcall sub_14000B270(PKSPIN_LOCK SpinLock, KIRQL a2, __int64 a3, __int64 a4);
PVOID __fastcall sub_14000B2F0(int a1, unsigned int a2, ULONG a3, __int64 a4, __int64 a5);
void __fastcall sub_14000B380(PVOID P, ULONG Tag, __int64 a3, __int64 a4);
_DWORD *__fastcall sub_14000B400(__int64 a1, __int64 a2, __int64 a3);
void __fastcall sub_14000B470(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
void __fastcall sub_14000B4F0(PVOID P, __int64 a2, __int64 a3);
char *__fastcall sub_14000B560(int a1, unsigned int a2, ULONG a3, __int64 a4, __int64 a5);
__int64 __fastcall sub_14000B5F0(PVOID P, __int64 a2, __int64 a3, __int64 a4);
PVOID __fastcall sub_14000B670(unsigned int a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_14000B6E0(PVOID Object, unsigned int a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_14000B760(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, __int64 a5, __int64 a6);
void __fastcall sub_14000B890(PVOID P);
bool __fastcall sub_14000B930(struct _KEVENT **a1, char a2, BOOLEAN a3);
int __fastcall sub_14000BA20(PRKEVENT Event);
int __fastcall sub_14000BAB0(PRKEVENT Event);
void __fastcall sub_14000BB40(PFAST_MUTEX FastMutex);
void __fastcall sub_14000BBD0(__int64 a1);
void __fastcall sub_14000BC70(PFAST_MUTEX FastMutex);
void __fastcall sub_14000BD00(PKSPIN_LOCK SpinLock, KIRQL *a2);
void __fastcall sub_14000BDC0(PKSPIN_LOCK SpinLock);
void __fastcall sub_14000BE50(PKSPIN_LOCK SpinLock, KIRQL a2);
PVOID __fastcall sub_14000BF00(int a1, unsigned int a2, ULONG a3);
void __fastcall sub_14000C020(PVOID P, ULONG Tag);
_DWORD *__fastcall sub_14000C110(__int64 a1);
void __fastcall sub_14000C220(__int64 a1, __int64 a2);
void __fastcall sub_14000C300(PVOID P);
char *__fastcall sub_14000C3E0(int a1, unsigned int a2, ULONG a3);
void __fastcall StartRoutine(PVOID StartContext);
__int64 __fastcall sub_14000C5F0(PVOID P); // idb
PVOID __fastcall sub_14000CBA0(unsigned int a1, char a2);
PVOID __fastcall sub_14000CFB0(unsigned int a1);
int __fastcall sub_14000CFC0(PVOID **a1);
__int64 __fastcall sub_14000D480(PVOID Object, unsigned int a2);
__int64 __fastcall sub_14000D550(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_14000D5E0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_14000D628(_DWORD *a1, char *a2, char a3);
__int64 sub_14000D760(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
char __fastcall sub_14000D7A4(PFAST_MUTEX FastMutex);
char __fastcall sub_14000D804(PFAST_MUTEX FastMutex);
void __fastcall sub_14000D85C(__int64 a1);
bool __fastcall sub_14000D884(__int64 a1);
char __fastcall sub_14000D8E4(PFAST_MUTEX FastMutex);
char __fastcall sub_14000D940(PFAST_MUTEX FastMutex);
char __fastcall sub_14000D9A0(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1);
char __fastcall sub_14000D9F0(__int64 a1, __int64 a2);
__int64 __fastcall sub_14000DA40(int a1, struct _FAST_MUTEX *a2, KIRQL *a3);
bool __fastcall sub_14000DB00(int a1, int a2);
char __fastcall sub_14000DB40(_DWORD *a1, _DWORD *a2);
__int64 __fastcall sub_14000DCB0(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3);
__int64 __fastcall sub_14000DE00(__int64 a1, __int64 a2, char a3);
__int64 __fastcall sub_14000E070(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_14000E200(__int64 a1, unsigned int a2, __int64 *a3, char a4);
__int64 __fastcall sub_14000E440(__int64 a1, __int64 a2, char a3);
__int64 __fastcall sub_14000E560(int a1, __int64 a2);
unsigned __int64 __fastcall sub_14000E6C0(__int64 a1, unsigned __int64 a2, _DWORD *a3);
_DWORD *__fastcall sub_14000E7C0(__int64 a1, __int64 a2, _DWORD *a3);
__int64 __fastcall sub_14000E950(__int64 a1, __int64 a2, char a3);
__int64 __fastcall sub_14000EA80(int a1, KSPIN_LOCK *a2);
_QWORD *__fastcall sub_14000EC30(__int64 a1, unsigned int a2, __int64 a3, _DWORD *a4);
char __fastcall sub_14000EE00(_DWORD *a1, _DWORD *a2);
__int64 __fastcall sub_14000EF70(unsigned int a1);
__int64 __fastcall sub_14000F0A0(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3);
__int64 __fastcall sub_14000F1F0(int a1, struct _FAST_MUTEX *a2, KIRQL a3);
char __fastcall sub_14000F280(_DWORD *a1, _DWORD *a2);
__int64 __fastcall sub_14000F3E4(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, __int64 a3);
__int64 __fastcall sub_14000F5C0(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3);
_DWORD *__fastcall sub_14000F760(unsigned __int8 a1, int a2, int a3, ULONG a4, __int64 a5, int a6, __int64 a7, __int64 a8, __int64 a9, __int64 a10, _DWORD *a11);
__int64 __fastcall sub_14000FB00(ULONG_PTR BugCheckParameter2, char a2);
__int64 __fastcall sub_14000FF64(int a1);
__int64 __fastcall sub_140010008(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3, _DWORD *a4);
__int64 __fastcall sub_140010294(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, char a3, _DWORD *a4);
__int64 __fastcall sub_140010530(__int64 a1, _DWORD *a2);
ULONG_PTR __fastcall sub_140010630(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, __int64 a4, __int64 a5);
__int64 __fastcall sub_140010AA4(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR *a4);
__int64 __fastcall sub_140010CD0(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, _QWORD *a3, _DWORD *a4);
__int64 __fastcall sub_140010EB0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_140010F00(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_140010F60(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_140010FB0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_140011000(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
BOOLEAN sub_140011060();
// errno_t __cdecl memcpy_s(void *, rsize_t DstSize, const void *Src, rsize_t MaxCount);
// void *__cdecl memset(void *Dst, int Val, size_t Size);
// void *__cdecl memmove(void *Dst, const void *Src, size_t MaxCount);
// void __stdcall RtlInitUnicodeString(PUNICODE_STRING DestinationString, PCWSTR SourceString);
// NTSTATUS __stdcall IoCreateDevice(PDRIVER_OBJECT DriverObject, ULONG DeviceExtensionSize, PUNICODE_STRING DeviceName, ULONG DeviceType, ULONG DeviceCharacteristics, BOOLEAN Exclusive, PDEVICE_OBJECT *DeviceObject);
// void __stdcall IoDeleteDevice(PDEVICE_OBJECT DeviceObject);
// HANDLE PsGetCurrentProcessId(void);
// HANDLE PsGetCurrentThreadId(void);
// void __stdcall KeInitializeEvent(PRKEVENT Event, EVENT_TYPE Type, BOOLEAN State);
// NTSTATUS __stdcall KeWaitForSingleObject(PVOID Object, KWAIT_REASON WaitReason, KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Timeout);
// PIRP __stdcall IoBuildDeviceIoControlRequest(ULONG IoControlCode, PDEVICE_OBJECT DeviceObject, PVOID InputBuffer, ULONG InputBufferLength, PVOID OutputBuffer, ULONG OutputBufferLength, BOOLEAN InternalDeviceIoControl, PKEVENT Event, PIO_STATUS_BLOCK IoStatusBlock);
// NTSTATUS __stdcall IofCallDriver(PDEVICE_OBJECT DeviceObject, PIRP Irp);
// void __stdcall IofCompleteRequest(PIRP Irp, CCHAR PriorityBoost);
// NTSTATUS __stdcall IoGetDeviceObjectPointer(PUNICODE_STRING ObjectName, ACCESS_MASK DesiredAccess, PFILE_OBJECT *FileObject, PDEVICE_OBJECT *DeviceObject);
// LONG_PTR __stdcall ObfDereferenceObject(PVOID Object);
// PVOID __stdcall MmMapLockedPagesSpecifyCache(PMDL MemoryDescriptorList, KPROCESSOR_MODE AccessMode, MEMORY_CACHING_TYPE CacheType, PVOID RequestedAddress, ULONG BugCheckOnFailure, ULONG Priority);
// PVOID __stdcall MmGetSystemRoutineAddress(PUNICODE_STRING SystemRoutineName);
// SIZE_T __stdcall RtlCompareMemory(const void *Source1, const void *Source2, SIZE_T Length);
// NTSTATUS __stdcall IoWMIRegistrationControl(PDEVICE_OBJECT DeviceObject, ULONG Action);
// PVOID __stdcall ExAllocatePoolWithTag(POOL_TYPE PoolType, SIZE_T NumberOfBytes, ULONG Tag);
// void __stdcall ExFreePoolWithTag(PVOID P, ULONG Tag);
// NTSTATUS __stdcall ZwClose(HANDLE Handle);
// NTSTATUS __stdcall ZwCreateKey(PHANDLE KeyHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, ULONG TitleIndex, PUNICODE_STRING Class, ULONG CreateOptions, PULONG Disposition);
// NTSTATUS __stdcall ZwQueryValueKey(HANDLE KeyHandle, PUNICODE_STRING ValueName, KEY_VALUE_INFORMATION_CLASS KeyValueInformationClass, PVOID KeyValueInformation, ULONG Length, PULONG ResultLength);
// NTSTATUS __stdcall ZwSetValueKey(HANDLE KeyHandle, PUNICODE_STRING ValueName, ULONG TitleIndex, ULONG Type, PVOID Data, ULONG DataSize);
// void __stdcall KeClearEvent(PRKEVENT Event);
// LONG __stdcall KeResetEvent(PRKEVENT Event);
// LONG __stdcall KeSetEvent(PRKEVENT Event, KPRIORITY Increment, BOOLEAN Wait);
// NTSTATUS __stdcall KeWaitForMultipleObjects(ULONG Count, PVOID Object[], WAIT_TYPE WaitType, KWAIT_REASON WaitReason, KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Timeout, PKWAIT_BLOCK WaitBlockArray);
// void __stdcall KeInitializeSpinLock(PKSPIN_LOCK SpinLock);
// void __stdcall KeAcquireSpinLockAtDpcLevel(PKSPIN_LOCK SpinLock);
// KIRQL __stdcall KeAcquireSpinLockRaiseToDpc(PKSPIN_LOCK SpinLock);
// void __stdcall KeReleaseSpinLock(PKSPIN_LOCK SpinLock, KIRQL NewIrql);
// void __stdcall KeReleaseSpinLockFromDpcLevel(PKSPIN_LOCK SpinLock);
// void __stdcall ExAcquireFastMutex(PFAST_MUTEX FastMutex);
// void __stdcall ExReleaseFastMutex(PFAST_MUTEX FastMutex);
// USHORT __stdcall ExQueryDepthSList(PSLIST_HEADER SListHead);
// PSLIST_ENTRY __stdcall ExpInterlockedPopEntrySList(PSLIST_HEADER ListHead);
// PSLIST_ENTRY __stdcall ExpInterlockedPushEntrySList(PSLIST_HEADER ListHead, PSLIST_ENTRY ListEntry);
// void __stdcall ExInitializeNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside, PALLOCATE_FUNCTION Allocate, PFREE_FUNCTION Free, ULONG Flags, SIZE_T Size, ULONG Tag, USHORT Depth);
// void __stdcall ExDeleteNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside);
// void __stdcall ExInitializePagedLookasideList(PPAGED_LOOKASIDE_LIST Lookaside, PALLOCATE_FUNCTION Allocate, PFREE_FUNCTION Free, ULONG Flags, SIZE_T Size, ULONG Tag, USHORT Depth);
// void __stdcall ExDeletePagedLookasideList(PPAGED_LOOKASIDE_LIST Lookaside);
// NTSTATUS __stdcall PsCreateSystemThread(PHANDLE ThreadHandle, ULONG DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, HANDLE ProcessHandle, PCLIENT_ID ClientId, PKSTART_ROUTINE StartRoutine, PVOID StartContext);
// NTSTATUS __stdcall PsTerminateSystemThread(NTSTATUS ExitStatus);
// NTSTATUS __stdcall ObReferenceObjectByHandle(HANDLE Handle, ACCESS_MASK DesiredAccess, POBJECT_TYPE ObjectType, KPROCESSOR_MODE AccessMode, PVOID *Object, POBJECT_HANDLE_INFORMATION HandleInformation);
// NTSTATUS __stdcall KeDelayExecutionThread(KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Interval);
// void __stdcall __noreturn KeBugCheckEx(ULONG BugCheckCode, ULONG_PTR BugCheckParameter1, ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter3, ULONG_PTR BugCheckParameter4);
// BOOLEAN __stdcall KeCancelTimer(PKTIMER);
void sub_140018000();
void sub_140018070();
__int64 (*sub_1400180F8())(void);
__int64 __fastcall sub_140018200(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6);
NTSTATUS __stdcall DriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath);
// void __cdecl _security_init_cookie();

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN sub_140008BF0; // weak
__int64 qword_140011AA0[2] = { -3689348818177884152i64, -3689348814741910324i64 }; // weak
_UNKNOWN unk_140012470; // weak
_UNKNOWN unk_140012480; // weak
_UNKNOWN unk_140012490; // weak
_UNKNOWN unk_1400124A0; // weak
_UNKNOWN unk_1400124B0; // weak
GUID stru_1400124C0 = { 32572448u, 27866u, 19059u, { 153u, 38u, 31u, 66u, 52u, 227u, 142u, 63u } }; // idb
GUID stru_1400124D0 = { 2973499422u, 35166u, 16412u, { 183u, 92u, 182u, 110u, 83u, 242u, 144u, 48u } }; // idb
GUID stru_1400124E0 = { 1828800656u, 5656u, 17052u, { 154u, 23u, 61u, 113u, 13u, 171u, 31u, 184u } }; // idb
GUID stru_1400124F0 = { 2211486497u, 38148u, 16855u, { 142u, 39u, 23u, 96u, 252u, 203u, 226u, 37u } }; // idb
GUID stru_140012500 = { 2118311574u, 45595u, 16583u, { 139u, 127u, 20u, 118u, 90u, 87u, 79u, 241u } }; // idb
GUID stru_140012510 = { 1549340668u, 32406u, 19673u, { 131u, 125u, 38u, 188u, 36u, 203u, 177u, 91u } }; // idb
GUID stru_140012520 = { 2974776479u, 11753u, 17199u, { 160u, 33u, 241u, 54u, 84u, 254u, 22u, 107u } }; // idb
GUID stru_140012530 =
{
  3883149106u,
  17706u,
  18311u,
  { 165u, 149u, 62u, 155u, 177u, 67u, 171u, 199u }
}; // idb
GUID stru_140012540 = { 488654037u, 7666u, 18299u, { 129u, 100u, 191u, 186u, 57u, 157u, 248u, 53u } }; // idb
GUID stru_140012550 =
{
  3754672986u,
  44145u,
  17097u,
  { 172u, 249u, 188u, 199u, 49u, 72u, 248u, 203u }
}; // idb
GUID stru_140012560 = { 4267090645u, 11791u, 17895u, { 181u, 71u, 19u, 208u, 48u, 140u, 228u, 32u } }; // idb
GUID stru_140012570 =
{
  1256752365u,
  11815u,
  19250u,
  { 174u, 253u, 202u, 226u, 135u, 31u, 102u, 215u }
}; // idb
GUID stru_140012580 = { 918700404u, 61124u, 17090u, { 167u, 216u, 58u, 72u, 235u, 18u, 72u, 16u } }; // idb
GUID stru_140012590 = { 431056810u, 37338u, 17804u, { 133u, 224u, 139u, 166u, 157u, 33u, 79u, 36u } }; // idb
GUID stru_1400125A0 = { 945112382u, 6132u, 16866u, { 191u, 107u, 149u, 63u, 240u, 19u, 253u, 58u } }; // idb
GUID stru_1400125B0 = { 1863928807u, 36859u, 18674u, { 146u, 146u, 33u, 156u, 36u, 178u, 92u, 230u } }; // idb
GUID stru_1400125C0 = { 4133553014u, 22837u, 16745u, { 146u, 114u, 16u, 29u, 52u, 89u, 33u, 27u } }; // idb
GUID stru_1400125D0 =
{
  1042681078u,
  23352u,
  20375u,
  { 129u, 246u, 223u, 202u, 159u, 186u, 48u, 51u }
}; // idb
GUID stru_1400125E0 =
{
  2093772809u,
  42891u,
  17449u,
  { 159u, 176u, 79u, 254u, 192u, 146u, 205u, 200u }
}; // idb
GUID stru_1400125F0 = { 247989506u, 64425u, 17014u, { 158u, 85u, 63u, 227u, 31u, 118u, 209u, 123u } }; // idb
GUID stru_140012600 = { 2637116692u, 7153u, 18118u, { 187u, 170u, 137u, 41u, 81u, 222u, 209u, 52u } }; // idb
__int128 xmmword_140012610 = 0x49CDF73EEE5B1B8B43805D6F25AB9FC5i64; // weak
__int128 xmmword_140012620 = 0xEE07CA6621B96FBD42BF66F4EC4D616Ai64; // weak
_UNKNOWN unk_140012630; // weak
_UNKNOWN unk_140012640; // weak
_UNKNOWN unk_140012650; // weak
_UNKNOWN unk_140012660; // weak
_UNKNOWN unk_140012670; // weak
_UNKNOWN unk_140012680; // weak
__int64 qword_140012690 = 5635069264067806136i64; // weak
__int64 qword_1400126A0 = 5338185440569054829i64; // weak
__int64 qword_1400126B0 = 5193802510280285732i64; // weak
__int64 qword_1400126C0 = 5253840152566971143i64; // weak
__int64 qword_1400126D0 = 5392767786629113857i64; // weak
__int64 qword_1400126E0 = 5677454778245206241i64; // weak
__int64 qword_1400126F0 = 5451967257449295053i64; // weak
__int128 xmmword_140012700 = 0xCAFF733BC1C5AEA54C93E09EDAF8CD14i64; // weak
__int128 xmmword_140012710 = 0xCA84A6803E9D786435C5167632CE23Bi64; // weak
__int64 qword_140012720 = 5078620718253892647i64; // weak
__int128 xmmword_140012730 = 0x27836AB4A726899C49795176BA69DC66i64; // weak
__int64 qword_140012740 = 5677565780428329634i64; // weak
__int128 xmmword_140012750 = 0xCDC0F102A9F561A24868877977A40437i64; // weak
__int128 xmmword_140012760 = 0x7F2583C4E9CE7EB846729F04A3B42C97i64; // weak
__int64 qword_140012770 = 5626101824053694080i64; // weak
__int64 qword_140012780 = 4619229426057895118i64; // weak
__int64 qword_140012790 = 4788439890839576551i64; // weak
__int64 qword_1400127B0 = 5483912236630644923i64; // weak
__int64 qword_1400127C0 = 5490738588793264081i64; // weak
__int64 qword_1400127D0 = 5219908205974811580i64; // weak
__int64 qword_1400127E0 = 5043362144207108826i64; // weak
__int64 qword_1400127F0 = 4952888250419263803i64; // weak
__int64 qword_140012800 = 4766986686987676059i64; // weak
__int64 qword_140012820 = 4766909398678986157i64; // weak
__int64 qword_140012850 = 4989948673866947479i64; // weak
_UNKNOWN unk_140012860; // weak
_UNKNOWN unk_140012870; // weak
_UNKNOWN unk_140012880; // weak
_UNKNOWN unk_140012890; // weak
_UNKNOWN unk_1400128A0; // weak
PDEVICE_OBJECT DeviceObject = &DeviceObject; // idb
char aUnknownModule[15] = "Unknown module"; // weak
__int64 (__fastcall *qword_140014060)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (*qword_140014070)(void) = NULL; // weak
__int64 (__fastcall *qword_140014078)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_140014080)(_QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
int dword_140014088 = 0; // weak
HANDLE engineHandle = NULL; // idb
UINT32 calloutId = 0u; // idb
UINT32 dword_14001409C = 0u; // idb
UINT32 dword_1400140A0 = 0u; // idb
UINT32 dword_1400140A4[2] = { 0u, 0u }; // idb
UINT32 dword_1400140AC = 0u; // idb
UINT32 dword_1400140B0 = 0u; // idb
UINT32 dword_1400140B4 = 0u; // idb
UINT32 dword_1400140B8 = 0u; // idb
UINT32 dword_1400140C0 = 0u; // idb
UINT32 dword_1400140C4 = 0u; // idb
UINT32 dword_1400140C8 = 0u; // idb
UINT32 dword_1400140CC = 0u; // idb
UINT32 dword_1400140D0 = 0u; // idb
UINT32 dword_1400140D4 = 0u; // idb
UINT32 dword_1400140D8 = 0u; // idb
UINT32 dword_1400140DC = 0u; // idb
UINT32 dword_1400140E0 = 0u; // idb
UINT32 dword_1400140E4 = 0u; // idb
UINT32 dword_1400140E8 = 0u; // idb
UINT32 dword_1400140EC = 0u; // idb
UINT32 dword_1400140F0 = 0u; // idb
UINT32 dword_1400140F4 = 0u; // idb
UINT32 dword_1400140F8 = 0u; // idb
UINT32 dword_1400140FC = 0u; // idb
UINT32 dword_140014100 = 0u; // idb
UINT32 dword_140014104 = 0u; // idb
PDEVICE_OBJECT deviceObject = NULL; // idb
HANDLE changeHandle = NULL; // idb
int dword_140014118 = 0; // weak
int dword_14001411C = 0; // weak
PLARGE_INTEGER P = NULL; // idb
PDEVICE_OBJECT qword_140014128 = NULL; // idb
PNDIS_GENERIC_OBJECT NdisObject = NULL; // idb
NDIS_HANDLE poolHandle = NULL; // idb
HANDLE injectionHandle = NULL; // idb
HANDLE qword_140014148 = NULL; // idb
PVOID qword_140014150 = NULL; // idb
ULONG_PTR BugCheckParameter2 = 0ui64; // idb
KSPIN_LOCK SpinLock = 0ui64; // idb
PVOID qword_140014168 = NULL; // idb
struct _KTIMER stru_140016780; // idb
struct _DEVICE_OBJECT stru_1400167C0; // idb


//----- (0000000140001000) ----------------------------------------------------
__int64 __fastcall sub_140001000(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6)
{
  int v8; // eax
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  __int64 result; // rax
  __int128 v12; // [rsp+20h] [rbp-48h] BYREF
  __int128 v13; // [rsp+30h] [rbp-38h] BYREF
  __int128 v14; // [rsp+40h] [rbp-28h] BYREF
  __int64 v15; // [rsp+50h] [rbp-18h]

  v12 = 0i64;
  v13 = 0i64;
  v14 = 0i64;
  v15 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x51u, (__int64)&unk_1400124B0);
  }
  *a6 = 8198;
  if ( sub_140005C1C() )
  {
    v8 = sub_140003FA4(a1, (__int64)&v13, (__int64)&v14 + 4);
    if ( v8 )
    {
      v9 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        goto LABEL_30;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
        goto LABEL_26;
      v10 = 83;
    }
    else
    {
      v8 = sub_140003E84(a2, &v12);
      if ( v8 )
      {
        v9 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          goto LABEL_30;
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
          goto LABEL_26;
        v10 = 84;
      }
      else
      {
        v8 = sub_140008CE0((__int64)&v13, (__int64)&v12);
        if ( !v8 )
          goto LABEL_26;
        v9 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          goto LABEL_30;
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
          goto LABEL_26;
        v10 = 85;
      }
    }
    sub_1400059D0(v9->Dpc.ProcessorHistory, v10, (__int64)&unk_1400124B0, v8);
  }
  else
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      goto LABEL_30;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x52u, (__int64)&unk_1400124B0);
  }
LABEL_26:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x56u, (__int64)&unk_1400124B0);
  }
LABEL_30:
  result = sub_140009080((__int64)&v12);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x57u, (__int64)&unk_1400124B0);
  }
  return result;
}

//----- (0000000140001230) ----------------------------------------------------
__int64 __fastcall sub_140001230(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6)
{
  int v8; // eax
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  __int64 result; // rax
  __int128 v12; // [rsp+20h] [rbp-48h] BYREF
  __int128 v13; // [rsp+30h] [rbp-38h] BYREF
  __int128 v14; // [rsp+40h] [rbp-28h] BYREF
  __int64 v15; // [rsp+50h] [rbp-18h]

  v12 = 0i64;
  v13 = 0i64;
  v14 = 0i64;
  v15 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x5Bu, (__int64)&unk_1400124B0);
  }
  *a6 = 8198;
  if ( sub_140005C1C() )
  {
    v8 = sub_140003FA4(a1, (__int64)&v13, (__int64)&v14 + 4);
    if ( v8 )
    {
      v9 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        goto LABEL_30;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
        goto LABEL_26;
      v10 = 93;
    }
    else
    {
      v8 = sub_140003E84(a2, &v12);
      if ( v8 )
      {
        v9 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          goto LABEL_30;
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
          goto LABEL_26;
        v10 = 94;
      }
      else
      {
        v8 = sub_140009264((__int64)&v13);
        if ( !v8 )
          goto LABEL_26;
        v9 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          goto LABEL_30;
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
          goto LABEL_26;
        v10 = 95;
      }
    }
    sub_1400059D0(v9->Dpc.ProcessorHistory, v10, (__int64)&unk_1400124B0, v8);
  }
  else
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      goto LABEL_30;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x5Cu, (__int64)&unk_1400124B0);
  }
LABEL_26:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x60u, (__int64)&unk_1400124B0);
  }
LABEL_30:
  result = sub_140009080((__int64)&v12);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x61u, (__int64)&unk_1400124B0);
  }
  return result;
}

//----- (0000000140001450) ----------------------------------------------------
__int64 sub_140001450()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x62u, (__int64)&unk_1400124B0);
  }
  if ( !sub_140005C1C() )
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return 0i64;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x63u, (__int64)&unk_1400124B0);
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x64u, (__int64)&unk_1400124B0);
  }
  return 0i64;
}

//----- (0000000140001520) ----------------------------------------------------
__int64 sub_140001520()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x58u, (__int64)&unk_1400124B0);
  }
  if ( !sub_140005C1C() )
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return 0i64;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x59u, (__int64)&unk_1400124B0);
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x5Au, (__int64)&unk_1400124B0);
  }
  return 0i64;
}

//----- (00000001400015F0) ----------------------------------------------------
__int64 __fastcall sub_1400015F0(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, int a6, _DWORD *a7)
{
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  int v11; // eax
  PDEVICE_OBJECT v12; // rcx
  unsigned __int16 v13; // dx
  __int64 result; // rax
  __int128 v15; // [rsp+20h] [rbp-48h] BYREF
  __int128 v16; // [rsp+30h] [rbp-38h] BYREF
  __int128 v17; // [rsp+40h] [rbp-28h] BYREF
  __int64 v18; // [rsp+50h] [rbp-18h]

  v15 = 0i64;
  v16 = 0i64;
  v17 = 0i64;
  v18 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && _bittest((const signed __int32 *)&DeviceObject->Dpc.DeferredContext + 1, 8u)
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xADu, (__int64)&unk_1400124B0);
  }
  *a7 = 8198;
  if ( sub_140005C1C() )
  {
    v11 = sub_140003FA4(a1, (__int64)&v16, (__int64)&v17 + 4);
    if ( v11 )
    {
      v12 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        goto LABEL_35;
      if ( !_bittest((const signed __int32 *)&DeviceObject->Dpc.DeferredContext + 1, 8u)
        || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_31;
      }
      v13 = 175;
    }
    else
    {
      v11 = sub_140003E84(a2, &v15);
      if ( v11 )
      {
        v12 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          goto LABEL_35;
        if ( !_bittest((const signed __int32 *)&DeviceObject->Dpc.DeferredContext + 1, 8u)
          || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
        {
          goto LABEL_31;
        }
        v13 = 176;
      }
      else
      {
        v11 = sub_140009264((__int64)&v16);
        if ( !v11 )
        {
          v9 = DeviceObject;
          if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
            goto LABEL_35;
          if ( !_bittest((const signed __int32 *)&DeviceObject->Dpc.DeferredContext + 1, 8u)
            || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
          {
            goto LABEL_31;
          }
          v10 = 178;
          goto LABEL_30;
        }
        v12 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          goto LABEL_35;
        if ( !_bittest((const signed __int32 *)&DeviceObject->Dpc.DeferredContext + 1, 8u)
          || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
        {
          goto LABEL_31;
        }
        v13 = 177;
      }
    }
    sub_1400059D0(v12->Dpc.ProcessorHistory, v13, (__int64)&unk_1400124B0, v11);
  }
  else
  {
    v9 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      goto LABEL_35;
    if ( _bittest((const signed __int32 *)&DeviceObject->Dpc.DeferredContext + 1, 8u)
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
    {
      v10 = 174;
LABEL_30:
      sub_1400059A0(v9->Dpc.ProcessorHistory, v10, (__int64)&unk_1400124B0);
      goto LABEL_31;
    }
  }
LABEL_31:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && _bittest((const signed __int32 *)&DeviceObject->Dpc.DeferredContext + 1, 8u)
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xB3u, (__int64)&unk_1400124B0);
  }
LABEL_35:
  result = sub_140009080((__int64)&v15);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && _bittest((const signed __int32 *)&DeviceObject->Dpc.DeferredContext + 1, 8u)
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xB4u, (__int64)&unk_1400124B0);
  }
  return result;
}

//----- (0000000140001850) ----------------------------------------------------
__int64 sub_140001850()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x100) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xB5u, (__int64)&unk_1400124B0);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x100) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xB6u, (__int64)&unk_1400124B0);
    }
  }
  return 0i64;
}

//----- (00000001400018E0) ----------------------------------------------------
__int64 __fastcall sub_1400018E0(__int16 *a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6)
{
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  int v10; // eax
  PDEVICE_OBJECT v11; // r10
  unsigned __int16 v12; // dx
  __int64 v13; // rcx
  __int64 result; // rax
  __int128 v15; // [rsp+20h] [rbp-69h] BYREF
  __int128 v16; // [rsp+30h] [rbp-59h] BYREF
  __int128 v17; // [rsp+40h] [rbp-49h]
  __int64 v18; // [rsp+50h] [rbp-39h]
  char Dst[64]; // [rsp+60h] [rbp-29h] BYREF

  v18 = 0i64;
  v15 = 0i64;
  v16 = 0i64;
  v17 = 0i64;
  memset(Dst, 0, sizeof(Dst));
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x7Bu, (__int64)&unk_1400124B0);
  }
  *a6 = 8198;
  if ( sub_140005C1C() )
  {
    v10 = sub_140003FA4((__int64)a1, (__int64)&v16, 0i64);
    if ( v10 )
    {
      v11 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        goto LABEL_47;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
        goto LABEL_43;
      v12 = 125;
    }
    else
    {
      BYTE3(v17) = 6;
      v10 = sub_140003E84(a2, &v15);
      if ( v10 )
      {
        v11 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          goto LABEL_47;
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
          goto LABEL_43;
        v12 = 126;
      }
      else
      {
        v10 = sub_140008CE0((__int64)&v16, (__int64)&v15);
        if ( !v10 )
        {
          if ( !sub_140005E68() )
          {
            v8 = DeviceObject;
            if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
              goto LABEL_47;
            if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) == 0
              || BYTE1(DeviceObject->Dpc.DeferredContext) < 5u )
            {
              goto LABEL_43;
            }
            v9 = 130;
            goto LABEL_42;
          }
          v10 = sub_140003BF4(a1, (__int64)&v15, (__int64)Dst);
          if ( !v10 )
          {
            sub_140004C3C((__int64)Dst);
            if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
              && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) != 0
              && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
            {
              sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x81u, (__int64)&unk_1400124B0);
            }
            sub_140007780(0, (__int64)Dst, 0x40u);
            goto LABEL_43;
          }
          if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
            goto LABEL_47;
          if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
            goto LABEL_43;
          v13 = DeviceObject->Dpc.ProcessorHistory;
          v12 = 128;
          goto LABEL_16;
        }
        v11 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          goto LABEL_47;
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
          goto LABEL_43;
        v12 = 127;
      }
    }
    v13 = v11->Dpc.ProcessorHistory;
LABEL_16:
    sub_1400059D0(v13, v12, (__int64)&unk_1400124B0, v10);
    goto LABEL_43;
  }
  v8 = DeviceObject;
  if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
    goto LABEL_47;
  if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
  {
    v9 = 124;
LABEL_42:
    sub_1400059A0(v8->Dpc.ProcessorHistory, v9, (__int64)&unk_1400124B0);
  }
LABEL_43:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x83u, (__int64)&unk_1400124B0);
  }
LABEL_47:
  result = sub_140009080((__int64)&v15);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x84u, (__int64)&unk_1400124B0);
  }
  return result;
}

//----- (0000000140001C20) ----------------------------------------------------
__int64 __fastcall sub_140001C20(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6)
{
  int v8; // eax
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  __int64 result; // rax
  __int128 v12; // [rsp+20h] [rbp-48h] BYREF
  __int128 v13; // [rsp+30h] [rbp-38h] BYREF
  __int128 v14; // [rsp+40h] [rbp-28h] BYREF
  __int64 v15; // [rsp+50h] [rbp-18h]

  v12 = 0i64;
  v13 = 0i64;
  v14 = 0i64;
  v15 = 0i64;
  *a6 = 8198;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x88u, (__int64)&unk_1400124B0);
  }
  v8 = sub_140003FA4(a1, (__int64)&v13, (__int64)&v14 + 4);
  if ( !v8 )
  {
    v8 = sub_140003E84(a2, &v12);
    if ( !v8 )
      goto LABEL_16;
    v9 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      goto LABEL_20;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
      goto LABEL_16;
    v10 = 138;
    goto LABEL_15;
  }
  v9 = DeviceObject;
  if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
    goto LABEL_20;
  if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
  {
    v10 = 137;
LABEL_15:
    sub_1400059D0(v9->Dpc.ProcessorHistory, v10, (__int64)&unk_1400124B0, v8);
  }
LABEL_16:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x100) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x8Bu, (__int64)&unk_1400124B0);
  }
LABEL_20:
  result = sub_140009080((__int64)&v12);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x8Cu, (__int64)&unk_1400124B0);
  }
  return result;
}

//----- (0000000140001DC0) ----------------------------------------------------
__int64 sub_140001DC0()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x8Du, (__int64)&unk_1400124B0);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x8Eu, (__int64)&unk_1400124B0);
    }
  }
  return 0i64;
}

//----- (0000000140001E50) ----------------------------------------------------
__int64 sub_140001E50()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x85u, (__int64)&unk_1400124B0);
  }
  if ( !sub_140005C1C() )
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return 0i64;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x86u, (__int64)&unk_1400124B0);
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x87u, (__int64)&unk_1400124B0);
  }
  return 0i64;
}

//----- (0000000140001F20) ----------------------------------------------------
__int64 __fastcall sub_140001F20(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, _DWORD *a6)
{
  __int64 result; // rax

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x65u, (__int64)&unk_1400124B0);
  }
  result = sub_140001000(a1, a2, a3, a4, a5, a6);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x66u, (__int64)&unk_1400124B0);
  }
  return result;
}

//----- (0000000140002000) ----------------------------------------------------
__int64 __fastcall sub_140002000(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, _DWORD *a6)
{
  __int64 result; // rax

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x6Au, (__int64)&unk_1400124B0);
  }
  result = sub_140001230(a1, a2, a3, a4, a5, a6);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x6Bu, (__int64)&unk_1400124B0);
  }
  return result;
}

//----- (00000001400020E0) ----------------------------------------------------
__int64 sub_1400020E0()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x6Cu, (__int64)&unk_1400124B0);
  }
  if ( !sub_140005C1C() )
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return 0i64;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x6Du, (__int64)&unk_1400124B0);
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x6Eu, (__int64)&unk_1400124B0);
  }
  return 0i64;
}

//----- (00000001400021B0) ----------------------------------------------------
__int64 sub_1400021B0()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x67u, (__int64)&unk_1400124B0);
  }
  if ( !sub_140005C1C() )
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return 0i64;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x68u, (__int64)&unk_1400124B0);
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x69u, (__int64)&unk_1400124B0);
  }
  return 0i64;
}

//----- (0000000140002280) ----------------------------------------------------
__int64 __fastcall sub_140002280(__int16 *a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6)
{
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  int v10; // eax
  PDEVICE_OBJECT v11; // r10
  unsigned __int16 v12; // dx
  __int64 v13; // rcx
  __int64 result; // rax
  __int128 v15; // [rsp+20h] [rbp-69h] BYREF
  __int128 v16; // [rsp+30h] [rbp-59h] BYREF
  __int128 v17; // [rsp+40h] [rbp-49h]
  __int64 v18; // [rsp+50h] [rbp-39h]
  char Dst[64]; // [rsp+60h] [rbp-29h] BYREF

  v18 = 0i64;
  v15 = 0i64;
  v16 = 0i64;
  v17 = 0i64;
  memset(Dst, 0, sizeof(Dst));
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x8Fu, (__int64)&unk_1400124B0);
  }
  *a6 = 8198;
  if ( sub_140005C1C() )
  {
    v10 = sub_140003FA4((__int64)a1, (__int64)&v16, 0i64);
    if ( v10 )
    {
      v11 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        goto LABEL_52;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
        goto LABEL_48;
      v12 = 145;
    }
    else
    {
      if ( BYTE3(v17) != 17 )
      {
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          goto LABEL_52;
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
          sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x92u, (__int64)&unk_1400124B0, BYTE3(v17));
        goto LABEL_48;
      }
      v10 = sub_140003E84(a2, &v15);
      if ( v10 )
      {
        v11 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          goto LABEL_52;
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
          goto LABEL_48;
        v12 = 147;
      }
      else
      {
        v10 = sub_140008CE0((__int64)&v16, (__int64)&v15);
        if ( !v10 )
        {
          if ( !sub_140005E68() )
          {
            v8 = DeviceObject;
            if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
              goto LABEL_52;
            if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) == 0
              || BYTE1(DeviceObject->Dpc.DeferredContext) < 5u )
            {
              goto LABEL_48;
            }
            v9 = 151;
            goto LABEL_47;
          }
          v10 = sub_140003BF4(a1, (__int64)&v15, (__int64)Dst);
          if ( !v10 )
          {
            sub_140004C3C((__int64)Dst);
            if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
              && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) != 0
              && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
            {
              sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x96u, (__int64)&unk_1400124B0);
            }
            sub_140007780(0, (__int64)Dst, 0x40u);
            goto LABEL_48;
          }
          if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
            goto LABEL_52;
          if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
            goto LABEL_48;
          v13 = DeviceObject->Dpc.ProcessorHistory;
          v12 = 149;
          goto LABEL_16;
        }
        v11 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          goto LABEL_52;
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
          goto LABEL_48;
        v12 = 148;
      }
    }
    v13 = v11->Dpc.ProcessorHistory;
LABEL_16:
    sub_1400059D0(v13, v12, (__int64)&unk_1400124B0, v10);
    goto LABEL_48;
  }
  v8 = DeviceObject;
  if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
    goto LABEL_52;
  if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
  {
    v9 = 144;
LABEL_47:
    sub_1400059A0(v8->Dpc.ProcessorHistory, v9, (__int64)&unk_1400124B0);
  }
LABEL_48:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x98u, (__int64)&unk_1400124B0);
  }
LABEL_52:
  result = sub_140009080((__int64)&v15);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x99u, (__int64)&unk_1400124B0);
  }
  return result;
}

//----- (0000000140002610) ----------------------------------------------------
__int64 __fastcall sub_140002610(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6)
{
  int v8; // eax
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  __int64 result; // rax
  __int128 v12; // [rsp+20h] [rbp-48h] BYREF
  __int128 v13; // [rsp+30h] [rbp-38h] BYREF
  __int128 v14; // [rsp+40h] [rbp-28h] BYREF
  __int64 v15; // [rsp+50h] [rbp-18h]

  v12 = 0i64;
  v13 = 0i64;
  v14 = 0i64;
  v15 = 0i64;
  *a6 = 8198;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xA6u, (__int64)&unk_1400124B0);
  }
  v8 = sub_140003FA4(a1, (__int64)&v13, (__int64)&v14 + 4);
  if ( !v8 )
  {
    v8 = sub_140003E84(a2, &v12);
    if ( !v8 )
      goto LABEL_16;
    v9 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      goto LABEL_20;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
      goto LABEL_16;
    v10 = 168;
    goto LABEL_15;
  }
  v9 = DeviceObject;
  if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
    goto LABEL_20;
  if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
  {
    v10 = 167;
LABEL_15:
    sub_1400059D0(v9->Dpc.ProcessorHistory, v10, (__int64)&unk_1400124B0, v8);
  }
LABEL_16:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xA9u, (__int64)&unk_1400124B0);
  }
LABEL_20:
  result = sub_140009080((__int64)&v12);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xAAu, (__int64)&unk_1400124B0);
  }
  return result;
}

//----- (00000001400027B0) ----------------------------------------------------
__int64 sub_1400027B0()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xABu, (__int64)&unk_1400124B0);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xACu, (__int64)&unk_1400124B0);
    }
  }
  return 0i64;
}

//----- (0000000140002840) ----------------------------------------------------
__int64 sub_140002840()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x9Au, (__int64)&unk_1400124B0);
  }
  if ( !sub_140005C1C() )
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return 0i64;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x9Bu, (__int64)&unk_1400124B0);
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x9Cu, (__int64)&unk_1400124B0);
  }
  return 0i64;
}

//----- (0000000140002910) ----------------------------------------------------
__int64 __fastcall sub_140002910(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6)
{
  int v8; // eax
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  __int64 result; // rax
  __int128 v12; // [rsp+20h] [rbp-48h] BYREF
  __int128 v13[2]; // [rsp+30h] [rbp-38h] BYREF
  __int64 v14; // [rsp+50h] [rbp-18h]

  v12 = 0i64;
  v13[0] = 0i64;
  v13[1] = 0i64;
  v14 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x9Du, (__int64)&unk_1400124B0);
  }
  *a6 = 8198;
  if ( sub_140005C1C() )
  {
    v8 = sub_140003FA4(a1, (__int64)v13, 0i64);
    if ( v8 )
    {
      v9 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        goto LABEL_25;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
        goto LABEL_21;
      v10 = 159;
    }
    else
    {
      v8 = sub_140003E84(a2, &v12);
      if ( !v8 )
        goto LABEL_21;
      v9 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        goto LABEL_25;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
        goto LABEL_21;
      v10 = 160;
    }
    sub_1400059D0(v9->Dpc.ProcessorHistory, v10, (__int64)&unk_1400124B0, v8);
  }
  else
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      goto LABEL_25;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x9Eu, (__int64)&unk_1400124B0);
  }
LABEL_21:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xA1u, (__int64)&unk_1400124B0);
  }
LABEL_25:
  result = sub_140009080((__int64)&v12);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xA2u, (__int64)&unk_1400124B0);
  }
  return result;
}

//----- (0000000140002AF0) ----------------------------------------------------
__int64 sub_140002AF0()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xA3u, (__int64)&unk_1400124B0);
  }
  if ( !sub_140005C1C() )
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return 0i64;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xA4u, (__int64)&unk_1400124B0);
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xA5u, (__int64)&unk_1400124B0);
  }
  return 0i64;
}

//----- (0000000140002BC0) ----------------------------------------------------
char __fastcall sub_140002BC0(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, _DWORD *a6)
{
  int v8; // eax
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  PDEVICE_OBJECT v11; // rcx
  unsigned __int16 v12; // dx
  __int128 v14; // [rsp+20h] [rbp-48h] BYREF
  __int128 v15[2]; // [rsp+30h] [rbp-38h] BYREF
  __int64 v16; // [rsp+50h] [rbp-18h]

  v14 = 0i64;
  v15[0] = 0i64;
  v15[1] = 0i64;
  v16 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x6Fu, (__int64)&unk_1400124B0);
  }
  *a6 = 8198;
  LOBYTE(v8) = sub_140005C1C();
  if ( (_BYTE)v8 )
  {
    v8 = sub_140003FA4(a1, (__int64)v15, 0i64);
    if ( v8 )
    {
      v11 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        return v8;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
        goto LABEL_41;
      v12 = 113;
    }
    else
    {
      v8 = sub_140009F44((__int64)v15);
      if ( !v8 )
        goto LABEL_41;
      if ( v8 == 5 )
      {
        v8 = sub_140003E84(a2, &v14);
        if ( v8 )
        {
          v11 = DeviceObject;
          if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
            return v8;
          if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
            goto LABEL_41;
          v12 = 115;
        }
        else
        {
          if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
            && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
            && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
          {
            sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x74u, (__int64)&unk_1400124B0);
          }
          sub_140009080((__int64)&v14);
          v8 = sub_140008CE0((__int64)v15, (__int64)&v14);
          if ( !v8 )
          {
            v9 = DeviceObject;
            if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
              return v8;
            v8 = HIDWORD(DeviceObject->Dpc.DeferredContext);
            if ( (v8 & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 4u )
              goto LABEL_41;
            v10 = 118;
            goto LABEL_40;
          }
          v11 = DeviceObject;
          if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
            return v8;
          if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
            goto LABEL_41;
          v12 = 117;
        }
      }
      else
      {
        v11 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          return v8;
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
          goto LABEL_41;
        v12 = 114;
      }
    }
    LOBYTE(v8) = sub_1400059D0(v11->Dpc.ProcessorHistory, v12, (__int64)&unk_1400124B0, v8);
  }
  else
  {
    v9 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return v8;
    v8 = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (v8 & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
    {
      v10 = 112;
LABEL_40:
      LOBYTE(v8) = sub_1400059A0(v9->Dpc.ProcessorHistory, v10, (__int64)&unk_1400124B0);
      goto LABEL_41;
    }
  }
LABEL_41:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    v8 = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (v8 & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      LOBYTE(v8) = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x77u, (__int64)&unk_1400124B0);
  }
  return v8;
}

//----- (0000000140002E80) ----------------------------------------------------
__int64 sub_140002E80()
{
  PDEVICE_OBJECT v0; // rcx
  unsigned __int16 v1; // dx

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x78u, (__int64)&unk_1400124B0);
  }
  if ( sub_140005C1C() )
  {
    v0 = DeviceObject;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      v1 = 122;
      goto LABEL_14;
    }
  }
  else
  {
    v0 = DeviceObject;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
    {
      v1 = 121;
LABEL_14:
      sub_1400059A0(v0->Dpc.ProcessorHistory, v1, (__int64)&unk_1400124B0);
      return 0i64;
    }
  }
  return 0i64;
}

//----- (0000000140002F34) ----------------------------------------------------
__int64 __fastcall sub_140002F34(void *a1)
{
  int v2; // eax
  int v3; // ebx
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  FWPM_PROVIDER0 provider; // [rsp+30h] [rbp-D0h] BYREF
  FWPM_SUBLAYER0 subLayer; // [rsp+70h] [rbp-90h] BYREF
  FWPM_SESSION0 session; // [rsp+C0h] [rbp-40h] BYREF

  *(_QWORD *)(&provider.flags + 1) = 0i64;
  *(FWP_BYTE_BLOB *)((char *)&provider.providerData + 4) = 0ui64;
  HIDWORD(provider.serviceName) = 0;
  memset(&subLayer, 0, sizeof(subLayer));
  memset(&session, 0, sizeof(session));
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x22u, (__int64)&unk_1400124B0);
  }
  provider.flags = 0;
  provider.displayData.name = L"Panda Security, S.L.";
  provider.displayData.description = L"Nano Network Security";
  session.flags = 1;
  provider.providerKey = (GUID)xmmword_140012620;
  v2 = FwpmEngineOpen0(0i64, 0xAu, 0i64, &session, &engineHandle);
  v3 = v2;
  if ( v2 >= 0 )
  {
    v3 = FwpmTransactionBegin0(engineHandle, 0);
    if ( v3 < 0 )
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
      {
        sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x24u, (__int64)&unk_1400124B0, v3);
      }
      goto LABEL_139;
    }
    v3 = FwpmProviderAdd0(engineHandle, &provider, 0i64);
    if ( (int)(v3 + 0x80000000) < 0 || v3 == -1071513591 )
    {
      subLayer.providerKey = (GUID *)&provider;
      subLayer.flags = 0;
      subLayer.displayData.name = L"PIHS WFP Sub-Layer";
      subLayer.weight = 0;
      subLayer.displayData.description = L"Sub-Layer for use by PIHS WFP callouts";
      subLayer.subLayerKey = (GUID)xmmword_140012610;
      v3 = FwpmSubLayerAdd0(engineHandle, &subLayer, 0i64);
      if ( (int)(v3 + 0x80000000) < 0 || v3 == -1071513591 )
      {
        v3 = sub_140004340(&qword_1400127C0, &stru_1400124C0, a1, (int *)&calloutId);
        if ( v3 >= 0 )
        {
          v3 = sub_140004340(&qword_1400126D0, &stru_1400124D0, a1, (int *)&dword_14001409C);
          if ( v3 >= 0 )
          {
            v3 = sub_140004340(&qword_140012790, &stru_1400124E0, a1, (int *)&dword_1400140A0);
            if ( v3 >= 0 )
            {
              v3 = sub_140004340(&qword_140012820, &stru_140012540, a1, (int *)&dword_1400140D0);
              if ( v3 >= 0 )
              {
                v3 = sub_140004340(&qword_1400127E0, &stru_140012550, a1, (int *)&dword_1400140D4);
                if ( v3 >= 0 )
                {
                  v3 = sub_140004340(&qword_140012800, &stru_1400124F0, a1, (int *)dword_1400140A4);
                  if ( v3 >= 0 )
                  {
                    v3 = sub_140004340(&qword_1400126A0, &stru_140012560, a1, (int *)&dword_1400140E8);
                    if ( v3 >= 0 )
                    {
                      v3 = sub_140004340(&qword_140012780, &stru_140012580, a1, (int *)&dword_1400140F0);
                      if ( v3 >= 0 )
                      {
                        v3 = sub_140004340(&qword_140012740, &stru_140012570, a1, (int *)&dword_1400140EC);
                        if ( v3 >= 0 )
                        {
                          v3 = sub_140004340(&qword_1400127F0, &stru_140012500, a1, (int *)&dword_1400140AC);
                          if ( v3 >= 0 )
                          {
                            v3 = sub_140004340(&qword_140012690, &stru_140012510, a1, (int *)&dword_1400140B0);
                            if ( v3 >= 0 )
                            {
                              v3 = sub_140004340(&xmmword_140012760, &stru_140012520, a1, (int *)&dword_1400140B4);
                              if ( v3 >= 0 )
                              {
                                v3 = sub_140004340(&qword_140012850, &stru_140012530, a1, (int *)&dword_1400140B8);
                                if ( v3 >= 0 )
                                {
                                  v3 = sub_140004340(&qword_1400126B0, &stru_1400125C0, a1, (int *)&dword_1400140E0);
                                  if ( v3 >= 0 )
                                  {
                                    v3 = sub_140004340(&qword_1400126C0, &stru_1400125D0, a1, (int *)&dword_1400140E4);
                                    if ( v3 >= 0 )
                                    {
                                      v3 = sub_140004340(&qword_1400126E0, &stru_140012590, a1, (int *)&dword_1400140F4);
                                      if ( v3 >= 0 )
                                      {
                                        v3 = sub_140004340(
                                               &qword_140012770,
                                               &stru_1400125B0,
                                               a1,
                                               (int *)&dword_1400140FC);
                                        if ( v3 >= 0 )
                                        {
                                          v3 = sub_140004340(
                                                 &qword_140012720,
                                                 &stru_1400125F0,
                                                 a1,
                                                 (int *)&dword_140014100);
                                          if ( v3 >= 0 )
                                          {
                                            v3 = sub_140004340(
                                                   &qword_1400126F0,
                                                   &stru_140012600,
                                                   a1,
                                                   (int *)&dword_140014104);
                                            if ( v3 >= 0 )
                                            {
                                              v3 = sub_140004340(
                                                     &qword_1400127B0,
                                                     &stru_1400125A0,
                                                     a1,
                                                     (int *)&dword_1400140F8);
                                              if ( v3 >= 0 )
                                              {
                                                v3 = sub_140004340(
                                                       &qword_1400127D0,
                                                       &stru_1400125E0,
                                                       a1,
                                                       (int *)&dword_1400140D8);
                                                if ( v3 >= 0 )
                                                {
                                                  v3 = FwpmTransactionCommit0(engineHandle);
                                                  if ( v3 >= 0 )
                                                    goto LABEL_140;
                                                  v4 = DeviceObject;
                                                  if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                                                    || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                                                    || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                                                  {
                                                    goto LABEL_138;
                                                  }
                                                  v5 = 65;
                                                }
                                                else
                                                {
                                                  v4 = DeviceObject;
                                                  if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                                                    || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                                                    || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                                                  {
                                                    goto LABEL_138;
                                                  }
                                                  v5 = 64;
                                                }
                                              }
                                              else
                                              {
                                                v4 = DeviceObject;
                                                if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                                                  || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                                                  || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                                                {
                                                  goto LABEL_138;
                                                }
                                                v5 = 63;
                                              }
                                            }
                                            else
                                            {
                                              v4 = DeviceObject;
                                              if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                                                || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                                                || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                                              {
                                                goto LABEL_138;
                                              }
                                              v5 = 62;
                                            }
                                          }
                                          else
                                          {
                                            v4 = DeviceObject;
                                            if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                                              || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                                              || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                                            {
                                              goto LABEL_138;
                                            }
                                            v5 = 61;
                                          }
                                        }
                                        else
                                        {
                                          v4 = DeviceObject;
                                          if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                                            || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                                            || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                                          {
                                            goto LABEL_138;
                                          }
                                          v5 = 60;
                                        }
                                      }
                                      else
                                      {
                                        v4 = DeviceObject;
                                        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                                          || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                                          || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                                        {
                                          goto LABEL_138;
                                        }
                                        v5 = 59;
                                      }
                                    }
                                    else
                                    {
                                      v4 = DeviceObject;
                                      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                                        || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                                        || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                                      {
                                        goto LABEL_138;
                                      }
                                      v5 = 58;
                                    }
                                  }
                                  else
                                  {
                                    v4 = DeviceObject;
                                    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                                      || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                                      || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                                    {
                                      goto LABEL_138;
                                    }
                                    v5 = 57;
                                  }
                                }
                                else
                                {
                                  v4 = DeviceObject;
                                  if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                                    || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                                    || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                                  {
                                    goto LABEL_138;
                                  }
                                  v5 = 56;
                                }
                              }
                              else
                              {
                                v4 = DeviceObject;
                                if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                                  || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                                  || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                                {
                                  goto LABEL_138;
                                }
                                v5 = 55;
                              }
                            }
                            else
                            {
                              v4 = DeviceObject;
                              if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                                || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                                || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                              {
                                goto LABEL_138;
                              }
                              v5 = 54;
                            }
                          }
                          else
                          {
                            v4 = DeviceObject;
                            if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                              || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                              || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                            {
                              goto LABEL_138;
                            }
                            v5 = 53;
                          }
                        }
                        else
                        {
                          v4 = DeviceObject;
                          if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                            || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                            || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                          {
                            goto LABEL_138;
                          }
                          v5 = 47;
                        }
                      }
                      else
                      {
                        v4 = DeviceObject;
                        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                          || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                          || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                        {
                          goto LABEL_138;
                        }
                        v5 = 46;
                      }
                    }
                    else
                    {
                      v4 = DeviceObject;
                      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                        || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                        || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                      {
                        goto LABEL_138;
                      }
                      v5 = 45;
                    }
                  }
                  else
                  {
                    v4 = DeviceObject;
                    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                      || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                      || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                    {
                      goto LABEL_138;
                    }
                    v5 = 44;
                  }
                }
                else
                {
                  v4 = DeviceObject;
                  if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                    || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                    || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                  {
                    goto LABEL_138;
                  }
                  v5 = 43;
                }
              }
              else
              {
                v4 = DeviceObject;
                if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                  || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                  || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
                {
                  goto LABEL_138;
                }
                v5 = 42;
              }
            }
            else
            {
              v4 = DeviceObject;
              if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
                || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
                || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
              {
                goto LABEL_138;
              }
              v5 = 41;
            }
          }
          else
          {
            v4 = DeviceObject;
            if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
              || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
              || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
            {
              goto LABEL_138;
            }
            v5 = 40;
          }
        }
        else
        {
          v4 = DeviceObject;
          if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
            || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
            || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
          {
            goto LABEL_138;
          }
          v5 = 39;
        }
      }
      else
      {
        v4 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
          || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
          || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
        {
          goto LABEL_138;
        }
        v5 = 38;
      }
    }
    else
    {
      v4 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
        || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
        || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_138;
      }
      v5 = 37;
    }
    sub_1400059D0(v4->Dpc.ProcessorHistory, v5, (__int64)&unk_1400124B0, v3);
LABEL_138:
    FwpmTransactionAbort0(engineHandle);
LABEL_139:
    FwpmEngineClose0(engineHandle);
    engineHandle = 0i64;
    goto LABEL_140;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
  {
    sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x23u, (__int64)&unk_1400124B0, v2);
  }
LABEL_140:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x42u, (__int64)&unk_1400124B0);
  }
  return (unsigned int)v3;
}
// 140011640: using guessed type wchar_t aPandaSecurityS[21];
// 140011670: using guessed type wchar_t aNanoNetworkSec[22];
// 1400116A0: using guessed type wchar_t aPihsWfpSubLaye[19];
// 1400116D0: using guessed type wchar_t aSubLayerForUse[39];
// 140012610: using guessed type __int128 xmmword_140012610;
// 140012620: using guessed type __int128 xmmword_140012620;
// 140012690: using guessed type __int64 qword_140012690;
// 1400126A0: using guessed type __int64 qword_1400126A0;
// 1400126B0: using guessed type __int64 qword_1400126B0;
// 1400126C0: using guessed type __int64 qword_1400126C0;
// 1400126D0: using guessed type __int64 qword_1400126D0;
// 1400126E0: using guessed type __int64 qword_1400126E0;
// 1400126F0: using guessed type __int64 qword_1400126F0;
// 140012720: using guessed type __int64 qword_140012720;
// 140012740: using guessed type __int64 qword_140012740;
// 140012760: using guessed type __int128 xmmword_140012760;
// 140012770: using guessed type __int64 qword_140012770;
// 140012780: using guessed type __int64 qword_140012780;
// 140012790: using guessed type __int64 qword_140012790;
// 1400127B0: using guessed type __int64 qword_1400127B0;
// 1400127C0: using guessed type __int64 qword_1400127C0;
// 1400127D0: using guessed type __int64 qword_1400127D0;
// 1400127E0: using guessed type __int64 qword_1400127E0;
// 1400127F0: using guessed type __int64 qword_1400127F0;
// 140012800: using guessed type __int64 qword_140012800;
// 140012820: using guessed type __int64 qword_140012820;
// 140012850: using guessed type __int64 qword_140012850;

//----- (00000001400039D0) ----------------------------------------------------
int sub_1400039D0()
{
  int result; // eax

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x43u, (__int64)&unk_1400124B0);
  }
  FwpmEngineClose0(engineHandle);
  FwpsCalloutUnregisterById0(calloutId);
  FwpsCalloutUnregisterById0(dword_14001409C);
  FwpsCalloutUnregisterById0(dword_1400140A0);
  FwpsCalloutUnregisterById0(dword_1400140A4[0]);
  FwpsCalloutUnregisterById0(dword_1400140C4);
  FwpsCalloutUnregisterById0(dword_1400140CC);
  FwpsCalloutUnregisterById0(dword_1400140D0);
  FwpsCalloutUnregisterById0(dword_1400140D4);
  FwpsCalloutUnregisterById0(dword_1400140E8);
  FwpsCalloutUnregisterById0(dword_1400140EC);
  FwpsCalloutUnregisterById0(dword_1400140F0);
  FwpsCalloutUnregisterById0(dword_1400140D8);
  FwpsCalloutUnregisterById0(dword_1400140AC);
  FwpsCalloutUnregisterById0(dword_1400140B0);
  FwpsCalloutUnregisterById0(dword_1400140B4);
  FwpsCalloutUnregisterById0(dword_1400140B8);
  FwpsCalloutUnregisterById0(dword_1400140C0);
  FwpsCalloutUnregisterById0(dword_1400140C8);
  FwpsCalloutUnregisterById0(dword_1400140E0);
  FwpsCalloutUnregisterById0(dword_1400140E4);
  FwpsCalloutUnregisterById0(dword_1400140F4);
  FwpsCalloutUnregisterById0(dword_1400140F8);
  FwpsCalloutUnregisterById0(dword_1400140FC);
  FwpsCalloutUnregisterById0(dword_140014100);
  result = FwpsCalloutUnregisterById0(dword_140014104);
  engineHandle = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x44u, (__int64)&unk_1400124B0);
  }
  return result;
}

//----- (0000000140003B78) ----------------------------------------------------
__int64 __fastcall sub_140003B78(__int16 a1)
{
  __int64 result; // rax

  switch ( a1 )
  {
    case 12:
    case 16:
    case 20:
    case 21:
    case 36:
    case 37:
    case 40:
    case 41:
    case 44:
    case 45:
    case 48:
    case 49:
    case 62:
    case 64:
      result = 2i64;
      break;
    case 14:
    case 18:
    case 22:
    case 23:
    case 38:
    case 39:
    case 42:
    case 43:
    case 46:
    case 47:
    case 50:
    case 51:
    case 63:
    case 65:
      result = 23i64;
      break;
    default:
      result = 0i64;
      break;
  }
  return result;
}

//----- (0000000140003BF4) ----------------------------------------------------
__int64 __fastcall sub_140003BF4(__int16 *a1, __int64 a2, __int64 a3)
{
  unsigned int v3; // ebx
  __int16 v4; // ax
  _DWORD *v5; // rax
  int v6; // eax
  _DWORD *v7; // rax

  v3 = 0;
  if ( !a1 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_140005BE0(DeviceObject->Dpc.ProcessorHistory, 0xD1u, (__int64)&unk_1400124B0, 0i64);
    }
    v3 = 4;
    goto LABEL_20;
  }
  *(_QWORD *)a3 = *(_QWORD *)a2;
  *(_QWORD *)(a3 + 8) = *(_QWORD *)(a2 + 8);
  *(_DWORD *)(a3 + 20) = *(unsigned __int16 *)(a2 + 32);
  *(_OWORD *)(a3 + 24) = *(_OWORD *)(a2 + 16);
  *(_OWORD *)(a3 + 24) = *(_OWORD *)(a2 + 16);
  *(_BYTE *)(a3 + 16) = *(_BYTE *)(a2 + 34);
  *(_BYTE *)(a3 + 17) = *(_BYTE *)(a2 + 35);
  v4 = *a1;
  if ( *a1 == 36 || v4 == 38 )
  {
    v7 = (_DWORD *)*((_QWORD *)a1 + 1);
    if ( v7[48] )
    {
      *(_DWORD *)(a3 + 44) = v7[50];
      v7 = (_DWORD *)*((_QWORD *)a1 + 1);
    }
    if ( v7[36] == 3 )
    {
      v6 = v7[38];
      goto LABEL_19;
    }
  }
  else if ( v4 == 40 || v4 == 42 )
  {
    v5 = (_DWORD *)*((_QWORD *)a1 + 1);
    if ( v5[40] )
    {
      *(_DWORD *)(a3 + 44) = v5[42];
      v5 = (_DWORD *)*((_QWORD *)a1 + 1);
    }
    if ( v5[28] == 3 )
    {
      v6 = v5[30];
LABEL_19:
      *(_DWORD *)(a3 + 40) = v6;
      goto LABEL_20;
    }
  }
LABEL_20:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xD2u, (__int64)&unk_1400124B0);
  }
  return v3;
}

//----- (0000000140003D3C) ----------------------------------------------------
_DWORD *__fastcall sub_140003D3C(unsigned __int16 a1, _DWORD *a2, _DWORD *a3, _DWORD *a4, _DWORD *a5, _DWORD *a6)
{
  _DWORD *result; // rax

  if ( a1 <= 0x2Bu )
  {
    if ( a1 >= 0x2Au )
    {
LABEL_13:
      *a2 = 2;
      *a3 = -1;
      *a4 = 4;
LABEL_14:
      *a5 = -1;
LABEL_15:
      result = a6;
      *a6 = -1;
      return result;
    }
    if ( a1 <= 0x15u )
    {
      if ( a1 < 0x14u )
      {
        if ( ((a1 - 12) & 0xFFFFFFFD) == 0 )
        {
          *a2 = 1;
          *a3 = 2;
          goto LABEL_9;
        }
        if ( ((a1 - 16) & 0xFFFFFFFD) == 0 )
        {
          *a2 = 1;
          *a3 = 3;
LABEL_9:
          *a4 = 4;
          *a5 = 5;
          result = a6;
          *a6 = 0;
          return result;
        }
        goto LABEL_24;
      }
LABEL_16:
      *a2 = 0;
      *a3 = 2;
      *a4 = 3;
      *a5 = 4;
      goto LABEL_15;
    }
    if ( a1 <= 0x17u )
      goto LABEL_16;
    if ( a1 > 0x23u )
    {
      if ( a1 >= 0x28u )
        goto LABEL_13;
      goto LABEL_25;
    }
LABEL_24:
    *a2 = -1;
    *a3 = -1;
    *a4 = -1;
    goto LABEL_14;
  }
  if ( a1 > 0x3Eu )
  {
    if ( a1 != 63 )
    {
      if ( a1 != 64 && a1 != 65 )
        goto LABEL_24;
      goto LABEL_20;
    }
LABEL_25:
    *a2 = 2;
    *a3 = -1;
    *a4 = 4;
    *a5 = -1;
    goto LABEL_26;
  }
  if ( a1 == 62 )
    goto LABEL_25;
  if ( a1 >= 0x34u )
    goto LABEL_24;
LABEL_20:
  *a2 = 2;
  *a3 = 6;
  *a4 = 4;
  *a5 = 7;
LABEL_26:
  result = a6;
  *a6 = 5;
  return result;
}

//----- (0000000140003E84) ----------------------------------------------------
__int64 __fastcall sub_140003E84(__int64 a1, _QWORD *a2)
{
  HANDLE v4; // r9
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx
  HANDLE v7; // rax

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xC0u, (__int64)&unk_1400124B0);
  }
  if ( (*(_DWORD *)a1 & 0x20) != 0 )
  {
    v4 = *(HANDLE *)(a1 + 64);
    *a2 = v4;
    v5 = DeviceObject;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
    {
      v6 = 193;
LABEL_14:
      sub_140005BE0(v5->Dpc.ProcessorHistory, v6, (__int64)&unk_1400124B0, v4);
      goto LABEL_15;
    }
  }
  else
  {
    v7 = PsGetCurrentProcessId();
    *a2 = v7;
    v5 = DeviceObject;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
    {
      v6 = 194;
      v4 = v7;
      goto LABEL_14;
    }
  }
LABEL_15:
  a2[1] = PsGetCurrentThreadId();
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xC3u, (__int64)&unk_1400124B0);
  }
  return 0i64;
}

//----- (0000000140003FA4) ----------------------------------------------------
__int64 __fastcall sub_140003FA4(__int64 a1, __int64 a2, __int64 a3)
{
  unsigned int v3; // edi
  __int16 v7; // bx
  __int64 v8; // rcx
  __int64 v9; // rcx
  __int64 v10; // rcx
  PDEVICE_OBJECT v11; // rcx
  unsigned __int16 v12; // dx
  __int64 v13; // rcx
  PDEVICE_OBJECT v14; // rcx
  unsigned __int16 v15; // dx
  __int64 v16; // rdx
  unsigned int v18; // [rsp+30h] [rbp-10h] BYREF
  unsigned int v19; // [rsp+34h] [rbp-Ch] BYREF
  unsigned int v20; // [rsp+38h] [rbp-8h] BYREF
  unsigned int v21; // [rsp+70h] [rbp+30h] BYREF
  unsigned int v22; // [rsp+88h] [rbp+48h] BYREF

  v3 = 0;
  v21 = 0;
  v22 = 0;
  v18 = 0;
  v19 = 0;
  v20 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xB7u, (__int64)&unk_1400124B0);
  }
  if ( a1 && a2 )
  {
    v7 = *(_WORD *)a1;
    sub_140003D3C(*(_WORD *)a1, &v21, &v22, &v18, &v19, &v20);
    if ( (unsigned __int16)sub_140003B78(v7) == 2 )
    {
      *(_BYTE *)(a2 + 18) = 4;
      if ( v21 != -1 )
        sub_14000D628((_DWORD *)a2, (char *)(16i64 * v21 + 8 + *(_QWORD *)(a1 + 8)), 4);
      if ( a3 )
      {
        *(_BYTE *)(a3 + 18) = 4;
        if ( v22 != -1 )
          sub_14000D628((_DWORD *)a3, (char *)(16i64 * v22 + 8 + *(_QWORD *)(a1 + 8)), 4);
      }
    }
    else
    {
      *(_BYTE *)(a2 + 18) = 6;
      if ( v21 != -1 )
      {
        v8 = *(_QWORD *)(a1 + 8);
        if ( *(_DWORD *)(v8 + 16i64 * v21) )
        {
          *(_OWORD *)a2 = *(_OWORD *)*(_QWORD *)(v8 + 16i64 * v21 + 8);
        }
        else if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
               && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
               && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
        {
          sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xB9u, (__int64)&unk_1400124B0);
        }
      }
      if ( a3 )
      {
        *(_BYTE *)(a3 + 18) = 6;
        if ( v22 != -1 )
        {
          v9 = *(_QWORD *)(a1 + 8);
          if ( *(_DWORD *)(v9 + 16i64 * v22) )
          {
            *(_OWORD *)a3 = *(_OWORD *)*(_QWORD *)(v9 + 16i64 * v22 + 8);
          }
          else if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
                 && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
                 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
          {
            sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xBAu, (__int64)&unk_1400124B0);
          }
        }
      }
    }
    if ( v18 == -1 )
    {
      v11 = DeviceObject;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      {
        v12 = 188;
        goto LABEL_39;
      }
    }
    else
    {
      v10 = *(_QWORD *)(a1 + 8);
      if ( *(_DWORD *)(v10 + 16i64 * v18) )
      {
        *(_WORD *)(a2 + 16) = *(_WORD *)(v10 + 16i64 * v18 + 8);
        goto LABEL_40;
      }
      v11 = DeviceObject;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      {
        v12 = 187;
LABEL_39:
        sub_1400059A0(v11->Dpc.ProcessorHistory, v12, (__int64)&unk_1400124B0);
        goto LABEL_40;
      }
    }
LABEL_40:
    if ( v19 == -1 )
    {
      v14 = DeviceObject;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      {
        v15 = 190;
        goto LABEL_52;
      }
    }
    else
    {
      v13 = *(_QWORD *)(a1 + 8);
      if ( *(_DWORD *)(v13 + 16i64 * v19) )
      {
        if ( a3 )
          *(_WORD *)(a3 + 16) = *(_WORD *)(v13 + 16i64 * v19 + 8);
        goto LABEL_53;
      }
      v14 = DeviceObject;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      {
        v15 = 189;
LABEL_52:
        sub_1400059A0(v14->Dpc.ProcessorHistory, v15, (__int64)&unk_1400124B0);
        goto LABEL_53;
      }
    }
LABEL_53:
    if ( v20 != -1 )
    {
      v16 = 2i64 * v20;
      *(_BYTE *)(a2 + 19) = *(_BYTE *)(*(_QWORD *)(a1 + 8) + 16i64 * v20 + 8);
      if ( a3 )
        *(_BYTE *)(a3 + 19) = *(_BYTE *)(*(_QWORD *)(a1 + 8) + 8 * v16 + 8);
    }
    goto LABEL_61;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
  {
    sub_140005B30(DeviceObject->Dpc.ProcessorHistory, 0xB8u, (__int64)&unk_1400124B0, a1, a2);
  }
  v3 = 4;
LABEL_61:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xBFu, (__int64)&unk_1400124B0);
  }
  return v3;
}

//----- (0000000140004340) ----------------------------------------------------
__int64 __fastcall sub_140004340(_QWORD *a1, GUID *a2, void *a3, int *a4)
{
  GUID v8; // xmm0
  bool v9; // zf
  __int64 (*v10)(); // rax
  NTSTATUS v11; // eax
  int v12; // edi
  PDEVICE_OBJECT v13; // rcx
  unsigned __int16 v14; // dx
  int v15; // er9
  GUID v16; // xmm0
  GUID v17; // xmm0
  PDEVICE_OBJECT v18; // rcx
  unsigned __int16 v19; // dx
  PDEVICE_OBJECT v20; // rcx
  unsigned __int16 v21; // dx
  GUID v22; // xmm0
  FWPM_ACTION0_::$6EA882394A24E7F0D0D0A8FACB4240B6 v23; // xmm0
  FWPS_CALLOUT0 v25; // [rsp+20h] [rbp-E0h] BYREF
  FWPS_CALLOUT1 callout; // [rsp+50h] [rbp-B0h] BYREF
  FWPM_CALLOUT0 Dst; // [rsp+80h] [rbp-80h] BYREF
  FWPM_FILTER0 filter; // [rsp+E0h] [rbp-20h] BYREF
  FWPM_FILTER0 v29; // [rsp+1B0h] [rbp+B0h] BYREF
  __int128 v30[8]; // [rsp+280h] [rbp+180h] BYREF

  *(_QWORD *)&v25.flags = 0i64;
  v25.classifyFn = 0i64;
  v25.notifyFn = 0i64;
  v25.flowDeleteFn = 0i64;
  memset(&Dst, 0, sizeof(Dst));
  callout.calloutKey = 0i64;
  *(_OWORD *)&callout.flags = 0i64;
  *(_OWORD *)&callout.notifyFn = 0i64;
  memset(&v29, 0, sizeof(v29));
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x45u, (__int64)&unk_1400124B0);
  }
  v8 = *a2;
  v9 = *a1 == 0x4C3305A7C38D57D1i64;
  v25.calloutKey = *a2;
  if ( v9 && a1[1] == 0x820EE6EEBC7F4F90ui64 || *a1 == 0x44BC319F4A72393Bi64 && a1[1] == 0xB4B6B3DC54BAC384ui64 )
  {
    v25.classifyFn = (FWPS_CALLOUT_CLASSIFY_FN0)sub_140001000;
    v10 = sub_140001520;
LABEL_67:
    v25.notifyFn = (FWPS_CALLOUT_NOTIFY_FN0)v10;
    goto LABEL_68;
  }
  if ( *a1 == 0x4AD6F5BAD632A801i64 && a1[1] == 0x6A83D9177060E396i64
    || *a1 == 0x4E33C9A3C97BC3B8i64 && a1[1] == 0x9DED4AA178E9586i64 )
  {
    v25.classifyFn = (FWPS_CALLOUT_CLASSIFY_FN0)sub_140001230;
    v10 = sub_140001450;
    goto LABEL_67;
  }
  if ( *a1 == 0x4273F4B5E1CD9FE7i64 && a1[1] == 0x50867B482E59C096i64
    || *a1 == 0x46729F04A3B42C97i64 && a1[1] == 0x7F2583C4E9CE7EB8i64 )
  {
    v25.classifyFn = (FWPS_CALLOUT_CLASSIFY_FN0)sub_140001F20;
    v10 = sub_1400021B0;
    goto LABEL_67;
  }
  if ( *a1 == 0x4227BD229EEAA99Bi64 && a1[1] == 0xB15733C673009F91ui64
    || *a1 == 0x453FDBE189455B97i64 && a1[1] == 0x96F35A89DA1324A2ui64 )
  {
    v25.classifyFn = (FWPS_CALLOUT_CLASSIFY_FN0)sub_140002000;
    v10 = sub_1400020E0;
    goto LABEL_67;
  }
  if ( *a1 == 0x46E2D21409E61AEAi64 && a1[1] == 0xC8282F0B6BB2219Bui64
    || *a1 == 0x4655013FE1735BDEi64 && a1[1] == 0xF02D76159EA451B3ui64
    || *a1 == 0x4426E3CF5926DFC8i64 && a1[1] == 0x9D0F5D3F39DC83A2ui64
    || *a1 == 0x4B90FC23634A869Fi64 && a1[1] == 0x6FAE360A62BFC1B0i64 )
  {
    v25.classifyFn = (FWPS_CALLOUT_CLASSIFY_FN0)sub_140002BC0;
    v10 = sub_140002E80;
    goto LABEL_67;
  }
  if ( *a1 == 0x422776D788BB5DADi64 && a1[1] == 0x7EBED73E0ADF719Ci64
    || *a1 == 0x481417DD7AC9DE24i64 && a1[1] == 0x1B325AC9FBA9BDB4i64 )
  {
    v25.classifyFn = (FWPS_CALLOUT_CLASSIFY_FN0)sub_1400018E0;
    v10 = sub_140001E50;
    goto LABEL_67;
  }
  if ( *a1 == 0x45FD9F26371DFADAi64 && a1[1] == 0x3F8912B29EC2EBB4i64
    || *a1 == 0x48E963C860703B07i64 && a1[1] == 0x17A640AFB112A3ADi64 )
  {
    v25.classifyFn = (FWPS_CALLOUT_CLASSIFY_FN0)sub_140001C20;
    v10 = sub_140001DC0;
    goto LABEL_67;
  }
  if ( *a1 == 0x4A150B601247D66Di64 && a1[1] == 0xC3AF5D05571448Di64
    || *a1 == 0x4ECA5F0A55A650E1i64 && a1[1] == 0x8CAA263BF58853A6ui64 )
  {
    v25.classifyFn = (FWPS_CALLOUT_CLASSIFY_FN0)sub_140002280;
    v10 = sub_140002840;
    goto LABEL_67;
  }
  if ( *a1 == 0x401ACCB074365CCEi64 && a1[1] == 0x157EAD3499B8C1BFi64
    || *a1 == 0x4E13EDCCF4E5CE80i64 && a1[1] == 0x7B05BB5414B92F8Ai64 )
  {
    v25.classifyFn = (FWPS_CALLOUT_CLASSIFY_FN0)sub_140002910;
    v10 = sub_140002AF0;
    goto LABEL_67;
  }
  if ( (*a1 != 0x467AE2A2B4766427i64 || a1[1] != 0x95AD81BCDDB7EBDi64)
    && (*a1 != 0x4BA94755BB536CCDi64 || a1[1] != 0x7B9C69F8EDF9F79Fi64) )
  {
    if ( *a1 == 0x4ECAC3FF0B5812A2i64 && a1[1] == 0x2263AC209EC78DB8i64
      || *a1 == 0x4C1AC51FCBC998BBi64 && a1[1] == 0x2FABACFC75974FBBi64 )
    {
      v25.classifyFn = (FWPS_CALLOUT_CLASSIFY_FN0)sub_140002610;
      v10 = sub_1400027B0;
    }
    else
    {
      if ( *a1 != 0x4870D6DB694673BCi64 || a1[1] != 0xB2F4B7BDCD0AEEADui64 )
      {
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
          && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
        {
          sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x46u, (__int64)&unk_1400124B0, *a4);
        }
        v12 = -1073741822;
        goto LABEL_118;
      }
      v25.classifyFn = (FWPS_CALLOUT_CLASSIFY_FN0)sub_140005380;
      v10 = sub_140005560;
    }
    goto LABEL_67;
  }
  callout.classifyFn = (FWPS_CALLOUT_CLASSIFY_FN1)sub_1400015F0;
  callout.notifyFn = (FWPS_CALLOUT_NOTIFY_FN1)sub_140001850;
LABEL_68:
  if ( !callout.classifyFn || !callout.notifyFn )
  {
    v12 = FwpsCalloutRegister0(a3, &v25, (UINT32 *)a4);
    if ( v12 < 0 )
    {
      v13 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        return (unsigned int)v12;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
        goto LABEL_118;
      v14 = 72;
      v15 = v12;
      goto LABEL_75;
    }
LABEL_81:
    v16 = *a2;
    Dst.displayData.name = L"PIHS WFP ALE Classify Callout";
    Dst.calloutKey = v16;
    v17 = *(GUID *)a1;
    Dst.displayData.description = L"Intercepts inbound or outbound connect and traffic attempts";
    Dst.applicableLayer = v17;
    Dst.providerKey = (GUID *)&xmmword_140012620;
    v12 = FwpmCalloutAdd0(engineHandle, &Dst, 0i64, 0i64);
    if ( v12 < 0 )
    {
      v18 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
        || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
        || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_112;
      }
      v19 = 74;
      goto LABEL_111;
    }
    if ( *a1 == 0x46729F04A3B42C97i64 && a1[1] == 0x7F2583C4E9CE7EB8i64 )
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      {
        sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x4Bu, (__int64)&unk_1400124B0);
      }
      memset(&filter, 0, sizeof(filter));
      filter.action.type = 4098;
      filter.weight.type = FWP_UINT8;
      filter.displayData.name = L"Teredo Filter for Application Specific Permit";
      filter.layerKey = (GUID)xmmword_140012760;
      filter.displayData.description = L"Implement Teredo Filter for Application Specific Permit at the Recv Accept layer";
      filter.weight.uint8 = 15;
      filter.filterCondition = (FWPM_FILTER_CONDITION0 *)v30;
      filter.subLayerKey = (GUID)xmmword_140012730;
      filter.numFilterConditions = 3;
      memset(v30, 0, 0x78ui64);
      LODWORD(v30[1]) = 0;
      DWORD2(v30[3]) = 0;
      v30[0] = xmmword_140012700;
      DWORD2(v30[1]) = 3;
      LODWORD(v30[2]) = 131;
      LODWORD(v30[4]) = 3;
      *(__int128 *)((char *)&v30[2] + 8) = xmmword_140012750;
      DWORD2(v30[4]) = 14;
      LODWORD(v30[6]) = 8;
      DWORD2(v30[6]) = 3;
      v30[5] = xmmword_140012710;
      LOWORD(v30[7]) = 1;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      {
        sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x4Cu, (__int64)&unk_1400124B0);
      }
      if ( FwpmFilterAdd0(engineHandle, &filter, 0i64, 0i64) >= 0 )
      {
        v20 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
          || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
          || BYTE1(DeviceObject->Dpc.DeferredContext) < 5u )
        {
          goto LABEL_106;
        }
        v21 = 78;
      }
      else
      {
        v20 = DeviceObject;
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
          || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
          || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
        {
          goto LABEL_106;
        }
        v21 = 77;
      }
      sub_1400059A0(v20->Dpc.ProcessorHistory, v21, (__int64)&unk_1400124B0);
    }
LABEL_106:
    v22 = *(GUID *)a1;
    v29.weight.type = FWP_EMPTY;
    v29.displayData.name = L"PIHS WFP ALE Classify Callout";
    v29.layerKey = v22;
    v23 = *(FWPM_ACTION0_::$6EA882394A24E7F0D0D0A8FACB4240B6 *)a2;
    v29.displayData.description = L"Intercepts inbound or outbound connect and traffic attempts";
    v29.action.type = 24580;
    v29.action.4 = v23;
    v29.providerKey = (GUID *)&xmmword_140012620;
    v29.subLayerKey = (GUID)xmmword_140012610;
    v12 = FwpmFilterAdd0(engineHandle, &v29, 0i64, 0i64);
    if ( v12 >= 0 )
      goto LABEL_118;
    v18 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0
      || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
    {
LABEL_112:
      FwpsCalloutUnregisterById0(*a4);
      *a4 = 0;
      goto LABEL_118;
    }
    v19 = 79;
LABEL_111:
    sub_1400059D0(v18->Dpc.ProcessorHistory, v19, (__int64)&unk_1400124B0, v12);
    goto LABEL_112;
  }
  callout.calloutKey = v8;
  v11 = FwpsCalloutRegister1(a3, &callout, (UINT32 *)a4);
  v12 = v11;
  if ( v11 >= 0 )
    goto LABEL_81;
  v13 = DeviceObject;
  if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
    return (unsigned int)v12;
  if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
  {
    v14 = 71;
    v15 = v11;
LABEL_75:
    sub_1400059D0(v13->Dpc.ProcessorHistory, v14, (__int64)&unk_1400124B0, v15);
  }
LABEL_118:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x50u, (__int64)&unk_1400124B0);
  }
  return (unsigned int)v12;
}
// 140011720: using guessed type wchar_t aPihsWfpAleClas[30];
// 140011760: using guessed type wchar_t aInterceptsInbo[60];
// 1400117E0: using guessed type wchar_t aTeredoFilterFo[46];
// 140011840: using guessed type wchar_t aImplementTered[81];
// 140012610: using guessed type __int128 xmmword_140012610;
// 140012620: using guessed type __int128 xmmword_140012620;
// 140012700: using guessed type __int128 xmmword_140012700;
// 140012710: using guessed type __int128 xmmword_140012710;
// 140012730: using guessed type __int128 xmmword_140012730;
// 140012750: using guessed type __int128 xmmword_140012750;
// 140012760: using guessed type __int128 xmmword_140012760;

//----- (0000000140004C3C) ----------------------------------------------------
__int64 __fastcall sub_140004C3C(__int64 a1)
{
  __int64 v1; // r13
  __int64 result; // rax
  int v3; // edx
  __int64 v4; // [rsp+F0h] [rbp+8h]

  v4 = a1;
  v1 = a1;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xD3u, (__int64)&unk_1400124B0);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
    {
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
        result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xD4u, (__int64)&unk_1400124B0);
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        result = HIDWORD(DeviceObject->Dpc.DeferredContext);
        if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
          result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xD5u, (__int64)&unk_1400124B0);
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
        {
          result = HIDWORD(DeviceObject->Dpc.DeferredContext);
          if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
            result = sub_140005B30(
                       DeviceObject->Dpc.ProcessorHistory,
                       0xD6u,
                       (__int64)&unk_1400124B0,
                       *(_QWORD *)v1,
                       *(_QWORD *)(v1 + 8));
          if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
          {
            result = HIDWORD(DeviceObject->Dpc.DeferredContext);
            if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
              result = sub_1400059D0(
                         DeviceObject->Dpc.ProcessorHistory,
                         0xD7u,
                         (__int64)&unk_1400124B0,
                         *(unsigned __int8 *)(v1 + 16));
          }
        }
      }
    }
  }
  v3 = *(unsigned __int8 *)(v1 + 16);
  if ( (_BYTE)v3 == 4 )
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return result;
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
      result = sub_140005B78(
                 DeviceObject->Dpc.ProcessorHistory,
                 0xD8u,
                 (__int64)&unk_1400124B0,
                 *(unsigned __int8 *)(v1 + 27));
  }
  else if ( (_BYTE)v3 == 6 )
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return result;
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
    {
      result = sub_140005A0C(
                 DeviceObject->Dpc.ProcessorHistory,
                 0xD9u,
                 (__int64)&unk_1400124B0,
                 *(unsigned __int8 *)(v4 + 24));
      v1 = v4;
    }
  }
  else
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return result;
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
      result = sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0xDAu, (__int64)&unk_1400124B0, v3);
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
      result = sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0xDBu, (__int64)&unk_1400124B0, *(_DWORD *)(v1 + 20));
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
    {
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
        result = sub_1400059D0(
                   DeviceObject->Dpc.ProcessorHistory,
                   0xDCu,
                   (__int64)&unk_1400124B0,
                   *(unsigned __int8 *)(v1 + 17));
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        result = HIDWORD(DeviceObject->Dpc.DeferredContext);
        if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
          result = sub_1400059D0(
                     DeviceObject->Dpc.ProcessorHistory,
                     0xDDu,
                     (__int64)&unk_1400124B0,
                     *(_DWORD *)(v1 + 44));
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
        {
          result = HIDWORD(DeviceObject->Dpc.DeferredContext);
          if ( (result & 0x20) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
            result = sub_1400059D0(
                       DeviceObject->Dpc.ProcessorHistory,
                       0xDEu,
                       (__int64)&unk_1400124B0,
                       *(_DWORD *)(v1 + 40));
        }
      }
    }
  }
  return result;
}

//----- (0000000140005060) ----------------------------------------------------
__int64 sub_140005060()
{
  int v0; // eax
  unsigned int v1; // ebx

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x1Du, (__int64)&unk_1400124B0);
  }
  v0 = sub_140002F34(deviceObject);
  v1 = v0;
  if ( v0 < 0 )
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return v1;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x1Eu, (__int64)&unk_1400124B0, v0);
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x1Fu, (__int64)&unk_1400124B0);
  }
  return v1;
}

//----- (000000014000513C) ----------------------------------------------------
__int64 sub_14000513C()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x20u, (__int64)&unk_1400124B0);
  }
  sub_1400039D0();
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x21u, (__int64)&unk_1400124B0);
  }
  return 0i64;
}

//----- (00000001400051C4) ----------------------------------------------------
__int64 __fastcall sub_1400051C4(PDRIVER_OBJECT DriverObject)
{
  NTSTATUS v2; // eax
  int v3; // ebx
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  int v6; // er9
  struct _UNICODE_STRING DestinationString; // [rsp+40h] [rbp-18h] BYREF

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_1400124B0);
  }
  RtlInitUnicodeString(&DestinationString, L"\\Device\\NNS_PihsWfpCallout");
  v2 = IoCreateDevice(DriverObject, 0, &DestinationString, 0x12u, 0, 0, &deviceObject);
  v3 = v2;
  if ( v2 >= 0 )
  {
    if ( FwpmBfeStateGet0() == FWPM_SERVICE_RUNNING && (v3 = sub_140005060(), v3 < 0) )
    {
      v4 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        return (unsigned int)v3;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 5u )
        goto LABEL_23;
      v5 = 12;
    }
    else
    {
      v3 = FwpmBfeStateSubscribeChanges0(
             deviceObject,
             (FWPM_SERVICE_STATE_CHANGE_CALLBACK0)callback,
             0i64,
             &changeHandle);
      if ( v3 >= 0 )
        goto LABEL_23;
      v4 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        return (unsigned int)v3;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 5u )
        goto LABEL_23;
      v5 = 13;
    }
    v6 = v3;
    goto LABEL_22;
  }
  v4 = DeviceObject;
  if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
    return (unsigned int)v3;
  if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    v5 = 11;
    v6 = v2;
LABEL_22:
    sub_1400059D0(v4->Dpc.ProcessorHistory, v5, (__int64)&unk_1400124B0, v6);
  }
LABEL_23:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_1400124B0);
  }
  return (unsigned int)v3;
}

//----- (0000000140005380) ----------------------------------------------------
int __fastcall sub_140005380(__int64 a1, __int64 a2, const NET_BUFFER_LIST *a3, __int64 a4, __int64 a5, _DWORD *a6)
{
  int result; // eax
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  PDEVICE_OBJECT v10; // rcx
  unsigned __int16 v11; // dx

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xC4u, (__int64)&unk_1400124B0);
  }
  *a6 = 8198;
  result = FwpsQueryPacketInjectionState0(injectionHandle, a3, 0i64);
  switch ( result )
  {
    case 0:
      v8 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        return result;
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 8) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 5u )
        goto LABEL_35;
      v9 = 197;
LABEL_34:
      result = sub_1400059A0(v8->Dpc.ProcessorHistory, v9, (__int64)&unk_1400124B0);
      goto LABEL_35;
    case 1:
      v10 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        goto LABEL_29;
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 8) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 5u )
        goto LABEL_29;
      v11 = 198;
LABEL_28:
      result = sub_1400059A0(v10->Dpc.ProcessorHistory, v11, (__int64)&unk_1400124B0);
LABEL_29:
      *a6 = 4098;
      goto LABEL_35;
    case 2:
      v10 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        goto LABEL_29;
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 8) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 5u )
        goto LABEL_29;
      v11 = 199;
      goto LABEL_28;
    case 3:
      v10 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        goto LABEL_29;
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 8) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 5u )
        goto LABEL_29;
      v11 = 200;
      goto LABEL_28;
    case 4:
      v8 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        return result;
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 8) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 5u )
        goto LABEL_35;
      v9 = 201;
      goto LABEL_34;
  }
  if ( (unsigned int)--result <= 2 )
    goto LABEL_29;
LABEL_35:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 8) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xCAu, (__int64)&unk_1400124B0);
  }
  return result;
}

//----- (0000000140005560) ----------------------------------------------------
__int64 sub_140005560()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xCBu, (__int64)&unk_1400124B0);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xCCu, (__int64)&unk_1400124B0);
    }
  }
  return 0i64;
}

//----- (00000001400055E4) ----------------------------------------------------
void sub_1400055E4()
{
  int v0; // eax
  int v1; // eax

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_1400124B0);
  }
  if ( FwpmBfeStateGet0() == FWPM_SERVICE_RUNNING )
  {
    v0 = sub_14000513C();
    if ( v0 >= 0 )
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
      {
        sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_1400124B0);
      }
    }
    else if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
           && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
           && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_1400124B0, v0);
    }
  }
  if ( changeHandle )
  {
    v1 = FwpmBfeStateUnsubscribeChanges0(changeHandle);
    if ( v1 >= 0 )
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
      {
        sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_1400124B0);
      }
    }
    else if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
           && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
           && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x12u, (__int64)&unk_1400124B0, v1);
    }
  }
  if ( deviceObject )
  {
    IoDeleteDevice(deviceObject);
    deviceObject = 0i64;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x14u, (__int64)&unk_1400124B0);
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_1400124B0);
  }
}

//----- (00000001400057C0) ----------------------------------------------------
void __fastcall callback(void *context, FWPM_SERVICE_STATE newState)
{
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x16u, (__int64)&unk_1400124B0);
  }
  if ( newState )
  {
    if ( newState != FWPM_SERVICE_START_PENDING )
    {
      if ( newState == FWPM_SERVICE_STOP_PENDING )
      {
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
          && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
        {
          sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x19u, (__int64)&unk_1400124B0);
        }
        sub_14000513C();
      }
      else if ( newState == FWPM_SERVICE_RUNNING )
      {
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
          && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
        {
          sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x1Au, (__int64)&unk_1400124B0);
        }
        sub_140005060();
      }
      else
      {
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          return;
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
          sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x1Bu, (__int64)&unk_1400124B0, newState);
      }
      goto LABEL_32;
    }
    v3 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) == 0 || BYTE1(DeviceObject->Dpc.DeferredContext) < 4u )
      goto LABEL_32;
    v4 = 24;
    goto LABEL_31;
  }
  v3 = DeviceObject;
  if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
    return;
  if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
  {
    v4 = 23;
LABEL_31:
    sub_1400059A0(v3->Dpc.ProcessorHistory, v4, (__int64)&unk_1400124B0);
  }
LABEL_32:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x1Cu, (__int64)&unk_1400124B0);
  }
}

//----- (00000001400059A0) ----------------------------------------------------
__int64 __fastcall sub_1400059A0(__int64 a1, unsigned __int16 a2, __int64 a3)
{
  return qword_140014068(a1, 43i64, a3, a2, 0i64);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001400059D0) ----------------------------------------------------
__int64 __fastcall sub_1400059D0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+68h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140014068(a1, 43i64, a3, a2, &v5);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140005A0C) ----------------------------------------------------
__int64 __fastcall sub_140005A0C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+160h] [rbp-58h] BYREF

  v5 = a4;
  return qword_140014068(a1, 43i64, a3, a2, &v5);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140005B30) ----------------------------------------------------
__int64 sub_140005B30(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140014068(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140005B78) ----------------------------------------------------
__int64 __fastcall sub_140005B78(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140014068(a1, 43i64, a3, a2, &v5);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140005BE0) ----------------------------------------------------
__int64 sub_140005BE0(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+68h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140014068(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140005C1C) ----------------------------------------------------
bool sub_140005C1C()
{
  bool v0; // bl

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_140012630);
  }
  v0 = _InterlockedCompareExchange(&dword_140014118, 0, 0) != 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x14u, (__int64)&unk_140012630);
  }
  return v0;
}
// 140014118: using guessed type int dword_140014118;

//----- (0000000140005CB8) ----------------------------------------------------
__int64 __fastcall sub_140005CB8(unsigned __int8 a1)
{
  __int32 v1; // ebx
  const char *v2; // r9

  v1 = a1;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_140012630);
  }
  _InterlockedExchange(&dword_140014118, v1);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
    {
      v2 = "Disabled";
      if ( (_BYTE)v1 )
        v2 = "enabled";
      sub_140006754(DeviceObject->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_140012630, v2);
    }
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x12u, (__int64)&unk_140012630);
    }
  }
  return 0i64;
}
// 140014118: using guessed type int dword_140014118;

//----- (0000000140005D9C) ----------------------------------------------------
__int64 sub_140005D9C()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_140012630);
  }
  _InterlockedExchange(&dword_140014118, 1);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_140012630);
  }
  sub_140005F34();
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xCu, (__int64)&unk_140012630);
  }
  return 0i64;
}
// 140014118: using guessed type int dword_140014118;

//----- (0000000140005E68) ----------------------------------------------------
bool sub_140005E68()
{
  return dword_14001411C != 0;
}
// 14001411C: using guessed type int dword_14001411C;

//----- (0000000140005E74) ----------------------------------------------------
__int64 sub_140005E74()
{
  __int64 result; // rax

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_140012630);
  }
  result = (unsigned int)_InterlockedExchange(&dword_140014118, 0);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 1) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_140012630);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
    {
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 1) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
        result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_140012630);
    }
  }
  return result;
}
// 140014118: using guessed type int dword_140014118;

//----- (0000000140005F34) ----------------------------------------------------
__int64 sub_140005F34()
{
  PDEVICE_OBJECT v0; // rcx
  unsigned __int16 v1; // dx
  int v3; // eax
  void *v4; // [rsp+50h] [rbp-18h] BYREF
  __int64 v5; // [rsp+90h] [rbp+28h] BYREF
  unsigned int v6; // [rsp+98h] [rbp+30h] BYREF
  int v7; // [rsp+A0h] [rbp+38h] BYREF
  HANDLE KeyHandle; // [rsp+A8h] [rbp+40h] BYREF

  v4 = 0i64;
  v6 = 0;
  KeyHandle = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_140012630);
  }
  if ( (unsigned int)sub_14000A358(
                       L"\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NNSPIHSW\\Parameters",
                       &KeyHandle) )
  {
    v0 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) == 0
      || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
    {
      return 3221291015i64;
    }
    v1 = 22;
LABEL_20:
    sub_1400059A0(v0->Dpc.ProcessorHistory, v1, (__int64)&unk_140012630);
    return 3221291015i64;
  }
  if ( (unsigned int)sub_14000A214(KeyHandle)
    && DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x17u, (__int64)&unk_140012630);
  }
  if ( (unsigned int)sub_14000A358(
                       L"\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NNSPIHSW\\Parameters\\Internal",
                       &KeyHandle) )
  {
    v0 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) == 0
      || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
    {
      return 3221291015i64;
    }
    v1 = 24;
    goto LABEL_20;
  }
  v7 = 0;
  LODWORD(v5) = 4;
  v3 = sub_14000A560(KeyHandle, L"NotifConnListenPort", &v4, &v6, (__int64)&v5);
  sub_14000615C(v3, KeyHandle, v4, v6, v5, &v7, 4u, &dword_14001411C, 4u, L"NotifConnListenPort");
  if ( !(unsigned int)sub_14000A214(KeyHandle) )
    goto LABEL_27;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x19u, (__int64)&unk_140012630);
LABEL_27:
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x1Au, (__int64)&unk_140012630);
    }
  }
  return 0i64;
}
// 14001411C: using guessed type int dword_14001411C;

//----- (000000014000615C) ----------------------------------------------------
__int64 __fastcall sub_14000615C(int a1, void *a2, void *a3, unsigned int a4, ULONG Type, void *Src, ULONG MaxCount, void *a8, unsigned int DstSize, const wchar_t *SourceString)
{
  rsize_t v10; // rbp
  unsigned int v14; // ebx

  v10 = a4;
  v14 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x1Bu, (__int64)&unk_140012630);
  }
  if ( !a1 )
  {
    if ( Type == 4 )
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      {
        sub_140006644(DeviceObject->Dpc.ProcessorHistory, 0x1Cu, (__int64)&unk_140012630, SourceString);
      }
    }
    else if ( Type == 1
           && DeviceObject != (PDEVICE_OBJECT)&DeviceObject
           && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
           && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      sub_140006580(DeviceObject->Dpc.ProcessorHistory, 0x1Du, (__int64)&unk_140012630, SourceString, (__int64)a3);
    }
    memcpy_s(a8, DstSize, a3, v10);
    sub_14000A2B8(a3);
    goto LABEL_47;
  }
  if ( a1 == 3 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
    {
      sub_140006514(DeviceObject->Dpc.ProcessorHistory, 0x1Eu, (__int64)&unk_140012630, SourceString);
    }
    memcpy_s(a8, DstSize, Src, MaxCount);
    if ( !(unsigned int)sub_14000A8DC(a2, SourceString, Src, MaxCount, Type) )
    {
      if ( Type == 4 )
      {
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          return v14;
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
          sub_140006644(DeviceObject->Dpc.ProcessorHistory, 0x20u, (__int64)&unk_140012630, SourceString);
      }
      else if ( Type == 1 )
      {
        if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
          return v14;
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
          sub_140006580(DeviceObject->Dpc.ProcessorHistory, 0x21u, (__int64)&unk_140012630, SourceString, (__int64)Src);
      }
      goto LABEL_47;
    }
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_140006514(DeviceObject->Dpc.ProcessorHistory, 0x1Fu, (__int64)&unk_140012630, SourceString);
    }
    goto LABEL_12;
  }
  if ( a1 != 4 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_1400066C8(DeviceObject->Dpc.ProcessorHistory, 0x23u, (__int64)&unk_140012630, a1, SourceString);
    }
LABEL_12:
    v14 = -1073741823;
    goto LABEL_47;
  }
  if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
    return v14;
  if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
    sub_140006514(DeviceObject->Dpc.ProcessorHistory, 0x22u, (__int64)&unk_140012630, SourceString);
LABEL_47:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x80u) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x24u, (__int64)&unk_140012630);
  }
  return v14;
}

//----- (0000000140006514) ----------------------------------------------------
__int64 __fastcall sub_140006514(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4)
{
  unsigned int v4; // er10
  __int64 v6; // rax
  __int64 v7; // rdx
  const wchar_t *v8; // rcx

  v4 = a2;
  if ( a4 )
  {
    v6 = -1i64;
    do
      ++v6;
    while ( a4[v6] );
    v7 = 2 * v6 + 2;
  }
  else
  {
    v7 = 10i64;
  }
  v8 = L"NULL";
  if ( a4 )
    v8 = a4;
  return ((__int64 (__fastcall *)(__int64, __int64, __int64, _QWORD, const wchar_t *, __int64, _QWORD))qword_140014068)(
           a1,
           43i64,
           a3,
           v4,
           v8,
           v7,
           0i64);
}
// 1400118F0: using guessed type wchar_t aNull[5];
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140006580) ----------------------------------------------------
__int64 __fastcall sub_140006580(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4, __int64 a5)
{
  __int64 v5; // rax
  unsigned int v6; // edi
  __int64 v7; // r10
  const wchar_t *v8; // rdx

  v5 = -1i64;
  v6 = a2;
  if ( a5 )
  {
    v7 = -1i64;
    do
      ++v7;
    while ( *(_WORD *)(a5 + 2 * v7) );
  }
  if ( a4 )
  {
    do
      ++v5;
    while ( a4[v5] );
  }
  v8 = L"NULL";
  if ( a4 )
    v8 = a4;
  return qword_140014068(a1, 43i64, a3, v6, v8);
}
// 1400118F0: using guessed type wchar_t aNull[5];
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140006644) ----------------------------------------------------
__int64 __fastcall sub_140006644(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4)
{
  __int64 v5; // rax
  const wchar_t *v6; // rcx

  if ( a4 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( a4[v5] );
  }
  v6 = L"NULL";
  if ( a4 )
    v6 = a4;
  return qword_140014068(a1, 43i64, a3, a2, v6);
}
// 1400118F0: using guessed type wchar_t aNull[5];
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001400066C8) ----------------------------------------------------
__int64 __fastcall sub_1400066C8(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, const wchar_t *a5)
{
  unsigned int v5; // er10
  __int64 v7; // rax
  __int64 v8; // rdx
  const wchar_t *v9; // rcx
  int v11; // [rsp+78h] [rbp+20h] BYREF

  v11 = a4;
  v5 = a2;
  if ( a5 )
  {
    v7 = -1i64;
    do
      ++v7;
    while ( a5[v7] );
    v8 = 2 * v7 + 2;
  }
  else
  {
    v8 = 10i64;
  }
  v9 = L"NULL";
  if ( a5 )
    v9 = a5;
  return ((__int64 (__fastcall *)(__int64, __int64, __int64, _QWORD, int *, __int64, const wchar_t *, __int64, _QWORD))qword_140014068)(
           a1,
           43i64,
           a3,
           v5,
           &v11,
           4i64,
           v9,
           v8,
           0i64);
}
// 1400118F0: using guessed type wchar_t aNull[5];
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140006754) ----------------------------------------------------
__int64 __fastcall sub_140006754(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  __int64 v5; // r10
  const char *v6; // rcx

  if ( a4 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( a4[v5] );
  }
  v6 = "NULL";
  if ( a4 )
    v6 = a4;
  return qword_140014068(a1, 43i64, a3, a2, v6);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001400067C0) ----------------------------------------------------
__int64 sub_1400067C0()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x200) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x23u, (__int64)&unk_140012640);
  }
  if ( sub_14000D7A4((PFAST_MUTEX)&P[7]) )
  {
    *(_OWORD *)&P->LowPart = 0i64;
    sub_14000D940((PFAST_MUTEX)&P[7]);
    sub_14000D804((PFAST_MUTEX)&P[7]);
    BYTE1(P[17].LowPart) = 0;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x200) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x24u, (__int64)&unk_140012640);
  }
  return 0i64;
}

//----- (0000000140006898) ----------------------------------------------------
__int64 __fastcall sub_140006898(__int64 a1, __int64 a2)
{
  unsigned int v4; // ebx
  unsigned __int8 *v5; // r14
  int v6; // esi
  __int64 *v7; // r9
  int v8; // er9
  unsigned int v9; // er9
  int v10; // eax
  unsigned __int16 v11; // si

  v4 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x19u, (__int64)&unk_140012640);
  }
  if ( !a1 || !a2 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_140005B30(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x1Au, (__int64)&unk_140012640, a1, a2);
    }
    goto LABEL_50;
  }
  v5 = *(unsigned __int8 **)(a2 + 184);
  *(_QWORD *)(a2 + 56) = 0i64;
  v6 = *v5;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_1400059D0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x1Bu, (__int64)&unk_140012640, *v5);
  }
  switch ( (_BYTE)v6 )
  {
    case 0:
      v7 = (__int64 *)(*((_QWORD *)v5 + 6) + 88i64);
      if ( *(_WORD *)v7 )
      {
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_140007C20(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x1Cu, (__int64)&unk_140012640, v7);
        }
LABEL_50:
        v4 = -1073741811;
        break;
      }
      goto LABEL_42;
    case 2:
LABEL_42:
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_1400059D0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x1Du, (__int64)&unk_140012640, v6);
      }
      break;
    case 0xF:
      v8 = *((_DWORD *)v5 + 6);
      if ( v8 != 2248224 )
      {
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_1400059D0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x1Eu, (__int64)&unk_140012640, v8);
        }
        goto LABEL_50;
      }
      v9 = *((_DWORD *)v5 + 4);
      if ( v9 < 0x38 || *((_DWORD *)v5 + 2) < 0x38u )
      {
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_140007C90(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x1Fu, (__int64)&unk_140012640, v9);
        }
        goto LABEL_50;
      }
      v10 = sub_14000706C(*(_QWORD *)(a2 + 24));
      v11 = v10;
      if ( v10 )
      {
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_1400059D0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x20u, (__int64)&unk_140012640, v10);
        }
        v4 = v11 | 0xE0020000;
      }
      else
      {
        *(_QWORD *)(a2 + 56) = 56i64;
      }
      break;
    default:
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_1400059D0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x21u, (__int64)&unk_140012640, v6);
      }
      v4 = -1073741808;
      break;
  }
  *(_DWORD *)(a2 + 48) = v4;
  IofCompleteRequest((PIRP)a2, 0);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x22u, (__int64)&unk_140012640);
  }
  return v4;
}

//----- (0000000140006BF0) ----------------------------------------------------
__int64 __fastcall sub_140006BF0(unsigned __int8 *a1, _QWORD *a2, _QWORD *a3)
{
  int v6; // eax
  unsigned int v7; // ebx
  __int64 v8; // r8
  __int128 v10[3]; // [rsp+30h] [rbp-48h] BYREF
  __int64 v11; // [rsp+60h] [rbp-18h]

  v10[0] = 0i64;
  v10[1] = 0i64;
  v10[2] = 0i64;
  v11 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x27u, (__int64)&unk_140012640);
  }
  if ( a1 && a2 && a3 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 2) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x29u, (__int64)&unk_140012640);
    }
    sub_140009C04(a1);
    v6 = sub_140009430((__int64)a1, (__int64)v10);
    v7 = v6;
    if ( v6 )
    {
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        return v7;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
        sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x2Au, (__int64)&unk_140012640, v6);
    }
    else
    {
      v8 = *((_QWORD *)&v10[0] + 1);
      *a2 = *(_QWORD *)&v10[0];
      *a3 = v8;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        return v7;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
        sub_140005B30(DeviceObject->Dpc.ProcessorHistory, 0x2Bu, (__int64)&unk_140012640);
    }
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_140007CF0(DeviceObject->Dpc.ProcessorHistory, 0x28u, (__int64)&unk_140012640, a1, a2, a3);
    }
    v7 = 4;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x2Cu, (__int64)&unk_140012640);
  }
  return v7;
}

//----- (0000000140006E00) ----------------------------------------------------
__int64 __fastcall sub_140006E00(PLARGE_INTEGER Timeout)
{
  unsigned int v2; // ebx
  int v3; // er9
  IRP *v4; // rax
  NTSTATUS v5; // eax
  struct _UNICODE_STRING DestinationString; // [rsp+50h] [rbp+7h] BYREF
  struct _IO_STATUS_BLOCK IoStatusBlock; // [rsp+60h] [rbp+17h] BYREF
  struct _KEVENT Event; // [rsp+70h] [rbp+27h] BYREF
  PDEVICE_OBJECT DeviceObject; // [rsp+B0h] [rbp+67h] BYREF
  PFILE_OBJECT FileObject; // [rsp+B8h] [rbp+6Fh] BYREF

  FileObject = 0i64;
  v2 = 0;
  if ( ::DeviceObject != (PDEVICE_OBJECT)&::DeviceObject
    && (HIDWORD(::DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(::DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(::DeviceObject->Dpc.ProcessorHistory, 0x35u, (__int64)&unk_140012640);
  }
  if ( !Timeout )
  {
    if ( ::DeviceObject != (PDEVICE_OBJECT)&::DeviceObject
      && (HIDWORD(::DeviceObject->Dpc.DeferredContext) & 1) != 0
      && BYTE1(::DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_140005BE0(::DeviceObject->Dpc.ProcessorHistory, 0x36u, (__int64)&unk_140012640, 0i64);
    }
    v2 = 4;
    goto LABEL_30;
  }
  RtlInitUnicodeString(&DestinationString, L"\\Device\\NNS_picc");
  v3 = IoGetDeviceObjectPointer(&DestinationString, 0, &FileObject, &DeviceObject);
  if ( v3 < 0 )
  {
    if ( ::DeviceObject != (PDEVICE_OBJECT)&::DeviceObject
      && (HIDWORD(::DeviceObject->Dpc.DeferredContext) & 1) != 0
      && BYTE1(::DeviceObject->Dpc.DeferredContext) >= 4u )
    {
      sub_1400059D0(::DeviceObject->Dpc.ProcessorHistory, 0x37u, (__int64)&unk_140012640, v3);
    }
LABEL_29:
    v2 = 1;
    goto LABEL_30;
  }
  KeInitializeEvent(&Event, NotificationEvent, 0);
  v4 = IoBuildDeviceIoControlRequest(
         0x224E20u,
         DeviceObject,
         Timeout,
         0x38u,
         Timeout,
         0x38u,
         1u,
         &Event,
         &IoStatusBlock);
  if ( v4 )
  {
    v5 = IofCallDriver(DeviceObject, v4);
    if ( v5 == 259 )
    {
      KeWaitForSingleObject(&Event, Executive, 0, 0, 0i64);
      v5 = IoStatusBlock.Status;
    }
    if ( v5 < 0 )
    {
      if ( ::DeviceObject != (PDEVICE_OBJECT)&::DeviceObject
        && (HIDWORD(::DeviceObject->Dpc.DeferredContext) & 1) != 0
        && BYTE1(::DeviceObject->Dpc.DeferredContext) >= 2u )
      {
        sub_1400059A0(::DeviceObject->Dpc.ProcessorHistory, 0x39u, (__int64)&unk_140012640);
      }
      goto LABEL_29;
    }
  }
  else
  {
    if ( ::DeviceObject != (PDEVICE_OBJECT)&::DeviceObject
      && (HIDWORD(::DeviceObject->Dpc.DeferredContext) & 1) != 0
      && BYTE1(::DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_1400059A0(::DeviceObject->Dpc.ProcessorHistory, 0x38u, (__int64)&unk_140012640);
    }
    v2 = 3;
  }
LABEL_30:
  if ( FileObject )
    ObfDereferenceObject(FileObject);
  if ( ::DeviceObject != (PDEVICE_OBJECT)&::DeviceObject
    && (HIDWORD(::DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(::DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(::DeviceObject->Dpc.ProcessorHistory, 0x3Au, (__int64)&unk_140012640);
  }
  return v2;
}

//----- (000000014000706C) ----------------------------------------------------
__int64 __fastcall sub_14000706C(__int64 a1)
{
  unsigned int v2; // ebx
  PLARGE_INTEGER v3; // rax

  v2 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x30u, (__int64)&unk_140012640);
  }
  if ( a1 )
  {
    if ( BYTE1(P[17].LowPart) )
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x32u, (__int64)&unk_140012640);
      }
      v2 = 6;
    }
    else
    {
      *(_OWORD *)&P->LowPart = *(_OWORD *)a1;
      v3 = P;
      *(_OWORD *)(a1 + 16) = *(_OWORD *)&P[2].LowPart;
      *(_OWORD *)(a1 + 32) = *(_OWORD *)&v3[4].LowPart;
      *(_LARGE_INTEGER *)(a1 + 48) = v3[6];
      if ( sub_14000D8E4((PFAST_MUTEX)&P[7]) )
      {
        BYTE1(P[17].LowPart) = 1;
      }
      else
      {
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x33u, (__int64)&unk_140012640);
        }
        v2 = 1;
      }
    }
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_140005BE0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x31u, (__int64)&unk_140012640, 0i64);
    }
    v2 = 4;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x34u, (__int64)&unk_140012640);
  }
  return v2;
}

//----- (000000014000722C) ----------------------------------------------------
__int64 __fastcall sub_14000722C(PDRIVER_OBJECT DriverObject)
{
  unsigned int v2; // ebx
  _LARGE_INTEGER *v3; // rax
  bool v4; // al
  int v5; // ebx
  char v6; // al
  struct _UNICODE_STRING DestinationString; // [rsp+40h] [rbp-18h] BYREF

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_140012640);
  }
  if ( DriverObject )
  {
    v3 = (_LARGE_INTEGER *)sub_14000B2F0(2, 0x90u, 0x74636370u, 0i64, 0i64);
    P = v3;
    if ( v3 )
    {
      memset(v3, 0, 0x90ui64);
      v4 = sub_14000D884((__int64)&P[7]);
      LOBYTE(P[17].LowPart) = v4;
      if ( v4 )
      {
        P[2].QuadPart = (LONGLONG)sub_1400067C0;
        P[3].QuadPart = (LONGLONG)sub_140007930;
        P[4].QuadPart = (LONGLONG)sub_140006BF0;
        P[5].QuadPart = (LONGLONG)sub_1400075C0;
        P[6].QuadPart = (LONGLONG)sub_1400076A0;
        RtlInitUnicodeString(&DestinationString, L"\\Device\\NNS_pihs");
        v5 = IoCreateDevice(DriverObject, 0, &DestinationString, 0x22u, 0x100u, 1u, &qword_140014128);
        if ( v5 >= 0 )
        {
          v2 = sub_140006E00(P);
          if ( v2 )
          {
            if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
              && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
              && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
            {
              sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_140012640, v2);
            }
            v2 = 0;
          }
          else
          {
            v6 = sub_14000D8E4((PFAST_MUTEX)&P[7]);
            BYTE1(P[17].LowPart) = v6;
            if ( v6 )
            {
              if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
                return v2;
              if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
                && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
              {
                sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_140012640);
              }
            }
            else
            {
              if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
                && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
                && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
              {
                sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_140012640);
              }
              v2 = 6;
            }
          }
        }
        else
        {
          if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
            && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
            && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
          {
            sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_140012640, v5);
          }
          qword_140014128 = 0i64;
          v2 = sub_140007BB8(v5);
        }
      }
      else
      {
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
          && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
        {
          sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_140012640);
        }
        v2 = 1;
      }
    }
    else
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
      {
        sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0xCu, (__int64)&unk_140012640, 144);
      }
      v2 = 3;
    }
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_140005BE0(DeviceObject->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_140012640, 0i64);
    }
    v2 = 4;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x12u, (__int64)&unk_140012640);
  }
  return v2;
}

//----- (00000001400075C0) ----------------------------------------------------
__int64 __fastcall sub_1400075C0(__int64 a1)
{
  unsigned int v2; // ebx

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x2Du, (__int64)&unk_140012640);
  }
  if ( a1 )
  {
    v2 = sub_140008178(a1);
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x2Eu, (__int64)&unk_140012640);
    }
    v2 = 4;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x2Fu, (__int64)&unk_140012640);
  }
  return v2;
}

//----- (00000001400076A0) ----------------------------------------------------
__int64 __fastcall sub_1400076A0(__int64 a1, __int64 a2)
{
  unsigned int v3; // ebx

  v3 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x200) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x3Bu, (__int64)&unk_140012640);
  }
  if ( !a2 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x200) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x3Cu, (__int64)&unk_140012640);
    }
    v3 = 4;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x200) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x3Du, (__int64)&unk_140012640);
  }
  return v3;
}

//----- (0000000140007780) ----------------------------------------------------
__int64 __fastcall sub_140007780(unsigned int a1, __int64 a2, unsigned int a3)
{
  unsigned int v6; // ebx
  int v7; // eax

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x3Eu, (__int64)&unk_140012640);
  }
  if ( P )
  {
    if ( sub_14000D7A4((PFAST_MUTEX)&P[7]) )
    {
      v7 = ((__int64 (__fastcall *)(_QWORD, __int64, _QWORD))P[1].QuadPart)(a1, a2, a3);
      v6 = v7;
      if ( v7
        && DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_1400059D0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x40u, (__int64)&unk_140012640, v7);
      }
      sub_14000D940((PFAST_MUTEX)&P[7]);
    }
    else
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x41u, (__int64)&unk_140012640);
      }
      v6 = 11;
    }
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x3Fu, (__int64)&unk_140012640);
    }
    v6 = 6;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && _bittest((const signed __int32 *)&DeviceObject->DeviceQueue.DeviceListHead.Flink + 1, 9u)
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x42u, (__int64)&unk_140012640);
  }
  return v6;
}

//----- (0000000140007930) ----------------------------------------------------
__int64 __fastcall sub_140007930(unsigned __int8 a1)
{
  unsigned int v2; // ebx

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x100) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x25u, (__int64)&unk_140012640);
  }
  v2 = sub_140005CB8(a1);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x100) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x26u, (__int64)&unk_140012640);
  }
  return v2;
}

//----- (00000001400079CC) ----------------------------------------------------
void sub_1400079CC()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_140012640);
  }
  if ( qword_140014128 )
  {
    IoDeleteDevice(qword_140014128);
    qword_140014128 = 0i64;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x14u, (__int64)&unk_140012640);
    }
  }
  if ( !P )
    goto LABEL_25;
  if ( BYTE1(P[17].LowPart) )
  {
    ((void (*)(void))P->QuadPart)();
    sub_14000D804((PFAST_MUTEX)&P[7]);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_140012640);
    }
  }
  if ( LOBYTE(P[17].LowPart) )
  {
    sub_14000D85C((__int64)&P[7]);
    LOBYTE(P[17].LowPart) = 0;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x16u, (__int64)&unk_140012640);
    }
  }
  sub_14000B380(P, 0x74636370u, 0i64, 0i64);
  P = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x17u, (__int64)&unk_140012640);
LABEL_25:
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x18u, (__int64)&unk_140012640);
    }
  }
}

//----- (0000000140007BB8) ----------------------------------------------------
__int64 __fastcall sub_140007BB8(int a1)
{
  if ( _bittest(&a1, 0x1Du) )
    return (unsigned __int16)a1;
  if ( (a1 & 0xC0000000) != 0 )
  {
    if ( a1 != -1073741811 )
    {
      if ( a1 == -1073741801 )
        return 3i64;
      if ( a1 != -1073741776 )
      {
        if ( a1 != -1073741670 )
        {
          if ( a1 <= -1073741586 )
            return 1i64;
          if ( a1 > -1073741574 )
          {
            if ( a1 == -1073741275 )
              return 5i64;
            return 1i64;
          }
          return 4i64;
        }
        return 3i64;
      }
    }
    return 4i64;
  }
  return 0i64;
}

//----- (0000000140007C20) ----------------------------------------------------
__int64 __fastcall sub_140007C20(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 *a4)
{
  __int64 *v5; // rcx

  v5 = qword_140011AA0;
  if ( a4 )
    v5 = a4;
  return qword_140014068(a1, 43i64, a3, a2, v5);
}
// 140011AA0: using guessed type __int64 qword_140011AA0[2];
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140007C90) ----------------------------------------------------
__int64 __fastcall sub_140007C90(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140014068(a1, 43i64, a3, a2, &v5);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140007CF0) ----------------------------------------------------
__int64 sub_140007CF0(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140014068(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140007D44) ----------------------------------------------------
__int64 sub_140007D44()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_140012650);
  }
  if ( poolHandle )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      sub_140005BE0(DeviceObject->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_140012650);
    }
    NdisFreeNetBufferListPool(poolHandle);
    poolHandle = 0i64;
  }
  if ( NdisObject )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      sub_140005BE0(DeviceObject->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_140012650);
    }
    NdisFreeGenericObject(NdisObject);
    NdisObject = 0i64;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_140012650, 0);
  }
  return 0i64;
}

//----- (0000000140007E80) ----------------------------------------------------
void __fastcall completionFn(void *context, NET_BUFFER_LIST *netBufferList, BOOLEAN dispatchLevel)
{
  PNET_BUFFER v4; // rdi
  PMDL v5; // rbx
  PVOID v6; // rbp
  UINT v7; // er14
  NDIS_STATUS Priority; // [rsp+28h] [rbp-30h]
  ULONG v9; // [rsp+30h] [rbp-28h]

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    Priority = netBufferList->Status;
    sub_14000884C(DeviceObject->Dpc.ProcessorHistory, 0x12u, (__int64)&unk_140012650, context, netBufferList, Priority);
  }
  v4 = netBufferList->FirstNetBuffer;
  if ( v4 )
  {
    v5 = v4->MdlChain;
    if ( v5 )
    {
      if ( (v5->MdlFlags & 5) != 0 )
        v6 = v5->MappedSystemVa;
      else
        v6 = MmMapLockedPagesSpecifyCache(v5, 0, MmCached, 0i64, 0, 0x40000010u);
      v7 = v5->ByteCount;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      {
        v9 = v5->ByteCount;
        sub_1400088A4(DeviceObject->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_140012650, v4, v5, v6, v9);
      }
      NdisFreeMdl(v5);
      NdisFreeMemory(v6, v7, 0);
    }
  }
  FwpsFreeNetBufferList0(netBufferList);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x14u, (__int64)&unk_140012650);
  }
}

//----- (0000000140007FF0) ----------------------------------------------------
__int64 sub_140007FF0()
{
  struct _NDIS_GENERIC_OBJECT *v0; // rax
  struct _NET_BUFFER_LIST_POOL_PARAMETERS Parameters; // [rsp+20h] [rbp-28h] BYREF

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_140012650);
  }
  Parameters.DataSize = 0;
  Parameters.PoolTag = 1767329870;
  Parameters.Header = (NDIS_OBJECT_HEADER)65920;
  *(_DWORD *)&Parameters.ProtocolId = 524544;
  v0 = NdisAllocateGenericObject(0i64, 0x6957504Eu, 0);
  NdisObject = v0;
  if ( v0 )
  {
    poolHandle = NdisAllocateNetBufferListPool(v0, &Parameters);
    if ( !poolHandle )
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
      {
        sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xCu, (__int64)&unk_140012650);
      }
      NdisFreeGenericObject(NdisObject);
      NdisObject = 0i64;
    }
  }
  else
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return 0i64;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_140012650);
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_140012650, 0);
  }
  return 0i64;
}

//----- (0000000140008178) ----------------------------------------------------
__int64 __fastcall sub_140008178(__int64 a1)
{
  int v1; // ebx
  HANDLE v3; // rbp
  unsigned int v4; // esi
  int v5; // edx
  int v6; // ecx
  UINT v7; // edx
  PMDL v8; // r14
  PVOID v9; // rax
  void *v10; // r15
  NTSTATUS v11; // ebx
  int v12; // eax
  PDEVICE_OBJECT v13; // rcx
  unsigned __int16 v14; // dx
  PDEVICE_OBJECT v15; // rcx
  unsigned __int16 v16; // dx
  int v17; // er9
  NET_BUFFER_LIST *netBufferList; // [rsp+90h] [rbp+8h] BYREF

  v1 = 0;
  v3 = 0i64;
  v4 = 3;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_140012650);
  }
  v5 = *(_DWORD *)(a1 + 16);
  v6 = v5;
  if ( v5 != 1 )
  {
    if ( v5 == 2 )
      goto LABEL_16;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x16u, (__int64)&unk_140012650);
      v6 = *(_DWORD *)(a1 + 16);
    }
    v4 = 18;
    v1 = -1073741823;
  }
  if ( v6 == 1 )
  {
    if ( !injectionHandle )
      v1 = FwpsInjectionHandleCreate0(0, 0x10u, &injectionHandle);
    v3 = injectionHandle;
    goto LABEL_20;
  }
LABEL_16:
  if ( v6 == 2 )
  {
    if ( !qword_140014148 )
      v1 = FwpsInjectionHandleCreate0(0, 1u, &qword_140014148);
    v3 = qword_140014148;
  }
LABEL_20:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400087A4(DeviceObject->Dpc.ProcessorHistory, 0x17u, (__int64)&unk_140012650, *(_DWORD *)(a1 + 16));
  }
  if ( v1 < 0 || !v3 )
  {
    v4 = 19;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return v4;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
      sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x21u, (__int64)&unk_140012650, v1);
    goto LABEL_85;
  }
  v7 = *(_DWORD *)(a1 + 8);
  netBufferList = 0i64;
  v8 = 0i64;
  v9 = NdisAllocateMemoryWithTagPriority(v3, v7, 0x6957504Eu, NormalPoolPriority);
  v10 = v9;
  if ( !v9 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x20u, (__int64)&unk_140012650);
    }
    goto LABEL_75;
  }
  memmove(v9, *(const void **)a1, *(unsigned int *)(a1 + 8));
  v8 = NdisAllocateMdl(v3, v10, *(_DWORD *)(a1 + 8));
  if ( !v8 )
  {
    v11 = -1073741801;
    v15 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) == 0
      || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_69;
    }
    v16 = 31;
    goto LABEL_67;
  }
  v11 = FwpsAllocateNetBufferAndNetBufferList0(poolHandle, 8u, 0, v8, 0, *(unsigned int *)(a1 + 8), &netBufferList);
  if ( v11 < 0 )
  {
    v11 = -1073741801;
    v15 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) == 0
      || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_69;
    }
    v16 = 30;
LABEL_67:
    v17 = -1073741801;
    goto LABEL_68;
  }
  v12 = *(_DWORD *)(a1 + 16);
  if ( v12 == 1 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      sub_140007CF0(DeviceObject->Dpc.ProcessorHistory, 0x18u, (__int64)&unk_140012650, netBufferList, v8, v10);
    }
    v11 = FwpsInjectMacSendAsync0(
            v3,
            0i64,
            0i64,
            57i64,
            *(unsigned __int16 *)(a1 + 12),
            0,
            netBufferList,
            completionFn,
            0i64);
    if ( v11 >= 0 )
    {
      v4 = 0;
      v13 = DeviceObject;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      {
        v14 = 25;
LABEL_54:
        sub_1400059A0(v13->Dpc.ProcessorHistory, v14, (__int64)&unk_140012650);
        goto LABEL_69;
      }
      goto LABEL_69;
    }
    v15 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) == 0
      || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_69;
    }
    v16 = 26;
    goto LABEL_43;
  }
  if ( v12 != 2 )
    goto LABEL_69;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_140007CF0(DeviceObject->Dpc.ProcessorHistory, 0x1Bu, (__int64)&unk_140012650, netBufferList, v8, v10);
  }
  v11 = FwpsStreamInjectAsync0(
          v3,
          0i64,
          0,
          *(_QWORD *)(a1 + 29),
          dword_1400140DC,
          0x14u,
          *(_BYTE *)(a1 + 20) == 0,
          netBufferList,
          *(unsigned int *)(a1 + 8),
          (FWPS_INJECT_COMPLETE0)completionFn,
          0i64);
  if ( v11 < 0 )
  {
    v15 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) == 0
      || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_69;
    }
    v16 = 29;
LABEL_43:
    v17 = v11;
LABEL_68:
    sub_1400059D0(v15->Dpc.ProcessorHistory, v16, (__int64)&unk_140012650, v17);
    goto LABEL_69;
  }
  v4 = 0;
  v13 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    v14 = 28;
    goto LABEL_54;
  }
LABEL_69:
  if ( (v11 & 0xC0000000) == -1073741824 )
  {
LABEL_75:
    if ( netBufferList )
      FwpsFreeNetBufferList0(netBufferList);
    if ( v8 )
      NdisFreeMdl(v8);
    if ( v10 )
      NdisFreeMemory(v10, *(_DWORD *)(a1 + 8), 0);
  }
LABEL_85:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 8) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x22u, (__int64)&unk_140012650, v4);
  }
  return v4;
}
// 14000AE42: using guessed type __int64 __fastcall FwpsInjectMacSendAsync0(_QWORD, _QWORD, _QWORD, _QWORD, _DWORD, _DWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001400087A4) ----------------------------------------------------
__int64 __fastcall sub_1400087A4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+B8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140014068(a1, 43i64, a3, a2, &v5);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000884C) ----------------------------------------------------
__int64 sub_14000884C(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140014068(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001400088A4) ----------------------------------------------------
__int64 sub_1400088A4(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140014068(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140008908) ----------------------------------------------------
__int64 __fastcall sub_140008908(PDRIVER_OBJECT DriverObject)
{
  int v2; // eax
  int v3; // eax
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx

  sub_140008BF8(&stru_1400167C0);
  sub_1400180F8();
  stru_1400167C0.CurrentIrp = 0i64;
  sub_140018070();
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_140012660);
  }
  DriverObject->DriverUnload = (PDRIVER_UNLOAD)sub_140008B40;
  memset64(DriverObject->MajorFunction, (unsigned __int64)&sub_140008BF0, 0x1Bui64);
  v2 = sub_140005D9C();
  if ( v2 < 0 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_140012660, v2);
    }
    goto LABEL_31;
  }
  v3 = sub_14000987C();
  if ( v3 )
  {
    v4 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) == 0
      || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_31;
    }
    v5 = 12;
LABEL_30:
    sub_1400059D0(v4->Dpc.ProcessorHistory, v5, (__int64)&unk_140012660, v3);
LABEL_31:
    sub_140008B40();
    goto LABEL_32;
  }
  v3 = sub_1400051C4(DriverObject);
  if ( v3 < 0 )
  {
    v4 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) == 0
      || BYTE1(DeviceObject->Dpc.DeferredContext) < 5u )
    {
      goto LABEL_31;
    }
    v5 = 13;
    goto LABEL_30;
  }
  v3 = sub_140007FF0();
  if ( v3 )
  {
    v4 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) == 0
      || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_31;
    }
    v5 = 14;
    goto LABEL_30;
  }
  v3 = sub_14000722C(DriverObject);
  if ( v3 )
  {
    v4 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) == 0
      || BYTE1(DeviceObject->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_31;
    }
    v5 = 15;
    goto LABEL_30;
  }
LABEL_32:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_140012660);
  }
  return 0i64;
}

//----- (0000000140008B40) ----------------------------------------------------
void sub_140008B40()
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_140012660);
  }
  sub_1400079CC();
  sub_140007D44();
  sub_1400055E4();
  sub_140009A94();
  sub_140005E74();
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x12u, (__int64)&unk_140012660);
  }
  sub_140018000();
}

//----- (0000000140008BF8) ----------------------------------------------------
void *__fastcall sub_140008BF8(_QWORD *a1)
{
  void *result; // rax

  a1[5] = 1i64;
  *a1 = 0i64;
  a1[1] = &unk_140012470;
  a1[2] = &stru_1400167C0.DeviceExtension;
  a1[9] = &unk_140012480;
  a1[10] = &stru_1400167C0.Queue.Wcb.DeviceObject;
  a1[17] = &unk_140012490;
  a1[18] = &stru_1400167C0.DeviceQueue.1;
  result = &unk_1400124A0;
  a1[25] = &unk_1400124A0;
  a1[4] = 0i64;
  a1[8] = 0i64;
  a1[12] = 0i64;
  a1[13] = 1i64;
  a1[16] = 0i64;
  a1[20] = 0i64;
  a1[21] = 1i64;
  a1[24] = 0i64;
  a1[26] = 0i64;
  a1[28] = 0i64;
  a1[29] = 1i64;
  return result;
}

//----- (0000000140008CB0) ----------------------------------------------------
void __fastcall sub_140008CB0(__int64 a1, unsigned __int8 a2, __int64 *a3, __int64 a4)
{
  __int64 v4; // rax

  if ( a2 <= 1u )
  {
    v4 = 0i64;
    if ( a2 )
    {
      *(_DWORD *)(a4 + 44) = *((_DWORD *)a3 + 1);
      *(_BYTE *)(a4 + 41) = *((_BYTE *)a3 + 2);
      v4 = *a3;
    }
    else
    {
      *(_BYTE *)(a4 + 41) = 0;
      *(_DWORD *)(a4 + 44) = 0;
    }
    *(_QWORD *)(a4 + 24) = v4;
  }
}

//----- (0000000140008CE0) ----------------------------------------------------
__int64 __fastcall sub_140008CE0(__int64 a1, __int64 a2)
{
  __int64 v4; // rsi
  unsigned __int64 v5; // rdi
  unsigned int v6; // eax
  unsigned int v7; // ebx
  __int64 v8; // rax
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  int v11; // eax
  int v12; // eax
  ULONG_PTR BugCheckParameter1[2]; // [rsp+30h] [rbp-10h] BYREF
  int v15; // [rsp+70h] [rbp+30h] BYREF
  int v16; // [rsp+80h] [rbp+40h] BYREF
  _OWORD *v17; // [rsp+88h] [rbp+48h] BYREF

  v16 = 0;
  BugCheckParameter1[0] = 0i64;
  v4 = 0i64;
  v17 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_140012670);
  }
  if ( !a1 || !a2 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_140005B30(DeviceObject->Dpc.ProcessorHistory, 0x14u, (__int64)&unk_140012670, a1, a2);
    }
    v7 = 4;
    goto LABEL_46;
  }
  v5 = *(unsigned __int16 *)(a1 + 16) | (unsigned __int64)(*(unsigned __int8 *)(a1 + 18) << 24);
  v6 = sub_140009630(&v17);
  v7 = v6;
  if ( v6 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_14000A1C8(DeviceObject->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_140012670, v5, v6);
    }
    v4 = (__int64)v17;
    goto LABEL_46;
  }
  v4 = (__int64)v17;
  *v17 = *(_OWORD *)a2;
  *(_OWORD *)(v4 + 16) = *(_OWORD *)(a2 + 16);
  *(_OWORD *)(v4 + 32) = *(_OWORD *)(a2 + 32);
  *(_QWORD *)(v4 + 48) = *(_QWORD *)(a2 + 48);
  sub_14000B180(&SpinLock, (KIRQL *)&v15, 0i64, 0i64);
  v8 = sub_140010CD0(BugCheckParameter2, v5, BugCheckParameter1, &v16);
  if ( (v16 & 0xFFFFFFFB) != 0 )
  {
    v7 = sub_14000FF64(v16);
    v9 = DeviceObject;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
    {
      v10 = 22;
LABEL_18:
      sub_14000A1C8(v9->Dpc.ProcessorHistory, v10, (__int64)&unk_140012670, v5, v7);
      goto LABEL_39;
    }
    goto LABEL_39;
  }
  if ( !v8 )
  {
LABEL_30:
    v12 = sub_140010AA4(BugCheckParameter2, v5, v4, 0i64);
    v16 = v12;
    if ( v12 )
    {
      v7 = sub_14000FF64(v12);
      v9 = DeviceObject;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
      {
        v10 = 25;
        goto LABEL_18;
      }
    }
    else if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
           && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
           && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_140005BE0(DeviceObject->Dpc.ProcessorHistory, 0x1Au, (__int64)&unk_140012670, v5, 0);
    }
    goto LABEL_39;
  }
  sub_140010008(BugCheckParameter2, BugCheckParameter1[0], 1, &v16);
  if ( !v16 )
  {
    v11 = sub_14000F5C0(BugCheckParameter2, BugCheckParameter1[0], 1);
    v16 = v11;
    if ( v11 )
    {
      v7 = sub_14000FF64(v11);
      v9 = DeviceObject;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      {
        v10 = 24;
        goto LABEL_18;
      }
      goto LABEL_39;
    }
    goto LABEL_30;
  }
  v7 = sub_14000FF64(v16);
  v9 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
  {
    v10 = 23;
    goto LABEL_18;
  }
LABEL_39:
  sub_14000B270(&SpinLock, v15, 0i64, 0i64);
  if ( v7 )
LABEL_46:
    sub_140009780(v4);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x1Bu, (__int64)&unk_140012670, v7);
  }
  return v7;
}

//----- (0000000140009080) ----------------------------------------------------
__int64 __fastcall sub_140009080(__int64 a1)
{
  __int64 result; // rax

  if ( a1 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
    {
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
        sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x3Du, (__int64)&unk_140012670);
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
          sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x3Eu, (__int64)&unk_140012670);
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
        {
          if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
            sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x3Fu, (__int64)&unk_140012670);
          if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
          {
            if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
              sub_140005B30(
                DeviceObject->Dpc.ProcessorHistory,
                0x40u,
                (__int64)&unk_140012670,
                *(_QWORD *)a1,
                *(_QWORD *)(a1 + 8));
            if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
              && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
              && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
            {
              sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x41u, (__int64)&unk_140012670);
            }
          }
        }
      }
    }
    sub_140009C04((unsigned __int8 *)(a1 + 16));
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x42u, (__int64)&unk_140012670);
    }
    result = sub_140009C04((unsigned __int8 *)(a1 + 36));
  }
  else if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Dpc.DeferredContext);
    if ( (result & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x3Cu, (__int64)&unk_140012670);
  }
  return result;
}

//----- (0000000140009264) ----------------------------------------------------
__int64 __fastcall sub_140009264(__int64 a1)
{
  unsigned int v1; // ebx
  unsigned __int64 v3; // rsi
  unsigned int v4; // eax
  int v6; // [rsp+50h] [rbp+8h] BYREF
  int v7; // [rsp+58h] [rbp+10h] BYREF

  v1 = 0;
  v7 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x28u, (__int64)&unk_140012670);
  }
  if ( a1 )
  {
    v3 = *(unsigned __int16 *)(a1 + 16) | (unsigned __int64)(*(unsigned __int8 *)(a1 + 18) << 24);
    sub_14000B180(&SpinLock, (KIRQL *)&v6, 0i64, 0i64);
    sub_140010294(BugCheckParameter2, v3, 1, &v7);
    if ( v7 )
    {
      v4 = sub_14000FF64(v7);
      v1 = v4;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
      {
        sub_14000A1C8(DeviceObject->Dpc.ProcessorHistory, 0x2Au, (__int64)&unk_140012670, v3, v4);
      }
    }
    else if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
           && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
           && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      sub_140005BE0(DeviceObject->Dpc.ProcessorHistory, 0x2Bu, (__int64)&unk_140012670, v3, 0);
    }
    sub_14000B270(&SpinLock, v6, 0i64, 0i64);
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_140005BE0(DeviceObject->Dpc.ProcessorHistory, 0x29u, (__int64)&unk_140012670, 0i64);
    }
    v1 = 4;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x2Cu, (__int64)&unk_140012670, v1);
  }
  return v1;
}

//----- (0000000140009430) ----------------------------------------------------
__int64 __fastcall sub_140009430(__int64 a1, __int64 a2)
{
  unsigned int v2; // ebx
  unsigned __int64 v5; // rbp
  __int64 v6; // rsi
  unsigned int v7; // eax
  int v9; // [rsp+60h] [rbp+8h] BYREF
  int v10; // [rsp+70h] [rbp+18h] BYREF

  v2 = 0;
  v10 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x1Cu, (__int64)&unk_140012670);
  }
  if ( a1 && a2 )
  {
    v5 = *(unsigned __int16 *)(a1 + 16) | (unsigned __int64)(*(unsigned __int8 *)(a1 + 18) << 24);
    sub_14000B180(&SpinLock, (KIRQL *)&v9, 0i64, 0i64);
    v6 = sub_140010CD0(BugCheckParameter2, v5, 0i64, &v10);
    if ( v10 )
    {
      v7 = sub_14000FF64(v10);
      v2 = v7;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      {
        sub_14000A1C8(DeviceObject->Dpc.ProcessorHistory, 0x1Eu, (__int64)&unk_140012670, v5, v7);
      }
    }
    else
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      {
        sub_140005BE0(DeviceObject->Dpc.ProcessorHistory, 0x1Fu, (__int64)&unk_140012670, v5, 0);
      }
      *(_OWORD *)a2 = *(_OWORD *)v6;
      *(_OWORD *)(a2 + 16) = *(_OWORD *)(v6 + 16);
      *(_OWORD *)(a2 + 32) = *(_OWORD *)(v6 + 32);
      *(_QWORD *)(a2 + 48) = *(_QWORD *)(v6 + 48);
    }
    sub_14000B270(&SpinLock, v9, 0i64, 0i64);
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_140005B30(DeviceObject->Dpc.ProcessorHistory, 0x1Du, (__int64)&unk_140012670, a1, a2);
    }
    v2 = 4;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x20u, (__int64)&unk_140012670, v2);
  }
  return v2;
}

//----- (0000000140009630) ----------------------------------------------------
__int64 __fastcall sub_140009630(_QWORD *a1)
{
  unsigned int v2; // ebx
  _DWORD *v3; // rax

  v2 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x2Du, (__int64)&unk_140012670);
  }
  if ( a1 )
  {
    v3 = sub_14000B400((__int64)qword_140014150, 0i64, 0i64);
    *a1 = v3;
    if ( v3 )
    {
      *(_OWORD *)v3 = 0i64;
      *((_OWORD *)v3 + 1) = 0i64;
      *((_OWORD *)v3 + 2) = 0i64;
      *((_QWORD *)v3 + 6) = 0i64;
    }
    else
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
      {
        sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x2Fu, (__int64)&unk_140012670);
      }
      v2 = 3;
    }
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x2Eu, (__int64)&unk_140012670);
    }
    v2 = 4;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x30u, (__int64)&unk_140012670, v2);
  }
  return v2;
}

//----- (0000000140009780) ----------------------------------------------------
__int64 __fastcall sub_140009780(__int64 a1)
{
  unsigned int v2; // ebx

  v2 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x31u, (__int64)&unk_140012670);
  }
  if ( a1 )
  {
    sub_14000B470((__int64)qword_140014150, a1, 0i64, 0i64);
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x32u, (__int64)&unk_140012670);
    }
    v2 = 4;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x33u, (__int64)&unk_140012670, v2);
  }
  return v2;
}

//----- (000000014000987C) ----------------------------------------------------
__int64 sub_14000987C()
{
  unsigned int v0; // ebx
  int v2; // [rsp+70h] [rbp+8h] BYREF

  v0 = 0;
  v2 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_140012670);
  }
  qword_140014150 = sub_14000B560(2, 0x38u, 0x7057504Eu, 0i64, 0i64);
  if ( !qword_140014150 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_140012670);
    }
    v0 = 3;
LABEL_17:
    sub_140009A94();
    goto LABEL_23;
  }
  sub_14000B200(&SpinLock, 0i64, 0i64);
  BugCheckParameter2 = 0i64;
  BugCheckParameter2 = (ULONG_PTR)sub_14000F760(
                                    8u,
                                    0,
                                    2,
                                    0x5057504Eu,
                                    60i64,
                                    0,
                                    0i64,
                                    0i64,
                                    (__int64)sub_140009780,
                                    (__int64)sub_140009080,
                                    &v2);
  if ( v2 )
  {
    v0 = sub_14000FF64(v2);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0xCu, (__int64)&unk_140012670, v0);
    }
    if ( !v0 )
      goto LABEL_23;
    goto LABEL_17;
  }
  qword_140014168 = sub_14000B670(1u, 0i64, 0i64);
  if ( !qword_140014168 )
  {
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
      return v0;
    if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_140012670);
  }
LABEL_23:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_140012670, v0);
  }
  return v0;
}

//----- (0000000140009A94) ----------------------------------------------------
__int64 sub_140009A94()
{
  unsigned int v0; // ebx
  int v1; // eax
  int v2; // eax

  v0 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_140012670);
  }
  sub_140011060();
  if ( qword_140014168 )
    sub_14000B5F0(qword_140014168, 5000i64, 0i64, 0i64);
  if ( !BugCheckParameter2 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_140012670);
    }
    goto LABEL_17;
  }
  v1 = sub_14000FB00(BugCheckParameter2, 1);
  if ( !v1 )
  {
LABEL_17:
    BugCheckParameter2 = 0i64;
    goto LABEL_18;
  }
  v2 = sub_14000FF64(v1);
  v0 = v2;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
  {
    sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_140012670, v2);
  }
LABEL_18:
  if ( qword_140014150 )
  {
    sub_14000B4F0(qword_140014150, 0i64, 0i64);
    qword_140014150 = 0i64;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 1) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x12u, (__int64)&unk_140012670, v0);
  }
  return v0;
}

//----- (0000000140009C04) ----------------------------------------------------
__int64 __fastcall sub_140009C04(unsigned __int8 *a1)
{
  unsigned __int8 *v1; // r13
  __int64 result; // rax
  int v3; // edx
  unsigned __int8 *v4; // [rsp+F0h] [rbp+8h]

  v4 = a1;
  v1 = a1;
  if ( a1 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
    {
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
        result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x35u, (__int64)&unk_140012670);
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        result = HIDWORD(DeviceObject->Dpc.DeferredContext);
        if ( (result & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
          result = sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x36u, (__int64)&unk_140012670, v1[18]);
      }
    }
    v3 = v1[18];
    if ( (_BYTE)v3 == 4 )
    {
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        return result;
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
        result = sub_140005B78(DeviceObject->Dpc.ProcessorHistory, 0x37u, (__int64)&unk_140012670, *v1);
    }
    else if ( (_BYTE)v3 == 6 )
    {
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        return result;
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
      {
        result = sub_140005A0C(DeviceObject->Dpc.ProcessorHistory, 0x38u, (__int64)&unk_140012670, *v4);
        v1 = v4;
      }
    }
    else
    {
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        return result;
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
        result = sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x39u, (__int64)&unk_140012670, v3);
    }
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
    {
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
        result = sub_1400059D0(
                   DeviceObject->Dpc.ProcessorHistory,
                   0x3Au,
                   (__int64)&unk_140012670,
                   *((unsigned __int16 *)v1 + 8));
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        result = HIDWORD(DeviceObject->Dpc.DeferredContext);
        if ( (result & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
          result = sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x3Bu, (__int64)&unk_140012670, v1[19]);
      }
    }
  }
  else
  {
    result = (__int64)&DeviceObject;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
    {
      result = HIDWORD(DeviceObject->Dpc.DeferredContext);
      if ( (result & 4) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
        result = sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x34u, (__int64)&unk_140012670);
    }
  }
  return result;
}

//----- (0000000140009F44) ----------------------------------------------------
__int64 __fastcall sub_140009F44(__int64 a1)
{
  unsigned int v1; // ebx
  unsigned __int64 v3; // rdi
  unsigned int v4; // eax
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx
  int v7; // eax
  int v8; // eax
  __int64 v10; // [rsp+20h] [rbp-10h]
  int v11; // [rsp+60h] [rbp+30h] BYREF
  int v12; // [rsp+68h] [rbp+38h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+70h] [rbp+40h] BYREF

  v1 = 0;
  v12 = 0;
  BugCheckParameter1 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x21u, (__int64)&unk_140012670);
  }
  if ( a1 )
  {
    v3 = *(unsigned __int16 *)(a1 + 16) | (unsigned __int64)(*(unsigned __int8 *)(a1 + 18) << 24);
    sub_14000B180(&SpinLock, (KIRQL *)&v11, 0i64, 0i64);
    sub_140010CD0(BugCheckParameter2, v3, &BugCheckParameter1, &v12);
    if ( v12 )
    {
      v4 = sub_14000FF64(v12);
      v1 = v4;
      v5 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
        || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) == 0
        || BYTE1(DeviceObject->Dpc.DeferredContext) < 3u )
      {
        goto LABEL_31;
      }
      v6 = 35;
      LODWORD(v10) = v4;
    }
    else
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
      {
        sub_140005B30(DeviceObject->Dpc.ProcessorHistory, 0x24u, (__int64)&unk_140012670, BugCheckParameter1, v3);
      }
      v7 = sub_14000F3E4(BugCheckParameter2, BugCheckParameter1, 0i64);
      v12 = v7;
      if ( v7 )
      {
        v1 = sub_14000FF64(v7);
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
          && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
        {
          LODWORD(v10) = v1;
          sub_14000A1C8(DeviceObject->Dpc.ProcessorHistory, 0x25u, (__int64)&unk_140012670, v3, v10);
        }
      }
      v8 = sub_14000F5C0(BugCheckParameter2, BugCheckParameter1, 1);
      v12 = v8;
      if ( !v8 )
        goto LABEL_31;
      v1 = sub_14000FF64(v8);
      v5 = DeviceObject;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
        || (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) == 0
        || BYTE1(DeviceObject->Dpc.DeferredContext) < 3u )
      {
        goto LABEL_31;
      }
      v6 = 38;
      LODWORD(v10) = v1;
    }
    sub_14000A1C8(v5->Dpc.ProcessorHistory, v6, (__int64)&unk_140012670, v3, v10);
LABEL_31:
    sub_14000B270(&SpinLock, v11, 0i64, 0i64);
    goto LABEL_32;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
  {
    sub_140005BE0(DeviceObject->Dpc.ProcessorHistory, 0x22u, (__int64)&unk_140012670, 0i64);
  }
  v1 = 4;
LABEL_32:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 4) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059D0(DeviceObject->Dpc.ProcessorHistory, 0x27u, (__int64)&unk_140012670, v1);
  }
  return v1;
}
// 14000A103: variable 'v10' is possibly undefined

//----- (000000014000A1C8) ----------------------------------------------------
__int64 sub_14000A1C8(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140014068(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000A214) ----------------------------------------------------
__int64 __fastcall sub_14000A214(void *a1)
{
  __int64 result; // rax

  if ( a1 )
  {
    ZwClose(a1);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
    {
      sub_140005BE0(DeviceObject->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_140012680, a1);
    }
    result = 0i64;
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_140005BE0(DeviceObject->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_140012680, 0i64);
    }
    result = 5i64;
  }
  return result;
}

//----- (000000014000A2B8) ----------------------------------------------------
void __fastcall sub_14000A2B8(PVOID P)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x18u, (__int64)&unk_140012680);
  }
  if ( P )
    ExFreePoolWithTag(P, 0x7248414Eu);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x19u, (__int64)&unk_140012680);
  }
}

//----- (000000014000A358) ----------------------------------------------------
__int64 __fastcall sub_14000A358(PCWSTR SourceString, void **a2)
{
  unsigned int v2; // ebx
  int v5; // er9
  const char *v6; // rax
  struct _UNICODE_STRING DestinationString; // [rsp+40h] [rbp-40h] BYREF
  struct _OBJECT_ATTRIBUTES ObjectAttributes; // [rsp+50h] [rbp-30h] BYREF
  ULONG Disposition; // [rsp+B0h] [rbp+30h] BYREF
  void *KeyHandle; // [rsp+C0h] [rbp+40h] BYREF

  v2 = 0;
  KeyHandle = 0i64;
  DestinationString = 0i64;
  Disposition = 0;
  *(_OWORD *)&ObjectAttributes.Length = 0i64;
  *(_OWORD *)&ObjectAttributes.ObjectName = 0i64;
  *(_OWORD *)&ObjectAttributes.SecurityDescriptor = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_140012680);
  }
  if ( SourceString )
  {
    *a2 = 0i64;
    RtlInitUnicodeString(&DestinationString, SourceString);
    ObjectAttributes.Length = 48;
    ObjectAttributes.ObjectName = &DestinationString;
    ObjectAttributes.RootDirectory = 0i64;
    ObjectAttributes.Attributes = 576;
    *(_OWORD *)&ObjectAttributes.SecurityDescriptor = 0i64;
    v5 = ZwCreateKey(&KeyHandle, 0xF003Fu, &ObjectAttributes, 0, 0i64, 0, &Disposition);
    if ( v5 >= 0 )
    {
      *a2 = KeyHandle;
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        return v2;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
      {
        v6 = "OPENED";
        if ( Disposition == 1 )
          v6 = "CREATED";
        sub_14000AC28(DeviceObject->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_140012680, SourceString, (__int64)v6);
      }
    }
    else
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
      {
        sub_1400066C8(DeviceObject->Dpc.ProcessorHistory, 0xCu, (__int64)&unk_140012680, v5, SourceString);
      }
      v2 = 1;
    }
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_140005BE0(DeviceObject->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_140012680, 0i64);
    }
    v2 = 5;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_140012680);
  }
  return v2;
}

//----- (000000014000A560) ----------------------------------------------------
__int64 __fastcall sub_14000A560(HANDLE KeyHandle, PCWSTR SourceString, void **a3, unsigned int *a4, __int64 a5)
{
  unsigned int v9; // ebx
  int v10; // eax
  _DWORD *v11; // rax
  _DWORD *v12; // rdi
  int v13; // er9
  unsigned int v14; // esi
  int v15; // ecx
  PVOID v16; // rax
  _UNICODE_STRING DestinationString; // [rsp+30h] [rbp-38h] BYREF
  ULONG ResultLength; // [rsp+80h] [rbp+18h] BYREF

  ResultLength = 0;
  DestinationString = 0i64;
  v9 = 1;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_140012680);
  }
  if ( a3 )
    *a3 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_14000ABA4(DeviceObject->Dpc.ProcessorHistory, 0x12u, (__int64)&unk_140012680, SourceString);
  }
  RtlInitUnicodeString(&DestinationString, SourceString);
  v10 = ZwQueryValueKey(KeyHandle, &DestinationString, KeyValueFullInformation, 0i64, 8u, &ResultLength);
  if ( v10 != -1073741789 && v10 != -2147483643 )
  {
    if ( v10 == -1073741772 )
      v9 = 3;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      sub_14000AB00(DeviceObject->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_140012680, v10, (__int64)SourceString);
    }
    goto LABEL_38;
  }
  v11 = ExAllocatePoolWithTag(NonPagedPool, ResultLength, 0x7248414Eu);
  v12 = v11;
  if ( v11 )
  {
    v13 = ZwQueryValueKey(KeyHandle, &DestinationString, KeyValueFullInformation, v11, ResultLength, &ResultLength);
    if ( v13 )
    {
      if ( v13 == -1073741772 )
        v9 = 3;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
      {
        sub_14000AB00(DeviceObject->Dpc.ProcessorHistory, 0x14u, (__int64)&unk_140012680, v13, (__int64)SourceString);
      }
      goto LABEL_37;
    }
    v14 = v12[3];
    if ( v14 <= 2 )
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 3u )
      {
        sub_140006514(DeviceObject->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_140012680, SourceString);
      }
      v9 = 4;
LABEL_37:
      ExFreePoolWithTag(v12, 0x7248414Eu);
      goto LABEL_38;
    }
    v15 = v12[1];
    if ( (unsigned int)(v15 - 1) <= 1 || v15 == 7 )
      v14 += 2;
    v16 = ExAllocatePoolWithTag(NonPagedPool, v14, 0x7248414Eu);
    *a3 = v16;
    if ( v16 )
    {
      memset(v16, 0, v14);
      memmove(*a3, (char *)v12 + (unsigned int)v12[2], (unsigned int)v12[3]);
      v9 = 0;
      *(_DWORD *)a5 = v12[1];
      *a4 = v14;
    }
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x16u, (__int64)&unk_140012680);
  }
  if ( v12 )
    goto LABEL_37;
LABEL_38:
  if ( v9 && *a3 )
    ExFreePoolWithTag(*a3, 0x7248414Eu);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x17u, (__int64)&unk_140012680);
  }
  return v9;
}

//----- (000000014000A8DC) ----------------------------------------------------
__int64 __fastcall sub_14000A8DC(HANDLE KeyHandle, PCWSTR SourceString, PVOID Data, ULONG DataSize, ULONG Type)
{
  unsigned int v9; // ebx
  int v10; // er9
  ULONG v12; // [rsp+30h] [rbp-38h]
  _UNICODE_STRING DestinationString; // [rsp+40h] [rbp-28h] BYREF

  DestinationString = 0i64;
  v9 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x1Au, (__int64)&unk_140012680);
  }
  if ( KeyHandle && SourceString && Data && DataSize )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
    {
      sub_14000ABA4(DeviceObject->Dpc.ProcessorHistory, 0x1Cu, (__int64)&unk_140012680, SourceString);
    }
    RtlInitUnicodeString(&DestinationString, SourceString);
    v10 = ZwSetValueKey(KeyHandle, &DestinationString, 0, Type, Data, DataSize);
    if ( v10 >= 0 )
    {
      if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject )
        return v9;
      if ( (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0 && BYTE1(DeviceObject->Dpc.DeferredContext) >= 4u )
        sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x1Eu, (__int64)&unk_140012680);
    }
    else
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
        && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
      {
        sub_14000AB00(DeviceObject->Dpc.ProcessorHistory, 0x1Du, (__int64)&unk_140012680, v10, (__int64)SourceString);
      }
      v9 = 1;
    }
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
      && BYTE1(DeviceObject->Dpc.DeferredContext) >= 2u )
    {
      v12 = DataSize;
      sub_1400088A4(
        DeviceObject->Dpc.ProcessorHistory,
        0x1Bu,
        (__int64)&unk_140012680,
        KeyHandle,
        SourceString,
        Data,
        v12);
    }
    v9 = 5;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(DeviceObject->Dpc.DeferredContext) >= 5u )
  {
    sub_1400059A0(DeviceObject->Dpc.ProcessorHistory, 0x1Fu, (__int64)&unk_140012680);
  }
  return v9;
}

//----- (000000014000AB00) ----------------------------------------------------
__int64 __fastcall sub_14000AB00(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, __int64 a5)
{
  __int64 v5; // rax
  int v7; // [rsp+88h] [rbp+20h] BYREF

  v7 = a4;
  if ( a5 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( *(_WORD *)(a5 + 2 * v5) );
  }
  return qword_140014068(a1, 43i64, a3, a2, &v7);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000ABA4) ----------------------------------------------------
__int64 __fastcall sub_14000ABA4(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4)
{
  __int64 v5; // rax
  const wchar_t *v6; // rcx

  if ( a4 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( a4[v5] );
  }
  v6 = L"NULL";
  if ( a4 )
    v6 = a4;
  return qword_140014068(a1, 43i64, a3, a2, v6);
}
// 1400118F0: using guessed type wchar_t aNull[5];
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000AC28) ----------------------------------------------------
__int64 __fastcall sub_14000AC28(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4, __int64 a5)
{
  __int64 v5; // rax
  __int64 v7; // r10
  const wchar_t *v8; // rcx

  v5 = -1i64;
  if ( a5 )
  {
    v7 = -1i64;
    do
      ++v7;
    while ( *(_BYTE *)(a5 + v7) );
  }
  if ( a4 )
  {
    do
      ++v5;
    while ( a4[v5] );
  }
  v8 = L"NULL";
  if ( a4 )
    v8 = a4;
  return qword_140014068(a1, 43i64, a3, a2, v8);
}
// 1400118F0: using guessed type wchar_t aNull[5];
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000AD2C) ----------------------------------------------------
__int64 __fastcall sub_14000AD2C(__int64 a1, __int64 a2)
{
  __int64 result; // rax
  unsigned __int8 v3; // dl

  result = *(_QWORD *)(a2 + 8);
  v3 = *(_BYTE *)(*(unsigned int *)(*(_QWORD *)(a2 + 16) + 8i64) + result + 3);
  if ( (v3 & 0xF) != 0 )
    result = v3 & 0xF0;
  return result;
}

//----- (000000014000AE50) ----------------------------------------------------
void __fastcall sub_14000AE50(PVOID P, __int64 a2, __int64 a3)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x1Eu, (__int64)&unk_140012860, aUnknownModule, a2, a3);
  }
  sub_14000B890(P);
}

//----- (000000014000AEC0) ----------------------------------------------------
bool __fastcall sub_14000AEC0(struct _KEVENT **a1, char a2, BOOLEAN a3, __int64 a4, __int64 a5)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x1Du, (__int64)&unk_140012860, aUnknownModule, a4, a5);
  }
  return sub_14000B930(a1, a2, a3);
}

//----- (000000014000AF50) ----------------------------------------------------
int __fastcall sub_14000AF50(PRKEVENT Event, __int64 a2, __int64 a3)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x20u, (__int64)&unk_140012860, aUnknownModule, a2, a3);
  }
  return sub_14000BA20(Event);
}

//----- (000000014000AFC0) ----------------------------------------------------
int __fastcall sub_14000AFC0(PRKEVENT Event, __int64 a2, __int64 a3)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x1Fu, (__int64)&unk_140012860, aUnknownModule, a2, a3);
  }
  return sub_14000BAB0(Event);
}

//----- (000000014000B030) ----------------------------------------------------
void __fastcall sub_14000B030(PFAST_MUTEX FastMutex, __int64 a2, __int64 a3)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x22u, (__int64)&unk_140012860, aUnknownModule, a2, a3);
  }
  sub_14000BB40(FastMutex);
}

//----- (000000014000B0A0) ----------------------------------------------------
void __fastcall sub_14000B0A0(__int64 a1, __int64 a2, __int64 a3)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x21u, (__int64)&unk_140012860, aUnknownModule, a2, a3);
  }
  sub_14000BBD0(a1);
}

//----- (000000014000B110) ----------------------------------------------------
void __fastcall sub_14000B110(PFAST_MUTEX FastMutex, __int64 a2, __int64 a3)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x24u, (__int64)&unk_140012860, aUnknownModule, a2, a3);
  }
  sub_14000BC70(FastMutex);
}

//----- (000000014000B180) ----------------------------------------------------
void __fastcall sub_14000B180(PKSPIN_LOCK SpinLock, KIRQL *a2, __int64 a3, __int64 a4)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x1Bu, (__int64)&unk_140012860, aUnknownModule, a3, a4);
  }
  sub_14000BD00(SpinLock, a2);
}

//----- (000000014000B200) ----------------------------------------------------
void __fastcall sub_14000B200(PKSPIN_LOCK SpinLock, __int64 a2, __int64 a3)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x1Au, (__int64)&unk_140012860, aUnknownModule, a2, a3);
  }
  sub_14000BDC0(SpinLock);
}

//----- (000000014000B270) ----------------------------------------------------
void __fastcall sub_14000B270(PKSPIN_LOCK SpinLock, KIRQL a2, __int64 a3, __int64 a4)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x1Cu, (__int64)&unk_140012860, aUnknownModule, a3, a4);
  }
  sub_14000BE50(SpinLock, a2);
}

//----- (000000014000B2F0) ----------------------------------------------------
PVOID __fastcall sub_14000B2F0(int a1, unsigned int a2, ULONG a3, __int64 a4, __int64 a5)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0xAu, (__int64)&unk_140012860, aUnknownModule, a4, a5);
  }
  return sub_14000BF00(a1, a2, a3);
}

//----- (000000014000B380) ----------------------------------------------------
void __fastcall sub_14000B380(PVOID P, ULONG Tag, __int64 a3, __int64 a4)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0xBu, (__int64)&unk_140012860, aUnknownModule, a3, a4);
  }
  sub_14000C020(P, Tag);
}

//----- (000000014000B400) ----------------------------------------------------
_DWORD *__fastcall sub_14000B400(__int64 a1, __int64 a2, __int64 a3)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0xFu, (__int64)&unk_140012860, aUnknownModule, a2, a3);
  }
  return sub_14000C110(a1);
}

//----- (000000014000B470) ----------------------------------------------------
void __fastcall sub_14000B470(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x10u, (__int64)&unk_140012860, aUnknownModule, a3, a4);
  }
  sub_14000C220(a1, a2);
}

//----- (000000014000B4F0) ----------------------------------------------------
void __fastcall sub_14000B4F0(PVOID P, __int64 a2, __int64 a3)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0xEu, (__int64)&unk_140012860, aUnknownModule, a2, a3);
  }
  sub_14000C300(P);
}

//----- (000000014000B560) ----------------------------------------------------
char *__fastcall sub_14000B560(int a1, unsigned int a2, ULONG a3, __int64 a4, __int64 a5)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0xDu, (__int64)&unk_140012860, aUnknownModule, a4, a5);
  }
  return sub_14000C3E0(a1, a2, a3);
}

//----- (000000014000B5F0) ----------------------------------------------------
__int64 __fastcall sub_14000B5F0(PVOID P, __int64 a2, __int64 a3, __int64 a4)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x2Du, (__int64)&unk_140012860, aUnknownModule, a3, a4);
  }
  return sub_14000C5F0(P);
}

//----- (000000014000B670) ----------------------------------------------------
PVOID __fastcall sub_14000B670(unsigned int a1, __int64 a2, __int64 a3)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x2Bu, (__int64)&unk_140012860, aUnknownModule, a2, a3);
  }
  return sub_14000CFB0(a1);
}

//----- (000000014000B6E0) ----------------------------------------------------
__int64 __fastcall sub_14000B6E0(PVOID Object, unsigned int a2, __int64 a3, __int64 a4)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_14000B760((__int64)DeviceObject->Queue.ListEntry.Blink, 0x32u, (__int64)&unk_140012860, aUnknownModule, a3, a4);
  }
  return sub_14000D480(Object, a2);
}

//----- (000000014000B760) ----------------------------------------------------
__int64 __fastcall sub_14000B760(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, __int64 a5, __int64 a6)
{
  __int64 v8; // rax
  __int64 v9; // r10
  __int64 v10; // r9
  const char *v11; // r8

  v8 = -1i64;
  if ( a6 )
  {
    v9 = -1i64;
    do
      ++v9;
    while ( *(_BYTE *)(a6 + v9) );
  }
  if ( a5 )
  {
    v10 = -1i64;
    do
      ++v10;
    while ( *(_BYTE *)(a5 + v10) );
  }
  if ( a4 )
  {
    do
      ++v8;
    while ( a4[v8] );
  }
  v11 = "NULL";
  if ( a4 )
    v11 = a4;
  return qword_140014068(a1, 43i64, a3, a2, v11);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000B890) ----------------------------------------------------
void __fastcall sub_14000B890(PVOID P)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x37u, (__int64)&unk_140012870);
  }
  KeClearEvent((PRKEVENT)P);
  sub_14000C020(P, 0x6E634556u);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x38u, (__int64)&unk_140012870);
  }
}

//----- (000000014000B930) ----------------------------------------------------
bool __fastcall sub_14000B930(struct _KEVENT **a1, char a2, BOOLEAN a3)
{
  int v6; // edi
  struct _KEVENT *v7; // rax
  struct _KEVENT *v8; // rbx

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x35u, (__int64)&unk_140012870);
  }
  v6 = 0;
  *a1 = 0i64;
  v7 = (struct _KEVENT *)sub_14000BF00(2, 0x18u, 0x6E634556u);
  v8 = v7;
  if ( v7 )
  {
    KeInitializeEvent(v7, (EVENT_TYPE)(a2 == 0), a3);
    *a1 = v8;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    LOBYTE(v6) = v8 != 0i64;
    sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x36u, (__int64)&unk_140012870, v6);
  }
  return v8 != 0i64;
}

//----- (000000014000BA20) ----------------------------------------------------
int __fastcall sub_14000BA20(PRKEVENT Event)
{
  int result; // eax

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x3Bu, (__int64)&unk_140012870);
  }
  result = KeResetEvent(Event);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine);
    if ( (result & 2) != 0 && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
      result = sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x3Cu, (__int64)&unk_140012870);
  }
  return result;
}

//----- (000000014000BAB0) ----------------------------------------------------
int __fastcall sub_14000BAB0(PRKEVENT Event)
{
  int result; // eax

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x39u, (__int64)&unk_140012870);
  }
  result = KeSetEvent(Event, 0, 0);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine);
    if ( (result & 2) != 0 && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
      result = sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x3Au, (__int64)&unk_140012870);
  }
  return result;
}

//----- (000000014000BB40) ----------------------------------------------------
void __fastcall sub_14000BB40(PFAST_MUTEX FastMutex)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x3Fu, (__int64)&unk_140012870);
  }
  ExAcquireFastMutex(FastMutex);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x40u, (__int64)&unk_140012870);
  }
}

//----- (000000014000BBD0) ----------------------------------------------------
void __fastcall sub_14000BBD0(__int64 a1)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x3Du, (__int64)&unk_140012870);
  }
  *(_DWORD *)a1 = 1;
  *(_QWORD *)(a1 + 8) = 0i64;
  *(_DWORD *)(a1 + 16) = 0;
  KeInitializeEvent((PRKEVENT)(a1 + 24), SynchronizationEvent, 0);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x3Eu, (__int64)&unk_140012870);
  }
}

//----- (000000014000BC70) ----------------------------------------------------
void __fastcall sub_14000BC70(PFAST_MUTEX FastMutex)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x43u, (__int64)&unk_140012870);
  }
  ExReleaseFastMutex(FastMutex);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x44u, (__int64)&unk_140012870);
  }
}

//----- (000000014000BD00) ----------------------------------------------------
void __fastcall sub_14000BD00(PKSPIN_LOCK SpinLock, KIRQL *a2)
{
  unsigned __int8 v4; // si

  v4 = KeGetCurrentIrql();
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x31u, (__int64)&unk_140012870);
  }
  if ( v4 == 2 )
  {
    *a2 = 2;
    KeAcquireSpinLockAtDpcLevel(SpinLock);
  }
  else
  {
    *a2 = KeAcquireSpinLockRaiseToDpc(SpinLock);
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x32u, (__int64)&unk_140012870);
  }
}

//----- (000000014000BDC0) ----------------------------------------------------
void __fastcall sub_14000BDC0(PKSPIN_LOCK SpinLock)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x2Fu, (__int64)&unk_140012870);
  }
  KeInitializeSpinLock(SpinLock);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x30u, (__int64)&unk_140012870);
  }
}

//----- (000000014000BE50) ----------------------------------------------------
void __fastcall sub_14000BE50(PKSPIN_LOCK SpinLock, KIRQL a2)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x33u, (__int64)&unk_140012870);
  }
  if ( a2 == 2 )
    KeReleaseSpinLockFromDpcLevel(SpinLock);
  else
    KeReleaseSpinLock(SpinLock, a2);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x34u, (__int64)&unk_140012870);
  }
}

//----- (000000014000BF00) ----------------------------------------------------
PVOID __fastcall sub_14000BF00(int a1, unsigned int a2, ULONG a3)
{
  SIZE_T v4; // rdi
  PVOID v6; // rax
  PVOID v7; // rbx

  v4 = a2;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    if ( (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0 && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
      sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0xAu, (__int64)&unk_140012870);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 4) != 0
      && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_14000D550((__int64)DeviceObject->Queue.ListEntry.Blink, 0xBu, (__int64)&unk_140012870, v4);
    }
  }
  v6 = ExAllocatePoolWithTag((POOL_TYPE)(a1 != 2), v4, a3);
  v7 = v6;
  if ( v6 )
    memset(v6, 0, v4);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0xCu, (__int64)&unk_140012870, (int)v7);
  }
  return v7;
}

//----- (000000014000C020) ----------------------------------------------------
void __fastcall sub_14000C020(PVOID P, ULONG Tag)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    if ( (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0 && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
      sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0xDu, (__int64)&unk_140012870);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 4) != 0
      && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_14000D550((__int64)DeviceObject->Queue.ListEntry.Blink, 0xEu, (__int64)&unk_140012870, (int)P);
    }
  }
  if ( P )
    ExFreePoolWithTag(P, Tag);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0xFu, (__int64)&unk_140012870);
  }
}

//----- (000000014000C110) ----------------------------------------------------
_DWORD *__fastcall sub_14000C110(__int64 a1)
{
  _DWORD *v1; // rbx
  _DWORD *v3; // rax

  v1 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x19u, (__int64)&unk_140012870);
  }
  if ( (*(_DWORD *)a1 == 2 || *(_DWORD *)a1 == 1)
    && ((++*(_DWORD *)(a1 + 84), (v3 = ExpInterlockedPopEntrySList((PSLIST_HEADER)(a1 + 64))) != 0i64)
     || (++*(_DWORD *)(a1 + 88),
         (v3 = (_DWORD *)(*(__int64 (__fastcall **)(_QWORD, _QWORD, _QWORD))(a1 + 112))(
                           *(unsigned int *)(a1 + 100),
                           *(unsigned int *)(a1 + 108),
                           *(unsigned int *)(a1 + 104))) != 0i64)) )
  {
    *v3 = 0;
  }
  else
  {
    v3 = sub_14000BF00(*(_DWORD *)a1, *(_DWORD *)(a1 + 4) + 7, *(_DWORD *)(a1 + 8));
    if ( !v3 )
      goto LABEL_14;
    *v3 = 1;
  }
  v1 = v3 + 1;
  if ( v3 != (_DWORD *)-4i64 )
    memset(v3 + 1, 0, *(unsigned int *)(a1 + 4));
LABEL_14:
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x1Au, (__int64)&unk_140012870, (int)v1);
  }
  return v1;
}

//----- (000000014000C220) ----------------------------------------------------
void __fastcall sub_14000C220(__int64 a1, __int64 a2)
{
  int v4; // eax
  struct _SLIST_ENTRY *v5; // rdi

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x1Bu, (__int64)&unk_140012870);
  }
  v4 = *(_DWORD *)(a2 - 4);
  v5 = (struct _SLIST_ENTRY *)(a2 - 4);
  if ( v4 )
  {
    if ( v4 == 1 )
      sub_14000C020(v5, *(_DWORD *)(a1 + 8));
  }
  else if ( *(_DWORD *)a1 == 2 || *(_DWORD *)a1 == 1 )
  {
    ++*(_DWORD *)(a1 + 92);
    if ( ExQueryDepthSList((PSLIST_HEADER)(a1 + 64)) < *(_WORD *)(a1 + 80) )
    {
      ExpInterlockedPushEntrySList((PSLIST_HEADER)(a1 + 64), v5);
    }
    else
    {
      ++*(_DWORD *)(a1 + 96);
      (*(void (__fastcall **)(struct _SLIST_ENTRY *))(a1 + 120))(v5);
    }
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x1Cu, (__int64)&unk_140012870);
  }
}

//----- (000000014000C300) ----------------------------------------------------
void __fastcall sub_14000C300(PVOID P)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    if ( (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0 && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
      sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x16u, (__int64)&unk_140012870);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 4) != 0
      && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x17u, (__int64)&unk_140012870);
    }
  }
  if ( *(_DWORD *)P == 2 )
  {
    ExDeleteNPagedLookasideList((PNPAGED_LOOKASIDE_LIST)((char *)P + 64));
  }
  else if ( *(_DWORD *)P == 1 )
  {
    ExDeletePagedLookasideList((PPAGED_LOOKASIDE_LIST)((char *)P + 64));
  }
  sub_14000C020(P, *((_DWORD *)P + 2));
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x18u, (__int64)&unk_140012870);
  }
}

//----- (000000014000C3E0) ----------------------------------------------------
char *__fastcall sub_14000C3E0(int a1, unsigned int a2, ULONG a3)
{
  __int64 v3; // rdi
  char *v4; // rbx
  char *v7; // rax
  SIZE_T Size; // rdi

  v3 = a2;
  v4 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x13u, (__int64)&unk_140012870);
  }
  if ( (unsigned int)(a1 - 1) <= 1 )
  {
    if ( (_DWORD)v3 )
    {
      v7 = (char *)sub_14000BF00(2, 0xC0u, a3);
      v4 = v7;
      if ( v7 )
      {
        memset(v7, 0, 0xC0ui64);
        *((_DWORD *)v4 + 1) = v3;
        *(_DWORD *)v4 = a1;
        *((_DWORD *)v4 + 2) = a3;
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 4) != 0
          && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x14u, (__int64)&unk_140012870);
        }
        Size = v3 + 7;
        if ( *(_DWORD *)v4 == 2 )
          ExInitializeNPagedLookasideList((PNPAGED_LOOKASIDE_LIST)(v4 + 64), 0i64, 0i64, 0, Size, a3, 0);
        if ( *(_DWORD *)v4 == 1 )
          ExInitializePagedLookasideList((PPAGED_LOOKASIDE_LIST)(v4 + 64), 0i64, 0i64, 0, Size, a3, 0);
      }
    }
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x15u, (__int64)&unk_140012870, (int)v4);
  }
  return v4;
}

//----- (000000014000C550) ----------------------------------------------------
void __fastcall StartRoutine(PVOID StartContext)
{
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x49u, (__int64)&unk_140012870);
  }
  (*(void (__fastcall **)(_QWORD))StartContext)(*((_QWORD *)StartContext + 1));
  sub_14000C020(StartContext, 0x6E635448u);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x4Au, (__int64)&unk_140012870);
  }
  PsTerminateSystemThread(0);
}

//----- (000000014000C5F0) ----------------------------------------------------
__int64 __fastcall sub_14000C5F0(PVOID P)
{
  unsigned int v2; // er15
  unsigned int v3; // er12
  __int64 v4; // rbp
  __int64 v5; // r13
  KSPIN_LOCK *v6; // rbx
  unsigned __int8 v7; // di
  KIRQL v8; // si
  __int64 i; // rcx
  __int64 **v10; // rax
  __int64 *v11; // rbx
  __int64 *v12; // rcx
  __int64 *v13; // rbx
  void (__fastcall *v14)(__int64 *); // rax
  __int64 v15; // rdx
  struct _KEVENT *v16; // rcx
  unsigned int j; // ebx
  __int64 v18; // rsi
  __int64 v19; // r8
  void *v20; // rdi
  int v21; // eax
  void *v22; // rdi

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x5Eu, (__int64)&unk_140012870);
  }
  if ( *((_BYTE *)P + 12) )
    v2 = *((_DWORD *)P + 2) + 1;
  else
    v2 = 1;
  v3 = 0;
  if ( v2 )
  {
    v4 = 0i64;
    do
    {
      v5 = 32i64 * v3;
      v6 = (KSPIN_LOCK *)(v5 + *((_QWORD *)P + 3));
      v7 = KeGetCurrentIrql();
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
        && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
      {
        sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x31u, (__int64)&unk_140012870);
      }
      if ( v7 == 2 )
      {
        v8 = 2;
        KeAcquireSpinLockAtDpcLevel(v6);
      }
      else
      {
        v8 = KeAcquireSpinLockRaiseToDpc(v6);
      }
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        if ( (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
          && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
        {
          sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x32u, (__int64)&unk_140012870);
        }
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
          && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x5Fu, (__int64)&unk_140012870);
        }
      }
      for ( i = *((_QWORD *)P + 3); *(_QWORD *)(v4 + i + 8) != v4 + i + 8; i = *((_QWORD *)P + 3) )
      {
        v10 = (__int64 **)(i + v4 + 8);
        v11 = *v10;
        if ( (__int64 **)(*v10)[1] != v10 || (v12 = (__int64 *)*v11, *(__int64 **)(*v11 + 8) != v11) )
          __fastfail(3u);
        *v10 = v12;
        v12[1] = (__int64)v10;
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
          && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x60u, (__int64)&unk_140012870, (int)v11);
        }
        v13 = v11 + 5;
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
          && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
        {
          sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x6Bu, (__int64)&unk_140012870);
        }
        if ( v13 )
        {
          v14 = (void (__fastcall *)(__int64 *))*(v13 - 1);
          if ( v14 )
            v14(v13);
          sub_14000C020(v13 - 5, 0x6E635749u);
        }
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
          && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
        {
          sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x6Cu, (__int64)&unk_140012870);
        }
      }
      v15 = i;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
        && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x61u, (__int64)&unk_140012870);
        v15 = *((_QWORD *)P + 3);
      }
      sub_14000BE50((PKSPIN_LOCK)(v15 + v5), v8);
      ++v3;
      v4 += 32i64;
    }
    while ( v3 < v2 );
  }
  if ( *(_QWORD *)P )
  {
    v16 = *(struct _KEVENT **)P;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
      && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x62u, (__int64)&unk_140012870);
      v16 = *(struct _KEVENT **)P;
    }
    sub_14000BAB0(v16);
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x63u, (__int64)&unk_140012870, *((_DWORD *)P + 2));
  }
  for ( j = 0; j < *((_DWORD *)P + 2); ++j )
  {
    v18 = 8i64 * j;
    if ( *(_QWORD *)(*((_QWORD *)P + 2) + v18) )
    {
      v19 = *((_QWORD *)P + 2);
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
        && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x64u, (__int64)&unk_140012870, j);
        v19 = *((_QWORD *)P + 2);
      }
      v20 = *(void **)(v19 + 8i64 * j);
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
        && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
      {
        sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x6Fu, (__int64)&unk_140012870);
      }
      v21 = KeWaitForSingleObject(v20, Executive, 0, 0, 0i64);
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        if ( (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
          && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
        {
          sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x70u, (__int64)&unk_140012870, v21);
        }
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
          && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x65u, (__int64)&unk_140012870, j);
        }
      }
      v22 = *(void **)(v18 + *((_QWORD *)P + 2));
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
        && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
      {
        sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x4Du, (__int64)&unk_140012870);
      }
      if ( v22 )
        ObfDereferenceObject(v22);
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
        && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
      {
        sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x4Eu, (__int64)&unk_140012870);
      }
      *(_QWORD *)(v18 + *((_QWORD *)P + 2)) = 0i64;
      if ( *((_BYTE *)P + 12) )
        sub_14000B890(*(PVOID *)(32i64 * (j + 1) + *((_QWORD *)P + 3) + 24));
    }
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x66u, (__int64)&unk_140012870);
  }
  sub_14000B890(*(PVOID *)(*((_QWORD *)P + 3) + 24i64));
  sub_14000B890(*(PVOID *)P);
  sub_14000C020(*((PVOID *)P + 2), 0x6E635450u);
  sub_14000C020(*((PVOID *)P + 3), 0x6E635450u);
  sub_14000C020(P, 0x6E635450u);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x67u, (__int64)&unk_140012870);
  }
  return 0i64;
}

//----- (000000014000CBA0) ----------------------------------------------------
PVOID __fastcall sub_14000CBA0(unsigned int a1, char a2)
{
  int v3; // er13
  __int64 v4; // r15
  unsigned int v5; // ebx
  PVOID v6; // rdi
  PVOID v7; // rax
  _QWORD *v8; // rax
  __int64 v9; // r14
  unsigned int v10; // ebp
  __int64 v11; // rbx
  _QWORD *v12; // rcx
  PVOID *v13; // rsi
  _QWORD *StartContext; // rax
  void *v15; // rbx
  int v16; // er9
  PVOID v18; // [rsp+40h] [rbp-78h] BYREF
  unsigned int v19; // [rsp+48h] [rbp-70h]
  PVOID Object; // [rsp+50h] [rbp-68h] BYREF
  struct _OBJECT_ATTRIBUTES ObjectAttributes; // [rsp+58h] [rbp-60h] BYREF
  void *ThreadHandle; // [rsp+D0h] [rbp+18h] BYREF

  v3 = 0;
  v4 = a1;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x5Bu, (__int64)&unk_140012870);
  }
  v5 = 32;
  v6 = sub_14000BF00(2, 0x20u, 0x6E635450u);
  if ( v6 )
  {
    *(_QWORD *)v6 = 0i64;
    *((_QWORD *)v6 + 1) = 0i64;
    *((_QWORD *)v6 + 2) = 0i64;
    *((_QWORD *)v6 + 3) = 0i64;
    sub_14000B930((struct _KEVENT **)v6, 1, 0);
    *((_DWORD *)v6 + 2) = v4;
    *((_BYTE *)v6 + 12) = a2;
    *((_QWORD *)v6 + 2) = sub_14000BF00(2, 8 * (int)v4, 0x6E635450u);
    if ( a2 )
      v5 = 32 * (v4 + 1);
    v7 = sub_14000BF00(2, v5, 0x6E635450u);
    *((_QWORD *)v6 + 3) = v7;
    if ( !*((_QWORD *)v6 + 2) || !v7 )
      goto LABEL_38;
    v18 = v6;
    sub_14000B930((struct _KEVENT **)&Object, 0, 0);
    memset(*((void **)v6 + 2), 0, 8 * v4);
    memset(*((void **)v6 + 3), 0, v5);
    sub_14000BDC0(*((PKSPIN_LOCK *)v6 + 3));
    sub_14000B930((struct _KEVENT **)(*((_QWORD *)v6 + 3) + 24i64), 0, 0);
    v8 = (_QWORD *)(*((_QWORD *)v6 + 3) + 8i64);
    v8[1] = v8;
    *v8 = v8;
    if ( (_DWORD)v4 )
    {
      v9 = 0i64;
      v10 = 1;
      while ( 1 )
      {
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
          && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_14000D5E0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x5Cu, (__int64)&unk_140012870, v10);
        }
        v19 = v10;
        if ( a2 )
        {
          v11 = 32i64 * v10;
          sub_14000BDC0((PKSPIN_LOCK)(v11 + *((_QWORD *)v6 + 3)));
          sub_14000B930((struct _KEVENT **)(v11 + *((_QWORD *)v6 + 3) + 24i64), 0, 0);
          v12 = (_QWORD *)(v11 + *((_QWORD *)v6 + 3) + 8i64);
          v12[1] = v12;
          *v12 = v12;
        }
        v13 = (PVOID *)(v9 + *((_QWORD *)v6 + 2));
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
          && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
        {
          sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x4Bu, (__int64)&unk_140012870);
        }
        StartContext = sub_14000BF00(2, 0x10u, 0x6E635448u);
        v15 = StartContext;
        *v13 = 0i64;
        if ( StartContext )
        {
          *(&ObjectAttributes.Length + 1) = 0;
          ObjectAttributes.RootDirectory = 0i64;
          ObjectAttributes.ObjectName = 0i64;
          *(_QWORD *)&ObjectAttributes.Attributes = 0i64;
          ObjectAttributes.SecurityDescriptor = 0i64;
          ObjectAttributes.SecurityQualityOfService = 0i64;
          *StartContext = sub_14000CFC0;
          StartContext[1] = &v18;
          ThreadHandle = 0i64;
          ObjectAttributes.Length = 48;
          if ( !PsCreateSystemThread(
                  &ThreadHandle,
                  0x1FFFFFu,
                  &ObjectAttributes,
                  0i64,
                  0i64,
                  (PKSTART_ROUTINE)StartRoutine,
                  StartContext) )
          {
            ObReferenceObjectByHandle(ThreadHandle, 0, 0i64, 0, v13, 0i64);
            ZwClose(ThreadHandle);
          }
        }
        v16 = 1;
        if ( !*v13 )
        {
          if ( v15 )
            sub_14000C020(v15, 0x6E635448u);
          v16 = 0;
        }
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
          && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
        {
          sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x4Cu, (__int64)&unk_140012870, v16);
        }
        if ( !*(_QWORD *)(v9 + *((_QWORD *)v6 + 2)) )
          break;
        sub_14000D480(Object, 0xFFFFFFFF);
        ++v10;
        v9 += 8i64;
        if ( v10 - 1 >= (unsigned int)v4 )
          goto LABEL_37;
      }
      v3 = -16777213;
    }
LABEL_37:
    sub_14000B890(Object);
    if ( v3 )
    {
LABEL_38:
      sub_14000C5F0(v6);
      v6 = 0i64;
    }
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x5Du, (__int64)&unk_140012870, (int)v6);
  }
  return v6;
}

//----- (000000014000CFB0) ----------------------------------------------------
PVOID __fastcall sub_14000CFB0(unsigned int a1)
{
  return sub_14000CBA0(a1, 0);
}

//----- (000000014000CFC0) ----------------------------------------------------
int __fastcall sub_14000CFC0(PVOID **a1)
{
  PVOID *v1; // r12
  __int64 v3; // r15
  ULONG v4; // er13
  struct _KEVENT *v5; // rcx
  int result; // eax
  int v7; // ebx
  unsigned int v8; // er14
  __int64 v9; // rsi
  KSPIN_LOCK *v10; // rbx
  unsigned __int8 v11; // di
  KIRQL v12; // bp
  char *v13; // rcx
  _QWORD *v14; // rdi
  char *v15; // rax
  _QWORD *v16; // rdx
  _QWORD *v17; // rcx
  void (__fastcall *v18)(_QWORD *); // rax
  PVOID Object[2]; // [rsp+48h] [rbp-50h] BYREF
  __int64 v20; // [rsp+58h] [rbp-40h]

  v1 = *a1;
  v3 = *((unsigned int *)a1 + 2);
  v4 = 2;
  Object[0] = **a1;
  Object[1] = *((PVOID *)v1[3] + 3);
  v20 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x53u, (__int64)&unk_140012870);
  }
  if ( *((_BYTE *)v1 + 12) )
  {
    v4 = 3;
    v20 = *((_QWORD *)v1[3] + 4 * v3 + 3);
  }
  if ( a1[2] )
  {
    v5 = (struct _KEVENT *)a1[2];
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
      && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x54u, (__int64)&unk_140012870, v3);
      v5 = (struct _KEVENT *)a1[2];
    }
    sub_14000BAB0(v5);
  }
  while ( 1 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x71u, (__int64)&unk_140012870);
    }
    result = KeWaitForMultipleObjects(v4, Object, WaitAny, Executive, 0, 0, 0i64, 0i64);
    v7 = result;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      result = sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x72u, (__int64)&unk_140012870, result);
    }
    if ( !v7 )
      break;
    v8 = v3;
    if ( v7 != 2 )
      v8 = 0;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
      && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x56u, (__int64)&unk_140012870, v3);
    }
    v9 = 32i64 * v8;
    v10 = (KSPIN_LOCK *)((char *)v1[3] + v9);
    v11 = KeGetCurrentIrql();
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x31u, (__int64)&unk_140012870);
    }
    if ( v11 == 2 )
    {
      v12 = 2;
      KeAcquireSpinLockAtDpcLevel(v10);
    }
    else
    {
      v12 = KeAcquireSpinLockRaiseToDpc(v10);
    }
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x32u, (__int64)&unk_140012870);
    }
    v13 = (char *)v1[3];
    v14 = 0i64;
    v15 = &v13[v9 + 8];
    v16 = *(_QWORD **)v15;
    if ( *(char **)v15 != v15 )
    {
      v14 = *(_QWORD **)v15;
      if ( (char *)v16[1] != v15 || (v17 = (_QWORD *)*v16, *(_QWORD **)(*v16 + 8i64) != v16) )
        __fastfail(3u);
      *(_QWORD *)v15 = v17;
      v17[1] = v15;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
        && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_14000D5E0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x57u, (__int64)&unk_140012870, v3);
      }
      v13 = (char *)v1[3];
      if ( *(char **)&v13[v9 + 8] != &v13[v9 + 8] )
      {
        sub_14000BAB0(*(PRKEVENT *)&v13[v9 + 24]);
        v13 = (char *)v1[3];
      }
    }
    sub_14000BE50((PKSPIN_LOCK)&v13[v9], v12);
    if ( v14 )
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
        && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_14000D5E0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x58u, (__int64)&unk_140012870, v3);
      }
      v18 = (void (__fastcall *)(_QWORD *))v14[3];
      if ( v18 )
        v18(v14 + 5);
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
        && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
      {
        sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x6Bu, (__int64)&unk_140012870);
      }
      if ( v14 != (_QWORD *)-40i64 )
        sub_14000C020(v14, 0x6E635749u);
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        if ( (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
          && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
        {
          sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x6Cu, (__int64)&unk_140012870);
        }
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 0x80u) != 0
          && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_14000D5E0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x59u, (__int64)&unk_140012870, v3);
        }
      }
    }
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    result = HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine);
    if ( (result & 0x80u) != 0 && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 5u )
      result = sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x55u, (__int64)&unk_140012870, v3);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
    {
      result = HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine);
      if ( (result & 2) != 0 && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
        result = sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x5Au, (__int64)&unk_140012870);
    }
  }
  return result;
}

//----- (000000014000D480) ----------------------------------------------------
__int64 __fastcall sub_14000D480(PVOID Object, unsigned int a2)
{
  __int64 v2; // rbx
  int v4; // eax
  unsigned int v5; // ebx
  _LARGE_INTEGER Timeout; // [rsp+40h] [rbp+8h] BYREF

  v2 = a2;
  Timeout.QuadPart = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059A0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x6Fu, (__int64)&unk_140012870);
  }
  if ( (_DWORD)v2 == -1 )
  {
    v4 = KeWaitForSingleObject(Object, Executive, 0, 0, 0i64);
  }
  else
  {
    Timeout.QuadPart = -10000 * v2;
    v4 = KeWaitForSingleObject(Object, Executive, 0, 0, &Timeout);
  }
  v5 = v4;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(DeviceObject->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_1400059D0((__int64)DeviceObject->Queue.ListEntry.Blink, 0x70u, (__int64)&unk_140012870, v4);
  }
  return v5;
}

//----- (000000014000D550) ----------------------------------------------------
__int64 __fastcall sub_14000D550(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+B8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140014068(a1, 43i64, a3, a2, &v5);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000D5E0) ----------------------------------------------------
__int64 __fastcall sub_14000D5E0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140014068(a1, 43i64, a3, a2, &v5);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000D628) ----------------------------------------------------
__int64 __fastcall sub_14000D628(_DWORD *a1, char *a2, char a3)
{
  signed __int64 v5; // rdi
  __int64 v6; // rcx

  if ( a3 == 4 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x1C6u, (__int64)&unk_140012880);
    }
    *a1 = ((unsigned __int8)HIBYTE(*(_DWORD *)a2) | ((unsigned __int8)BYTE2(*(_DWORD *)a2) << 8))
        + (((unsigned __int8)BYTE1(*(_DWORD *)a2) | ((unsigned __int8)*(_DWORD *)a2 << 8)) << 16);
    return 0i64;
  }
  if ( a3 == 6 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x1C7u, (__int64)&unk_140012880);
    }
    v5 = a2 - (char *)a1;
    v6 = 8i64;
    do
    {
      *(_WORD *)a1 = *(_WORD *)((char *)a1 + v5);
      a1 = (_DWORD *)((char *)a1 + 2);
      --v6;
    }
    while ( v6 );
    return 0i64;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x1C8u, (__int64)&unk_140012880);
  }
  return 4i64;
}

//----- (000000014000D760) ----------------------------------------------------
__int64 sub_14000D760(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140014068(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000D7A4) ----------------------------------------------------
char __fastcall sub_14000D7A4(PFAST_MUTEX FastMutex)
{
  char v1; // di

  v1 = 0;
  if ( !FastMutex )
    return 0;
  sub_14000B030(FastMutex, 0i64, 0i64);
  if ( LOBYTE(FastMutex[1].Contention) )
  {
    ++LODWORD(FastMutex[1].Owner);
    sub_14000AF50(*(PRKEVENT *)&FastMutex[1].Count, 0i64, 0i64);
    v1 = 1;
  }
  sub_14000B110(FastMutex, 0i64, 0i64);
  return v1;
}

//----- (000000014000D804) ----------------------------------------------------
char __fastcall sub_14000D804(PFAST_MUTEX FastMutex)
{
  if ( !FastMutex )
    return 0;
  if ( LOBYTE(FastMutex[1].Contention) )
  {
    sub_14000B030(FastMutex, 0i64, 0i64);
    LOBYTE(FastMutex[1].Contention) = 0;
    sub_14000B110(FastMutex, 0i64, 0i64);
    sub_14000B6E0(*(PVOID *)&FastMutex[1].Count, 0xFFFFFFFF, 0i64, 0i64);
  }
  return 1;
}

//----- (000000014000D85C) ----------------------------------------------------
void __fastcall sub_14000D85C(__int64 a1)
{
  void *v1; // rcx

  if ( a1 )
  {
    *(_DWORD *)(a1 + 68) = 0;
    v1 = *(void **)(a1 + 56);
    if ( v1 )
      sub_14000AE50(v1, 0i64, 0i64);
  }
}

//----- (000000014000D884) ----------------------------------------------------
bool __fastcall sub_14000D884(__int64 a1)
{
  bool result; // al
  bool v3; // bl

  if ( !a1 )
    return 0;
  v3 = sub_14000AEC0((struct _KEVENT **)(a1 + 56), 1, 0, 0i64, 0i64);
  sub_14000B0A0(a1, 0i64, 0i64);
  *(_DWORD *)(a1 + 64) = 0;
  result = v3;
  *(_DWORD *)(a1 + 68) = 0;
  *(_BYTE *)(a1 + 72) = 0;
  return result;
}

//----- (000000014000D8E4) ----------------------------------------------------
char __fastcall sub_14000D8E4(PFAST_MUTEX FastMutex)
{
  char result; // al

  result = 0;
  if ( FastMutex && !LODWORD(FastMutex[1].Owner) && !LOBYTE(FastMutex[1].Contention) && !HIDWORD(FastMutex[1].Owner) )
  {
    sub_14000B030(FastMutex, 0i64, 0i64);
    sub_14000AFC0(*(PRKEVENT *)&FastMutex[1].Count, 0i64, 0i64);
    LOBYTE(FastMutex[1].Contention) = 1;
    sub_14000B110(FastMutex, 0i64, 0i64);
    result = 1;
  }
  return result;
}

//----- (000000014000D940) ----------------------------------------------------
char __fastcall sub_14000D940(PFAST_MUTEX FastMutex)
{
  if ( !FastMutex || !*(_QWORD *)&FastMutex[1].Count || !LODWORD(FastMutex[1].Owner) )
    return 0;
  sub_14000B030(FastMutex, 0i64, 0i64);
  if ( LODWORD(FastMutex[1].Owner)-- == 1 )
    sub_14000AFC0(*(PRKEVENT *)&FastMutex[1].Count, 0i64, 0i64);
  sub_14000B110(FastMutex, 0i64, 0i64);
  return 1;
}

//----- (000000014000D9A0) ----------------------------------------------------
char __fastcall sub_14000D9A0(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1)
{
  char result; // al
  int v5; // [rsp+50h] [rbp+18h] BYREF

  result = sub_14000DB40((_DWORD *)BugCheckParameter2, &v5);
  if ( result )
  {
    if ( *(_BYTE *)(BugCheckParameter1 + 45) )
      KeBugCheckEx(0xDEFECAu, BugCheckParameter1, BugCheckParameter2, 0i64, 0i64);
  }
  return result;
}

//----- (000000014000D9F0) ----------------------------------------------------
char __fastcall sub_14000D9F0(__int64 a1, __int64 a2)
{
  char result; // al
  int v5; // [rsp+40h] [rbp+18h] BYREF

  result = sub_14000DB40((_DWORD *)a1, &v5);
  if ( result && !*(_DWORD *)(a2 + 40) && !*(_BYTE *)(a2 + 45) )
  {
    result = MEMORY[0xFFFFF78000000014];
    *(_QWORD *)(a2 + 48) = MEMORY[0xFFFFF78000000014];
    *(_BYTE *)(a2 + 45) = 1;
    if ( a1 )
      ++*(_QWORD *)(a1 + 32);
  }
  return result;
}

//----- (000000014000DA40) ----------------------------------------------------
__int64 __fastcall sub_14000DA40(int a1, struct _FAST_MUTEX *a2, KIRQL *a3)
{
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  int v6; // ecx

  if ( !a2 )
  {
    v3 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v4 = 22;
LABEL_6:
    sub_1400059A0(*(_QWORD *)&v3->AlignmentRequirement, v4, (__int64)&unk_140012890);
    return 3i64;
  }
  if ( !a3 )
  {
    v3 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v4 = 23;
    goto LABEL_6;
  }
  v6 = a1 - 1;
  if ( v6 )
  {
    if ( v6 == 1 )
      sub_14000B030(a2, 0i64, 0i64);
  }
  else
  {
    sub_14000B180((PKSPIN_LOCK)a2, a3, 0i64, 0i64);
  }
  return 0i64;
}

//----- (000000014000DB00) ----------------------------------------------------
bool __fastcall sub_14000DB00(int a1, int a2)
{
  bool v2; // r8
  int v3; // ecx

  v2 = 1;
  if ( a2 )
  {
    v3 = a1 - 1;
    if ( v3 )
    {
      if ( v3 != 1 || (unsigned int)(a2 - 1) > 1 )
        v2 = 0;
    }
    else
    {
      v2 = a2 == 2;
    }
  }
  return v2;
}

//----- (000000014000DB40) ----------------------------------------------------
char __fastcall sub_14000DB40(_DWORD *a1, _DWORD *a2)
{
  char v4; // bl
  PDEVICE_OBJECT v6; // r9
  unsigned __int16 v7; // dx

  v4 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xE8u, (__int64)&unk_140012890);
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 4) != 0 )
    {
      v4 = 1;
      v6 = DeviceObject;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        if ( (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          v7 = 234;
LABEL_20:
          sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_140012890);
          v6 = DeviceObject;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else
    {
      v6 = DeviceObject;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        if ( (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          v7 = 235;
          goto LABEL_20;
        }
LABEL_21:
        if ( v6 != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, 0xECu, (__int64)&unk_140012890);
        }
        return v4;
      }
    }
    return v4;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xE9u, (__int64)&unk_140012890);
  }
  *a2 = 3;
  return 0;
}

//----- (000000014000DCB0) ----------------------------------------------------
__int64 __fastcall sub_14000DCB0(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  int v9; // eax

  v6 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_140005BE0(
      *(_QWORD *)&DeviceObject->AlignmentRequirement,
      0xDAu,
      (__int64)&unk_140012890,
      *(_QWORD *)(BugCheckParameter1 + 16));
    v6 = DeviceObject;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 219;
LABEL_10:
    sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_140012890);
    return 3i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 220;
    goto LABEL_10;
  }
  if ( !a3 )
    sub_14000D9A0(BugCheckParameter2, BugCheckParameter1);
  v9 = *(_DWORD *)(BugCheckParameter1 + 40);
  if ( v9 )
    *(_DWORD *)(BugCheckParameter1 + 40) = v9 - 1;
  sub_14000D9F0(BugCheckParameter2, BugCheckParameter1);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_140010FB0(
      *(_QWORD *)&DeviceObject->AlignmentRequirement,
      0xDDu,
      (__int64)&unk_140012890,
      *(_DWORD *)(BugCheckParameter1 + 40));
  }
  return 0i64;
}

//----- (000000014000DE00) ----------------------------------------------------
__int64 __fastcall sub_14000DE00(__int64 a1, __int64 a2, char a3)
{
  unsigned int v6; // esi
  PDEVICE_OBJECT v7; // rcx
  _QWORD *v9; // r14
  _QWORD *v10; // rdi
  __int64 v11; // rcx
  _QWORD *v12; // rax
  __int64 v13; // rcx
  void (__fastcall *v14)(__int64); // rax

  v6 = 0;
  v7 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x6Du, (__int64)&unk_140012890);
    v7 = DeviceObject;
  }
  if ( a1 && a2 )
  {
    if ( !*(_DWORD *)(a2 + 16) )
    {
      v6 = 4;
      goto LABEL_9;
    }
    v9 = *(_QWORD **)a2;
    if ( *(_QWORD *)a2 == a2 )
    {
LABEL_9:
      sub_14000E440(a1, a2, 0);
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x72u, (__int64)&unk_140012890);
      }
      return v6;
    }
    while ( 1 )
    {
      v10 = v9;
      v9 = (_QWORD *)*v9;
      v11 = *v10;
      v12 = (_QWORD *)v10[1];
      if ( *(_QWORD **)(*v10 + 8i64) != v10 || (_QWORD *)*v12 != v10 )
        __fastfail(3u);
      *v12 = v11;
      *(_QWORD *)(v11 + 8) = v12;
      --*(_DWORD *)(a2 + 16);
      if ( !a3 )
        goto LABEL_31;
      v13 = v10[4];
      if ( v13 )
      {
        v14 = *(void (__fastcall **)(__int64))(a1 + 56);
        if ( v14 )
        {
          v14(v13);
LABEL_31:
          if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
            && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
            && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            sub_140005BE0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x71u, (__int64)&unk_140012890, v10[2]);
          }
          sub_14000B470(*(_QWORD *)(a1 + 72), (__int64)v10, 0i64, 0i64);
          goto LABEL_36;
        }
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x70u, (__int64)&unk_140012890);
        }
        v6 = 5;
      }
      else
      {
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x6Fu, (__int64)&unk_140012890);
        }
        v6 = 6;
      }
LABEL_36:
      if ( *(_QWORD *)a2 == a2 )
        goto LABEL_9;
    }
  }
  if ( v7 != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(v7->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_140005B30(*(_QWORD *)&v7->AlignmentRequirement, 0x6Eu, (__int64)&unk_140012890, a1, a2);
  }
  return 3i64;
}

//----- (000000014000E070) ----------------------------------------------------
__int64 __fastcall sub_14000E070(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  __int64 *v7; // rax
  __int64 result; // rax
  int v9; // [rsp+20h] [rbp-18h]

  v6 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x69u, (__int64)&unk_140012890);
    v6 = DeviceObject;
  }
  if ( a1 && a2 && a3 )
  {
    if ( !*(_DWORD *)(a2 + 16) )
    {
      sub_14000E950(a1, a2, 0);
      v6 = DeviceObject;
    }
    if ( v6 != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v9 = *(_DWORD *)(a3 + 40);
      sub_14000D760(*(_QWORD *)&v6->AlignmentRequirement, 0x6Bu, (__int64)&unk_140012890, *(_QWORD *)(a3 + 16), v9);
    }
    v7 = *(__int64 **)(a2 + 8);
    *(_QWORD *)a3 = a2;
    *(_QWORD *)(a3 + 8) = v7;
    if ( *v7 != a2 )
      __fastfail(3u);
    *v7 = a3;
    *(_QWORD *)(a2 + 8) = a3;
    ++*(_DWORD *)(a2 + 16);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x6Cu, (__int64)&unk_140012890);
    }
    result = 0i64;
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_140007CF0(*(_QWORD *)&v6->AlignmentRequirement, 0x6Au, (__int64)&unk_140012890, a1, a2, a3);
    }
    result = 3i64;
  }
  return result;
}

//----- (000000014000E200) ----------------------------------------------------
__int64 __fastcall sub_14000E200(__int64 a1, unsigned int a2, __int64 *a3, char a4)
{
  __int64 v6; // rbp
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  __int64 result; // rax
  __int64 *v11; // rcx
  __int64 **v12; // rax
  signed __int32 v13; // er9
  PDEVICE_OBJECT v14; // rcx
  __int64 v15; // [rsp+20h] [rbp-28h]
  unsigned int v16; // [rsp+50h] [rbp+8h] BYREF

  v16 = 0;
  v6 = a2;
  v8 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x62u, (__int64)&unk_140012890);
    v8 = DeviceObject;
  }
  if ( !a1 )
  {
    if ( v8 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v8->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v9 = 99;
LABEL_10:
    sub_1400059A0(*(_QWORD *)&v8->AlignmentRequirement, v9, (__int64)&unk_140012890);
    return 3i64;
  }
  if ( !a3 )
  {
    if ( v8 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v8->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v9 = 100;
    goto LABEL_10;
  }
  if ( v8 != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(v8->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_14000D760(*(_QWORD *)&v8->AlignmentRequirement, 0x65u, (__int64)&unk_140012890, a3[2], *((_DWORD *)a3 + 10));
  }
  if ( a4 || !sub_14000DB40((_DWORD *)a1, &v16) )
  {
    v11 = (__int64 *)*a3;
    v12 = (__int64 **)a3[1];
    if ( *(__int64 **)(*a3 + 8) != a3 || *v12 != a3 )
      __fastfail(3u);
    *v12 = v11;
    v11[1] = (__int64)v12;
    --*(_DWORD *)(a1 + 80 * v6 + 96);
    v13 = _InterlockedDecrement((volatile signed __int32 *)(a1 + 8));
    v14 = DeviceObject;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
    {
      if ( (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        LODWORD(v15) = *(_DWORD *)(a1 + 80 * v6 + 96);
        sub_140010F00(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x67u, (__int64)&unk_140012890, a3[2], v15, v13);
        v14 = DeviceObject;
      }
      if ( v14 != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(v14->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
        && BYTE1(v14->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_1400059A0(*(_QWORD *)&v14->AlignmentRequirement, 0x68u, (__int64)&unk_140012890);
      }
    }
    result = v16;
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x66u, (__int64)&unk_140012890);
    }
    result = 12i64;
  }
  return result;
}
// 14000E3E9: variable 'v15' is possibly undefined

//----- (000000014000E440) ----------------------------------------------------
__int64 __fastcall sub_14000E440(__int64 a1, __int64 a2, char a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx

  v6 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x1Du, (__int64)&unk_140012890);
    v6 = DeviceObject;
  }
  if ( !a1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 30;
LABEL_10:
    sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_140012890);
    return 3i64;
  }
  if ( !a2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 31;
    goto LABEL_10;
  }
  if ( a3 )
  {
    sub_14000E560(*(_DWORD *)(a1 + 24), a2 + 24);
    v6 = DeviceObject;
  }
  if ( v6 != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, 0x20u, (__int64)&unk_140012890);
  }
  return 0i64;
}

//----- (000000014000E560) ----------------------------------------------------
__int64 __fastcall sub_14000E560(int a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  int v6; // ebx
  unsigned __int16 v7; // dx

  v4 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x10u, (__int64)&unk_140012890);
    v4 = DeviceObject;
  }
  if ( a2 )
  {
    if ( a1 )
    {
      v6 = a1 - 1;
      if ( v6 )
      {
        if ( v6 != 1 )
          goto LABEL_27;
        if ( v4 != (PDEVICE_OBJECT)&DeviceObject )
        {
          if ( (HIDWORD(v4->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
            && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            v7 = 20;
LABEL_26:
            sub_1400059A0(*(_QWORD *)&v4->AlignmentRequirement, v7, (__int64)&unk_140012890);
            v4 = DeviceObject;
            goto LABEL_27;
          }
          goto LABEL_27;
        }
      }
      else if ( v4 != (PDEVICE_OBJECT)&DeviceObject )
      {
        if ( (HIDWORD(v4->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          v7 = 19;
          goto LABEL_26;
        }
LABEL_27:
        if ( v4 != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(v4->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_1400059A0(*(_QWORD *)&v4->AlignmentRequirement, 0x15u, (__int64)&unk_140012890);
        }
        return 0i64;
      }
    }
    else if ( v4 != (PDEVICE_OBJECT)&DeviceObject )
    {
      if ( (HIDWORD(v4->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
        && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        v7 = 18;
        goto LABEL_26;
      }
      goto LABEL_27;
    }
    return 0i64;
  }
  if ( v4 != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(v4->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_1400059A0(*(_QWORD *)&v4->AlignmentRequirement, 0x11u, (__int64)&unk_140012890);
  }
  return 3i64;
}

//----- (000000014000E6C0) ----------------------------------------------------
unsigned __int64 __fastcall sub_14000E6C0(__int64 a1, unsigned __int64 a2, _DWORD *a3)
{
  unsigned __int64 result; // rax

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x5Au, (__int64)&unk_140012890);
  }
  *a3 = 0;
  if ( a1 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x5Cu, (__int64)&unk_140012890);
    }
    result = a2 % *(unsigned int *)(a1 + 4);
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x5Bu, (__int64)&unk_140012890);
    }
    *a3 = 3;
    result = 0xFFFFFFFFi64;
  }
  return result;
}

//----- (000000014000E7C0) ----------------------------------------------------
_DWORD *__fastcall sub_14000E7C0(__int64 a1, __int64 a2, _DWORD *a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  _DWORD *v9; // rax
  _DWORD *v10; // rdi

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x5Du, (__int64)&unk_140012890);
  }
  *a3 = 0;
  if ( !a1 )
  {
    v6 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v7 = 94;
LABEL_10:
    sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_140012890);
LABEL_11:
    *a3 = 3;
    return 0i64;
  }
  if ( !a2 )
  {
    v6 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v7 = 95;
    goto LABEL_10;
  }
  v9 = sub_14000B400(*(_QWORD *)(a1 + 72), 0i64, 0i64);
  v10 = v9;
  if ( !v9 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x60u, (__int64)&unk_140012890);
    }
    *a3 = 2;
    return 0i64;
  }
  memset(v9, 0, 0x38ui64);
  *((_QWORD *)v10 + 3) = *(_QWORD *)(a1 + 16);
  *((_QWORD *)v10 + 4) = a2;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x61u, (__int64)&unk_140012890);
  }
  return v10;
}

//----- (000000014000E950) ----------------------------------------------------
__int64 __fastcall sub_14000E950(__int64 a1, __int64 a2, char a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx

  v6 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x19u, (__int64)&unk_140012890);
    v6 = DeviceObject;
  }
  if ( !a1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 26;
LABEL_10:
    sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_140012890);
    return 3i64;
  }
  if ( !a2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 27;
    goto LABEL_10;
  }
  *(_QWORD *)(a2 + 8) = a2;
  *(_QWORD *)a2 = a2;
  *(_DWORD *)(a2 + 16) = 0;
  if ( a3 )
    sub_14000EA80(*(_DWORD *)(a1 + 24), (KSPIN_LOCK *)(a2 + 24));
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x1Cu, (__int64)&unk_140012890);
  }
  return 0i64;
}

//----- (000000014000EA80) ----------------------------------------------------
__int64 __fastcall sub_14000EA80(int a1, KSPIN_LOCK *a2)
{
  PDEVICE_OBJECT v4; // rcx
  int v6; // ebx

  v4 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xAu, (__int64)&unk_140012890);
    v4 = DeviceObject;
  }
  if ( a2 )
  {
    if ( a1 )
    {
      v6 = a1 - 1;
      if ( !v6 )
      {
        if ( v4 != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(v4->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_1400059A0(*(_QWORD *)&v4->AlignmentRequirement, 0xDu, (__int64)&unk_140012890);
        }
        sub_14000B200(a2, 0i64, 0i64);
        goto LABEL_28;
      }
      if ( v6 == 1 )
      {
        if ( v4 != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(v4->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_1400059A0(*(_QWORD *)&v4->AlignmentRequirement, 0xEu, (__int64)&unk_140012890);
        }
        sub_14000B0A0((__int64)a2, 0i64, 0i64);
        goto LABEL_28;
      }
    }
    else
    {
      if ( v4 == (PDEVICE_OBJECT)&DeviceObject )
        return 0i64;
      if ( (HIDWORD(v4->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
        && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_1400059A0(*(_QWORD *)&v4->AlignmentRequirement, 0xCu, (__int64)&unk_140012890);
LABEL_28:
        v4 = DeviceObject;
        goto LABEL_29;
      }
    }
LABEL_29:
    if ( v4 != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(v4->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_1400059A0(*(_QWORD *)&v4->AlignmentRequirement, 0xFu, (__int64)&unk_140012890);
    }
    return 0i64;
  }
  if ( v4 != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(v4->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_1400059A0(*(_QWORD *)&v4->AlignmentRequirement, 0xBu, (__int64)&unk_140012890);
  }
  return 3i64;
}

//----- (000000014000EC30) ----------------------------------------------------
_QWORD *__fastcall sub_14000EC30(__int64 a1, unsigned int a2, __int64 a3, _DWORD *a4)
{
  __int64 v5; // r14
  _QWORD *v8; // rsi
  _QWORD *result; // rax
  _QWORD *v10; // rcx
  _QWORD *v11; // rbx
  PDEVICE_OBJECT v12; // rcx

  v5 = a2;
  v8 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xB0u, (__int64)&unk_140012890);
  }
  *a4 = 4;
  if ( a1 )
  {
    v10 = (_QWORD *)(a1 + 80 * (v5 + 1));
    if ( (_QWORD *)*v10 != v10 )
    {
      v11 = (_QWORD *)*v10;
      while ( v11 != v10 )
      {
        v8 = v11;
        if ( v11[2] == a3 )
        {
          v12 = DeviceObject;
          if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
            && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
            && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
          {
            sub_140010FB0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xB2u, (__int64)&unk_140012890, v5);
            v12 = DeviceObject;
          }
          if ( *((_BYTE *)v11 + 44) )
          {
            if ( v12 != (PDEVICE_OBJECT)&DeviceObject
              && (HIDWORD(v12->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
              && BYTE1(v12->DeviceQueue.DeviceListHead.Flink) >= 4u )
            {
              sub_140005BE0(*(_QWORD *)&v12->AlignmentRequirement, 0xB3u, (__int64)&unk_140012890, v11[2]);
            }
            *a4 = 8;
          }
          else
          {
            *a4 = 0;
          }
          break;
        }
        v11 = (_QWORD *)*v11;
        v8 = 0i64;
      }
    }
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xB4u, (__int64)&unk_140012890);
    }
    result = v8;
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xB1u, (__int64)&unk_140012890);
    }
    *a4 = 3;
    result = 0i64;
  }
  return result;
}

//----- (000000014000EE00) ----------------------------------------------------
char __fastcall sub_14000EE00(_DWORD *a1, _DWORD *a2)
{
  char v4; // bl
  PDEVICE_OBJECT v6; // r9
  unsigned __int16 v7; // dx

  v4 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xE3u, (__int64)&unk_140012890);
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 2) != 0 )
    {
      v4 = 1;
      v6 = DeviceObject;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        if ( (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          v7 = 229;
LABEL_20:
          sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_140012890);
          v6 = DeviceObject;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else
    {
      v6 = DeviceObject;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        if ( (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          v7 = 230;
          goto LABEL_20;
        }
LABEL_21:
        if ( v6 != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, 0xE7u, (__int64)&unk_140012890);
        }
        return v4;
      }
    }
    return v4;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xE4u, (__int64)&unk_140012890);
  }
  *a2 = 3;
  return 0;
}

//----- (000000014000EF70) ----------------------------------------------------
__int64 __fastcall sub_14000EF70(unsigned int a1)
{
  PDEVICE_OBJECT v2; // r10
  unsigned int v3; // ebx
  int *v4; // rax
  unsigned int v5; // ecx

  v2 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x10Au, (__int64)&unk_140012890);
    v2 = DeviceObject;
  }
  v3 = 0;
  v4 = (int *)&unk_1400128A0;
  v5 = 0;
  while ( *v4 < a1 )
  {
    ++v5;
    ++v4;
    if ( v5 >= 0x1D )
    {
      if ( v2 == (PDEVICE_OBJECT)&DeviceObject )
        return v3;
      if ( (HIDWORD(v2->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
        && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_1400059A0(*(_QWORD *)&v2->AlignmentRequirement, 0x10Bu, (__int64)&unk_140012890);
LABEL_16:
        v2 = DeviceObject;
        goto LABEL_17;
      }
      goto LABEL_17;
    }
  }
  v3 = *v4;
  if ( v2 == (PDEVICE_OBJECT)&DeviceObject )
    return v3;
  if ( (HIDWORD(v2->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0 && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_1400059D0(*(_QWORD *)&v2->AlignmentRequirement, 0x10Cu, (__int64)&unk_140012890, *v4);
    goto LABEL_16;
  }
LABEL_17:
  if ( v2 != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(v2->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&v2->AlignmentRequirement, 0x10Du, (__int64)&unk_140012890);
  }
  return v3;
}

//----- (000000014000F0A0) ----------------------------------------------------
__int64 __fastcall sub_14000F0A0(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx

  v6 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xD6u, (__int64)&unk_140012890);
    v6 = DeviceObject;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 215;
LABEL_10:
    sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_140012890);
    return 3i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 216;
    goto LABEL_10;
  }
  if ( !a3 )
  {
    sub_14000D9A0(BugCheckParameter2, BugCheckParameter1);
    v6 = DeviceObject;
  }
  if ( !*(_BYTE *)(BugCheckParameter1 + 45) )
  {
    ++*(_DWORD *)(BugCheckParameter1 + 40);
    v6 = DeviceObject;
  }
  if ( v6 != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_140010FB0(
      *(_QWORD *)&v6->AlignmentRequirement,
      0xD9u,
      (__int64)&unk_140012890,
      *(_DWORD *)(BugCheckParameter1 + 40));
  }
  return 0i64;
}

//----- (000000014000F1F0) ----------------------------------------------------
__int64 __fastcall sub_14000F1F0(int a1, struct _FAST_MUTEX *a2, KIRQL a3)
{
  __int64 result; // rax
  int v4; // ecx

  if ( a2 )
  {
    v4 = a1 - 1;
    if ( v4 )
    {
      if ( v4 == 1 )
        sub_14000B110(a2, 0i64, 0i64);
    }
    else
    {
      sub_14000B270((PKSPIN_LOCK)a2, a3, 0i64, 0i64);
    }
    result = 0i64;
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x18u, (__int64)&unk_140012890);
    }
    result = 3i64;
  }
  return result;
}

//----- (000000014000F280) ----------------------------------------------------
char __fastcall sub_14000F280(_DWORD *a1, _DWORD *a2)
{
  char v4; // bl
  PDEVICE_OBJECT v6; // r9
  unsigned __int16 v7; // dx

  v4 = 0;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xDEu, (__int64)&unk_140012890);
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 1) != 0 )
    {
      v4 = 1;
      v6 = DeviceObject;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        if ( (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          v7 = 224;
LABEL_20:
          sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_140012890);
          v6 = DeviceObject;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else
    {
      v6 = DeviceObject;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
      {
        if ( (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          v7 = 225;
          goto LABEL_20;
        }
LABEL_21:
        if ( v6 != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, 0xE2u, (__int64)&unk_140012890);
        }
        return v4;
      }
    }
    return v4;
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xDFu, (__int64)&unk_140012890);
  }
  *a2 = 3;
  return 0;
}

//----- (000000014000F3E4) ----------------------------------------------------
__int64 __fastcall sub_14000F3E4(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  __int64 v9; // rbp
  __int64 v10; // r8
  KIRQL v11; // [rsp+60h] [rbp+8h] BYREF
  unsigned int v12; // [rsp+68h] [rbp+10h] BYREF

  v12 = 0;
  v6 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x102u, (__int64)&unk_140012890);
    v6 = DeviceObject;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 259;
LABEL_10:
    sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_140012890);
    return 3i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 260;
    goto LABEL_10;
  }
  v9 = 80i64 * (unsigned int)sub_14000E6C0(BugCheckParameter2, *(_QWORD *)(BugCheckParameter1 + 16), &v12);
  sub_14000DA40(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v9 + BugCheckParameter2 + 104), &v11);
  sub_14000D9A0(BugCheckParameter2, BugCheckParameter1);
  if ( a3 )
  {
    *(_QWORD *)(BugCheckParameter1 + 24) = a3;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_140005B30(
        *(_QWORD *)&DeviceObject->AlignmentRequirement,
        0x105u,
        (__int64)&unk_140012890,
        *(_QWORD *)(BugCheckParameter1 + 16),
        a3);
    }
  }
  else
  {
    v10 = *(_QWORD *)(BugCheckParameter2 + 16);
    *(_QWORD *)(BugCheckParameter1 + 24) = v10;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_140005B30(
        *(_QWORD *)&DeviceObject->AlignmentRequirement,
        0x106u,
        (__int64)&unk_140012890,
        *(_QWORD *)(BugCheckParameter1 + 16),
        v10);
    }
  }
  sub_14000F1F0(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v9 + BugCheckParameter2 + 104), v11);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x107u, (__int64)&unk_140012890);
  }
  return v12;
}

//----- (000000014000F5C0) ----------------------------------------------------
__int64 __fastcall sub_14000F5C0(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3)
{
  PDEVICE_OBJECT v6; // rcx
  __int64 result; // rax
  unsigned int v8; // esi
  __int64 v9; // rbp
  unsigned int v10; // esi
  char v11[120]; // [rsp+20h] [rbp-78h] BYREF
  KIRQL v12; // [rsp+A0h] [rbp+8h] BYREF
  unsigned int v13; // [rsp+A8h] [rbp+10h] BYREF

  v13 = 0;
  memset(v11, 0, 0x50ui64);
  v6 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xCFu, (__int64)&unk_140012890);
    v6 = DeviceObject;
  }
  if ( BugCheckParameter1 )
  {
    v8 = sub_14000E6C0(BugCheckParameter2, *(_QWORD *)(BugCheckParameter1 + 16), &v13);
    v9 = 80i64 * v8;
    sub_14000DA40(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v9 + BugCheckParameter2 + 104), &v12);
    sub_14000DCB0(BugCheckParameter2, BugCheckParameter1, 0);
    if ( *(_DWORD *)(BugCheckParameter1 + 40) )
    {
      v10 = v13;
    }
    else
    {
      v10 = sub_14000E200(BugCheckParameter2, v8, (__int64 *)BugCheckParameter1, 0);
      if ( !v10 )
        sub_14000E070(BugCheckParameter2, (__int64)v11, BugCheckParameter1);
    }
    sub_14000F1F0(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v9 + BugCheckParameter2 + 104), v12);
    sub_14000DE00(BugCheckParameter2, (__int64)v11, a3);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xD1u, (__int64)&unk_140012890);
    }
    result = v10;
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(v6->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&v6->AlignmentRequirement, 0xD0u, (__int64)&unk_140012890);
    }
    result = 3i64;
  }
  return result;
}

//----- (000000014000F760) ----------------------------------------------------
_DWORD *__fastcall sub_14000F760(unsigned __int8 a1, int a2, int a3, ULONG a4, __int64 a5, int a6, __int64 a7, __int64 a8, __int64 a9, __int64 a10, _DWORD *a11)
{
  unsigned int v15; // edi
  int v17; // ebx
  int v18; // eax
  int v19; // ebp
  unsigned int v20; // ebx
  _DWORD *v21; // rbx
  char *v22; // rax
  PDEVICE_OBJECT v23; // rcx

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x21u, (__int64)&unk_140012890);
  }
  v15 = 0;
  *a11 = 0;
  if ( a1 > 0x1Eu )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_140010EB0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x22u, (__int64)&unk_140012890, a1);
    }
LABEL_10:
    *a11 = 3;
    return 0i64;
  }
  v17 = 1 << a1;
  v18 = sub_14000EF70(v17);
  v19 = v18;
  if ( !v18 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059D0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x23u, (__int64)&unk_140012890, v17);
    }
    goto LABEL_10;
  }
  v20 = 80 * (v18 + 1);
  if ( !sub_14000DB00(a3, a6) )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_14000D5E0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x24u, (__int64)&unk_140012890, a3);
    }
    goto LABEL_10;
  }
  v21 = sub_14000B2F0(2, v20, a4, 0i64, 0i64);
  if ( !v21 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x25u, (__int64)&unk_140012890);
    }
LABEL_27:
    *a11 = 2;
    return 0i64;
  }
  v22 = sub_14000B560(a3, 0x38u, a4, 0i64, 0i64);
  *((_QWORD *)v21 + 9) = v22;
  if ( !v22 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x26u, (__int64)&unk_140012890);
    }
    sub_14000B380(v21, a4, 0i64, 0i64);
    goto LABEL_27;
  }
  *((_QWORD *)v21 + 2) = a5;
  v21[3] = a4;
  *v21 = a2;
  v21[1] = v19;
  v21[2] = 0;
  v21[6] = a6;
  if ( v19 )
  {
    do
      sub_14000E950((__int64)v21, (__int64)&v21[20 * ++v15], 1);
    while ( v15 < v21[1] );
  }
  *((_QWORD *)v21 + 5) = a7;
  *((_QWORD *)v21 + 6) = a8;
  *((_QWORD *)v21 + 7) = a9;
  *((_QWORD *)v21 + 8) = a10;
  v23 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    if ( (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_140010F60(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x27u, (__int64)&unk_140012890, v21[1]);
      v23 = DeviceObject;
    }
    if ( v23 != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(v23->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(v23->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_1400059A0(*(_QWORD *)&v23->AlignmentRequirement, 0x28u, (__int64)&unk_140012890);
    }
  }
  return v21;
}

//----- (000000014000FB00) ----------------------------------------------------
__int64 __fastcall sub_14000FB00(ULONG_PTR BugCheckParameter2, char a2)
{
  char v2; // r13
  PDEVICE_OBJECT v4; // rcx
  __int64 v6; // rsi
  ULONG_PTR v7; // r12
  _QWORD **v8; // r15
  _QWORD *v9; // r14
  PDEVICE_OBJECT v10; // rcx
  ULONG_PTR v11; // rbx
  int v12; // eax
  int i; // ebx
  unsigned int j; // ebx
  PDEVICE_OBJECT v15; // rcx
  __int64 v16; // [rsp+20h] [rbp-49h]
  char Dst[144]; // [rsp+30h] [rbp-39h] BYREF
  KIRQL v18; // [rsp+D0h] [rbp+67h] BYREF
  char v19; // [rsp+D8h] [rbp+6Fh]
  unsigned int v20; // [rsp+E0h] [rbp+77h] BYREF
  union _LARGE_INTEGER Interval; // [rsp+E8h] [rbp+7Fh] BYREF

  v19 = a2;
  v20 = 0;
  v2 = a2;
  memset(Dst, 0, 0x50ui64);
  v4 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x36u, (__int64)&unk_140012890);
    v4 = DeviceObject;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v4 != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(v4->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&v4->AlignmentRequirement, 0x37u, (__int64)&unk_140012890);
    }
    return 3i64;
  }
  if ( v4 != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(v4->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_140010F60(
      *(_QWORD *)&v4->AlignmentRequirement,
      0x38u,
      (__int64)&unk_140012890,
      *(_DWORD *)(BugCheckParameter2 + 4));
  }
  _InterlockedIncrement((volatile signed __int32 *)(BugCheckParameter2 + 28));
  v6 = 0i64;
  if ( *(_DWORD *)(BugCheckParameter2 + 4) )
  {
    while ( 1 )
    {
      v7 = 80 * v6 + BugCheckParameter2;
      sub_14000DA40(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v7 + 104), &v18);
      v8 = (_QWORD **)(80 * v6 + BugCheckParameter2 + 80);
      v9 = *v8;
      if ( *v8 != v8 )
        break;
LABEL_35:
      sub_14000F1F0(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v7 + 104), v18);
      v6 = (unsigned int)(v6 + 1);
      if ( (unsigned int)v6 >= *(_DWORD *)(BugCheckParameter2 + 4) )
      {
        v2 = v19;
        goto LABEL_37;
      }
    }
    v10 = DeviceObject;
    while ( 1 )
    {
      v11 = (ULONG_PTR)v9;
      v9 = (_QWORD *)*v9;
      if ( *(_BYTE *)(v11 + 44) )
      {
        if ( v10 == (PDEVICE_OBJECT)&DeviceObject
          || (HIDWORD(v10->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
          || BYTE1(v10->DeviceQueue.DeviceListHead.Flink) < 4u )
        {
          goto LABEL_34;
        }
        LODWORD(v16) = *(_DWORD *)(v11 + 40);
        sub_14000D760(*(_QWORD *)&v10->AlignmentRequirement, 0x39u, (__int64)&unk_140012890, *(_QWORD *)(v11 + 16), v16);
      }
      else
      {
        if ( !sub_14000EE00((_DWORD *)BugCheckParameter2, &v20) )
          v20 = sub_14000DCB0(BugCheckParameter2, v11, 1);
        if ( *(_DWORD *)(v11 + 40) )
        {
          *(_BYTE *)(v11 + 44) = 1;
        }
        else
        {
          v20 = sub_14000E200(BugCheckParameter2, v6, (__int64 *)v11, 0);
          if ( v20 )
          {
            v10 = DeviceObject;
            if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
              || (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
              || BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) < 3u )
            {
              goto LABEL_34;
            }
            sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x3Au, (__int64)&unk_140012890);
          }
          else
          {
            sub_14000E070(BugCheckParameter2, (__int64)Dst, v11);
          }
        }
      }
      v10 = DeviceObject;
LABEL_34:
      if ( v9 == v8 )
        goto LABEL_35;
    }
  }
LABEL_37:
  sub_14000DE00(BugCheckParameter2, (__int64)Dst, v2);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x3Bu, (__int64)&unk_140012890);
  }
  v12 = sub_140010530(BugCheckParameter2, &v20);
  if ( v12 )
  {
    Interval.QuadPart = -5000000i64;
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_1400059D0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x3Cu, (__int64)&unk_140012890, v12);
    }
    for ( i = 0; i < 10; ++i )
    {
      if ( !(unsigned int)sub_140010530(BugCheckParameter2, &v20) )
        break;
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_1400059D0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x3Du, (__int64)&unk_140012890, i);
      }
      KeDelayExecutionThread(0, 0, &Interval);
    }
  }
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x3Eu, (__int64)&unk_140012890);
  }
  for ( j = 0; j < *(_DWORD *)(BugCheckParameter2 + 4); ++j )
    sub_14000E440(BugCheckParameter2, BugCheckParameter2 + 80 * (j + 1i64), 1);
  sub_14000B4F0(*(PVOID *)(BugCheckParameter2 + 72), 0i64, 0i64);
  sub_14000B380((PVOID)BugCheckParameter2, *(_DWORD *)(BugCheckParameter2 + 12), 0i64, 0i64);
  v15 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    if ( (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x3Fu, (__int64)&unk_140012890);
      v15 = DeviceObject;
    }
    if ( v15 != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(v15->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v15->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_1400059A0(*(_QWORD *)&v15->AlignmentRequirement, 0x40u, (__int64)&unk_140012890);
    }
  }
  return v20;
}
// 14000FC94: variable 'v16' is possibly undefined

//----- (000000014000FF64) ----------------------------------------------------
__int64 __fastcall sub_14000FF64(int a1)
{
  int v2; // ebx
  int v3; // ebx
  int v4; // ebx
  int v5; // ebx
  int v6; // ebx
  int v7; // ebx
  int v8; // ebx

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x108u, (__int64)&unk_140012890);
  }
  if ( !a1 )
    return 0i64;
  v2 = a1 - 1;
  if ( v2 )
  {
    v3 = v2 - 1;
    if ( !v3 )
      return 3i64;
    v4 = v3 - 1;
    if ( !v4 )
      return 4i64;
    v5 = v4 - 1;
    if ( !v5 )
      return 5i64;
    v6 = v5 - 1;
    if ( !v6 )
      return 6i64;
    v7 = v6 - 1;
    if ( !v7 )
      return 19i64;
    v8 = v7 - 1;
    if ( !v8 || v8 == 1 )
      return 19i64;
  }
  return 1i64;
}

//----- (0000000140010008) ----------------------------------------------------
__int64 __fastcall sub_140010008(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3, _DWORD *a4)
{
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  __int64 v11; // r15
  struct _FAST_MUTEX *v12; // r14
  __int64 v13; // rbp
  int v14; // eax
  char Dst[80]; // [rsp+20h] [rbp-78h] BYREF
  KIRQL v16; // [rsp+A0h] [rbp+8h] BYREF

  memset(Dst, 0, sizeof(Dst));
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x9Au, (__int64)&unk_140012890);
  }
  *a4 = 0;
  if ( !BugCheckParameter2 )
  {
    v8 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v9 = 155;
LABEL_10:
    sub_1400059A0(*(_QWORD *)&v8->AlignmentRequirement, v9, (__int64)&unk_140012890);
LABEL_11:
    *a4 = 3;
    return 0i64;
  }
  if ( !BugCheckParameter1 )
  {
    v8 = DeviceObject;
    if ( DeviceObject == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v9 = 156;
    goto LABEL_10;
  }
  if ( sub_14000EE00((_DWORD *)BugCheckParameter2, a4) )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x9Du, (__int64)&unk_140012890);
    }
    *a4 = 10;
    return 0i64;
  }
  v11 = (unsigned int)sub_14000E6C0(BugCheckParameter2, *(_QWORD *)(BugCheckParameter1 + 16), a4);
  v12 = (struct _FAST_MUTEX *)(80 * v11 + BugCheckParameter2 + 104);
  sub_14000DA40(*(_DWORD *)(BugCheckParameter2 + 24), v12, &v16);
  if ( *(_BYTE *)(BugCheckParameter1 + 44) )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_140005BE0(
        *(_QWORD *)&DeviceObject->AlignmentRequirement,
        0x9Eu,
        (__int64)&unk_140012890,
        *(_QWORD *)(BugCheckParameter1 + 16));
    }
    sub_14000F1F0(*(_DWORD *)(BugCheckParameter2 + 24), v12, v16);
    *a4 = 8;
    return 0i64;
  }
  sub_14000DCB0(BugCheckParameter2, BugCheckParameter1, 0);
  v13 = *(_QWORD *)(BugCheckParameter1 + 32);
  if ( *(_DWORD *)(BugCheckParameter1 + 40) )
  {
    *(_BYTE *)(BugCheckParameter1 + 44) = 1;
  }
  else
  {
    v14 = sub_14000E200(BugCheckParameter2, v11, (__int64 *)BugCheckParameter1, 0);
    *a4 = v14;
    if ( !v14 )
      sub_14000E070(BugCheckParameter2, (__int64)Dst, BugCheckParameter1);
  }
  sub_14000F1F0(*(_DWORD *)(BugCheckParameter2 + 24), v12, v16);
  sub_14000DE00(BugCheckParameter2, (__int64)Dst, a3);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x9Fu, (__int64)&unk_140012890);
  }
  return v13;
}

//----- (0000000140010294) ----------------------------------------------------
__int64 __fastcall sub_140010294(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, char a3, _DWORD *a4)
{
  __int64 v4; // rbp
  __int64 v10; // r12
  struct _FAST_MUTEX *v11; // r14
  _QWORD *v12; // rax
  __int64 v13; // rsi
  int v14; // eax
  char v15[80]; // [rsp+20h] [rbp-78h] BYREF
  KIRQL v16; // [rsp+A0h] [rbp+8h] BYREF

  v4 = 0i64;
  memset(v15, 0, sizeof(v15));
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x93u, (__int64)&unk_140012890);
  }
  *a4 = 0;
  if ( !BugCheckParameter2 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x94u, (__int64)&unk_140012890);
    }
    *a4 = 3;
    return 0i64;
  }
  if ( sub_14000EE00((_DWORD *)BugCheckParameter2, a4) )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x95u, (__int64)&unk_140012890);
    }
    *a4 = 10;
    return 0i64;
  }
  v10 = (unsigned int)sub_14000E6C0(BugCheckParameter2, a2, a4);
  v11 = (struct _FAST_MUTEX *)(80 * v10 + BugCheckParameter2 + 104);
  sub_14000DA40(*(_DWORD *)(BugCheckParameter2 + 24), v11, &v16);
  v12 = sub_14000EC30(BugCheckParameter2, v10, a2, a4);
  v13 = (__int64)v12;
  if ( v12 )
  {
    if ( *a4 == 8 )
    {
      sub_14000F1F0(*(_DWORD *)(BugCheckParameter2 + 24), v11, v16);
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_140005BE0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x96u, (__int64)&unk_140012890, a2);
      }
      return 0i64;
    }
    sub_14000DCB0(BugCheckParameter2, (ULONG_PTR)v12, 0);
    v4 = *(_QWORD *)(v13 + 32);
    if ( *(_DWORD *)(v13 + 40) )
    {
      *(_BYTE *)(v13 + 44) = 1;
    }
    else
    {
      v14 = sub_14000E200(BugCheckParameter2, v10, (__int64 *)v13, 0);
      *a4 = v14;
      if ( !v14 )
        sub_14000E070(BugCheckParameter2, (__int64)v15, v13);
    }
  }
  sub_14000F1F0(*(_DWORD *)(BugCheckParameter2 + 24), v11, v16);
  sub_14000DE00(BugCheckParameter2, (__int64)v15, a3);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x97u, (__int64)&unk_140012890);
  }
  return v4;
}

//----- (0000000140010530) ----------------------------------------------------
__int64 __fastcall sub_140010530(__int64 a1, _DWORD *a2)
{
  __int64 result; // rax
  unsigned __int32 v5; // ebx

  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x73u, (__int64)&unk_140012890);
  }
  *a2 = 0;
  if ( a1 )
  {
    v5 = _InterlockedExchangeAdd((volatile signed __int32 *)(a1 + 8), 0);
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x75u, (__int64)&unk_140012890);
    }
    result = v5;
  }
  else
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x74u, (__int64)&unk_140012890);
    }
    *a2 = 3;
    result = 0i64;
  }
  return result;
}

//----- (0000000140010630) ----------------------------------------------------
ULONG_PTR __fastcall sub_140010630(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  ULONG_PTR v6; // rbp
  PDEVICE_OBJECT v9; // rcx
  _DWORD *v10; // r14
  __int64 v12; // r12
  int v13; // ebx
  __int64 v14; // rbx
  ULONG_PTR *v15; // rax
  ULONG_PTR *v16; // rsi
  ULONG_PTR *v17; // rax
  ULONG_PTR v18; // rax
  ULONG_PTR **v19; // rcx
  ULONG_PTR **v20; // r15
  ULONG_PTR v21; // [rsp+20h] [rbp-68h]
  int v22[18]; // [rsp+40h] [rbp-48h] BYREF
  KIRQL v23; // [rsp+90h] [rbp+8h] BYREF
  ULONG_PTR **v24; // [rsp+A8h] [rbp+20h]

  v24 = (ULONG_PTR **)a4;
  v6 = 0i64;
  v22[0] = 0;
  v9 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xB5u, (__int64)&unk_140012890);
    v9 = DeviceObject;
  }
  v10 = (_DWORD *)a5;
  if ( !a5 )
  {
    if ( v9 != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(v9->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= (unsigned __int8)(a5 + 2) )
    {
      sub_1400059A0(*(_QWORD *)&v9->AlignmentRequirement, 0xB6u, (__int64)&unk_140012890);
    }
    return 0i64;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v9 != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(v9->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&v9->AlignmentRequirement, 0xB7u, (__int64)&unk_140012890);
    }
    *v10 = 3;
    return 0i64;
  }
  if ( a3 )
  {
    if ( _InterlockedCompareExchange((volatile signed __int32 *)(BugCheckParameter2 + 28), 0, 0) )
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xB9u, (__int64)&unk_140012890);
      }
      *v10 = 9;
      return 0i64;
    }
    v12 = (unsigned int)sub_14000E6C0(BugCheckParameter2, a2, v22);
    v14 = 80 * v12;
    sub_14000DA40(
      *(_DWORD *)(BugCheckParameter2 + 24),
      (struct _FAST_MUTEX *)(80 * v12 + BugCheckParameter2 + 104),
      &v23);
    if ( sub_14000F280((_DWORD *)BugCheckParameter2, v22)
      || (v15 = sub_14000EC30(BugCheckParameter2, v12, a2, v22), (v16 = v15) == 0i64) )
    {
      v17 = (ULONG_PTR *)sub_14000E7C0(BugCheckParameter2, a3, v22);
      v16 = v17;
      if ( !v17 )
      {
        v13 = 2;
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xBCu, (__int64)&unk_140012890);
        }
        goto LABEL_56;
      }
      v17[2] = a2;
      if ( !sub_14000EE00((_DWORD *)BugCheckParameter2, v22) )
        sub_14000F0A0(BugCheckParameter2, (ULONG_PTR)v16, 1);
      v18 = v14 + BugCheckParameter2 + 80;
      v19 = *(ULONG_PTR ***)(v18 + 8);
      *v16 = v18;
      v16[1] = (ULONG_PTR)v19;
      if ( *v19 != (ULONG_PTR *)v18 )
        __fastfail(3u);
      *v19 = v16;
      *(_QWORD *)(v18 + 8) = v16;
      ++*(_DWORD *)(v14 + BugCheckParameter2 + 96);
      _InterlockedIncrement((volatile signed __int32 *)(BugCheckParameter2 + 8));
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v21 = v16[2];
        sub_140011000(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xBDu, (__int64)&unk_140012890, v12);
      }
      v13 = v22[0];
    }
    else
    {
      sub_14000D9A0(BugCheckParameter2, (ULONG_PTR)v15);
      v13 = v22[0];
      if ( v22[0] == 8 )
      {
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 3u )
        {
          sub_140005BE0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xBAu, (__int64)&unk_140012890, a2);
        }
        goto LABEL_56;
      }
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v21 = v16[2];
        sub_140010FB0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xBBu, (__int64)&unk_140012890, v12);
      }
    }
    v20 = v24;
    v6 = v16[4];
    if ( v24 )
    {
      sub_14000F0A0(BugCheckParameter2, (ULONG_PTR)v16, 1);
      *v20 = v16;
    }
    goto LABEL_56;
  }
  if ( v9 != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(v9->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_1400059A0(*(_QWORD *)&v9->AlignmentRequirement, 0xB8u, (__int64)&unk_140012890);
  }
  LODWORD(v12) = a5;
  v13 = 3;
LABEL_56:
  sub_14000F1F0(
    *(_DWORD *)(BugCheckParameter2 + 24),
    (struct _FAST_MUTEX *)(80i64 * (unsigned int)v12 + BugCheckParameter2 + 104),
    v23);
  *v10 = v13;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    LODWORD(v21) = v13;
    sub_14000D760(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xBEu, (__int64)&unk_140012890, v6, v21);
  }
  return v6;
}
// 140010A84: variable 'v21' is possibly undefined

//----- (0000000140010AA4) ----------------------------------------------------
__int64 __fastcall sub_140010AA4(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR *a4)
{
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  __int64 result; // rax
  ULONG_PTR v11; // rax
  PDEVICE_OBJECT v12; // r10
  unsigned int v13; // ebx
  __int64 v14; // [rsp+60h] [rbp+8h] BYREF

  v8 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x86u, (__int64)&unk_140012890);
    v8 = DeviceObject;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v8 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v8->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v9 = 135;
LABEL_10:
    sub_1400059A0(*(_QWORD *)&v8->AlignmentRequirement, v9, (__int64)&unk_140012890);
    return 3i64;
  }
  if ( !a3 )
  {
    if ( v8 == (PDEVICE_OBJECT)&DeviceObject
      || (HIDWORD(v8->DeviceQueue.DeviceListHead.Flink) & 0x80u) == 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v9 = 136;
    goto LABEL_10;
  }
  if ( _InterlockedCompareExchange((volatile signed __int32 *)(BugCheckParameter2 + 28), 0, 0) )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x89u, (__int64)&unk_140012890);
    }
    result = 9i64;
  }
  else
  {
    v11 = sub_140010630(BugCheckParameter2, a2, a3, (__int64)a4, (__int64)&v14);
    if ( v11 )
    {
      if ( v11 == a3 )
      {
        v13 = v14;
        v12 = DeviceObject;
      }
      else
      {
        if ( a4 )
          sub_14000F5C0(BugCheckParameter2, *a4, 1);
        v12 = DeviceObject;
        if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
          && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
          && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_140005BE0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x8Bu, (__int64)&unk_140012890, a2);
          v12 = DeviceObject;
        }
        v13 = 7;
      }
      if ( v12 != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(v12->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
        && BYTE1(v12->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_1400059A0(*(_QWORD *)&v12->AlignmentRequirement, 0x8Cu, (__int64)&unk_140012890);
      }
      result = v13;
    }
    else
    {
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_1400059D0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0x8Au, (__int64)&unk_140012890, v14);
      }
      result = (unsigned int)v14;
    }
  }
  return result;
}

//----- (0000000140010CD0) ----------------------------------------------------
__int64 __fastcall sub_140010CD0(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, _QWORD *a3, _DWORD *a4)
{
  __int64 v8; // rbp
  unsigned int v10; // ebx
  struct _FAST_MUTEX *v11; // r15
  _QWORD *v12; // rax
  _QWORD *v13; // rbx
  KIRQL v14; // [rsp+50h] [rbp+8h] BYREF

  v8 = 0i64;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xACu, (__int64)&unk_140012890);
  }
  *a4 = 4;
  if ( !BugCheckParameter2 )
  {
    if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
      && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
      && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xADu, (__int64)&unk_140012890);
    }
    *a4 = 3;
    return 0i64;
  }
  v10 = sub_14000E6C0(BugCheckParameter2, a2, a4);
  v11 = (struct _FAST_MUTEX *)(80i64 * v10 + BugCheckParameter2 + 104);
  sub_14000DA40(*(_DWORD *)(BugCheckParameter2 + 24), v11, &v14);
  v12 = sub_14000EC30(BugCheckParameter2, v10, a2, a4);
  v13 = v12;
  if ( v12 )
  {
    if ( *a4 == 8 )
    {
      sub_14000F1F0(*(_DWORD *)(BugCheckParameter2 + 24), v11, v14);
      if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
        && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
        && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_140005BE0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xAEu, (__int64)&unk_140012890, a2);
      }
      return 0i64;
    }
    v8 = v12[4];
    if ( a3 )
    {
      sub_14000F0A0(BugCheckParameter2, (ULONG_PTR)v12, 0);
      *a3 = v13;
    }
  }
  sub_14000F1F0(*(_DWORD *)(BugCheckParameter2 + 24), v11, v14);
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject
    && (HIDWORD(DeviceObject->DeviceQueue.DeviceListHead.Flink) & 0x80u) != 0
    && BYTE1(DeviceObject->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1400059A0(*(_QWORD *)&DeviceObject->AlignmentRequirement, 0xAFu, (__int64)&unk_140012890);
  }
  return v8;
}

//----- (0000000140010EB0) ----------------------------------------------------
__int64 __fastcall sub_140010EB0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140014068(a1, 43i64, a3, a2, &v5);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140010F00) ----------------------------------------------------
__int64 sub_140010F00(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140014068(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140010F60) ----------------------------------------------------
__int64 __fastcall sub_140010F60(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140014068(a1, 43i64, a3, a2, &v5);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140010FB0) ----------------------------------------------------
__int64 __fastcall sub_140010FB0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140014068(a1, 43i64, a3, a2, &v5);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140011000) ----------------------------------------------------
__int64 __fastcall sub_140011000(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140014068(a1, 43i64, a3, a2, &v5);
}
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140011060) ----------------------------------------------------
BOOLEAN sub_140011060()
{
  return KeCancelTimer(&stru_140016780);
}

//----- (0000000140018000) ----------------------------------------------------
void sub_140018000()
{
  PDEVICE_OBJECT v0; // rbx

  v0 = DeviceObject;
  if ( DeviceObject != (PDEVICE_OBJECT)&DeviceObject )
  {
    if ( dword_140014088 == 4 )
    {
      while ( v0 )
      {
        if ( v0->Vpb )
          qword_140014070();
        v0 = v0->NextDevice;
      }
    }
    else if ( dword_140014088 == 2 )
    {
      IoWMIRegistrationControl(DeviceObject, 0x80000002);
    }
    DeviceObject = (PDEVICE_OBJECT)&DeviceObject;
  }
}
// 140014070: using guessed type __int64 (*qword_140014070)(void);
// 140014088: using guessed type int dword_140014088;

//----- (0000000140018070) ----------------------------------------------------
void sub_140018070()
{
  struct _DEVICE_OBJECT *v0; // rbx

  v0 = &stru_1400167C0;
  if ( DeviceObject != &stru_1400167C0 )
  {
    DeviceObject = &stru_1400167C0;
    if ( dword_140014088 == 4 )
    {
      do
      {
        v0->Vpb = 0i64;
        qword_140014078(v0->DriverObject, 0i64, sub_140008CB0, v0, &v0->Vpb);
        v0 = v0->NextDevice;
      }
      while ( v0 );
    }
    else if ( dword_140014088 == 2 )
    {
      *(_QWORD *)&stru_1400167C0.Type = sub_140018200;
      IoWMIRegistrationControl(&stru_1400167C0, 0x80010001);
    }
  }
}
// 140014078: invalid function type has been ignored
// 140014078: using guessed type __int64 (__fastcall *qword_140014078)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 140014088: using guessed type int dword_140014088;

//----- (00000001400180F8) ----------------------------------------------------
__int64 (*sub_1400180F8())(void)
{
  __int64 (*result)(void); // rax
  _UNICODE_STRING DestinationString; // [rsp+30h] [rbp-10h] BYREF
  unsigned int v2; // [rsp+50h] [rbp+10h] BYREF

  v2 = 0;
  RtlInitUnicodeString(&DestinationString, L"PsGetVersion");
  qword_140014080 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&DestinationString);
  RtlInitUnicodeString(&DestinationString, L"WmiTraceMessage");
  qword_140014068 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&DestinationString);
  RtlInitUnicodeString(&DestinationString, L"WmiQueryTraceInformation");
  qword_140014060 = (__int64)MmGetSystemRoutineAddress(&DestinationString);
  result = (__int64 (*)(void))qword_140014080;
  dword_140014088 = 2;
  if ( qword_140014080 )
    result = (__int64 (*)(void))qword_140014080(&v2, 0i64, 0i64, 0i64);
  if ( v2 >= 6 )
  {
    RtlInitUnicodeString(&DestinationString, L"EtwRegisterClassicProvider");
    result = (__int64 (*)(void))MmGetSystemRoutineAddress(&DestinationString);
    qword_140014078 = (__int64)result;
    if ( result )
    {
      RtlInitUnicodeString(&DestinationString, L"EtwUnregister");
      result = (__int64 (*)(void))MmGetSystemRoutineAddress(&DestinationString);
      qword_140014070 = result;
      dword_140014088 = 4;
    }
  }
  return result;
}
// 140014060: using guessed type __int64 qword_140014060;
// 140014068: using guessed type __int64 (__fastcall *qword_140014068)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 140014070: using guessed type __int64 (*qword_140014070)(void);
// 140014078: using guessed type __int64 qword_140014078;
// 140014080: using guessed type __int64 (__fastcall *qword_140014080)(_QWORD, _QWORD, _QWORD, _QWORD);
// 140014088: using guessed type int dword_140014088;

//----- (0000000140018200) ----------------------------------------------------
__int64 __fastcall sub_140018200(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6)
{
  unsigned int *v6; // r13
  unsigned int v7; // ebx
  __int64 v10; // rsi
  unsigned int v11; // edi
  __int64 v12; // rax
  const void **v13; // r15
  unsigned int v14; // ebp
  unsigned int v15; // er12
  _WORD *v16; // rcx
  _DWORD *v17; // r14
  __int64 v18; // rcx
  __int128 v19; // xmm0
  __int64 v20; // rdi
  __int64 v21; // rax
  char v23; // [rsp+70h] [rbp+8h] BYREF

  v6 = a6;
  v7 = 0;
  *a6 = 0;
  if ( a1 <= 3u )
    return (unsigned int)-1073741808;
  if ( a1 <= 5u )
  {
    v20 = a5;
    if ( !a5 )
      return (unsigned int)-1073741163;
    if ( a3 < 0x30 )
      return (unsigned int)-1073741811;
    while ( RtlCompareMemory(*(const void **)(v20 + 8), a4 + 6, 0x10ui64) != 16 )
    {
      v20 = *(_QWORD *)(v20 + 16);
      if ( !v20 )
        return (unsigned int)-1073741163;
    }
    if ( a1 == 5 )
    {
      *(_DWORD *)(v20 + 44) = 0;
      *(_QWORD *)(v20 + 24) = 0i64;
      *(_BYTE *)(v20 + 41) = 0;
    }
    else
    {
      v21 = *((_QWORD *)a4 + 1);
      *(_QWORD *)(v20 + 24) = v21;
      if ( dword_140014088 == 2 )
      {
        if ( !(unsigned int)qword_140014060(3i64, &v23, 4i64, &a6, a4) )
          *(_BYTE *)(v20 + 41) = v23;
        v7 = qword_140014060(2i64, v20 + 44, 4i64, &a6, a4);
      }
      else
      {
        *(_DWORD *)(v20 + 44) = HIDWORD(v21);
        *(_BYTE *)(v20 + 41) = BYTE2(v21);
      }
    }
    return v7;
  }
  if ( a1 <= 7u )
    return v7;
  if ( a1 != 8 )
    return (unsigned int)-1073741808;
  v10 = a5;
  v11 = 0;
  v12 = a5;
  v13 = *(const void ***)(a5 + 32);
  do
  {
    v12 = *(_QWORD *)(v12 + 16);
    ++v11;
  }
  while ( v12 );
  if ( v11 > 0x3F )
    return (unsigned int)-1073741811;
  v14 = 32 * v11 + 24;
  if ( v13 )
  {
    v15 = 32 * v11 + 24;
    v14 += *(unsigned __int16 *)v13 + 2;
  }
  else
  {
    v15 = 0;
  }
  if ( v14 > a3 )
  {
    v7 = -1073741789;
    if ( a3 >= 4 )
    {
      *a4 = v14;
      *v6 = 4;
    }
  }
  else
  {
    memset(a4, 0, a3);
    *a4 = v14;
    a4[2] = v15;
    a4[4] = v11;
    if ( v13 )
    {
      v16 = (_WORD *)((char *)a4 + v15);
      *v16 = *(_WORD *)v13;
      memmove(v16 + 1, v13[1], *(unsigned __int16 *)v13);
    }
    if ( v11 )
    {
      v17 = a4 + 10;
      v18 = v11;
      do
      {
        v19 = *(_OWORD *)*(_QWORD *)(v10 + 8);
        *v17 = 528384;
        v17 += 8;
        *((_OWORD *)v17 - 3) = v19;
        *(_BYTE *)(v10 + 41) = 0;
        *(_DWORD *)(v10 + 44) = 0;
        v10 = *(_QWORD *)(v10 + 16);
        --v18;
      }
      while ( v18 );
    }
    *v6 = v14;
  }
  return v7;
}
// 140014060: invalid function type has been ignored
// 140014060: using guessed type __int64 (__fastcall *qword_140014060)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 140014088: using guessed type int dword_140014088;

//----- (0000000140019000) ----------------------------------------------------
NTSTATUS __stdcall DriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath)
{
  _security_init_cookie();
  return sub_140008908(DriverObject);
}

// nfuncs=237 queued=197 decompiled=197 lumina nreq=0 worse=0 better=0
// ALL OK, 197 function(s) have been successfully decompiled
