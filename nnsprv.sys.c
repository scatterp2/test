/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall sub_11008(__int64 a1, unsigned __int16 a2, __int64 a3);
__int64 __fastcall sub_1102C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_110AC(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_11148(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_11194(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_11230(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_1127C(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4);
__int64 __fastcall sub_112FC(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_11338(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_113D0(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_11430(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_11478(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_114E4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_11544(__int64 a1, __int64 a2, __int64 a3, int a4, char a5, char a6, const char *a7);
__int64 __fastcall sub_115F4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_1164C(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_116CC(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_11764(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_1182C(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_1188C(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_11908(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, const char *a5);
__int64 __fastcall sub_119B8(__int64 a1, __int64 a2, __int64 a3, __int16 a4, __int64 a5);
__int64 __fastcall sub_11B0C(__int64 a1, char a2, __int64 *a3, __int64 a4);
NTSTATUS __stdcall DriverEntry(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath);
void __fastcall sub_129DC(struct _DEVICE_OBJECT *a1);
__int64 __fastcall sub_13788(__int64 a1, IRP *a2);
__int64 sub_137B0();
__int64 __fastcall sub_13A88(__int64 a1, IRP *a2);
__int64 __fastcall sub_13D18(__int64 a1, IRP *a2);
__int64 sub_13E0C();
__int64 __fastcall sub_14268(__int64 a1, union _LARGE_INTEGER *a2, unsigned int a3, __int64 a4, _DWORD *a5);
__int64 __fastcall sub_14528(unsigned int a1, _QWORD *a2);
__int64 __fastcall sub_14568(__int64 a1);
__int64 __fastcall sub_14594(__int64 a1, unsigned int a2);
__int64 __fastcall sub_147AC(unsigned int a1, __int64 a2, int *a3, int a4, __int64 a5);
__int64 sub_14B0C();
__int64 __fastcall sub_14E54(int a1, __int64 a2);
__int64 __fastcall sub_15050(__int64 *a1, int a2);
void __fastcall sub_15254(__int64 *a1, __int64 a2);
void __fastcall sub_15C58(__int64 *a1);
__int64 __fastcall sub_15D38(__int64 a1);
__int64 __fastcall sub_15DFC(__int64 a1, __int64 a2, unsigned int a3, __int64 a4, _DWORD *a5);
__int64 __fastcall sub_16088(__int64 a1, _QWORD *a2, unsigned int a3);
__int64 __fastcall sub_16388(__int64 a1, __int64 a2, unsigned int a3);
__int64 __fastcall sub_16618(__int64 a1, __int64 a2, __int64 a3, unsigned int *a4, _QWORD *a5, _DWORD *a6);
ULONG_PTR __fastcall sub_167A4(_QWORD **a1);
__int64 __fastcall sub_16A88(__int64 a1, __int64 a2);
__int64 __fastcall sub_16B6C(PVOID StartContext, int *a2);
__int64 __fastcall sub_1700C(__int64 a1);
__int64 __fastcall sub_17238(__int64 a1, char a2);
__int64 __fastcall sub_17354(__int64 a1, int a2);
__int64 __fastcall sub_173D4(__int64 a1);
__int64 __fastcall sub_17448(__int64 a1, int a2);
__int64 __fastcall sub_17548(__int64 a1, __int64 a2);
__int64 __fastcall sub_17648(__int64 a1);
__int64 __fastcall sub_17784(__int64 a1);
__int64 sub_178F4();
void sub_17918();
void __fastcall sub_17F30(__int64 *a1, _DWORD *a2, char *a3);
__int64 __fastcall sub_1820C(int a1, __int64 a2, _QWORD *a3, int a4, char a5);
__int64 __fastcall sub_1843C(int a1, __int64 a2, _QWORD *a3, int a4, char a5);
void __fastcall sub_1864C(__int64 a1, char a2);
__int64 __fastcall sub_187B8(signed __int32 *a1, unsigned int a2);
__int64 __fastcall sub_188D4(const signed __int32 *a1);
__int64 __fastcall sub_189A0(__int64 a1, int a2);
void __fastcall sub_18B70(const void *a1, unsigned int a2, void *a3, int a4, int a5, int a6, int a7, PLARGE_INTEGER a8, char a9);
void __fastcall sub_18E4C(__int64 a1);
__int64 __fastcall sub_18EDC(_BYTE *a1);
__int64 __fastcall sub_18F68(__int64 a1, _DWORD *a2);
__int64 sub_190CC();
__int64 __fastcall sub_19248(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_19410(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_195E4(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_197B8(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_19940(__int64 a1, __int64 a2, unsigned int a3);
__int64 __fastcall sub_19B74(__int64 a1, __int64 a2);
__int64 __fastcall sub_19C6C(__int64 a1, __int64 a2, __int64 a3, _DWORD *a4, _QWORD *a5, _DWORD *a6);
char __fastcall sub_19D94(__int64 a1, __int64 a2);
__int64 __fastcall sub_19F78(int a1, __int64 a2, int a3);
__int64 __fastcall sub_1A078(int a1, __int64 a2, int a3);
__int64 __fastcall sub_1A248(__int64 a1, __int64 a2);
__int64 __fastcall sub_1A32C(__int64 a1);
__int64 __fastcall sub_1A670(__int64 a1);
__int64 __fastcall sub_1A840(__int64 a1, int a2, __int64 a3);
void __fastcall sub_1AB08(__int64 a1);
__int64 __fastcall sub_1B2A0(__int64 a1, __int64 a2, _DWORD *a3);
__int64 __fastcall sub_1B63C(__int64 a1, char a2, _DWORD *a3);
__int64 __fastcall sub_1C180(__int64 a1, char a2);
__int64 __fastcall sub_1C6C4(__int64 a1);
char __fastcall sub_1C988(__int64 a1);
__int64 __fastcall sub_1CA88(__int64 a1, int a2);
__int64 __fastcall sub_1CB00(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_1CC8C(__int64 a1, _BYTE *a2);
char __fastcall sub_1CF58(__int64 a1);
__int64 __fastcall sub_1D144(int a1, __int64 a2, int a3, _DWORD *a4, void **a5, _DWORD *a6);
__int64 __fastcall sub_1D2C8(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_1D34C(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 sub_1D3B0(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_1D3F8(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_1D47C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_1D4DC(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_1D530(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_1D620(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_1D6E8(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_1D79C(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_1D878(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_1D8D0(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_1D940(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_1D9CC(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_1DA38(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_1DAE4();
__int64 __fastcall sub_1DC34(int a1, __int64 a2, int a3);
__int64 __fastcall sub_1DE00(__int64 a1, __int64 a2);
__int64 __fastcall sub_1DED8(__int64 a1);
_DWORD *__fastcall sub_1E94C(__int64 a1, int a2, __int64 a3);
void __fastcall sub_1E9C4(__int64 a1);
__int64 __fastcall sub_1EA38(__int64 a1, int a2);
__int64 __fastcall sub_1EB34(__int64 a1, int a2, _QWORD *a3, _QWORD **a4);
__int64 __fastcall sub_1ED14(__int64 a1, unsigned int a2);
__int64 __fastcall sub_1EECC(__int64 *a1);
__int64 __fastcall sub_1F3F0(__int64 a1, __int64 a2, _DWORD *a3);
__int64 __fastcall sub_1FF94(__int64 *a1);
__int64 __fastcall sub_200B4(PVOID StartContext, int *a2);
__int64 __fastcall sub_20744(__int64 a1, __int64 a2);
__int64 __fastcall sub_20824(__int64 a1);
__int64 __fastcall sub_20A64(_QWORD *a1, unsigned int a2);
__int64 __fastcall sub_20CB4(__int64 a1, struct _NET_BUFFER *a2);
void __fastcall sub_20F00(_QWORD *a1);
__int64 __fastcall sub_210F8(__int64 a1, __int64 a2);
__int64 __fastcall sub_21254(__int64 *a1, int a2, int a3);
__int64 __fastcall sub_21490(__int64 a1, struct _NET_BUFFER *a2);
__int64 __fastcall sub_215D0(__int64 a1);
__int64 __fastcall sub_216A0(PNET_BUFFER NetBuffer, __int64 a2, char a3, __int64 a4);
__int64 __fastcall sub_21938(__int64 a1);
PDEVICE_OBJECT *__fastcall sub_21A08(__int64 a1, PDEVICE_OBJECT **a2, struct _DEVICE_OBJECT **a3);
PDEVICE_OBJECT __fastcall sub_21AB0(__int64 a1, _QWORD *a2);
void __fastcall sub_21B30(_QWORD *a1, _QWORD *a2);
__int64 __fastcall sub_21CF0(_QWORD *a1, ULONG_PTR a2, _DWORD *a3);
__int64 __fastcall sub_22510(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_22A3C(PNET_BUFFER NetBuffer, int a2, char a3, __int64 a4, __int64 a5);
__int64 __fastcall sub_22FA4(__int64 a1, int a2, __int64 a3, _DWORD *a4);
__int64 sub_231F0(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_23244(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_232A4(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 sub_232FC(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_2335C(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4, char a5, char a6, const char *a7);
__int64 sub_23418(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_234B4();
__int64 __fastcall sub_236BC(unsigned __int64 *a1, ULONG_PTR **a2, int a3);
__int64 __fastcall sub_23944(unsigned __int64 a1, unsigned int *a2);
__int64 __fastcall sub_23BD0(__int64 a1, unsigned __int64 a2);
__int64 __fastcall sub_23EA4(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_240F4(unsigned __int64 a1, __int64 *a2, _QWORD *a3, int a4);
__int64 __fastcall sub_2422C(ULONG_PTR a1, int a2);
__int64 __fastcall sub_243C4(ULONG_PTR BugCheckParameter1, int a2);
__int64 __fastcall sub_24560(__int64 a1);
__int64 sub_24834();
void __fastcall sub_24EB4(__int64 a1);
__int64 sub_25188(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
char __fastcall sub_251F4(PVOID StartContext, _DWORD *a2);
char __fastcall sub_255AC(__int64 *a1, int a2);
void __fastcall StartRoutine(PVOID StartContext);
__int64 sub_25CAC(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_25D04(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_25D5C(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_25DB0(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_25E14(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_25E74(__int64 a1, __int64 a2, __int64 a3, ...);
char __fastcall sub_25EF8(__int64 a1);
char __fastcall sub_25F7C(__int64 a1, unsigned __int16 a2, unsigned __int16 a3);
_DWORD *__fastcall sub_26214(__int64 *a1, __int64 a2);
__int64 __fastcall sub_26328(__int64 a1, __int64 a2, int a3);
__int64 __fastcall sub_263C8(__int64 a1, __int64 *a2, __int64 a3);
__int64 __fastcall sub_265B8(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_26950(__int64 a1, __int64 a2);
__int64 __fastcall sub_26A2C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_26B9C(__int64 a1, __int64 a2);
__int64 __fastcall sub_26DB8(__int64 a1, __int64 a2);
__int64 __fastcall sub_27028(__int64 a1, __int64 *a2, _QWORD *a3, ULONG_PTR **a4, __int64 *a5, __int64 a6);
__int64 __fastcall sub_27CDC(__int64 a1, __int64 a2, _QWORD *a3);
__int64 __fastcall sub_27E8C(__int64 a1, __int64 a2);
__int64 __fastcall sub_28048(int *a1);
__int64 __fastcall sub_283CC(__int64 a1);
__int64 sub_2879C();
void sub_28A20();
__int64 sub_28A70();
void sub_28AD8();
__int64 __fastcall sub_28B24(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_28B88(__int64 a1, __int64 a2, __int64 a3, int a4, _WORD *a5);
unsigned __int8 __fastcall sub_28C34(int a1, _DWORD *a2, _DWORD *a3, _DWORD *a4);
PDEVICE_OBJECT *__fastcall sub_2920C(__int64 a1);
void __fastcall sub_2957C(__int64 a1);
__int64 sub_29F60();
__int64 sub_2A0B4();
__int64 sub_2A310();
__int64 sub_2A65C();
__int64 __fastcall sub_2ACF8(wchar_t *Str2, _DWORD *a2);
PVOID __fastcall sub_2AF40(_WORD *a1);
__int64 __fastcall sub_2B228(__int64 a1);
__int64 sub_2B354();
__int64 sub_2B828();
__int64 __fastcall sub_2BA8C(_WORD *a1, _DWORD *a2);
__int64 __fastcall sub_2BE50(__int64 a1, __int64 a2, __int64 a3, int a4, char a5, const char *a6);
__int64 __fastcall sub_2BEEC(int **a1);
PVOID __fastcall sub_2C130(int *a1, int a2);
__int64 __fastcall sub_2C274(int *a1);
__int64 __fastcall sub_2C3A4(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_2C4A8(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_2C55C(__int64 a1, __int64 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_2C648(__int64 a1, __int64 a2, _DWORD *a3);
__int64 __fastcall sub_2C80C(__int64 a1, __int64 a2, char a3, _DWORD *a4);
__int64 __fastcall sub_2D248(unsigned int a1, __int64 a2, unsigned __int8 *a3, int *a4, unsigned __int8 *a5, __int64 a6, int a7);
__int64 __fastcall sub_2DC54(__int64 a1, __int64 a2);
void __fastcall sub_2E44C(PVOID StartContext);
__int64 __fastcall sub_2E7B8(void *Src); // idb
__int64 __fastcall sub_2E948(__int64 a1);
__int64 sub_2EB84();
char *__fastcall sub_2EC90(void *Src, _DWORD *a2);
__int64 __fastcall sub_2F084(__int64 a1, char a2);
__int64 __fastcall sub_2F338(__int64 a1);
void sub_2F3D8();
__int64 __fastcall sub_2F598(__int64 a1, _DWORD *a2);
__int64 sub_2F7B8(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_2F80C(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_2F848();
__int64 sub_2FA74();
__int64 __fastcall sub_2FBE4(_QWORD *a1);
_QWORD *__fastcall sub_2FCDC(void *Src, ULONG_PTR **a2, int *a3);
__int64 __fastcall sub_30380(unsigned __int64 a1, _QWORD *a2, _DWORD *a3);
__int64 __fastcall sub_304E0(ULONG_PTR BugCheckParameter1); // idb
__int64 __fastcall sub_30588(ULONG_PTR BugCheckParameter1); // idb
__int64 __fastcall sub_30678(__int64 a1);
__int64 __fastcall sub_30A80(void *Src, _BYTE *a2, _DWORD *a3, _BYTE *a4);
__int64 sub_30D34();
void sub_30DA8();
__int64 __fastcall sub_30EA8(void *Dst, _DWORD *a2);
__int64 __fastcall sub_31058(int *a1, _BYTE *a2, _QWORD *a3);
__int64 __fastcall sub_31438(void *Dst, __int64 a2, const void *a3);
__int64 __fastcall sub_31554(__int64 a1, __int64 a2, const __m128i *a3);
__int64 __fastcall sub_31700(__int64 a1);
__int64 __fastcall sub_318C8(unsigned __int8 *a1, int *a2, char a3);
__int64 __fastcall sub_31AE0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_31B40(__int64 a1, __int64 a2, __int64 a3, char a4);
__int64 __fastcall sub_31B98(__int64 a1, __int64 a2, __int64 a3, int a4, char a5, char a6, const char *a7, char a8, char a9, const char *a10, char a11, const char *a12);
__int64 __fastcall sub_31D34(__int64 a1, __int64 a2, __int64 a3, int a4, char a5, const char *a6, const char *a7);
__int64 __fastcall sub_31E08(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, const char *a5);
__int64 __fastcall sub_31E88(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5, char a6, char a7, char a8, char a9, const char *a10);
__int64 __fastcall sub_31FA4(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5, char a6, const char *a7, char a8, char a9, const char *a10);
__int64 __fastcall sub_32110(__int64 a1, __int64 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_321A4(__int64 a1, __int64 a2, __int64 a3, const char *a4, char a5, const char *a6);
__int64 sub_3225C();
__int64 __fastcall sub_3246C(__int64 a1, __int64 a2, _BYTE *a3);
__int64 __fastcall sub_32644(__int64 a1, __int64 a2);
__int64 __fastcall sub_327A4(__int64 a1, __int64 a2);
char __fastcall sub_33270(__int64 a1, __int64 a2);
char __fastcall sub_33740(__int64 a1, _DWORD *a2, unsigned int *a3);
__int64 __fastcall sub_33FB0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_34694(__int64 a1);
__int64 __fastcall sub_34C44(_QWORD *a1, _DWORD *a2);
__int64 __fastcall sub_34EF4(PVOID *a1);
__int64 sub_3502C();
void sub_351D4();
__int64 __fastcall sub_35728(__int64 a1);
__int64 __fastcall sub_35FD4(const void *a1);
__int64 __fastcall sub_36204(PVOID P, unsigned int a2);
__int64 __fastcall sub_36358(unsigned int a1);
__int64 __fastcall sub_365AC(_WORD *a1, unsigned int a2);
__int64 __fastcall sub_368DC(__int64 a1);
__int64 __fastcall sub_36A30(PVOID P); // idb
__int64 sub_36B1C();
__int64 sub_36C8C(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_36D10(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_36D70(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_36DF4(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_36E78(__int64 a1, _QWORD *a2, _BYTE *a3);
void *__fastcall sub_37534(__int64 a1, __int64 a2, const void *a3, _QWORD *a4);
__int64 __fastcall sub_3760C(_QWORD *a1);
int __fastcall sub_37674(void *Src, _BYTE *a2, const __m128i *a3, const __m128i *a4, __int16 a5, __int16 a6);
ULONG_PTR __fastcall sub_37730(__int64 a1, ULONG_PTR a2, _DWORD *a3, _QWORD *a4, __int64 (*a5)(void), void (__fastcall *a6)(__int64), unsigned int a7, __int64 a8, char a9, ULONG_PTR **a10);
__int64 __fastcall sub_37AF4(_QWORD *a1, _QWORD *a2, __int64 a3, __int64 a4, int a5, int a6, int a7, __int64 a8);
unsigned __int64 __fastcall sub_37C68(_DWORD *a1);
__int64 __fastcall sub_37DB0(_QWORD *a1, char a2);
__int64 __fastcall sub_37F20(__int64 a1);
__int64 __fastcall sub_38148(_DWORD *a1);
void __fastcall sub_38174(PVOID Object);
__int64 __fastcall sub_38400(ULONG_PTR BugCheckParameter2, __int64 a2);
__int64 sub_385D4(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_38628(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_386AC(__int64 a1, __int64 a2);
void sub_38A90();
__int64 __fastcall sub_38C30(__int64 *a1, _WORD *a2, unsigned __int16 a3, const __m128i *a4, const __m128i *a5, _QWORD *a6, _BYTE *a7);
ULONG_PTR __fastcall sub_3929C(__int64 a1, __int64 a2, _DWORD *a3, unsigned int a4, __int64 a5, ULONG_PTR *a6, ULONG_PTR **a7, __int64 a8);
_DWORD *sub_398DC();
void __fastcall sub_399D4(__int64 a1);
__int64 __fastcall sub_39AC4(_QWORD *a1, unsigned __int8 a2, __int64 a3, _BYTE *a4);
__int64 __fastcall sub_39D5C(__int64 a1, __int64 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_39DF4(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int *a5);
__int64 __fastcall sub_3A268(__int64 a1, __int64 a2, __int64 a3, __int64 a4, _DWORD *a5);
__int64 __fastcall sub_3A27C(__int64 a1, __int64 *a2);
__int64 sub_3A628();
__int64 sub_3A928();
__int64 __fastcall sub_3AB3C(int a1, __int64 a2, int a3, _DWORD *a4, void **a5, _DWORD *a6);
__int64 __fastcall sub_3ACB8(__int64 a1, __int64 a2);
void sub_3B040();
__int64 __fastcall sub_3B1B4(__int64 *a1, _WORD *a2, unsigned __int16 a3, const __m128i *a4, const __m128i *a5, __int64 a6, _BYTE *a7);
ULONG_PTR __fastcall sub_3B668(__int64 a1, _DWORD *a2, __int64 a3, __int64 a4, unsigned int a5, __int64 a6, _QWORD *a7, _QWORD *a8, _DWORD *a9);
void __fastcall sub_3B844(__int64 a1);
_DWORD *sub_3B934();
__int64 __fastcall sub_3B9B4(__int64 *a1, char *a2, unsigned __int16 a3, __int64 a4, int a5, _QWORD *a6);
__int64 __fastcall sub_3BCB4(__int64 a1, __int64 a2, int *a3);
__int64 __fastcall sub_3C08C(unsigned __int16 a1, __int16 a2, int *a3);
char __fastcall sub_3C2D8(int a1, __int16 a2, __int16 a3);
__int64 __fastcall sub_3C448(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_3C6D8(__int64 a1, unsigned __int16 a2, char a3, _DWORD *a4);
__int64 __fastcall sub_3C814(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_3C8C4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_3C940(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_3C994(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_3C9F4();
__int64 __fastcall sub_3CB34(unsigned __int8 *a1, ULONG_PTR **a2, _DWORD *a3);
__int64 __fastcall sub_3CDAC(unsigned __int64 *a1, ULONG_PTR **a2);
__int64 __fastcall sub_3CFDC(PVOID P); // idb
__int64 __fastcall sub_3D0C8(ULONG_PTR BugCheckParameter1); // idb
__int64 __fastcall sub_3D170(__int64 a1);
__int64 sub_3DA44();
__int64 sub_3DBA0();
__int64 sub_3DEC8();
__int64 __fastcall sub_3E3D4(__int64 a1, __int64 a2, _BYTE *a3);
__int64 sub_3ECD8();
__int64 __fastcall sub_3EFD8(_QWORD *a1, int *a2);
__int64 __fastcall sub_3F25C(__int64 a1, const void *a2);
__int64 __fastcall sub_3F498(PVOID P, unsigned int a2);
__int64 __fastcall sub_3F5EC(__int64 a1, unsigned __int16 a2);
PVOID __fastcall sub_3F66C(int a1, unsigned int a2, ULONG a3);
void __fastcall sub_3F6F0(PVOID P, ULONG Tag);
PVOID __fastcall sub_3F764(__int64 a1, void *a2, unsigned int a3, unsigned int a4);
char *__fastcall sub_3F8D8(int a1, unsigned int a2, ULONG a3);
void __fastcall sub_3F95C(PVOID P);
_DWORD *__fastcall sub_3FA7C(__int64 a1);
void __fastcall sub_3FAE4(__int64 a1, __int64 a2);
_DWORD *__fastcall sub_3FC10(__int64 a1, unsigned int a2);
__int64 __fastcall sub_3FD2C(PERESOURCE Resource); // idb
__int64 __fastcall sub_3FE00(PERESOURCE Resource); // idb
BOOLEAN __fastcall sub_3FED4(PERESOURCE Resource);
BOOLEAN __fastcall sub_3FFAC(PERESOURCE Resource);
void __fastcall sub_40084(PERESOURCE Resource);
__int64 __fastcall sub_40150(_QWORD *a1);
void __fastcall sub_401B8(PKSPIN_LOCK SpinLock, KIRQL *a2);
void __fastcall sub_40230(PKSPIN_LOCK SpinLock, KIRQL a2);
bool __fastcall sub_402A4(struct _KEVENT **a1, char a2);
void __fastcall sub_4031C(PVOID P);
int __fastcall sub_40384(PRKEVENT Event);
int __fastcall sub_403EC(PRKEVENT Event);
void __fastcall sub_404B8(__int64 a1);
void __fastcall sub_40598(PFAST_MUTEX FastMutex);
void __fastcall sub_40664(PFAST_MUTEX FastMutex);
unsigned __int8 __fastcall sub_40730(PVOID *Object, __int64 a2, __int64 a3);
__int64 __fastcall sub_407B8(PVOID Object); // idb
__int64 __fastcall sub_40820(unsigned int a1);
__int64 __fastcall sub_40888(unsigned int a1);
__int64 __fastcall sub_408F0(PVOID P); // idb
_QWORD *__fastcall sub_40964(__int64 a1, int a2, __int64 a3, __int64 a4);
void __fastcall sub_40AF4(__int64 a1);
__int64 __fastcall sub_40B60(PVOID Object, unsigned int a2);
__int64 __fastcall sub_40BD4(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_40C64(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_40D00(__int64 a1, __int64 a2, __int64 a3, int a4);
PVOID __fastcall sub_40D90(int a1, unsigned int a2, ULONG a3);
void __fastcall sub_40EAC(PVOID P, ULONG Tag);
char *__fastcall sub_40FA4(int a1, unsigned int a2, ULONG a3);
_DWORD *__fastcall sub_41158(__int64 a1);
__int64 __fastcall sub_4125C(_QWORD *a1);
void __fastcall sub_412E0(PKSPIN_LOCK SpinLock, KIRQL *a2);
void __fastcall sub_41398(PKSPIN_LOCK SpinLock, KIRQL a2);
bool __fastcall sub_4143C(struct _KEVENT **a1, char a2);
void __fastcall sub_41524(PVOID P);
int __fastcall sub_415BC(PRKEVENT Event);
void __fastcall HandleInformation(PVOID StartContext);
unsigned __int8 __fastcall sub_416E8(PVOID *Object, __int64 a2, __int64 a3);
__int64 __fastcall sub_41858(PVOID Object); // idb
__int64 __fastcall sub_418EC(void ***a1);
__int64 __fastcall sub_41BF8(unsigned int a1, char a2);
__int64 __fastcall sub_41EAC(PVOID P); // idb
void __fastcall sub_42208(__int64 a1, char a2);
void __fastcall sub_422CC(__int64 a1);
__int64 __fastcall sub_423B0(PVOID Object, unsigned int a2);
__int64 __fastcall sub_42488(ULONG Count, PVOID Object[]); // idb
__int64 sub_42594();
__int64 sub_426C8();
__int64 __fastcall sub_42754(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_42898(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5, const char *a6);
__int64 __fastcall sub_42960(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 sub_429B4(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_42A20(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_42AB8(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_42B1C(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_42B9C(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_42C00(__int64 a1, __int64 a2, __int64 a3, ...);
_BYTE *__fastcall sub_42C74(__int64 a1, int a2);
__int64 __fastcall sub_431D0(__int64 a1, unsigned int a2, __int64 *a3);
__int64 __fastcall sub_4371C(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_438AC(__int64 a1, __int64 a2);
__int64 __fastcall sub_43964(__int64 a1, __int64 a2);
__int64 __fastcall sub_43A18(__int64 a1, _WORD *a2);
__int64 __fastcall sub_43ADC(_BYTE *a1, _BYTE *a2);
__int64 __fastcall sub_43B8C(_BYTE *a1, _BYTE *a2);
__int64 __fastcall sub_43C3C(__int64 a1, _WORD *a2);
__int64 __fastcall sub_43D00(__int64 a1, _WORD *a2);
__int64 __fastcall sub_43DC4(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_43E74(__int64 a1, _WORD *a2);
__int64 __fastcall sub_43F40(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_43FF0(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_440A0(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_44150(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_44214(__int64 a1, unsigned __int8 *a2, _QWORD *a3, _WORD *a4);
char __fastcall sub_444FC(__int64 a1);
__int64 __fastcall sub_446D0(__int64 a1, unsigned __int16 *a2);
__int64 __fastcall sub_44798(__int64 a1, unsigned __int8 *a2);
__int64 __fastcall sub_4484C(__int64 a1, __m128i *a2);
__int64 __fastcall sub_44900(__int64 a1, __m128i *a2);
__int64 __fastcall sub_44A5C(_BYTE *a1, __m128i *a2);
__int64 __fastcall sub_44EC8(_WORD *a1, _WORD *a2);
__int64 __fastcall sub_44F8C(__int64 a1, _WORD *a2);
__int64 __fastcall sub_45050(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_45100(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_451B0(_WORD *a1, _WORD *a2);
__int64 __fastcall sub_45274(__int64 a1, _WORD *a2);
__int64 __fastcall sub_45338(__int64 a1, _QWORD *a2);
__int64 __fastcall sub_453E8(__int64 a1, _WORD *a2);
__int64 __fastcall sub_454AC(__int64 a1, _WORD *a2);
char __fastcall sub_45570(__int16 *a1);
__int64 __fastcall sub_45670(__int64 a1, unsigned __int8 *a2);
__int64 __fastcall sub_45760(__int64 a1, unsigned __int16 a2);
char __fastcall sub_45824(__int64 a1, __int64 a2, unsigned int a3);
__int64 __fastcall sub_458D8(__int64 a1, unsigned __int16 a2);
__int64 __fastcall sub_4599C(__int64 a1, unsigned __int8 a2);
__int64 __fastcall sub_45A54(__int64 a1, unsigned __int16 a2);
char __fastcall sub_45B18(__int64 a1);
__int64 __fastcall sub_45BD8(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_45D6C(__int64 a1, unsigned int a2, unsigned __int16 *a3);
__int64 __fastcall sub_45F84(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_461F4(__int64 a1, unsigned __int8 a2, unsigned __int64 *a3);
__int64 __fastcall sub_46554(__int64 a1, int *a2);
__int64 __fastcall sub_4686C(__int64 a1);
__int64 __fastcall sub_46A6C(unsigned __int8 **a1, unsigned __int8 *a2);
bool __fastcall sub_46BE8(__int64 a1);
__int64 __fastcall sub_46C28(__int64 a1, _WORD *a2);
__int64 __fastcall sub_46CEC(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_46D94(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_46E70(__int64 a1, __int64 a2, _QWORD *a3, _WORD *a4);
__int64 __fastcall sub_46F54(__int64 a1, __int64 a2, _DWORD *a3);
__int16 __fastcall sub_47100(unsigned __int16 *a1);
__int64 __fastcall sub_47270(__int64 a1, _QWORD *a2, unsigned __int16 *a3);
__int64 __fastcall sub_47524(__int64 a1, unsigned __int8 *a2, _QWORD *a3);
char __fastcall sub_476DC(__int64 a1, unsigned __int16 a2);
char __fastcall sub_478B8(__int64 a1, unsigned __int16 a2);
bool __fastcall sub_47A78(char a1, const void *a2);
char __fastcall sub_47ADC(char a1, _BYTE *a2, __int64 a3);
char __fastcall sub_47C5C(_BYTE *a1, __int64 a2);
const char *__fastcall sub_47CFC(unsigned __int8 a1);
__int64 __fastcall sub_47DEC(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_47E50(PVOID **a1);
__int64 __fastcall sub_48380(unsigned int a1);
__int64 __fastcall sub_486D4(PVOID P); // idb
__int64 __fastcall sub_48AD0(__int64 a1);
_QWORD *__fastcall sub_48CA0(__int64 a1, int a2, __int64 a3, __int64 a4);
void __fastcall sub_48E4C(__int64 a1, char a2);
__int64 __fastcall sub_48F24(__int64 a1, unsigned int a2);
__int64 __fastcall sub_49110(__int64 a1, __int64 a2, __int64 a3, const wchar_t *a4);
__int64 __fastcall sub_491C0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_49218(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_4927C(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_492E8(__int16 *a1, int a2, unsigned int *a3);
__int64 __fastcall sub_494BC(char a1);
__int64 __fastcall sub_49558(int a1, int a2);
__int64 __fastcall sub_49738(int a1, __int64 a2, int a3);
__int64 sub_4992C();
__int64 __fastcall sub_49AEC(int a1, const void *a2, unsigned int a3, int a4, int *a5, void (__fastcall *a6)(const void *, _QWORD));
__int64 __fastcall sub_49D44(__int64 a1, void *a2, __int64 a3, int a4, int *a5);
__int64 __fastcall sub_49F00(unsigned int a1, __int64 a2);
__int64 sub_4A050();
__int64 sub_4A2C0();
__int64 __fastcall sub_4A548(int a1);
__int64 sub_4A90C();
__int64 sub_4B070();
__int64 __fastcall sub_4B3D0(int a1, const void *a2, unsigned int a3, int a4, int *a5, void (__fastcall *a6)(const void *, _QWORD));
__int64 __fastcall sub_4B718(__int64 a1, void *a2, __int64 a3, int a4, int *a5);
__int64 __fastcall sub_4BC68(int a1, const void *a2, unsigned int a3, _DWORD *a4);
__int64 __fastcall sub_4BEBC(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_4C114(unsigned int *a1);
__int64 __fastcall sub_4C270(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_4C35C(__int64 a1, int a2, unsigned int a3, void *a4);
__int64 __fastcall sub_4C558(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_4C7CC(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_4CAE4(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_4CCC4(int a1);
__int64 __fastcall sub_4CDB4(int a1, __int64 a2);
__int64 __fastcall sub_4CFA8(int a1, __int64 a2);
__int64 __fastcall sub_4D1A4(int a1, const void *a2, unsigned int a3);
__int64 __fastcall sub_4D4B0(__int64 a1, __int64 a2, __int64 a3);
__int64 sub_4D654();
void __fastcall sub_4D74C(int a1, __int64 a2);
void __fastcall DeferredRoutine(_KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2);
const char *__fastcall sub_4D7E8(int a1);
const char *__fastcall sub_4D84C(unsigned int a1);
const char *__fastcall sub_4D8C4(int a1);
const char *__fastcall sub_4D99C(unsigned int a1);
const char *__fastcall sub_4DA20(int a1);
const char *__fastcall sub_4DA64(int a1);
const char *__fastcall sub_4DAA8(int a1);
const char *__fastcall sub_4DD74(int a1);
const char *__fastcall sub_4DDE8(int a1);
__int64 __fastcall sub_4DE38(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_4DE8C(__int64 a1, __int64 a2, int a3, int a4, _QWORD *a5);
__int64 __fastcall sub_4E420(PVOID *a1, const void *a2, unsigned int a3, const void *a4, int a5, PLARGE_INTEGER Time);
void __fastcall sub_4E948(__int64 a1);
void __fastcall sub_4E9A0(__int64 a1);
__int64 __fastcall sub_4EA14(__int64 a1, __int64 a2, const void *a3, unsigned int a4, void *Src, unsigned int MaxCount, _QWORD *a7);
__int64 __fastcall sub_4EBEC(PVOID *a1, const void *a2, unsigned int a3, void *a4, int a5, PLARGE_INTEGER Time, char a7);
__int64 __fastcall sub_4EC48(PVOID *a1);
__int64 __fastcall sub_4ED98(__int64 a1, const void *a2, size_t a3);
__int64 __fastcall sub_4EEF8(char *a1, _BYTE *a2, char a3, unsigned int a4, int *a5);
char sub_4EFDC();
char sub_4F0EC();
__int64 __fastcall sub_4F240(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6, int a7);
__int64 __fastcall sub_4F2B0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_4F31C(__int64 a1);
__int64 __fastcall sub_4F390(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_4F3EC(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_4F45C(__int64 a1, __int64 a2, _QWORD *a3);
__int64 sub_4F9A0();
__int64 (**sub_4FD40())(void);
void sub_4FE6C();
__int64 __fastcall sub_50028(__int64 a1, void *a2);
__int64 __fastcall sub_502CC(unsigned int a1);
__int64 __fastcall sub_50538(unsigned int a1);
__int64 __fastcall sub_507A8(__int64 a1, unsigned int a2, _QWORD *a3, _DWORD *a4);
__int64 __fastcall sub_50A80(__int64 a1);
__int64 __fastcall sub_50CBC(unsigned int a1, unsigned int a2, __int64 a3, int a4);
char *__fastcall sub_50F88(unsigned int a1);
void sub_51168();
__int64 __fastcall sub_5124C(__int64 a1);
__int64 sub_51804();
__int64 __fastcall sub_51ED0(unsigned int a1, int a2, unsigned int a3, _DWORD *a4);
__int64 __fastcall sub_524C8(__int64 a1, unsigned int a2, __int64 a3);
__int64 __fastcall sub_5288C(int a1);
__int64 __fastcall sub_529E8(int a1);
__int64 __fastcall sub_52B10(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_52B6C(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_52BDC(int a1, _QWORD *a2);
__int64 __fastcall sub_52D80(int a1, __int64 a2);
__int64 __fastcall sub_52EE0(int a1, struct _FAST_MUTEX *a2, KIRQL *a3);
__int64 __fastcall sub_52FA4(int a1, struct _FAST_MUTEX *a2, KIRQL a3);
__int64 __fastcall sub_53038(__int64 a1, __int64 a2, char a3);
__int64 __fastcall sub_53164(__int64 a1, __int64 a2, char a3);
_DWORD *__fastcall sub_53288(char a1, int a2, int a3, ULONG a4, __int64 a5, int a6, __int64 a7, __int64 a8, __int64 a9, __int64 a10, _DWORD *a11);
__int64 __fastcall sub_535C8(__int64 a1);
__int64 __fastcall sub_53950(ULONG_PTR BugCheckParameter2, char a2);
__int64 __fastcall sub_53DDC(__int64 a1, __int64 a2, unsigned __int64 a3);
__int64 __fastcall sub_541A0(ULONG_PTR BugCheckParameter2); // idb
__int64 __fastcall sub_54480(__int64 a1, int a2);
unsigned __int64 __fastcall sub_5482C(__int64 a1, unsigned __int64 a2, _DWORD *a3);
_DWORD *__fastcall sub_54928(__int64 a1, __int64 a2, _DWORD *a3);
__int64 __fastcall sub_54AB0(__int64 a1, unsigned int a2, __int64 *a3, char a4);
__int64 __fastcall sub_54CBC(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_54E3C(__int64 a1, __int64 a2, char a3);
__int64 __fastcall sub_55088(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_55180(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4);
__int64 __fastcall sub_553BC(__int64 a1, unsigned __int64 a2, __int64 a3, _DWORD *a4);
__int64 __fastcall sub_55648(__int64 a1, ULONG_PTR a2);
__int64 __fastcall sub_5575C(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, __int64 a3, _DWORD *a4);
__int64 __fastcall sub_559E0(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, _QWORD *a3, _DWORD *a4);
_QWORD *__fastcall sub_55BD4(__int64 a1, unsigned int a2, __int64 a3, _DWORD *a4);
ULONG_PTR __fastcall sub_55D94(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4, __int64 a5);
__int64 __fastcall sub_5621C(ULONG_PTR BugCheckParameter2, ULONG_PTR *a2, _DWORD *a3);
__int64 __fastcall sub_563E8(ULONG_PTR BugCheckParameter2, ULONG_PTR *a2, char a3, _DWORD *a4);
__int64 __fastcall sub_566A8(__int64 a1, ULONG_PTR a2, __int64 a3, _DWORD *a4);
__int64 __fastcall sub_56864(__int64 a1, ULONG_PTR a2);
__int64 __fastcall sub_56A10(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1); // idb
__int64 __fastcall sub_56BB4(__int64 a1, unsigned __int64 a2);
__int64 __fastcall sub_56DD4(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3);
__int64 __fastcall sub_56F18(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3);
char __fastcall sub_57094(_BYTE *a1, _DWORD *a2);
char __fastcall sub_571E0(_BYTE *a1, _DWORD *a2);
char __fastcall sub_5732C(_BYTE *a1, _DWORD *a2);
__int64 __fastcall sub_57478(__int64 a1);
__int64 __fastcall sub_578A8(__int64 a1);
__int64 __fastcall sub_57D60(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, __int64 a3);
__int64 __fastcall sub_57F30(int a1);
__int64 __fastcall sub_57FD0(unsigned int a1);
__int64 __fastcall sub_58100(__int64 a1, __int64 a2, char a3);
char __fastcall sub_58254(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1);
char __fastcall sub_582AC(PFAST_MUTEX FastMutex);
char __fastcall sub_5830C(PFAST_MUTEX FastMutex);
char __fastcall sub_58374(PFAST_MUTEX FastMutex);
__int64 __fastcall sub_583D8(_QWORD *a1, _QWORD *a2);
void __fastcall sub_5855C(PVOID P);
__int64 __fastcall sub_585CC(__int64 a1, __int64 a2);
__int64 __fastcall sub_58610(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, void *Src);
__int64 __fastcall sub_58778(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4);
__int64 sub_587C8(char *a1, unsigned __int64 a2, CHAR *a3, ...);
__int64 __fastcall sub_587EC(char *a1, unsigned __int64 a2, unsigned __int64 a3, CHAR *a4, __int64 a5);
__int64 sub_58888(char *a1, unsigned __int64 a2, unsigned __int64 a3, CHAR *a4, ...);
__int64 __fastcall sub_588AC(void *a1, size_t a2, const void *a3, size_t a4);
__int64 __fastcall sub_58950(_WORD *a1, __int64 a2, __int16 *a3, __int64 a4);
__int64 __fastcall sub_58A58(char *a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int16 *a4, int *a5);
__int64 sub_58B00(char *a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int16 *a4, ...);
// __int64 __fastcall write_char(_QWORD, _QWORD, _QWORD); weak
// __int64 __fastcall write_multi_char(_QWORD, _QWORD, _QWORD, _QWORD); weak
__int64 __fastcall sub_58BCC(_BYTE *a1, int a2, __int64 a3, _DWORD *a4);
// int __cdecl mbtowc(wchar_t *DstCh, const char *SrcCh, size_t SrcSizeInBytes);
__int64 __fastcall sub_58C94(__int64 a1, CHAR *a2, __int64 a3);
__int64 __fastcall sub_59564(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4);
_WORD *__fastcall sub_59634(__int16 a1, __int64 a2, _DWORD *a3);
_WORD *__fastcall sub_59684(__int16 *a1, int a2, __int64 a3, _DWORD *a4);
__int64 __fastcall sub_596E4(__int64 a1, unsigned __int16 *a2, int *a3);
__int64 __fastcall sub_59FC8(char *a1, unsigned __int64 a2, unsigned __int16 *a3, int *a4);
// int __cdecl flsbuf(int Ch, FILE *File);
// NTSTATUS __stdcall RtlStringCopyWorkerW(NTSTRSAFE_PWSTR pszDest, size_t cchDest, size_t *pcchNewDestLength, STRSAFE_PCNZWCH pszSrc, size_t cchToCopy);
// __int64 __fastcall unknown_libname_2(_QWORD, _QWORD, _QWORD); weak
__int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // weak
// void *__cdecl memmove(void *Dst, const void *Src, size_t MaxCount);
// void *__cdecl memset(void *Dst, int Val, size_t Size);
// NTSTATUS __stdcall RtlUnicodeToMultiByteN(PCHAR MultiByteString, ULONG MaxBytesInMultiByteString, PULONG BytesInMultiByteString, PCWCH UnicodeString, ULONG BytesInUnicodeString);
__int64 __fastcall sub_5A678(_WORD *a1, __int64 a2, __int16 *a3);
__int64 __fastcall sub_5A704(char *a1, unsigned __int64 a2, unsigned __int16 *a3, int *a4);
__int64 sub_5A75C(char *a1, unsigned __int64 a2, unsigned __int16 *a3, ...);
// int __cdecl memcmp(const void *Buf1, const void *Buf2, size_t Size);
// void __stdcall KeStallExecutionProcessor(ULONG MicroSeconds);
// LARGE_INTEGER __stdcall KeQueryPerformanceCounter(PLARGE_INTEGER PerformanceFrequency);
// PVOID __stdcall NdisGetDataBuffer(PNET_BUFFER NetBuffer, ULONG BytesNeeded, PVOID Storage, UINT AlignMultiple, UINT AlignOffset);
// void __stdcall RtlInitUnicodeString(PUNICODE_STRING DestinationString, PCWSTR SourceString);
// void __stdcall IoDeleteDevice(PDEVICE_OBJECT DeviceObject);
// PVOID __stdcall MmGetSystemRoutineAddress(PUNICODE_STRING SystemRoutineName);
// NTSTATUS __stdcall IoGetDeviceObjectPointer(PUNICODE_STRING ObjectName, ACCESS_MASK DesiredAccess, PFILE_OBJECT *FileObject, PDEVICE_OBJECT *DeviceObject);
// NTSTATUS __stdcall ZwClose(HANDLE Handle);
// void __stdcall IofCompleteRequest(PIRP Irp, CCHAR PriorityBoost);
// SIZE_T __stdcall RtlCompareMemory(const void *Source1, const void *Source2, SIZE_T Length);
// LONG_PTR __stdcall ObfDereferenceObject(PVOID Object);
// NTSTATUS __stdcall IoCreateDevice(PDRIVER_OBJECT DriverObject, ULONG DeviceExtensionSize, PUNICODE_STRING DeviceName, ULONG DeviceType, ULONG DeviceCharacteristics, BOOLEAN Exclusive, PDEVICE_OBJECT *DeviceObject);
// NTSTATUS __stdcall IofCallDriver(PDEVICE_OBJECT DeviceObject, PIRP Irp);
// NTSTATUS __stdcall KeDelayExecutionThread(KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Interval);
// NTSTATUS __stdcall PsCreateSystemThread(PHANDLE ThreadHandle, ULONG DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, HANDLE ProcessHandle, PCLIENT_ID ClientId, PKSTART_ROUTINE StartRoutine, PVOID StartContext);
// NTSTATUS __stdcall IoWMIWriteEvent(PVOID WnodeEventItem);
// NTSTATUS __stdcall RtlUnicodeStringToInteger(PCUNICODE_STRING String, ULONG Base, PULONG Value);
// int __cdecl stricmp(const char *Str1, const char *Str2);
// LONG __stdcall KeResetEvent(PRKEVENT Event);
// void KeLeaveCriticalRegion(void);
// BOOLEAN __stdcall RtlTimeToSecondsSince1970(PLARGE_INTEGER Time, PULONG ElapsedSeconds);
// LONG __stdcall KeSetEvent(PRKEVENT Event, KPRIORITY Increment, BOOLEAN Wait);
// void __stdcall KeInitializeEvent(PRKEVENT Event, EVENT_TYPE Type, BOOLEAN State);
// void KeEnterCriticalRegion(void);
// NTSTATUS __stdcall ZwWaitForSingleObject(HANDLE Handle, BOOLEAN Alertable, PLARGE_INTEGER Timeout);
// NTSTATUS __stdcall PsTerminateSystemThread(NTSTATUS ExitStatus);
// NTSTATUS __stdcall KeWaitForSingleObject(PVOID Object, KWAIT_REASON WaitReason, KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Timeout);
// int __cdecl strnicmp(const char *Str1, const char *Str2, size_t MaxCount);
// void __stdcall __noreturn KeBugCheckEx(ULONG BugCheckCode, ULONG_PTR BugCheckParameter1, ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter3, ULONG_PTR BugCheckParameter4);
// int __cdecl wcsnicmp(const wchar_t *Str1, const wchar_t *Str2, size_t MaxCount);
// void __stdcall ExFreePoolWithTag(PVOID P, ULONG Tag);
// BOOLEAN __stdcall ExAcquireResourceExclusiveLite(PERESOURCE Resource, BOOLEAN Wait);
// void __stdcall KeClearEvent(PRKEVENT Event);
// void __stdcall ExReleaseFastMutex(PFAST_MUTEX FastMutex);
// PIRP __stdcall IoBuildDeviceIoControlRequest(ULONG IoControlCode, PDEVICE_OBJECT DeviceObject, PVOID InputBuffer, ULONG InputBufferLength, PVOID OutputBuffer, ULONG OutputBufferLength, BOOLEAN InternalDeviceIoControl, PKEVENT Event, PIO_STATUS_BLOCK IoStatusBlock);
// void __stdcall ExAcquireFastMutex(PFAST_MUTEX FastMutex);
// PSLIST_ENTRY __stdcall ExpInterlockedPushEntrySList(PSLIST_HEADER ListHead, PSLIST_ENTRY ListEntry);
// void __stdcall KeReleaseSpinLock(PKSPIN_LOCK SpinLock, KIRQL NewIrql);
// PSLIST_ENTRY __stdcall ExpInterlockedPopEntrySList(PSLIST_HEADER ListHead);
// void __stdcall KeReleaseSpinLockFromDpcLevel(PKSPIN_LOCK SpinLock);
// void __stdcall ExDeletePagedLookasideList(PPAGED_LOOKASIDE_LIST Lookaside);
// BOOLEAN __stdcall ExAcquireResourceSharedLite(PERESOURCE Resource, BOOLEAN Wait);
// void __stdcall ExReleaseResourceLite(PERESOURCE Resource);
// USHORT __stdcall ExQueryDepthSList(PSLIST_HEADER SListHead);
// NTSTATUS __stdcall ObReferenceObjectByHandle(HANDLE Handle, ACCESS_MASK DesiredAccess, POBJECT_TYPE ObjectType, KPROCESSOR_MODE AccessMode, PVOID *Object, POBJECT_HANDLE_INFORMATION HandleInformation);
// NTSTATUS __stdcall ExDeleteResourceLite(PERESOURCE Resource);
// void __stdcall ExInitializePagedLookasideList(PPAGED_LOOKASIDE_LIST Lookaside, PALLOCATE_FUNCTION Allocate, PFREE_FUNCTION Free, ULONG Flags, SIZE_T Size, ULONG Tag, USHORT Depth);
// NTSTATUS __stdcall ExInitializeResourceLite(PERESOURCE Resource);
// NTSTATUS __stdcall KeWaitForMultipleObjects(ULONG Count, PVOID Object[], WAIT_TYPE WaitType, KWAIT_REASON WaitReason, KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Timeout, PKWAIT_BLOCK WaitBlockArray);
// void __stdcall KeAcquireSpinLockAtDpcLevel(PKSPIN_LOCK SpinLock);
// void __stdcall ExDeleteNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside);
// KIRQL __stdcall KeAcquireSpinLockRaiseToDpc(PKSPIN_LOCK SpinLock);
// KPRIORITY __stdcall KeSetPriorityThread(PKTHREAD Thread, KPRIORITY Priority);
// KPRIORITY __stdcall KeQueryPriorityThread(PKTHREAD Thread);
// void __stdcall KeInitializeDpc(PRKDPC Dpc, PKDEFERRED_ROUTINE DeferredRoutine, PVOID DeferredContext);
// void __stdcall KeInitializeTimer(PKTIMER Timer);
// NTSTATUS __stdcall ZwCreateFile(PHANDLE FileHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, PIO_STATUS_BLOCK IoStatusBlock, PLARGE_INTEGER AllocationSize, ULONG FileAttributes, ULONG ShareAccess, ULONG CreateDisposition, ULONG CreateOptions, PVOID EaBuffer, ULONG EaLength);
// BOOLEAN __stdcall KeSetTimer(PKTIMER Timer, LARGE_INTEGER DueTime, PKDPC Dpc);
// BOOLEAN __stdcall KeCancelTimer(PKTIMER);
// NTSTATUS __stdcall ZwWriteFile(HANDLE FileHandle, HANDLE Event, PIO_APC_ROUTINE ApcRoutine, PVOID ApcContext, PIO_STATUS_BLOCK IoStatusBlock, PVOID Buffer, ULONG Length, PLARGE_INTEGER ByteOffset, PULONG Key);
// NTSTATUS __stdcall ZwSetInformationFile(HANDLE FileHandle, PIO_STATUS_BLOCK IoStatusBlock, PVOID FileInformation, ULONG Length, FILE_INFORMATION_CLASS FileInformationClass);
// ULONGLONG __stdcall VerSetConditionMask(ULONGLONG ConditionMask, ULONG TypeMask, UCHAR Condition);
// NTSTATUS __stdcall RtlGetVersion(PRTL_OSVERSIONINFOW lpVersionInformation);
// NTSTATUS __stdcall RtlVerifyVersionInfo(PRTL_OSVERSIONINFOEXW VersionInfo, ULONG TypeMask, ULONGLONG ConditionMask);
// NTSTATUS __stdcall IoWMIRegistrationControl(PDEVICE_OBJECT DeviceObject, ULONG Action);
// void __stdcall ExInitializeNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside, PALLOCATE_FUNCTION Allocate, PFREE_FUNCTION Free, ULONG Flags, SIZE_T Size, ULONG Tag, USHORT Depth);
// PVOID __stdcall ExAllocatePoolWithTag(POOL_TYPE PoolType, SIZE_T NumberOfBytes, ULONG Tag);
__int64 __fastcall sub_68008(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6);
void __fastcall sub_682B4(struct _DEVICE_OBJECT *a1);

//-------------------------------------------------------------------------
// Data declarations

__int64 qword_5A920[2] = { -3689348814755303602i64, -3689348814741910324i64 }; // weak
__int64 qword_5AA80[2] = { -3689348818173612210i64, -3689348814741910324i64 }; // weak
__int64 qword_5AA90[2] = { -3689348814755302619i64, -3689348814741910324i64 }; // weak
__int64 qword_5AB80[2] = { -3689348814755304625i64, -3689348814741910324i64 }; // weak
__int64 qword_5AC90[2] = { -3689348814741962752i64, -3689348814741910324i64 }; // weak
unsigned __int8 byte_5C280[352] =
{
  6u,
  128u,
  128u,
  134u,
  128u,
  129u,
  128u,
  0u,
  0u,
  16u,
  3u,
  134u,
  128u,
  134u,
  130u,
  128u,
  20u,
  5u,
  5u,
  69u,
  69u,
  69u,
  133u,
  133u,
  133u,
  5u,
  0u,
  0u,
  48u,
  48u,
  128u,
  80u,
  128u,
  128u,
  0u,
  8u,
  0u,
  32u,
  32u,
  48u,
  80u,
  87u,
  128u,
  0u,
  7u,
  0u,
  55u,
  48u,
  48u,
  80u,
  80u,
  136u,
  0u,
  0u,
  0u,
  32u,
  40u,
  128u,
  136u,
  128u,
  128u,
  0u,
  0u,
  0u,
  96u,
  96u,
  96u,
  104u,
  104u,
  96u,
  0u,
  0u,
  7u,
  120u,
  112u,
  112u,
  119u,
  112u,
  112u,
  8u,
  8u,
  0u,
  0u,
  8u,
  0u,
  8u,
  0u,
  7u,
  8u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u
}; // idb
_UNKNOWN unk_5CB50; // weak
_UNKNOWN unk_5CB60; // weak
_UNKNOWN unk_5CB70; // weak
_UNKNOWN unk_5CB80; // weak
_UNKNOWN unk_5CB90; // weak
_UNKNOWN unk_5CBA0; // weak
_UNKNOWN unk_5CBB0; // weak
_UNKNOWN unk_5CBD0; // weak
_DWORD dword_5CBE0[30] =
{
  1,
  11,
  23,
  53,
  97,
  193,
  389,
  769,
  1543,
  3079,
  6151,
  12289,
  24593,
  49157,
  98317,
  196613,
  393241,
  786433,
  1572869,
  3145739,
  6291469,
  12582917,
  25165843,
  50331653,
  100663319,
  201326611,
  402653189,
  805306457,
  1610612741,
  0
}; // idb
_UNKNOWN unk_5CC58; // weak
_UNKNOWN unk_5CC68; // weak
_UNKNOWN unk_5CC78; // weak
_UNKNOWN unk_5CC88; // weak
_UNKNOWN unk_5CC98; // weak
_UNKNOWN unk_5CCA8; // weak
_UNKNOWN unk_5CCB8; // weak
_UNKNOWN unk_5CCD8; // weak
_UNKNOWN unk_5CCE8; // weak
_UNKNOWN unk_5CCF8; // weak
_UNKNOWN unk_5CD08; // weak
_UNKNOWN unk_5CD18; // weak
_UNKNOWN unk_5CD28; // weak
_UNKNOWN unk_5CD38; // weak
_UNKNOWN unk_5CD48; // weak
_UNKNOWN unk_5CD58; // weak
_UNKNOWN unk_5CD68; // weak
_UNKNOWN unk_5CD78; // weak
_UNKNOWN unk_5CD88; // weak
_UNKNOWN unk_5CD98; // weak
_UNKNOWN unk_5CDA8; // weak
_UNKNOWN unk_5CDB8; // weak
_UNKNOWN unk_5CDC8; // weak
_UNKNOWN unk_5CDD8; // weak
_UNKNOWN unk_5CDE8; // weak
_UNKNOWN unk_5CDF8; // weak
_UNKNOWN unk_5CE08; // weak
_UNKNOWN unk_5CE18; // weak
_UNKNOWN unk_5CE78; // weak
char *SrcCh = "(null)"; // idb
wchar_t *off_60118 = L"(null)"; // weak
int dword_60120 = 1; // weak
PDEVICE_OBJECT off_60148 = &off_60148; // idb
char aUnknownModule[15] = "Unknown module"; // weak
wchar_t aTlscreceivedpa[20] = L"TLSCReceivedPackets"; // weak
wchar_t aProvpublishedp[21] = L"PROVPublishedPackets"; // weak
char aIyyu[5] = "\xFF\xFF"; // weak
_UNKNOWN unk_611C8; // weak
_UNKNOWN unk_611D8; // weak
_UNKNOWN unk_611E8; // weak
_UNKNOWN unk_611F8; // weak
__int64 (__fastcall *qword_61230)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (*qword_61240)(void) = NULL; // weak
__int64 (__fastcall *qword_61248)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_61250)(_QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
int dword_61258 = 0; // weak
char byte_61260[4] = { '\0', '\0', '\0', '\0' }; // idb
char byte_61264[4] = { '\0', '\0', '\0', '\0' }; // idb
char byte_61268[4] = { '\0', '\0', '\0', '\0' }; // idb
int dword_6126C = 0; // weak
__int64 qword_61270 = 0i64; // weak
PVOID qword_61278 = NULL; // idb
PVOID qword_61280 = NULL; // idb
char byte_61288 = '\0'; // weak
char byte_61289 = '\0'; // weak
char byte_6128A = '\0'; // weak
char byte_6128B = '\0'; // weak
int dword_6128C = 0; // weak
__int64 qword_61290 = 0i64; // weak
int qword_61298 = 0; // idb
__int64 qword_612A0 = 0i64; // weak
PVOID qword_612A8 = NULL; // idb
PVOID qword_612B0 = NULL; // idb
PVOID qword_612B8 = NULL; // idb
PVOID qword_612C0 = NULL; // idb
PVOID qword_612C8 = NULL; // idb
PVOID qword_612D0 = NULL; // idb
__int64 qword_612D8 = 0i64; // weak
int dword_612E0 = 0; // weak
int dword_612E4 = 0; // weak
int dword_612E8 = 0; // weak
int dword_612EC = 0; // weak
int dword_612F0 = 0; // weak
int dword_612F4 = 0; // weak
int dword_612F8 = 0; // weak
int dword_612FC = 0; // weak
int dword_61300 = 0; // weak
__int64 qword_61308 = 0i64; // weak
__int64 qword_61310 = 0i64; // weak
__int64 qword_61318 = 0i64; // weak
__int64 qword_61320 = 0i64; // weak
__int64 qword_61328 = 0i64; // weak
__int64 qword_61330 = 0i64; // weak
__int64 qword_61338 = 0i64; // weak
__int64 qword_61340 = 0i64; // weak
__int64 qword_61348 = 0i64; // weak
__int64 qword_61350 = 0i64; // weak
__int64 qword_61358 = 0i64; // weak
__int64 qword_61360 = 0i64; // weak
__int64 qword_61368 = 0i64; // weak
__int64 qword_61370 = 0i64; // weak
__int64 qword_61378 = 0i64; // weak
__int64 qword_61380 = 0i64; // weak
__int64 qword_61388 = 0i64; // weak
__int64 qword_61390 = 0i64; // weak
__int64 qword_61398 = 0i64; // weak
__int64 qword_613A0 = 0i64; // weak
__int64 qword_613A8 = 0i64; // weak
__int64 qword_613B0 = 0i64; // weak
__int64 qword_613B8 = 0i64; // weak
__int64 qword_613C0 = 0i64; // weak
int dword_613C8 = 0; // weak
int dword_613CC = 0; // weak
__int64 qword_613D0 = 0i64; // weak
PVOID qword_613D8 = NULL; // idb
PVOID qword_613E0 = NULL; // idb
ULONG_PTR qword_613E8 = 0ui64; // idb
_UNKNOWN unk_613F0; // weak
__int16 word_6142C; // weak
int dword_61430; // weak
char byte_61434; // weak
char byte_61435; // weak
char byte_61436; // weak
char byte_61437; // weak
PVOID qword_61438; // idb
__int16 word_61440; // weak
int dword_61444; // weak
wchar_t Dst[1020]; // idb
_UNKNOWN unk_61C40; // weak
_UNKNOWN unk_61C48; // weak
struct _KEVENT Event; // idb
_UNKNOWN unk_61C70; // weak
_UNKNOWN unk_61CE0; // weak
PVOID qword_62180; // idb
PVOID qword_62188; // idb
int dword_62190; // weak
int dword_62194; // weak
struct _FAST_MUTEX FastMutex; // idb
PVOID qword_621D0; // idb
KSPIN_LOCK qword_621D8; // idb
int dword_621E0; // weak
PVOID qword_621E8; // idb
ULONG_PTR qword_621F0; // idb
ULONG_PTR qword_621F8; // idb
ULONG_PTR qword_62200; // idb
ULONG_PTR qword_62208; // idb
PVOID qword_62210; // idb
PVOID Object; // idb
char byte_62220; // weak
char byte_62221; // weak
char byte_62222; // weak
char byte_62223; // weak
int dword_62224; // weak
PVOID qword_62228; // idb
PVOID qword_62230; // idb
ULONG_PTR qword_62238; // idb
ULONG_PTR qword_62240; // idb
PVOID qword_62248; // idb
int dword_62250; // weak
int dword_62254; // weak
int dword_62258; // weak
int dword_6225C; // weak
__int64 qword_62260; // weak
__int64 qword_62268; // weak
__int64 qword_62270; // weak
__int64 qword_62278; // weak
__int64 qword_62280; // weak
__int64 qword_62288; // weak
PVOID qword_62290; // idb
ULONG_PTR qword_62298; // idb
ULONG_PTR qword_622A0; // idb
struct _FAST_MUTEX stru_622A8; // idb
int dword_622E0; // weak
int dword_622E4; // weak
PVOID qword_622E8; // idb
__int64 qword_62308; // weak
union _LARGE_INTEGER PerformanceFrequency; // idb
__int64 qword_62318; // weak
__int64 qword_62320; // weak
__int64 qword_62328; // weak
PVOID qword_62330; // idb
__int64 qword_62338; // weak
PVOID qword_62340; // idb
__int64 qword_62348; // weak
wchar_t word_62350[520]; // idb
int dword_62760; // weak
PVOID qword_62768; // idb
__int64 qword_62770; // weak
PVOID qword_62778; // idb
PVOID qword_62780; // idb
int dword_62788; // weak
int dword_6278C; // weak
char byte_62790; // weak
char byte_62791; // weak
char byte_62792; // weak
char byte_62793; // weak
char byte_62794; // weak
__int64 (__fastcall *qword_62798)(_QWORD); // weak
__int64 qword_627A0; // weak
__int64 qword_627A8; // weak
PVOID P; // idb
PVOID qword_627B8; // idb
KSPIN_LOCK qword_64DA0; // idb
__int64 qword_64DA8; // weak
ULONG_PTR qword_64DB0; // idb
ULONG_PTR qword_64DB8; // idb
ULONG_PTR qword_64DC0; // idb
struct _ERESOURCE Resource; // idb
__int64 qword_64E60[]; // weak
int dword_64E68; // weak
int dword_64E90; // weak
int dword_64E94; // weak
unsigned __int16 word_64EA0[240]; // idb
int dword_65080; // weak
KSPIN_LOCK SpinLock; // idb
int dword_65098; // weak
int dword_6509C; // weak
__int64 qword_650A0; // weak
__int64 qword_650A8; // weak
KSPIN_LOCK qword_650B0; // idb
__int64 qword_650B8; // weak
int dword_650C0; // weak
int dword_650C4; // weak
__int64 (__fastcall *qword_650C8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // weak
__int64 (__fastcall *qword_650D0)(_QWORD, _QWORD); // weak
__int64 (*qword_650D8)(void); // weak
__int64 (__fastcall *qword_650E0)(_QWORD); // weak
__int64 (__fastcall *qword_650E8)(_QWORD, _QWORD); // weak
__int64 qword_650F0; // weak
__int64 qword_650F8; // weak
__int64 qword_65100; // weak
__int64 qword_65108; // weak
__int64 qword_65110; // weak
__int64 qword_65118; // weak
struct _KDPC Dpc; // idb
__int64 qword_65160; // weak
int dword_65168; // weak
PDEVICE_OBJECT DeviceObject; // idb
__int64 qword_65180; // weak
__int64 qword_65188; // weak
__int64 qword_65190; // weak
__int64 qword_65198; // weak
__int64 qword_651A0; // weak
__int64 qword_651A8; // weak
struct _KTIMER Timer; // idb
__int64 qword_65200; // weak
__int64 qword_65208; // weak
__int64 qword_65210; // weak
__int64 qword_65220; // weak
char byte_65228; // weak
char byte_65229; // weak
__int16 word_6522A; // weak
int dword_6522C; // weak
__int64 qword_65240; // weak
__int64 qword_65248; // weak
__int64 qword_65250; // weak
__int64 qword_65260; // weak
char byte_65268; // weak
char byte_65269; // weak
__int16 word_6526A; // weak
int dword_6526C; // weak
__int64 qword_65280; // weak
__int64 qword_65288; // weak
__int64 qword_65290; // weak
__int64 qword_652A0; // weak
char byte_652A8; // weak
char byte_652A9; // weak
__int16 word_652AA; // weak
int dword_652AC; // weak
__int64 qword_652C0; // weak
__int64 qword_652C8; // weak
__int64 qword_652D0; // weak
__int64 qword_652E0; // weak
char byte_652E8; // weak
char byte_652E9; // weak
__int16 word_652EA; // weak
int dword_652EC; // weak
__int64 qword_65300; // weak
__int64 qword_65308; // weak
__int64 qword_65310; // weak
__int64 qword_65320; // weak
char byte_65328; // weak
char byte_65329; // weak
__int16 word_6532A; // weak
int dword_6532C; // weak
__int64 qword_65340; // weak
__int64 qword_65348; // weak
__int64 qword_65350; // weak
__int64 qword_65360; // weak
char byte_65368; // weak
char byte_65369; // weak
__int16 word_6536A; // weak
int dword_6536C; // weak
__int64 qword_65380; // weak
__int64 qword_65388; // weak
__int64 qword_65390; // weak
__int64 qword_653A0; // weak
char byte_653A8; // weak
char byte_653A9; // weak
__int16 word_653AA; // weak
int dword_653AC; // weak
PDEVICE_OBJECT qword_653C0; // idb
char byte_653E0; // weak
int dword_653E4; // weak
int dword_653E8; // weak
int dword_653EC; // weak
int dword_653F0; // weak
int dword_653F4; // weak
int dword_653F8; // weak
int dword_653FC; // weak
int dword_65400; // weak
int dword_65404; // weak
int dword_65408; // weak
int dword_6540C; // weak
int dword_65410; // weak
int dword_65414; // weak
int dword_65418; // weak
int dword_6541C; // weak
int dword_65420; // weak
int dword_65424; // weak
int dword_65428; // weak
int dword_6542C; // weak
int dword_65430; // weak
int dword_65434; // weak
int dword_65438; // weak
int dword_6543C; // weak
int dword_65440; // weak
int dword_65444; // weak
int dword_65448; // weak
int dword_6544C; // weak
char byte_65450; // weak
char byte_65451; // weak
int dword_65454; // weak
int dword_65458; // weak
__int64 qword_65460; // weak
int dword_65468; // weak
char byte_6546C; // weak
__int64 qword_65470; // weak
int dword_65478; // weak
char byte_6547C; // weak


//----- (0000000000011008) ----------------------------------------------------
__int64 __fastcall sub_11008(__int64 a1, unsigned __int16 a2, __int64 a3)
{
  return qword_61238(a1, 43i64, a3, a2, 0i64);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001102C) ----------------------------------------------------
__int64 __fastcall sub_1102C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+B8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, a3, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000110AC) ----------------------------------------------------
__int64 __fastcall sub_110AC(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+D8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, a3, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011148) ----------------------------------------------------
__int64 __fastcall sub_11148(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, a3, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011194) ----------------------------------------------------
__int64 sub_11194(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+C8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CE18, 267i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011230) ----------------------------------------------------
__int64 sub_11230(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, a3, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001127C) ----------------------------------------------------
__int64 __fastcall sub_1127C(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4)
{
  __int64 v5; // rcx
  const wchar_t *v6; // rdi
  bool v7; // zf

  if ( a4 && *a4 )
  {
    v5 = -1i64;
    v6 = a4;
    do
    {
      if ( !v5 )
        break;
      v7 = *v6++ == 0;
      --v5;
    }
    while ( !v7 );
  }
  if ( a4 )
  {
    if ( !*a4 )
      a4 = L"<NULL>";
  }
  else
  {
    a4 = L"NULL";
  }
  return qword_61238(a1, 43i64, a3, a2, a4);
}
// 5A870: using guessed type wchar_t aNull_3[7];
// 5A880: using guessed type wchar_t aNull[5];
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000112FC) ----------------------------------------------------
__int64 __fastcall sub_112FC(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+68h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, a3, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011338) ----------------------------------------------------
__int64 __fastcall sub_11338(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+C8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CE18, 286i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000113D0) ----------------------------------------------------
__int64 __fastcall sub_113D0(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CE18, 99i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011430) ----------------------------------------------------
__int64 __fastcall sub_11430(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, a3, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011478) ----------------------------------------------------
__int64 __fastcall sub_11478(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CE18, 227i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000114E4) ----------------------------------------------------
__int64 __fastcall sub_114E4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, a3, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011544) ----------------------------------------------------
__int64 __fastcall sub_11544(__int64 a1, __int64 a2, __int64 a3, int a4, char a5, char a6, const char *a7)
{
  int v9; // [rsp+98h] [rbp+20h] BYREF

  v9 = a4;
  if ( a7 )
    strlen(a7);
  return qword_61238(a1, 43i64, &unk_5CE18, 98i64, &v9);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000115F4) ----------------------------------------------------
__int64 __fastcall sub_115F4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, a3, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001164C) ----------------------------------------------------
__int64 sub_1164C(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+78h] [rbp+20h] BYREF
  va_list va; // [rsp+78h] [rbp+20h]
  const char *v7; // [rsp+80h] [rbp+28h]
  va_list va1; // [rsp+88h] [rbp+30h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, const char *);
  if ( v7 )
    strlen(v7);
  return qword_61238(a1, 43i64, a3, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000116CC) ----------------------------------------------------
__int64 sub_116CC(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+88h] [rbp+20h] BYREF
  va_list va; // [rsp+88h] [rbp+20h]
  const char *v7; // [rsp+90h] [rbp+28h]
  va_list va1; // [rsp+98h] [rbp+30h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, const char *);
  if ( v7 )
    strlen(v7);
  return qword_61238(a1, 43i64, a3, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011764) ----------------------------------------------------
__int64 sub_11764(__int64 a1, __int64 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+88h] [rbp+20h] BYREF
  va_list va; // [rsp+88h] [rbp+20h]
  const char *v7; // [rsp+90h] [rbp+28h]
  const char *v8; // [rsp+98h] [rbp+30h]
  va_list va1; // [rsp+A0h] [rbp+38h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, const char *);
  v8 = va_arg(va1, const char *);
  if ( v8 )
    strlen(v8);
  if ( v7 )
    strlen(v7);
  return qword_61238(a1, 43i64, &unk_5CE18, 411i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001182C) ----------------------------------------------------
__int64 __fastcall sub_1182C(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_61238(a1, 43i64, a3, a2, v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001188C) ----------------------------------------------------
__int64 __fastcall sub_1188C(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CE18, a2, v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011908) ----------------------------------------------------
__int64 __fastcall sub_11908(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, const char *a5)
{
  const char *v7; // rcx

  if ( a5 )
    strlen(a5);
  if ( a4 )
    strlen(a4);
  v7 = "NULL";
  if ( a4 )
    v7 = a4;
  return qword_61238(a1, 43i64, a3, a2, v7);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000119B8) ----------------------------------------------------
__int64 __fastcall sub_119B8(__int64 a1, __int64 a2, __int64 a3, __int16 a4, __int64 a5)
{
  char *v7; // rsi
  __int64 *v8; // rax
  __int64 v9; // r8
  SIZE_T v10; // rbx
  unsigned __int64 v11; // rcx
  int *v12; // rdx
  __int64 v13; // r9
  char *v15; // rax
  __int64 v16; // rbp
  const void **i; // rdi
  size_t v18; // rbx
  unsigned int v19; // ebx
  __int64 WnodeEventItem[7]; // [rsp+30h] [rbp-D8h] BYREF
  int v21; // [rsp+68h] [rbp-A0h] BYREF
  char *v22; // [rsp+70h] [rbp-98h]
  int v23; // [rsp+78h] [rbp-90h]
  __int16 v24; // [rsp+128h] [rbp+20h] BYREF

  v24 = a4;
  v7 = 0i64;
  memset(WnodeEventItem, 0, 0x30ui64);
  WnodeEventItem[1] = a1;
  WnodeEventItem[6] = (__int64)&v24;
  v8 = &a5;
  WnodeEventItem[3] = a3;
  HIDWORD(WnodeEventItem[5]) = 1703936;
  BYTE4(WnodeEventItem[0]) = -1;
  v21 = 2;
  v9 = a5;
  v10 = 0i64;
  v11 = 0i64;
  if ( a5 )
  {
    v12 = &v21;
    do
    {
      v13 = v8[1];
      ++v11;
      v12 += 4;
      v10 += v13;
      if ( v11 <= 7 )
      {
        *((_QWORD *)v12 - 1) = v9;
        *v12 = v13;
      }
      v8 += 2;
      v9 = *v8;
    }
    while ( *v8 );
  }
  if ( v10 > 0x2000 )
    return 3221225473i64;
  if ( v11 <= 7 )
  {
    LOWORD(WnodeEventItem[0]) = 16 * (v11 + 4);
  }
  else
  {
    v15 = (char *)ExAllocatePoolWithTag(NonPagedPool, v10, 0x45435453u);
    v7 = v15;
    if ( !v15 )
      return 3221225495i64;
    v22 = v15;
    v23 = v10;
    v16 = 0i64;
    for ( i = (const void **)&a5; *i; i += 2 )
    {
      v18 = (size_t)i[1];
      memmove(&v7[v16], *i, v18);
      v16 += v18;
    }
    LOWORD(WnodeEventItem[0]) = 80;
  }
  v19 = IoWMIWriteEvent(WnodeEventItem);
  if ( v7 )
    ExFreePoolWithTag(v7, 0);
  return v19;
}

//----- (0000000000011B0C) ----------------------------------------------------
__int64 __fastcall sub_11B0C(__int64 a1, char a2, __int64 *a3, __int64 a4)
{
  __int64 result; // rax

  result = 0i64;
  if ( a2 == 1 || !a2 )
  {
    if ( a2 )
    {
      *(_DWORD *)(a4 + 44) = *((_DWORD *)a3 + 1);
      *(_BYTE *)(a4 + 41) = *((_BYTE *)a3 + 2);
      result = *a3;
    }
    else
    {
      *(_BYTE *)(a4 + 41) = 0;
      *(_DWORD *)(a4 + 44) = 0;
    }
    *(_QWORD *)(a4 + 24) = result;
  }
  return result;
}

//----- (0000000000011B44) ----------------------------------------------------
NTSTATUS __stdcall DriverEntry(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath)
{
  int v3; // eax
  PDEVICE_OBJECT v4; // rcx
  __int64 *v5; // rbx
  __int64 v6; // rcx
  ULONG v7; // edx
  struct _DEVICE_OBJECT *v8; // rcx
  char v10; // al
  int v11; // ebx
  int v12; // eax
  int v13; // edi
  PDEVICE_OBJECT v14; // rcx
  unsigned __int16 v15; // dx
  int v16; // er9
  int v17; // eax
  unsigned __int16 v18; // di
  PDEVICE_OBJECT v19; // rcx
  unsigned __int16 v20; // dx
  int v21; // eax
  unsigned __int16 v22; // dx
  int v23; // eax
  PDEVICE_OBJECT v24; // rcx
  struct _UNICODE_STRING SystemRoutineName; // [rsp+40h] [rbp-58h] BYREF
  struct _UNICODE_STRING DestinationString; // [rsp+50h] [rbp-48h] BYREF
  char v27; // [rsp+B0h] [rbp+18h] BYREF
  unsigned int v28; // [rsp+B8h] [rbp+20h] BYREF

  qword_65208 = (__int64)&unk_5CB50;
  qword_65210 = (__int64)&qword_65240;
  qword_65248 = (__int64)&unk_5CB60;
  qword_65250 = (__int64)&qword_65280;
  qword_65288 = (__int64)&unk_5CB70;
  v27 = 0;
  qword_65290 = (__int64)&qword_652C0;
  qword_65200 = 0i64;
  qword_652C8 = (__int64)&unk_5CB80;
  qword_65220 = 0i64;
  qword_652D0 = (__int64)&qword_65300;
  byte_65228 = 1;
  qword_65308 = (__int64)&unk_5CB90;
  byte_65229 = 0;
  qword_65310 = (__int64)&qword_65340;
  word_6522A = 0;
  qword_65348 = (__int64)&unk_5CBA0;
  dword_6522C = 0;
  qword_65350 = (__int64)&qword_65380;
  qword_65240 = 0i64;
  qword_65260 = 0i64;
  byte_65268 = 1;
  byte_65269 = 0;
  qword_65388 = (__int64)&unk_5CBB0;
  word_6526A = 0;
  dword_6526C = 0;
  qword_65280 = 0i64;
  qword_652A0 = 0i64;
  byte_652A8 = 1;
  byte_652A9 = 0;
  word_652AA = 0;
  dword_652AC = 0;
  qword_652C0 = 0i64;
  qword_652E0 = 0i64;
  byte_652E8 = 1;
  byte_652E9 = 0;
  word_652EA = 0;
  dword_652EC = 0;
  qword_65300 = 0i64;
  qword_65320 = 0i64;
  byte_65328 = 1;
  byte_65329 = 0;
  word_6532A = 0;
  dword_6532C = 0;
  qword_65340 = 0i64;
  qword_65360 = 0i64;
  byte_65368 = 1;
  byte_65369 = 0;
  word_6536A = 0;
  dword_6536C = 0;
  qword_65380 = 0i64;
  qword_65390 = 0i64;
  qword_653A0 = 0i64;
  byte_653A8 = 1;
  byte_653A9 = 0;
  word_653AA = 0;
  dword_653AC = 0;
  v28 = 0;
  RtlInitUnicodeString(&SystemRoutineName, L"PsGetVersion");
  qword_61250 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
  RtlInitUnicodeString(&SystemRoutineName, L"WmiTraceMessage");
  qword_61238 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
  if ( !qword_61238 )
  {
    qword_61238 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))sub_119B8;
    v3 = 1;
LABEL_3:
    dword_61258 = v3;
    goto LABEL_10;
  }
  RtlInitUnicodeString(&SystemRoutineName, L"WmiQueryTraceInformation");
  qword_61230 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
  v3 = 2;
  dword_61258 = 2;
  if ( qword_61250 )
  {
    qword_61250(&v28, 0i64, 0i64, 0i64);
    v3 = dword_61258;
  }
  if ( v28 >= 6 )
  {
    RtlInitUnicodeString(&SystemRoutineName, L"EtwRegisterClassicProvider");
    qword_61248 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
    if ( qword_61248 )
    {
      RtlInitUnicodeString(&SystemRoutineName, L"EtwUnregister");
      qword_61240 = (__int64 (*)(void))MmGetSystemRoutineAddress(&SystemRoutineName);
      v3 = 4;
      goto LABEL_3;
    }
    v3 = dword_61258;
  }
LABEL_10:
  v4 = off_60148;
  v5 = &qword_65200;
  qword_65220 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&qword_65200 )
  {
    off_60148 = (PDEVICE_OBJECT)&qword_65200;
    if ( v3 == 4 )
    {
      do
      {
        v6 = v5[1];
        v5[7] = 0i64;
        qword_61248(v6, 0i64, sub_11B0C, v5, v5 + 7);
        v5 = (__int64 *)v5[2];
      }
      while ( v5 );
    }
    else
    {
      if ( v3 == 2 )
      {
        v7 = -2147418111;
        v8 = (struct _DEVICE_OBJECT *)&qword_65200;
        qword_65200 = (__int64)sub_68008;
      }
      else
      {
        qword_65200 = 0i64;
        v7 = 1;
        v8 = (struct _DEVICE_OBJECT *)DriverObject;
      }
      IoWMIRegistrationControl(v8, v7);
    }
    v4 = off_60148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v4->Dpc.DeferredContext) & 1) != 0
    && BYTE1(v4->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v4->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_5CE18);
  }
  sub_18EDC(&v27);
  if ( v27 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_5CE18);
    }
    sub_682B4((struct _DEVICE_OBJECT *)DriverObject);
    return -1073740764;
  }
  memset(&qword_65180, 0, 0x30ui64);
  sub_42594();
  sub_42594();
  sub_4D74C(15, (__int64)aProvpublishedp);
  v10 = sub_4F0EC();
  dword_65168 = 0;
  byte_61289 = v10;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xCu, (__int64)&unk_5CE18);
  }
  sub_40150(&SpinLock);
  dword_65098 = 0;
  qword_650A8 = (__int64)&qword_650A0;
  qword_650A0 = (__int64)&qword_650A0;
  dword_6509C = 0;
  qword_650B0 = 0i64;
  sub_40150(&qword_650B0);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_5CE18, &qword_650A0);
  }
  dword_6126C = 0;
  DriverObject->DriverUnload = (PDRIVER_UNLOAD)sub_129DC;
  RtlInitUnicodeString(&DestinationString, L"\\Device\\NNSNAHC");
  if ( IoCreateDevice(DriverObject, 0, &DestinationString, 0x22u, 0, 0, &DeviceObject) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_1188C(off_60148->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_5CE18, (const char *)L"\\Device\\NNSNAHC");
    }
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_1127C(off_60148->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_5CE18, L"\\Device\\NNSNAHC");
    }
    DriverObject->MajorFunction[0] = (PDRIVER_DISPATCH)sub_13788;
    DriverObject->MajorFunction[2] = (PDRIVER_DISPATCH)sub_13788;
    DriverObject->MajorFunction[15] = (PDRIVER_DISPATCH)sub_13A88;
  }
  RtlInitUnicodeString(&DestinationString, L"\\Device\\NNS_NetworkProvider");
  v11 = IoCreateDevice(DriverObject, 0, &DestinationString, 0x22u, 0, 0, &qword_653C0);
  if ( v11 )
  {
    v14 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 1) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_168;
    }
    sub_1188C(
      off_60148->Dpc.ProcessorHistory,
      0x11u,
      (__int64)&unk_5CE18,
      (const char *)L"\\Device\\NNS_NetworkProvider");
    goto LABEL_167;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_1127C(off_60148->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_5CE18, L"\\Device\\NNS_NetworkProvider");
  }
  DriverObject->MajorFunction[14] = (PDRIVER_DISPATCH)sub_13D18;
  v12 = sub_29F60();
  LOWORD(v13) = v12;
  if ( v12 )
  {
    v14 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 1) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_60;
    }
    v15 = 18;
    goto LABEL_57;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_5CE18);
  }
  sub_494BC(0);
  v13 = sub_13E0C();
  if ( v13 )
  {
    sub_4FE6C();
    v14 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 1) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_60;
    }
    v15 = 31;
LABEL_158:
    v16 = v13;
    goto LABEL_58;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x14u, (__int64)&unk_5CE18);
  }
  byte_61288 = sub_4EFDC();
  v13 = sub_4F9A0();
  if ( v13 )
  {
    sub_4A050();
    sub_4FE6C();
    v14 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 1) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_60;
    }
    v15 = 30;
    goto LABEL_158;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_5CE18);
  }
  v17 = sub_234B4();
  v18 = v17;
  if ( v17 )
  {
    v19 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 1) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_81;
    }
    v20 = 22;
LABEL_80:
    sub_112FC(v19->Dpc.ProcessorHistory, v20, (__int64)&unk_5CE18, v17);
LABEL_81:
    sub_4FD40();
    sub_4A050();
    sub_4FE6C();
    v11 = v18 | 0xE0020000;
LABEL_167:
    v14 = off_60148;
    goto LABEL_168;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x17u, (__int64)&unk_5CE18);
  }
  v21 = sub_3225C();
  LOWORD(v13) = v21;
  if ( v21 )
  {
    v14 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 1) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_60;
    }
    v22 = 24;
    goto LABEL_91;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x19u, (__int64)&unk_5CE18);
  }
  v21 = sub_3C9F4();
  LOWORD(v13) = v21;
  if ( v21 )
  {
    v14 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 1) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_60;
    }
    v22 = 26;
LABEL_91:
    sub_112FC(v14->Dpc.ProcessorHistory, v22, (__int64)&unk_5CE18, v21);
    goto LABEL_59;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x1Bu, (__int64)&unk_5CE18);
  }
  v17 = sub_2F848();
  v18 = v17;
  if ( v17 )
  {
    v19 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 1) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_81;
    }
    v20 = 28;
    goto LABEL_80;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x1Du, (__int64)&unk_5CE18);
  }
  dword_65168 = 1;
  sub_494BC(1);
  v23 = sub_36B1C();
  if ( v23
    && off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x20u, (__int64)&unk_5CE18, v23);
  }
  qword_612A8 = sub_3F8D8(2, 0x190u, 0x704E734Eu);
  qword_612B8 = sub_3F8D8(2, 0x5EAu, 0x624E734Eu);
  qword_612C0 = sub_3F8D8(2, 0xFFFFu, 0x624E734Eu);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x21u, (__int64)&unk_5CE18);
  }
  v12 = sub_1DAE4();
  LOWORD(v13) = v12;
  if ( !v12 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x23u, (__int64)&unk_5CE18);
    }
    qword_612C8 = sub_3F8D8(2, 0x40u, 0x7452734Eu);
    qword_612D0 = sub_3F8D8(2, 0x20u, 0x7446734Eu);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x24u, (__int64)&unk_5CE18);
    }
    sub_137B0();
    v24 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x25u, (__int64)&unk_5CE18);
        v24 = off_60148;
      }
      if ( v24 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v24->Dpc.DeferredContext) & 1) != 0
        && BYTE1(v24->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v24->Dpc.ProcessorHistory, 0x26u, (__int64)&unk_5CE18);
      }
    }
    if ( (unsigned int)sub_190CC()
      && off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x27u, (__int64)&unk_5CE18);
    }
    qword_61278 = (PVOID)sub_40888(1u);
    qword_61280 = (PVOID)sub_40888(2u);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x28u, (__int64)&unk_5CE18);
    }
    sub_2EB84();
    qword_65160 = 1000000i64;
    KeInitializeDpc(&Dpc, (PKDEFERRED_ROUTINE)DeferredRoutine, sub_17918);
    KeInitializeTimer(&Timer);
    qword_650B8 = -10000000i64;
    KeSetTimer(&Timer, (LARGE_INTEGER)-10000000i64, &Dpc);
    goto LABEL_174;
  }
  v14 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148
    || (BYTE4(off_60148->Dpc.DeferredContext) & 1) == 0
    || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
  {
    goto LABEL_60;
  }
  v15 = 34;
LABEL_57:
  v16 = v12;
LABEL_58:
  sub_112FC(v14->Dpc.ProcessorHistory, v15, (__int64)&unk_5CE18, v16);
LABEL_59:
  v14 = off_60148;
LABEL_60:
  v11 = (unsigned __int16)v13 | 0xE0020000;
LABEL_168:
  if ( v11 >= 0 )
    goto LABEL_175;
  if ( v14 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v14->Dpc.DeferredContext) & 1) != 0
    && BYTE1(v14->Dpc.DeferredContext) >= 2u )
  {
    sub_112FC(v14->Dpc.ProcessorHistory, 0x29u, (__int64)&unk_5CE18, v11);
  }
  sub_129DC((struct _DEVICE_OBJECT *)DriverObject);
LABEL_174:
  v14 = off_60148;
LABEL_175:
  if ( v14 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v14->Dpc.DeferredContext) & 1) != 0
    && BYTE1(v14->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v14->Dpc.ProcessorHistory, 0x2Au, (__int64)&unk_5CE18);
  }
  return v11;
}
// 60C20: using guessed type wchar_t aProvpublishedp[21];
// 61230: using guessed type __int64 (__fastcall *qword_61230)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 61240: using guessed type __int64 (*qword_61240)(void);
// 61248: using guessed type __int64 (__fastcall *qword_61248)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 61250: using guessed type __int64 (__fastcall *qword_61250)(_QWORD, _QWORD, _QWORD, _QWORD);
// 61258: using guessed type int dword_61258;
// 6126C: using guessed type int dword_6126C;
// 61288: using guessed type char byte_61288;
// 61289: using guessed type char byte_61289;
// 65098: using guessed type int dword_65098;
// 6509C: using guessed type int dword_6509C;
// 650A0: using guessed type __int64 qword_650A0;
// 650A8: using guessed type __int64 qword_650A8;
// 650B8: using guessed type __int64 qword_650B8;
// 65160: using guessed type __int64 qword_65160;
// 65168: using guessed type int dword_65168;
// 65180: using guessed type __int64 qword_65180;
// 65200: using guessed type __int64 qword_65200;
// 65208: using guessed type __int64 qword_65208;
// 65210: using guessed type __int64 qword_65210;
// 65220: using guessed type __int64 qword_65220;
// 65228: using guessed type char byte_65228;
// 65229: using guessed type char byte_65229;
// 6522A: using guessed type __int16 word_6522A;
// 6522C: using guessed type int dword_6522C;
// 65240: using guessed type __int64 qword_65240;
// 65248: using guessed type __int64 qword_65248;
// 65250: using guessed type __int64 qword_65250;
// 65260: using guessed type __int64 qword_65260;
// 65268: using guessed type char byte_65268;
// 65269: using guessed type char byte_65269;
// 6526A: using guessed type __int16 word_6526A;
// 6526C: using guessed type int dword_6526C;
// 65280: using guessed type __int64 qword_65280;
// 65288: using guessed type __int64 qword_65288;
// 65290: using guessed type __int64 qword_65290;
// 652A0: using guessed type __int64 qword_652A0;
// 652A8: using guessed type char byte_652A8;
// 652A9: using guessed type char byte_652A9;
// 652AA: using guessed type __int16 word_652AA;
// 652AC: using guessed type int dword_652AC;
// 652C0: using guessed type __int64 qword_652C0;
// 652C8: using guessed type __int64 qword_652C8;
// 652D0: using guessed type __int64 qword_652D0;
// 652E0: using guessed type __int64 qword_652E0;
// 652E8: using guessed type char byte_652E8;
// 652E9: using guessed type char byte_652E9;
// 652EA: using guessed type __int16 word_652EA;
// 652EC: using guessed type int dword_652EC;
// 65300: using guessed type __int64 qword_65300;
// 65308: using guessed type __int64 qword_65308;
// 65310: using guessed type __int64 qword_65310;
// 65320: using guessed type __int64 qword_65320;
// 65328: using guessed type char byte_65328;
// 65329: using guessed type char byte_65329;
// 6532A: using guessed type __int16 word_6532A;
// 6532C: using guessed type int dword_6532C;
// 65340: using guessed type __int64 qword_65340;
// 65348: using guessed type __int64 qword_65348;
// 65350: using guessed type __int64 qword_65350;
// 65360: using guessed type __int64 qword_65360;
// 65368: using guessed type char byte_65368;
// 65369: using guessed type char byte_65369;
// 6536A: using guessed type __int16 word_6536A;
// 6536C: using guessed type int dword_6536C;
// 65380: using guessed type __int64 qword_65380;
// 65388: using guessed type __int64 qword_65388;
// 65390: using guessed type __int64 qword_65390;
// 653A0: using guessed type __int64 qword_653A0;
// 653A8: using guessed type char byte_653A8;
// 653A9: using guessed type char byte_653A9;
// 653AA: using guessed type __int16 word_653AA;
// 653AC: using guessed type int dword_653AC;

//----- (00000000000129DC) ----------------------------------------------------
void __fastcall sub_129DC(struct _DEVICE_OBJECT *a1)
{
  unsigned int v2; // edi
  void *v3; // rax
  PDEVICE_OBJECT v4; // rcx
  PDEVICE_OBJECT v5; // rcx
  PDEVICE_OBJECT v6; // rcx
  int v7; // eax
  PDEVICE_OBJECT v8; // rcx
  __int64 v9; // rax
  int v10; // edi
  int v11; // eax
  int v12; // ebx
  PDEVICE_OBJECT v13; // rcx
  PVOID v14; // rax
  int v15; // eax
  PDEVICE_OBJECT v16; // rcx
  unsigned __int16 v17; // dx
  void *v18; // r8
  int v19; // eax
  PDEVICE_OBJECT v20; // rcx
  unsigned __int16 v21; // dx
  PVOID v22; // rax
  PVOID v23; // rax
  unsigned int v24; // [rsp+68h] [rbp+10h] BYREF

  v24 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Bu, (__int64)&unk_5CE18);
  }
  dword_6126C = 1;
  v2 = 1000 * sub_502CC(0x200A024u);
  if ( !v2 )
    v2 = 5000;
  sub_502CC(0x200A004u);
  KeCancelTimer(&Timer);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Cu, (__int64)&unk_5CE18);
  }
  v3 = (void *)_InterlockedCompareExchange64(&qword_61270, 0i64, 0i64);
  if ( v3 )
    sub_486D4(v3);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Du, (__int64)&unk_5CE18);
  }
  if ( (unsigned int)sub_28A70() )
  {
    qword_650D8();
    sub_28AD8();
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Eu, (__int64)&unk_5CE18);
  }
  sub_2F3D8();
  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x4Cu, (__int64)&unk_5CDA8);
    v4 = off_60148;
  }
  if ( byte_61434 )
  {
    sub_3FE00(&Resource);
    v4 = off_60148;
  }
  byte_61434 = 0;
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(v4->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v4->Dpc.ProcessorHistory, 0x4Du, (__int64)&unk_5CDA8);
    v4 = off_60148;
  }
  if ( qword_61280 )
  {
    sub_408F0(qword_61280);
    v4 = off_60148;
    qword_61280 = 0i64;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(v4[1].AttachedDevice) & 1) != 0 && BYTE1(v4[1].AttachedDevice) >= 5u )
    {
      sub_11008((__int64)v4[1].DriverObject, 0xDu, (__int64)&unk_5CD68);
      v4 = off_60148;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v4[1].AttachedDevice) & 1) != 0 && BYTE1(v4[1].AttachedDevice) >= 5u )
      sub_11008((__int64)v4[1].DriverObject, 0x20u, (__int64)&unk_5CD38);
  }
  sub_3A928();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x21u, (__int64)&unk_5CD38);
  }
  sub_426C8();
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148[1].AttachedDevice) & 1) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 5u )
    {
      sub_11008((__int64)off_60148[1].DriverObject, 0xEu, (__int64)&unk_5CD68);
      v5 = off_60148;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v5->Dpc.DeferredContext) & 1) != 0
      && BYTE1(v5->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v5->Dpc.ProcessorHistory, 0x2Fu, (__int64)&unk_5CE18);
    }
  }
  sub_23944(v2, &v24);
  if ( dword_65168 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x30u, (__int64)&unk_5CE18);
    }
    sub_4FD40();
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x31u, (__int64)&unk_5CE18);
    }
    sub_4A050();
    sub_4FE6C();
  }
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x32u, (__int64)&unk_5CE18);
      v6 = off_60148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(v6->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v6->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_5CD88);
      v6 = off_60148;
    }
  }
  if ( qword_62188 )
  {
    sub_408F0(qword_62188);
    v6 = off_60148;
  }
  if ( qword_64DC0 )
  {
    v7 = sub_53950(qword_64DC0, 1);
    if ( v7 )
    {
      v6 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        goto LABEL_93;
      if ( !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
        || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_89;
      }
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_5CD88, v7);
      goto LABEL_88;
    }
    v6 = off_60148;
  }
  if ( qword_62180 )
  {
    sub_3F95C(qword_62180);
    v6 = off_60148;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( !_bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0xEu) || BYTE1(v6->Dpc.DeferredContext) < 5u )
    {
LABEL_89:
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v6->Dpc.DeferredContext) & 1) != 0
        && BYTE1(v6->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v6->Dpc.ProcessorHistory, 0x33u, (__int64)&unk_5CE18);
      }
      goto LABEL_93;
    }
    sub_11008(v6->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_5CD88);
LABEL_88:
    v6 = off_60148;
    goto LABEL_89;
  }
LABEL_93:
  IoDeleteDevice(DeviceObject);
  IoDeleteDevice(qword_653C0);
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x34u, (__int64)&unk_5CE18);
    v8 = off_60148;
  }
  v9 = qword_613E8;
  byte_6128A = 0;
  if ( qword_613E8 )
  {
    sub_58100(qword_613E8, 0i64, 0);
    v8 = off_60148;
    v9 = qword_613E8;
  }
  if ( v8 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v8->Dpc.DeferredContext) & 1) != 0
    && BYTE1(v8->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v8->Dpc.ProcessorHistory, 0x35u, (__int64)&unk_5CE18);
    v8 = off_60148;
    v9 = qword_613E8;
  }
  v10 = 0;
  if ( v8 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v8->Dpc.DeferredContext) & 4) != 0
    && BYTE1(v8->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v8->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_5CDF8);
    v8 = off_60148;
    v9 = qword_613E8;
  }
  if ( byte_6128A )
  {
    byte_6128A = 0;
    if ( !v9 )
      goto LABEL_119;
    sub_58100(v9, 0i64, 0);
    v8 = off_60148;
    v9 = qword_613E8;
  }
  if ( v9 )
  {
    v11 = sub_535C8(v9);
    v12 = v11;
    if ( v11 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_5CDF8, v11);
      }
      v10 = sub_57F30(v12);
    }
    else
    {
      qword_613E8 = 0i64;
    }
    v8 = off_60148;
  }
LABEL_119:
  if ( v8 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v8->Dpc.DeferredContext) & 4) != 0
    && BYTE1(v8->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v8->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_5CDF8);
    v8 = off_60148;
  }
  if ( v10
    && v8 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v8->Dpc.DeferredContext) & 1) != 0
    && BYTE1(v8->Dpc.DeferredContext) >= 2u )
  {
    sub_112FC(v8->Dpc.ProcessorHistory, 0x36u, (__int64)&unk_5CE18, v10);
  }
  sub_2879C();
  if ( qword_61278 )
  {
    sub_408F0(qword_61278);
    qword_61278 = 0i64;
  }
  if ( P )
  {
    sub_3F6F0(P, 0x72746E63u);
    P = 0i64;
  }
  sub_426C8();
  if ( qword_61290 )
    sub_4EC48((PVOID *)&qword_61290);
  if ( *(_QWORD *)&qword_61298 )
    sub_4EC48((PVOID *)&qword_61298);
  if ( qword_612A0 )
    sub_4EC48((PVOID *)&qword_612A0);
  v13 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x37u, (__int64)&unk_5CE18);
    v13 = off_60148;
  }
  if ( qword_612A8 )
  {
    sub_3F95C(qword_612A8);
    v13 = off_60148;
    qword_612A8 = 0i64;
  }
  if ( qword_612B0 )
  {
    sub_3F95C(qword_612B0);
    v13 = off_60148;
    qword_612B0 = 0i64;
  }
  if ( qword_612B8 )
  {
    sub_3F95C(qword_612B8);
    v13 = off_60148;
    qword_612B8 = 0i64;
  }
  if ( v13 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(v13->Dpc.DeferredContext) & 1) != 0 && BYTE1(v13->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v13->Dpc.ProcessorHistory, 0x38u, (__int64)&unk_5CE18);
      v13 = off_60148;
    }
    if ( v13 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v13->Dpc.DeferredContext) & 1) != 0
      && BYTE1(v13->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v13->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_5CE08);
      v13 = off_60148;
    }
  }
  if ( qword_613D8 )
  {
    sub_3F95C(qword_613D8);
    v13 = off_60148;
    qword_613D8 = 0i64;
  }
  if ( qword_613E0 )
  {
    sub_3F95C(qword_613E0);
    v13 = off_60148;
    qword_613E0 = 0i64;
  }
  if ( v13 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(v13->Dpc.DeferredContext) & 1) != 0 && BYTE1(v13->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v13->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_5CE08);
      v13 = off_60148;
    }
    if ( v13 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(v13->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v13->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_5CD78);
      v13 = off_60148;
    }
  }
  v14 = qword_621D0;
  if ( qword_621D0 )
  {
    if ( v13 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(v13->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(v13->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_5CD78, qword_621D0);
      v14 = qword_621D0;
    }
    sub_3F6F0(v14, 0x7270644Eu);
    qword_621D0 = 0i64;
  }
  sub_36358(0);
  v15 = sub_53950(qword_64DB8, 1);
  if ( !v15 )
  {
    v16 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
      goto LABEL_192;
    if ( !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      || BYTE1(off_60148->Dpc.DeferredContext) < 5u )
    {
      goto LABEL_188;
    }
    v17 = 18;
    v18 = &unk_5CD78;
    goto LABEL_187;
  }
  v16 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_5CD78, v15);
      v16 = off_60148;
    }
    if ( v16 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(v16->Dpc.DeferredContext) & 1) == 0 || BYTE1(v16->Dpc.DeferredContext) < 2u )
      {
LABEL_188:
        if ( v16 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v16->Dpc.DeferredContext + 1, 0x18u)
          && BYTE1(v16->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(v16->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_5CCF8);
        }
        goto LABEL_192;
      }
      v17 = 57;
      v18 = &unk_5CE18;
LABEL_187:
      sub_11008(v16->Dpc.ProcessorHistory, v17, (__int64)v18);
      v16 = off_60148;
      goto LABEL_188;
    }
  }
LABEL_192:
  v19 = sub_541A0(qword_64DB0);
  if ( v19 )
  {
    v20 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      v21 = 14;
LABEL_202:
      sub_112FC(v20->Dpc.ProcessorHistory, v21, (__int64)&unk_5CCF8, v19);
      goto LABEL_203;
    }
  }
  else
  {
    v19 = sub_53950(qword_64DB0, 1);
    if ( !v19 )
    {
LABEL_203:
      v20 = off_60148;
      goto LABEL_204;
    }
    v20 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      v21 = 15;
      goto LABEL_202;
    }
  }
LABEL_204:
  byte_62222 = 0;
  if ( v20 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v20->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(v20->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v20->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_5CCF8);
    v20 = off_60148;
  }
  if ( qword_612C0 )
  {
    sub_3F95C(qword_612C0);
    v20 = off_60148;
    qword_612C0 = 0i64;
  }
  if ( qword_612C8 )
  {
    sub_3F95C(qword_612C8);
    v20 = off_60148;
    qword_612C8 = 0i64;
  }
  if ( qword_612D0 )
  {
    sub_3F95C(qword_612D0);
    v20 = off_60148;
    qword_612D0 = 0i64;
  }
  v22 = qword_61438;
  if ( qword_61438 )
  {
    if ( v20 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v20->Dpc.DeferredContext) & 1) != 0
      && BYTE1(v20->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(v20->Dpc.ProcessorHistory, 0x3Bu, (__int64)&unk_5CE18, qword_61438);
      v22 = qword_61438;
    }
    sub_3F6F0(v22, 0x7061694Eu);
    v20 = off_60148;
  }
  v23 = qword_622E8;
  if ( qword_622E8 )
  {
    if ( v20 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v20->Dpc.DeferredContext) & 1) != 0
      && BYTE1(v20->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(v20->Dpc.ProcessorHistory, 0x3Cu, (__int64)&unk_5CE18, qword_622E8);
      v23 = qword_622E8;
    }
    sub_3F6F0(v23, 0x6952414Eu);
    v20 = off_60148;
  }
  if ( v20 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v20->Dpc.DeferredContext) & 1) != 0
    && BYTE1(v20->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v20->Dpc.ProcessorHistory, 0x3Du, (__int64)&unk_5CE18);
  }
  sub_682B4(a1);
}
// 6126C: using guessed type int dword_6126C;
// 61270: using guessed type __int64 qword_61270;
// 6128A: using guessed type char byte_6128A;
// 61290: using guessed type __int64 qword_61290;
// 612A0: using guessed type __int64 qword_612A0;
// 61434: using guessed type char byte_61434;
// 62222: using guessed type char byte_62222;
// 650D8: using guessed type __int64 (*qword_650D8)(void);
// 65168: using guessed type int dword_65168;

//----- (0000000000013788) ----------------------------------------------------
__int64 __fastcall sub_13788(__int64 a1, IRP *a2)
{
  a2->IoStatus.Status = 0;
  a2->IoStatus.Information = 0i64;
  IofCompleteRequest(a2, 0);
  return 0i64;
}

//----- (00000000000137B0) ----------------------------------------------------
__int64 sub_137B0()
{
  NTSTATUS v0; // ebx
  IRP *v2; // rax
  struct _UNICODE_STRING DestinationString; // [rsp+50h] [rbp-28h] BYREF
  struct _IO_STATUS_BLOCK IoStatusBlock; // [rsp+60h] [rbp-18h] BYREF
  PDEVICE_OBJECT DeviceObject; // [rsp+80h] [rbp+8h] BYREF
  PFILE_OBJECT FileObject; // [rsp+88h] [rbp+10h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 9u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Eu, (__int64)&unk_5CE18);
  }
  RtlInitUnicodeString(&DestinationString, L"\\Device\\NNSNAHS");
  v0 = IoGetDeviceObjectPointer(&DestinationString, 0, &FileObject, &DeviceObject);
  if ( v0 < 0 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 9u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Fu, (__int64)&unk_5CE18);
    }
    return (unsigned int)v0;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 9u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x40u, (__int64)&unk_5CE18);
  }
  dword_650C4 = 0;
  qword_65108 = (__int64)sub_147AC;
  qword_65110 = (__int64)sub_14B0C;
  qword_650F8 = (__int64)sub_14528;
  qword_65100 = (__int64)sub_14568;
  dword_650C0 = 12;
  qword_650F0 = (__int64)sub_14E54;
  qword_65118 = (__int64)sub_19F78;
  v2 = IoBuildDeviceIoControlRequest(
         0x222EE0u,
         DeviceObject,
         &dword_650C0,
         0x60u,
         &dword_650C0,
         0x60u,
         1u,
         0i64,
         &IoStatusBlock);
  if ( !v2 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 9u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x41u, (__int64)&unk_5CE18);
    }
    v0 = 21;
LABEL_26:
    ObfDereferenceObject(FileObject);
    return (unsigned int)v0;
  }
  v0 = IofCallDriver(DeviceObject, v2);
  if ( v0 < 0 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 9u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x42u, (__int64)&unk_5CE18);
    }
    goto LABEL_26;
  }
  sub_28A20();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 9u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x43u, (__int64)&unk_5CE18, qword_650C8, qword_650D8);
  }
  ObfDereferenceObject(FileObject);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 9u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x44u, (__int64)&unk_5CE18);
  }
  return 0i64;
}
// 650C0: using guessed type int dword_650C0;
// 650C4: using guessed type int dword_650C4;
// 650C8: using guessed type __int64 (__fastcall *qword_650C8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 650D8: using guessed type __int64 (*qword_650D8)(void);
// 650F0: using guessed type __int64 qword_650F0;
// 650F8: using guessed type __int64 qword_650F8;
// 65100: using guessed type __int64 qword_65100;
// 65108: using guessed type __int64 qword_65108;
// 65110: using guessed type __int64 qword_65110;
// 65118: using guessed type __int64 qword_65118;

//----- (0000000000013A88) ----------------------------------------------------
__int64 __fastcall sub_13A88(__int64 a1, IRP *a2)
{
  PDEVICE_OBJECT v3; // rcx
  struct _IO_STACK_LOCATION *v4; // rbx
  int v5; // er9
  unsigned int v6; // ebx
  unsigned int v7; // edi
  unsigned __int16 v8; // dx
  int v9; // er9
  char v11; // [rsp+58h] [rbp+10h] BYREF

  v11 = 0;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 2) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x45u, (__int64)&unk_5CE18);
    v3 = off_60148;
  }
  v4 = a2->Tail.Overlay.CurrentStackLocation;
  v5 = v4->Parameters.Read.ByteOffset.LowPart;
  if ( v5 != 2240224 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v3->Dpc.DeferredContext) & 2) != 0
      && BYTE1(v3->Dpc.DeferredContext) >= 3u )
    {
      sub_112FC(v3->Dpc.ProcessorHistory, 0x4Au, (__int64)&unk_5CE18, v5);
    }
    v6 = -1073741811;
    goto LABEL_27;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v3->Dpc.DeferredContext) & 2) != 0
    && BYTE1(v3->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v3->Dpc.ProcessorHistory, 0x46u, (__int64)&unk_5CE18);
    v3 = off_60148;
  }
  v7 = 96;
  if ( v4->Parameters.Create.Options == 96 )
  {
    sub_18EDC(&v11);
    if ( v11 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 2) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x48u, (__int64)&unk_5CE18);
      }
      goto LABEL_26;
    }
    memmove(&dword_650C0, a2->AssociatedIrp.MasterIrp, 0x60ui64);
    v9 = 12;
    if ( dword_650C0 == 12 )
    {
      qword_65108 = (__int64)sub_147AC;
      qword_65110 = (__int64)sub_14B0C;
      qword_650F8 = (__int64)sub_14528;
      qword_65100 = (__int64)sub_14568;
      qword_650F0 = (__int64)sub_14E54;
      qword_65118 = (__int64)sub_19F78;
      memmove(a2->AssociatedIrp.MasterIrp, &dword_650C0, 0x60ui64);
      sub_28A20();
      v6 = 0;
      goto LABEL_34;
    }
    v3 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 2) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 3u )
    {
      goto LABEL_26;
    }
    v8 = 73;
  }
  else
  {
    if ( v3 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(v3->Dpc.DeferredContext) & 2) == 0
      || BYTE1(v3->Dpc.DeferredContext) < 3u )
    {
      goto LABEL_26;
    }
    v8 = 71;
    v9 = 96;
  }
  sub_11430(v3->Dpc.ProcessorHistory, v8, (__int64)&unk_5CE18, v9);
LABEL_26:
  v6 = -1073740764;
LABEL_27:
  v7 = 0;
LABEL_34:
  a2->IoStatus.Information = v7;
  a2->IoStatus.Status = v6;
  IofCompleteRequest(a2, 0);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 2) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x4Bu, (__int64)&unk_5CE18, v6);
  }
  return v6;
}
// 650C0: using guessed type int dword_650C0;
// 650F0: using guessed type __int64 qword_650F0;
// 650F8: using guessed type __int64 qword_650F8;
// 65100: using guessed type __int64 qword_65100;
// 65108: using guessed type __int64 qword_65108;
// 65110: using guessed type __int64 qword_65110;
// 65118: using guessed type __int64 qword_65118;

//----- (0000000000013D18) ----------------------------------------------------
__int64 __fastcall sub_13D18(__int64 a1, IRP *a2)
{
  PDEVICE_OBJECT v3; // rcx

  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Dpc.DeferredContext) & 2) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x4Cu, (__int64)&unk_5CE18);
      v3 = off_60148;
    }
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v3->Dpc.DeferredContext) & 2) != 0
      && BYTE1(v3->Dpc.DeferredContext) >= 3u )
    {
      sub_112FC(
        v3->Dpc.ProcessorHistory,
        0x4Du,
        (__int64)&unk_5CE18,
        a2->Tail.Overlay.CurrentStackLocation->Parameters.Read.ByteOffset.LowPart);
    }
  }
  a2->IoStatus.Information = 0i64;
  a2->IoStatus.Status = -1073741811;
  IofCompleteRequest(a2, 0);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 2) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x4Eu, (__int64)&unk_5CE18, -1073741811);
  }
  return 3221225485i64;
}

//----- (0000000000013E0C) ----------------------------------------------------
__int64 sub_13E0C()
{
  PDEVICE_OBJECT v0; // rcx
  unsigned __int16 v1; // dx
  unsigned int v3; // ebx
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x4Fu, (__int64)&unk_5CE18);
  }
  if ( (unsigned int)sub_49558(40000, 1) )
  {
    v0 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 1) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_11;
    }
    v1 = 80;
LABEL_10:
    sub_11008(v0->Dpc.ProcessorHistory, v1, (__int64)&unk_5CE18);
LABEL_11:
    sub_4A050();
    return 258i64;
  }
  if ( (unsigned int)sub_49558(40001, 1) )
  {
    v0 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 1) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_11;
    }
    v1 = 81;
    goto LABEL_10;
  }
  if ( (unsigned int)sub_49558(40002, 1) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x52u, (__int64)&unk_5CE18);
    }
    v3 = 258;
  }
  else
  {
    v4 = sub_4CCC4(40020);
    if ( v4
      && off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x53u, (__int64)&unk_5CE18, v4);
    }
    v5 = sub_4CCC4(40022);
    if ( v5
      && off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x54u, (__int64)&unk_5CE18, v5);
    }
    v6 = sub_4CCC4(40036);
    if ( v6
      && off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x55u, (__int64)&unk_5CE18, v6);
    }
    v7 = sub_4CCC4(40014);
    if ( v7
      && off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x56u, (__int64)&unk_5CE18, v7);
    }
    v8 = sub_4CCC4(40025);
    v3 = v8;
    if ( v8
      && off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x57u, (__int64)&unk_5CE18, v8);
    }
    sub_49738(40008, (__int64)sub_14268, 1);
    sub_49738(40004, (__int64)sub_15DFC, 0);
    sub_4CDB4(40021, (__int64)sub_16088);
    sub_4CDB4(40024, (__int64)sub_16388);
    sub_4CDB4(40013, (__int64)sub_19B74);
    sub_4CDB4(40012, (__int64)sub_19940);
    sub_4CFA8(40011, (__int64)sub_16618);
    sub_4CFA8(40052, (__int64)sub_1D144);
    sub_4CFA8(40003, (__int64)sub_19C6C);
    if ( !v3 )
    {
      v3 = sub_49738(40007, (__int64)sub_3A268, 0);
      if ( !v3 )
      {
        v3 = sub_4CFA8(40051, (__int64)sub_3AB3C);
        if ( !v3 )
        {
          v3 = sub_4CDB4(40023, (__int64)sub_3A27C);
          if ( !v3 )
          {
            v3 = sub_4CCC4(40019);
            if ( !v3 )
              v3 = sub_4CCC4(40038);
          }
        }
      }
    }
    if ( !(unsigned int)sub_4992C() )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x59u, (__int64)&unk_5CE18);
      }
      return v3;
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x58u, (__int64)&unk_5CE18);
    }
    v3 = 259;
  }
  sub_4A050();
  return v3;
}

//----- (0000000000014268) ----------------------------------------------------
__int64 __fastcall sub_14268(__int64 a1, union _LARGE_INTEGER *a2, unsigned int a3, __int64 a4, _DWORD *a5)
{
  _DWORD *v7; // rdi
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  __int64 result; // rax
  const char *v11; // rax
  __int16 v12; // cx
  __int64 v13; // r10
  int *v14; // r11
  int v15; // er9
  void *v16; // r8
  int v17; // [rsp+78h] [rbp+10h] BYREF

  v17 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x5Au, (__int64)&unk_5CE18);
  }
  v7 = a5;
  *a5 = 1;
  if ( !a2 )
  {
    v8 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      return 4i64;
    }
    v9 = 91;
LABEL_10:
    sub_11008(v8->Dpc.ProcessorHistory, v9, (__int64)&unk_5CE18);
    return 4i64;
  }
  if ( a3 < 0x190 )
  {
    v8 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      return 4i64;
    }
    v9 = 92;
    goto LABEL_10;
  }
  if ( a2[16].LowPart == 2 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
    {
      v11 = sub_4D7E8(1);
      sub_1164C(*(_QWORD *)(v13 + 216), v12 + 93, (__int64)&unk_5CE18, a2->QuadPart, v11);
    }
    sub_39DF4(40000i64, (__int64)a2, 400i64, 0i64, &v17);
    v14 = *(int **)((char *)&a2[16].QuadPart + 4);
    if ( v14 )
      v15 = *v14;
    else
      v15 = 0;
    if ( v14 )
      v16 = v14 + 1;
    else
      v16 = 0i64;
    sub_18B70(
      (const void *)a2[2].QuadPart,
      a2[15].HighPart,
      v16,
      v15,
      a2[15].LowPart,
      a2[16].LowPart,
      a2[26].LowPart,
      a2 + 1,
      0);
    if ( (unsigned int)sub_28A70() )
    {
      ((void (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))qword_650C8)(
        (unsigned int)a2[15].HighPart,
        (union _LARGE_INTEGER)a2[2].QuadPart,
        (unsigned int)a2[46].HighPart,
        (a2[15].LowPart & 0x10) == 16,
        0i64);
      sub_28AD8();
      if ( (unsigned int)dword_622E4 > 2 )
        _InterlockedAdd((volatile signed __int32 *)P + 2, 1u);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x60u, (__int64)&unk_5CE18);
      }
      result = 0i64;
    }
    else
    {
      *v7 = 4;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x5Fu, (__int64)&unk_5CE18);
      }
      result = 9i64;
    }
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
    {
      sub_11230(off_60148->Dpc.ProcessorHistory, 0x5Du, (__int64)&unk_5CE18, a2->QuadPart, a2[16].LowPart);
    }
    result = 6i64;
  }
  return result;
}
// 143C2: variable 'v13' is possibly undefined
// 143BF: variable 'v12' is possibly undefined
// 622E4: using guessed type int dword_622E4;
// 650C8: using guessed type __int64 (__fastcall *qword_650C8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014528) ----------------------------------------------------
__int64 __fastcall sub_14528(unsigned int a1, _QWORD *a2)
{
  _DWORD *v3; // rax

  v3 = sub_3FC10((__int64)qword_612B8, a1);
  if ( !v3 )
    return 1i64;
  *a2 = v3;
  return 0i64;
}

//----- (0000000000014568) ----------------------------------------------------
__int64 __fastcall sub_14568(__int64 a1)
{
  sub_3FAE4((__int64)qword_612B8, a1);
  return 0i64;
}

//----- (0000000000014594) ----------------------------------------------------
__int64 __fastcall sub_14594(__int64 a1, unsigned int a2)
{
  unsigned int v2; // ebx
  _WORD *v4; // rcx
  _WORD *v6; // rcx
  unsigned int v7; // esi
  unsigned int v8; // eax
  PDEVICE_OBJECT v9; // r11
  const char *v10; // r10
  __int64 v12; // rcx
  __int64 v13; // [rsp+40h] [rbp-58h] BYREF
  char Dst[40]; // [rsp+48h] [rbp-50h] BYREF
  unsigned __int16 v15; // [rsp+A0h] [rbp+8h] BYREF
  unsigned __int16 v16; // [rsp+B0h] [rbp+18h] BYREF
  unsigned int v17; // [rsp+B8h] [rbp+20h] BYREF

  v2 = 0;
  v4 = *(_WORD **)(a1 + 32);
  v16 = 0;
  v15 = 0;
  if ( v4 )
  {
    sub_44EC8(v4, &v16);
    sub_44F8C(*(_QWORD *)(a1 + 32), &v15);
  }
  else
  {
    v6 = *(_WORD **)(a1 + 40);
    if ( v6 )
    {
      sub_451B0(v6, &v16);
      sub_45274(*(_QWORD *)(a1 + 40), &v15);
    }
  }
  if ( dword_6541C == 1 )
  {
    v7 = a2;
    if ( a2 > 1 )
      --a2;
  }
  else
  {
    v7 = 0;
  }
  if ( !v16 || !v15 )
  {
    if ( (*(_BYTE *)(a1 + 88) & 1) == 0 )
      goto LABEL_14;
    v12 = *(_QWORD *)(a1 + 16);
    if ( v12 )
    {
      LOWORD(v17) = 0;
      sub_43D00(v12, &v17);
      v8 = (unsigned __int16)v17;
      goto LABEL_13;
    }
    if ( !*(_QWORD *)(a1 + 24) )
      goto LABEL_14;
    v17 = 0;
    v13 = 0i64;
    memset(Dst, 0, sizeof(Dst));
    if ( (unsigned int)sub_461F4(*(_QWORD *)(a1 + 24), 0x2Cu, (unsigned __int64 *)&v13) )
    {
      v9 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x19u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 3u )
      {
        goto LABEL_33;
      }
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x61u, (__int64)&unk_5CE18);
    }
    else
    {
      sub_46D94(v13, &v17);
      v2 = v17;
    }
    v9 = off_60148;
LABEL_33:
    v7 = v2 % a2 + 1;
    goto LABEL_15;
  }
  v8 = v15 + v16;
LABEL_13:
  v7 = v8 % a2 + 1;
LABEL_14:
  v9 = off_60148;
LABEL_15:
  if ( v9 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v9->Dpc.DeferredContext + 1, 0x19u)
    && BYTE1(v9->Dpc.DeferredContext) >= 4u )
  {
    v10 = (const char *)qword_5A920;
    if ( (*(_BYTE *)(a1 + 88) & 1) != 0 )
      v10 = "Yes";
    sub_11544(v9->Dpc.ProcessorHistory, 98i64, (__int64)&unk_5CE18, v7, v16, v15, v10);
  }
  return v7;
}
// 5A920: using guessed type __int64 qword_5A920[2];
// 6541C: using guessed type int dword_6541C;

//----- (00000000000147AC) ----------------------------------------------------
__int64 __fastcall sub_147AC(unsigned int a1, __int64 a2, int *a3, int a4, __int64 a5)
{
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  int v11; // er9
  __int64 v12; // rbx
  PDEVICE_OBJECT v13; // rcx
  unsigned __int16 v14; // dx
  _QWORD *v16; // rsi
  unsigned int v17; // eax
  int v18; // edi
  __int64 v19; // [rsp+30h] [rbp-38h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_113D0(off_60148->Dpc.ProcessorHistory, 99i64, (__int64)&unk_5CE18, a1);
  }
  if ( !dword_6126C )
  {
    v11 = *a3;
    v19 = MEMORY[0xFFFFF78000000014];
    v12 = sub_1843C(a1, a2, &v19, v11, a4 == 1);
    if ( v12 )
    {
      sub_197B8(a1, a2, (__int64)a3);
      sub_431D0(a2, a1, (__int64 *)(v12 + 24));
      if ( sub_25EF8(v12) )
        *(_DWORD *)(v12 + 120) |= 1u;
      *(_DWORD *)(v12 + 128) = 1;
      *(_DWORD *)(v12 + 372) = *a3;
      *(_DWORD *)(v12 + 380) = a3[34];
      *(_DWORD *)(v12 + 376) = a3[38];
      *(_DWORD *)(v12 + 396) = a3[92];
      *(_DWORD *)(v12 + 392) = 1;
      sub_588AC((void *)(v12 + 384), 6ui64, a3 + 35, 6ui64);
      v16 = sub_48CA0(
              _InterlockedCompareExchange64(&qword_61270, 0i64, 0i64),
              8,
              (__int64)sub_15254,
              (__int64)sub_15C58);
      if ( v16 )
      {
        *(_QWORD *)(v12 + 220) = a5;
        if ( dword_65418 )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
          {
            sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x67u, (__int64)&unk_5CE18, a5);
          }
          *(_QWORD *)(a5 + 120) = 0i64;
        }
        v17 = sub_14594(v12 + 24, dword_653F0);
        *v16 = v12;
        v18 = sub_48F24((__int64)v16, v17);
        if ( !v18 )
        {
          v9 = off_60148;
          if ( off_60148 == (PDEVICE_OBJECT)&off_60148
            || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
            || BYTE1(off_60148->Dpc.DeferredContext) < 5u )
          {
            return 0i64;
          }
          v10 = 106;
          goto LABEL_39;
        }
        sub_1864C(v12, 0);
        sub_48E4C((__int64)v16, 0);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_112FC(off_60148->Dpc.ProcessorHistory, 0x69u, (__int64)&unk_5CE18, v18);
        }
        return 3i64;
      }
      sub_1864C(v12, 0);
      v13 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
      {
        return 3i64;
      }
      v14 = 102;
    }
    else
    {
      v13 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
      {
        return 3i64;
      }
      v14 = 101;
    }
    sub_11008(v13->Dpc.ProcessorHistory, v14, (__int64)&unk_5CE18);
    return 3i64;
  }
  sub_3FAE4((__int64)qword_612B8, a2);
  v9 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148
    || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    || BYTE1(off_60148->Dpc.DeferredContext) < 5u )
  {
    return 0i64;
  }
  v10 = 100;
LABEL_39:
  sub_11008(v9->Dpc.ProcessorHistory, v10, (__int64)&unk_5CE18);
  return 0i64;
}
// 6126C: using guessed type int dword_6126C;
// 61270: using guessed type __int64 qword_61270;
// 653F0: using guessed type int dword_653F0;
// 65418: using guessed type int dword_65418;

//----- (0000000000014B0C) ----------------------------------------------------
__int64 sub_14B0C()
{
  __int64 v0; // rbx
  __int64 v1; // rdx
  unsigned __int64 v2; // rbx
  int v3; // eax
  int v4; // eax
  PDEVICE_OBJECT v5; // rcx
  KIRQL v7; // [rsp+40h] [rbp+8h] BYREF

  sub_502CC(0x200A003u);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x6Bu, (__int64)&unk_5CE18);
  }
  v0 = _InterlockedCompareExchange64(&qword_61270, 0i64, 0i64);
  if ( v0 )
  {
    sub_502CC(0x200A004u);
    sub_48AD0(v0);
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x6Cu, (__int64)&unk_5CE18);
  }
  v2 = 1000 * (unsigned int)sub_502CC(0x200A024u);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x37u, (__int64)&unk_5CDF8, qword_613E8);
  }
  LOBYTE(v1) = 1;
  v3 = sub_53DDC(qword_613E8, v1, v2);
  if ( !v3 )
    goto LABEL_20;
  v4 = sub_57F30(v3);
  v5 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    goto LABEL_29;
  if ( (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x38u, (__int64)&unk_5CDF8, v4);
LABEL_20:
    v5 = off_60148;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(v5->Dpc.DeferredContext) & 4) != 0 && BYTE1(v5->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v5->Dpc.ProcessorHistory, 0x39u, (__int64)&unk_5CDF8);
      v5 = off_60148;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v5->Dpc.DeferredContext) & 1) != 0
      && BYTE1(v5->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v5->Dpc.ProcessorHistory, 0x6Du, (__int64)&unk_5CE18);
    }
  }
LABEL_29:
  sub_2879C();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x6Eu, (__int64)&unk_5CE18);
  }
  sub_401B8(&SpinLock, &v7);
  dword_6509C = 0;
  sub_40230(&SpinLock, v7);
  while ( dword_65098 )
    ;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x6Fu, (__int64)&unk_5CE18);
  }
  sub_2F3D8();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x70u, (__int64)&unk_5CE18);
  }
  sub_2FA74();
  if ( qword_61290 )
    sub_4EC48((PVOID *)&qword_61290);
  if ( *(_QWORD *)&qword_61298 )
    sub_4EC48((PVOID *)&qword_61298);
  if ( qword_612A0 )
    sub_4EC48((PVOID *)&qword_612A0);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x71u, (__int64)&unk_5CE18);
  }
  return 0i64;
}
// 14C1F: variable 'v1' is possibly undefined
// 61270: using guessed type __int64 qword_61270;
// 61290: using guessed type __int64 qword_61290;
// 612A0: using guessed type __int64 qword_612A0;
// 65098: using guessed type int dword_65098;
// 6509C: using guessed type int dword_6509C;

//----- (0000000000014E54) ----------------------------------------------------
__int64 __fastcall sub_14E54(int a1, __int64 a2)
{
  unsigned int v4; // edi
  PDEVICE_OBJECT v5; // rcx
  int v6; // ebx
  int **v7; // rax
  unsigned __int16 v8; // dx
  int v9; // er9
  _DWORD *v10; // rbx

  v4 = 0;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x72u, (__int64)&unk_5CE18);
    v5 = off_60148;
  }
  if ( !a2 )
  {
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v5->Dpc.DeferredContext) & 0x10) != 0
      && BYTE1(v5->Dpc.DeferredContext) >= 2u )
    {
      sub_2F80C(v5->Dpc.ProcessorHistory, 0x73u, (__int64)&unk_5CE18, 0i64);
      v5 = off_60148;
    }
    goto LABEL_10;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v5->Dpc.DeferredContext) & 0x10) != 0
    && BYTE1(v5->Dpc.DeferredContext) >= 4u )
  {
    sub_115F4(v5->Dpc.ProcessorHistory, 0x74u, (__int64)&unk_5CE18, a1);
    v5 = off_60148;
  }
  v6 = a1 - 1;
  if ( !v6 )
  {
    v9 = 8;
    if ( *(_DWORD *)(a2 + 8) != 8 )
    {
      if ( v5 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(v5->Dpc.DeferredContext) & 0x10) == 0
        || BYTE1(v5->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_30;
      }
      v8 = 117;
      goto LABEL_29;
    }
    sub_2BEEC(*(int ***)a2);
LABEL_32:
    v5 = off_60148;
    goto LABEL_33;
  }
  if ( v6 == 1 )
  {
    v7 = *(int ***)a2;
    if ( *(_DWORD *)(a2 + 8) != 16 )
    {
      if ( v5 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(v5->Dpc.DeferredContext) & 0x10) == 0
        || BYTE1(v5->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_30;
      }
      v8 = 118;
      v9 = 16;
LABEL_29:
      sub_11430(v5->Dpc.ProcessorHistory, v8, (__int64)&unk_5CE18, v9);
      v5 = off_60148;
LABEL_30:
      v4 = 3;
      goto LABEL_33;
    }
    v10 = v7 + 1;
    sub_2ACF8((wchar_t *)*v7 + 80, (_DWORD *)v7 + 2);
    if ( *v10 )
      _InterlockedAdd64(&qword_61390, 1ui64);
    goto LABEL_32;
  }
LABEL_10:
  v4 = 2;
LABEL_33:
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v5->Dpc.DeferredContext) & 0x10) != 0
    && BYTE1(v5->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(v5->Dpc.ProcessorHistory, 0x77u, (__int64)&unk_5CE18, v4);
  }
  return v4;
}
// 61390: using guessed type __int64 qword_61390;

//----- (0000000000015050) ----------------------------------------------------
__int64 __fastcall sub_15050(__int64 *a1, int a2)
{
  __int64 result; // rax
  int v5; // er13
  ULONG_PTR v6; // rbp
  __int64 v7; // rax
  __int64 v8; // rbp
  __int64 v9; // [rsp+20h] [rbp-28h]
  ULONG_PTR BugCheckParameter1; // [rsp+50h] [rbp+8h] BYREF

  BugCheckParameter1 = 0i64;
  if ( a1 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x79u, (__int64)&unk_5CE18, *a1);
    }
    sub_40598((PFAST_MUTEX)(a1 + 19));
    v5 = *((_DWORD *)a1 + 52);
    sub_40664((PFAST_MUTEX)(a1 + 19));
    while ( 1 )
    {
      v7 = sub_27CDC((__int64)&qword_650A0, *a1, &BugCheckParameter1);
      v8 = v7;
      if ( !v7 )
        break;
      sub_40598((PFAST_MUTEX)(v7 + 152));
      *(_DWORD *)(v8 + 208) = v5;
      sub_40664((PFAST_MUTEX)(v8 + 152));
      v6 = BugCheckParameter1;
      if ( BugCheckParameter1 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          LODWORD(v9) = a2 == 1;
          sub_11230(off_60148->Dpc.ProcessorHistory, 0x7Au, (__int64)&unk_5CE18, *a1, v9);
        }
        if ( a2 == 1 )
          sub_189A0(a1, 1i64);
        else
          sub_243C4(v6, 25);
        sub_243C4(v6, 20);
      }
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x7Bu, (__int64)&unk_5CE18);
    }
    result = 0i64;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x78u, (__int64)&unk_5CE18);
    }
    result = 4i64;
  }
  return result;
}
// 151AB: variable 'v9' is possibly undefined
// 189A0: using guessed type __int64 __fastcall sub_189A0(_QWORD, _QWORD);
// 650A0: using guessed type __int64 qword_650A0;

//----- (0000000000015254) ----------------------------------------------------
void __fastcall sub_15254(__int64 *a1, __int64 a2)
{
  PDEVICE_OBJECT v3; // rcx
  __int64 v4; // rbx
  __int64 v5; // rcx
  unsigned __int16 v6; // dx
  unsigned __int16 v7; // dx
  const char *v8; // rax
  __int64 v9; // r10
  const char *v10; // r9
  int *v11; // r11
  int v12; // er9
  void *v13; // r8
  PDEVICE_OBJECT v14; // rcx
  ULONG_PTR v15; // rax
  __int64 v16; // rsi
  int v17; // edx
  ULONG_PTR v18; // rcx
  PDEVICE_OBJECT v19; // r11
  int v20; // ebp
  const char *v21; // rax
  __int64 v22; // r11
  int v23; // ebx
  ULONG_PTR v24; // rcx
  int v25; // edx
  __int64 v26; // [rsp+20h] [rbp-A8h]
  int v27; // [rsp+50h] [rbp-78h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+58h] [rbp-70h] BYREF
  ULONG_PTR v29; // [rsp+60h] [rbp-68h] BYREF
  int v30; // [rsp+68h] [rbp-60h] BYREF
  int v31; // [rsp+6Ch] [rbp-5Ch] BYREF
  __int64 v32; // [rsp+70h] [rbp-58h] BYREF
  __int64 v33; // [rsp+78h] [rbp-50h] BYREF
  __int64 v34[2]; // [rsp+80h] [rbp-48h] BYREF
  _BYTE v35[12]; // [rsp+90h] [rbp-38h]
  char v36; // [rsp+9Ch] [rbp-2Ch]

  v31 = 0;
  v27 = 0;
  v29 = 0i64;
  BugCheckParameter1 = 0i64;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x7Cu, (__int64)&unk_5CE18, a1);
    v3 = off_60148;
  }
  v4 = *a1;
  if ( !v4 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(v3->Dpc.DeferredContext) >= 2u )
    {
      v5 = v3->Dpc.ProcessorHistory;
      v6 = 125;
LABEL_173:
      sub_11008(v5, v6, (__int64)&unk_5CE18);
      return;
    }
    return;
  }
  if ( !dword_653E4 || dword_6126C )
  {
    sub_15D38(v4);
    if ( (unsigned int)dword_622E4 > 9 )
      _InterlockedAdd((volatile signed __int32 *)P + 9, 1u);
    return;
  }
  if ( *(_QWORD *)(v4 + 48) && !dword_653F4 && !dword_65408 )
  {
    if ( v3 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x10u)
      || BYTE1(v3->Dpc.DeferredContext) < 3u )
    {
      goto LABEL_20;
    }
    v7 = 127;
LABEL_19:
    sub_11008(v3->Dpc.ProcessorHistory, v7, (__int64)&unk_5CE18);
LABEL_20:
    sub_15D38(v4);
    return;
  }
  if ( (*(_BYTE *)(v4 + 112) & 1) != 0 && dword_653F8 != 3 && sub_1CF58(v4 + 24) )
  {
    _InterlockedAdd64(&qword_613A8, 1ui64);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      v8 = sub_4DA64(dword_653F8);
      v10 = "IPv6";
      if ( *(_QWORD *)(v4 + 40) )
        v10 = "IPv4";
      sub_11908(*(_QWORD *)(v9 + 216), 0x80u, (__int64)&unk_5CE18, v10, v8);
    }
    goto LABEL_20;
  }
  if ( sub_19D94(v4, a2) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x81u, (__int64)&unk_5CE18);
    }
    _InterlockedAdd64(&qword_61348, 1ui64);
    goto LABEL_20;
  }
  if ( byte_653E0 == 1 )
    sub_17784(v4);
  if ( dword_65408 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x82u, (__int64)&unk_5CE18);
    }
    sub_1B63C(v4, 1, &v30);
    if ( v30 == 2 )
    {
      *(_DWORD *)(v4 + 120) |= 0x1000u;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x83u, (__int64)&unk_5CE18);
      }
    }
    else if ( v30 == 1 )
    {
      _InterlockedAdd64(&qword_613A0, 1ui64);
      if ( (*(_BYTE *)(v4 + 120) & 4) != 0 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x84u, (__int64)&unk_5CE18);
        }
        sub_4ED98(v4, "|ISOLATION_EXCLUDED|", 0x14ui64);
        v11 = *(int **)(v4 + 132);
        if ( v11 )
          v12 = *v11;
        else
          v12 = 0;
        v13 = v11 + 1;
        if ( !v11 )
          v13 = 0i64;
        sub_18B70(
          *(const void **)(v4 + 16),
          *(_DWORD *)(v4 + 124),
          v13,
          v12,
          *(_DWORD *)(v4 + 120),
          *(_DWORD *)(v4 + 128),
          *(_DWORD *)(v4 + 208),
          (PLARGE_INTEGER)(v4 + 8),
          0);
      }
      v3 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 3u )
      {
        goto LABEL_20;
      }
      v7 = 133;
      goto LABEL_19;
    }
  }
  *(_QWORD *)(v4 + 8) = MEMORY[0xFFFFF78000000014];
  *(_QWORD *)(v4 + 144) = _InterlockedCompareExchange64(&qword_613D0, 0i64, 0i64);
  sub_255AC((__int64 *)v4, 0);
  if ( (unsigned int)sub_236BC((unsigned __int64 *)v4, (ULONG_PTR **)&v29, 1) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x86u, (__int64)&unk_5CE18);
    }
    sub_15D38(v4);
    goto LABEL_164;
  }
  sub_255AC((__int64 *)v4, 1);
  if ( (unsigned int)dword_622E4 > 7 )
    _InterlockedAdd((volatile signed __int32 *)P + 7, 1u);
  if ( (*(_BYTE *)(v4 + 120) & 1) == 0 || (*(_BYTE *)(v4 + 120) & 0x10) != 0 )
  {
LABEL_105:
    v15 = BugCheckParameter1;
    v16 = *(_QWORD *)v4;
    if ( BugCheckParameter1 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x8Eu, (__int64)&unk_5CE18);
        v15 = BugCheckParameter1;
      }
      v17 = 4;
      v18 = v15;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x8Fu, (__int64)&unk_5CE18);
      }
      v18 = v29;
      v17 = 3;
    }
    sub_2422C(v18, v17);
    v20 = sub_16B6C((PVOID)v4, &v27);
    v19 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      v21 = sub_4D7E8(v27);
      sub_1182C(*(_QWORD *)(v22 + 216), 0x90u, (__int64)&unk_5CE18, v21);
      v19 = off_60148;
    }
    v23 = (unsigned __int16)v27;
    if ( (unsigned __int16)v27 == 4 && _bittest(&v27, 0x1Eu) )
    {
LABEL_155:
      if ( v20 )
      {
        if ( v19 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0x10u)
          && BYTE1(v19->Dpc.DeferredContext) >= 2u )
        {
          LODWORD(v26) = v20;
          sub_11230(v19->Dpc.ProcessorHistory, 0x94u, (__int64)&unk_5CE18, v16, v26);
          goto LABEL_164;
        }
      }
      else if ( v19 != (PDEVICE_OBJECT)&off_60148
             && _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0x10u)
             && BYTE1(v19->Dpc.DeferredContext) >= 2u )
      {
        sub_2F80C(v19->Dpc.ProcessorHistory, 0x95u, (__int64)&unk_5CE18, v16);
        goto LABEL_164;
      }
      goto LABEL_165;
    }
    if ( v19 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(v19->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v19->Dpc.ProcessorHistory, 0x91u, (__int64)&unk_5CE18);
      v19 = off_60148;
    }
    if ( v23 == 4 || v23 == 2 )
    {
      if ( v19 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(v19->Dpc.DeferredContext) >= 4u )
      {
        sub_2F80C(v19->Dpc.ProcessorHistory, 0x92u, (__int64)&unk_5CE18, v16);
      }
      v24 = BugCheckParameter1;
      if ( BugCheckParameter1 )
      {
        v25 = 9;
        goto LABEL_154;
      }
      v25 = 6;
    }
    else
    {
      if ( v19 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(v19->Dpc.DeferredContext) >= 4u )
      {
        sub_2F80C(v19->Dpc.ProcessorHistory, 0x93u, (__int64)&unk_5CE18, v16);
      }
      v24 = BugCheckParameter1;
      if ( BugCheckParameter1 )
      {
        v25 = 8;
LABEL_154:
        sub_243C4(v24, v25);
        v19 = off_60148;
        goto LABEL_155;
      }
      v25 = 7;
    }
    v24 = v29;
    goto LABEL_154;
  }
  v32 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x87u, (__int64)&unk_5CE18);
  }
  v34[0] = 0i64;
  v34[1] = 0i64;
  *(_QWORD *)v35 = 0i64;
  *(_DWORD *)&v35[8] = 0;
  v36 = 0;
  sub_17F30((__int64 *)v4, &v31, (char *)v34);
  if ( (unsigned __int16)v31 != 4 && (unsigned __int16)v31 != 2 )
  {
    if ( sub_25F7C((__int64)&qword_650A0, *(unsigned __int16 *)&v35[7], *(unsigned __int16 *)v35) )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x89u, (__int64)&unk_5CE18);
      }
      _InterlockedAdd64(&qword_651A8, 1ui64);
      goto LABEL_164;
    }
    v14 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x8Au, (__int64)&unk_5CE18);
        v14 = off_60148;
      }
      if ( v14 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v14->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(v14->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v14->Dpc.ProcessorHistory, 0x8Bu, (__int64)&unk_5CE18);
      }
    }
    if ( (unsigned int)sub_27028(
                         (__int64)&qword_650A0,
                         (__int64 *)v4,
                         &v33,
                         (ULONG_PTR **)&BugCheckParameter1,
                         &v32,
                         (__int64)v34) )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x8Cu, (__int64)&unk_5CE18);
      }
      if ( BugCheckParameter1 )
        sub_243C4(BugCheckParameter1, 33);
      return;
    }
    if ( !v33 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x8Du, (__int64)&unk_5CE18);
      }
      sub_2422C(v29, 23);
      goto LABEL_164;
    }
    if ( byte_653E0 == 1 )
      sub_17784(v4);
    v4 = v32;
    goto LABEL_105;
  }
  v19 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x88u, (__int64)&unk_5CE18);
    v19 = off_60148;
  }
  if ( (unsigned int)dword_622E4 > 3 )
  {
    _InterlockedAdd((volatile signed __int32 *)P + 3, 1u);
LABEL_164:
    v19 = off_60148;
  }
LABEL_165:
  if ( v29 )
  {
    sub_243C4(v29, 2);
    v19 = off_60148;
  }
  if ( BugCheckParameter1 )
  {
    sub_243C4(BugCheckParameter1, 2);
    v19 = off_60148;
  }
  if ( v19 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(v19->Dpc.DeferredContext) >= 5u )
  {
    v5 = v19->Dpc.ProcessorHistory;
    v6 = 150;
    goto LABEL_173;
  }
}
// 153FF: variable 'v9' is possibly undefined
// 15418: variable 'a2' is possibly undefined
// 15A18: variable 'v22' is possibly undefined
// 15B61: variable 'v26' is possibly undefined
// 6126C: using guessed type int dword_6126C;
// 61348: using guessed type __int64 qword_61348;
// 613A0: using guessed type __int64 qword_613A0;
// 613A8: using guessed type __int64 qword_613A8;
// 613D0: using guessed type __int64 qword_613D0;
// 622E4: using guessed type int dword_622E4;
// 650A0: using guessed type __int64 qword_650A0;
// 651A8: using guessed type __int64 qword_651A8;
// 653E0: using guessed type char byte_653E0;
// 653E4: using guessed type int dword_653E4;
// 653F4: using guessed type int dword_653F4;
// 653F8: using guessed type int dword_653F8;
// 65408: using guessed type int dword_65408;

//----- (0000000000015C58) ----------------------------------------------------
void __fastcall sub_15C58(__int64 *a1)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x97u, (__int64)&unk_5CE18, a1);
    v2 = off_60148;
  }
  if ( *a1 )
  {
    sub_1864C(*a1, 1);
LABEL_11:
    v2 = off_60148;
    goto LABEL_12;
  }
  if ( v2 == (PDEVICE_OBJECT)&off_60148 )
    return;
  if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x10u) && BYTE1(v2->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v2->Dpc.ProcessorHistory, 0x98u, (__int64)&unk_5CE18);
    goto LABEL_11;
  }
LABEL_12:
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(v2->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v2->Dpc.ProcessorHistory, 0x99u, (__int64)&unk_5CE18);
  }
}

//----- (0000000000015D38) ----------------------------------------------------
__int64 __fastcall sub_15D38(__int64 a1)
{
  unsigned int v2; // ebx

  v2 = 0;
  if ( (unsigned int)sub_28A70() )
  {
    if ( (unsigned int)dword_622E4 > 2 )
      _InterlockedAdd((volatile signed __int32 *)P + 2, 1u);
    qword_650C8(
      *(unsigned int *)(a1 + 124),
      *(_QWORD *)(a1 + 16),
      *(unsigned int *)(a1 + 372),
      (*(_BYTE *)(a1 + 120) & 0x10) == 16,
      *(_QWORD *)(a1 + 220));
    sub_28AD8();
  }
  else
  {
    v2 = 11;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x9Bu, (__int64)&unk_5CE18);
    }
  }
  sub_1864C(a1, 1);
  return v2;
}
// 622E4: using guessed type int dword_622E4;
// 650C8: using guessed type __int64 (__fastcall *qword_650C8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000015DFC) ----------------------------------------------------
__int64 __fastcall sub_15DFC(__int64 a1, __int64 a2, unsigned int a3, __int64 a4, _DWORD *a5)
{
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  unsigned int v9; // esi
  const char *v10; // rax
  __int64 v11; // r10
  int v12; // eax
  __int64 v13; // r12
  int v14; // ebx
  __int64 v16[5]; // [rsp+30h] [rbp-28h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+68h] [rbp+10h] BYREF

  v16[0] = 0i64;
  BugCheckParameter1 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x9Cu, (__int64)&unk_5CE18);
  }
  *a5 = 1;
  if ( !a2 )
  {
    v7 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_11;
    }
    v8 = 157;
LABEL_10:
    sub_11008(v7->Dpc.ProcessorHistory, v8, (__int64)&unk_5CE18);
    v7 = off_60148;
LABEL_11:
    v9 = 4;
    goto LABEL_32;
  }
  if ( a3 < 0xC )
  {
    v7 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_11;
    }
    v8 = 158;
    goto LABEL_10;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    v10 = sub_4D7E8(*(_DWORD *)(a2 + 8));
    sub_1164C(*(_QWORD *)(v11 + 216), 0x9Fu, (__int64)&unk_5CE18, *(_QWORD *)a2, v10);
  }
  v12 = sub_240F4(*(_QWORD *)a2, v16, &BugCheckParameter1, 43);
  v13 = v16[0];
  v9 = v12;
  if ( v12 )
  {
    v7 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0xA0u, (__int64)&unk_5CE18, v12);
      v7 = off_60148;
    }
    v9 = 5;
  }
  else
  {
    sub_40598((PFAST_MUTEX)(v16[0] + 152));
    *(_DWORD *)(v13 + 208) = *(_DWORD *)(a2 + 8);
    sub_40664((PFAST_MUTEX)(v13 + 152));
    v7 = off_60148;
  }
  if ( BugCheckParameter1 )
  {
    sub_40598((PFAST_MUTEX)(v13 + 152));
    v14 = *(_DWORD *)(v13 + 212);
    sub_40664((PFAST_MUTEX)(v13 + 152));
    sub_243C4(BugCheckParameter1, 44);
    if ( v14 == 2 )
      sub_243C4(BugCheckParameter1, 45);
    v7 = off_60148;
  }
LABEL_32:
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(v7->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v7->Dpc.ProcessorHistory, 0xA1u, (__int64)&unk_5CE18);
  }
  return v9;
}
// 15F18: variable 'v11' is possibly undefined

//----- (0000000000016088) ----------------------------------------------------
__int64 __fastcall sub_16088(__int64 a1, _QWORD *a2, unsigned int a3)
{
  PDEVICE_OBJECT v5; // r10
  unsigned __int16 v6; // dx
  const char *v8; // rax
  __int64 v9; // r10
  int v10; // er8
  unsigned int v11; // er12
  __int64 v12; // rsi
  struct _FAST_MUTEX *v13; // rcx
  PDEVICE_OBJECT v14; // rcx
  ULONG_PTR BugCheckParameter1; // [rsp+68h] [rbp+10h] BYREF
  __int64 v16; // [rsp+78h] [rbp+20h] BYREF

  v16 = 0i64;
  BugCheckParameter1 = 0i64;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xA2u, (__int64)&unk_5CE18);
    v5 = off_60148;
  }
  if ( !a2 )
  {
    if ( v5 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x10u)
      || BYTE1(v5->Dpc.DeferredContext) < 2u )
    {
      return 4i64;
    }
    v6 = 163;
LABEL_10:
    sub_11008(v5->Dpc.ProcessorHistory, v6, (__int64)&unk_5CE18);
    return 4i64;
  }
  if ( a3 < 0xD )
  {
    if ( v5 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x10u)
      || BYTE1(v5->Dpc.DeferredContext) < 2u )
    {
      return 4i64;
    }
    v6 = 164;
    goto LABEL_10;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(v5->Dpc.DeferredContext) >= 4u )
  {
    v8 = sub_4D7E8(*((_DWORD *)a2 + 2));
    sub_116CC(*(_QWORD *)(v9 + 216), 0xA5u, (__int64)&unk_5CE18, *a2, v8, v10);
  }
  v11 = sub_240F4(*a2, &v16, &BugCheckParameter1, 38);
  if ( v11 || (v12 = v16) == 0 )
  {
    v14 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_38;
    }
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xA8u, (__int64)&unk_5CE18, *a2);
  }
  else
  {
    v13 = (struct _FAST_MUTEX *)(v16 + 152);
    if ( *((_BYTE *)a2 + 12) )
    {
      sub_40598(v13);
      *(_DWORD *)(v12 + 212) = 1;
      sub_40664((PFAST_MUTEX)(v12 + 152));
      v14 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
        || BYTE1(off_60148->Dpc.DeferredContext) < 5u )
      {
        goto LABEL_38;
      }
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xA6u, (__int64)&unk_5CE18);
    }
    else
    {
      sub_40598(v13);
      *(_DWORD *)(v12 + 208) = *((_DWORD *)a2 + 2);
      sub_40664((PFAST_MUTEX)(v12 + 152));
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xA7u, (__int64)&unk_5CE18);
      }
      sub_243C4(BugCheckParameter1, 40);
    }
  }
  v14 = off_60148;
LABEL_38:
  if ( BugCheckParameter1 )
  {
    if ( v14 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v14->Dpc.DeferredContext + 1, 0xAu)
      && BYTE1(v14->Dpc.DeferredContext) >= 5u )
    {
      sub_2F80C(v14->Dpc.ProcessorHistory, 0xA9u, (__int64)&unk_5CE18, *a2);
    }
    sub_243C4(BugCheckParameter1, 39);
    v14 = off_60148;
  }
  if ( v14 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v14->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(v14->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v14->Dpc.ProcessorHistory, 0xAAu, (__int64)&unk_5CE18);
  }
  return v11;
}
// 16182: variable 'v9' is possibly undefined
// 1619B: variable 'v10' is possibly undefined

//----- (0000000000016388) ----------------------------------------------------
__int64 __fastcall sub_16388(__int64 a1, __int64 a2, unsigned int a3)
{
  unsigned int v5; // esi
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  int v9; // eax

  v5 = 0;
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xABu, (__int64)&unk_5CE18);
    v6 = off_60148;
  }
  if ( !a2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x10u)
      || BYTE1(v6->Dpc.DeferredContext) < 2u )
    {
      return 4i64;
    }
    v7 = 172;
LABEL_10:
    sub_11008(v6->Dpc.ProcessorHistory, v7, (__int64)&unk_5CE18);
    return 4i64;
  }
  if ( a3 < 0x78 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x10u)
      || BYTE1(v6->Dpc.DeferredContext) < 2u )
    {
      return 4i64;
    }
    v7 = 173;
    goto LABEL_10;
  }
  if ( dword_6126C )
    return 0i64;
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(v6->Dpc.DeferredContext) >= 4u )
  {
    sub_112FC(v6->Dpc.ProcessorHistory, 0xAEu, (__int64)&unk_5CE18, *(_DWORD *)a2);
    v6 = off_60148;
  }
  switch ( *(_DWORD *)a2 )
  {
    case 1:
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(v6->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v6->Dpc.ProcessorHistory, 0xAFu, (__int64)&unk_5CE18);
      }
      sub_2E7B8((void *)a2);
      goto LABEL_44;
    case 2:
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(v6->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v6->Dpc.ProcessorHistory, 0xB0u, (__int64)&unk_5CE18);
      }
      sub_2F338(a2 + 8);
      v9 = sub_31700(a2 + 8);
      v5 = v9;
      if ( !v9 )
        goto LABEL_44;
      v6 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_112FC(off_60148->Dpc.ProcessorHistory, 0xB1u, (__int64)&unk_5CE18, v9);
          goto LABEL_44;
        }
LABEL_45:
        if ( v6 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x10u)
          && BYTE1(v6->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(v6->Dpc.ProcessorHistory, 0xB3u, (__int64)&unk_5CE18);
        }
        return v5;
      }
      break;
    case 3:
      sub_2F338(a2 + 8);
      sub_31554(a2 + 8, a2 + 46, (const __m128i *)(a2 + 52));
      v6 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0xB2u, (__int64)&unk_5CE18);
LABEL_44:
          v6 = off_60148;
          goto LABEL_45;
        }
        goto LABEL_45;
      }
      break;
    default:
      goto LABEL_45;
  }
  return v5;
}
// 6126C: using guessed type int dword_6126C;

//----- (0000000000016618) ----------------------------------------------------
__int64 __fastcall sub_16618(__int64 a1, __int64 a2, __int64 a3, unsigned int *a4, _QWORD *a5, _DWORD *a6)
{
  int v7; // ebx
  unsigned int v8; // ebx
  PVOID v9; // rax
  __int64 result; // rax
  unsigned int v11; // eax
  unsigned int v12; // edi
  unsigned int v13[6]; // [rsp+30h] [rbp-18h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xB4u, (__int64)&unk_5CE18);
  }
  v7 = sub_30D34();
  if ( v7 )
  {
    v8 = 395 * v7;
    v13[0] = v8;
    v9 = sub_3F66C(2, v8, 0x7764734Eu);
    *a5 = v9;
    if ( v9 )
    {
      v11 = sub_30EA8(v9, v13);
      *a4 = v8;
      *a6 = 2003071822;
      v12 = v11;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xB7u, (__int64)&unk_5CE18);
      }
      result = v12;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xB6u, (__int64)&unk_5CE18);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xB5u, (__int64)&unk_5CE18);
    }
    result = 0i64;
  }
  return result;
}

//----- (00000000000167A4) ----------------------------------------------------
ULONG_PTR __fastcall sub_167A4(_QWORD **a1)
{
  PDEVICE_OBJECT v2; // rcx
  _QWORD *v3; // rdi
  int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  ULONG_PTR result; // rax
  int v7; // [rsp+50h] [rbp+8h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+58h] [rbp+10h] BYREF

  v7 = 0;
  BugCheckParameter1 = 0i64;
  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xB8u, (__int64)&unk_5CE18);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(v2->Dpc.DeferredContext) >= 5u )
    {
      sub_2F80C(v2->Dpc.ProcessorHistory, 0xB9u, (__int64)&unk_5CE18, a1);
    }
  }
  v3 = *a1;
  sub_40598((PFAST_MUTEX)(v3 + 19));
  *((_DWORD *)v3 + 52) = 0;
  *((_DWORD *)v3 + 53) = 0;
  sub_40664((PFAST_MUTEX)(v3 + 19));
  v3[1] = MEMORY[0xFFFFF78000000014];
  v3[18] = _InterlockedCompareExchange64(&qword_613D0, 0i64, 0i64);
  if ( (unsigned int)sub_236BC(v3, (ULONG_PTR **)&BugCheckParameter1, 12) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xBAu, (__int64)&unk_5CE18);
    }
    if ( (v3[15] & 2) != 0 )
      sub_1864C((__int64)v3, 1);
    else
      sub_15D38((__int64)v3);
    goto LABEL_37;
  }
  if ( (unsigned int)dword_622E4 > 7 )
    _InterlockedAdd((volatile signed __int32 *)P + 7, 1u);
  sub_2422C(BugCheckParameter1, 13);
  v4 = sub_16B6C(v3, &v7);
  if ( (_WORD)v7 != 4 || !_bittest(&v7, 0x1Eu) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xBBu, (__int64)&unk_5CE18);
    }
    sub_243C4(BugCheckParameter1, 14);
  }
  if ( v4 )
  {
    v5 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11230(off_60148->Dpc.ProcessorHistory, 0xBCu, (__int64)&unk_5CE18, *v3, v4);
LABEL_37:
      v5 = off_60148;
      goto LABEL_38;
    }
  }
  else
  {
    v5 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xBDu, (__int64)&unk_5CE18, *v3);
      v5 = off_60148;
    }
    if ( (unsigned int)dword_622E4 > 8 )
    {
      _InterlockedAdd((volatile signed __int32 *)P + 8, 1u);
      goto LABEL_37;
    }
  }
LABEL_38:
  result = BugCheckParameter1;
  if ( BugCheckParameter1 )
  {
    result = sub_243C4(BugCheckParameter1, 15);
    v5 = off_60148;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(v5->Dpc.DeferredContext) >= 5u )
  {
    result = sub_11008(v5->Dpc.ProcessorHistory, 0xBEu, (__int64)&unk_5CE18);
  }
  return result;
}
// 613D0: using guessed type __int64 qword_613D0;
// 622E4: using guessed type int dword_622E4;

//----- (0000000000016A88) ----------------------------------------------------
__int64 __fastcall sub_16A88(__int64 a1, __int64 a2)
{
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx

  v4 = 4;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xBFu, (__int64)&unk_5CE18);
    v5 = off_60148;
  }
  if ( a1 && a2 )
  {
    v4 = 0;
    *(_DWORD *)(a1 + 120) = *(_DWORD *)(a2 + 120);
    *(_QWORD *)(a1 + 132) = *(_QWORD *)(a2 + 132);
    *(_DWORD *)(a1 + 140) = *(_DWORD *)(a2 + 140);
    v5 = off_60148;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(v5->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v5->Dpc.ProcessorHistory, 0xC0u, (__int64)&unk_5CE18);
  }
  return v4;
}

//----- (0000000000016B6C) ----------------------------------------------------
__int64 __fastcall sub_16B6C(PVOID StartContext, int *a2)
{
  int v4; // ebp
  bool v5; // zf
  const char *v6; // rax
  __int64 v7; // r10
  int v8; // er11
  PDEVICE_OBJECT v9; // r11
  const char *v10; // rax
  __int64 v11; // r11
  int v12; // er8
  int v13; // edx
  int v14; // ecx
  int v15; // ecx
  const char *v16; // rax
  __int64 v17; // r10
  unsigned __int16 v18; // dx
  __int64 v20; // [rsp+28h] [rbp-30h]
  char v21; // [rsp+60h] [rbp+8h] BYREF
  int v22; // [rsp+68h] [rbp+10h] BYREF

  v22 = 0;
  v21 = 0;
  v4 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xC1u, (__int64)&unk_5CE18);
  }
  sub_19248((__int64)StartContext, &v21);
  if ( v21 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xC2u, (__int64)&unk_5CE18, *(_QWORD *)StartContext);
    }
    v5 = (*((_BYTE *)StartContext + 120) & 4) == 0;
    v22 = 3;
    if ( !v5 )
      sub_4ED98((__int64)StartContext, "|LOOPBACK|", 0xAui64);
    goto LABEL_55;
  }
  if ( *((_DWORD *)StartContext + 95) == 2 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xBu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xC3u, (__int64)&unk_5CE18);
    }
    if ( dword_65430 == 1 )
    {
      sub_2F598((__int64)StartContext, &v22);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xBu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        v6 = sub_4D7E8(v22);
        sub_116CC(*(_QWORD *)(v7 + 216), 0xC4u, (__int64)&unk_5CE18, *(_QWORD *)StartContext, v6, v8);
      }
      sub_17448((__int64)StartContext, v22);
    }
  }
  if ( (unsigned __int16)v22 != 4 && (unsigned __int16)v22 != 2 )
  {
    if ( !sub_251F4(StartContext, &v22) )
    {
      sub_39DF4(40000i64, (__int64)StartContext, 400i64, 0i64, a2);
      if ( *a2 == 3 )
      {
        v9 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
          goto LABEL_41;
        if ( (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
          || BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) < 4u )
        {
LABEL_37:
          if ( v9 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v9->Dpc.DeferredContext + 1, 0xAu)
            && BYTE1(v9->Dpc.DeferredContext) >= 4u )
          {
            v10 = sub_4D7E8(v22);
            LODWORD(v20) = v12;
            sub_116CC(*(_QWORD *)(v11 + 216), 0xC7u, (__int64)&unk_5CE18, *(_QWORD *)StartContext, v10, v20);
          }
LABEL_41:
          sub_40598((PFAST_MUTEX)((char *)StartContext + 152));
          v4 = *((_DWORD *)StartContext + 53);
          sub_40664((PFAST_MUTEX)((char *)StartContext + 152));
          if ( v4 )
          {
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
              && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
            {
              sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xC8u, (__int64)&unk_5CE18, *(_QWORD *)StartContext);
            }
            v4 = 1;
            v22 = 1073741828;
            v13 = 41;
          }
          else
          {
            if ( (_WORD)v22 != 4 || !_bittest(&v22, 0x1Eu) )
              goto LABEL_55;
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
              && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
            {
              sub_11008(off_60148->Dpc.ProcessorHistory, 0xC9u, (__int64)&unk_5CE18);
            }
            v4 = 2;
            v13 = 46;
          }
          sub_1CA88((__int64)StartContext, v13);
          goto LABEL_55;
        }
        sub_11008(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0xC6u, (__int64)&unk_5CE18);
      }
      else
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
          && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_112FC(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0xC5u, (__int64)&unk_5CE18, *a2);
        }
        sub_49AEC(40000, StartContext, 0x190u, dword_65434, &v22, (void (__fastcall *)(const void *, _QWORD))sub_16A88);
      }
    }
    v9 = off_60148;
    goto LABEL_37;
  }
LABEL_55:
  sub_40598((PFAST_MUTEX)((char *)StartContext + 152));
  v14 = *((_DWORD *)StartContext + 52);
  *((_DWORD *)StartContext + 53) = v4;
  if ( v14 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      v16 = sub_4D7E8(v14);
      v18 = 203;
      goto LABEL_64;
    }
  }
  else
  {
    v15 = v22;
    *((_DWORD *)StartContext + 52) = v22;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      v16 = sub_4D7E8(v15);
      v18 = 202;
LABEL_64:
      sub_1182C(*(_QWORD *)(v17 + 216), v18, (__int64)&unk_5CE18, v16);
      goto LABEL_65;
    }
  }
LABEL_65:
  sub_40664((PFAST_MUTEX)((char *)StartContext + 152));
  sub_17238((__int64)StartContext, 0);
  if ( a2 )
    *a2 = v22;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xCDu, (__int64)&unk_5CE18);
  }
  return 0i64;
}
// 16CCB: variable 'v7' is possibly undefined
// 16CE4: variable 'v8' is possibly undefined
// 16E18: variable 'v12' is possibly undefined
// 16E11: variable 'v11' is possibly undefined
// 16E2A: variable 'v20' is possibly undefined
// 16F82: variable 'v17' is possibly undefined
// 65430: using guessed type int dword_65430;
// 65434: using guessed type int dword_65434;

//----- (000000000001700C) ----------------------------------------------------
__int64 __fastcall sub_1700C(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  unsigned int v3; // edi
  unsigned __int16 v5; // dx
  unsigned int v6; // er11

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xCEu, (__int64)&unk_5CE18);
    v2 = off_60148;
  }
  v3 = 0;
  if ( a1 )
  {
    if ( (*(_BYTE *)(a1 + 120) & 2) != 0 )
    {
      if ( v2 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(v2->Dpc.DeferredContext) >= 4u )
      {
        sub_2F80C(v2->Dpc.ProcessorHistory, 0xD0u, (__int64)&unk_5CE18, *(_QWORD *)a1);
        v2 = off_60148;
      }
      if ( (unsigned int)dword_622E4 > 7 )
      {
        _InterlockedAdd((volatile signed __int32 *)P + 7, 0xFFFFFFFF);
        v2 = off_60148;
      }
      if ( v2 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x10u)
        || BYTE1(v2->Dpc.DeferredContext) < 5u )
      {
        return 0i64;
      }
      v5 = 209;
      goto LABEL_38;
    }
    if ( (unsigned int)sub_28A70() )
    {
      LOBYTE(v3) = (*(_BYTE *)(a1 + 120) & 0x10) == 16;
      qword_650C8(
        *(unsigned int *)(a1 + 124),
        *(_QWORD *)(a1 + 16),
        *(unsigned int *)(a1 + 372),
        v3,
        *(_QWORD *)(a1 + 220));
      sub_28AD8();
      v6 = dword_622E4;
      if ( (unsigned int)dword_622E4 > 2 )
      {
        _InterlockedAdd((volatile signed __int32 *)P + 2, 1u);
        v6 = dword_622E4;
      }
      if ( v6 <= 7 )
        goto LABEL_33;
    }
    else
    {
      v2 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xD2u, (__int64)&unk_5CE18);
        v2 = off_60148;
      }
      if ( (unsigned int)dword_622E4 <= 7 )
        goto LABEL_34;
    }
    _InterlockedAdd((volatile signed __int32 *)P + 7, 0xFFFFFFFF);
LABEL_33:
    v2 = off_60148;
LABEL_34:
    if ( v2 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x10u)
      || BYTE1(v2->Dpc.DeferredContext) < 5u )
    {
      return 0i64;
    }
    v5 = 211;
LABEL_38:
    sub_11008(v2->Dpc.ProcessorHistory, v5, (__int64)&unk_5CE18);
    return 0i64;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(v2->Dpc.DeferredContext) >= 2u )
  {
    sub_2F80C(v2->Dpc.ProcessorHistory, 0xCFu, (__int64)&unk_5CE18, 0i64);
  }
  return 4i64;
}
// 622E4: using guessed type int dword_622E4;
// 650C8: using guessed type __int64 (__fastcall *qword_650C8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000017238) ----------------------------------------------------
__int64 __fastcall sub_17238(__int64 a1, char a2)
{
  int v4; // ebx
  int v5; // er12
  int v6; // ebx
  const char *v7; // r9
  const char *v8; // rax
  char v10[128]; // [rsp+20h] [rbp-A8h] BYREF

  sub_40598((PFAST_MUTEX)(a1 + 152));
  v4 = *(_DWORD *)(a1 + 212);
  v5 = *(_DWORD *)(a1 + 208);
  sub_40664((PFAST_MUTEX)(a1 + 152));
  if ( v4 )
  {
    if ( a2 )
    {
      v8 = sub_4D7E8(v5);
      sub_587C8(v10, 0x80ui64, "|PENDING-AUTH:%s|", v8);
    }
    else
    {
      v6 = v4 - 1;
      if ( v6 )
      {
        if ( v6 == 1 )
          v7 = "PROTECTOR";
        else
          v7 = "UNKNOWN";
      }
      else
      {
        v7 = "CONTEXT";
      }
      sub_587C8(v10, 0x80ui64, "|PENDING-REAS:%s|", v7);
    }
    sub_4ED98(a1, v10, strlen(v10));
  }
  return 0i64;
}
// 172A9: conditional instruction was optimized away because of 'ebx.4!=0'

//----- (0000000000017354) ----------------------------------------------------
__int64 __fastcall sub_17354(__int64 a1, int a2)
{
  const char *v3; // rax
  char v5[64]; // [rsp+20h] [rbp-58h] BYREF

  v3 = sub_4DDE8(a2);
  sub_587C8(v5, 0x40ui64, "|PASSTHRU_LOCATION:%s|", v3);
  sub_4ED98(a1, v5, strlen(v5));
  return 0i64;
}

//----- (00000000000173D4) ----------------------------------------------------
__int64 __fastcall sub_173D4(__int64 a1)
{
  char v3[16]; // [rsp+20h] [rbp-28h] BYREF

  sub_587C8(v3, 0x10ui64, "|INT_LOGIC|");
  sub_4ED98(a1, v3, strlen(v3));
  return 0i64;
}

//----- (0000000000017448) ----------------------------------------------------
__int64 __fastcall sub_17448(__int64 a1, int a2)
{
  const char *v4; // rax
  char v6[64]; // [rsp+20h] [rbp-58h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xD4u, (__int64)&unk_5CE18);
  }
  v4 = sub_4D7E8(a2);
  sub_587C8(v6, 0x40ui64, "|WIFI-%s|", v4);
  sub_4ED98(a1, v6, strlen(v6));
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xD5u, (__int64)&unk_5CE18);
  }
  return 0i64;
}

//----- (0000000000017548) ----------------------------------------------------
__int64 __fastcall sub_17548(__int64 a1, __int64 a2)
{
  char v5[56]; // [rsp+20h] [rbp-48h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xD6u, (__int64)&unk_5CE18);
  }
  sub_587C8(v5, 0x32ui64, "|ADAPT-%S|", (const wchar_t *)(a2 + 160));
  sub_4ED98(a1, v5, strlen(v5));
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xD7u, (__int64)&unk_5CE18);
  }
  return 0i64;
}

//----- (0000000000017648) ----------------------------------------------------
__int64 __fastcall sub_17648(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  char v4[128]; // [rsp+30h] [rbp-98h] BYREF

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xD8u, (__int64)&unk_5CE18);
    v2 = off_60148;
  }
  if ( (*(_BYTE *)(a1 + 120) & 8) != 0 )
  {
    if ( (unsigned int)dword_622E4 > 0xB )
      *((_DWORD *)P + 11) = -(int)qword_612D8;
    sub_587C8(v4, 0x80ui64, "|PRV-END-%I64u|", 0i64);
    sub_4ED98(a1, v4, strlen(v4));
    v2 = off_60148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xAu)
    && BYTE1(v2->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v2->Dpc.ProcessorHistory, 0xD9u, (__int64)&unk_5CE18);
  }
  return 0i64;
}
// 612D8: using guessed type __int64 qword_612D8;
// 622E4: using guessed type int dword_622E4;

//----- (0000000000017784) ----------------------------------------------------
__int64 __fastcall sub_17784(__int64 a1)
{
  __int64 v2; // r9
  char v4[128]; // [rsp+40h] [rbp-98h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xDAu, (__int64)&unk_5CE18);
  }
  *(_DWORD *)(a1 + 120) |= 8u;
  v2 = *(_QWORD *)a1;
  qword_612D8 = 0i64;
  sub_587C8(v4, 0x80ui64, "|PRV-START-ID%I64u-(BASE %I64u)-%I64u|", v2, PerformanceFrequency.QuadPart, 0i64);
  sub_4ED98(a1, v4, strlen(v4));
  if ( (*(_BYTE *)(a1 + 120) & 2) != 0 )
  {
    sub_173D4(a1);
    sub_4ED98(a1, "|REASSEMBLED|", 0xDui64);
  }
  if ( (*(_BYTE *)(a1 + 120) & 1) != 0 )
    sub_4ED98(a1, "|FRAGMENT|", 0xAui64);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xDBu, (__int64)&unk_5CE18);
  }
  return 0i64;
}
// 612D8: using guessed type __int64 qword_612D8;

//----- (00000000000178F4) ----------------------------------------------------
__int64 sub_178F4()
{
  __int64 result; // rax

  result = sub_24834();
  _InterlockedExchange(&dword_6128C, 0);
  return result;
}
// 6128C: using guessed type int dword_6128C;

//----- (0000000000017918) ----------------------------------------------------
void sub_17918()
{
  PDEVICE_OBJECT v0; // rcx
  _QWORD *v1; // rax
  __int64 v2; // rdi
  int v3; // eax
  int v4; // ebx
  unsigned __int16 v5; // dx
  _QWORD *v6; // rax
  int v7; // er12
  __int64 v8; // rbx
  unsigned int v9; // er8
  unsigned int v10; // ebp
  __int64 v11; // rdi
  char *v12; // rsi
  int v13; // er9
  int v14; // eax
  void *v15; // rcx
  PDEVICE_OBJECT v16; // rcx
  int v17; // eax
  PDEVICE_OBJECT v18; // rcx
  unsigned __int16 v19; // dx
  _QWORD *v20; // rax
  __int64 v21; // [rsp+40h] [rbp-48h]
  __int64 v22; // [rsp+50h] [rbp-38h]
  KIRQL v23; // [rsp+90h] [rbp+8h] BYREF

  _InterlockedAdd64(&qword_613D0, 1ui64);
  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 8) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xDCu, (__int64)&unk_5CE18, qword_613D0);
    v0 = off_60148;
  }
  if ( ++dword_613C8 >= (unsigned int)dword_65410 )
  {
    if ( _InterlockedCompareExchange(&dword_6128C, 1, 0) )
    {
      v0 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148->Dpc.DeferredContext) & 8) == 0
        || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
      {
        goto LABEL_30;
      }
      v5 = 224;
LABEL_28:
      sub_11008(v0->Dpc.ProcessorHistory, v5, (__int64)&unk_5CE18);
      goto LABEL_29;
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 8) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xDDu, (__int64)&unk_5CE18);
    }
    v1 = sub_48CA0(_InterlockedCompareExchange64(&qword_61270, 0i64, 0i64), 4, (__int64)sub_178F4, 0i64);
    v2 = (__int64)v1;
    if ( v1 )
    {
      v3 = sub_48F24((__int64)v1, 0);
      v4 = v3;
      if ( !v3 )
        goto LABEL_29;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 8) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0xDEu, (__int64)&unk_5CE18, v3);
      }
      sub_48E4C(v2, 1);
    }
    else
    {
      v4 = 3;
    }
    if ( v4 )
    {
      _InterlockedExchange(&dword_6128C, 0);
      v0 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148->Dpc.DeferredContext) & 8) == 0
        || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_30;
      }
      v5 = 223;
      goto LABEL_28;
    }
LABEL_29:
    v0 = off_60148;
LABEL_30:
    dword_613C8 = 0;
  }
  if ( ++dword_62190 )
  {
    if ( v0 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v0->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(v0->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v0->Dpc.ProcessorHistory, 0x4Cu, (__int64)&unk_5CD88);
    }
    v6 = sub_40964((__int64)qword_62188, 4, (__int64)sub_30DA8, 0i64);
    if ( v6 )
      sub_40AF4((__int64)v6);
    v0 = off_60148;
    dword_62190 = 0;
  }
  v7 = 0;
  if ( v0 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v0->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(v0->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v0->Dpc.ProcessorHistory, 0xA7u, (__int64)&unk_5CD78);
  }
  v8 = MEMORY[0xFFFFF78000000014];
  sub_401B8(&qword_621D8, &v23);
  v9 = dword_621E0;
  v10 = 0;
  if ( dword_621E0 )
  {
    v11 = 0i64;
    do
    {
      v12 = (char *)qword_621E8;
      v13 = *(_DWORD *)((char *)qword_621E8 + v11 + 8);
      if ( v13 && (v8 - *(_QWORD *)((char *)qword_621E8 + v11)) / 0x989680ui64 >= (unsigned int)dword_65400 )
      {
        *(_DWORD *)(*(_QWORD *)((char *)qword_621E8 + v11 + 16) + 266i64) = v13;
        v14 = sub_35FD4(*(const void **)&v12[v11 + 16]);
        v15 = *(void **)&v12[v11 + 16];
        v7 = v14;
        if ( v15 )
        {
          sub_3F6F0(v15, 0x6970644Eu);
          *(_QWORD *)&v12[v11 + 16] = 0i64;
        }
        *(_DWORD *)&v12[v11 + 8] = 0;
        *(_QWORD *)&v12[v11] = v8;
        v9 = dword_621E0;
      }
      ++v10;
      v11 += 24i64;
    }
    while ( v10 < v9 );
  }
  sub_40230(&qword_621D8, v23);
  v16 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0xA8u, (__int64)&unk_5CD78, v7);
      v16 = off_60148;
    }
    if ( v16 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v16->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(v16->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v16->Dpc.ProcessorHistory, 0xBAu, (__int64)&unk_5CD78);
    }
  }
  v17 = sub_57478(qword_64DB8);
  if ( !v17 )
    goto LABEL_64;
  v18 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    goto LABEL_69;
  if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0xBBu, (__int64)&unk_5CD78, v17);
LABEL_64:
    v18 = off_60148;
  }
  if ( v18 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v18->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(v18->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v18->Dpc.ProcessorHistory, 0xBCu, (__int64)&unk_5CD78);
    v18 = off_60148;
  }
LABEL_69:
  HIDWORD(v22) = 0;
  if ( v18 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v18->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(v18->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v18->Dpc.ProcessorHistory, 0x5Eu, (__int64)&unk_5CCF8);
    v18 = off_60148;
  }
  if ( (unsigned int)++dword_622E0 > 0x3C )
  {
    if ( !qword_61280 )
    {
      if ( v18 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v18->Dpc.DeferredContext + 1, 0x18u)
        && BYTE1(v18->Dpc.DeferredContext) >= 2u )
      {
        v19 = 95;
LABEL_91:
        sub_11008(v18->Dpc.ProcessorHistory, v19, (__int64)&unk_5CCF8);
        return;
      }
      return;
    }
    LODWORD(v21) = 3;
    LODWORD(v22) = 0;
    v20 = sub_40964((__int64)qword_61280, 24, (__int64)sub_1A670, 0i64);
    if ( v20 )
    {
      *v20 = v21;
      v20[1] = 0i64;
      v20[2] = v22;
      sub_40AF4((__int64)v20);
    }
    else
    {
      v18 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_86;
      }
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x60u, (__int64)&unk_5CCF8);
    }
    v18 = off_60148;
LABEL_86:
    dword_622E0 = 0;
  }
  if ( v18 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v18->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(v18->Dpc.DeferredContext) >= 5u )
  {
    v19 = 97;
    goto LABEL_91;
  }
}
// 17E80: variable 'v21' is possibly undefined
// 61270: using guessed type __int64 qword_61270;
// 6128C: using guessed type int dword_6128C;
// 613C8: using guessed type int dword_613C8;
// 613D0: using guessed type __int64 qword_613D0;
// 62190: using guessed type int dword_62190;
// 621E0: using guessed type int dword_621E0;
// 622E0: using guessed type int dword_622E0;
// 65400: using guessed type int dword_65400;
// 65410: using guessed type int dword_65410;

//----- (0000000000017F30) ----------------------------------------------------
void __fastcall sub_17F30(__int64 *a1, _DWORD *a2, char *a3)
{
  _BYTE *v6; // r13
  _BYTE *v7; // rbx
  __int16 v8; // r9
  char v9; // dl
  __int64 v10; // rax
  unsigned __int16 v11; // r9
  int v12; // [rsp+70h] [rbp+8h] BYREF

  v12 = 0;
  *a2 = 0;
  if ( !a3 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xE1u, (__int64)&unk_5CE18);
    }
    goto LABEL_31;
  }
  v6 = (_BYTE *)a1[5];
  if ( !v6 )
  {
LABEL_30:
    *a2 = v12;
    goto LABEL_31;
  }
  v7 = a3 + 22;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x45u, (__int64)&unk_5CCA8, v6, v7);
  }
  *v7 = v6[8];
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x46u, (__int64)&unk_5CCA8);
  }
  sub_43E74((__int64)v6, a3 + 23);
  sub_43C3C((__int64)v6, a3 + 25);
  sub_43B8C(v6, a3 + 27);
  sub_43DC4((__int64)v6, a3 + 28);
  sub_43FF0((__int64)v6, a3 + 18);
  sub_43D00((__int64)v6, (_WORD *)a3 + 8);
  v8 = *(_WORD *)(a3 + 23);
  v9 = 4 * a3[27];
  *((_QWORD *)a3 + 1) = a1[1];
  v10 = *a1;
  v11 = 8 * v8;
  a3[27] = v9;
  *(_QWORD *)a3 = v10;
  *(_WORD *)(a3 + 23) = v11;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11478(off_60148->Dpc.ProcessorHistory, 227i64, (__int64)&unk_5CE18, v11);
  }
  if ( !(unsigned int)sub_49AEC(40001, a3, 0x1Du, dword_65438, &v12, 0i64) )
  {
    if ( (unsigned int)dword_622E4 > 1 )
      _InterlockedAdd((volatile signed __int32 *)P + 1, 1u);
    goto LABEL_30;
  }
  *a2 = 4;
  if ( !(unsigned int)sub_502CC(0x200A002u) )
    *a2 = 3;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xE4u, (__int64)&unk_5CE18);
  }
  if ( (unsigned int)dword_622E4 > 0xA )
    _InterlockedAdd((volatile signed __int32 *)P + 10, 1u);
LABEL_31:
  sub_40598((PFAST_MUTEX)(a1 + 19));
  *((_DWORD *)a1 + 52) = *a2;
  sub_40664((PFAST_MUTEX)(a1 + 19));
}
// 622E4: using guessed type int dword_622E4;
// 65438: using guessed type int dword_65438;

//----- (000000000001820C) ----------------------------------------------------
__int64 __fastcall sub_1820C(int a1, __int64 a2, _QWORD *a3, int a4, char a5)
{
  _DWORD *v9; // rax
  __int64 v10; // rbx
  signed __int64 v11; // rax
  bool v12; // zf
  int v13; // edi
  _DWORD *v14; // rax
  _DWORD *v15; // rax

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xE5u, (__int64)&unk_5CE18);
  }
  v9 = sub_3FA7C((__int64)qword_612A8);
  v10 = (__int64)v9;
  if ( v9 )
  {
    memset(v9, 0, 0x190ui64);
    *(_DWORD *)(v10 + 208) = 0;
    *(_DWORD *)(v10 + 212) = 0;
    sub_404B8(v10 + 152);
    *(_DWORD *)(v10 + 140) = 0;
    v11 = _InterlockedExchangeAdd64(&qword_627A8, 1ui64);
    *(_DWORD *)(v10 + 372) = a4;
    *(_QWORD *)(v10 + 16) = a2;
    *(_QWORD *)v10 = v11 + 1;
    *(_DWORD *)(v10 + 124) = a1;
    *(_QWORD *)(v10 + 8) = *a3;
    *(_QWORD *)(v10 + 144) = _InterlockedCompareExchange64(&qword_613D0, 0i64, 0i64);
    if ( a5 )
      *(_DWORD *)(v10 + 120) |= 0x10u;
    memset((void *)(v10 + 24), 0, 0x60ui64);
    v12 = byte_653E0 == 1;
    *(_QWORD *)(v10 + 132) = 0i64;
    if ( v12 && dword_65420 == 1 )
    {
      *(_DWORD *)(v10 + 120) |= 4u;
      v13 = sub_502CC(0x200A009u);
      *(_DWORD *)(v10 + 140) = v13;
      v14 = *(_DWORD **)(v10 + 132);
      if ( v14 )
        *v14 = 0;
      v15 = sub_3FC10((__int64)qword_612B0, v13 + 5);
      *(_QWORD *)(v10 + 132) = v15;
      if ( v15 )
      {
        *(_DWORD *)(v10 + 140) = v13;
        *v15 = 0;
      }
      else
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0xE6u, (__int64)&unk_5CE18);
        }
        sub_1864C(v10, 0);
        v10 = 0i64;
      }
    }
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xE7u, (__int64)&unk_5CE18);
  }
  return v10;
}
// 613D0: using guessed type __int64 qword_613D0;
// 627A8: using guessed type __int64 qword_627A8;
// 653E0: using guessed type char byte_653E0;
// 65420: using guessed type int dword_65420;

//----- (000000000001843C) ----------------------------------------------------
__int64 __fastcall sub_1843C(int a1, __int64 a2, _QWORD *a3, int a4, char a5)
{
  _DWORD *v9; // rax
  __int64 v10; // rbx
  signed __int64 v11; // rax
  bool v12; // zf
  int v13; // edx
  _DWORD *v14; // rax

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xE8u, (__int64)&unk_5CE18);
  }
  v9 = sub_3FA7C((__int64)qword_612A8);
  v10 = (__int64)v9;
  if ( v9 )
  {
    memset(v9, 0, 0x190ui64);
    *(_DWORD *)(v10 + 208) = 0;
    *(_DWORD *)(v10 + 212) = 0;
    sub_404B8(v10 + 152);
    *(_DWORD *)(v10 + 140) = 0;
    v11 = _InterlockedExchangeAdd64(&qword_627A8, 1ui64);
    *(_DWORD *)(v10 + 372) = a4;
    *(_QWORD *)(v10 + 16) = a2;
    *(_QWORD *)v10 = v11 + 1;
    *(_DWORD *)(v10 + 124) = a1;
    *(_QWORD *)(v10 + 8) = *a3;
    *(_QWORD *)(v10 + 144) = _InterlockedCompareExchange64(&qword_613D0, 0i64, 0i64);
    if ( a5 )
      *(_DWORD *)(v10 + 120) |= 0x10u;
    memset((void *)(v10 + 24), 0, 0x60ui64);
    v12 = byte_653E0 == 1;
    *(_QWORD *)(v10 + 132) = 0i64;
    if ( v12 && dword_65420 == 1 )
    {
      v13 = dword_653EC;
      *(_DWORD *)(v10 + 120) |= 4u;
      *(_DWORD *)(v10 + 140) = v13;
      v14 = sub_3FC10((__int64)qword_612B0, v13 + 5);
      *(_QWORD *)(v10 + 132) = v14;
      if ( v14 )
      {
        *v14 = 0;
      }
      else
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0xE9u, (__int64)&unk_5CE18);
        }
        sub_1864C(v10, 0);
        v10 = 0i64;
      }
    }
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xEAu, (__int64)&unk_5CE18);
  }
  return v10;
}
// 613D0: using guessed type __int64 qword_613D0;
// 627A8: using guessed type __int64 qword_627A8;
// 653E0: using guessed type char byte_653E0;
// 653EC: using guessed type int dword_653EC;
// 65420: using guessed type int dword_65420;

//----- (000000000001864C) ----------------------------------------------------
void __fastcall sub_1864C(__int64 a1, char a2)
{
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  __int64 v6; // rdx
  __int64 v7; // rdx
  PVOID v8; // rcx

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xEBu, (__int64)&unk_5CE18);
    v4 = off_60148;
  }
  if ( a1 )
  {
    if ( _bittest((const signed __int32 *)(a1 + 120), 0xAu) )
    {
      sub_20F00((_QWORD *)a1);
      v4 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x40) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        v5 = 238;
LABEL_24:
        sub_11008(v4->Dpc.ProcessorHistory, v5, (__int64)&unk_5CE18);
        return;
      }
      return;
    }
    v6 = *(_QWORD *)(a1 + 132);
    if ( v6 )
      sub_3FAE4((__int64)qword_612B0, v6);
    if ( a2 )
    {
      v7 = *(_QWORD *)(a1 + 16);
      if ( v7 )
      {
        v8 = qword_612C0;
        if ( (*(_BYTE *)(a1 + 120) & 2) == 0 )
          v8 = qword_612B8;
        sub_3FAE4((__int64)v8, v7);
      }
      sub_188D4((const signed __int32 *)a1);
    }
    sub_3FAE4((__int64)qword_612A8, a1);
    v4 = off_60148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v4->Dpc.DeferredContext) & 0x40) != 0
    && BYTE1(v4->Dpc.DeferredContext) >= 5u )
  {
    v5 = 239;
    goto LABEL_24;
  }
}

//----- (00000000000187B8) ----------------------------------------------------
__int64 __fastcall sub_187B8(signed __int32 *a1, unsigned int a2)
{
  const char *v4; // rax
  int v5; // eax
  unsigned int v6; // ebx

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->Dpc.DeferredContext) < 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    if ( a2 )
    {
      if ( a2 == 1 )
      {
        v4 = "ADAPTER_EVENT";
      }
      else if ( a2 == 2 )
      {
        v4 = "PACKET_FREE";
      }
      else
      {
        v4 = "UNKNOWN";
      }
    }
    else
    {
      v4 = "NONE";
    }
    sub_1164C(off_60148->Dpc.ProcessorHistory, 0xF0u, (__int64)&unk_5CE18, *(_QWORD *)a1, v4);
  }
  if ( a2 == 1 )
  {
    _InterlockedAdd64(&qword_61330, 1ui64);
  }
  else if ( a2 == 2 )
  {
    _InterlockedAdd64(&qword_61328, 1ui64);
  }
  if ( _bittest(a1 + 30, 0xAu) )
    v5 = sub_20A64(a1, a2);
  else
    v5 = sub_189A0((__int64)a1, a2);
  v6 = v5;
  if ( v5
    && off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->Dpc.DeferredContext) < 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0xF1u, (__int64)&unk_5CE18, v5);
  }
  return v6;
}
// 61328: using guessed type __int64 qword_61328;
// 61330: using guessed type __int64 qword_61330;

//----- (00000000000188D4) ----------------------------------------------------
__int64 __fastcall sub_188D4(const signed __int32 *a1)
{
  __int64 v1; // rbx

  if ( !_bittest(a1 + 30, 0xAu) )
  {
    v1 = _InterlockedExchange64((volatile __int64 *)(a1 + 55), 0i64);
    if ( v1 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(off_60148->Dpc.DeferredContext) < 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xF2u, (__int64)&unk_5CE18, *(_QWORD *)a1);
      }
      if ( (unsigned int)sub_28A70() )
      {
        qword_650E0(v1);
        sub_28AD8();
      }
    }
    else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
           && SBYTE4(off_60148->Dpc.DeferredContext) < 0
           && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xF3u, (__int64)&unk_5CE18, *(_QWORD *)a1);
    }
  }
  return 0i64;
}
// 650E0: using guessed type __int64 (__fastcall *qword_650E0)(_QWORD);

//----- (00000000000189A0) ----------------------------------------------------
__int64 __fastcall sub_189A0(__int64 a1, int a2)
{
  unsigned int v2; // esi
  int v5; // ebp
  const char *v6; // rax
  __int64 v7; // r10

  v2 = 0;
  if ( a1 )
  {
    sub_40598((PFAST_MUTEX)(a1 + 152));
    v5 = *(_DWORD *)(a1 + 208);
    sub_40664((PFAST_MUTEX)(a1 + 152));
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->Dpc.DeferredContext) < 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
    {
      v6 = sub_4D7E8(v5);
      sub_1164C(*(_QWORD *)(v7 + 216), 0xF5u, (__int64)&unk_5CE18, *(_QWORD *)a1, v6);
    }
    if ( (unsigned __int16)v5 != 2 && (unsigned __int16)v5 != 4 )
    {
      if ( _InterlockedCompareExchange((volatile signed __int32 *)(a1 + 216), 1, 0) )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_1D3B0(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0xF7u, (__int64)&unk_5CE18, a1, *(_QWORD *)a1);
        }
      }
      else
      {
        v2 = sub_1700C(a1);
        if ( v2
          && off_60148 != (PDEVICE_OBJECT)&off_60148
          && SBYTE4(off_60148->Dpc.DeferredContext) < 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
        {
          sub_11148(off_60148->Dpc.ProcessorHistory, 0xF6u, (__int64)&unk_5CE18, v2);
        }
      }
    }
    if ( (*(_BYTE *)(a1 + 120) & 2) != 0 )
      sub_15050((__int64 *)a1, a2);
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->Dpc.DeferredContext) < 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xF4u, (__int64)&unk_5CE18, 0i64);
    }
    v2 = 4;
  }
  return v2;
}
// 18A68: variable 'v7' is possibly undefined

//----- (0000000000018B70) ----------------------------------------------------
void __fastcall sub_18B70(const void *a1, unsigned int a2, void *a3, int a4, int a5, int a6, int a7, PLARGE_INTEGER a8, char a9)
{
  PDEVICE_OBJECT v13; // rcx
  int v14; // eax
  unsigned __int16 v15; // dx
  char v16; // di
  __int64 *v17; // rcx
  __int64 *v18; // r10
  unsigned __int16 v19; // dx

  v13 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 8u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xF8u, (__int64)&unk_5CE18);
    v13 = off_60148;
  }
  if ( (a5 & 2) != 0 )
    goto LABEL_9;
  if ( dword_65424 == 3 )
  {
    if ( (a5 & 0x10) != 0 )
    {
      v14 = a6;
      if ( a6 == 2 )
        goto LABEL_9;
      goto LABEL_19;
    }
    if ( a7 && ((unsigned __int16)a7 == 4 || (unsigned __int16)a7 == 2) )
    {
LABEL_9:
      if ( v13 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 8u)
        && BYTE1(v13->Dpc.DeferredContext) >= 4u )
      {
        v15 = 249;
LABEL_13:
        sub_11008(v13->Dpc.ProcessorHistory, v15, (__int64)&unk_5CE18);
        return;
      }
      return;
    }
  }
  v14 = a6;
  if ( a6 == 2 )
  {
LABEL_20:
    v16 = 1;
    goto LABEL_21;
  }
LABEL_19:
  v16 = 0;
  if ( a9 )
    goto LABEL_20;
LABEL_21:
  if ( dword_6126C || byte_653E0 != 1 )
    goto LABEL_49;
  if ( dword_65424 != 2 )
  {
    if ( qword_61290 )
    {
      v17 = &qword_61290;
LABEL_30:
      sub_4EBEC((PVOID *)v17, a1, a2, a3, a4, a8, v16);
      goto LABEL_48;
    }
    if ( v13 == (PDEVICE_OBJECT)&off_60148 )
      return;
    if ( !_bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 8u) || BYTE1(v13->Dpc.DeferredContext) < 2u )
      goto LABEL_49;
    v19 = 251;
    goto LABEL_47;
  }
  if ( !qword_612A0 || !*(_QWORD *)&qword_61298 )
  {
    if ( v13 == (PDEVICE_OBJECT)&off_60148 )
      return;
    if ( !_bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 8u) || BYTE1(v13->Dpc.DeferredContext) < 2u )
      goto LABEL_49;
    v19 = 250;
LABEL_47:
    sub_11008(v13->Dpc.ProcessorHistory, v19, (__int64)&unk_5CE18);
    goto LABEL_48;
  }
  if ( (a5 & 0x40) == 0 )
  {
    sub_4EBEC((PVOID *)&qword_61298, a1, a2, a3, a4, a8, v16);
    sub_4EBEC((PVOID *)&qword_612A0, a1, a2, a3, a4, a8, v16);
LABEL_48:
    v13 = off_60148;
    goto LABEL_49;
  }
  if ( v14 == 1 )
  {
    v17 = &qword_612A0;
    if ( (a5 & 0x10) == 16 )
      v17 = (__int64 *)&qword_61298;
    goto LABEL_30;
  }
  if ( v14 == 2 )
  {
    v18 = (__int64 *)&qword_61298;
    if ( (a5 & 0x10) == 16 )
      v18 = &qword_612A0;
    v17 = v18;
    goto LABEL_30;
  }
LABEL_49:
  if ( v13 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 8u)
    && BYTE1(v13->Dpc.DeferredContext) >= 5u )
  {
    v15 = 252;
    goto LABEL_13;
  }
}
// 6126C: using guessed type int dword_6126C;
// 61290: using guessed type __int64 qword_61290;
// 612A0: using guessed type __int64 qword_612A0;
// 653E0: using guessed type char byte_653E0;
// 65424: using guessed type int dword_65424;

//----- (0000000000018E4C) ----------------------------------------------------
void __fastcall sub_18E4C(__int64 a1)
{
  int *v2; // r11
  int v3; // er9
  void *v4; // r8

  if ( !_bittest((const signed __int32 *)(a1 + 120), 0xAu)
    || !_InterlockedCompareExchange((volatile signed __int32 *)(a1 + 216), 0, 0) )
  {
    sub_17648(a1);
    v2 = *(int **)(a1 + 132);
    if ( v2 )
      v3 = *v2;
    else
      v3 = 0;
    v4 = v2 + 1;
    if ( !v2 )
      v4 = 0i64;
    sub_18B70(
      *(const void **)(a1 + 16),
      *(_DWORD *)(a1 + 124),
      v4,
      v3,
      *(_DWORD *)(a1 + 120),
      *(_DWORD *)(a1 + 128),
      *(_DWORD *)(a1 + 208),
      (PLARGE_INTEGER)(a1 + 8),
      0);
  }
}

//----- (0000000000018EDC) ----------------------------------------------------
__int64 __fastcall sub_18EDC(_BYTE *a1)
{
  PDEVICE_OBJECT v1; // rcx

  *a1 = 0;
  v1 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x101u, (__int64)&unk_5CE18);
      v1 = off_60148;
    }
    if ( v1 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v1->Dpc.DeferredContext) & 1) != 0
      && BYTE1(v1->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v1->Dpc.ProcessorHistory, 0x102u, (__int64)&unk_5CE18);
    }
  }
  return 0i64;
}

//----- (0000000000018F68) ----------------------------------------------------
__int64 __fastcall sub_18F68(__int64 a1, _DWORD *a2)
{
  unsigned __int8 v3; // di
  int v4; // er12
  unsigned __int16 v6; // dx
  PDEVICE_OBJECT v7; // rcx
  _WORD *v8; // rbp

  v3 = 0;
  v4 = 0;
  if ( (*(_BYTE *)(a1 + 32) & 0x10) != 0 && (*(_BYTE *)(a1 + 32) & 0x20) != 0 )
  {
    if ( !_InterlockedCompareExchange(&dword_61430, 1, 1) )
    {
      v6 = word_6142C;
      if ( word_6142C )
      {
        v7 = off_60148;
        v8 = &unk_613F0;
        do
        {
          if ( v3 )
            break;
          if ( *(_WORD *)(a1 + 76) == *v8 || *(_WORD *)(a1 + 78) == *v8 )
          {
            if ( v7 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u)
              && BYTE1(v7->Dpc.DeferredContext) >= 5u )
            {
              sub_11430(v7->Dpc.ProcessorHistory, 0x104u, (__int64)&unk_5CE18, *(unsigned __int16 *)(a1 + 76));
              v7 = off_60148;
              v6 = word_6142C;
            }
            v3 = 1;
          }
          ++v4;
          ++v8;
        }
        while ( v4 < v6 );
      }
    }
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
         && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x103u, (__int64)&unk_5CE18);
  }
  *a2 = v3;
  return 0i64;
}
// 6142C: using guessed type __int16 word_6142C;
// 61430: using guessed type int dword_61430;

//----- (00000000000190CC) ----------------------------------------------------
__int64 sub_190CC()
{
  unsigned int v0; // ebx
  PDEVICE_OBJECT v1; // rcx
  __int16 *v3; // [rsp+20h] [rbp-28h] BYREF
  __int64 v4; // [rsp+28h] [rbp-20h]
  __int16 v5; // [rsp+30h] [rbp-18h] BYREF
  PVOID P; // [rsp+38h] [rbp-10h]

  v0 = 0;
  v3 = 0i64;
  v4 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x105u, (__int64)&unk_5CE18);
  }
  LODWORD(v4) = 16;
  v3 = &v5;
  P = sub_2AF40(&v5);
  if ( (unsigned int)sub_28A70() )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x106u, (__int64)&unk_5CE18);
    }
    qword_650D0(3i64, &v3);
    sub_28AD8();
    v1 = off_60148;
  }
  else
  {
    v1 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x107u, (__int64)&unk_5CE18);
      v1 = off_60148;
    }
    v0 = 1;
  }
  if ( P )
  {
    ExFreePoolWithTag(P, 0x7845734Eu);
    v1 = off_60148;
  }
  if ( v1 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v1->Dpc.DeferredContext + 1, 9u)
    && BYTE1(v1->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v1->Dpc.ProcessorHistory, 0x108u, (__int64)&unk_5CE18);
  }
  return v0;
}
// 650D0: using guessed type __int64 (__fastcall *qword_650D0)(_QWORD, _QWORD);

//----- (0000000000019248) ----------------------------------------------------
__int64 __fastcall sub_19248(__int64 a1, _BYTE *a2)
{
  PDEVICE_OBJECT v5; // rbx
  unsigned __int8 v6; // [rsp+50h] [rbp-18h] BYREF
  int v7; // [rsp+51h] [rbp-17h]
  unsigned __int8 v8; // [rsp+55h] [rbp-13h]

  v7 = 0;
  v8 = 0;
  v6 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xDu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x109u, (__int64)&unk_5CE18);
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*(_BYTE *)(a1 + 120) & 0x10) == 0 )
    {
      sub_438AC(*(_QWORD *)(a1 + 24), (__int64)&v6);
      if ( sub_47C5C(&v6, a1 + 384) )
      {
        *a2 = 1;
        v5 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
          return 0i64;
        if ( !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xDu)
          || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
        {
LABEL_18:
          if ( v5 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0xDu)
            && BYTE1(v5->Dpc.DeferredContext) >= 5u )
          {
            sub_11008(v5->Dpc.ProcessorHistory, 0x10Cu, (__int64)&unk_5CE18);
          }
          return 0i64;
        }
        sub_11194(
          off_60148->Dpc.ProcessorHistory,
          267i64,
          (__int64)&unk_5CE18,
          *(_QWORD *)a1,
          v6,
          (unsigned __int8)v7,
          BYTE1(v7),
          BYTE2(v7),
          HIBYTE(v7),
          v8);
      }
    }
    v5 = off_60148;
    goto LABEL_18;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xDu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x10Au, (__int64)&unk_5CE18, 0i64);
  }
  return 4i64;
}

//----- (0000000000019410) ----------------------------------------------------
__int64 __fastcall sub_19410(__int64 a1, _DWORD *a2)
{
  unsigned int v2; // ebx
  __int16 v5; // ax
  int v6; // er9
  PDEVICE_OBJECT v7; // rcx
  int *v9; // [rsp+20h] [rbp-48h] BYREF
  __int64 v10; // [rsp+28h] [rbp-40h]
  int v11; // [rsp+30h] [rbp-38h] BYREF
  int v12; // [rsp+34h] [rbp-34h]
  int v13; // [rsp+38h] [rbp-30h]

  v2 = 0;
  v10 = 0i64;
  v12 = 0;
  v13 = 0;
  v9 = 0i64;
  v11 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x10Du, (__int64)&unk_5CE18);
  }
  *a2 = 0;
  v12 = *(_DWORD *)a1;
  v5 = *(_WORD *)(a1 + 4);
  LODWORD(v10) = 12;
  LOWORD(v13) = v5;
  v9 = &v11;
  if ( (unsigned int)sub_28A70() )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x10Eu, (__int64)&unk_5CE18);
    }
    qword_650D0(4i64, &v9);
    v6 = v11;
    *a2 = v11;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x10Fu, (__int64)&unk_5CE18, v6);
    }
    sub_28AD8();
    v7 = off_60148;
  }
  else
  {
    v7 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x110u, (__int64)&unk_5CE18);
      v7 = off_60148;
    }
    v2 = 1;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v7->Dpc.DeferredContext) & 0x10) != 0
    && BYTE1(v7->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v7->Dpc.ProcessorHistory, 0x111u, (__int64)&unk_5CE18);
  }
  return v2;
}
// 650D0: using guessed type __int64 (__fastcall *qword_650D0)(_QWORD, _QWORD);

//----- (00000000000195E4) ----------------------------------------------------
__int64 __fastcall sub_195E4(__int64 a1, _DWORD *a2)
{
  unsigned int v2; // ebx
  __int16 v5; // ax
  int v6; // er9
  PDEVICE_OBJECT v7; // rcx
  int *v9; // [rsp+20h] [rbp-48h] BYREF
  __int64 v10; // [rsp+28h] [rbp-40h]
  int v11; // [rsp+30h] [rbp-38h] BYREF
  int v12; // [rsp+34h] [rbp-34h]
  int v13; // [rsp+38h] [rbp-30h]

  v2 = 0;
  v10 = 0i64;
  v12 = 0;
  v13 = 0;
  v9 = 0i64;
  v11 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x112u, (__int64)&unk_5CE18);
  }
  *a2 = 0;
  v12 = *(_DWORD *)a1;
  v5 = *(_WORD *)(a1 + 4);
  LODWORD(v10) = 12;
  LOWORD(v13) = v5;
  v9 = &v11;
  if ( (unsigned int)sub_28A70() )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x113u, (__int64)&unk_5CE18);
    }
    qword_650D0(5i64, &v9);
    v6 = v11;
    *a2 = v11;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x114u, (__int64)&unk_5CE18, v6);
    }
    sub_28AD8();
    v7 = off_60148;
  }
  else
  {
    v7 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x115u, (__int64)&unk_5CE18);
      v7 = off_60148;
    }
    v2 = 1;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v7->Dpc.DeferredContext) & 0x10) != 0
    && BYTE1(v7->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v7->Dpc.ProcessorHistory, 0x116u, (__int64)&unk_5CE18);
  }
  return v2;
}
// 650D0: using guessed type __int64 (__fastcall *qword_650D0)(_QWORD, _QWORD);

//----- (00000000000197B8) ----------------------------------------------------
__int64 __fastcall sub_197B8(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx
  char v8; // [rsp+40h] [rbp+18h] BYREF
  int v9; // [rsp+48h] [rbp+20h] BYREF
  __int16 v10; // [rsp+4Ch] [rbp+24h]

  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xFu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x117u, (__int64)&unk_5CE18);
    v5 = off_60148;
  }
  if ( *(_DWORD *)(a3 + 136) == 6 )
  {
    v8 = 0;
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0xFu)
      && BYTE1(v5->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(v5->Dpc.ProcessorHistory, 0x118u, (__int64)&unk_5CE18);
    }
    *(_QWORD *)a2 = 0i64;
    *(_DWORD *)(a2 + 8) = 0;
    *(_WORD *)(a2 + 12) = 0;
    sub_43ADC((_BYTE *)(a2 + 14), &v8);
    if ( v8 == 4 )
    {
      v6 = 2048;
    }
    else
    {
      if ( v8 != 6 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xFu)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x119u, (__int64)&unk_5CE18);
        }
        goto LABEL_19;
      }
      v6 = -31011;
    }
    sub_45760(a2, v6);
LABEL_19:
    v9 = *(_DWORD *)(a3 + 140);
    v10 = *(_WORD *)(a3 + 144);
    sub_45670(a2, (unsigned __int8 *)&v9);
    v5 = off_60148;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0xFu)
    && BYTE1(v5->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v5->Dpc.ProcessorHistory, 0x11Au, (__int64)&unk_5CE18);
  }
  return 0i64;
}

//----- (0000000000019940) ----------------------------------------------------
__int64 __fastcall sub_19940(__int64 a1, __int64 a2, unsigned int a3)
{
  unsigned __int64 v3; // rsi
  unsigned int v5; // ebp
  PDEVICE_OBJECT v6; // rbx
  unsigned __int64 i; // rsi
  __int64 v9; // rdi
  int v10; // eax

  v3 = a3;
  v5 = 0;
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x11Bu, (__int64)&unk_5CE18);
    v6 = off_60148;
  }
  if ( !a2 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(v6->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(v6->Dpc.ProcessorHistory, 0x11Cu, (__int64)&unk_5CE18);
    }
    return 4i64;
  }
  if ( dword_6126C )
    return 0i64;
  i = v3 / 0xA;
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(v6->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(v6->Dpc.ProcessorHistory, 0x11Du, (__int64)&unk_5CE18, (unsigned __int16)i);
    v6 = off_60148;
  }
  if ( (_WORD)i )
  {
    v9 = a2 + 4;
    for ( i = (unsigned __int16)i; i; --i )
    {
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(v6->Dpc.DeferredContext) >= 5u )
      {
        sub_11338(v6->Dpc.ProcessorHistory, 286i64, (__int64)&unk_5CE18, *(_DWORD *)(v9 + 2));
      }
      v10 = sub_318C8((unsigned __int8 *)(v9 - 4), (int *)(v9 + 2), 0);
      v5 = v10;
      if ( v10 )
      {
        v6 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148
          || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
          || BYTE1(off_60148->Dpc.DeferredContext) < 3u )
        {
          goto LABEL_29;
        }
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x11Fu, (__int64)&unk_5CE18, v10);
      }
      v6 = off_60148;
LABEL_29:
      v9 += 10i64;
    }
  }
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(v6->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v6->Dpc.ProcessorHistory, 0x120u, (__int64)&unk_5CE18);
  }
  return v5;
}
// 6126C: using guessed type int dword_6126C;

//----- (0000000000019B74) ----------------------------------------------------
__int64 __fastcall sub_19B74(__int64 a1, __int64 a2)
{
  PDEVICE_OBJECT v3; // rcx
  __int64 result; // rax

  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x121u, (__int64)&unk_5CE18);
    v3 = off_60148;
  }
  if ( a2 )
  {
    if ( !dword_6126C )
    {
      sub_3D170(a2);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x123u, (__int64)&unk_5CE18);
      }
    }
    result = 0i64;
  }
  else
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(v3->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(v3->Dpc.ProcessorHistory, 0x122u, (__int64)&unk_5CE18);
    }
    result = 4i64;
  }
  return result;
}
// 6126C: using guessed type int dword_6126C;

//----- (0000000000019C6C) ----------------------------------------------------
__int64 __fastcall sub_19C6C(__int64 a1, __int64 a2, __int64 a3, _DWORD *a4, _QWORD *a5, _DWORD *a6)
{
  PDEVICE_OBJECT v8; // rcx
  __int64 result; // rax
  __int64 v10[3]; // [rsp+20h] [rbp-18h] BYREF
  int v11; // [rsp+48h] [rbp+10h] BYREF

  v10[0] = 0i64;
  v11 = 0;
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x124u, (__int64)&unk_5CE18);
    v8 = off_60148;
  }
  if ( a2 )
  {
    if ( !dword_6126C )
    {
      sub_3EFD8(v10, &v11);
      *a5 = v10[0];
      *a4 = v11;
      *a6 = 1196257857;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x126u, (__int64)&unk_5CE18);
      }
    }
    result = 0i64;
  }
  else
  {
    if ( v8 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v8->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(v8->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(v8->Dpc.ProcessorHistory, 0x125u, (__int64)&unk_5CE18);
    }
    result = 4i64;
  }
  return result;
}
// 6126C: using guessed type int dword_6126C;

//----- (0000000000019D94) ----------------------------------------------------
char __fastcall sub_19D94(__int64 a1, __int64 a2)
{
  __int64 v4; // rcx
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx
  __int64 v7; // rcx
  __int64 v8; // rcx

  if ( !a1 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 8) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x127u, (__int64)&unk_5CE18, 0i64);
    }
    return 1;
  }
  v4 = *(_QWORD *)(a1 + 24);
  if ( !v4 )
  {
    v5 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
      return 1;
    if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x9Au, (__int64)&unk_5CE18);
      v5 = off_60148;
    }
    if ( v5 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 8) == 0
      || BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      return 1;
    }
    v6 = 296;
    goto LABEL_16;
  }
  LOBYTE(a2) = (*(_BYTE *)(a1 + 120) & 0x10) != 16;
  if ( !sub_45824(v4, a2, *(_DWORD *)(a1 + 124)) )
  {
    v5 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 8) == 0
      || BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      return 1;
    }
    v6 = 297;
LABEL_16:
    sub_2F80C(*(_QWORD *)&v5->DeviceLock.Header.Lock, v6, (__int64)&unk_5CE18, *(_QWORD *)a1);
    return 1;
  }
  v7 = *(_QWORD *)(a1 + 40);
  if ( v7 )
  {
    if ( !sub_476DC(v7, *(_DWORD *)(a1 + 124)) )
    {
      v5 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 8) == 0
        || BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) < 3u )
      {
        return 1;
      }
      v6 = 298;
      goto LABEL_16;
    }
  }
  else
  {
    v8 = *(_QWORD *)(a1 + 48);
    if ( v8 && !sub_478B8(v8, *(_DWORD *)(a1 + 124)) )
    {
      v5 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 8) == 0
        || BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) < 3u )
      {
        return 1;
      }
      v6 = 299;
      goto LABEL_16;
    }
  }
  return 0;
}

//----- (0000000000019F78) ----------------------------------------------------
__int64 __fastcall sub_19F78(int a1, __int64 a2, int a3)
{
  unsigned int v6; // ebx

  if ( a2 && a3 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x13u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_115F4(off_60148->Dpc.ProcessorHistory, 0x12Du, (__int64)&unk_5CE18, a1);
    }
    if ( !a1 )
      return (unsigned int)sub_1DC34(0, a2, a3);
    if ( a1 != 1 )
      return 2;
    return (unsigned int)sub_1A078(1, a2, a3);
  }
  v6 = 2;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x13u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_11230(off_60148->Dpc.ProcessorHistory, 0x12Cu, (__int64)&unk_5CE18, a2, a3);
  }
  return v6;
}

//----- (000000000001A078) ----------------------------------------------------
__int64 __fastcall sub_1A078(int a1, __int64 a2, int a3)
{
  unsigned int v3; // ebx
  PDEVICE_OBJECT v7; // rcx
  int v8; // eax

  v3 = 0;
  if ( !a2 || !a3 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x13u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11230(off_60148->Dpc.ProcessorHistory, 0x12Eu, (__int64)&unk_5CE18, a2, a3);
    }
    return 2;
  }
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x13u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_115F4(off_60148->Dpc.ProcessorHistory, 0x12Fu, (__int64)&unk_5CE18, a1);
    v7 = off_60148;
  }
  if ( a1 != 1 )
    return 2;
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0x13u)
    && BYTE1(v7->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(v7->Dpc.ProcessorHistory, 0x130u, (__int64)&unk_5CE18);
    v7 = off_60148;
  }
  if ( a3 == 40 )
  {
    v8 = sub_1A32C(a2);
    if ( v8 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x131u, (__int64)&unk_5CE18, v8);
      }
      v3 = 1;
    }
  }
  else if ( v7 != (PDEVICE_OBJECT)&off_60148
         && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0x13u)
         && BYTE1(v7->Dpc.DeferredContext) >= 3u )
  {
    sub_11430(v7->Dpc.ProcessorHistory, 0x132u, (__int64)&unk_5CE18, a3);
  }
  return v3;
}

//----- (000000000001A248) ----------------------------------------------------
__int64 __fastcall sub_1A248(__int64 a1, __int64 a2)
{
  unsigned int v2; // ebx

  v2 = 0;
  if ( a2 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x13u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_115F4(off_60148->Dpc.ProcessorHistory, 0x134u, (__int64)&unk_5CE18, 2);
    }
    if ( qword_650E8 )
      v2 = qword_650E8(2i64, a2);
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x13u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11230(off_60148->Dpc.ProcessorHistory, 0x133u, (__int64)&unk_5CE18, 0i64, 32);
    }
    v2 = 2;
  }
  return v2;
}
// 650E8: using guessed type __int64 (__fastcall *qword_650E8)(_QWORD, _QWORD);

//----- (000000000001A32C) ----------------------------------------------------
__int64 __fastcall sub_1A32C(__int64 a1)
{
  unsigned int v1; // ebx
  const char *v3; // rax
  __int64 v4; // r10
  const char *v5; // r9
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  char v9[16]; // [rsp+30h] [rbp-F8h] BYREF
  __int64 v10; // [rsp+40h] [rbp-E8h] BYREF
  __int64 Dst[11]; // [rsp+48h] [rbp-E0h] BYREF
  int v12; // [rsp+A0h] [rbp-88h] BYREF
  char v13[100]; // [rsp+A4h] [rbp-84h] BYREF

  v1 = 0;
  v10 = 0i64;
  memset(Dst, 0, sizeof(Dst));
  v9[0] = 0;
  v12 = 0;
  memset(v13, 0, sizeof(v13));
  if ( !a1 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x135u, (__int64)&unk_5CE18, 0i64);
    }
    return 4;
  }
  *(_DWORD *)(a1 + 28) = 0;
  *(_DWORD *)(a1 + 32) = 0;
  sub_197B8(*(unsigned int *)(a1 + 8), *(_QWORD *)a1, *(_QWORD *)(a1 + 16));
  sub_431D0(*(_QWORD *)a1, *(_DWORD *)(a1 + 8), &v10);
  if ( (Dst[10] & 1) != 0 )
  {
    if ( dword_653F8 == 3 || !sub_1CF58((__int64)&v10) )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x137u, (__int64)&unk_5CE18);
      }
    }
    else
    {
      _InterlockedAdd64(&qword_613A8, 1ui64);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        v3 = sub_4DA64(dword_653F8);
        v5 = "IPv6";
        if ( Dst[1] )
          v5 = "IPv4";
        sub_11908(*(_QWORD *)(v4 + 216), 0x136u, (__int64)&unk_5CE18, v5, v3);
      }
      *(_DWORD *)(a1 + 32) = 1;
    }
    return v1;
  }
  sub_1A840((__int64)&v10, *(_DWORD *)(a1 + 24), (__int64)&v12);
  if ( dword_653FC )
  {
    if ( dword_65414 )
    {
      sub_3246C((__int64)&v12, (__int64)&v10, v9);
      if ( v9[0] )
      {
        v6 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148
          || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
          || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
        {
          goto LABEL_29;
        }
        v7 = 312;
LABEL_28:
        sub_11008(v6->Dpc.ProcessorHistory, v7, (__int64)&unk_5CE18);
LABEL_29:
        *(_DWORD *)(a1 + 28) = 1;
        return v1;
      }
    }
  }
  if ( dword_65440 == 1 )
  {
    sub_3E3D4((__int64)&v12, (__int64)&v10, v9);
    if ( v9[0] )
    {
      v6 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
      {
        goto LABEL_29;
      }
      v7 = 313;
      goto LABEL_28;
    }
  }
  if ( dword_653E8 )
  {
    sub_18F68((__int64)&v12, (_DWORD *)(a1 + 32));
    if ( dword_653E8 == 2 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x13Au, (__int64)&unk_5CE18);
      }
      *(_DWORD *)(a1 + 32) = *(_DWORD *)(a1 + 32) == 0;
    }
    if ( *(_DWORD *)(a1 + 32) )
      _InterlockedAdd64(&qword_61398, 1ui64);
  }
  return v1;
}
// 1A482: variable 'v4' is possibly undefined
// 61398: using guessed type __int64 qword_61398;
// 613A8: using guessed type __int64 qword_613A8;
// 653E8: using guessed type int dword_653E8;
// 653F8: using guessed type int dword_653F8;
// 653FC: using guessed type int dword_653FC;
// 65414: using guessed type int dword_65414;
// 65440: using guessed type int dword_65440;

//----- (000000000001A670) ----------------------------------------------------
__int64 __fastcall sub_1A670(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 result; // rax
  unsigned __int16 v4; // dx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    result = sub_11008(off_60148->Dpc.ProcessorHistory, 0x13Bu, (__int64)&unk_5CE18);
    v2 = off_60148;
  }
  if ( !a1 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(v2->Dpc.DeferredContext) >= 2u )
    {
      v4 = 316;
      return sub_11008(v2->Dpc.ProcessorHistory, v4, (__int64)&unk_5CE18);
    }
    return result;
  }
  switch ( *(_DWORD *)a1 )
  {
    case 0:
      if ( v2 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(v2->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v2->Dpc.ProcessorHistory, 0x13Eu, (__int64)&unk_5CE18);
      }
      result = sub_36204(*(PVOID *)(a1 + 8), *(_DWORD *)(a1 + 16));
      goto LABEL_33;
    case 1:
      if ( v2 == (PDEVICE_OBJECT)&off_60148 )
        return result;
      if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x10u) && BYTE1(v2->Dpc.DeferredContext) >= 5u )
      {
        result = sub_11008(v2->Dpc.ProcessorHistory, 0x13Fu, (__int64)&unk_5CE18);
LABEL_33:
        v2 = off_60148;
        break;
      }
      break;
    case 2:
      if ( v2 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(v2->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v2->Dpc.ProcessorHistory, 0x140u, (__int64)&unk_5CE18);
      }
      result = sub_3F498(*(PVOID *)(a1 + 8), *(_DWORD *)(a1 + 16));
      goto LABEL_33;
    case 3:
      if ( v2 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(v2->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v2->Dpc.ProcessorHistory, 0x13Du, (__int64)&unk_5CE18);
      }
      result = sub_3ECD8();
      goto LABEL_33;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(v2->Dpc.DeferredContext) >= 5u )
  {
    v4 = 321;
    return sub_11008(v2->Dpc.ProcessorHistory, v4, (__int64)&unk_5CE18);
  }
  return result;
}

//----- (000000000001A840) ----------------------------------------------------
__int64 __fastcall sub_1A840(__int64 a1, int a2, __int64 a3)
{
  int v6; // ecx
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x147u, (__int64)&unk_5CE18);
  }
  *(_QWORD *)a3 = MEMORY[0xFFFFF78000000014];
  if ( *(_QWORD *)a1 )
  {
    sub_438AC(*(_QWORD *)a1, a3 + 20);
    sub_43964(*(_QWORD *)a1, a3 + 26);
  }
  if ( *(_QWORD *)(a1 + 16) )
  {
    *(_DWORD *)(a3 + 32) |= 7u;
    *(_DWORD *)(a3 + 36) = 2048;
    sub_43FF0(*(_QWORD *)(a1 + 16), (_DWORD *)(a3 + 40));
    sub_440A0(*(_QWORD *)(a1 + 16), (_DWORD *)(a3 + 56));
  }
  else if ( *(_QWORD *)(a1 + 24) )
  {
    *(_DWORD *)(a3 + 32) |= 7u;
    *(_DWORD *)(a3 + 36) = 34525;
    sub_4484C(*(_QWORD *)(a1 + 24), (__m128i *)(a3 + 40));
    sub_44900(*(_QWORD *)(a1 + 24), (__m128i *)(a3 + 56));
  }
  else if ( *(_QWORD *)(a1 + 8) )
  {
    *(_DWORD *)(a3 + 32) |= 1u;
    *(_DWORD *)(a3 + 36) = 2054;
  }
  v6 = *(_DWORD *)(a3 + 32);
  if ( (v6 & 1) == 0 )
  {
    v7 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
    {
      v8 = 328;
LABEL_18:
      sub_11008(v7->Dpc.ProcessorHistory, v8, (__int64)&unk_5CE18);
      goto LABEL_43;
    }
    goto LABEL_43;
  }
  *(_DWORD *)(a3 + 16) = (a2 != 0) + 1;
  if ( *(_QWORD *)(a1 + 32) || *(_QWORD *)(a1 + 40) )
  {
LABEL_26:
    *(_DWORD *)(a3 + 32) |= 8u;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x14Au, (__int64)&unk_5CE18);
    }
    if ( *(_QWORD *)(a1 + 32) )
    {
      *(_DWORD *)(a3 + 72) = 6;
      sub_44EC8(*(_WORD **)(a1 + 32), (_WORD *)(a3 + 76));
      sub_44F8C(*(_QWORD *)(a1 + 32), (_WORD *)(a3 + 78));
    }
    else
    {
      if ( !*(_QWORD *)(a1 + 40) )
        goto LABEL_39;
      *(_DWORD *)(a3 + 72) = 17;
      sub_451B0(*(_WORD **)(a1 + 40), (_WORD *)(a3 + 76));
      sub_45274(*(_QWORD *)(a1 + 40), (_WORD *)(a3 + 78));
    }
    *(_DWORD *)(a3 + 32) |= 0x30u;
LABEL_39:
    if ( (*(_BYTE *)(a3 + 32) & 0x10) != 0 && (*(_BYTE *)(a3 + 32) & 0x20) != 0 )
    {
      sub_3C08C(*(_WORD *)(a3 + 76), *(_WORD *)(a3 + 78), (int *)(a3 + 80));
      *(_DWORD *)(a3 + 32) |= 0x40u;
    }
    *(_QWORD *)(a3 + 88) = *(_QWORD *)(a1 + 48);
    *(_DWORD *)(a3 + 96) = *(_DWORD *)(a1 + 84);
    goto LABEL_43;
  }
  if ( *(_QWORD *)(a1 + 56) )
  {
    *(_DWORD *)(a3 + 72) = 1;
LABEL_25:
    *(_DWORD *)(a3 + 32) = v6 | 8;
    goto LABEL_26;
  }
  if ( *(_QWORD *)(a1 + 64) )
  {
    *(_DWORD *)(a3 + 72) = 58;
    goto LABEL_25;
  }
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    v8 = 329;
    goto LABEL_18;
  }
LABEL_43:
  sub_1AB08(a3);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x14Bu, (__int64)&unk_5CE18);
  }
  return 0i64;
}

//----- (000000000001AB08) ----------------------------------------------------
void __fastcall sub_1AB08(__int64 a1)
{
  PDEVICE_OBJECT v2; // r14
  const char *v3; // r9
  const char *v4; // rax
  const char *v5; // rax
  const char *v6; // rbx
  const char *v7; // rax

  if ( !a1 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x14Cu, (__int64)&unk_5CE18);
    }
    return;
  }
  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x14Du, (__int64)&unk_5CE18);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x15u) && BYTE1(v2->Dpc.DeferredContext) >= 5u )
      {
        sub_112FC(v2->Dpc.ProcessorHistory, 0x14Eu, (__int64)&unk_5CE18, *(_DWORD *)(a1 + 96));
        v2 = off_60148;
      }
      if ( v2 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x15u)
          && BYTE1(v2->Dpc.DeferredContext) >= 5u )
        {
          if ( *(_DWORD *)(a1 + 16) == 1 )
          {
            v3 = "INCOMING";
          }
          else if ( *(_DWORD *)(a1 + 16) == 2 )
          {
            v3 = "OUTGOING";
          }
          else
          {
            v3 = "UNKNOWN";
          }
          sub_1182C(v2->Dpc.ProcessorHistory, 0x14Fu, (__int64)&unk_5CE18, v3);
          v2 = off_60148;
        }
        if ( v2 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x15u)
            && BYTE1(v2->Dpc.DeferredContext) >= 5u )
          {
            sub_1102C(v2->Dpc.ProcessorHistory, 0x150u, (__int64)&unk_5CE18, *(unsigned __int8 *)(a1 + 26));
            v2 = off_60148;
          }
          if ( v2 != (PDEVICE_OBJECT)&off_60148 )
          {
            if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x15u)
              && BYTE1(v2->Dpc.DeferredContext) >= 5u )
            {
              sub_1102C(v2->Dpc.ProcessorHistory, 0x151u, (__int64)&unk_5CE18, *(unsigned __int8 *)(a1 + 20));
              v2 = off_60148;
            }
            if ( v2 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x15u)
              && BYTE1(v2->Dpc.DeferredContext) >= 5u )
            {
              if ( (*(_BYTE *)(a1 + 32) & 1) != 0 )
              {
                v4 = sub_4D99C(*(_DWORD *)(a1 + 36));
                v2 = off_60148;
              }
              else
              {
                v4 = (const char *)qword_5AA80;
              }
              sub_1182C(v2->Dpc.ProcessorHistory, 0x152u, (__int64)&unk_5CE18, v4);
              v2 = off_60148;
            }
          }
        }
      }
    }
  }
  if ( (*(_BYTE *)(a1 + 32) & 4) != 0 || (*(_BYTE *)(a1 + 32) & 2) != 0 )
  {
    if ( *(_DWORD *)(a1 + 36) == 2048 )
    {
      if ( v2 == (PDEVICE_OBJECT)&off_60148 )
        goto LABEL_65;
      if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x15u) && BYTE1(v2->Dpc.DeferredContext) >= 5u )
      {
        sub_114E4(v2->Dpc.ProcessorHistory, 0x153u, (__int64)&unk_5CE18, *(unsigned __int8 *)(a1 + 56));
        v2 = off_60148;
      }
      if ( v2 == (PDEVICE_OBJECT)&off_60148 )
        goto LABEL_65;
      if ( !_bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x15u) || BYTE1(v2->Dpc.DeferredContext) < 5u )
        goto LABEL_58;
      sub_114E4(v2->Dpc.ProcessorHistory, 0x154u, (__int64)&unk_5CE18, *(unsigned __int8 *)(a1 + 40));
      goto LABEL_57;
    }
    if ( v2 == (PDEVICE_OBJECT)&off_60148 )
      goto LABEL_65;
    if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x15u) && BYTE1(v2->Dpc.DeferredContext) >= 5u )
    {
      sub_110AC(
        v2->Dpc.ProcessorHistory,
        0x155u,
        (__int64)&unk_5CE18,
        (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 56)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 56) << 8));
      v2 = off_60148;
    }
    if ( v2 == (PDEVICE_OBJECT)&off_60148 )
      goto LABEL_65;
    if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x15u) && BYTE1(v2->Dpc.DeferredContext) >= 5u )
    {
      sub_110AC(
        v2->Dpc.ProcessorHistory,
        0x156u,
        (__int64)&unk_5CE18,
        (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 40)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 40) << 8));
LABEL_57:
      v2 = off_60148;
      goto LABEL_58;
    }
  }
LABEL_58:
  if ( v2 == (PDEVICE_OBJECT)&off_60148
    || !_bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x15u)
    || BYTE1(v2->Dpc.DeferredContext) < 5u )
  {
LABEL_65:
    v6 = (const char *)qword_5AA80;
    goto LABEL_66;
  }
  if ( (*(_BYTE *)(a1 + 32) & 8) != 0 )
  {
    v5 = sub_4D84C(*(_DWORD *)(a1 + 72));
    v2 = off_60148;
    v6 = (const char *)qword_5AA80;
  }
  else
  {
    v6 = (const char *)qword_5AA80;
    v5 = (const char *)qword_5AA80;
  }
  sub_1182C(v2->Dpc.ProcessorHistory, 0x157u, (__int64)&unk_5CE18, v5);
  v2 = off_60148;
LABEL_66:
  if ( (*(_BYTE *)(a1 + 32) & 0x20) == 0 && (*(_BYTE *)(a1 + 32) & 0x10) == 0 )
  {
LABEL_76:
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x15u)
      && BYTE1(v2->Dpc.DeferredContext) >= 5u )
    {
      if ( (*(_BYTE *)(a1 + 32) & 0x40) != 0 )
      {
        v7 = sub_4D8C4(*(_DWORD *)(a1 + 80));
        v2 = off_60148;
        v6 = v7;
      }
      sub_1182C(v2->Dpc.ProcessorHistory, 0x15Au, (__int64)&unk_5CE18, v6);
    }
    return;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x15u) && BYTE1(v2->Dpc.DeferredContext) >= 5u )
    {
      sub_112FC(v2->Dpc.ProcessorHistory, 0x158u, (__int64)&unk_5CE18, *(unsigned __int16 *)(a1 + 78));
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x15u) && BYTE1(v2->Dpc.DeferredContext) >= 5u )
      {
        sub_112FC(v2->Dpc.ProcessorHistory, 0x159u, (__int64)&unk_5CE18, *(unsigned __int16 *)(a1 + 76));
        v2 = off_60148;
      }
      goto LABEL_76;
    }
  }
}
// 5AA80: using guessed type __int64 qword_5AA80[2];

//----- (000000000001B2A0) ----------------------------------------------------
__int64 __fastcall sub_1B2A0(__int64 a1, __int64 a2, _DWORD *a3)
{
  int v3; // esi
  unsigned __int8 v7; // bp
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  char *v10; // rdi
  int v11; // er14
  union _LARGE_INTEGER v13; // [rsp+50h] [rbp-68h] BYREF
  char v14[24]; // [rsp+58h] [rbp-60h] BYREF

  v3 = 0;
  v7 = 0;
  if ( !a2 )
  {
    v8 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      v9 = 347;
LABEL_6:
      sub_11008(v8->Dpc.ProcessorHistory, v9, (__int64)&unk_5CE18);
      goto LABEL_51;
    }
    goto LABEL_51;
  }
  if ( a1 )
  {
    if ( *(_DWORD *)(a1 + 36) == 2054 )
    {
      if ( (dword_6540C & 0x40) == 0 )
      {
        v8 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          v9 = 350;
          goto LABEL_6;
        }
        goto LABEL_51;
      }
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x15Du, (__int64)&unk_5CE18);
      }
      goto LABEL_18;
    }
    if ( (*(_DWORD *)(a1 + 36) == 2048 || *(_DWORD *)(a1 + 36) == 34525)
      && (*(_QWORD *)(a2 + 64) || *(_QWORD *)(a2 + 56)) )
    {
      if ( (dword_6540C & 0x80u) != 0 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x15Fu, (__int64)&unk_5CE18);
        }
        sub_1C180(a1, 1);
LABEL_18:
        v7 = 1;
LABEL_39:
        if ( qword_61290 )
        {
          v10 = 0i64;
          v11 = 0;
          v13.QuadPart = MEMORY[0xFFFFF78000000014];
          if ( dword_65420 )
          {
            sub_58888(v14, 0x15ui64, 0x15ui64, (CHAR *)qword_5AA90, "|ISOLATION_EXCLUDED|");
            v10 = v14;
            v11 = strlen(v14);
          }
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
          {
            sub_11008(off_60148->Dpc.ProcessorHistory, 0x161u, (__int64)&unk_5CE18);
          }
          if ( *(_DWORD *)(a1 + 16) == 2 )
            v3 = 16;
          if ( (*(_BYTE *)(a2 + 88) & 1) != 0 )
            v3 |= 1u;
          sub_18B70(*(const void **)a2, *(_DWORD *)(a2 + 72), v10, v11, v3, 1, 1, &v13, 1);
        }
        goto LABEL_51;
      }
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
      {
        goto LABEL_51;
      }
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x160u, (__int64)&unk_5CE18);
    }
    else
    {
      v7 = sub_1C988(a1);
    }
    if ( !v7 )
      goto LABEL_51;
    goto LABEL_39;
  }
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    v9 = 348;
    goto LABEL_6;
  }
LABEL_51:
  *a3 = v7;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x162u, (__int64)&unk_5CE18, v7);
  }
  return 0i64;
}
// 5AA90: using guessed type __int64 qword_5AA90[2];
// 61290: using guessed type __int64 qword_61290;
// 6540C: using guessed type int dword_6540C;
// 65420: using guessed type int dword_65420;

//----- (000000000001B63C) ----------------------------------------------------
__int64 __fastcall sub_1B63C(__int64 a1, char a2, _DWORD *a3)
{
  int v6; // eax
  PDEVICE_OBJECT v7; // r10
  unsigned __int16 v8; // dx
  __int64 v9; // rcx
  unsigned __int16 v10; // dx
  unsigned __int16 v11; // dx
  __int64 v12; // rcx
  PDEVICE_OBJECT v13; // rcx
  __int64 v14; // rcx
  unsigned __int16 v15; // dx
  unsigned __int16 v16; // dx
  unsigned int *v17; // rdx
  unsigned int v18; // er12
  unsigned __int64 v19; // rbp
  char v20; // cl
  char v21; // al
  __int16 v22; // ax
  unsigned __int16 v23; // cx
  bool v24; // zf
  char v25; // cl
  char v26; // al
  __int16 v28[2]; // [rsp+30h] [rbp-118h] BYREF
  unsigned __int16 v29; // [rsp+34h] [rbp-114h] BYREF
  char v30; // [rsp+38h] [rbp-110h] BYREF
  __int64 v31; // [rsp+39h] [rbp-10Fh]
  int v32; // [rsp+41h] [rbp-107h]
  __int16 v33; // [rsp+45h] [rbp-103h]
  char v34; // [rsp+47h] [rbp-101h]
  char v35; // [rsp+48h] [rbp-100h] BYREF
  __int64 v36; // [rsp+49h] [rbp-FFh]
  int v37; // [rsp+51h] [rbp-F7h]
  __int16 v38; // [rsp+55h] [rbp-F3h]
  char v39; // [rsp+57h] [rbp-F1h]
  char v40; // [rsp+58h] [rbp-F0h] BYREF
  __int64 v41; // [rsp+59h] [rbp-EFh]
  int v42; // [rsp+61h] [rbp-E7h]
  __int16 v43; // [rsp+65h] [rbp-E3h]
  char v44; // [rsp+67h] [rbp-E1h]
  char v45; // [rsp+68h] [rbp-E0h] BYREF
  __int64 v46; // [rsp+69h] [rbp-DFh]
  int v47; // [rsp+71h] [rbp-D7h]
  __int16 v48; // [rsp+75h] [rbp-D3h]
  char v49; // [rsp+77h] [rbp-D1h]
  char v50; // [rsp+78h] [rbp-D0h] BYREF
  __int64 v51; // [rsp+79h] [rbp-CFh]
  int v52; // [rsp+81h] [rbp-C7h]
  __int16 v53; // [rsp+85h] [rbp-C3h]
  char v54; // [rsp+87h] [rbp-C1h]
  int v55; // [rsp+90h] [rbp-B8h] BYREF
  int Dst[27]; // [rsp+94h] [rbp-B4h] BYREF

  v40 = 0;
  v41 = 0i64;
  v42 = 0;
  v43 = 0;
  v44 = 0;
  v30 = 0;
  v31 = 0i64;
  v32 = 0;
  v33 = 0;
  v34 = 0;
  v50 = 0;
  v51 = 0i64;
  v52 = 0;
  v53 = 0;
  v54 = 0;
  v35 = 0;
  v36 = 0i64;
  v37 = 0;
  v38 = 0;
  v39 = 0;
  v45 = 0;
  v46 = 0i64;
  v47 = 0;
  v48 = 0;
  v49 = 0;
  v55 = 0;
  memset(Dst, 0, 0x64ui64);
  *a3 = 0;
  sub_1A840(a1 + 24, (*(_BYTE *)(a1 + 120) & 0x10) == 16, (__int64)&v55);
  v6 = Dst[8];
  if ( a2 )
  {
    if ( Dst[8] == 2054 )
    {
      if ( (dword_6540C & 0x40) != 0 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x163u, (__int64)&unk_5CE18);
        }
LABEL_8:
        *a3 = 1;
LABEL_187:
        v7 = off_60148;
        goto LABEL_188;
      }
      v7 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return 0i64;
      if ( !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
      {
        goto LABEL_188;
      }
      v8 = 356;
      goto LABEL_13;
    }
    if ( (Dst[8] == 2048 || Dst[8] == 34525) && (*(_QWORD *)(a1 + 88) || *(_QWORD *)(a1 + 80)) )
    {
      if ( (dword_6540C & 0x80u) != 0 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x165u, (__int64)&unk_5CE18);
        }
        sub_1C180((__int64)&v55, 1);
        goto LABEL_8;
      }
      v7 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return 0i64;
      if ( !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
      {
        goto LABEL_188;
      }
      v8 = 358;
LABEL_13:
      sub_11008(v7->Dpc.ProcessorHistory, v8, (__int64)&unk_5CE18);
      goto LABEL_187;
    }
  }
  v9 = *(_QWORD *)(a1 + 64);
  if ( !v9 )
    goto LABEL_97;
  v29 = 0;
  v28[0] = 0;
  sub_45274(v9, &v29);
  sub_451B0(*(_WORD **)(a1 + 64), v28);
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_4DE38(off_60148->Dpc.ProcessorHistory, 0x168u, (__int64)&unk_5CE18, v29);
    v7 = off_60148;
  }
  if ( v29 == 137 )
  {
    if ( v28[0] == 137 )
    {
      if ( (dword_6540C & 1) == 0 )
      {
        if ( v7 == (PDEVICE_OBJECT)&off_60148 )
          return 0i64;
        if ( !_bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u) || BYTE1(v7->Dpc.DeferredContext) < 4u )
          goto LABEL_188;
        v8 = 362;
        goto LABEL_13;
      }
      if ( v7 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u)
        && BYTE1(v7->Dpc.DeferredContext) >= 4u )
      {
        v10 = 361;
LABEL_40:
        sub_11008(v7->Dpc.ProcessorHistory, v10, (__int64)&unk_5CE18);
        goto LABEL_41;
      }
      goto LABEL_41;
    }
  }
  else if ( v29 == 5355 )
  {
    goto LABEL_147;
  }
  if ( v28[0] == 5355 )
  {
LABEL_147:
    if ( (dword_6540C & 2) == 0 )
    {
      if ( v7 == (PDEVICE_OBJECT)&off_60148 )
        return 0i64;
      if ( !_bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u) || BYTE1(v7->Dpc.DeferredContext) < 4u )
        goto LABEL_188;
      v8 = 364;
      goto LABEL_13;
    }
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u)
      && BYTE1(v7->Dpc.DeferredContext) >= 4u )
    {
      v10 = 363;
      goto LABEL_40;
    }
LABEL_41:
    *a3 = 2;
    goto LABEL_187;
  }
  v6 = Dst[8];
  if ( Dst[8] == 2048 )
  {
    if ( v29 == 68 || v29 == 67 )
    {
      if ( (dword_6540C & 4) == 0 )
      {
        if ( v7 == (PDEVICE_OBJECT)&off_60148 )
          return 0i64;
        if ( !_bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u) || BYTE1(v7->Dpc.DeferredContext) < 4u )
          goto LABEL_188;
        v8 = 366;
        goto LABEL_13;
      }
      if ( v7 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u)
        || BYTE1(v7->Dpc.DeferredContext) < 4u )
      {
        goto LABEL_58;
      }
      v11 = 365;
LABEL_56:
      v12 = v7->Dpc.ProcessorHistory;
LABEL_57:
      sub_11008(v12, v11, (__int64)&unk_5CE18);
LABEL_58:
      sub_1C180((__int64)&v55, 1);
      goto LABEL_41;
    }
  }
  else if ( Dst[8] == 34525 && (v29 == 546 || v29 == 547) )
  {
    if ( (dword_6540C & 8) == 0 )
    {
      if ( v7 == (PDEVICE_OBJECT)&off_60148 )
        return 0i64;
      if ( !_bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u) || BYTE1(v7->Dpc.DeferredContext) < 4u )
        goto LABEL_188;
      v8 = 368;
      goto LABEL_13;
    }
    if ( v7 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u)
      || BYTE1(v7->Dpc.DeferredContext) < 4u )
    {
      goto LABEL_58;
    }
    v11 = 367;
    goto LABEL_56;
  }
  if ( v29 == 1900 )
  {
    if ( Dst[8] == 2048 )
    {
      if ( (dword_6540C & 0x10) == 0 )
      {
        if ( v7 == (PDEVICE_OBJECT)&off_60148 )
          return 0i64;
        if ( !_bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u) || BYTE1(v7->Dpc.DeferredContext) < 4u )
          goto LABEL_188;
        v8 = 372;
        goto LABEL_13;
      }
      if ( v7 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u)
        && BYTE1(v7->Dpc.DeferredContext) >= 4u )
      {
        sub_112FC(v7->Dpc.ProcessorHistory, 0x171u, (__int64)&unk_5CE18, Dst[8]);
      }
      if ( !v40 )
        sub_588AC(&v40, 4ui64, aIyyu, 4ui64);
      if ( sub_47ADC(4, &Dst[13], (__int64)&v40) )
      {
        v13 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148
          || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
          || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
        {
          goto LABEL_58;
        }
        v11 = 370;
        goto LABEL_89;
      }
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
      {
        goto LABEL_95;
      }
      v14 = off_60148->Dpc.ProcessorHistory;
      v15 = 371;
    }
    else
    {
      if ( Dst[8] == 34525 )
      {
        if ( (dword_6540C & 0x20) == 0 )
        {
          if ( v7 == (PDEVICE_OBJECT)&off_60148 )
            return 0i64;
          if ( !_bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u)
            || BYTE1(v7->Dpc.DeferredContext) < 4u )
          {
            goto LABEL_188;
          }
          v8 = 377;
          goto LABEL_13;
        }
        if ( !v30 )
          sub_588AC(&v30, 0x10ui64, &unk_611C8, 0x10ui64);
        if ( sub_47ADC(16, &Dst[13], (__int64)&v30) )
        {
          v13 = off_60148;
          if ( off_60148 == (PDEVICE_OBJECT)&off_60148
            || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
            || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
          {
            goto LABEL_58;
          }
          v11 = 373;
        }
        else
        {
          if ( !v50 )
            sub_588AC(&v50, 0x10ui64, &unk_611D8, 0x10ui64);
          if ( sub_47ADC(16, &Dst[13], (__int64)&v50) )
          {
            v13 = off_60148;
            if ( off_60148 == (PDEVICE_OBJECT)&off_60148
              || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
              || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
            {
              goto LABEL_58;
            }
            v11 = 374;
          }
          else
          {
            if ( !v35 )
              sub_588AC(&v35, 0x10ui64, &unk_611E8, 0x10ui64);
            if ( sub_47ADC(16, &Dst[13], (__int64)&v35) )
            {
              v13 = off_60148;
              if ( off_60148 == (PDEVICE_OBJECT)&off_60148
                || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
                || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
              {
                goto LABEL_58;
              }
              v11 = 375;
            }
            else
            {
              if ( !v45 )
                sub_588AC(&v45, 0x10ui64, &unk_611F8, 0x10ui64);
              if ( !sub_47ADC(16, &Dst[13], (__int64)&v45) )
                goto LABEL_96;
              v13 = off_60148;
              if ( off_60148 == (PDEVICE_OBJECT)&off_60148
                || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
                || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
              {
                goto LABEL_58;
              }
              v11 = 376;
            }
          }
        }
LABEL_89:
        v12 = v13->Dpc.ProcessorHistory;
        goto LABEL_57;
      }
      if ( v7 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u)
        || BYTE1(v7->Dpc.DeferredContext) < 4u )
      {
LABEL_95:
        sub_1C180((__int64)&v55, 0);
LABEL_96:
        v6 = Dst[8];
LABEL_97:
        v7 = off_60148;
        goto LABEL_98;
      }
      v14 = v7->Dpc.ProcessorHistory;
      v15 = 378;
    }
    sub_11008(v14, v15, (__int64)&unk_5CE18);
    goto LABEL_95;
  }
LABEL_98:
  if ( v6 == 2048 || v6 == 34525 )
  {
    if ( !dword_65404 )
    {
      if ( v7 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u)
        || BYTE1(v7->Dpc.DeferredContext) < 4u )
      {
        return 0i64;
      }
      v16 = 379;
      goto LABEL_192;
    }
    if ( byte_6128B )
    {
      if ( v7 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u)
        || BYTE1(v7->Dpc.DeferredContext) < 4u )
      {
        return 0i64;
      }
      v16 = 380;
LABEL_192:
      sub_11008(v7->Dpc.ProcessorHistory, v16, (__int64)&unk_5CE18);
      return 0i64;
    }
    if ( !qword_61438 )
    {
      if ( v7 == (PDEVICE_OBJECT)&off_60148 )
        return 0i64;
      if ( !_bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u) || BYTE1(v7->Dpc.DeferredContext) < 4u )
        goto LABEL_188;
      v8 = 381;
      goto LABEL_13;
    }
    _InterlockedAdd(&dword_613CC, 1u);
    v17 = (unsigned int *)qword_61438;
    v18 = 0;
    if ( !*(_DWORD *)qword_61438 )
    {
LABEL_186:
      _InterlockedAdd(&dword_613CC, 0xFFFFFFFF);
      goto LABEL_187;
    }
    v19 = 0i64;
    while ( 1 )
    {
      if ( *a3 )
        goto LABEL_186;
      if ( Dst[8] == v17[v19 / 4 + 1] )
      {
        if ( Dst[3] == 2 )
        {
          v20 = 16;
          if ( Dst[8] == 2048 )
            v20 = 4;
          v21 = sub_47ADC(v20, &Dst[13], (__int64)&v17[6 * v18 + 2]);
          v17 = (unsigned int *)qword_61438;
          if ( !v21 )
            goto LABEL_198;
          v22 = *(_WORD *)((char *)qword_61438 + v19 + 24);
          if ( HIWORD(Dst[18]) == v22 )
            goto LABEL_185;
          v23 = *(_WORD *)((char *)qword_61438 + v19 + 26);
          v24 = HIWORD(Dst[18]) == v23;
          goto LABEL_182;
        }
        if ( Dst[3] != 1 )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
          {
            sub_11008(off_60148->Dpc.ProcessorHistory, 0x17Eu, (__int64)&unk_5CE18);
            v17 = (unsigned int *)qword_61438;
          }
          goto LABEL_198;
        }
        v25 = 16;
        if ( Dst[8] == 2048 )
          v25 = 4;
        v26 = sub_47ADC(v25, &Dst[9], (__int64)&v17[6 * v18 + 2]);
        v17 = (unsigned int *)qword_61438;
        if ( v26 )
        {
          v22 = *(_WORD *)((char *)qword_61438 + v19 + 24);
          if ( LOWORD(Dst[18]) == v22 )
            goto LABEL_185;
          v23 = *(_WORD *)((char *)qword_61438 + v19 + 26);
          v24 = LOWORD(Dst[18]) == v23;
LABEL_182:
          if ( v24 || !v22 && !v23 )
          {
LABEL_185:
            sub_1C6C4((__int64)&v17[6 * v18 + 1]);
            *a3 = 2;
            goto LABEL_186;
          }
          goto LABEL_198;
        }
      }
LABEL_198:
      ++v18;
      v19 += 24i64;
      if ( v18 >= *v17 )
        goto LABEL_186;
    }
  }
LABEL_188:
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 9u)
    && BYTE1(v7->Dpc.DeferredContext) >= 5u )
  {
    v16 = 383;
    goto LABEL_192;
  }
  return 0i64;
}
// 6128B: using guessed type char byte_6128B;
// 613CC: using guessed type int dword_613CC;
// 65404: using guessed type int dword_65404;
// 6540C: using guessed type int dword_6540C;

//----- (000000000001C180) ----------------------------------------------------
__int64 __fastcall sub_1C180(__int64 a1, char a2)
{
  PDEVICE_OBJECT v3; // r14
  unsigned __int16 v4; // dx
  const char *v5; // r9

  if ( a2 )
  {
    v3 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      v4 = 384;
LABEL_10:
      sub_11008(v3->Dpc.ProcessorHistory, v4, (__int64)&unk_5CE18);
      v3 = off_60148;
      goto LABEL_11;
    }
  }
  else
  {
    v3 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      v4 = 385;
      goto LABEL_10;
    }
  }
LABEL_11:
  if ( *(_DWORD *)(a1 + 36) == 2048 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 9u) && BYTE1(v3->Dpc.DeferredContext) >= 4u )
      {
        sub_114E4(v3->Dpc.ProcessorHistory, 0x182u, (__int64)&unk_5CE18, *(unsigned __int8 *)(a1 + 56));
        v3 = off_60148;
      }
      if ( v3 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 9u)
        && BYTE1(v3->Dpc.DeferredContext) >= 4u )
      {
        sub_114E4(v3->Dpc.ProcessorHistory, 0x183u, (__int64)&unk_5CE18, *(unsigned __int8 *)(a1 + 40));
LABEL_29:
        v3 = off_60148;
        goto LABEL_30;
      }
    }
  }
  else if ( *(_DWORD *)(a1 + 36) == 34525 && v3 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 9u) && BYTE1(v3->Dpc.DeferredContext) >= 4u )
    {
      sub_110AC(
        v3->Dpc.ProcessorHistory,
        0x184u,
        (__int64)&unk_5CE18,
        (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 56)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 56) << 8));
      v3 = off_60148;
    }
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 9u)
      && BYTE1(v3->Dpc.DeferredContext) >= 4u )
    {
      sub_110AC(
        v3->Dpc.ProcessorHistory,
        0x185u,
        (__int64)&unk_5CE18,
        (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 40)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 40) << 8));
      goto LABEL_29;
    }
  }
LABEL_30:
  if ( (*(_BYTE *)(a1 + 32) & 0x20) == 0 && (*(_BYTE *)(a1 + 32) & 0x10) == 0 )
  {
LABEL_40:
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 9u)
      && BYTE1(v3->Dpc.DeferredContext) >= 4u )
    {
      v5 = "E_NNS_COMM_DIRECTION_OUTGOING";
      if ( *(_DWORD *)(a1 + 16) == 1 )
        v5 = "E_NNS_COMM_DIRECTION_INCOMING";
      sub_1182C(v3->Dpc.ProcessorHistory, 0x188u, (__int64)&unk_5CE18, v5);
    }
    return 0i64;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 9u) && BYTE1(v3->Dpc.DeferredContext) >= 4u )
    {
      sub_112FC(v3->Dpc.ProcessorHistory, 0x186u, (__int64)&unk_5CE18, *(unsigned __int16 *)(a1 + 78));
      v3 = off_60148;
    }
    if ( v3 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 9u) && BYTE1(v3->Dpc.DeferredContext) >= 4u )
      {
        sub_112FC(v3->Dpc.ProcessorHistory, 0x187u, (__int64)&unk_5CE18, *(unsigned __int16 *)(a1 + 76));
        v3 = off_60148;
      }
      goto LABEL_40;
    }
  }
  return 0i64;
}

//----- (000000000001C6C4) ----------------------------------------------------
__int64 __fastcall sub_1C6C4(__int64 a1)
{
  PDEVICE_OBJECT v2; // r14

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x189u, (__int64)&unk_5CE18);
    v2 = off_60148;
  }
  if ( *(_DWORD *)a1 != 2048 )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_60148 )
      return 0i64;
    if ( !_bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 9u) || BYTE1(v2->Dpc.DeferredContext) < 4u )
      goto LABEL_15;
    sub_110AC(
      v2->Dpc.ProcessorHistory,
      0x18Bu,
      (__int64)&unk_5CE18,
      (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 4)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 4) << 8));
    goto LABEL_14;
  }
  if ( v2 == (PDEVICE_OBJECT)&off_60148 )
    return 0i64;
  if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 9u) && BYTE1(v2->Dpc.DeferredContext) >= 4u )
  {
    sub_114E4(v2->Dpc.ProcessorHistory, 0x18Au, (__int64)&unk_5CE18, *(unsigned __int8 *)(a1 + 4));
LABEL_14:
    v2 = off_60148;
  }
LABEL_15:
  if ( v2 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 9u) && BYTE1(v2->Dpc.DeferredContext) >= 4u )
    {
      sub_112FC(v2->Dpc.ProcessorHistory, 0x18Cu, (__int64)&unk_5CE18, *(unsigned __int16 *)(a1 + 20));
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 9u)
      && BYTE1(v2->Dpc.DeferredContext) >= 4u )
    {
      sub_112FC(v2->Dpc.ProcessorHistory, 0x18Du, (__int64)&unk_5CE18, *(unsigned __int16 *)(a1 + 22));
    }
  }
  return 0i64;
}

//----- (000000000001C988) ----------------------------------------------------
char __fastcall sub_1C988(__int64 a1)
{
  char v1; // bl
  PDEVICE_OBJECT v3; // rcx

  v1 = 0;
  if ( byte_61289 )
  {
    v3 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x18Eu, (__int64)&unk_5CE18);
      v3 = off_60148;
    }
    if ( *(_WORD *)(a1 + 78) == 53 || *(_WORD *)(a1 + 76) == 53 )
    {
      if ( v3 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 9u)
        && BYTE1(v3->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v3->Dpc.ProcessorHistory, 0x18Fu, (__int64)&unk_5CE18);
        v3 = off_60148;
      }
      v1 = 1;
    }
  }
  else
  {
    v3 = off_60148;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 9u)
    && BYTE1(v3->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v3->Dpc.ProcessorHistory, 0x192u, (__int64)&unk_5CE18);
  }
  return v1;
}
// 61289: using guessed type char byte_61289;

//----- (000000000001CA88) ----------------------------------------------------
__int64 __fastcall sub_1CA88(__int64 a1, int a2)
{
  __int64 result; // rax
  int v3; // [rsp+20h] [rbp-18h]

  result = (unsigned int)_InterlockedIncrement((volatile signed __int32 *)(a1 + 228));
  if ( (unsigned int)result > 0x14 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      v3 = result;
      result = sub_11230(off_60148->Dpc.ProcessorHistory, 0x193u, (__int64)&unk_5CE18, *(_QWORD *)a1, v3);
    }
  }
  else
  {
    result = (int)result;
    *(_DWORD *)(a1 + 4i64 * (int)result + 228) = a2;
  }
  return result;
}

//----- (000000000001CB00) ----------------------------------------------------
__int64 __fastcall sub_1CB00(__int64 a1, _BYTE *a2)
{
  PDEVICE_OBJECT v4; // rcx
  int v5; // eax
  unsigned int v6; // ebx
  PDEVICE_OBJECT v7; // rcx

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->Dpc.DeferredContext) < 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x194u, (__int64)&unk_5CE18);
    v4 = off_60148;
  }
  if ( a1 && a2 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_60148 && SBYTE4(v4->Dpc.DeferredContext) < 0 && BYTE1(v4->Dpc.DeferredContext) >= 4u )
      sub_2F80C(v4->Dpc.ProcessorHistory, 0x196u, (__int64)&unk_5CE18, *(_QWORD *)a1);
    sub_17238(a1, 1);
    if ( _bittest((const signed __int32 *)(a1 + 120), 0xAu) )
      v5 = sub_22510(a1, a2);
    else
      v5 = sub_1CC8C(a1, a2);
    v6 = v5;
    if ( v5 )
    {
      v7 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return v6;
      if ( SBYTE4(off_60148->Dpc.DeferredContext) >= 0 || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
      {
LABEL_20:
        if ( v7 != (PDEVICE_OBJECT)&off_60148
          && SBYTE4(v7->Dpc.DeferredContext) < 0
          && BYTE1(v7->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(v7->Dpc.ProcessorHistory, 0x198u, (__int64)&unk_5CE18);
        }
        return v6;
      }
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x197u, (__int64)&unk_5CE18, v5);
    }
    v7 = off_60148;
    goto LABEL_20;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148 && SBYTE4(v4->Dpc.DeferredContext) < 0 && BYTE1(v4->Dpc.DeferredContext) >= 2u )
    sub_1D3B0(v4->Dpc.ProcessorHistory, 0x195u, (__int64)&unk_5CE18, a1, a2);
  return 4i64;
}

//----- (000000000001CC8C) ----------------------------------------------------
__int64 __fastcall sub_1CC8C(__int64 a1, _BYTE *a2)
{
  unsigned int v4; // er12
  PDEVICE_OBJECT v5; // rcx
  int v7; // er13
  int v8; // esi
  const char *v9; // rax
  __int64 v10; // r10
  __int64 v11; // r8
  __int64 v12; // rax
  _QWORD *v13; // rax
  __int64 v14; // rbx
  unsigned int v15; // edx
  unsigned int v16; // eax
  int v17; // eax
  PDEVICE_OBJECT v18; // rcx
  unsigned __int16 v19; // dx

  v4 = 0;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->Dpc.DeferredContext) < 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x199u, (__int64)&unk_5CE18);
    v5 = off_60148;
  }
  if ( a1 )
  {
    sub_40598((PFAST_MUTEX)(a1 + 152));
    v7 = *(_DWORD *)(a1 + 208);
    v8 = *(_DWORD *)(a1 + 212);
    sub_40664((PFAST_MUTEX)(a1 + 152));
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->Dpc.DeferredContext) < 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      v9 = sub_4D7E8(v7);
      sub_11764(*(_QWORD *)(v10 + 216), 411i64, (__int64)&unk_5CE18, *(_QWORD *)a1, v9, v11);
    }
    *a2 = 0;
    if ( v8 != 2 )
      goto LABEL_34;
    v12 = _InterlockedCompareExchange64(&qword_61270, 0i64, 0i64);
    if ( v12 )
    {
      *(_DWORD *)(a1 + 120) |= 0x20u;
      v13 = sub_48CA0(v12, 8, (__int64)sub_167A4, 0i64);
      v14 = (__int64)v13;
      if ( v13 )
      {
        v15 = dword_653F0;
        *v13 = a1;
        v16 = sub_14594(a1 + 24, v15);
        v17 = sub_48F24(v14, v16);
        v4 = v17;
        if ( v17 )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && SBYTE4(off_60148->Dpc.DeferredContext) < 0
            && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
          {
            sub_112FC(off_60148->Dpc.ProcessorHistory, 0x19Cu, (__int64)&unk_5CE18, v17);
          }
          sub_48E4C(v14, 1);
        }
        else
        {
          *a2 = 1;
        }
        goto LABEL_34;
      }
      v18 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( SBYTE4(off_60148->Dpc.DeferredContext) < 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          v19 = 413;
LABEL_33:
          sub_11008(v18->Dpc.ProcessorHistory, v19, (__int64)&unk_5CE18);
LABEL_34:
          v18 = off_60148;
          goto LABEL_35;
        }
        goto LABEL_35;
      }
    }
    else
    {
      v18 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( SBYTE4(off_60148->Dpc.DeferredContext) < 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          v19 = 414;
          goto LABEL_33;
        }
LABEL_35:
        if ( v18 != (PDEVICE_OBJECT)&off_60148
          && SBYTE4(v18->Dpc.DeferredContext) < 0
          && BYTE1(v18->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(v18->Dpc.ProcessorHistory, 0x19Fu, (__int64)&unk_5CE18);
        }
        return v4;
      }
    }
    return v4;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148 && SBYTE4(v5->Dpc.DeferredContext) < 0 && BYTE1(v5->Dpc.DeferredContext) >= 2u )
    sub_11008(v5->Dpc.ProcessorHistory, 0x19Au, (__int64)&unk_5CE18);
  return 4i64;
}
// 1CDC8: variable 'v10' is possibly undefined
// 1CDE5: variable 'v11' is possibly undefined
// 61270: using guessed type __int64 qword_61270;
// 653F0: using guessed type int dword_653F0;

//----- (000000000001CF58) ----------------------------------------------------
char __fastcall sub_1CF58(__int64 a1)
{
  char v1; // bl
  __int64 v2; // rcx
  PDEVICE_OBJECT v3; // r10
  const char *v4; // rax
  const char *v5; // r8
  __int64 v6; // r10
  unsigned __int16 v7; // dx
  __int64 v8; // rcx
  PDEVICE_OBJECT v9; // r10
  unsigned __int8 v11; // [rsp+40h] [rbp+8h] BYREF

  v1 = 0;
  if ( *(_QWORD *)(a1 + 16) )
  {
    v2 = *(_QWORD *)(a1 + 16);
    v11 = -1;
    sub_43F40(v2, &v11);
    v3 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x1A0u, (__int64)&unk_5CE18);
      v3 = off_60148;
    }
    if ( v11 == 17 && dword_653F8 == 1 || v11 == 6 && dword_653F8 == 2 || !dword_653F8 )
    {
      if ( v3 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 9u)
        || BYTE1(v3->Dpc.DeferredContext) < 4u )
      {
        return 1;
      }
      v4 = sub_4DA64(dword_653F8);
      v7 = 417;
      goto LABEL_27;
    }
  }
  else if ( *(_QWORD *)(a1 + 24) )
  {
    v8 = *(_QWORD *)(a1 + 24);
    if ( v8 )
    {
      v11 = -1;
      sub_44214(v8, &v11, 0i64, 0i64);
      v9 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x1A2u, (__int64)&unk_5CE18);
        v9 = off_60148;
      }
      if ( dword_653F8 != 3 )
      {
        if ( v9 == (PDEVICE_OBJECT)&off_60148
          || !_bittest((const signed __int32 *)&v9->Dpc.DeferredContext + 1, 9u)
          || BYTE1(v9->Dpc.DeferredContext) < 4u )
        {
          return 1;
        }
        v4 = sub_4DA64(dword_653F8);
        v7 = 420;
LABEL_27:
        sub_11908(*(_QWORD *)(v6 + 216), v7, (__int64)&unk_5CE18, v4, v5);
        return 1;
      }
    }
  }
  return v1;
}
// 1CF7A: conditional instruction was optimized away because of 'rax.8==0'
// 1D112: variable 'v6' is possibly undefined
// 1D128: variable 'v5' is possibly undefined
// 653F8: using guessed type int dword_653F8;

//----- (000000000001D144) ----------------------------------------------------
__int64 __fastcall sub_1D144(int a1, __int64 a2, int a3, _DWORD *a4, void **a5, _DWORD *a6)
{
  PDEVICE_OBJECT v9; // rcx
  __int64 result; // rax
  PVOID v11; // rax

  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x1A8u, (__int64)&unk_5CE18, a1);
    v9 = off_60148;
  }
  if ( a3 == 232 )
  {
    v11 = sub_3F66C(2, 0xE8u, 0x6444734Eu);
    *a5 = v11;
    if ( v11 )
    {
      *a4 = 232;
      *a6 = 1682207566;
      memmove(*a5, &dword_612E0, 0xE8ui64);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x1ABu, (__int64)&unk_5CE18);
      }
      result = 0i64;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x1AAu, (__int64)&unk_5CE18);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v9->Dpc.DeferredContext + 1, 0x10u)
      && BYTE1(v9->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(v9->Dpc.ProcessorHistory, 0x1A9u, (__int64)&unk_5CE18, a3);
    }
    result = 6i64;
  }
  return result;
}
// 612E0: using guessed type int dword_612E0;

//----- (000000000001D2C8) ----------------------------------------------------
__int64 __fastcall sub_1D2C8(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+A8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CE08, 94i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D34C) ----------------------------------------------------
__int64 __fastcall sub_1D34C(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CE08, 91i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D3B0) ----------------------------------------------------
__int64 sub_1D3B0(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, a3, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D3F8) ----------------------------------------------------
__int64 __fastcall sub_1D3F8(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+A8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CE08, 84i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D47C) ----------------------------------------------------
__int64 __fastcall sub_1D47C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CE08, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D4DC) ----------------------------------------------------
__int64 sub_1D4DC(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CE08, 141i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D530) ----------------------------------------------------
__int64 sub_1D530(__int64 a1, __int64 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+A8h] [rbp+20h] BYREF
  va_list va; // [rsp+A8h] [rbp+20h]
  __int64 v7; // [rsp+B0h] [rbp+28h]
  __int64 v8; // [rsp+B8h] [rbp+30h]
  const char *v9; // [rsp+C0h] [rbp+38h]
  const char *v10; // [rsp+C8h] [rbp+40h]
  va_list va1; // [rsp+D0h] [rbp+48h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, _QWORD);
  v8 = va_arg(va1, _QWORD);
  v9 = va_arg(va1, const char *);
  v10 = va_arg(va1, const char *);
  if ( v10 )
    strlen(v10);
  if ( v9 )
    strlen(v9);
  return qword_61238(a1, 43i64, &unk_5CE08, 214i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D620) ----------------------------------------------------
__int64 sub_1D620(__int64 a1, __int64 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+A8h] [rbp+20h] BYREF
  va_list va; // [rsp+A8h] [rbp+20h]
  const char *v7; // [rsp+B0h] [rbp+28h]
  va_list va1; // [rsp+B8h] [rbp+30h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, const char *);
  if ( v7 )
    strlen(v7);
  return qword_61238(a1, 43i64, &unk_5CE08, 95i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D6E8) ----------------------------------------------------
__int64 sub_1D6E8(__int64 a1, __int64 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+98h] [rbp+20h] BYREF
  va_list va; // [rsp+98h] [rbp+20h]
  __int64 v7; // [rsp+A0h] [rbp+28h]
  __int64 v8; // [rsp+A8h] [rbp+30h]
  const char *v9; // [rsp+B0h] [rbp+38h]
  va_list va1; // [rsp+B8h] [rbp+40h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, _QWORD);
  v8 = va_arg(va1, _QWORD);
  v9 = va_arg(va1, const char *);
  if ( v9 )
    strlen(v9);
  return qword_61238(a1, 43i64, &unk_5CE08, 50i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D79C) ----------------------------------------------------
__int64 sub_1D79C(__int64 a1, __int64 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+98h] [rbp+20h] BYREF
  va_list va; // [rsp+98h] [rbp+20h]
  __int64 v7; // [rsp+A0h] [rbp+28h]
  const char *v8; // [rsp+A8h] [rbp+30h]
  const char *v9; // [rsp+B0h] [rbp+38h]
  va_list va1; // [rsp+B8h] [rbp+40h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, _QWORD);
  v8 = va_arg(va1, const char *);
  v9 = va_arg(va1, const char *);
  if ( v9 )
    strlen(v9);
  if ( v8 )
    strlen(v8);
  return qword_61238(a1, 43i64, &unk_5CE08, 25i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D878) ----------------------------------------------------
__int64 sub_1D878(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, a3, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D8D0) ----------------------------------------------------
__int64 sub_1D8D0(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CE08, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D940) ----------------------------------------------------
__int64 sub_1D940(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+B8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CE08, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D9CC) ----------------------------------------------------
__int64 sub_1D9CC(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CE08, 100i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001DA38) ----------------------------------------------------
__int64 sub_1DA38(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+98h] [rbp+20h] BYREF
  va_list va; // [rsp+98h] [rbp+20h]
  __int64 v7; // [rsp+A0h] [rbp+28h]
  __int64 v8; // [rsp+A8h] [rbp+30h]
  const char *v9; // [rsp+B0h] [rbp+38h]
  va_list va1; // [rsp+B8h] [rbp+40h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, _QWORD);
  v8 = va_arg(va1, _QWORD);
  v9 = va_arg(va1, const char *);
  if ( v9 )
    strlen(v9);
  return qword_61238(a1, 43i64, &unk_5CE08, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001DAE4) ----------------------------------------------------
__int64 sub_1DAE4()
{
  unsigned int v0; // ebx
  PDEVICE_OBJECT v1; // rcx
  unsigned __int16 v2; // dx

  v0 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_5CE08);
  }
  qword_613D8 = sub_3F8D8(2, 0x80u, 0x64644E4Eu);
  if ( !qword_613D8 )
  {
    v1 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 1) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_11;
    }
    v2 = 11;
    goto LABEL_10;
  }
  qword_613E0 = sub_3F8D8(2, 0x18u, 0x634E774Eu);
  if ( qword_613E0 )
  {
    v1 = off_60148;
    goto LABEL_18;
  }
  v1 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    v2 = 12;
LABEL_10:
    sub_11008(v1->Dpc.ProcessorHistory, v2, (__int64)&unk_5CE08);
    v1 = off_60148;
  }
LABEL_11:
  v0 = 3;
LABEL_18:
  if ( v1 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v1->Dpc.DeferredContext) & 1) != 0
    && BYTE1(v1->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v1->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_5CE08);
  }
  return v0;
}

//----- (000000000001DC34) ----------------------------------------------------
__int64 __fastcall sub_1DC34(int a1, __int64 a2, int a3)
{
  unsigned int v3; // ebx
  PDEVICE_OBJECT v7; // rcx
  int v8; // eax

  v3 = 0;
  if ( !a2 || !a3 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11230(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x10u, (__int64)&unk_5CE08, a2, a3);
    }
    return 2;
  }
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_115F4(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x11u, (__int64)&unk_5CE08, a1);
    v7 = off_60148;
  }
  if ( a1 )
    return 2;
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v7->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_11008(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x12u, (__int64)&unk_5CE08);
    v7 = off_60148;
  }
  if ( a3 == 32 )
  {
    v8 = sub_1DED8(a2);
    if ( v8 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x14u, (__int64)&unk_5CE08, v8);
      }
      v3 = 1;
    }
  }
  else
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
      && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11430(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x13u, (__int64)&unk_5CE08, 32);
    }
    v3 = 3;
  }
  return v3;
}

//----- (000000000001DE00) ----------------------------------------------------
__int64 __fastcall sub_1DE00(__int64 a1, __int64 a2)
{
  unsigned int v3; // ebx

  if ( a2 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_115F4(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x16u, (__int64)&unk_5CE08, 2);
    }
    v3 = sub_1A248(2i64, a2);
  }
  else
  {
    v3 = 2;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11230(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x15u, (__int64)&unk_5CE08, 0i64, 32);
    }
  }
  return v3;
}

//----- (000000000001DED8) ----------------------------------------------------
__int64 __fastcall sub_1DED8(__int64 a1)
{
  unsigned int v1; // esi
  struct _DEVICE_OBJECT **v2; // rbx
  int v3; // ebp
  _DWORD *v4; // rdi
  unsigned int v6; // er15
  PDEVICE_OBJECT v7; // r10
  const char *v8; // rax
  int v9; // er8
  struct _DEVICE_OBJECT *i; // rcx
  int v11; // ebp
  struct _DEVICE_OBJECT **v12; // r13
  int v13; // eax
  _DWORD *v14; // rax
  struct _DEVICE_OBJECT **v15; // rbp
  unsigned int v16; // ebp
  struct _DEVICE_OBJECT **v17; // rbp
  PDEVICE_OBJECT v18; // rcx
  int v19; // eax
  struct _DEVICE_OBJECT **v20; // rbp
  unsigned __int16 v21; // dx
  PDEVICE_OBJECT v22; // rcx
  unsigned __int16 v23; // dx
  __int64 v24; // rcx
  unsigned __int16 v25; // dx
  int v26; // er8
  PDEVICE_OBJECT v27; // rcx
  __int64 *v28; // rax
  __int64 v30; // [rsp+20h] [rbp-88h]
  __int64 v31; // [rsp+28h] [rbp-80h]
  __int64 v32; // [rsp+30h] [rbp-78h]
  PDEVICE_OBJECT *v33; // [rsp+40h] [rbp-68h] BYREF
  int v34; // [rsp+48h] [rbp-60h] BYREF
  int v35; // [rsp+4Ch] [rbp-5Ch]
  unsigned int v36; // [rsp+50h] [rbp-58h]
  struct _DEVICE_OBJECT **v37; // [rsp+58h] [rbp-50h] BYREF
  void *v38; // [rsp+60h] [rbp-48h]
  __int64 v39; // [rsp+68h] [rbp-40h]
  int v40; // [rsp+B0h] [rbp+8h]
  int v41; // [rsp+C0h] [rbp+18h]
  __int64 v42; // [rsp+C8h] [rbp+20h]

  v1 = 0;
  v2 = 0i64;
  v42 = 0i64;
  v33 = 0i64;
  v3 = 0;
  v4 = 0i64;
  v37 = 0i64;
  v38 = 0i64;
  v39 = 0i64;
  v40 = 0;
  v6 = 0;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x17u, (__int64)&unk_5CE08);
    v2 = v37;
    v7 = off_60148;
  }
  if ( !a1 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0x12u)
      && BYTE1(v7->Dpc.DeferredContext) >= 2u )
    {
      sub_2F80C(v7->Dpc.ProcessorHistory, 0x18u, (__int64)&unk_5CE08, 0i64);
      v2 = v37;
    }
    v1 = 4;
    goto LABEL_138;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0x12u)
    && BYTE1(v7->Dpc.DeferredContext) >= 5u )
  {
    v8 = "Outbound";
    if ( !*(_DWORD *)(a1 + 12) )
      v8 = "Inbound";
    sub_1D79C(
      v7->Dpc.ProcessorHistory,
      25i64,
      (__int64)&unk_5CE08,
      *(_QWORD *)a1,
      *(_DWORD *)(a1 + 8),
      v8,
      *(_QWORD *)(a1 + 16) + 4i64);
    v7 = off_60148;
  }
  if ( !dword_653E4 || dword_6126C )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0x12u)
      && BYTE1(v7->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v7->Dpc.ProcessorHistory, 0x1Au, (__int64)&unk_5CE08);
    }
    if ( (unsigned int)dword_622E4 > 9 )
      _InterlockedAdd((volatile signed __int32 *)P + 9, 1u);
    return 0i64;
  }
  v2 = *(struct _DEVICE_OBJECT ***)a1;
  v9 = *(_DWORD *)(a1 + 8);
  v37 = v2;
  LODWORD(v39) = v9;
  v38 = v2;
  for ( i = *v2; i; i = *(struct _DEVICE_OBJECT **)&i->Type )
    v38 = i;
  if ( !v2 )
    goto LABEL_138;
  while ( 1 )
  {
    v34 = 0;
    v11 = v3 + 1;
    v41 = v11;
    v35 = 0;
    v36 = 0;
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0x12u)
      && BYTE1(v7->Dpc.DeferredContext) >= 5u )
    {
      sub_11430(v7->Dpc.ProcessorHistory, 0x1Du, (__int64)&unk_5CE08, v11);
    }
    v12 = (struct _DEVICE_OBJECT **)*v2;
    v13 = sub_22FA4((__int64)v2, *(_DWORD *)(a1 + 12), *(_QWORD *)(a1 + 16), &v34);
    v1 = v13;
    if ( v13 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x1Eu, (__int64)&unk_5CE08, v13);
      }
      sub_20824((__int64)v4);
      v1 = 12;
      goto LABEL_106;
    }
    if ( v34 )
    {
      if ( !v42 )
      {
        v14 = sub_1E94C(*(_QWORD *)(a1 + 16), *(_DWORD *)(a1 + 12), *(_QWORD *)(a1 + 24));
        v42 = (__int64)v14;
        if ( !v14 )
        {
          v7 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
          {
            v21 = 31;
            goto LABEL_93;
          }
          goto LABEL_94;
        }
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_2F80C(off_60148->Dpc.ProcessorHistory, v1 + 32, (__int64)&unk_5CE08, v14);
        }
      }
      sub_21A08((__int64)&v37, &v33, v2);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        LODWORD(v31) = v39;
        sub_1D878(off_60148->Dpc.ProcessorHistory, 0x21u, (__int64)&unk_5CE08, v2, v37, v31);
      }
      v15 = v2;
      v2 = v12;
      sub_21AB0(v42 + 40, v15);
      v7 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        LODWORD(v31) = *(_DWORD *)(v42 + 56);
        sub_1D878(off_60148->Dpc.ProcessorHistory, 0x22u, (__int64)&unk_5CE08, v15, v42, v31);
        goto LABEL_43;
      }
      goto LABEL_44;
    }
    v16 = v36;
    v40 = v36;
    if ( v35 )
    {
      v7 = off_60148;
      v33 = v2;
      v2 = v12;
    }
    else
    {
      if ( v4 && v36 == v6 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11430(off_60148->Dpc.ProcessorHistory, 0x23u, (__int64)&unk_5CE08, v36);
        }
        sub_21A08((__int64)&v37, &v33, v2);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          LODWORD(v31) = v39;
          sub_1D878(off_60148->Dpc.ProcessorHistory, 0x24u, (__int64)&unk_5CE08, v2, v37, v31);
        }
        v17 = v2;
        v2 = v12;
        sub_21AB0((__int64)(v4 + 4), v17);
        v7 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          LODWORD(v31) = v4[8];
          sub_1D878(off_60148->Dpc.ProcessorHistory, 0x25u, (__int64)&unk_5CE08, v17, v4, v31);
LABEL_43:
          v7 = off_60148;
        }
LABEL_44:
        v16 = v40;
        goto LABEL_45;
      }
      v18 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11430(off_60148->Dpc.ProcessorHistory, 0x26u, (__int64)&unk_5CE08, v36);
        v18 = off_60148;
      }
      if ( v4 )
      {
        if ( v18 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v18->Dpc.DeferredContext + 1, 0x12u)
          && BYTE1(v18->Dpc.DeferredContext) >= 4u )
        {
          LODWORD(v32) = v6;
          LODWORD(v31) = v4[8];
          sub_1D8D0(v18->Dpc.ProcessorHistory, 0x27u, (__int64)&unk_5CE08, v4, *((_QWORD *)v4 + 2), v31, v32);
          v18 = off_60148;
        }
        if ( dword_65448 == 1 )
        {
          if ( v18 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v18->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
            && BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            v24 = *(_QWORD *)&v18->DeviceLock.Header.Lock;
            v25 = 40;
            goto LABEL_104;
          }
LABEL_105:
          sub_20824((__int64)v4);
          goto LABEL_106;
        }
        v19 = sub_1ED14((__int64)v4, v6);
        v1 = v19;
        if ( v19 )
        {
          v22 = off_60148;
          if ( off_60148 == (PDEVICE_OBJECT)&off_60148
            || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
            || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
          {
            goto LABEL_105;
          }
          v23 = 41;
LABEL_99:
          HIDWORD(v30) = HIDWORD(v4);
          sub_11148(v22->Dpc.ProcessorHistory, v23, (__int64)&unk_5CE08, v19);
          goto LABEL_105;
        }
        v18 = off_60148;
      }
      v6 = v16;
      if ( v18 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v18->Dpc.DeferredContext + 1, 0x12u)
        && BYTE1(v18->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v18->Dpc.ProcessorHistory, 0x2Au, (__int64)&unk_5CE08);
      }
      v4 = sub_1E94C(*(_QWORD *)(a1 + 16), *(_DWORD *)(a1 + 12), *(_QWORD *)(a1 + 24));
      if ( !v4 )
      {
        v7 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          v21 = 43;
LABEL_93:
          sub_11008(v7->Dpc.ProcessorHistory, v21, (__int64)&unk_5CE08);
          v7 = off_60148;
        }
LABEL_94:
        v1 = 3;
        goto LABEL_131;
      }
      sub_21A08((__int64)&v37, &v33, v2);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        LODWORD(v31) = v39;
        sub_1D878(off_60148->Dpc.ProcessorHistory, 0x2Cu, (__int64)&unk_5CE08, v2, v37, v31);
      }
      v20 = v2;
      v2 = v12;
      sub_21AB0((__int64)(v4 + 4), v20);
      v7 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        LODWORD(v31) = v4[8];
        sub_1D878(off_60148->Dpc.ProcessorHistory, 0x2Du, (__int64)&unk_5CE08, v20, v4, v31);
        v7 = off_60148;
      }
      v16 = v6;
    }
LABEL_45:
    if ( !v12 )
      break;
    v3 = v41;
  }
  if ( v4 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0x12u)
      && BYTE1(v7->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(v7->Dpc.ProcessorHistory, 0x2Eu, (__int64)&unk_5CE08, v4);
      v7 = off_60148;
    }
    if ( dword_65448 == 1 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v7->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        v24 = *(_QWORD *)&v7->DeviceLock.Header.Lock;
        v25 = 47;
LABEL_104:
        sub_1182C(v24, v25, (__int64)&unk_5CE08, "BEFORE_NBL_ENQUEUE");
      }
      goto LABEL_105;
    }
    v19 = sub_1ED14((__int64)v4, v16);
    v1 = v19;
    if ( v19 )
    {
      v22 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_105;
      }
      v23 = 48;
      goto LABEL_99;
    }
LABEL_106:
    v7 = off_60148;
  }
LABEL_131:
  if ( v42 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0x12u)
      && BYTE1(v7->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(v7->Dpc.ProcessorHistory, 0x31u, (__int64)&unk_5CE08, v42);
    }
    sub_20824(v42);
  }
  v2 = v37;
LABEL_138:
  v26 = v39;
  *(_QWORD *)a1 = v2;
  *(_DWORD *)(a1 + 8) = v26;
  v27 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      v28 = (__int64 *)"Error";
      if ( !v1 )
        v28 = qword_5AB80;
      LODWORD(v31) = v1;
      LODWORD(v30) = v26;
      sub_1D6E8(off_60148->Dpc.ProcessorHistory, 50i64, (__int64)&unk_5CE08, v2, v30, v31, v28);
      v27 = off_60148;
    }
    if ( v27 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v27->Dpc.DeferredContext + 1, 0x12u)
      && BYTE1(v27->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v27->Dpc.ProcessorHistory, 0x33u, (__int64)&unk_5CE08);
    }
  }
  return v1;
}
// 1E461: conditional instruction was optimized away because of 'rdi.8==0'
// 1E1B1: variable 'v31' is possibly undefined
// 1E424: variable 'v32' is possibly undefined
// 1E8AC: variable 'v30' is possibly undefined
// 5AB80: using guessed type __int64 qword_5AB80[2];
// 6126C: using guessed type int dword_6126C;
// 622E4: using guessed type int dword_622E4;
// 653E4: using guessed type int dword_653E4;
// 65448: using guessed type int dword_65448;

//----- (000000000001E94C) ----------------------------------------------------
_DWORD *__fastcall sub_1E94C(__int64 a1, int a2, __int64 a3)
{
  _DWORD *v6; // rax
  _DWORD *v7; // rbx

  v6 = sub_3FA7C((__int64)qword_613D8);
  v7 = v6;
  if ( v6 )
  {
    memset(v6, 0, 0x80ui64);
    *((_QWORD *)v7 + 1) = v7;
    *(_QWORD *)v7 = v7;
    *((_QWORD *)v7 + 9) = a1;
    v7[16] = a2;
    *((_QWORD *)v7 + 10) = a3;
  }
  return v7;
}

//----- (000000000001E9C4) ----------------------------------------------------
void __fastcall sub_1E9C4(__int64 a1)
{
  if ( a1 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x34u, (__int64)&unk_5CE08, a1);
    }
    sub_3FAE4((__int64)qword_613D8, a1);
  }
}

//----- (000000000001EA38) ----------------------------------------------------
__int64 __fastcall sub_1EA38(__int64 a1, int a2)
{
  __int64 result; // rax
  _QWORD *v4; // rdx
  _QWORD *v5; // rcx

  if ( a1 )
  {
    if ( a2 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x37u, (__int64)&unk_5CE08);
      }
      v4 = (_QWORD *)(a1 + 16);
      v5 = (_QWORD *)(a1 + 40);
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x36u, (__int64)&unk_5CE08);
      }
      v4 = (_QWORD *)(a1 + 40);
      v5 = (_QWORD *)(a1 + 16);
    }
    sub_21B30(v5, v4);
    result = 0i64;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x35u, (__int64)&unk_5CE08, 0i64);
    }
    result = 4i64;
  }
  return result;
}

//----- (000000000001EB34) ----------------------------------------------------
__int64 __fastcall sub_1EB34(__int64 a1, int a2, _QWORD *a3, _QWORD **a4)
{
  PDEVICE_OBJECT v8; // rcx
  const char *v9; // rsi
  int v10; // edx
  const char *v11; // rax
  int v12; // ebx

  v8 = off_60148;
  v9 = "UNKNOWN";
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    if ( a2 )
    {
      v10 = a2 - 1;
      if ( v10 )
      {
        if ( v10 == 1 )
          v11 = "RETREATED";
        else
          v11 = "UNKNOWN";
      }
      else
      {
        v11 = "ADVANCED";
      }
    }
    else
    {
      v11 = "INIT";
    }
    sub_1DA38(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x38u, (__int64)&unk_5CE08, a1, a3, a4, v11);
    v8 = off_60148;
  }
  if ( a1 && a3 && a4 )
  {
    if ( a2 == 1 )
    {
      if ( !*a4 )
        goto LABEL_23;
      *a3 = *a4;
      *a4 = (_QWORD *)**a4;
    }
    else if ( a2 == 2 )
    {
      if ( !*a3 )
        goto LABEL_23;
      *a4 = (_QWORD *)*a3;
      *a3 = 0i64;
    }
    else
    {
      *a3 = 0i64;
      *a4 = *(_QWORD **)(a1 + 8);
    }
    v8 = off_60148;
LABEL_23:
    if ( v8 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v8->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      if ( a2 )
      {
        v12 = a2 - 1;
        if ( v12 )
        {
          if ( v12 == 1 )
            v9 = "RETREATED";
        }
        else
        {
          v9 = "ADVANCED";
        }
      }
      else
      {
        v9 = "INIT";
      }
      sub_1DA38(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x3Au, (__int64)&unk_5CE08, a1, a3, a4, v9);
    }
    return 0i64;
  }
  if ( v8 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v8->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_385D4(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x39u, (__int64)&unk_5CE08, a1, a3, a4);
  }
  return 4i64;
}

//----- (000000000001ED14) ----------------------------------------------------
__int64 __fastcall sub_1ED14(__int64 a1, unsigned int a2)
{
  __int64 result; // rax
  _QWORD *v5; // rsi
  unsigned int v6; // edi
  int v7; // eax

  if ( a1 )
  {
    v5 = sub_48CA0(_InterlockedCompareExchange64(&qword_61270, 0i64, 0i64), 128, (__int64)sub_1EECC, (__int64)sub_1FF94);
    if ( v5 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_1D8D0(
          off_60148->Dpc.ProcessorHistory,
          0x3Du,
          (__int64)&unk_5CE08,
          a1,
          *(_QWORD *)(a1 + 16),
          *(_DWORD *)(a1 + 32),
          a2);
      }
      *v5 = a1;
      v7 = sub_48F24((__int64)v5, a2);
      v6 = v7;
      if ( v7 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x10u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_112FC(off_60148->Dpc.ProcessorHistory, 0x3Eu, (__int64)&unk_5CE08, v7);
        }
        sub_48E4C((__int64)v5, 0);
      }
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x3Cu, (__int64)&unk_5CE08);
      }
      v6 = 3;
    }
    result = v6;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x12u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x3Bu, (__int64)&unk_5CE08, 0i64);
    }
    result = 4i64;
  }
  return result;
}
// 61270: using guessed type __int64 qword_61270;

//----- (000000000001EECC) ----------------------------------------------------
__int64 __fastcall sub_1EECC(__int64 *a1)
{
  int v2; // er14
  PDEVICE_OBJECT v3; // rcx
  __int64 result; // rax
  __int64 v5; // rdi
  unsigned __int16 v6; // dx
  PDEVICE_OBJECT *v7; // rsi
  PDEVICE_OBJECT v8; // r12
  PDEVICE_OBJECT v9; // rcx
  PDEVICE_OBJECT v10; // rcx
  PDEVICE_OBJECT *v11; // rbp
  PDEVICE_OBJECT v12; // rcx
  int v13; // [rsp+70h] [rbp+8h] BYREF
  PDEVICE_OBJECT *v14; // [rsp+78h] [rbp+10h] BYREF

  v2 = 0;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x3Fu, (__int64)&unk_5CE08, a1);
    v3 = off_60148;
  }
  if ( a1 )
  {
    v5 = *a1;
    if ( !*a1 )
    {
      if ( v3 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
        || BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        return result;
      }
      v6 = 65;
      return sub_11008(*(_QWORD *)&v3->DeviceLock.Header.Lock, v6, (__int64)&unk_5CE08);
    }
    if ( dword_6126C )
    {
      if ( v3 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
        && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11008(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x42u, (__int64)&unk_5CE08);
      }
LABEL_74:
      result = sub_20824(v5);
      v3 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
        || BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
        return result;
      }
      v6 = 78;
      return sub_11008(*(_QWORD *)&v3->DeviceLock.Header.Lock, v6, (__int64)&unk_5CE08);
    }
    if ( dword_65448 == 2 )
    {
      if ( v3 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v3->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_1182C(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x43u, (__int64)&unk_5CE08, "AFTER_NBL_UNENQUEUE");
      }
      goto LABEL_74;
    }
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11230(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x44u, (__int64)&unk_5CE08, v5, *(_DWORD *)(v5 + 32));
    }
    v7 = *(PDEVICE_OBJECT **)(v5 + 16);
    v14 = v7;
    while ( 1 )
    {
      while ( 1 )
      {
        if ( !v7 )
          goto LABEL_74;
        v13 = 1;
        v8 = *v7;
        *(_QWORD *)(v5 + 104) = v14;
        *(_QWORD *)(v5 + 96) = v7;
        ++v2;
        v9 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
            && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_11430(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x45u, (__int64)&unk_5CE08, v2);
            v9 = off_60148;
          }
          if ( v9 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
            && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_385D4(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x46u, (__int64)&unk_5CE08, v14, v7, v8);
          }
        }
        sub_1F3F0((__int64)v7, v5, &v13);
        if ( !v13 )
          break;
        if ( v13 == 1 )
        {
          v10 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
            && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_11008(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x47u, (__int64)&unk_5CE08);
            v10 = off_60148;
          }
          v14 = v7;
        }
        else
        {
          if ( v13 != 2 )
          {
            v10 = off_60148;
            goto LABEL_69;
          }
          v10 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
            && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_1D47C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x4Cu, (__int64)&unk_5CE08, *(_DWORD *)(v5 + 32));
            v10 = off_60148;
          }
        }
        v7 = (PDEVICE_OBJECT *)v8;
LABEL_69:
        if ( v10 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v10->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
          && BYTE1(v10->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_11430(*(_QWORD *)&v10->DeviceLock.Header.Lock, 0x4Du, (__int64)&unk_5CE08, v2);
        }
      }
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_1D47C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x48u, (__int64)&unk_5CE08, *(_DWORD *)(v5 + 32));
      }
      sub_21A08(v5 + 16, &v14, v7);
      v11 = v7;
      v7 = (PDEVICE_OBJECT *)v8;
      v12 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
          && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_11148(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x49u, (__int64)&unk_5CE08, *(_DWORD *)(v5 + 32));
          v12 = off_60148;
        }
        if ( v12 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v12->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
          && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_1D47C(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x4Au, (__int64)&unk_5CE08, *(_DWORD *)(v5 + 56));
        }
      }
      sub_21AB0(v5 + 40, v11);
      v10 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
          && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_11148(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x4Bu, (__int64)&unk_5CE08, *(_DWORD *)(v5 + 56));
          v10 = off_60148;
        }
        goto LABEL_69;
      }
    }
  }
  if ( v3 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    result = sub_2F80C(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x40u, (__int64)&unk_5CE08, 0i64);
  }
  return result;
}
// 6126C: using guessed type int dword_6126C;
// 65448: using guessed type int dword_65448;

//----- (000000000001F3F0) ----------------------------------------------------
__int64 __fastcall sub_1F3F0(__int64 a1, __int64 a2, _DWORD *a3)
{
  unsigned int v3; // edi
  int v7; // esi
  PDEVICE_OBJECT v8; // r10
  unsigned int v9; // eax
  struct _NET_BUFFER *v10; // rbx
  __int64 *v11; // rax
  __int64 v12; // rsi
  __int64 v13; // r14
  PDEVICE_OBJECT v14; // rcx
  __int64 v15; // rdx
  PDEVICE_OBJECT v16; // rcx
  ULONG_PTR v17; // rcx
  int v18; // edx
  const char *v19; // rax
  __int64 v20; // r10
  int v21; // eax
  int v22; // eax
  int v23; // edi
  __int64 v25; // [rsp+20h] [rbp-68h]
  __int64 v26; // [rsp+28h] [rbp-60h]
  int v27; // [rsp+40h] [rbp-48h] BYREF
  int v28; // [rsp+44h] [rbp-44h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+48h] [rbp-40h] BYREF
  char v30; // [rsp+90h] [rbp+8h]
  int v31; // [rsp+A8h] [rbp+20h]

  v3 = 0;
  v7 = 0;
  v30 = 1;
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x4Fu, (__int64)&unk_5CE08, a1, a2);
    v8 = off_60148;
  }
  if ( !a1 || !a2 || !a3 )
  {
    if ( v8 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v8->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_385D4(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x50u, (__int64)&unk_5CE08, a1, a2, a3);
      v8 = off_60148;
    }
    v3 = 4;
    goto LABEL_145;
  }
  *a3 = 1;
  if ( (*(_BYTE *)(a2 + 88) & 1) == 0 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x51u, (__int64)&unk_5CE08, a2);
    }
    v9 = sub_1EB34(*(_QWORD *)(a2 + 96), 0, (_QWORD *)(a2 + 120), (_QWORD **)(a2 + 112));
    v3 = v9;
    if ( v9 )
    {
      v8 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return v3;
      if ( (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
        || BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        goto LABEL_145;
      }
      LODWORD(v25) = v9;
      sub_11230(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x52u, (__int64)&unk_5CE08, a2, v25);
      goto LABEL_18;
    }
  }
  v10 = *(struct _NET_BUFFER **)(a2 + 112);
  if ( !v10 )
  {
LABEL_18:
    v8 = off_60148;
LABEL_145:
    if ( v8 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(v8->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
        && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        LODWORD(v26) = v7;
        sub_1D878(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x67u, (__int64)&unk_5CE08, a2, *(_QWORD *)(a2 + 96), v26);
        v8 = off_60148;
      }
      if ( v8 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v8->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
        && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x68u, (__int64)&unk_5CE08);
      }
    }
    return v3;
  }
  while ( 1 )
  {
    v27 = 0;
    BugCheckParameter1 = 0i64;
    v31 = v7 + 1;
    v11 = (__int64 *)sub_20CB4(a2, v10);
    v12 = (__int64)v11;
    if ( !v11 )
      break;
    v13 = *v11;
    v14 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        HIDWORD(v26) = HIDWORD(a2);
        HIDWORD(v25) = HIDWORD(*v11);
        sub_1D3F8(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 84i64, (__int64)&unk_5CE08, v31);
        v14 = off_60148;
      }
      if ( v14 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v14->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
        && BYTE1(v14->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_2F80C(*(_QWORD *)&v14->DeviceLock.Header.Lock, 0x55u, (__int64)&unk_5CE08, a2);
      }
    }
    v3 = sub_1EB34(*(_QWORD *)(a2 + 96), 1, (_QWORD *)(a2 + 120), (_QWORD **)(a2 + 112));
    if ( v3 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        LODWORD(v25) = v3;
        sub_11230(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x56u, (__int64)&unk_5CE08, a2, v25);
      }
LABEL_158:
      sub_20F00((_QWORD *)v12);
LABEL_143:
      v8 = off_60148;
LABEL_144:
      v7 = v31;
      goto LABEL_145;
    }
    sub_255AC((__int64 *)v12, 0);
    if ( (unsigned int)sub_236BC((unsigned __int64 *)v12, (ULONG_PTR **)&BugCheckParameter1, 1) )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x57u, (__int64)&unk_5CE08, v12);
      }
      goto LABEL_158;
    }
    sub_255AC((__int64 *)v12, v3 + 1);
    if ( (*(_BYTE *)(v12 + 120) & 4) != 0 )
    {
      sub_17784(v12);
      sub_17548(v12, *(_QWORD *)(a2 + 72));
    }
    if ( sub_19D94(v12, v15) )
    {
      _InterlockedAdd64(&qword_61348, 1ui64);
      if ( (*(_BYTE *)(v12 + 120) & 4) != 0 )
        sub_4ED98(v12, "|INTEGRITY_BROKEN|", 0x12ui64);
      v8 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_1D9CC(
          *(_QWORD *)&off_60148->DeviceLock.Header.Lock,
          100i64,
          (__int64)&unk_5CE08,
          a2,
          *(_QWORD *)(a2 + 96),
          v10,
          v13);
        goto LABEL_107;
      }
    }
    else
    {
      if ( (*(_BYTE *)(v12 + 120) & 1) != 0 && (*(_BYTE *)(v12 + 120) & 0x10) == 0 )
      {
        v28 = 2;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
          && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x58u, (__int64)&unk_5CE08, v13);
        }
        *a3 = 2;
        v21 = sub_210F8(v12, a2);
        if ( v21 )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
            && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
          {
            HIDWORD(v26) = HIDWORD(v13);
            sub_1D34C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 91i64, (__int64)&unk_5CE08, v21);
          }
          v23 = 1;
        }
        else
        {
          v22 = sub_21CF0((_QWORD *)v12, BugCheckParameter1, &v28);
          if ( v22 )
          {
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
              && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
            {
              sub_11148(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x59u, (__int64)&unk_5CE08, v22);
            }
            v23 = v28;
          }
          else
          {
            v23 = v28;
            if ( v28 )
            {
              if ( v28 == 2 )
              {
                sub_1CA88(v12, 29);
                sub_17238(v12, 0);
              }
              else if ( v28 == 1 )
              {
                sub_1CA88(v12, 30);
              }
            }
            else
            {
              if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
                && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
              {
                sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, v28 + 90, (__int64)&unk_5CE08, v13);
              }
              sub_1CA88(v12, 31);
            }
          }
        }
        sub_40598((PFAST_MUTEX)(v12 + 152));
        *(_DWORD *)(v12 + 208) = v23;
        sub_40664((PFAST_MUTEX)(v12 + 152));
        if ( BugCheckParameter1 )
          sub_243C4(BugCheckParameter1, 2);
        v3 = 0;
        goto LABEL_143;
      }
      sub_2422C(BugCheckParameter1, 3);
      v16 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11008(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x5Cu, (__int64)&unk_5CE08);
        v16 = off_60148;
      }
      if ( dword_65448 == 3 )
      {
        if ( v16 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v16->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
          && BYTE1(v16->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_1182C(*(_QWORD *)&v16->DeviceLock.Header.Lock, 0x5Du, (__int64)&unk_5CE08, "BEFORE_NWP_PROCESS");
        }
        *a3 = 1;
        v27 = 3;
        if ( (*(_BYTE *)(v12 + 120) & 4) != 0 )
          sub_17354(v12, 3);
        v17 = BugCheckParameter1;
        if ( BugCheckParameter1 )
        {
          v18 = 16;
          goto LABEL_49;
        }
        goto LABEL_107;
      }
      v3 = sub_200B4((PVOID)v12, &v27);
      if ( v3 )
      {
        v27 = 3;
        *a3 = 1;
        if ( (*(_BYTE *)(v12 + 120) & 4) != 0 )
          sub_4ED98(v12, "UNABLE TO PUBLISH PACKET IN ANALYSIS PIPELINE-PASS", 0x32ui64);
        if ( BugCheckParameter1 )
          sub_243C4(BugCheckParameter1, 5);
        v8 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
          && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          HIDWORD(v26) = HIDWORD(a2);
          HIDWORD(v25) = HIDWORD(v13);
          sub_1D2C8(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 94i64, (__int64)&unk_5CE08, v3);
          goto LABEL_107;
        }
      }
      else
      {
        v8 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
          && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          v19 = sub_4D7E8(v27);
          sub_1D620(*(_QWORD *)(v20 + 280), 95i64, (__int64)&unk_5CE08, v13, v19, a2, *(_QWORD *)(a2 + 96), v10);
          v8 = off_60148;
        }
        if ( (unsigned __int16)v27 == 4 )
        {
          if ( _bittest(&v27, 0x1Eu) )
          {
            if ( v8 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(v8->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
              && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              sub_2F80C(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x60u, (__int64)&unk_5CE08, v13);
            }
            *a3 = 2;
            v30 = 0;
            v3 = sub_210F8(v12, a2);
            if ( v3 )
            {
              if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
                && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
              {
                sub_112FC(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x61u, (__int64)&unk_5CE08, v3);
              }
              *a3 = 1;
              v8 = off_60148;
              v30 = 1;
LABEL_109:
              v10 = (struct _NET_BUFFER *)v10->Link.Alignment;
              goto LABEL_77;
            }
LABEL_75:
            v8 = off_60148;
            goto LABEL_76;
          }
          if ( (unsigned __int16)v27 == 4 )
            goto LABEL_97;
        }
        if ( (unsigned __int16)v27 == 2 )
        {
LABEL_97:
          if ( v8 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(v8->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
            && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_2F80C(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x62u, (__int64)&unk_5CE08, v13);
          }
          v17 = BugCheckParameter1;
          *a3 = 0;
          v30 = 0;
          if ( !v17 )
            goto LABEL_75;
          v18 = 6;
LABEL_49:
          sub_243C4(v17, v18);
LABEL_107:
          v8 = off_60148;
          goto LABEL_108;
        }
        if ( v8 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v8->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
          && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_2F80C(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x63u, (__int64)&unk_5CE08, v13);
          v8 = off_60148;
        }
        v17 = BugCheckParameter1;
        if ( BugCheckParameter1 )
        {
          v18 = 7;
          goto LABEL_49;
        }
      }
    }
LABEL_108:
    if ( v30 )
      goto LABEL_109;
LABEL_76:
    v10 = 0i64;
LABEL_77:
    if ( BugCheckParameter1 )
    {
      if ( *a3 != 2 )
      {
        sub_18E4C(v12);
        _InterlockedCompareExchange((volatile signed __int32 *)(v12 + 216), 1, 0);
        v8 = off_60148;
      }
      if ( v8 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v8->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
        && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_2F80C(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x65u, (__int64)&unk_5CE08, v13);
      }
      sub_243C4(BugCheckParameter1, 2);
      v8 = off_60148;
    }
    else if ( v8 != (PDEVICE_OBJECT)&off_60148
           && (BYTE4(v8->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
           && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x66u, (__int64)&unk_5CE08);
      v8 = off_60148;
    }
    v7 = v31;
    if ( !v10 )
      goto LABEL_145;
  }
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_385D4(
        *(_QWORD *)&off_60148->DeviceLock.Header.Lock,
        0x53u,
        (__int64)&unk_5CE08,
        a2,
        *(_QWORD *)(a2 + 96),
        v10);
      goto LABEL_143;
    }
    goto LABEL_144;
  }
  return v3;
}
// 1F532: variable 'v25' is possibly undefined
// 1F68B: variable 'v15' is possibly undefined
// 1F883: variable 'v20' is possibly undefined
// 1FDE4: variable 'v26' is possibly undefined
// 61348: using guessed type __int64 qword_61348;
// 65448: using guessed type int dword_65448;

//----- (000000000001FF94) ----------------------------------------------------
__int64 __fastcall sub_1FF94(__int64 *a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 result; // rax

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x69u, (__int64)&unk_5CE08, a1);
    v2 = off_60148;
  }
  if ( !a1 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      result = sub_2F80C(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x6Au, (__int64)&unk_5CE08, 0i64);
    }
    return result;
  }
  if ( *a1 )
  {
    result = sub_20824(*a1);
  }
  else
  {
    if ( v2 == (PDEVICE_OBJECT)&off_60148 )
      return result;
    if ( (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      goto LABEL_17;
    }
    result = sub_11008(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x6Bu, (__int64)&unk_5CE08);
  }
  v2 = off_60148;
LABEL_17:
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_11008(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x6Cu, (__int64)&unk_5CE08);
  }
  return result;
}

//----- (00000000000200B4) ----------------------------------------------------
__int64 __fastcall sub_200B4(PVOID StartContext, int *a2)
{
  unsigned int v2; // er13
  PDEVICE_OBJECT v5; // rcx
  const char *v6; // rax
  __int64 v7; // r10
  int v8; // eax
  PDEVICE_OBJECT v9; // r10
  const char *v10; // rax
  __int64 v11; // r10
  int v12; // er8
  const char *v13; // rax
  __int64 v14; // r10
  int v15; // esi
  int v16; // edx
  int v17; // ecx
  int v18; // ecx
  const char *v19; // rax
  __int64 v20; // r10
  unsigned __int16 v21; // dx
  __int64 v23; // [rsp+20h] [rbp-48h]
  __int64 v24; // [rsp+28h] [rbp-40h]
  char v25; // [rsp+70h] [rbp+8h] BYREF
  int v26; // [rsp+78h] [rbp+10h] BYREF

  v2 = 0;
  v25 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x6Du, (__int64)&unk_5CE08);
  }
  *a2 = 3;
  if ( StartContext )
  {
    if ( dword_65408 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x6Fu, (__int64)&unk_5CE08);
      }
      sub_1B63C((__int64)StartContext, 0, &v26);
      if ( v26 == 2 )
      {
        *((_DWORD *)StartContext + 30) |= 0x1000u;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x70u, (__int64)&unk_5CE08);
        }
      }
    }
    sub_19248((__int64)StartContext, &v25);
    if ( v25 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x71u, (__int64)&unk_5CE08, *(_QWORD *)StartContext);
      }
      *a2 = 3;
      if ( (*((_BYTE *)StartContext + 120) & 4) != 0 )
        sub_4ED98((__int64)StartContext, "|LOOPBACK|", 0xAui64);
      v5 = off_60148;
      goto LABEL_103;
    }
    if ( *((_DWORD *)StartContext + 95) == 2 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xBu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x72u, (__int64)&unk_5CE08);
      }
      if ( dword_65430 == 1 )
      {
        v2 = sub_2F598((__int64)StartContext, a2);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xBu)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          v6 = sub_4D7E8(*a2);
          sub_116CC(*(_QWORD *)(v7 + 216), 0x73u, (__int64)&unk_5CE08, *(_QWORD *)StartContext, v6, v2);
        }
        sub_17448((__int64)StartContext, *a2);
      }
    }
    v8 = (unsigned __int16)*a2;
    if ( v8 == 4 || v8 == 2 )
    {
LABEL_73:
      sub_40598((PFAST_MUTEX)((char *)StartContext + 152));
      v15 = *((_DWORD *)StartContext + 53);
      sub_40664((PFAST_MUTEX)((char *)StartContext + 152));
      if ( v15 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x7Au, (__int64)&unk_5CE08, *(_QWORD *)StartContext);
        }
        *a2 = 1073741828;
        v15 = 1;
        v16 = 41;
      }
      else
      {
        if ( *(_WORD *)a2 != 4 || !_bittest(a2, 0x1Eu) )
        {
LABEL_87:
          sub_40598((PFAST_MUTEX)((char *)StartContext + 152));
          v17 = *((_DWORD *)StartContext + 52);
          *((_DWORD *)StartContext + 53) = v15;
          if ( v17 )
          {
            if ( off_60148 == (PDEVICE_OBJECT)&off_60148
              || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
              || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
            {
              goto LABEL_97;
            }
            v19 = sub_4D7E8(v17);
            v21 = 125;
          }
          else
          {
            v18 = *a2;
            *((_DWORD *)StartContext + 52) = *a2;
            if ( off_60148 == (PDEVICE_OBJECT)&off_60148
              || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
              || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
            {
              goto LABEL_97;
            }
            v19 = sub_4D7E8(v18);
            v21 = 124;
          }
          sub_1182C(*(_QWORD *)(v20 + 216), v21, (__int64)&unk_5CE08, v19);
LABEL_97:
          sub_40664((PFAST_MUTEX)((char *)StartContext + 152));
          sub_17238((__int64)StartContext, 0);
          v5 = off_60148;
          goto LABEL_103;
        }
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xAu)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x7Bu, (__int64)&unk_5CE08);
        }
        v15 = 2;
        v16 = 46;
      }
      sub_1CA88((__int64)StartContext, v16);
      goto LABEL_87;
    }
    if ( !sub_251F4(StartContext, a2) )
    {
      sub_39DF4(40000i64, (__int64)StartContext, 400i64, 0i64, a2);
      if ( *a2 == 3 )
      {
        v9 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        {
LABEL_60:
          if ( v2 )
          {
            if ( (unsigned int)dword_622E4 > 0xA )
            {
              _InterlockedAdd((volatile signed __int32 *)P + 10, 1u);
              v9 = off_60148;
            }
            if ( v9 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
              && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 2u )
            {
              LODWORD(v23) = v2;
              sub_11230(
                *(_QWORD *)&v9->DeviceLock.Header.Lock,
                0x78u,
                (__int64)&unk_5CE08,
                *(_QWORD *)StartContext,
                v23);
            }
          }
          else
          {
            if ( dword_622E4 )
            {
              _InterlockedAdd((volatile signed __int32 *)P, 1u);
              v9 = off_60148;
            }
            if ( v9 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
              && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              v13 = sub_4D7E8(*a2);
              sub_1164C(*(_QWORD *)(v14 + 280), 0x79u, (__int64)&unk_5CE08, *(_QWORD *)StartContext, v13);
            }
          }
          goto LABEL_73;
        }
        if ( (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
          || BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) < 4u )
        {
LABEL_56:
          if ( v9 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
            && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            v10 = sub_4D7E8(*a2);
            LODWORD(v24) = v12;
            sub_116CC(*(_QWORD *)(v11 + 280), 0x77u, (__int64)&unk_5CE08, *(_QWORD *)StartContext, v10, v24);
            v9 = off_60148;
          }
          goto LABEL_60;
        }
        sub_11008(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x76u, (__int64)&unk_5CE08);
      }
      else
      {
        v9 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
          && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_112FC(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x74u, (__int64)&unk_5CE08, *a2);
          v9 = off_60148;
        }
        if ( dword_65448 == 4 )
        {
          if ( v9 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v9->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
            && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_1182C(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x75u, (__int64)&unk_5CE08, "BEFORE_NWP_NANO_SEND");
            v9 = off_60148;
          }
          if ( (*((_BYTE *)StartContext + 120) & 4) == 0 )
            goto LABEL_56;
          sub_17354((__int64)StartContext, 4);
        }
        else
        {
          v2 = sub_49AEC(
                 40000,
                 StartContext,
                 0x190u,
                 dword_65434,
                 a2,
                 (void (__fastcall *)(const void *, _QWORD))sub_20744);
        }
      }
    }
    v9 = off_60148;
    goto LABEL_56;
  }
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x6Eu, (__int64)&unk_5CE08, 0i64, a2);
    v5 = off_60148;
  }
  v2 = 4;
LABEL_103:
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x7Eu, (__int64)&unk_5CE08);
  }
  return v2;
}
// 202A7: variable 'v7' is possibly undefined
// 20449: variable 'v12' is possibly undefined
// 20442: variable 'v11' is possibly undefined
// 2045B: variable 'v24' is possibly undefined
// 204BB: variable 'v23' is possibly undefined
// 204FF: variable 'v14' is possibly undefined
// 2066C: variable 'v20' is possibly undefined
// 622E4: using guessed type int dword_622E4;
// 65408: using guessed type int dword_65408;
// 65430: using guessed type int dword_65430;
// 65434: using guessed type int dword_65434;
// 65448: using guessed type int dword_65448;

//----- (0000000000020744) ----------------------------------------------------
__int64 __fastcall sub_20744(__int64 a1, __int64 a2)
{
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx

  v4 = 4;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x7Fu, (__int64)&unk_5CE08);
    v5 = off_60148;
  }
  if ( a1 && a2 )
  {
    v4 = 0;
    *(_DWORD *)(a1 + 120) = *(_DWORD *)(a2 + 120);
    *(_QWORD *)(a1 + 132) = *(_QWORD *)(a2 + 132);
    *(_DWORD *)(a1 + 140) = *(_DWORD *)(a2 + 140);
    v5 = off_60148;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x80u, (__int64)&unk_5CE08);
  }
  return v4;
}

//----- (0000000000020824) ----------------------------------------------------
__int64 __fastcall sub_20824(__int64 a1)
{
  unsigned int v1; // edi
  int v3; // eax
  __int64 v4; // r9
  __int64 v5; // rax
  int v6; // er9
  PDEVICE_OBJECT v7; // rcx
  int v8; // er10
  int v9; // eax
  __int64 v10; // r9
  __int64 v11; // rax
  int v12; // er9
  __int64 v14; // [rsp+30h] [rbp-28h] BYREF
  __int64 v15; // [rsp+38h] [rbp-20h]
  __int64 v16; // [rsp+40h] [rbp-18h]
  __int64 v17; // [rsp+48h] [rbp-10h]

  v1 = 0;
  v14 = 0i64;
  v15 = 0i64;
  v16 = 0i64;
  v17 = 0i64;
  if ( a1 )
  {
    if ( !*(_DWORD *)(a1 + 32) )
      goto LABEL_18;
    v3 = *(_DWORD *)(a1 + 64);
    v4 = *(_QWORD *)(a1 + 16);
    LODWORD(v15) = *(_DWORD *)(a1 + 32);
    HIDWORD(v15) = v3;
    v5 = *(_QWORD *)(a1 + 80);
    v14 = v4;
    v17 = v5;
    LODWORD(v16) = 1;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11230(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x82u, (__int64)&unk_5CE08);
    }
    v6 = sub_1DE00(2i64, (__int64)&v14);
    if ( v6 )
    {
      v7 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11148(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x83u, (__int64)&unk_5CE08, v6);
        v7 = off_60148;
      }
      v1 = 11;
    }
    else
    {
LABEL_18:
      v7 = off_60148;
    }
    v8 = *(_DWORD *)(a1 + 56);
    if ( v8 )
    {
      v9 = *(_DWORD *)(a1 + 64);
      v10 = *(_QWORD *)(a1 + 40);
      LODWORD(v16) = 0;
      HIDWORD(v15) = v9;
      v11 = *(_QWORD *)(a1 + 80);
      v14 = v10;
      v17 = v11;
      LODWORD(v15) = v8;
      if ( v7 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11230(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x84u, (__int64)&unk_5CE08);
      }
      v12 = sub_1DE00(2i64, (__int64)&v14);
      if ( v12 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
          && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_11148(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x85u, (__int64)&unk_5CE08, v12);
        }
        v1 = 11;
      }
    }
    sub_1E9C4(a1);
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x81u, (__int64)&unk_5CE08, 0i64);
    }
    v1 = 4;
  }
  return v1;
}

//----- (0000000000020A64) ----------------------------------------------------
__int64 __fastcall sub_20A64(_QWORD *a1, unsigned int a2)
{
  unsigned int v2; // esi
  __int64 *v5; // rbx
  unsigned int v6; // ebp
  unsigned int v7; // ebp

  v2 = 0;
  if ( a1 )
  {
    if ( (a1[15] & 2) != 0 )
    {
      sub_40598((PFAST_MUTEX)(a1 + 19));
      v6 = *((_DWORD *)a1 + 52);
      sub_40664((PFAST_MUTEX)(a1 + 19));
      if ( (unsigned __int16)v6 == 2 || (unsigned __int16)v6 == 4 )
        v7 = (v6 >> 29) & 2;
      else
        v7 = 1;
      sub_21254(a1, v7, a2);
    }
    else
    {
      v5 = *(__int64 **)((char *)a1 + 220);
      if ( v5 )
      {
        if ( _InterlockedCompareExchange((volatile signed __int32 *)a1 + 54, 1, 0) )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
            && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
          {
            sub_1D3B0(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x8Fu, (__int64)&unk_5CE08, a1, *a1);
          }
        }
        else if ( *v5 )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
            && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_1D4DC(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 141i64, (__int64)&unk_5CE08, *a1, *v5);
          }
          sub_20824(*v5);
          a1[2] = 0i64;
          *v5 = 0i64;
        }
        else
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
            && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x8Eu, (__int64)&unk_5CE08, *a1);
          }
          _InterlockedAdd((volatile signed __int32 *)a1 + 54, 0xFFFFFFFF);
        }
      }
      else
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x8Cu, (__int64)&unk_5CE08, *a1);
        }
        v2 = 6;
      }
    }
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x8Bu, (__int64)&unk_5CE08, 0i64);
    }
    v2 = 4;
  }
  return v2;
}
// 21254: using guessed type __int64 __fastcall sub_21254(_QWORD, _QWORD, _QWORD);

//----- (0000000000020CB4) ----------------------------------------------------
__int64 __fastcall sub_20CB4(__int64 a1, struct _NET_BUFFER *a2)
{
  __int64 v2; // rbx
  __int64 v3; // rdi
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx
  bool v7; // zf
  int v8; // er9
  __int64 v9; // rdx
  int v10; // ecx
  __int64 v11; // rax
  unsigned int v12; // edx
  __int64 v13; // rcx
  int v14; // ecx
  __int64 v16; // [rsp+40h] [rbp+8h] BYREF

  v2 = 0i64;
  v3 = 0i64;
  if ( !a1 || !a2 )
  {
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return v2;
    }
    sub_1D3B0(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x90u, (__int64)&unk_5CE08, a1, a2);
    goto LABEL_24;
  }
  v3 = sub_21490(a1, a2);
  if ( !v3 )
  {
    v5 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      v6 = 145;
LABEL_8:
      sub_11008(*(_QWORD *)&v5->DeviceLock.Header.Lock, v6, (__int64)&unk_5CE08);
      goto LABEL_24;
    }
    goto LABEL_24;
  }
  v7 = *(_DWORD *)(a1 + 64) == 1;
  v8 = **(_DWORD **)(a1 + 72);
  v9 = *(_QWORD *)(v3 + 8);
  v10 = *(_DWORD *)(v3 + 16);
  v16 = MEMORY[0xFFFFF78000000014];
  v11 = sub_1820C(v10, v9, &v16, v8, v7);
  v2 = v11;
  if ( !v11 )
  {
    v5 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      v6 = 146;
      goto LABEL_8;
    }
LABEL_24:
    if ( v3 )
      sub_215D0(v3);
    return v2;
  }
  v12 = *(_DWORD *)(v11 + 124);
  v13 = *(_QWORD *)(v11 + 16);
  *(_QWORD *)(v11 + 220) = v3;
  sub_431D0(v13, v12, (__int64 *)(v11 + 24));
  if ( sub_25EF8(v2) )
    *(_DWORD *)(v2 + 120) |= 1u;
  *(_DWORD *)(v2 + 120) |= 0x400u;
  *(_DWORD *)(v2 + 128) = 1;
  *(_DWORD *)(v2 + 372) = **(_DWORD **)(a1 + 72);
  *(_DWORD *)(v2 + 380) = *(_DWORD *)(*(_QWORD *)(a1 + 72) + 136i64);
  *(_DWORD *)(v2 + 376) = *(_DWORD *)(*(_QWORD *)(a1 + 72) + 152i64);
  v14 = *(_DWORD *)(*(_QWORD *)(a1 + 72) + 368i64);
  *(_DWORD *)(v2 + 392) = 1;
  *(_DWORD *)(v2 + 396) = v14;
  sub_588AC((void *)(v2 + 384), 6ui64, (const void *)(*(_QWORD *)(a1 + 72) + 140i64), 6ui64);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x93u, (__int64)&unk_5CE08, *(_QWORD *)v2);
  }
  return v2;
}

//----- (0000000000020F00) ----------------------------------------------------
void __fastcall sub_20F00(_QWORD *a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 v3; // rdx

  if ( !a1 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x94u, (__int64)&unk_5CE08, 0i64);
    }
    return;
  }
  if ( (a1[15] & 1) == 0 )
    goto LABEL_11;
  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x95u, (__int64)&unk_5CE08, *a1);
LABEL_11:
    v2 = off_60148;
  }
  if ( (a1[15] & 2) != 0
    && v2 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_2F80C(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x96u, (__int64)&unk_5CE08, *a1);
    v2 = off_60148;
  }
  v3 = *(_QWORD *)((char *)a1 + 132);
  if ( v3 )
  {
    sub_3FAE4((__int64)qword_612B0, v3);
    v2 = off_60148;
  }
  if ( *(_QWORD *)((char *)a1 + 220) )
  {
    sub_215D0(*(_QWORD *)((char *)a1 + 220));
    *(_QWORD *)((char *)a1 + 220) = 0i64;
  }
  else
  {
    if ( (a1[15] & 2) == 0 || !a1[2] )
      goto LABEL_29;
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_2F80C(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x97u, (__int64)&unk_5CE08, *a1);
    }
    sub_3FAE4((__int64)qword_612B8, a1[2]);
  }
  v2 = off_60148;
LABEL_29:
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_2F80C(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x98u, (__int64)&unk_5CE08, *a1);
  }
  sub_3FAE4((__int64)qword_612A8, (__int64)a1);
}

//----- (00000000000210F8) ----------------------------------------------------
__int64 __fastcall sub_210F8(__int64 a1, __int64 a2)
{
  unsigned int v2; // ebx
  _QWORD *v3; // rdi
  _QWORD *v6; // rax

  v2 = 0;
  v3 = 0i64;
  if ( a1 && a2 )
  {
    v3 = sub_1E94C(*(_QWORD *)(a2 + 72), *(_DWORD *)(a2 + 64), *(_QWORD *)(a2 + 80));
    if ( v3 )
    {
      sub_21A08(a2 + 16, (PDEVICE_OBJECT **)(a2 + 104), *(struct _DEVICE_OBJECT ***)(a2 + 96));
      sub_21AB0((__int64)(v3 + 2), *(_QWORD **)(a2 + 96));
      v3[12] = *(_QWORD *)(a2 + 96);
      v3[13] = *(_QWORD *)(a2 + 96);
      v3[14] = *(_QWORD *)(a2 + 112);
      v3[15] = *(_QWORD *)(a2 + 120);
      v6 = *(_QWORD **)(a1 + 220);
      if ( v6 )
      {
        *v6 = v3;
        return v2;
      }
      v2 = 6;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x9Au, (__int64)&unk_5CE08);
      }
      v2 = 3;
    }
  }
  else
  {
    v2 = 4;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_1D3B0(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0x99u, (__int64)&unk_5CE08, a1, a2);
    }
  }
  if ( v3 )
    sub_1E9C4((__int64)v3);
  return v2;
}

//----- (0000000000021254) ----------------------------------------------------
__int64 __fastcall sub_21254(__int64 *a1, int a2, int a3)
{
  _QWORD *v6; // rbx
  PDEVICE_OBJECT v7; // rcx
  __int64 *v8; // rcx
  const char *v9; // rcx
  __int64 v11; // [rsp+28h] [rbp-20h]
  ULONG_PTR BugCheckParameter1; // [rsp+68h] [rbp+20h] BYREF

  BugCheckParameter1 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x9Bu, (__int64)&unk_5CE08, *a1);
  }
  v6 = (_QWORD *)sub_27CDC((__int64)&qword_650A0, *a1, &BugCheckParameter1);
  if ( v6 )
  {
    do
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_1D3B0(off_60148->Dpc.ProcessorHistory, 0x9Du, (__int64)&unk_5CE08, *v6, *a1);
      }
      v8 = *(__int64 **)((char *)v6 + 220);
      if ( v8 )
      {
        sub_1EA38(*v8, a2);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          if ( a2 )
          {
            if ( a2 == 1 )
            {
              v9 = "PASS";
            }
            else if ( a2 == 2 )
            {
              v9 = "PENDING";
            }
            else
            {
              v9 = "UNKNOWN";
            }
          }
          else
          {
            v9 = "DISCARD";
          }
          LODWORD(v11) = a3 == 1;
          sub_116CC(off_60148->Dpc.ProcessorHistory, 0x9Eu, (__int64)&unk_5CE08, *a1, v9, v11);
        }
        if ( a3 == 1 )
          sub_20A64(a1, 1u);
        else
          sub_243C4(BugCheckParameter1, 26);
        sub_243C4(BugCheckParameter1, 20);
      }
      v6 = (_QWORD *)sub_27CDC((__int64)&qword_650A0, *a1, &BugCheckParameter1);
    }
    while ( v6 );
    goto LABEL_31;
  }
  v7 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return 0i64;
  if ( (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x9Cu, (__int64)&unk_5CE08);
LABEL_31:
    v7 = off_60148;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v7->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(v7->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v7->Dpc.ProcessorHistory, 0x9Fu, (__int64)&unk_5CE08);
  }
  return 0i64;
}
// 213E8: variable 'v11' is possibly undefined
// 650A0: using guessed type __int64 qword_650A0;

//----- (0000000000021490) ----------------------------------------------------
__int64 __fastcall sub_21490(__int64 a1, struct _NET_BUFFER *a2)
{
  __int64 v2; // rbx
  _DWORD *v5; // rax
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx

  v2 = 0i64;
  if ( a1 && a2 )
  {
    v5 = sub_3FA7C((__int64)qword_613E0);
    v2 = (__int64)v5;
    if ( v5 )
    {
      *(_QWORD *)v5 = 0i64;
      if ( !(unsigned int)sub_216A0(a2, *(_QWORD *)(a1 + 72), dword_6543C, (__int64)(v5 + 2)) )
        return v2;
      v6 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 2) == 0
        || BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        goto LABEL_14;
      }
      v7 = 162;
    }
    else
    {
      v6 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 2) == 0
        || BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
LABEL_14:
        if ( v2 )
        {
          sub_215D0(v2);
          v2 = 0i64;
        }
        return v2;
      }
      v7 = 161;
    }
    sub_11008(*(_QWORD *)&v6->DeviceLock.Header.Lock, v7, (__int64)&unk_5CE08);
    goto LABEL_14;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
    && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0xA0u, (__int64)&unk_5CE08, a1, a2);
  }
  return v2;
}
// 6543C: using guessed type int dword_6543C;

//----- (00000000000215D0) ----------------------------------------------------
__int64 __fastcall sub_215D0(__int64 a1)
{
  if ( a1 )
  {
    sub_21938(a1 + 8);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0xA4u, (__int64)&unk_5CE08, a1);
    }
    sub_3FAE4((__int64)qword_613E0, a1);
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
         && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0xA3u, (__int64)&unk_5CE08, 0i64);
  }
  return 0i64;
}

//----- (00000000000216A0) ----------------------------------------------------
__int64 __fastcall sub_216A0(PNET_BUFFER NetBuffer, __int64 a2, char a3, __int64 a4)
{
  unsigned int v4; // er13
  __int64 v5; // rdi
  char v6; // r15
  PVOID v11; // rax
  const void *v12; // rsi
  _DWORD *v13; // rax
  void *v14; // rcx
  void *v15; // r8
  ULONG v16; // eax

  v4 = 0;
  v5 = 0i64;
  v6 = 0;
  if ( NetBuffer && a4 )
  {
    v11 = NdisGetDataBuffer(NetBuffer, NetBuffer->DataLength, 0i64, 1u, 0);
    v12 = v11;
    if ( v11 )
    {
      v5 = (__int64)v11;
      if ( (unsigned int)dword_622E4 > 0xC )
        _InterlockedAdd((volatile signed __int32 *)P + 12, 1u);
    }
    else if ( (unsigned int)dword_622E4 > 0xD )
    {
      _InterlockedAdd((volatile signed __int32 *)P + 13, 1u);
    }
    if ( *(_DWORD *)(a2 + 136) != 6 && v11 && !a3 )
    {
LABEL_38:
      *(_QWORD *)a4 = v5;
      v16 = NetBuffer->DataLength;
      *(_DWORD *)(a4 + 8) = v16;
      if ( *(_DWORD *)(a2 + 136) == 6 )
        *(_DWORD *)(a4 + 8) = v16 + 14;
      *(_BYTE *)(a4 + 12) = v6;
      return v4;
    }
    v13 = sub_3FC10((__int64)qword_612B8, NetBuffer->DataLength);
    v5 = (__int64)v13;
    if ( !v13 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0xA6u, (__int64)&unk_5CE08);
      }
      return 3;
    }
    v6 = 1;
    if ( *(_DWORD *)(a2 + 136) == 6 && v12 )
    {
      v14 = (char *)v13 + 14;
    }
    else
    {
      if ( !a3 || !v12 )
      {
LABEL_24:
        v15 = (void *)v5;
        if ( !v12 )
        {
          if ( *(_DWORD *)(a2 + 136) == 6 )
            v15 = (void *)(v5 + 14);
          if ( !NdisGetDataBuffer(NetBuffer, NetBuffer->DataLength, v15, 1u, 0) )
          {
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
              && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
            {
              sub_11008(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0xA7u, (__int64)&unk_5CE08);
            }
            v4 = 12;
            sub_3FAE4((__int64)qword_612B8, v5);
            return v4;
          }
        }
        if ( a3 && (unsigned int)dword_622E4 > 0xE )
          _InterlockedAdd((volatile signed __int32 *)P + 14, 1u);
        if ( *(_DWORD *)(a2 + 136) == 6 )
          sub_197B8(1514i64, v5, a2);
        goto LABEL_38;
      }
      v14 = v13;
    }
    memmove(v14, v12, NetBuffer->DataLength);
    goto LABEL_24;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
    && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0xA5u, (__int64)&unk_5CE08, NetBuffer, a4);
  }
  return v4;
}
// 622E4: using guessed type int dword_622E4;

//----- (0000000000021938) ----------------------------------------------------
__int64 __fastcall sub_21938(__int64 a1)
{
  if ( a1 )
  {
    if ( *(_QWORD *)a1 && *(_BYTE *)(a1 + 12) )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
        && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0xA9u, (__int64)&unk_5CE08, a1);
      }
      sub_3FAE4((__int64)qword_612B8, *(_QWORD *)a1);
    }
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
         && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0xA8u, (__int64)&unk_5CE08, 0i64);
  }
  return 0i64;
}

//----- (0000000000021A08) ----------------------------------------------------
PDEVICE_OBJECT *__fastcall sub_21A08(__int64 a1, PDEVICE_OBJECT **a2, struct _DEVICE_OBJECT **a3)
{
  struct _DEVICE_OBJECT *v3; // r9
  PDEVICE_OBJECT *result; // rax

  if ( a1 && a2 && a3 )
  {
    v3 = *a3;
    if ( *(struct _DEVICE_OBJECT ***)a1 == a3 )
    {
      *a2 = 0i64;
      *(_QWORD *)a1 = v3;
      if ( !v3 )
        *(_QWORD *)(a1 + 8) = 0i64;
    }
    else
    {
      result = *a2;
      **a2 = v3;
      if ( !v3 )
      {
        result = *a2;
        *(_QWORD *)(a1 + 8) = *a2;
      }
    }
    *a3 = 0i64;
    --*(_DWORD *)(a1 + 16);
  }
  else
  {
    result = &off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      result = (PDEVICE_OBJECT *)sub_385D4(
                                   *(_QWORD *)&off_60148->DeviceLock.Header.Lock,
                                   0xAAu,
                                   (__int64)&unk_5CE08,
                                   a1,
                                   *a2,
                                   a3);
    }
  }
  return result;
}

//----- (0000000000021AB0) ----------------------------------------------------
PDEVICE_OBJECT __fastcall sub_21AB0(__int64 a1, _QWORD *a2)
{
  PDEVICE_OBJECT result; // rax

  if ( a1 && a2 )
  {
    *a2 = 0i64;
    if ( *(_QWORD *)a1 )
    {
      result = *(PDEVICE_OBJECT *)(a1 + 8);
      *(_QWORD *)&result->Type = a2;
    }
    else
    {
      *(_QWORD *)a1 = a2;
    }
    ++*(_DWORD *)(a1 + 16);
    *(_QWORD *)(a1 + 8) = a2;
  }
  else
  {
    result = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      result = (PDEVICE_OBJECT)sub_1D3B0(
                                 *(_QWORD *)&off_60148->DeviceLock.Header.Lock,
                                 0xABu,
                                 (__int64)&unk_5CE08,
                                 a1,
                                 a2);
    }
  }
  return result;
}

//----- (0000000000021B30) ----------------------------------------------------
void __fastcall sub_21B30(_QWORD *a1, _QWORD *a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 v5; // rax
  _QWORD *v6; // rcx
  __int64 v7; // [rsp+28h] [rbp-30h]
  __int64 v8; // [rsp+40h] [rbp-18h]

  if ( a1 && a2 )
  {
    v4 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_1D940(
        *(_QWORD *)&off_60148->DeviceLock.Header.Lock,
        0xADu,
        (__int64)&unk_5CE08,
        *a1,
        a1[1],
        *((_DWORD *)a1 + 4),
        *a2,
        a2[1],
        *((_DWORD *)a2 + 4));
      v4 = off_60148;
    }
    v5 = *a1;
    if ( *a1 && *((_DWORD *)a1 + 4) )
    {
      v6 = (_QWORD *)a2[1];
      if ( v6 )
        *v6 = v5;
      else
        *a2 = v5;
      a2[1] = a1[1];
      *((_DWORD *)a2 + 4) += *((_DWORD *)a1 + 4);
      *a1 = 0i64;
      *((_DWORD *)a1 + 4) = 0;
    }
    else
    {
      if ( v4 == (PDEVICE_OBJECT)&off_60148 )
        return;
      if ( (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x40) == 0
        || BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) < 4u )
      {
        goto LABEL_22;
      }
      sub_11008(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0xAEu, (__int64)&unk_5CE08);
    }
    goto LABEL_21;
  }
  v4 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return;
  if ( (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0xACu, (__int64)&unk_5CE08, a1, a2);
LABEL_21:
    v4 = off_60148;
  }
LABEL_22:
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    LODWORD(v8) = *((_DWORD *)a2 + 4);
    LODWORD(v7) = *((_DWORD *)a1 + 4);
    sub_1D940(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0xAFu, (__int64)&unk_5CE08, *a1, a1[1], v7, *a2, a2[1], v8);
  }
}
// 21CD5: variable 'v7' is possibly undefined
// 21CD5: variable 'v8' is possibly undefined

//----- (0000000000021CF0) ----------------------------------------------------
__int64 __fastcall sub_21CF0(_QWORD *a1, ULONG_PTR a2, _DWORD *a3)
{
  __int64 *v6; // rdi
  PDEVICE_OBJECT v8; // rcx
  unsigned int v9; // er13
  __int64 v10; // rbx
  _QWORD *v11; // rbp
  PDEVICE_OBJECT v12; // r10
  const char *v13; // rax
  __int64 v14; // r10
  int v15; // er8
  ULONG_PTR v16; // rcx
  const char *v17; // rax
  __int64 v18; // r10
  int v19; // ebx
  int v20; // edx
  PDEVICE_OBJECT v21; // rcx
  unsigned __int16 v22; // dx
  __int64 v23; // [rsp+20h] [rbp-88h]
  __int64 v24; // [rsp+28h] [rbp-80h]
  char v25[4]; // [rsp+30h] [rbp-78h] BYREF
  int v26; // [rsp+34h] [rbp-74h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+38h] [rbp-70h] BYREF
  int v28; // [rsp+40h] [rbp-68h] BYREF
  PVOID StartContext; // [rsp+48h] [rbp-60h] BYREF
  __int64 v30; // [rsp+50h] [rbp-58h] BYREF
  __int64 v31[2]; // [rsp+58h] [rbp-50h] BYREF
  _BYTE v32[12]; // [rsp+68h] [rbp-40h]
  char v33; // [rsp+74h] [rbp-34h]

  v28 = 0;
  StartContext = 0i64;
  BugCheckParameter1 = 0i64;
  v25[0] = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xC3u, (__int64)&unk_5CE08, *a1);
  }
  v6 = *(__int64 **)((char *)a1 + 220);
  v31[0] = 0i64;
  v31[1] = 0i64;
  *(_QWORD *)v32 = 0i64;
  *(_DWORD *)&v32[8] = 0;
  v33 = 0;
  sub_19248((__int64)a1, v25);
  if ( v25[0] )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(off_60148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_2F80C(*(_QWORD *)&off_60148->DeviceLock.Header.Lock, 0xC4u, (__int64)&unk_5CE08, *a1);
    }
    *a3 = 1;
    if ( (a1[15] & 4) != 0 )
      sub_4ED98((__int64)a1, "|LOOPBACK|", 0xAui64);
    return 0i64;
  }
  sub_2422C(a2, 22);
  sub_17F30(a1, &v28, (char *)v31);
  if ( (unsigned __int16)v28 == 4 || (unsigned __int16)v28 == 2 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xC5u, (__int64)&unk_5CE08, *a1);
    }
    sub_1EA38(*v6, 0);
    if ( a2 )
      sub_243C4(a2, 24);
    *a3 = 0;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xC6u, (__int64)&unk_5CE08, *(_QWORD *)(*v6 + 16));
    }
    return 0i64;
  }
  if ( !sub_25F7C((__int64)&qword_650A0, *(unsigned __int16 *)&v32[7], *(unsigned __int16 *)v32) )
  {
    v8 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xC8u, (__int64)&unk_5CE08);
      v8 = off_60148;
    }
    if ( a2 )
    {
      sub_243C4(a2, 25);
      v8 = off_60148;
    }
    if ( v8 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v8->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(v8->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v8->Dpc.ProcessorHistory, 0xC9u, (__int64)&unk_5CE08);
    }
    v9 = sub_27028(
           (__int64)&qword_650A0,
           a1,
           &v30,
           (ULONG_PTR **)&BugCheckParameter1,
           (__int64 *)&StartContext,
           (__int64)v31);
    if ( v9 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xCAu, (__int64)&unk_5CE08);
      }
      if ( BugCheckParameter1 )
        sub_243C4(BugCheckParameter1, 33);
      return v9;
    }
    sub_2422C(a2, 18);
    v10 = v30;
    if ( !v30 || !BugCheckParameter1 || (v11 = StartContext) == 0i64 )
    {
      v12 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return v9;
      if ( (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) == 0 || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
      {
LABEL_100:
        if ( v12 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v12->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(v12->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(v12->Dpc.ProcessorHistory, 0xD4u, (__int64)&unk_5CE08);
        }
        return v9;
      }
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xD3u, (__int64)&unk_5CE08, *a1);
      goto LABEL_99;
    }
    v26 = 0;
    sub_2422C(BugCheckParameter1, 34);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xCBu, (__int64)&unk_5CE08, v10);
    }
    if ( byte_653E0 == 1 )
      sub_17784((__int64)v11);
    if ( !sub_251F4(v11, &v26) )
      v9 = sub_49AEC(40000, v11, 0x190u, dword_65434, &v26, (void (__fastcall *)(const void *, _QWORD))sub_20744);
    v12 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      v13 = sub_4D7E8(v26);
      LODWORD(v24) = v15;
      sub_116CC(*(_QWORD *)(v14 + 216), 0xCCu, (__int64)&unk_5CE08, *v11, v13, v24);
      v12 = off_60148;
    }
    if ( v9 )
    {
      if ( v12 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v12->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(v12->Dpc.DeferredContext) >= 2u )
      {
        LODWORD(v23) = v9;
        sub_11230(v12->Dpc.ProcessorHistory, 0xCDu, (__int64)&unk_5CE08, *v11, v23);
        v12 = off_60148;
      }
      v16 = BugCheckParameter1;
      if ( !BugCheckParameter1 )
        goto LABEL_100;
      goto LABEL_92;
    }
    if ( v12 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v12->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(v12->Dpc.DeferredContext) >= 4u )
    {
      v17 = sub_4D7E8(v26);
      sub_1164C(*(_QWORD *)(v18 + 216), 0xCEu, (__int64)&unk_5CE08, *v11, v17);
    }
    sub_40598((PFAST_MUTEX)(a1 + 19));
    v19 = *((_DWORD *)a1 + 53);
    sub_40664((PFAST_MUTEX)(a1 + 19));
    if ( v19 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xCFu, (__int64)&unk_5CE08, *v11);
      }
      sub_40598((PFAST_MUTEX)(v11 + 19));
      *((_DWORD *)v11 + 53) = 1;
      *((_DWORD *)v11 + 52) = 1073741828;
      sub_40664((PFAST_MUTEX)(v11 + 19));
      v20 = 41;
LABEL_79:
      sub_1CA88((__int64)v11, v20);
      sub_17238((__int64)v11, 0);
      goto LABEL_93;
    }
    if ( (unsigned __int16)v26 == 4 )
    {
      if ( _bittest(&v26, 0x1Eu) )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= (unsigned __int8)v26 )
        {
          sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xD0u, (__int64)&unk_5CE08, *v11);
        }
        sub_40598((PFAST_MUTEX)(v11 + 19));
        *((_DWORD *)v11 + 53) = 2;
        *((_DWORD *)v11 + 52) = v26;
        sub_40664((PFAST_MUTEX)(v11 + 19));
        v20 = 46;
        goto LABEL_79;
      }
      if ( (unsigned __int16)v26 == 4 )
        goto LABEL_86;
    }
    if ( (unsigned __int16)v26 == 2 )
    {
LABEL_86:
      v21 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        v22 = 209;
        goto LABEL_90;
      }
    }
    else
    {
      v21 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        v22 = 210;
LABEL_90:
        sub_2F80C(v21->Dpc.ProcessorHistory, v22, (__int64)&unk_5CE08, *v11);
        goto LABEL_91;
      }
    }
LABEL_91:
    sub_40598((PFAST_MUTEX)(v11 + 19));
    *((_DWORD *)v11 + 52) = v26;
    sub_40664((PFAST_MUTEX)(v11 + 19));
    v16 = BugCheckParameter1;
    if ( BugCheckParameter1 )
    {
LABEL_92:
      sub_243C4(v16, 35);
LABEL_93:
      if ( BugCheckParameter1 )
        sub_243C4(BugCheckParameter1, 33);
    }
LABEL_99:
    v12 = off_60148;
    goto LABEL_100;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xC7u, (__int64)&unk_5CE08);
  }
  _InterlockedAdd64(&qword_651A8, 1ui64);
  if ( a2 )
    sub_243C4(a2, 24);
  return 530i64;
}
// 220DC: variable 'v15' is possibly undefined
// 220D5: variable 'v14' is possibly undefined
// 220F2: variable 'v24' is possibly undefined
// 22137: variable 'v23' is possibly undefined
// 2217B: variable 'v18' is possibly undefined
// 650A0: using guessed type __int64 qword_650A0;
// 651A8: using guessed type __int64 qword_651A8;
// 653E0: using guessed type char byte_653E0;
// 65434: using guessed type int dword_65434;

//----- (0000000000022510) ----------------------------------------------------
__int64 __fastcall sub_22510(__int64 a1, _BYTE *a2)
{
  __int64 *v4; // r15
  unsigned int v5; // er14
  int v6; // er13
  int v7; // er14
  PDEVICE_OBJECT v8; // rdi
  int v9; // er13
  const char *v10; // r9
  const char *v11; // r8
  __int64 v12; // r13
  unsigned __int16 v13; // dx
  unsigned int v14; // eax
  unsigned int v15; // eax
  int v16; // ecx
  __int64 v17; // [rsp+20h] [rbp-78h]
  bool v18; // [rsp+40h] [rbp-58h]
  unsigned int v19; // [rsp+44h] [rbp-54h]
  __int64 v21[2]; // [rsp+50h] [rbp-48h] BYREF

  v19 = 0;
  v21[0] = a1;
  if ( a1 )
  {
    v4 = *(__int64 **)(a1 + 220);
    sub_40598((PFAST_MUTEX)(a1 + 152));
    v5 = *(_DWORD *)(a1 + 208);
    v6 = *(_DWORD *)(a1 + 212);
    sub_40664((PFAST_MUTEX)(a1 + 152));
    if ( (unsigned __int16)v5 == 2 || (unsigned __int16)v5 == 4 )
      v7 = (v5 >> 29) & 2;
    else
      v7 = 1;
    v18 = v6 == 2;
    v8 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 0x80) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
    {
      v12 = v21[0];
    }
    else
    {
      if ( v6 )
      {
        v9 = v6 - 1;
        if ( v9 )
        {
          if ( v9 == 1 )
            v10 = "PROTECTOR";
          else
            v10 = "UNKNOWN";
        }
        else
        {
          v10 = "CONTEXT";
        }
      }
      else
      {
        v10 = "NONE";
      }
      if ( v7 )
      {
        if ( v7 == 1 )
          v11 = "PASS";
        else
          v11 = "PENDING";
      }
      else
      {
        v11 = "DISCARD";
      }
      v12 = v21[0];
      sub_1D530(
        off_60148->Dpc.ProcessorHistory,
        214i64,
        (__int64)&unk_5CE08,
        *(_QWORD *)v21[0],
        *v4,
        *(_QWORD *)(*v4 + 16),
        v11,
        v10);
      v8 = off_60148;
    }
    if ( !*v4 )
    {
      if ( v8 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v8->Dpc.DeferredContext) & 0x80) != 0
        && BYTE1(v8->Dpc.DeferredContext) >= 3u )
      {
        sub_11008(v8->Dpc.ProcessorHistory, 0xD7u, (__int64)&unk_5CE08);
        v8 = off_60148;
      }
      v19 = 6;
      goto LABEL_77;
    }
    *a2 = 0;
    if ( !v7 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x80) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xD8u, (__int64)&unk_5CE08);
      }
      sub_1EA38(*v4, 0);
      goto LABEL_76;
    }
    sub_1EA38(*v4, 1);
    if ( (*(_BYTE *)(v12 + 120) & 2) != 0 )
    {
      v8 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( (BYTE4(off_60148->Dpc.DeferredContext) & 0x80) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
        {
          v13 = 217;
LABEL_40:
          sub_11008(v8->Dpc.ProcessorHistory, v13, (__int64)&unk_5CE08);
LABEL_76:
          v8 = off_60148;
          goto LABEL_77;
        }
        goto LABEL_77;
      }
      return v19;
    }
    if ( v18 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x80) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xDAu, (__int64)&unk_5CE08, *v4);
      }
      v14 = sub_1EB34(*(_QWORD *)(*v4 + 96), 2, (_QWORD *)(*v4 + 120), (_QWORD **)(*v4 + 112));
      v19 = v14;
      if ( v14 )
      {
        v8 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( (BYTE4(off_60148->Dpc.DeferredContext) & 0x80) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
          {
            LODWORD(v17) = v14;
            sub_11230(off_60148->Dpc.ProcessorHistory, 0xDBu, (__int64)&unk_5CE08, *v4, v17);
            goto LABEL_76;
          }
          goto LABEL_77;
        }
        return v19;
      }
      v8 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148->Dpc.DeferredContext) & 0x80) == 0
        || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_56;
      }
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xDCu, (__int64)&unk_5CE08, *v4);
    }
    v8 = off_60148;
LABEL_56:
    if ( *(_QWORD *)(*v4 + 112) )
    {
      if ( v8 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v8->Dpc.DeferredContext) & 0x80) != 0
        && BYTE1(v8->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v8->Dpc.ProcessorHistory, 0xDEu, (__int64)&unk_5CE08);
      }
      *(_DWORD *)(*v4 + 88) |= 1u;
      v15 = sub_14594(v12 + 24, dword_653F0);
      v16 = sub_1ED14(*v4, v15);
      v19 = v16;
      if ( !v16 )
      {
        sub_173D4(v12);
        sub_587C8((char *)v21, 0x10ui64, "|REENQUEUED|");
        sub_4ED98(v12, v21, strlen((const char *)v21));
        sub_18E4C(v12);
        _InterlockedCompareExchange((volatile signed __int32 *)(v12 + 216), 1, 0);
        *a2 = 1;
        goto LABEL_76;
      }
      v8 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( (BYTE4(off_60148->Dpc.DeferredContext) & 0x80) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_11148(off_60148->Dpc.ProcessorHistory, 0xDFu, (__int64)&unk_5CE08, v16);
          goto LABEL_76;
        }
        goto LABEL_77;
      }
    }
    else if ( v8 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(v8->Dpc.DeferredContext) & 0x80) != 0 && BYTE1(v8->Dpc.DeferredContext) >= 4u )
      {
        v13 = 221;
        goto LABEL_40;
      }
LABEL_77:
      if ( v8 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v8->Dpc.DeferredContext) & 0x80) != 0
        && BYTE1(v8->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v8->Dpc.ProcessorHistory, 0xE0u, (__int64)&unk_5CE08);
      }
      return v19;
    }
    return v19;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->Dpc.DeferredContext) < 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xD5u, (__int64)&unk_5CE08);
  }
  return 4i64;
}
// 22675: conditional instruction was optimized away because of 'er14.4==2'
// 22820: variable 'v17' is possibly undefined
// 653F0: using guessed type int dword_653F0;

//----- (0000000000022A3C) ----------------------------------------------------
__int64 __fastcall sub_22A3C(PNET_BUFFER NetBuffer, int a2, char a3, __int64 a4, __int64 a5)
{
  unsigned int v9; // er12
  const char *v11; // rax
  __int64 v12; // r10
  const char *v13; // r9
  char v14[8]; // [rsp+30h] [rbp-128h] BYREF
  __int64 v15; // [rsp+38h] [rbp-120h] BYREF
  __int64 v16; // [rsp+40h] [rbp-118h]
  __int64 v17; // [rsp+50h] [rbp-108h] BYREF
  __int64 Dst[11]; // [rsp+58h] [rbp-100h] BYREF
  int v19; // [rsp+B0h] [rbp-A8h] BYREF
  char v20[100]; // [rsp+B4h] [rbp-A4h] BYREF

  v9 = 0;
  v17 = 0i64;
  memset(Dst, 0, sizeof(Dst));
  v14[0] = 0;
  v19 = 0;
  memset(v20, 0, sizeof(v20));
  v15 = 0i64;
  v16 = 0i64;
  if ( dword_653FC || a3 )
  {
    if ( dword_65408 == 2 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xE2u, (__int64)&unk_5CE08);
      }
      *(_DWORD *)a5 = 1;
      goto LABEL_14;
    }
    v9 = sub_216A0(NetBuffer, a4, 0, (__int64)&v15);
    if ( v9 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xE3u, (__int64)&unk_5CE08);
      }
      v9 = 12;
      goto LABEL_14;
    }
    sub_431D0(v15, v16, &v17);
    if ( (Dst[10] & 1) != 0 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xE4u, (__int64)&unk_5CE08);
      }
      if ( dword_653F8 == 3 || !sub_1CF58((__int64)&v17) )
        goto LABEL_14;
      _InterlockedAdd64(&qword_613C0, 1ui64);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        v11 = sub_4DA64(dword_653F8);
        v13 = "IPv6";
        if ( Dst[1] )
          v13 = "IPv4";
        sub_11908(*(_QWORD *)(v12 + 216), 0xE5u, (__int64)&unk_5CE08, v13, v11);
      }
      goto LABEL_45;
    }
    if ( Dst[2] )
    {
      if ( !dword_653F4 && !dword_65408 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0xE6u, (__int64)&unk_5CE08);
        }
LABEL_45:
        *(_DWORD *)(a5 + 4) = 1;
        goto LABEL_14;
      }
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11430(off_60148->Dpc.ProcessorHistory, 0xE7u, (__int64)&unk_5CE08, dword_653F4);
      }
    }
    sub_1A840((__int64)&v17, a2, (__int64)&v19);
    if ( !dword_65408 )
      goto LABEL_79;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xE8u, (__int64)&unk_5CE08);
    }
    sub_1B2A0((__int64)&v19, (__int64)&v17, (_DWORD *)(a5 + 4));
    if ( *(_DWORD *)(a5 + 4) )
    {
      _InterlockedAdd64(&qword_613B8, 1ui64);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xE9u, (__int64)&unk_5CE08);
      }
    }
    else
    {
LABEL_79:
      if ( dword_653FC && dword_65414 && (sub_3246C((__int64)&v19, (__int64)&v17, v14), v14[0])
        || dword_65440 == 1 && (sub_3E3D4((__int64)&v19, (__int64)&v17, v14), v14[0]) )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0xEAu, (__int64)&unk_5CE08);
        }
        *(_DWORD *)a5 = 1;
        goto LABEL_25;
      }
    }
LABEL_14:
    if ( !*(_DWORD *)(a5 + 4) )
    {
      if ( a3 )
      {
        *(_DWORD *)(a5 + 8) = sub_14594((__int64)&v17, dword_653F0);
        if ( dword_653E8 )
        {
          sub_18F68((__int64)&v19, (_DWORD *)(a5 + 4));
          if ( dword_653E8 == 2 )
          {
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
              && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
            {
              sub_11008(off_60148->Dpc.ProcessorHistory, 0xEBu, (__int64)&unk_5CE08);
            }
            *(_DWORD *)(a5 + 4) = *(_DWORD *)(a5 + 4) == 0;
          }
          if ( *(_DWORD *)(a5 + 4) )
            _InterlockedAdd64(&qword_613B0, 1ui64);
        }
      }
    }
LABEL_25:
    sub_21938((__int64)&v15);
    return v9;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xE1u, (__int64)&unk_5CE08);
  }
  return 0i64;
}
// 22D75: variable 'v12' is possibly undefined
// 613B0: using guessed type __int64 qword_613B0;
// 613B8: using guessed type __int64 qword_613B8;
// 613C0: using guessed type __int64 qword_613C0;
// 653E8: using guessed type int dword_653E8;
// 653F0: using guessed type int dword_653F0;
// 653F4: using guessed type int dword_653F4;
// 653F8: using guessed type int dword_653F8;
// 653FC: using guessed type int dword_653FC;
// 65408: using guessed type int dword_65408;
// 65414: using guessed type int dword_65414;
// 65440: using guessed type int dword_65440;

//----- (0000000000022FA4) ----------------------------------------------------
__int64 __fastcall sub_22FA4(__int64 a1, int a2, __int64 a3, _DWORD *a4)
{
  unsigned int v4; // esi
  int v7; // er14
  PDEVICE_OBJECT v10; // rcx
  struct _NET_BUFFER *v11; // rbx
  char v12; // r8
  int v13; // eax

  v4 = 0;
  v7 = 0;
  v10 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xECu, (__int64)&unk_5CE08);
    v10 = off_60148;
  }
  if ( a1 && a3 && a4 )
  {
    *a4 = 0;
    a4[1] = 0;
    a4[2] = 0;
    v10 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xEEu, (__int64)&unk_5CE08, a1);
      v10 = off_60148;
    }
    v11 = *(struct _NET_BUFFER **)(a1 + 8);
    v12 = 1;
    if ( v11 )
    {
      while ( 1 )
      {
        ++v7;
        v13 = sub_22A3C(v11, a2, v12, a3, (__int64)a4);
        v4 = v13;
        if ( v13 )
          break;
        if ( *a4 )
        {
          v10 = off_60148;
          if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
            return v4;
          if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
          {
            sub_11008(off_60148->Dpc.ProcessorHistory, 0xF0u, (__int64)&unk_5CE08);
LABEL_25:
            v10 = off_60148;
            goto LABEL_31;
          }
          goto LABEL_31;
        }
        v11 = (struct _NET_BUFFER *)v11->Link.Alignment;
        v12 = 0;
        if ( !v11 )
          goto LABEL_25;
      }
      v10 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return v4;
      if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x15u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0xEFu, (__int64)&unk_5CE08, v13);
        goto LABEL_25;
      }
    }
  }
  else
  {
    if ( v10 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v10->Dpc.DeferredContext + 1, 0x15u)
      && BYTE1(v10->Dpc.DeferredContext) >= 2u )
    {
      sub_385D4(v10->Dpc.ProcessorHistory, 0xEDu, (__int64)&unk_5CE08, a1, a3, a4);
      v10 = off_60148;
    }
    v4 = 4;
  }
LABEL_31:
  if ( v10 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v10->Dpc.DeferredContext + 1, 0x15u)
    && BYTE1(v10->Dpc.DeferredContext) >= 5u )
  {
    sub_11148(v10->Dpc.ProcessorHistory, 0xF1u, (__int64)&unk_5CE08, v7);
  }
  return v4;
}

//----- (00000000000231F0) ----------------------------------------------------
__int64 sub_231F0(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CDF8, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000023244) ----------------------------------------------------
__int64 sub_23244(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, a3, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000232A4) ----------------------------------------------------
__int64 __fastcall sub_232A4(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CDF8, 32i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000232FC) ----------------------------------------------------
__int64 sub_232FC(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CDF8, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002335C) ----------------------------------------------------
__int64 __fastcall sub_2335C(__int64 a1, unsigned __int16 a2, __int64 a3, __int64 a4, char a5, char a6, const char *a7)
{
  ULONG_PTR v9; // [rsp+98h] [rbp+20h] BYREF

  v9 = qword_613E8;
  if ( a7 )
    strlen(a7);
  return qword_61238(a1, 43i64, &unk_5CDF8, a2, &v9);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000023418) ----------------------------------------------------
__int64 sub_23418(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+88h] [rbp+20h] BYREF
  va_list va; // [rsp+88h] [rbp+20h]
  const char *v7; // [rsp+90h] [rbp+28h]
  va_list va1; // [rsp+98h] [rbp+30h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, const char *);
  if ( v7 )
    strlen(v7);
  return qword_61238(a1, 43i64, &unk_5CDF8, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000234B4) ----------------------------------------------------
__int64 sub_234B4()
{
  char v0; // bl
  unsigned int v1; // edi
  unsigned int v2; // eax
  int v3; // eax
  int v4; // eax
  int v6; // [rsp+70h] [rbp+8h] BYREF

  v0 = 0;
  v6 = 0;
  v1 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_5CDF8);
  }
  v2 = sub_502CC(0x200A01Au);
  if ( v2 < 3 )
    v2 = 3;
  qword_613E8 = (ULONG_PTR)sub_53288(11, 2, 2, 0x6B4E734Eu, v2, 1, 0i64, 0i64, (__int64)sub_24EB4, 0i64, &v6);
  if ( v6 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_5CDF8, v6);
    }
    v1 = sub_57F30(v6);
    if ( v1 && qword_613E8 )
    {
      v3 = sub_53950(qword_613E8, 0);
      if ( v3
        && off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0xCu, (__int64)&unk_5CDF8, v3);
      }
      qword_613E8 = 0i64;
    }
  }
  v4 = sub_502CC(0x200A026u);
  if ( v4 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_5CDF8, v4);
    }
    v0 = 1;
  }
  sub_58100(qword_613E8, 0i64, v0);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_5CDF8);
  }
  return v1;
}

//----- (00000000000236BC) ----------------------------------------------------
__int64 __fastcall sub_236BC(unsigned __int64 *a1, ULONG_PTR **a2, int a3)
{
  unsigned int v6; // esi
  int v7; // eax
  int v8; // edi
  int v9; // eax
  const char *v10; // rax
  __int64 v11; // r10
  int v12; // eax
  PDEVICE_OBJECT v13; // rcx
  int v15; // [rsp+50h] [rbp+8h] BYREF

  v6 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x12u, (__int64)&unk_5CDF8, *a1);
  }
  v7 = sub_55180(qword_613E8, *a1, (__int64)a1, a2);
  v8 = v7;
  v15 = v7;
  if ( v7 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11230(off_60148->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_5CDF8, *a1, v7);
    }
    v6 = sub_57F30(v8);
  }
  if ( a1[7] )
  {
    if ( a1[5] )
    {
      _InterlockedAdd(&dword_612E4, 1u);
    }
    else if ( a1[6] )
    {
      _InterlockedAdd(&dword_612E8, 1u);
    }
  }
  else if ( a1[8] )
  {
    if ( a1[5] )
    {
      _InterlockedAdd(&dword_612EC, 1u);
    }
    else if ( a1[6] )
    {
      _InterlockedAdd(&dword_612F0, 1u);
    }
  }
  else if ( a1[5] )
  {
    _InterlockedAdd(&dword_612F4, 1u);
  }
  else if ( a1[6] )
  {
    _InterlockedAdd(&dword_612F8, 1u);
  }
  else
  {
    _InterlockedAdd(&dword_612FC, 1u);
  }
  if ( (a1[14] & 1) != 0 )
    _InterlockedAdd(&dword_61300, 1u);
  _InterlockedAdd(&dword_612E0, 1u);
  v9 = *((_DWORD *)a1 + 95);
  switch ( v9 )
  {
    case 1:
      _InterlockedAdd64(&qword_61378, 1ui64);
      break;
    case 2:
      _InterlockedAdd64(&qword_61370, 1ui64);
      break;
    case 6:
      _InterlockedAdd64(&qword_61380, 1ui64);
      break;
    default:
      _InterlockedAdd64(&qword_61388, 1ui64);
      break;
  }
  sub_1CA88((__int64)a1, a3);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    v10 = sub_4DAA8(a3);
    sub_23418(*(_QWORD *)(v11 + 216), 0x14u, (__int64)&unk_5CDF8, a2, v10, *a1);
  }
  v12 = sub_55088(qword_613E8, &v15);
  v13 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_5CDF8, v12);
      v13 = off_60148;
    }
    if ( v13 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v13->Dpc.DeferredContext) & 4) != 0
      && BYTE1(v13->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v13->Dpc.ProcessorHistory, 0x16u, (__int64)&unk_5CDF8);
    }
  }
  return v6;
}
// 2387D: variable 'v11' is possibly undefined
// 612E0: using guessed type int dword_612E0;
// 612E4: using guessed type int dword_612E4;
// 612E8: using guessed type int dword_612E8;
// 612EC: using guessed type int dword_612EC;
// 612F0: using guessed type int dword_612F0;
// 612F4: using guessed type int dword_612F4;
// 612F8: using guessed type int dword_612F8;
// 612FC: using guessed type int dword_612FC;
// 61300: using guessed type int dword_61300;
// 61370: using guessed type __int64 qword_61370;
// 61378: using guessed type __int64 qword_61378;
// 61380: using guessed type __int64 qword_61380;
// 61388: using guessed type __int64 qword_61388;

//----- (0000000000023944) ----------------------------------------------------
__int64 __fastcall sub_23944(unsigned __int64 a1, unsigned int *a2)
{
  unsigned int v2; // ebx
  unsigned int v5; // ebp
  PDEVICE_OBJECT v6; // rcx
  unsigned __int64 v7; // r12
  unsigned __int64 v8; // rdi
  unsigned int v9; // eax
  unsigned int v10; // eax
  __int64 result; // rax
  int v12; // [rsp+70h] [rbp+8h] BYREF
  union _LARGE_INTEGER Interval; // [rsp+80h] [rbp+18h] BYREF

  v2 = 0;
  v12 = 0;
  v5 = 0;
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x17u, (__int64)&unk_5CDF8, a1);
    v6 = off_60148;
  }
  if ( a1 && a2 )
  {
    if ( a1 < 0x1F4 )
      a1 = 500i64;
    v7 = a1 / 0x1F4;
    if ( a1 / 0x1F4 )
    {
      v8 = a1 / v7;
      Interval.QuadPart = -10000i64 * v8;
      v9 = sub_55088(qword_613E8, &v12);
      *a2 = v9;
      v6 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_1D3B0(off_60148->Dpc.ProcessorHistory, 0x19u, (__int64)&unk_5CDF8, v9, v8);
        v6 = off_60148;
      }
      while ( *a2 && v5 < v7 )
      {
        if ( v6 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v6->Dpc.DeferredContext) & 4) != 0
          && BYTE1(v6->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(v6->Dpc.ProcessorHistory, 0x1Au, (__int64)&unk_5CDF8);
        }
        KeDelayExecutionThread(0, 0, &Interval);
        v10 = sub_55088(qword_613E8, &v12);
        *a2 = v10;
        v6 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x1Bu, (__int64)&unk_5CDF8, v10);
          v6 = off_60148;
        }
        ++v5;
      }
    }
    else
    {
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v6->Dpc.DeferredContext) & 4) != 0
        && BYTE1(v6->Dpc.DeferredContext) >= 5u )
      {
        sub_1D3B0(v6->Dpc.ProcessorHistory, 0x1Cu, (__int64)&unk_5CDF8, a1, a1 / 0x1F4);
        v6 = off_60148;
      }
      v2 = 4;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v6->Dpc.DeferredContext) & 4) != 0
      && BYTE1(v6->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v6->Dpc.ProcessorHistory, 0x1Du, (__int64)&unk_5CDF8);
    }
    result = v2;
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v6->Dpc.DeferredContext) & 4) != 0
      && BYTE1(v6->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(v6->Dpc.ProcessorHistory, 0x18u, (__int64)&unk_5CDF8);
    }
    result = 4i64;
  }
  return result;
}

//----- (0000000000023BD0) ----------------------------------------------------
__int64 __fastcall sub_23BD0(__int64 a1, unsigned __int64 a2)
{
  unsigned __int64 v2; // rbx
  unsigned int v4; // esi
  PDEVICE_OBJECT v5; // rcx
  unsigned __int64 v7; // rbp
  unsigned int v8; // ebx
  unsigned __int8 v9; // di
  unsigned __int8 v10; // [rsp+78h] [rbp+10h] BYREF
  union _LARGE_INTEGER Interval; // [rsp+80h] [rbp+18h] BYREF

  v2 = a2;
  v10 = 0;
  v4 = 0;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x1Eu, (__int64)&unk_5CDF8, a2);
    v5 = off_60148;
  }
  if ( v2 )
  {
    if ( v2 < 0x1F4 )
      v2 = 500i64;
    v7 = v2 / 0x1F4;
    if ( v2 / 0x1F4 )
    {
      Interval.QuadPart = -10000i64 * (v2 / v7);
      v8 = sub_23EA4(a1, &v10);
      v5 = off_60148;
      v9 = v10;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_232A4(off_60148->Dpc.ProcessorHistory, 32i64, (__int64)&unk_5CDF8, v10);
        v5 = off_60148;
      }
      if ( v8 )
      {
        if ( v5 == (PDEVICE_OBJECT)&off_60148 )
          return v8;
        if ( (BYTE4(v5->Dpc.DeferredContext) & 4) != 0 && BYTE1(v5->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(v5->Dpc.ProcessorHistory, 0x23u, (__int64)&unk_5CDF8);
          v5 = off_60148;
        }
      }
      else
      {
        do
        {
          if ( !v9 || v4 >= v7 )
            break;
          if ( v5 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(v5->Dpc.DeferredContext) & 4) != 0
            && BYTE1(v5->Dpc.DeferredContext) >= 5u )
          {
            sub_11008(v5->Dpc.ProcessorHistory, 0x21u, (__int64)&unk_5CDF8);
          }
          KeDelayExecutionThread(0, 0, &Interval);
          v8 = sub_23EA4(a1, &v10);
          v5 = off_60148;
          v9 = v10;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
            && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
          {
            sub_112FC(off_60148->Dpc.ProcessorHistory, 0x22u, (__int64)&unk_5CDF8, v10);
            v5 = off_60148;
          }
          ++v4;
        }
        while ( !v8 );
      }
    }
    else
    {
      if ( v5 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v5->Dpc.DeferredContext) & 4) != 0
        && BYTE1(v5->Dpc.DeferredContext) >= 5u )
      {
        sub_1D3B0(v5->Dpc.ProcessorHistory, 0x24u, (__int64)&unk_5CDF8, v2, v2 / 0x1F4);
        v5 = off_60148;
      }
      v8 = 4;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v5->Dpc.DeferredContext) & 4) != 0
      && BYTE1(v5->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v5->Dpc.ProcessorHistory, 0x25u, (__int64)&unk_5CDF8);
    }
    return v8;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v5->Dpc.DeferredContext) & 4) != 0
    && BYTE1(v5->Dpc.DeferredContext) >= 2u )
  {
    sub_11008(v5->Dpc.ProcessorHistory, 0x1Fu, (__int64)&unk_5CDF8);
  }
  return 4i64;
}

//----- (0000000000023EA4) ----------------------------------------------------
__int64 __fastcall sub_23EA4(__int64 a1, _BYTE *a2)
{
  unsigned int v2; // ebx
  PDEVICE_OBJECT v5; // rcx
  ULONG_PTR v7; // rcx
  __int64 v8; // r9
  PDEVICE_OBJECT v9; // rcx
  int v10; // eax
  ULONG_PTR v11; // rdx
  __int64 v12; // rcx
  int v13; // edi
  __int64 v14; // [rsp+20h] [rbp-38h]
  int v15; // [rsp+68h] [rbp+10h] BYREF
  ULONG_PTR v16; // [rsp+70h] [rbp+18h] BYREF

  v2 = 0;
  v15 = 0;
  v16 = 0i64;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2335C(
      off_60148->Dpc.ProcessorHistory,
      0x26u,
      (__int64)&unk_5CDF8,
      qword_613E8,
      *(_DWORD *)a1,
      *(_DWORD *)(a1 + 148),
      (const char *)(a1 + 4));
    v5 = off_60148;
  }
  if ( a2 )
  {
    v7 = qword_613E8;
    *a2 = 0;
    v8 = sub_5621C(v7, &v16, &v15);
    if ( v8 )
    {
      while ( *(_DWORD *)(v8 + 372) != *(_DWORD *)a1 )
      {
        v8 = sub_563E8(qword_613E8, &v16, 1, &v15);
        if ( !v8 )
          goto LABEL_29;
      }
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        LODWORD(v14) = *(_DWORD *)a1;
        sub_231F0(off_60148->Dpc.ProcessorHistory, 0x29u, (__int64)&unk_5CDF8, *(_QWORD *)v8, v14);
      }
      v11 = v16;
      v12 = qword_613E8;
      *a2 = 1;
      v13 = sub_56864(v12, v11);
      if ( v13 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x2Au, (__int64)&unk_5CDF8, v16);
        }
        v2 = sub_57F30(v13);
      }
    }
    else
    {
      v9 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return v2;
      if ( (BYTE4(off_60148->Dpc.DeferredContext) & 4) == 0 || BYTE1(off_60148->Dpc.DeferredContext) < 5u )
      {
LABEL_30:
        if ( v9 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v9->Dpc.DeferredContext) & 4) != 0
          && BYTE1(v9->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(v9->Dpc.ProcessorHistory, 0x2Bu, (__int64)&unk_5CDF8);
        }
        return v2;
      }
      v10 = sub_57F30(v15);
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x28u, (__int64)&unk_5CDF8, v10);
    }
LABEL_29:
    v9 = off_60148;
    goto LABEL_30;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v5->Dpc.DeferredContext) & 4) != 0
    && BYTE1(v5->Dpc.DeferredContext) >= 2u )
  {
    sub_11008(v5->Dpc.ProcessorHistory, 0x27u, (__int64)&unk_5CDF8);
  }
  return 4i64;
}
// 24041: variable 'v14' is possibly undefined

//----- (00000000000240F4) ----------------------------------------------------
__int64 __fastcall sub_240F4(unsigned __int64 a1, __int64 *a2, _QWORD *a3, int a4)
{
  unsigned int v4; // ebx
  __int64 v9; // rax
  int v10; // edi
  unsigned int v11; // eax
  int v13; // [rsp+58h] [rbp+10h] BYREF

  v4 = 0;
  v13 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x2Cu, (__int64)&unk_5CDF8, a1);
  }
  v9 = sub_559E0(qword_613E8, a1, a3, &v13);
  v10 = v13;
  *a2 = v9;
  if ( v10 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_231F0(off_60148->Dpc.ProcessorHistory, 0x2Du, (__int64)&unk_5CDF8, a1, v10);
    }
    v11 = sub_57F30(v10);
    *a2 = 0i64;
    v4 = v11;
  }
  else
  {
    sub_1CA88(v9, a4);
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Eu, (__int64)&unk_5CDF8);
  }
  return v4;
}

//----- (000000000002422C) ----------------------------------------------------
__int64 __fastcall sub_2422C(ULONG_PTR a1, int a2)
{
  unsigned int v2; // ebx
  __int64 result; // rax
  int v6; // ebp
  _QWORD *v7; // rbp
  const char *v8; // rax
  __int64 v9; // r10
  int v10; // [rsp+50h] [rbp+8h] BYREF

  v2 = 0;
  v10 = 0;
  if ( a1 )
  {
    sub_566A8(qword_613E8, a1, 0i64, &v10);
    v6 = v10;
    if ( v10 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x30u, (__int64)&unk_5CDF8, v10);
      }
      v2 = sub_57F30(v6);
    }
    else
    {
      v7 = (_QWORD *)sub_55648(qword_613E8, a1);
      if ( v7 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          v8 = sub_4DAA8(a2);
          sub_23418(*(_QWORD *)(v9 + 216), 0x31u, (__int64)&unk_5CDF8, a1, v8, *v7);
        }
        sub_1CA88((__int64)v7, a2);
      }
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x32u, (__int64)&unk_5CDF8);
    }
    result = v2;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Fu, (__int64)&unk_5CDF8);
    }
    result = 4i64;
  }
  return result;
}
// 24341: variable 'v9' is possibly undefined

//----- (00000000000243C4) ----------------------------------------------------
__int64 __fastcall sub_243C4(ULONG_PTR BugCheckParameter1, int a2)
{
  unsigned int v2; // ebx
  __int64 result; // rax
  _QWORD *v6; // rbp
  const char *v7; // rax
  __int64 v8; // r10
  int v9; // ebp

  v2 = 0;
  if ( BugCheckParameter1 )
  {
    v6 = (_QWORD *)sub_55648(qword_613E8, BugCheckParameter1);
    if ( v6 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        v7 = sub_4DAA8(a2);
        sub_23418(*(_QWORD *)(v8 + 216), 0x34u, (__int64)&unk_5CDF8, BugCheckParameter1, v7, *v6);
      }
      sub_1CA88((__int64)v6, a2);
    }
    v9 = sub_56A10(qword_613E8, BugCheckParameter1);
    if ( v9 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x35u, (__int64)&unk_5CDF8, BugCheckParameter1);
      }
      v2 = sub_57F30(v9);
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x36u, (__int64)&unk_5CDF8);
    }
    result = v2;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x33u, (__int64)&unk_5CDF8);
    }
    result = 4i64;
  }
  return result;
}
// 24475: variable 'v8' is possibly undefined

//----- (0000000000024560) ----------------------------------------------------
__int64 __fastcall sub_24560(__int64 a1)
{
  unsigned int v1; // edi
  PDEVICE_OBJECT v3; // rcx
  signed __int32 *v4; // rbx
  PDEVICE_OBJECT v5; // rcx
  int v6; // eax
  int v8; // [rsp+70h] [rbp+18h] BYREF
  ULONG_PTR v9; // [rsp+78h] [rbp+20h] BYREF

  v1 = 0;
  v8 = 0;
  v9 = 0i64;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2335C(
      off_60148->Dpc.ProcessorHistory,
      0x3Au,
      (__int64)&unk_5CDF8,
      qword_613E8,
      *(_DWORD *)a1,
      *(_DWORD *)(a1 + 148),
      (const char *)(a1 + 4));
    v3 = off_60148;
  }
  if ( byte_6128A )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v3->Dpc.DeferredContext) & 4) != 0
      && BYTE1(v3->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v3->Dpc.ProcessorHistory, 0x3Bu, (__int64)&unk_5CDF8);
    }
    sub_54480(qword_613E8, 0);
  }
  v4 = (signed __int32 *)sub_5621C(qword_613E8, &v9, &v8);
  if ( v4 )
  {
    do
    {
      if ( v4[93] == *(_DWORD *)a1 )
      {
        if ( (unsigned int)sub_187B8(v4, 1u) )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
            && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
          {
            sub_11148(off_60148->Dpc.ProcessorHistory, 0x3Eu, (__int64)&unk_5CDF8, v8);
          }
        }
        else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
               && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
               && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x3Du, (__int64)&unk_5CDF8, *(_QWORD *)v4);
        }
        v1 = sub_188D4(v4);
        if ( v1 )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
            && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
          {
            sub_11148(off_60148->Dpc.ProcessorHistory, 0x40u, (__int64)&unk_5CDF8, v8);
          }
        }
        else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
               && (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0
               && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x3Fu, (__int64)&unk_5CDF8, *(_QWORD *)v4);
        }
        sub_1CA88((__int64)v4, 49);
      }
      v4 = (signed __int32 *)sub_563E8(qword_613E8, &v9, 1, &v8);
    }
    while ( v4 );
    goto LABEL_37;
  }
  v5 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return v1;
  if ( (BYTE4(off_60148->Dpc.DeferredContext) & 4) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    v6 = sub_57F30(v8);
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x3Cu, (__int64)&unk_5CDF8, v6);
LABEL_37:
    v5 = off_60148;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v5->Dpc.DeferredContext) & 4) != 0
    && BYTE1(v5->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v5->Dpc.ProcessorHistory, 0x41u, (__int64)&unk_5CDF8);
  }
  return v1;
}
// 6128A: using guessed type char byte_6128A;

//----- (0000000000024834) ----------------------------------------------------
__int64 sub_24834()
{
  int v0; // eax
  unsigned int v1; // ebp
  unsigned int v2; // esi
  PDEVICE_OBJECT v3; // rcx
  unsigned __int64 *v5; // rdi
  PDEVICE_OBJECT v6; // rcx
  int v7; // eax
  unsigned __int64 v8; // rbx
  signed __int64 v9; // rax
  signed __int64 v10; // rbx
  char v11; // cl
  bool v12; // r12
  __int64 v13; // rax
  int v14; // eax
  unsigned __int64 v15; // r13
  int v16; // ebx
  bool v17; // zf
  int v18; // ebx
  ULONG_PTR BugCheckParameter4; // [rsp+20h] [rbp-58h]
  int v20; // [rsp+88h] [rbp+10h] BYREF
  ULONG_PTR v21; // [rsp+90h] [rbp+18h] BYREF

  v20 = 0;
  v21 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 8) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x42u, (__int64)&unk_5CDF8, qword_613E8);
  }
  _InterlockedExchange64(&qword_65180, 0i64);
  _InterlockedExchange64(&qword_65188, 0i64);
  if ( byte_6128A )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 8) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x43u, (__int64)&unk_5CDF8);
    }
    v0 = sub_502CC(0x200A026u);
    sub_54480(qword_613E8, 1000 * v0);
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && (BYTE4(off_60148->Dpc.DeferredContext) & 8) != 0
         && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x44u, (__int64)&unk_5CDF8);
  }
  v1 = sub_502CC(0x200A01Au);
  v2 = sub_502CC(0x200A01Bu);
  if ( v1 && v1 < 3 )
    v1 = 3;
  if ( v2 && v2 < 3 )
    v2 = 3;
  if ( v1 )
    goto LABEL_26;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 8) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x46u, (__int64)&unk_5CDF8);
LABEL_26:
    v3 = off_60148;
  }
  if ( !v2
    && v3 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v3->Dpc.DeferredContext) & 8) != 0
    && BYTE1(v3->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v3->Dpc.ProcessorHistory, 0x47u, (__int64)&unk_5CDF8);
    v3 = off_60148;
  }
  if ( !v1 && !v2 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v3->Dpc.DeferredContext) & 8) != 0
      && BYTE1(v3->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v3->Dpc.ProcessorHistory, 0x48u, (__int64)&unk_5CDF8);
    }
    return 7i64;
  }
  v5 = (unsigned __int64 *)sub_5621C(qword_613E8, &v21, &v20);
  if ( v5 )
  {
    while ( 1 )
    {
      v8 = *v5;
      if ( !(unsigned int)sub_55088(qword_613E8, &v20) )
        break;
      v9 = _InterlockedCompareExchange64(&qword_613D0, 0i64, 0i64);
      v10 = v9;
      v11 = v5[15] & 1;
      v12 = v11 == 1;
      if ( v11 == 1 )
      {
        _InterlockedAdd64(&qword_65188, 1ui64);
        if ( !v2 )
          goto LABEL_96;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 8) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          LODWORD(BugCheckParameter4) = v2;
          sub_232FC(off_60148->Dpc.ProcessorHistory, 0x4Au, (__int64)&unk_5CDF8, v5[18], BugCheckParameter4, v9);
        }
        v13 = v2;
      }
      else
      {
        _InterlockedAdd64(&qword_65180, 1ui64);
        if ( !v1 )
          goto LABEL_96;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 8) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          LODWORD(BugCheckParameter4) = v2;
          sub_232FC(off_60148->Dpc.ProcessorHistory, 0x4Bu, (__int64)&unk_5CDF8, v5[18], BugCheckParameter4, v9);
        }
        v13 = v1;
      }
      if ( (__int64)(v5[18] + v13) >= v10 )
      {
LABEL_96:
        v5 = (unsigned __int64 *)sub_563E8(qword_613E8, &v21, 1, &v20);
LABEL_97:
        v6 = off_60148;
        goto LABEL_94;
      }
      v14 = sub_502CC(0x200A027u);
      v15 = *v5;
      v16 = v14;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 8) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x4Cu, (__int64)&unk_5CDF8, *v5);
      }
      sub_1CA88((__int64)v5, 50);
      if ( v12 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 8) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x4Du, (__int64)&unk_5CDF8, *v5);
        }
        _InterlockedAdd64(&qword_65198, 1ui64);
      }
      else
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 8) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x4Eu, (__int64)&unk_5CDF8, *v5);
        }
        _InterlockedAdd64(&qword_65190, 1ui64);
      }
      _InterlockedAdd64(&qword_61338, 1ui64);
      if ( v12 )
        v17 = v16 == 2;
      else
        v17 = v16 == 1;
      if ( v17 || v16 == 3 )
        KeBugCheckEx(0xDEFECAu, 0i64, 0i64, 0i64, 0i64);
      v5 = (unsigned __int64 *)sub_563E8(qword_613E8, &v21, 1, &v20);
      v18 = sub_56BB4(qword_613E8, v15);
      v20 = v18;
      sub_283CC(v15);
      if ( v18 )
      {
        v6 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148
          || (BYTE4(off_60148->Dpc.DeferredContext) & 8) == 0
          || BYTE1(off_60148->Dpc.DeferredContext) < 5u )
        {
          goto LABEL_94;
        }
        sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x4Fu, (__int64)&unk_5CDF8, v15);
      }
      v6 = off_60148;
LABEL_94:
      if ( !v5 )
        goto LABEL_44;
    }
    v6 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->Dpc.DeferredContext) & 8) == 0
      || BYTE1(off_60148->Dpc.DeferredContext) < 5u )
    {
      goto LABEL_94;
    }
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x50u, (__int64)&unk_5CDF8, v8);
    goto LABEL_97;
  }
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Dpc.DeferredContext) & 8) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      v7 = sub_57F30(v20);
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x49u, (__int64)&unk_5CDF8, v7);
      v6 = off_60148;
    }
LABEL_44:
    if ( v6 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(v6->Dpc.DeferredContext) & 8) != 0 && BYTE1(v6->Dpc.DeferredContext) >= 5u )
      {
        sub_23244(
          v6->Dpc.ProcessorHistory,
          0x51u,
          (__int64)&unk_5CDF8,
          qword_65180,
          qword_65188,
          qword_65190,
          qword_65198);
        v6 = off_60148;
      }
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v6->Dpc.DeferredContext) & 8) != 0
        && BYTE1(v6->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v6->Dpc.ProcessorHistory, 0x52u, (__int64)&unk_5CDF8);
      }
    }
  }
  return 0i64;
}
// 24BF8: variable 'BugCheckParameter4' is possibly undefined
// 6128A: using guessed type char byte_6128A;
// 61338: using guessed type __int64 qword_61338;
// 613D0: using guessed type __int64 qword_613D0;
// 65180: using guessed type __int64 qword_65180;
// 65188: using guessed type __int64 qword_65188;
// 65190: using guessed type __int64 qword_65190;
// 65198: using guessed type __int64 qword_65198;

//----- (0000000000024EB4) ----------------------------------------------------
void __fastcall sub_24EB4(__int64 a1)
{
  __int64 v1; // r12
  unsigned __int8 v2; // r13
  int v4; // ebp
  int v5; // esi
  PDEVICE_OBJECT v6; // rcx
  char v7; // [rsp+50h] [rbp+8h] BYREF

  v1 = *(_QWORD *)a1;
  v2 = _bittest((const signed __int32 *)(a1 + 120), 0xAu);
  v7 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->Dpc.DeferredContext) < 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x53u, (__int64)&unk_5CDF8, v1);
  }
  sub_40598((PFAST_MUTEX)(a1 + 152));
  v4 = *(_DWORD *)(a1 + 212);
  v5 = *(unsigned __int16 *)(a1 + 208);
  sub_40664((PFAST_MUTEX)(a1 + 152));
  if ( !dword_6126C && v4 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->Dpc.DeferredContext) < 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x54u, (__int64)&unk_5CDF8, v1);
    }
    sub_1CB00(a1, &v7);
  }
  if ( !v7 )
  {
    sub_18E4C(a1);
LABEL_18:
    v6 = off_60148;
    goto LABEL_19;
  }
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->Dpc.DeferredContext) < 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x55u, (__int64)&unk_5CDF8, v1);
    goto LABEL_18;
  }
LABEL_19:
  if ( !v7 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148 && SBYTE4(v6->Dpc.DeferredContext) < 0 && BYTE1(v6->Dpc.DeferredContext) >= 4u )
      sub_2F80C(v6->Dpc.ProcessorHistory, 0x56u, (__int64)&unk_5CDF8, v1);
    sub_187B8((signed __int32 *)a1, 2u);
  }
  if ( v4 == 1 )
  {
    _InterlockedAdd64(&qword_61320, 1ui64);
  }
  else if ( v4 == 2 )
  {
    _InterlockedAdd64(&qword_61318, 1ui64);
  }
  if ( v5 == 1 || v5 == 3 )
  {
    _InterlockedAdd64(&qword_61308, 1ui64);
  }
  else if ( v5 == 2 || v5 == 4 )
  {
    _InterlockedAdd64(&qword_61310, 1ui64);
  }
  if ( *(_QWORD *)(a1 + 56) )
  {
    if ( *(_QWORD *)(a1 + 40) )
    {
      _InterlockedAdd(&dword_612E4, 0xFFFFFFFF);
    }
    else if ( *(_QWORD *)(a1 + 48) )
    {
      _InterlockedAdd(&dword_612E8, 0xFFFFFFFF);
    }
  }
  else if ( *(_QWORD *)(a1 + 64) )
  {
    if ( *(_QWORD *)(a1 + 40) )
    {
      _InterlockedAdd(&dword_612EC, 0xFFFFFFFF);
    }
    else if ( *(_QWORD *)(a1 + 48) )
    {
      _InterlockedAdd(&dword_612F0, 0xFFFFFFFF);
    }
  }
  else if ( *(_QWORD *)(a1 + 40) )
  {
    _InterlockedAdd(&dword_612F4, 0xFFFFFFFF);
  }
  else if ( *(_QWORD *)(a1 + 48) )
  {
    _InterlockedAdd(&dword_612F8, 0xFFFFFFFF);
  }
  else
  {
    _InterlockedAdd(&dword_612FC, 0xFFFFFFFF);
  }
  if ( (*(_BYTE *)(a1 + 112) & 1) != 0 )
    _InterlockedAdd(&dword_61300, 0xFFFFFFFF);
  _InterlockedAdd(&dword_612E0, 0xFFFFFFFF);
  if ( !v7 || v2 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->Dpc.DeferredContext) < 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x57u, (__int64)&unk_5CDF8, v1);
    }
    sub_1864C(a1, 1);
  }
}
// 6126C: using guessed type int dword_6126C;
// 612E0: using guessed type int dword_612E0;
// 612E4: using guessed type int dword_612E4;
// 612E8: using guessed type int dword_612E8;
// 612EC: using guessed type int dword_612EC;
// 612F0: using guessed type int dword_612F0;
// 612F4: using guessed type int dword_612F4;
// 612F8: using guessed type int dword_612F8;
// 612FC: using guessed type int dword_612FC;
// 61300: using guessed type int dword_61300;
// 61308: using guessed type __int64 qword_61308;
// 61310: using guessed type __int64 qword_61310;
// 61318: using guessed type __int64 qword_61318;
// 61320: using guessed type __int64 qword_61320;

//----- (0000000000025188) ----------------------------------------------------
__int64 sub_25188(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CDE8, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000251F4) ----------------------------------------------------
char __fastcall sub_251F4(PVOID StartContext, _DWORD *a2)
{
  char v4; // si
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx
  __int64 v8; // r13
  _BYTE *v9; // rax
  _WORD *v10; // rbp
  __int64 v11; // rax
  PDEVICE_OBJECT v12; // r11
  int StartContexta; // [rsp+30h] [rbp-58h]
  __int64 v14; // [rsp+40h] [rbp-48h] BYREF
  int v15; // [rsp+48h] [rbp-40h]
  char v16; // [rsp+4Ch] [rbp-3Ch]
  unsigned __int16 v17; // [rsp+90h] [rbp+8h] BYREF
  unsigned __int16 v18; // [rsp+A0h] [rbp+18h] BYREF
  void *ThreadHandle; // [rsp+A8h] [rbp+20h] BYREF

  v4 = 0;
  ThreadHandle = 0i64;
  if ( !StartContext )
  {
    v5 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
      || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
    {
      return 0;
    }
    v6 = 10;
LABEL_6:
    sub_11008(v5->Dpc.ProcessorHistory, v6, (__int64)&unk_5CDE8);
    return 0;
  }
  if ( (*((_BYTE *)StartContext + 112) & 1) != 0 )
  {
    v5 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
      || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
    {
      return 0;
    }
    v6 = 11;
    goto LABEL_6;
  }
  if ( (*((_BYTE *)StartContext + 120) & 0x20) != 0 )
  {
    v5 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
      || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
    {
      return 0;
    }
    v6 = 12;
    goto LABEL_6;
  }
  if ( !dword_65428 || (unsigned int)dword_6542C > 1 )
    return v4;
  v8 = *(_QWORD *)StartContext;
  v9 = sub_42C74(*((_QWORD *)StartContext + 2), 3);
  v18 = 0;
  v17 = 0;
  v10 = v9;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_5CDE8, v8);
  }
  if ( v10 || (v10 = sub_42C74(*((_QWORD *)StartContext + 2), 4)) != 0i64 )
  {
    sub_44EC8(v10, &v18);
    sub_44F8C((__int64)v10, &v17);
    if ( v18 == (unsigned int)sub_502CC(0x200A02Du) || v17 == (unsigned int)sub_502CC(0x200A02Du) )
    {
      if ( dword_6542C )
      {
        if ( dword_6542C == 1 )
        {
          v12 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
          {
            sub_11008(off_60148->Dpc.ProcessorHistory, dword_6542C + 14, (__int64)&unk_5CDE8);
            v12 = off_60148;
          }
          v4 = 1;
          goto LABEL_39;
        }
      }
      else
      {
        v4 = 1;
        v16 = 0;
        v15 = sub_502CC(0x200A02Fu);
        v11 = *(_QWORD *)StartContext;
        v16 = 1;
        v14 = v11;
        *((_DWORD *)StartContext + 53) = 1;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_5CDE8);
        }
        sub_16088(40021i64, &v14, 0xDu);
      }
    }
    v12 = off_60148;
LABEL_39:
    if ( v12 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v12->Dpc.DeferredContext + 1, 0x16u)
      && BYTE1(v12->Dpc.DeferredContext) >= 4u )
    {
      StartContexta = sub_502CC(0x200A02Du);
      sub_25188(off_60148->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_5CDE8, v8, v18, v17, StartContexta);
    }
    goto LABEL_43;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_5CDE8, v8);
LABEL_43:
    if ( v4 )
    {
      if ( PsCreateSystemThread(&ThreadHandle, 0, 0i64, 0i64, 0i64, (PKSTART_ROUTINE)StartRoutine, StartContext) >= 0 )
        ZwClose(ThreadHandle);
      *a2 = 1073741828;
    }
  }
  return v4;
}
// 65428: using guessed type int dword_65428;
// 6542C: using guessed type int dword_6542C;

//----- (00000000000255AC) ----------------------------------------------------
char __fastcall sub_255AC(__int64 *a1, int a2)
{
  char v2; // di
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx
  __int64 v8; // r13
  _BYTE *v9; // rax
  _WORD *v10; // rbp
  unsigned int v11; // eax
  unsigned __int64 v12; // rbp
  PDEVICE_OBJECT v13; // rax
  int i; // esi
  int v15; // [rsp+30h] [rbp-38h]
  unsigned __int16 v16; // [rsp+70h] [rbp+8h] BYREF
  unsigned __int16 v17; // [rsp+80h] [rbp+18h] BYREF
  union _LARGE_INTEGER Interval; // [rsp+88h] [rbp+20h] BYREF

  v2 = 0;
  if ( !a1 )
  {
    v5 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
      || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
    {
      return 0;
    }
    v6 = 18;
LABEL_6:
    sub_11008(v5->Dpc.ProcessorHistory, v6, (__int64)&unk_5CDE8);
    return 0;
  }
  if ( (a1[14] & 1) != 0 )
  {
    v5 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
      || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
    {
      return 0;
    }
    v6 = 19;
    goto LABEL_6;
  }
  if ( (a1[15] & 0x20) != 0 )
  {
    v5 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
      || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
    {
      return 0;
    }
    v6 = 20;
    goto LABEL_6;
  }
  if ( dword_65428 && (unsigned int)dword_6542C >= 2 )
  {
    v8 = *a1;
    v9 = sub_42C74(a1[2], 3);
    v17 = 0;
    v16 = 0;
    v10 = v9;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_5CDE8, v8);
    }
    if ( v10 || (v10 = sub_42C74(a1[2], 4)) != 0i64 )
    {
      sub_44EC8(v10, &v17);
      sub_44F8C((__int64)v10, &v16);
      if ( (v17 == (unsigned int)sub_502CC(0x200A02Du) || v16 == (unsigned int)sub_502CC(0x200A02Du))
        && (dword_6542C == 2 && !a2 || dword_6542C == 3 && a2 == 1) )
      {
        v11 = sub_502CC(0x200A02Eu);
        Interval.QuadPart = -5000000i64;
        v12 = v11 / 0x1F4;
        v13 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x16u, (__int64)&unk_5CDE8);
          v13 = off_60148;
        }
        for ( i = 0; i < v12; v13 = off_60148 )
        {
          if ( !dword_653E4 )
            break;
          if ( v13 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x16u)
            && BYTE1(v13->Dpc.DeferredContext) >= 5u )
          {
            sub_11008(v13->Dpc.ProcessorHistory, 0x17u, (__int64)&unk_5CDE8);
          }
          KeDelayExecutionThread(0, 0, &Interval);
          ++i;
        }
        if ( v13 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x16u)
          && BYTE1(v13->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(v13->Dpc.ProcessorHistory, 0x18u, (__int64)&unk_5CDE8);
          v13 = off_60148;
        }
        v2 = 1;
      }
      else
      {
        v13 = off_60148;
      }
      if ( v13 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x16u)
        && BYTE1(v13->Dpc.DeferredContext) >= 4u )
      {
        v15 = sub_502CC(0x200A02Du);
        sub_25188(off_60148->Dpc.ProcessorHistory, 0x19u, (__int64)&unk_5CDE8, v8, v17, v16, v15);
      }
    }
    else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
           && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
           && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x1Au, (__int64)&unk_5CDE8, v8);
    }
  }
  return v2;
}
// 653E4: using guessed type int dword_653E4;
// 65428: using guessed type int dword_65428;
// 6542C: using guessed type int dword_6542C;

//----- (000000000002594C) ----------------------------------------------------
void __fastcall StartRoutine(PVOID StartContext)
{
  unsigned int v2; // eax
  unsigned int v3; // kr00_4
  unsigned __int64 v4; // rsi
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx
  unsigned __int64 v7; // rdi
  int v8; // ebx
  __int64 v9; // rbx
  int v10; // eax
  const char *v11; // rax
  __int64 v12; // r10
  int v13; // eax
  const char *v14; // rax
  __int64 v15; // r10
  unsigned __int64 v16; // [rsp+30h] [rbp-38h] BYREF
  int v17; // [rsp+38h] [rbp-30h]
  char v18; // [rsp+3Ch] [rbp-2Ch]
  __int64 v19; // [rsp+70h] [rbp+8h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+78h] [rbp+10h] BYREF
  union _LARGE_INTEGER Interval; // [rsp+80h] [rbp+18h] BYREF

  v19 = 0i64;
  BugCheckParameter1 = 0i64;
  v2 = sub_502CC(0x200A02Eu);
  Interval.QuadPart = -5000000i64;
  v3 = v2;
  v4 = v2 / 0x1F4;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x1Bu, (__int64)&unk_5CDE8);
    v5 = off_60148;
  }
  if ( !StartContext )
  {
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x16u)
      && BYTE1(v5->Dpc.DeferredContext) >= 4u )
    {
      v6 = 28;
LABEL_50:
      sub_11008(v5->Dpc.ProcessorHistory, v6, (__int64)&unk_5CDE8);
      return;
    }
    return;
  }
  v7 = *(_QWORD *)StartContext;
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x16u)
    && BYTE1(v5->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(v5->Dpc.ProcessorHistory, 0x1Du, (__int64)&unk_5CDE8);
    v5 = off_60148;
  }
  v8 = 0;
  if ( v3 / 0x1F4 )
  {
    do
    {
      if ( !dword_653E4 )
        break;
      if ( v5 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x16u)
        && BYTE1(v5->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v5->Dpc.ProcessorHistory, 0x1Eu, (__int64)&unk_5CDE8);
      }
      KeDelayExecutionThread(0, 0, &Interval);
      v5 = off_60148;
      ++v8;
    }
    while ( v8 < v4 );
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x16u)
    && BYTE1(v5->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(v5->Dpc.ProcessorHistory, 0x1Fu, (__int64)&unk_5CDE8);
  }
  if ( !(unsigned int)sub_240F4(v7, &v19, &BugCheckParameter1, 43) )
  {
    v9 = v19;
    if ( v19 )
    {
      if ( BugCheckParameter1 )
        sub_243C4(BugCheckParameter1, 44);
      if ( dword_6542C )
      {
        if ( dword_6542C == 1 )
        {
          sub_502CC(0x200A02Fu);
          v13 = sub_502CC(0x200A02Fu);
          v16 = v7;
          *(_DWORD *)(v9 + 212) = 2;
          v17 = v13;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
          {
            v14 = sub_4D7E8(v13);
            sub_1164C(*(_QWORD *)(v15 + 216), 0x21u, (__int64)&unk_5CDE8, v7, v14);
          }
          sub_15DFC(40004i64, (__int64)&v16, 0xCu, 0i64, &v19);
        }
      }
      else
      {
        v10 = sub_502CC(0x200A02Fu);
        v16 = v7;
        v18 = 0;
        v17 = v10;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          v11 = sub_4D7E8(v10);
          sub_1164C(*(_QWORD *)(v12 + 216), 0x20u, (__int64)&unk_5CDE8, v7, v11);
        }
        sub_16088(40021i64, &v16, 0xDu);
      }
      goto LABEL_45;
    }
  }
  v5 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return;
  if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x16u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x22u, (__int64)&unk_5CDE8, v7);
LABEL_45:
    v5 = off_60148;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x16u)
    && BYTE1(v5->Dpc.DeferredContext) >= 4u )
  {
    v6 = 35;
    goto LABEL_50;
  }
}
// 25B5F: variable 'v12' is possibly undefined
// 25BF3: variable 'v15' is possibly undefined
// 653E4: using guessed type int dword_653E4;
// 6542C: using guessed type int dword_6542C;

//----- (0000000000025CAC) ----------------------------------------------------
__int64 sub_25CAC(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, a3, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000025D04) ----------------------------------------------------
__int64 sub_25D04(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  *((int *)va + 2) = 0;
  return qword_61238(a1, 43i64, &unk_5CDD8, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000025D5C) ----------------------------------------------------
__int64 sub_25D5C(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CDD8, 88i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000025DB0) ----------------------------------------------------
__int64 sub_25DB0(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CDD8, 72i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000025E14) ----------------------------------------------------
__int64 sub_25E14(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CDD8, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000025E74) ----------------------------------------------------
__int64 sub_25E74(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+A8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CDD8, 80i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000025EF8) ----------------------------------------------------
char __fastcall sub_25EF8(__int64 a1)
{
  _BYTE *v1; // rdi
  _BYTE *v4; // rbx
  char v5; // [rsp+30h] [rbp+8h] BYREF

  v1 = *(_BYTE **)(a1 + 40);
  v5 = 0;
  if ( v1 )
  {
    if ( *(_DWORD *)(a1 + 124) < 0x23u )
      return 0;
    sub_43ADC(v1, &v5);
    if ( v5 != 4 )
      return 0;
    if ( sub_45B18((__int64)v1) )
      return 1;
  }
  v4 = *(_BYTE **)(a1 + 48);
  if ( v4 )
  {
    sub_43ADC(v4, &v5);
    if ( v5 == 6 && sub_46BE8((__int64)v4) )
      return 1;
  }
  return 0;
}

//----- (0000000000025F7C) ----------------------------------------------------
char __fastcall sub_25F7C(__int64 a1, unsigned __int16 a2, unsigned __int16 a3)
{
  char v5; // bp
  __int64 v6; // r11
  __int64 **v7; // rdi
  __int64 *v8; // rbx
  PDEVICE_OBJECT v9; // r10
  __int64 v11; // [rsp+20h] [rbp-28h]
  __int64 v12; // [rsp+28h] [rbp-20h]
  __int64 v13; // [rsp+50h] [rbp+8h] BYREF

  v13 = a1;
  v5 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11430(off_60148->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_5CDD8, a2);
  }
  sub_401B8(&qword_650B0, (KIRQL *)&v13);
  v6 = qword_650A0;
  if ( (__int64 *)qword_650A0 == &qword_650A0 )
  {
LABEL_8:
    v6 = 0i64;
  }
  else
  {
    while ( *(_DWORD *)(v6 + 32) != a3 )
    {
      v6 = *(_QWORD *)v6;
      if ( (__int64 *)v6 == &qword_650A0 )
        goto LABEL_8;
    }
  }
  if ( !v6 || (v7 = (__int64 **)(v6 + 16), v6 == -16) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_5CDD8);
    }
  }
  else
  {
    v8 = *v7;
    v9 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_5CDD8);
      v9 = off_60148;
    }
    while ( v8 != (__int64 *)v7 )
    {
      if ( v8 )
      {
        if ( v9 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v9->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(v9->Dpc.DeferredContext) >= 4u )
        {
          LODWORD(v12) = a2;
          LODWORD(v11) = *((unsigned __int16 *)v8 + 13);
          sub_25CAC(v9->Dpc.ProcessorHistory, 0xCu, (__int64)&unk_5CDD8, v8[2], v11, v12);
          v9 = off_60148;
        }
        if ( *((_WORD *)v8 + 13) == a2 )
        {
          if ( v9 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(v9->Dpc.DeferredContext) & 0x20) != 0
            && BYTE1(v9->Dpc.DeferredContext) >= 4u )
          {
            sub_11430(v9->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_5CDD8, a3);
          }
          v5 = 1;
          break;
        }
      }
      else if ( v9 != (PDEVICE_OBJECT)&off_60148
             && (BYTE4(v9->Dpc.DeferredContext) & 0x20) != 0
             && BYTE1(v9->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v9->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_5CDD8);
        v9 = off_60148;
      }
      v8 = (__int64 *)*v8;
    }
  }
  sub_40230(&qword_650B0, v13);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_5CDD8);
  }
  return v5;
}
// 260D8: variable 'v11' is possibly undefined
// 260D8: variable 'v12' is possibly undefined
// 650A0: using guessed type __int64 qword_650A0;

//----- (0000000000026214) ----------------------------------------------------
_DWORD *__fastcall sub_26214(__int64 *a1, __int64 a2)
{
  _DWORD *v4; // rax
  _DWORD *v5; // rbx
  __int64 v6; // r9

  if ( !a1 || !a2 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_5CDD8);
    }
    return 0i64;
  }
  v4 = sub_3FA7C((__int64)qword_612D0);
  v5 = v4;
  if ( !v4 )
    return 0i64;
  v6 = *a1;
  *((_BYTE *)v4 + 24) = 0;
  *((_QWORD *)v4 + 2) = v6;
  *((_WORD *)v4 + 13) = *(_WORD *)(a2 + 23);
  *((_WORD *)v4 + 14) = *(_WORD *)(a2 + 25) - *(unsigned __int8 *)(a2 + 27);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_25CAC(off_60148->Dpc.ProcessorHistory, 0x12u, (__int64)&unk_5CDD8);
  }
  return v5;
}

//----- (0000000000026328) ----------------------------------------------------
__int64 __fastcall sub_26328(__int64 a1, __int64 a2, int a3)
{
  __int64 v4; // rbx
  _DWORD *v5; // rax
  __int64 v6; // rdi
  __int64 v7; // rax
  __int64 v9; // [rsp+48h] [rbp+10h] BYREF

  v9 = a2;
  v4 = 0i64;
  v5 = sub_3FC10((__int64)qword_612C0, 0x200u);
  v6 = (__int64)v5;
  if ( v5 )
  {
    v7 = sub_1820C(512, (__int64)v5, &v9, a3, 1);
    v4 = v7;
    if ( v7 )
    {
      *(_DWORD *)(v7 + 120) |= 2u;
      *(_DWORD *)(v7 + 128) = 1;
    }
    else
    {
      sub_3FAE4((__int64)qword_612C0, v6);
    }
  }
  return v4;
}

//----- (00000000000263C8) ----------------------------------------------------
__int64 __fastcall sub_263C8(__int64 a1, __int64 *a2, __int64 a3)
{
  _BYTE *v3; // rbx
  unsigned int v7; // esi
  size_t v8; // r8
  void *v9; // rcx
  int v10; // er11
  unsigned __int16 *v12; // rbx
  unsigned __int16 v13; // ax
  __int16 v14; // ax
  __int64 v15; // r11
  unsigned __int16 v16; // [rsp+30h] [rbp-38h] BYREF
  unsigned __int16 v17; // [rsp+38h] [rbp-30h]
  unsigned __int8 v18; // [rsp+78h] [rbp+10h] BYREF
  unsigned __int8 v19; // [rsp+80h] [rbp+18h] BYREF
  unsigned __int16 v20; // [rsp+88h] [rbp+20h] BYREF

  v3 = *(_BYTE **)(a3 + 40);
  sub_43B8C(v3, &v18);
  v18 *= 4;
  sub_43C3C((__int64)v3, &v16);
  v7 = v16 - v18;
  sub_43E74((__int64)v3, &v20);
  v8 = *((unsigned int *)a2 + 31);
  v9 = (void *)a2[2];
  v20 *= 8;
  memset(v9, 0, v8);
  v10 = v18 + 14;
  if ( (unsigned int)v10 > *((_DWORD *)a2 + 31) )
    return 517i64;
  memmove((void *)a2[2], *(const void **)(a3 + 16), v10);
  if ( v18 + v7 + v20 + 14 > *((_DWORD *)a2 + 31) )
    return 518i64;
  memmove((void *)(v18 + (unsigned __int64)v20 + a2[2] + 14), (const void *)(*(_QWORD *)(a3 + 16) + v18 + 14i64), v7);
  v12 = (unsigned __int16 *)sub_42C74(a2[2], 1);
  sub_43DC4((__int64)v12, &v19);
  v19 &= 0xFEu;
  sub_4599C((__int64)v12, v19);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_429B4(*(_QWORD *)&off_60148->AlignmentRequirement, 264i64, (__int64)&unk_5CCA8, v12, 0, 0);
  }
  v13 = v12[3];
  v17 = _byteswap_ushort(v13) & 0xE000;
  v12[3] = _byteswap_ushort(v17);
  sub_458D8((__int64)v12, v16 + v20);
  v14 = sub_47100(v12);
  sub_45A54((__int64)v12, v14);
  v15 = *a2;
  *(_DWORD *)(a1 + 36) = v20;
  *(_QWORD *)(a1 + 40) = v15;
  return 0i64;
}

//----- (00000000000265B8) ----------------------------------------------------
__int64 __fastcall sub_265B8(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12
  int v6; // er9
  unsigned int v7; // er9
  __int64 result; // rax
  char v11; // di
  _BYTE *v12; // rax
  unsigned __int16 v13; // di
  PDEVICE_OBJECT v14; // r10
  unsigned int v15; // er8
  int v16; // er13
  unsigned int v17; // er9
  _BYTE *v18; // rsi
  unsigned __int16 v19; // di
  int v20; // [rsp+20h] [rbp-58h]
  int v21; // [rsp+28h] [rbp-50h]
  unsigned __int16 v22; // [rsp+30h] [rbp-48h]
  void *Src; // [rsp+38h] [rbp-40h] BYREF
  unsigned __int16 v25; // [rsp+88h] [rbp+10h] BYREF
  unsigned __int16 v26; // [rsp+90h] [rbp+18h] BYREF
  __int16 v27; // [rsp+98h] [rbp+20h] BYREF

  v4 = *(_QWORD *)(a3 + 48);
  v6 = *(unsigned __int16 *)(a4 + 26);
  v26 = 0;
  v27 = 0;
  Src = 0i64;
  v7 = v6 + 14;
  if ( v7 <= *(_DWORD *)(a2 + 124) )
  {
    memset(*(void **)(a2 + 16), 0, *(unsigned int *)(a2 + 124));
    LOBYTE(v25) = 0;
    sub_46A6C((unsigned __int8 **)a4, (unsigned __int8 *)&v25);
    v22 = *(_WORD *)(a4 + 26);
    memmove(*(void **)(a2 + 16), *(const void **)(a3 + 16), v22 + 14);
    v11 = v25;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      v21 = (unsigned __int8)v25;
      v20 = *(unsigned __int8 *)(a4 + 40);
      sub_42AB8(
        *(_QWORD *)&off_60148->AlignmentRequirement,
        321i64,
        (__int64)&unk_5CCA8,
        *(_QWORD *)(a4 + 32),
        v20,
        v21);
    }
    v12 = *(_BYTE **)(a4 + 32);
    if ( *(_BYTE *)(a4 + 40) == 0xFF )
      v12[6] = v11;
    else
      *v12 = v11;
    sub_46C28(*(_QWORD *)a4, &v27);
    v13 = 8 * v27;
    sub_46E70(v4, a4, &Src, &v26);
    v14 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11430(off_60148->Dpc.ProcessorHistory, 0x14u, (__int64)&unk_5CDD8, v13);
      v14 = off_60148;
    }
    v15 = *(_DWORD *)(a2 + 124);
    v16 = v13;
    if ( v13 <= v15 )
    {
      v17 = v26 + v13 + *(unsigned __int16 *)(a4 + 26) + 14;
      if ( v17 <= v15 )
      {
        memmove((void *)(v22 + (unsigned __int64)v13 + *(_QWORD *)(a2 + 16) + 14), Src, v26);
        v18 = sub_42C74(*(_QWORD *)(a2 + 16), 2);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x144u, (__int64)&unk_5CCA8);
        }
        *((_WORD *)v18 + 1) = 0;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x145u, (__int64)&unk_5CCA8);
        }
        v19 = v22 + v26 + v13 - 40;
        v25 = v19;
        *((_WORD *)v18 + 2) = _byteswap_ushort(v19);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_112FC(off_60148->Dpc.ProcessorHistory, 0x17u, (__int64)&unk_5CDD8, v19);
        }
        *(_QWORD *)(a1 + 40) = *(_QWORD *)a2;
        result = 0i64;
        *(_DWORD *)(a1 + 36) = v16;
      }
      else
      {
        if ( v14 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v14->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(v14->Dpc.DeferredContext) >= 3u )
        {
          sub_11430(v14->Dpc.ProcessorHistory, 0x16u, (__int64)&unk_5CDD8, v17);
        }
        result = 521i64;
      }
    }
    else
    {
      if ( v14 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v14->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(v14->Dpc.DeferredContext) >= 3u )
      {
        sub_11430(v14->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_5CDD8, v13);
      }
      result = 522i64;
    }
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
    {
      sub_11430(off_60148->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_5CDD8, v7);
    }
    result = 519i64;
  }
  return result;
}

//----- (0000000000026950) ----------------------------------------------------
__int64 __fastcall sub_26950(__int64 a1, __int64 a2)
{
  _BYTE *v2; // rbx
  _BYTE *v3; // rdi
  unsigned __int16 v6; // si
  unsigned __int8 v7; // r11
  unsigned __int8 v9; // [rsp+50h] [rbp+8h] BYREF
  char v10; // [rsp+58h] [rbp+10h] BYREF
  unsigned __int16 v11; // [rsp+60h] [rbp+18h] BYREF
  __int16 v12; // [rsp+68h] [rbp+20h] BYREF

  v2 = *(_BYTE **)(a2 + 40);
  v3 = *(_BYTE **)(a1 + 40);
  sub_43E74((__int64)v2, &v11);
  v11 *= 8;
  sub_43C3C((__int64)v2, &v12);
  sub_43B8C(v2, &v9);
  v9 *= 4;
  v6 = v12 - v9;
  sub_43B8C(v3, &v10);
  v7 = 4 * v10;
  v10 *= 4;
  if ( (unsigned int)v11 > *(_DWORD *)(a1 + 124) || v6 + v7 + (unsigned int)v11 + 14 > *(_DWORD *)(a1 + 124) )
    return 0i64;
  memmove((void *)(v7 + *(_QWORD *)(a1 + 16) + v11 + 14i64), (const void *)(*(_QWORD *)(a2 + 16) + v9 + 14i64), v6);
  return v6;
}

//----- (0000000000026A2C) ----------------------------------------------------
__int64 __fastcall sub_26A2C(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v4; // rcx
  unsigned __int16 v7; // di
  unsigned __int16 v8; // r12
  PDEVICE_OBJECT v9; // rcx
  unsigned int v10; // er10
  unsigned int v11; // er9
  unsigned __int16 v12; // dx
  unsigned int v14; // ebx
  unsigned __int16 v15; // [rsp+50h] [rbp+8h] BYREF
  void *Src; // [rsp+58h] [rbp+10h] BYREF

  v4 = *(_QWORD *)a3;
  v15 = 0;
  sub_46C28(v4, &Src);
  v7 = 8 * (_WORD)Src;
  sub_46E70(*(_QWORD *)(a2 + 48), a3, &Src, &v15);
  v8 = *(_WORD *)(a3 + 26);
  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_4DE38(off_60148->Dpc.ProcessorHistory, 0x18u, (__int64)&unk_5CDD8, v8);
    v9 = off_60148;
  }
  v10 = *(_DWORD *)(a1 + 124);
  v11 = v7;
  if ( v7 > v10 )
  {
    if ( v9 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(v9->Dpc.DeferredContext) & 0x20) == 0
      || BYTE1(v9->Dpc.DeferredContext) < 3u )
    {
      return 0i64;
    }
    v12 = 25;
LABEL_10:
    sub_11430(v9->Dpc.ProcessorHistory, v12, (__int64)&unk_5CDD8, v11);
    return 0i64;
  }
  v14 = v15;
  v11 = v7 + *(unsigned __int16 *)(a3 + 26) + v15 + 14;
  if ( v11 > v10 )
  {
    if ( v9 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(v9->Dpc.DeferredContext) & 0x20) == 0
      || BYTE1(v9->Dpc.DeferredContext) < 3u )
    {
      return 0i64;
    }
    v12 = 26;
    goto LABEL_10;
  }
  memmove((void *)(v8 + *(_QWORD *)(a1 + 16) + v7 + 14i64), Src, v15);
  return v14;
}

//----- (0000000000026B9C) ----------------------------------------------------
__int64 __fastcall sub_26B9C(__int64 a1, __int64 a2)
{
  __int64 *v2; // rsi
  __int64 *v3; // rbx
  int v6; // eax
  PDEVICE_OBJECT v7; // rcx
  ULONG_PTR v8; // rcx
  ULONG_PTR BugCheckParameter1; // [rsp+60h] [rbp+8h] BYREF
  __int64 v11; // [rsp+70h] [rbp+18h] BYREF

  v11 = 0i64;
  BugCheckParameter1 = 0i64;
  v2 = (__int64 *)(a1 + 16);
  v3 = *(__int64 **)(a1 + 16);
  if ( v3 == (__int64 *)(a1 + 16) )
    return 0i64;
  while ( 1 )
  {
    if ( *((_BYTE *)v3 + 24) )
      goto LABEL_16;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x1Bu, (__int64)&unk_5CDD8, v3[2]);
    }
    if ( (unsigned int)sub_240F4(v3[2], &v11, &BugCheckParameter1, 17) )
      break;
    v6 = sub_26950(a2, v11);
    if ( !v6 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x1Du, (__int64)&unk_5CDD8, v3[2]);
      }
      goto LABEL_30;
    }
    *(_DWORD *)(a1 + 36) -= v6;
    v7 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11430(off_60148->Dpc.ProcessorHistory, 0x1Eu, (__int64)&unk_5CDD8, v6);
      v7 = off_60148;
    }
    if ( *(_DWORD *)(a1 + 36) > 0xFFFFu )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v7->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(v7->Dpc.DeferredContext) >= 3u )
      {
        sub_11430(v7->Dpc.ProcessorHistory, 0x1Fu, (__int64)&unk_5CDD8, *(_DWORD *)(a1 + 36));
      }
      goto LABEL_30;
    }
    v8 = BugCheckParameter1;
    *((_BYTE *)v3 + 24) = 1;
    if ( v8 )
    {
      sub_243C4(v8, 20);
      BugCheckParameter1 = 0i64;
    }
LABEL_16:
    v3 = (__int64 *)*v3;
    if ( v3 == v2 )
      goto LABEL_30;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_25D04(off_60148->Dpc.ProcessorHistory, 0x1Cu, (__int64)&unk_5CDD8, v3[2], 0);
  }
LABEL_30:
  if ( BugCheckParameter1 )
    sub_243C4(BugCheckParameter1, 20);
  return 0i64;
}

//----- (0000000000026DB8) ----------------------------------------------------
__int64 __fastcall sub_26DB8(__int64 a1, __int64 a2)
{
  __int64 *v2; // rsi
  __int64 *v3; // rbx
  __int64 v6; // rbp
  int v7; // eax
  PDEVICE_OBJECT v8; // rcx
  unsigned __int64 v10; // [rsp+30h] [rbp-58h] BYREF
  char Dst[40]; // [rsp+38h] [rbp-50h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+90h] [rbp+8h] BYREF
  __int64 v13; // [rsp+A0h] [rbp+18h] BYREF

  v13 = 0i64;
  BugCheckParameter1 = 0i64;
  v2 = (__int64 *)(a1 + 16);
  v3 = *(__int64 **)(a1 + 16);
  if ( v3 == (__int64 *)(a1 + 16) )
    return 0i64;
  while ( 1 )
  {
    if ( *((_BYTE *)v3 + 24) )
      goto LABEL_18;
    v10 = 0i64;
    memset(Dst, 0, sizeof(Dst));
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x20u, (__int64)&unk_5CDD8, v3[2]);
    }
    if ( (unsigned int)sub_240F4(v3[2], &v13, &BugCheckParameter1, 17) )
      break;
    v6 = v13;
    if ( !(unsigned int)sub_461F4(*(_QWORD *)(v13 + 48), 0x2Cu, &v10) )
    {
      v7 = sub_26A2C(a2, v6, (__int64)&v10);
      if ( !v7 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x22u, (__int64)&unk_5CDD8, v3[2]);
        }
        goto LABEL_32;
      }
      *(_DWORD *)(a1 + 36) -= v7;
      v8 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11430(off_60148->Dpc.ProcessorHistory, 0x23u, (__int64)&unk_5CDD8, v7);
        v8 = off_60148;
      }
      if ( *(_DWORD *)(a1 + 36) > 0xFFFFu )
      {
        if ( v8 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v8->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(v8->Dpc.DeferredContext) >= 3u )
        {
          sub_11430(v8->Dpc.ProcessorHistory, 0x24u, (__int64)&unk_5CDD8, *(_DWORD *)(a1 + 36));
        }
        goto LABEL_32;
      }
      *((_BYTE *)v3 + 24) = 1;
    }
    if ( BugCheckParameter1 )
    {
      sub_243C4(BugCheckParameter1, 20);
      BugCheckParameter1 = 0i64;
    }
LABEL_18:
    v3 = (__int64 *)*v3;
    if ( v3 == v2 )
      goto LABEL_32;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_25D04(off_60148->Dpc.ProcessorHistory, 0x21u, (__int64)&unk_5CDD8, v3[2], 0);
  }
LABEL_32:
  if ( BugCheckParameter1 )
    sub_243C4(BugCheckParameter1, 20);
  return 0i64;
}

//----- (0000000000027028) ----------------------------------------------------
__int64 __fastcall sub_27028(__int64 a1, __int64 *a2, _QWORD *a3, ULONG_PTR **a4, __int64 *a5, __int64 a6)
{
  __int64 *v7; // rbx
  __int64 v9; // r13
  unsigned int v10; // er15
  __int64 v11; // r14
  __int64 i; // r12
  int v13; // ebx
  bool v14; // cc
  __int64 v15; // rcx
  unsigned int v16; // ebx
  _QWORD *v17; // rcx
  __int64 result; // rax
  _QWORD *v19; // rax
  int v20; // ebx
  __int64 v21; // rbx
  ULONG_PTR **v22; // r14
  bool v23; // r15
  _DWORD *v24; // rax
  __int64 v25; // r14
  __int64 v26; // rax
  char v27; // r14
  int v28; // eax
  PDEVICE_OBJECT v29; // rcx
  unsigned __int16 v30; // dx
  int v31; // er9
  int v32; // eax
  __int64 v33; // rcx
  __int64 v34; // rdx
  __int64 *v35; // rax
  bool v36; // zf
  int v37; // eax
  PDEVICE_OBJECT v38; // rcx
  unsigned int v39; // er9
  PDEVICE_OBJECT v40; // rcx
  __int64 v41; // r9
  __int64 v42; // [rsp+20h] [rbp-B8h]
  KIRQL v43; // [rsp+30h] [rbp-A8h] BYREF
  char v44; // [rsp+31h] [rbp-A7h]
  char v45; // [rsp+32h] [rbp-A6h] BYREF
  char v46; // [rsp+33h] [rbp-A5h] BYREF
  unsigned __int16 v47; // [rsp+34h] [rbp-A4h] BYREF
  int v48; // [rsp+38h] [rbp-A0h] BYREF
  unsigned __int16 v49; // [rsp+3Ch] [rbp-9Ch] BYREF
  __int64 v50; // [rsp+40h] [rbp-98h] BYREF
  int v51; // [rsp+48h] [rbp-90h] BYREF
  __int16 v52; // [rsp+4Ch] [rbp-8Ch] BYREF
  __int16 v53; // [rsp+50h] [rbp-88h] BYREF
  _QWORD *v54; // [rsp+58h] [rbp-80h]
  __int64 v55; // [rsp+60h] [rbp-78h] BYREF
  __int64 v56; // [rsp+68h] [rbp-70h]
  __int64 v57; // [rsp+70h] [rbp-68h] BYREF
  _BYTE v58[40]; // [rsp+78h] [rbp-60h] BYREF
  __int64 v59; // [rsp+E8h] [rbp+10h]
  _QWORD *v60; // [rsp+F0h] [rbp+18h]
  ULONG_PTR **v61; // [rsp+F8h] [rbp+20h]

  v61 = a4;
  v60 = a3;
  v59 = (__int64)a2;
  v7 = a2;
  v48 = 0;
  v9 = 0i64;
  v50 = 0i64;
  v10 = 0;
  v51 = 0;
  v47 = 0;
  v49 = 0;
  v57 = 0i64;
  memset(v58, 0, sizeof(v58));
  *a4 = 0i64;
  v44 = 0;
  *a3 = 0i64;
  *a5 = 0i64;
  if ( v7[5] )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x25u, (__int64)&unk_5CDD8, *v7);
    }
    v11 = v7[5];
    sub_43D00(v11, &v48);
    goto LABEL_14;
  }
  if ( v7[6] )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x26u, (__int64)&unk_5CDD8, *v7);
    }
    v11 = v7[6];
    v44 = 1;
    if ( !(unsigned int)sub_461F4(v11, 0x2Cu, (unsigned __int64 *)&v57) )
    {
      sub_46D94(v57, &v48);
LABEL_14:
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x29u, (__int64)&unk_5CDD8, v48);
      }
      sub_401B8(&qword_650B0, &v43);
      for ( i = qword_650A0; (__int64 *)i != &qword_650A0; i = *(_QWORD *)i )
      {
        if ( *(_DWORD *)(i + 32) == v48 )
          goto LABEL_23;
      }
      i = 0i64;
LABEL_23:
      if ( !i )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Au, (__int64)&unk_5CDD8);
        }
        if ( (unsigned int)dword_622E4 > 4 )
        {
          _InterlockedAdd((volatile signed __int32 *)P + 4, 1u);
          v9 = v50;
        }
        v13 = v48;
        i = (__int64)sub_3FA7C((__int64)qword_612C8);
        if ( !i )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
            && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
          {
            sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Bu, (__int64)&unk_5CDD8);
          }
          v16 = 514;
          goto LABEL_51;
        }
        v14 = (unsigned int)dword_622E4 <= 6;
        *(_DWORD *)(i + 32) = v13;
        v7 = (__int64 *)v59;
        *(_DWORD *)(i + 36) = 0;
        *(_QWORD *)(i + 40) = 0i64;
        *(_QWORD *)(i + 48) = 0i64;
        *(_BYTE *)(i + 56) = 0;
        *(_QWORD *)(i + 24) = i + 16;
        *(_QWORD *)(i + 16) = i + 16;
        v15 = qword_650A0;
        *(_QWORD *)i = qword_650A0;
        *(_QWORD *)(i + 8) = &qword_650A0;
        *(_QWORD *)(v15 + 8) = i;
        qword_650A0 = i;
        if ( !v14 )
        {
          _InterlockedAdd((volatile signed __int32 *)P + 6, 1u);
          v9 = v50;
        }
      }
      if ( *(_BYTE *)(i + 56) == 1 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Cu, (__int64)&unk_5CDD8);
        }
        _InterlockedAdd64(&qword_651A0, 1ui64);
        v16 = 529;
LABEL_51:
        sub_40230(&qword_650B0, v43);
        return v16;
      }
      v17 = sub_26214(v7, a6);
      v54 = v17;
      if ( !v17 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Du, (__int64)&unk_5CDD8);
        }
        v16 = 515;
        goto LABEL_51;
      }
      v14 = (unsigned int)dword_622E4 <= 6;
      v19 = *(_QWORD **)(i + 24);
      *v17 = i + 16;
      v56 = i + 16;
      v17[1] = v19;
      *v19 = v17;
      *(_QWORD *)(i + 24) = v17;
      if ( !v14 )
      {
        _InterlockedAdd((volatile signed __int32 *)P + 6, 1u);
        v9 = v50;
      }
      *(_QWORD *)(i + 48) = v7[1];
      if ( v44 )
      {
        v21 = v57;
        sub_46CEC(v57, &v46);
        sub_46C28(v21, &v52);
        if ( (v46 & 1) == 0 && v52 )
          goto LABEL_57;
        v7 = (__int64 *)v59;
      }
      else
      {
        sub_43DC4(v11, &v45);
        sub_43E74(v11, &v53);
        if ( (v45 & 1) == 0 && v53 )
        {
LABEL_57:
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
            && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
          {
            sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Eu, (__int64)&unk_5CDD8);
          }
          if ( v44 )
          {
            sub_46F54(v11, (__int64)&v57, &v51);
            v20 = v51 + 14;
            v51 += 14;
          }
          else
          {
            sub_43C3C(v11, &v49);
            sub_43E74(v11, &v47);
            v20 = v49 + 8 * v47 + 14;
            v51 = v20;
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
              && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
            {
              sub_11430(off_60148->Dpc.ProcessorHistory, 0x2Fu, (__int64)&unk_5CDD8, v49);
            }
          }
          v23 = (*(_BYTE *)(v59 + 120) & 0x10) == 16;
          LODWORD(v50) = *(_DWORD *)(v59 + 372);
          v55 = *(_QWORD *)(v59 + 8);
          v9 = 0i64;
          v24 = sub_3FC10((__int64)qword_612C0, v20);
          v25 = (__int64)v24;
          if ( v24 )
          {
            v26 = sub_1843C(v20, (__int64)v24, &v55, v50, v23);
            v9 = v26;
            if ( v26 )
            {
              *(_DWORD *)(v26 + 120) |= 2u;
              *(_DWORD *)(v26 + 128) = 1;
            }
            else
            {
              sub_3FAE4((__int64)qword_612C0, v25);
            }
          }
          v50 = v9;
          if ( !v9 )
          {
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
              && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
            {
              sub_11008(off_60148->Dpc.ProcessorHistory, 0x30u, (__int64)&unk_5CDD8);
            }
            sub_40230(&qword_650B0, v43);
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
              && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
            {
              sub_11008(off_60148->Dpc.ProcessorHistory, 0x31u, (__int64)&unk_5CDD8);
            }
            return 516i64;
          }
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
            && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
          {
            LODWORD(v42) = v20;
            sub_11230(off_60148->Dpc.ProcessorHistory, 0x32u, (__int64)&unk_5CDD8, *(_QWORD *)v9, v42);
          }
          if ( (*(_BYTE *)(v9 + 120) & 4) != 0 )
            sub_17784(v9);
          v27 = v44;
          if ( v44 )
            v28 = sub_265B8(i, v9, v59, (__int64)&v57);
          else
            v28 = sub_263C8(i, (__int64 *)v9, v59);
          v10 = v28;
          if ( v28 )
          {
            v29 = off_60148;
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
              && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
            {
              v30 = 51;
              v31 = v28;
LABEL_122:
              sub_112FC(v29->Dpc.ProcessorHistory, v30, (__int64)&unk_5CDD8, v31);
              goto LABEL_123;
            }
            goto LABEL_123;
          }
          *((_BYTE *)v54 + 24) = 1;
          if ( v27 )
          {
            v32 = sub_26DB8(i, v9);
          }
          else
          {
            sub_431D0(*(_QWORD *)(v9 + 16), *(_DWORD *)(v9 + 124), (__int64 *)(v9 + 24));
            v32 = sub_26B9C(i, v9);
          }
          v10 = v32;
          if ( v32 )
          {
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
              && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
            {
              sub_112FC(off_60148->Dpc.ProcessorHistory, 0x34u, (__int64)&unk_5CDD8, v32);
            }
            goto LABEL_123;
          }
          v22 = v61;
          if ( (unsigned int)sub_236BC((unsigned __int64 *)v9, v61, 32) )
          {
            v29 = off_60148;
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
              && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
            {
              v30 = 53;
              v31 = 0;
              goto LABEL_122;
            }
LABEL_123:
            LODWORD(v42) = 0;
            if ( _bittest((const signed __int32 *)(v59 + 120), 0xAu) )
            {
              v33 = v56;
              v34 = *(_QWORD *)(v56 + 8);
              v35 = *(__int64 **)(v34 + 8);
              *(_QWORD *)(v56 + 8) = v35;
              *v35 = v33;
              sub_3FAE4((__int64)qword_612D0, v34);
              sub_40230(&qword_650B0, v43);
              sub_21254((__int64 *)v9, 1, 2);
            }
            else
            {
              sub_40230(&qword_650B0, v43);
              if ( (unsigned int)sub_27E8C((__int64)&qword_650A0, *(_QWORD *)(i + 40))
                && off_60148 != (PDEVICE_OBJECT)&off_60148
                && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
                && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
              {
                sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x3Eu, (__int64)&unk_5CDD8, *(_QWORD *)(i + 40), v42);
              }
            }
            return v10;
          }
          if ( (unsigned int)dword_622E4 > 7 )
          {
            _InterlockedAdd((volatile signed __int32 *)P + 7, 1u);
            v9 = v50;
          }
          goto LABEL_152;
        }
      }
      if ( !*(_QWORD *)(i + 40) )
      {
        v40 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x3Bu, (__int64)&unk_5CDD8);
          v40 = off_60148;
        }
        v22 = v61;
        goto LABEL_158;
      }
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x36u, (__int64)&unk_5CDD8);
      }
      v22 = v61;
      if ( (unsigned int)sub_240F4(*(_QWORD *)(i + 40), &v50, v61, 32) )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_112FC(off_60148->Dpc.ProcessorHistory, 0x37u, (__int64)&unk_5CDD8, 0);
        }
      }
      else
      {
        v9 = v50;
        v36 = v44 == 0;
        *(_QWORD *)(v50 + 8) = v7[1];
        if ( v36 )
          v37 = sub_26950(v9, (__int64)v7);
        else
          v37 = sub_26A2C(v9, (__int64)v7, (__int64)&v57);
        if ( v37 )
        {
          *(_DWORD *)(i + 36) -= v37;
          v38 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
            && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
          {
            sub_11430(off_60148->Dpc.ProcessorHistory, 0x39u, (__int64)&unk_5CDD8, v37);
            v38 = off_60148;
          }
          v39 = *(_DWORD *)(i + 36);
          if ( v39 <= 0xFFFF )
          {
            *((_BYTE *)v54 + 24) = 1;
            if ( *v61 )
              sub_243C4((ULONG_PTR)*v61, 33);
LABEL_152:
            v40 = off_60148;
LABEL_158:
            if ( *(_DWORD *)(i + 36) || (v41 = *(_QWORD *)(i + 40)) == 0 )
            {
              *v22 = 0i64;
              *v60 = 0i64;
              *a5 = 0i64;
            }
            else
            {
              *v60 = v41;
              *a5 = v9;
              if ( v40 != (PDEVICE_OBJECT)&off_60148
                && (BYTE4(v40->Dpc.DeferredContext) & 0x20) != 0
                && BYTE1(v40->Dpc.DeferredContext) >= 4u )
              {
                sub_2F80C(v40->Dpc.ProcessorHistory, 0x3Cu, (__int64)&unk_5CDD8);
              }
              *(_BYTE *)(i + 56) = 1;
              if ( v44 )
              {
                if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                  && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
                  && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
                {
                  sub_11008(off_60148->Dpc.ProcessorHistory, 0x3Du, (__int64)&unk_5CDD8);
                }
                sub_431D0(*(_QWORD *)(v9 + 16), *(_DWORD *)(v9 + 124), (__int64 *)(v9 + 24));
              }
            }
            sub_40230(&qword_650B0, v43);
            return v10;
          }
          if ( v38 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(v38->Dpc.DeferredContext) & 0x20) != 0
            && BYTE1(v38->Dpc.DeferredContext) >= 3u )
          {
            sub_11430(v38->Dpc.ProcessorHistory, 0x3Au, (__int64)&unk_5CDD8, v39);
          }
        }
        else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
               && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
               && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x38u, (__int64)&unk_5CDD8);
        }
      }
      sub_40230(&qword_650B0, v43);
      return 6;
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x27u, (__int64)&unk_5CDD8);
    }
    result = 512i64;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x28u, (__int64)&unk_5CDD8);
    }
    result = 513i64;
  }
  return result;
}
// 277B2: variable 'v42' is possibly undefined
// 622E4: using guessed type int dword_622E4;
// 650A0: using guessed type __int64 qword_650A0;
// 651A0: using guessed type __int64 qword_651A0;

//----- (0000000000027CDC) ----------------------------------------------------
__int64 __fastcall sub_27CDC(__int64 a1, __int64 a2, _QWORD *a3)
{
  __int64 *i; // rbx
  __int64 *v7; // rcx
  __int64 v8; // rcx
  __int64 *v9; // rax
  bool v10; // cc
  __int64 v11; // rdi
  _QWORD *v12; // rax
  __int64 v13; // rcx
  __int64 *v14; // rax
  __int64 v15; // rbx
  int v16; // [rsp+20h] [rbp-18h]
  __int64 v17; // [rsp+40h] [rbp+8h] BYREF
  __int64 v18; // [rsp+58h] [rbp+20h] BYREF

  v17 = a1;
  v16 = 0;
  sub_401B8(&qword_650B0, (KIRQL *)&v17);
  for ( i = (__int64 *)qword_650A0; i != &qword_650A0; i = (__int64 *)*i )
  {
    if ( i[5] == a2 )
      goto LABEL_6;
  }
  i = 0i64;
LABEL_6:
  if ( !i )
    goto LABEL_7;
  v7 = i + 2;
  if ( (__int64 *)*v7 == v7 )
  {
    v8 = *i;
    v9 = (__int64 *)i[1];
    *v9 = *i;
    *(_QWORD *)(v8 + 8) = v9;
    sub_3FAE4((__int64)qword_612C8, (__int64)i);
LABEL_7:
    sub_40230(&qword_650B0, v17);
    return 0i64;
  }
  v10 = (unsigned int)dword_622E4 <= 6;
  v11 = *v7;
  v12 = *(_QWORD **)*v7;
  *v7 = (__int64)v12;
  v12[1] = v7;
  if ( !v10 )
    _InterlockedAdd((volatile signed __int32 *)P + 6, 0xFFFFFFFF);
  if ( (__int64 *)*v7 == v7 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x3Fu, (__int64)&unk_5CDD8, i[5], v16);
    }
    v13 = *i;
    v14 = (__int64 *)i[1];
    *v14 = *i;
    *(_QWORD *)(v13 + 8) = v14;
    sub_3FAE4((__int64)qword_612C8, (__int64)i);
  }
  if ( (unsigned int)sub_240F4(*(_QWORD *)(v11 + 16), &v18, a3, 19) )
    v15 = 0i64;
  else
    v15 = v18;
  sub_3FAE4((__int64)qword_612D0, v11);
  sub_40230(&qword_650B0, v17);
  return v15;
}
// 622E4: using guessed type int dword_622E4;
// 650A0: using guessed type __int64 qword_650A0;

//----- (0000000000027E8C) ----------------------------------------------------
__int64 __fastcall sub_27E8C(__int64 a1, __int64 a2)
{
  __int64 *i; // rbx
  _QWORD **v4; // rdi
  __int64 v5; // rcx
  __int64 *v6; // rax
  bool v8; // cc
  _QWORD *v9; // rsi
  _QWORD *v10; // rax
  unsigned int v11; // er11
  __int64 v12; // rcx
  __int64 *v13; // rax
  __int64 v14; // [rsp+50h] [rbp+8h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+60h] [rbp+18h] BYREF
  __int64 v16; // [rsp+68h] [rbp+20h] BYREF

  v14 = a1;
  v16 = 0i64;
  BugCheckParameter1 = 0i64;
  sub_401B8(&qword_650B0, (KIRQL *)&v14);
  for ( i = (__int64 *)qword_650A0; i != &qword_650A0; i = (__int64 *)*i )
  {
    if ( i[5] == a2 )
      goto LABEL_6;
  }
  i = 0i64;
LABEL_6:
  if ( i )
  {
    v4 = (_QWORD **)(i + 2);
    if ( *v4 == v4 )
    {
      v5 = *i;
      v6 = (__int64 *)i[1];
      *v6 = *i;
      *(_QWORD *)(v5 + 8) = v6;
      sub_3FAE4((__int64)qword_612C8, (__int64)i);
    }
    else
    {
      while ( 1 )
      {
        v8 = (unsigned int)dword_622E4 <= 6;
        v9 = *v4;
        v10 = (_QWORD *)**v4;
        *v4 = v10;
        v10[1] = v4;
        if ( !v8 )
          _InterlockedAdd((volatile signed __int32 *)P + 6, 0xFFFFFFFF);
        if ( (unsigned int)sub_240F4(v9[2], &v16, &BugCheckParameter1, 21) )
          break;
        sub_243C4(BugCheckParameter1, 25);
        sub_243C4(BugCheckParameter1, 25);
        v11 = dword_622E4;
        if ( (unsigned int)dword_622E4 > 7 )
        {
          _InterlockedAdd((volatile signed __int32 *)P + 7, 0xFFFFFFFF);
          v11 = dword_622E4;
        }
        if ( v11 > 3 )
          _InterlockedAdd((volatile signed __int32 *)P + 3, 1u);
        sub_3FAE4((__int64)qword_612D0, (__int64)v9);
        if ( *v4 == v4 )
        {
          v12 = *i;
          v13 = (__int64 *)i[1];
          *v13 = *i;
          *(_QWORD *)(v12 + 8) = v13;
          sub_3FAE4((__int64)qword_612C8, (__int64)i);
          sub_40230(&qword_650B0, v14);
          return 0i64;
        }
      }
    }
  }
  sub_40230(&qword_650B0, v14);
  return 5i64;
}
// 622E4: using guessed type int dword_622E4;
// 650A0: using guessed type __int64 qword_650A0;

//----- (0000000000028048) ----------------------------------------------------
__int64 __fastcall sub_28048(int *a1)
{
  char v2; // r14
  __int64 *v3; // rsi
  PDEVICE_OBJECT v4; // rcx
  __int64 *v5; // r12
  __int64 v6; // rbx
  __int64 *v7; // rbp
  unsigned __int64 v8; // rcx
  __int64 v9; // rdi
  __int64 v10; // rcx
  __int64 *v11; // rax
  __int64 v12; // rcx
  _QWORD *v13; // rax
  __int64 v15; // [rsp+20h] [rbp-58h]
  __int64 v16; // [rsp+28h] [rbp-50h]
  __int64 v17; // [rsp+30h] [rbp-48h]
  KIRQL v18; // [rsp+88h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+90h] [rbp+18h] BYREF
  __int64 v20; // [rsp+98h] [rbp+20h] BYREF

  v20 = 0i64;
  v2 = 0;
  BugCheckParameter1 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x45u, (__int64)&unk_5CDD8, *a1);
  }
  LODWORD(v15) = 0;
  sub_401B8(&qword_650B0, &v18);
  v3 = (__int64 *)qword_650A0;
  if ( (__int64 *)qword_650A0 != &qword_650A0 )
  {
    v4 = off_60148;
    while ( 1 )
    {
      v5 = v3;
      v17 = (__int64)v3;
      if ( v4 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v4->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(v4->Dpc.DeferredContext) >= 5u )
      {
        sub_2F80C(v4->Dpc.ProcessorHistory, 0x46u, (__int64)&unk_5CDD8, v3[5]);
        v4 = off_60148;
      }
      v3 = (__int64 *)*v3;
      v6 = v5[2];
      if ( (__int64 *)v6 != v5 + 2 )
        break;
LABEL_37:
      v2 = 0;
      if ( v3 == &qword_650A0 )
        goto LABEL_38;
    }
    while ( 1 )
    {
      v7 = (__int64 *)v6;
      if ( v4 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v4->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(v4->Dpc.DeferredContext) >= 5u )
      {
        LODWORD(v16) = *(unsigned __int8 *)(v6 + 24);
        sub_25E14(v4->Dpc.ProcessorHistory, 0x47u, (__int64)&unk_5CDD8, v6, *(_QWORD *)(v6 + 16), v16);
      }
      v8 = *(_QWORD *)(v6 + 16);
      v6 = *(_QWORD *)v6;
      if ( !(unsigned int)sub_240F4(v8, &v20, &BugCheckParameter1, 27) )
      {
        v4 = off_60148;
        v9 = v20;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          LODWORD(v16) = *(_DWORD *)(v20 + 372);
          sub_25DB0(off_60148->Dpc.ProcessorHistory, 72i64, (__int64)&unk_5CDD8, v20, *(_QWORD *)v20, v16);
          v4 = off_60148;
        }
        if ( *(_DWORD *)(v9 + 372) == *a1 )
        {
          if ( v4 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(v4->Dpc.DeferredContext) & 0x20) != 0
            && BYTE1(v4->Dpc.DeferredContext) >= 5u )
          {
            sub_2F80C(v4->Dpc.ProcessorHistory, 0x49u, (__int64)&unk_5CDD8, v7, v15);
          }
          v10 = *v7;
          v11 = (__int64 *)v7[1];
          *v11 = *v7;
          *(_QWORD *)(v10 + 8) = v11;
          v2 = 1;
          LODWORD(v15) = 0;
          sub_3FAE4((__int64)qword_612D0, (__int64)v7);
          v4 = off_60148;
        }
        if ( !BugCheckParameter1 )
          goto LABEL_30;
        sub_243C4(BugCheckParameter1, 28);
        BugCheckParameter1 = 0i64;
      }
      v4 = off_60148;
LABEL_30:
      if ( (__int64 *)v6 == v5 + 2 )
      {
        if ( v2 )
        {
          if ( v4 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(v4->Dpc.DeferredContext) & 0x20) != 0
            && BYTE1(v4->Dpc.DeferredContext) >= 5u )
          {
            LODWORD(v15) = *(_DWORD *)(v17 + 36);
            sub_11230(v4->Dpc.ProcessorHistory, 0x4Au, (__int64)&unk_5CDD8, *(_QWORD *)(v17 + 40), v15);
          }
          v12 = *(_QWORD *)v17;
          v13 = *(_QWORD **)(v17 + 8);
          *v13 = *(_QWORD *)v17;
          *(_QWORD *)(v12 + 8) = v13;
          LODWORD(v15) = 0;
          sub_3FAE4((__int64)qword_612C8, v17);
          v4 = off_60148;
        }
        goto LABEL_37;
      }
    }
  }
LABEL_38:
  sub_40230(&qword_650B0, v18);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x4Bu, (__int64)&unk_5CDD8);
  }
  return 0i64;
}
// 2818E: variable 'v16' is possibly undefined
// 2824F: variable 'v15' is possibly undefined
// 650A0: using guessed type __int64 qword_650A0;

//----- (00000000000283CC) ----------------------------------------------------
__int64 __fastcall sub_283CC(__int64 a1)
{
  unsigned __int8 v2; // r13
  __int64 *v3; // rsi
  PDEVICE_OBJECT v4; // r10
  __int64 v5; // rbx
  _QWORD *v6; // rbp
  __int64 v7; // rdi
  __int64 v8; // r12
  __int64 v9; // rcx
  _QWORD *v10; // rax
  _QWORD *v11; // rax
  __int64 v12; // rcx
  _QWORD *v13; // rax
  __int64 v14; // rdx
  __int64 v16; // [rsp+20h] [rbp-48h]
  __int64 v17; // [rsp+28h] [rbp-40h]
  __int64 v18; // [rsp+30h] [rbp-38h]
  __int64 v19; // [rsp+38h] [rbp-30h]
  KIRQL v20; // [rsp+78h] [rbp+10h] BYREF

  v2 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x4Cu, (__int64)&unk_5CDD8, a1);
  }
  LODWORD(v16) = 0;
  sub_401B8(&qword_650B0, &v20);
  v3 = (__int64 *)qword_650A0;
  if ( (__int64 *)qword_650A0 != &qword_650A0 )
  {
    v4 = off_60148;
    while ( 1 )
    {
      v5 = (__int64)v3;
      if ( v4 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v4->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(v4->Dpc.DeferredContext) >= 5u )
      {
        sub_2F80C(v4->Dpc.ProcessorHistory, 0x4Du, (__int64)&unk_5CDD8, v3[5], v16);
        v4 = off_60148;
      }
      if ( v3[5] == a1 )
      {
        if ( v4 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v4->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(v4->Dpc.DeferredContext) >= 5u )
        {
          sub_2F80C(v4->Dpc.ProcessorHistory, 0x4Eu, (__int64)&unk_5CDD8);
          v4 = off_60148;
        }
        v2 = 1;
      }
      v3 = (__int64 *)*v3;
      v6 = (_QWORD *)(v5 + 16);
      v7 = *(_QWORD *)(v5 + 16);
      if ( v7 != v5 + 16 )
      {
        while ( 1 )
        {
          v8 = v7;
          if ( v4 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(v4->Dpc.DeferredContext) & 0x20) != 0
            && BYTE1(v4->Dpc.DeferredContext) >= 5u )
          {
            LODWORD(v17) = *(unsigned __int8 *)(v7 + 24);
            sub_25E14(v4->Dpc.ProcessorHistory, 0x4Fu, (__int64)&unk_5CDD8, v7, *(_QWORD *)(v7 + 16), v17);
            v4 = off_60148;
          }
          v7 = *(_QWORD *)v7;
          if ( *(_QWORD *)(v8 + 16) == a1 || v2 )
            break;
          if ( (_QWORD *)v7 == v6 )
            goto LABEL_36;
        }
        if ( v4 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v4->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(v4->Dpc.DeferredContext) >= 5u )
        {
          LODWORD(v19) = v2;
          LODWORD(v18) = *(unsigned __int16 *)(v8 + 28);
          LODWORD(v17) = *(_DWORD *)(v5 + 36);
          sub_25E74(v4->Dpc.ProcessorHistory, 80i64, (__int64)&unk_5CDD8, v8, *(_QWORD *)(v8 + 16), v17, v18, v19);
        }
        *(_DWORD *)(v5 + 36) += *(unsigned __int16 *)(v8 + 28);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          sub_112FC(off_60148->Dpc.ProcessorHistory, 0x51u, (__int64)&unk_5CDD8, *(_DWORD *)(v5 + 36));
        }
        v9 = *(_QWORD *)v8;
        v10 = *(_QWORD **)(v8 + 8);
        LODWORD(v16) = 0;
        *v10 = *(_QWORD *)v8;
        *(_QWORD *)(v9 + 8) = v10;
        sub_3FAE4((__int64)qword_612D0, v8);
        v4 = off_60148;
      }
      if ( v2 )
        break;
LABEL_36:
      if ( (_QWORD *)*v6 == v6 )
      {
        if ( v4 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v4->Dpc.DeferredContext) & 0x20) != 0
          && BYTE1(v4->Dpc.DeferredContext) >= 5u )
        {
          sub_2F80C(v4->Dpc.ProcessorHistory, 0x53u, (__int64)&unk_5CDD8, *(_QWORD *)(v5 + 40), v16);
        }
        v11 = *(_QWORD **)(v5 + 8);
        v12 = *(_QWORD *)v5;
        *v11 = *(_QWORD *)v5;
        *(_QWORD *)(v12 + 8) = v11;
        goto LABEL_49;
      }
      if ( v3 == &qword_650A0 )
        goto LABEL_50;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v4->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(v4->Dpc.DeferredContext) >= 5u )
    {
      LODWORD(v16) = *(_DWORD *)(v5 + 36);
      sub_11230(v4->Dpc.ProcessorHistory, 0x52u, (__int64)&unk_5CDD8, *(_QWORD *)(v5 + 40), v16);
    }
    v13 = *(_QWORD **)(v5 + 8);
    v14 = *(_QWORD *)v5;
    *v13 = *(_QWORD *)v5;
    *(_QWORD *)(v14 + 8) = v13;
LABEL_49:
    sub_3FAE4((__int64)qword_612C8, v5);
  }
LABEL_50:
  sub_40230(&qword_650B0, v20);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x54u, (__int64)&unk_5CDD8);
  }
  return 0i64;
}
// 28495: variable 'v16' is possibly undefined
// 28543: variable 'v17' is possibly undefined
// 285C8: variable 'v18' is possibly undefined
// 285C8: variable 'v19' is possibly undefined
// 650A0: using guessed type __int64 qword_650A0;

//----- (000000000002879C) ----------------------------------------------------
__int64 sub_2879C()
{
  __int64 *v0; // rdi
  __int64 v1; // rsi
  PDEVICE_OBJECT v2; // rcx
  __int64 *i; // rbx
  __int64 *v4; // rbp
  __int64 v5; // rcx
  __int64 *v6; // rax
  __int64 v7; // rcx
  _QWORD *v8; // rax
  __int64 v10; // [rsp+20h] [rbp-28h]
  __int64 v11; // [rsp+28h] [rbp-20h]
  KIRQL v12; // [rsp+50h] [rbp+8h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x55u, (__int64)&unk_5CDD8);
  }
  LODWORD(v10) = 0;
  sub_401B8(&qword_650B0, &v12);
  v0 = (__int64 *)qword_650A0;
  while ( v0 != &qword_650A0 )
  {
    v1 = (__int64)v0;
    v2 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x56u, (__int64)&unk_5CDD8, v0[5], v10);
      v2 = off_60148;
    }
    v0 = (__int64 *)*v0;
    for ( i = *(__int64 **)(v1 + 16); i != (__int64 *)(v1 + 16); v2 = off_60148 )
    {
      v4 = i;
      if ( v2 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v2->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(v2->Dpc.DeferredContext) >= 5u )
      {
        LODWORD(v11) = *((unsigned __int8 *)i + 24);
        sub_25E14(v2->Dpc.ProcessorHistory, 0x57u, (__int64)&unk_5CDD8, i, i[2], v11);
        v2 = off_60148;
      }
      i = (__int64 *)*i;
      if ( v2 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v2->Dpc.DeferredContext) & 0x20) != 0
        && BYTE1(v2->Dpc.DeferredContext) >= 5u )
      {
        sub_25D5C(v2->Dpc.ProcessorHistory, 88i64, (__int64)&unk_5CDD8, v4, v4[2]);
      }
      v5 = *v4;
      v6 = (__int64 *)v4[1];
      *v6 = *v4;
      *(_QWORD *)(v5 + 8) = v6;
      sub_3FAE4((__int64)qword_612D0, (__int64)v4);
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Dpc.DeferredContext) & 0x20) != 0
      && BYTE1(v2->Dpc.DeferredContext) >= 5u )
    {
      LODWORD(v10) = *(_DWORD *)(v1 + 36);
      sub_11230(v2->Dpc.ProcessorHistory, 0x59u, (__int64)&unk_5CDD8, *(_QWORD *)(v1 + 40), v10);
    }
    v7 = *(_QWORD *)v1;
    v8 = *(_QWORD **)(v1 + 8);
    LODWORD(v10) = 0;
    *v8 = *(_QWORD *)v1;
    *(_QWORD *)(v7 + 8) = v8;
    sub_3FAE4((__int64)qword_612C8, v1);
  }
  sub_40230(&qword_650B0, v12);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x20) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x5Au, (__int64)&unk_5CDD8);
  }
  return 0i64;
}
// 28858: variable 'v10' is possibly undefined
// 288B9: variable 'v11' is possibly undefined
// 650A0: using guessed type __int64 qword_650A0;

//----- (0000000000028A20) ----------------------------------------------------
void sub_28A20()
{
  KIRQL v0; // [rsp+40h] [rbp+8h] BYREF

  sub_401B8(&SpinLock, &v0);
  dword_6509C = 1;
  sub_40230(&SpinLock, v0);
}
// 6509C: using guessed type int dword_6509C;

//----- (0000000000028A70) ----------------------------------------------------
__int64 sub_28A70()
{
  unsigned int v0; // ebx
  KIRQL v2; // [rsp+40h] [rbp+8h] BYREF

  sub_401B8(&SpinLock, &v2);
  if ( dword_6509C )
  {
    v0 = 1;
    ++dword_65098;
  }
  else
  {
    v0 = 0;
  }
  sub_40230(&SpinLock, v2);
  return v0;
}
// 65098: using guessed type int dword_65098;
// 6509C: using guessed type int dword_6509C;

//----- (0000000000028AD8) ----------------------------------------------------
void sub_28AD8()
{
  KIRQL v0; // [rsp+40h] [rbp+8h] BYREF

  sub_401B8(&SpinLock, &v0);
  --dword_65098;
  sub_40230(&SpinLock, v0);
}
// 65098: using guessed type int dword_65098;

//----- (0000000000028B24) ----------------------------------------------------
__int64 __fastcall sub_28B24(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CDC8, 10i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000028B88) ----------------------------------------------------
__int64 __fastcall sub_28B88(__int64 a1, __int64 a2, __int64 a3, int a4, _WORD *a5)
{
  __int64 v6; // rcx
  _WORD *v7; // rdi
  bool v8; // zf
  int v10; // [rsp+78h] [rbp+20h] BYREF

  v10 = a4;
  if ( a5 && *a5 )
  {
    v6 = -1i64;
    v7 = a5;
    do
    {
      if ( !v6 )
        break;
      v8 = *v7++ == 0;
      --v6;
    }
    while ( !v8 );
  }
  return qword_61238(a1, 43i64, &unk_5CDC8, 16i64, &v10);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000028C34) ----------------------------------------------------
unsigned __int8 __fastcall sub_28C34(int a1, _DWORD *a2, _DWORD *a3, _DWORD *a4)
{
  unsigned __int8 v8; // bp

  v8 = 1;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_28B24(*(_QWORD *)&off_60148->AlignmentRequirement, 10i64, (__int64)&unk_5CDC8, a1);
  }
  switch ( a1 )
  {
    case 33595393:
      *a2 = 0;
      goto LABEL_7;
    case 33595394:
      *a2 = 4;
      goto LABEL_7;
    case 33595395:
      *a2 = 8;
      goto LABEL_7;
    case 33595396:
      *a2 = 12;
      goto LABEL_7;
    case 33595397:
      *a2 = 16;
      goto LABEL_7;
    case 33595398:
      *a2 = 20;
      goto LABEL_7;
    case 33595399:
      *a2 = 3124;
      goto LABEL_19;
    case 33595400:
      *a2 = 3133;
      goto LABEL_7;
    case 33595401:
      *a2 = 3141;
      goto LABEL_7;
    case 33595402:
      *a2 = 3145;
      *a3 = 260;
      goto LABEL_17;
    case 33595403:
      *a2 = 3125;
      goto LABEL_7;
    case 33595404:
      *a2 = 24;
      *a3 = 4;
      goto LABEL_14;
    case 33595405:
      *a2 = 80;
      goto LABEL_16;
    case 33595406:
      *a2 = 1104;
      *a3 = 2020;
      goto LABEL_17;
    case 33595407:
      *a2 = 28;
      goto LABEL_7;
    case 33595408:
      *a2 = 32;
      goto LABEL_7;
    case 33595409:
      *a2 = 36;
      goto LABEL_7;
    case 33595410:
      *a2 = 40;
      goto LABEL_7;
    case 33595411:
      *a2 = 44;
      goto LABEL_7;
    case 33595412:
      *a2 = 48;
      goto LABEL_7;
    case 33595413:
      *a2 = 52;
      goto LABEL_7;
    case 33595414:
      *a2 = 56;
      goto LABEL_7;
    case 33595415:
      *a2 = 60;
      goto LABEL_7;
    case 33595416:
      *a2 = 64;
      goto LABEL_7;
    case 33595417:
      *a2 = 68;
      goto LABEL_7;
    case 33595418:
      *a2 = 72;
      goto LABEL_7;
    case 33595419:
      *a2 = 76;
      goto LABEL_7;
    case 33595420:
      *a2 = 3408;
      goto LABEL_7;
    case 33595421:
      *a2 = 3412;
      goto LABEL_7;
    case 33595423:
      *a2 = 3416;
      goto LABEL_7;
    case 33595424:
      *a2 = 3420;
      goto LABEL_7;
    case 33595425:
      *a2 = 3432;
      goto LABEL_51;
    case 33595426:
      *a2 = 3424;
      goto LABEL_7;
    case 33595427:
      *a2 = 3428;
      goto LABEL_7;
    case 33595428:
      *a2 = 7528;
      goto LABEL_7;
    case 33595429:
      *a2 = 7532;
      goto LABEL_7;
    case 33595430:
      *a2 = 7536;
      goto LABEL_7;
    case 33595431:
      *a2 = 7540;
      goto LABEL_7;
    case 33595432:
      *a2 = 7544;
      goto LABEL_7;
    case 33595433:
      *a2 = 7548;
      goto LABEL_7;
    case 33595434:
      *a2 = 7552;
      goto LABEL_7;
    case 33595435:
      *a2 = 7556;
      goto LABEL_7;
    case 33595436:
      *a2 = 7560;
      goto LABEL_7;
    case 33595437:
      *a2 = 7564;
      goto LABEL_7;
    case 33595438:
      *a2 = 7568;
      goto LABEL_7;
    case 33595439:
      *a2 = 7572;
      goto LABEL_7;
    case 33595440:
      *a2 = 7576;
      goto LABEL_7;
    case 33595441:
      *a2 = 7580;
      goto LABEL_7;
    case 33595442:
      *a2 = 3129;
      goto LABEL_7;
    case 33595443:
      *a2 = 3137;
      goto LABEL_7;
    case 33595444:
      *a2 = 7584;
      goto LABEL_7;
    case 33595445:
      *a2 = 7588;
      goto LABEL_7;
    case 33595446:
      *a2 = 7592;
LABEL_51:
      *a3 = 4096;
      *a4 = 4;
      break;
    case 33595447:
      *a2 = 11688;
      goto LABEL_7;
    case 33595448:
      *a2 = 11692;
      goto LABEL_7;
    case 33595449:
      *a2 = 11696;
      goto LABEL_7;
    case 33595450:
      *a2 = 11700;
      goto LABEL_7;
    case 33595456:
      *a2 = 11704;
      goto LABEL_7;
    case 33595457:
      *a2 = 11708;
      *a3 = 1;
      *a4 = 5;
      break;
    case 33595458:
      *a2 = 11728;
      goto LABEL_73;
    case 33595459:
      *a2 = 11736;
      goto LABEL_7;
    case 33595460:
      *a2 = 11740;
      goto LABEL_19;
    case 33595461:
      *a2 = 11744;
LABEL_73:
      *a3 = 8;
      *a4 = 7;
      break;
    case 33595462:
      *a2 = 11752;
      goto LABEL_7;
    case 33595463:
      *a2 = 11756;
      goto LABEL_19;
    case 33595464:
      *a2 = 11709;
      goto LABEL_19;
    case 33595465:
      *a2 = 11712;
      goto LABEL_7;
    case 33595466:
      *a2 = 11716;
      goto LABEL_7;
    case 33595488:
      *a2 = 11760;
LABEL_7:
      *a3 = 4;
      *a4 = 0;
      break;
    case 33595489:
      *a2 = 11764;
LABEL_16:
      *a3 = 1024;
      goto LABEL_17;
    case 33595490:
      *a2 = 12788;
      *a3 = 512;
LABEL_17:
      *a4 = 2;
      break;
    case 33595491:
      *a2 = 13300;
      goto LABEL_19;
    case 33595492:
      *a2 = 13301;
LABEL_19:
      *a3 = 1;
LABEL_14:
      *a4 = 1;
      break;
    default:
      v8 = 0;
      break;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xBu, (__int64)&unk_5CDC8, v8);
  }
  return v8;
}

//----- (000000000002920C) ----------------------------------------------------
PDEVICE_OBJECT *__fastcall sub_2920C(__int64 a1)
{
  PDEVICE_OBJECT *result; // rax

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0xCu, (__int64)&unk_5CDC8, a1);
  }
  *(_DWORD *)(a1 + 12) = 10;
  *(_DWORD *)(a1 + 44) = 10;
  *(_DWORD *)a1 = 1;
  *(_DWORD *)(a1 + 4) = 0;
  *(_DWORD *)(a1 + 8) = 5;
  *(_DWORD *)(a1 + 16) = 5000;
  *(_DWORD *)(a1 + 52) = 3;
  *(_DWORD *)(a1 + 56) = 3;
  *(_DWORD *)(a1 + 20) = 5000;
  *(_DWORD *)(a1 + 24) = 0;
  *(_DWORD *)(a1 + 28) = 0;
  *(_DWORD *)(a1 + 64) = 0;
  *(_DWORD *)(a1 + 68) = 0;
  *(_DWORD *)(a1 + 72) = 60;
  *(_DWORD *)(a1 + 76) = 30;
  *(_DWORD *)(a1 + 3428) = 0x7FFFFFFF;
  *(_DWORD *)(a1 + 32) = 60;
  *(_DWORD *)(a1 + 60) = 1;
  *(_DWORD *)(a1 + 36) = 255;
  *(_DWORD *)(a1 + 40) = 6;
  *(_DWORD *)(a1 + 48) = 200;
  memset((void *)(a1 + 1104), 0, 0x7E4ui64);
  sub_58950((_WORD *)(a1 + 1104), 1010i64, L"ms_bridge|vms_mp|vms_vsmp", -1i64);
  *(_DWORD *)(a1 + 3408) = 0;
  *(_DWORD *)(a1 + 3412) = 0;
  *(_DWORD *)(a1 + 7552) = 1;
  *(_DWORD *)(a1 + 3416) = 60;
  *(_DWORD *)(a1 + 7588) = 60;
  *(_DWORD *)(a1 + 3420) = 0;
  memset((void *)(a1 + 3432), 0, 0x1000ui64);
  memset((void *)(a1 + 7592), 0, 0x1000ui64);
  *(_DWORD *)(a1 + 7568) = 5000;
  *(_DWORD *)(a1 + 3424) = 0;
  *(_DWORD *)(a1 + 7528) = 5;
  *(_DWORD *)(a1 + 7532) = 5;
  *(_DWORD *)(a1 + 3141) = 512;
  *(_DWORD *)(a1 + 7536) = 0;
  *(_DWORD *)(a1 + 7544) = 0;
  *(_DWORD *)(a1 + 7548) = 5;
  *(_DWORD *)(a1 + 7556) = 0;
  *(_DWORD *)(a1 + 7560) = 0;
  *(_DWORD *)(a1 + 7564) = 61471;
  *(_DWORD *)(a1 + 7572) = 4;
  *(_DWORD *)(a1 + 7576) = 1;
  *(_DWORD *)(a1 + 7580) = 0;
  *(_DWORD *)(a1 + 7584) = 0;
  *(_BYTE *)(a1 + 3124) = 0;
  *(_DWORD *)(a1 + 3125) = 1;
  *(_DWORD *)(a1 + 3129) = 1;
  *(_DWORD *)(a1 + 3133) = 1;
  *(_DWORD *)(a1 + 3137) = 604800;
  if ( (int)unknown_libname_2(a1 + 3145, 130i64, 0x7FFFFFFFi64) >= 0 )
    RtlStringCopyWorkerW((NTSTRSAFE_PWSTR)(a1 + 3145), 0x82ui64, 0i64, L"PSCapture", 0x7FFFFFFEui64);
  sub_58950((_WORD *)(a1 + 80), 512i64, (__int16 *)qword_5AC90, -1i64);
  memset((void *)(a1 + 7592), 0, 0x1000ui64);
  *(_QWORD *)(a1 + 11728) = 864000000000i64;
  *(_DWORD *)(a1 + 11688) = 0;
  *(_DWORD *)(a1 + 11736) = 0x20000;
  *(_DWORD *)(a1 + 11752) = 0x20000;
  *(_DWORD *)(a1 + 11692) = 0;
  *(_DWORD *)(a1 + 11700) = 0;
  *(_DWORD *)(a1 + 11704) = 1;
  *(_BYTE *)(a1 + 11709) = 1;
  *(_BYTE *)(a1 + 11708) = 2;
  *(_DWORD *)(a1 + 11712) = 0;
  *(_DWORD *)(a1 + 11716) = 1;
  *(_BYTE *)(a1 + 11740) = 1;
  *(_BYTE *)(a1 + 11756) = 1;
  *(_QWORD *)(a1 + 11744) = 1200000000i64;
  *(_DWORD *)(a1 + 11760) = 1;
  *(_BYTE *)(a1 + 13300) = 0;
  *(_BYTE *)(a1 + 13301) = 0;
  sub_58950(
    (_WORD *)(a1 + 11764),
    512i64,
    L"HTTP:80:8080:3128|HTTPS:443|POP3:110|DNS:53|DHCP:67:68|DHCPV6:546:547",
    -1i64);
  memset((void *)(a1 + 12788), 0, 0x200ui64);
  result = &off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    result = (PDEVICE_OBJECT *)sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0xDu, (__int64)&unk_5CDC8, a1);
  }
  return result;
}
// 5A160: using guessed type __int64 __fastcall unknown_libname_2(_QWORD, _QWORD, _QWORD);
// 5AC30: using guessed type wchar_t aMsBridgeVmsMpV[26];
// 5AC90: using guessed type __int64 qword_5AC90[2];
// 5ACA0: using guessed type wchar_t aHttp8080803128[70];

//----- (000000000002957C) ----------------------------------------------------
void __fastcall sub_2957C(__int64 a1)
{
  unsigned int v2; // eax
  __int64 v3; // rax
  void *v4; // rbx
  int v5; // eax
  int v6; // eax
  char *v7; // rbx
  int v8; // ebx
  int v9; // eax
  int v10; // ebx
  int v11; // eax
  int v12; // ebx
  int v13; // eax
  __int64 *v14; // rcx
  int v15; // eax
  PDEVICE_OBJECT v16; // rcx
  unsigned __int16 v17; // dx
  int v18; // er9
  int v19; // eax
  PDEVICE_OBJECT v20; // rcx
  __int64 v21; // rcx
  char v22; // r8
  __int16 v23; // [rsp+40h] [rbp-258h] BYREF
  char v24[258]; // [rsp+42h] [rbp-256h] BYREF
  __int16 v25; // [rsp+150h] [rbp-148h] BYREF
  char Dst[258]; // [rsp+152h] [rbp-146h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0xEu, (__int64)&unk_5CDC8, a1);
  }
  if ( (*(_BYTE *)a1 & 4) != 0 )
  {
    v2 = sub_502CC(0x200A003u);
    if ( v2 )
    {
      v3 = sub_48380(v2);
      if ( v3 )
      {
        v4 = (void *)_InterlockedExchange64(&qword_61270, v3);
        if ( v4 )
        {
          sub_502CC(0x200A004u);
          v5 = sub_486D4(v4);
          if ( v5 )
          {
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
              && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
            {
              sub_11148(*(_QWORD *)&off_60148->AlignmentRequirement, 0xFu, (__int64)&unk_5CDC8, v5);
            }
          }
        }
      }
    }
    dword_653F0 = sub_502CC(0x200A003u);
  }
  if ( _bittest((const signed __int32 *)a1, 8u) )
  {
    v6 = sub_502CC(0x200A009u);
    v7 = sub_3F8D8(2, v6 + 5, 0x6C54734Eu);
    dword_653EC = sub_502CC(0x200A009u);
    if ( _InterlockedCompareExchange64((volatile signed __int64 *)&qword_612B0, (signed __int64)v7, 0i64) )
      sub_3F95C(v7);
  }
  if ( (*(_BYTE *)a1 & 0x40) != 0 )
  {
    v8 = 0;
    byte_653E0 = sub_502CC(0x200A007u);
    if ( byte_653E0 )
    {
      v25 = 0;
      memset(Dst, 0, sizeof(Dst));
      v23 = 0;
      memset(v24, 0, sizeof(v24));
      v9 = sub_50028(33595402i64, &v25);
      if ( !v9 )
      {
        if ( (unsigned int)sub_502CC(0x200A00Bu) == 2 )
        {
          sub_58B00((char *)&v23, 0x82ui64, 0x82ui64, L"%s_Internal.%s.%s", &v25, L"PSCapture", L"pcap");
          v10 = sub_502CC(0x200A033u);
          v11 = sub_502CC(0x200A008u);
          sub_4DE8C((__int64)L"\\SystemRoot\\system32\\drivers\\", (__int64)&v23, v11 << 20, v10, &qword_61298);
          sub_58B00((char *)&v23, 0x82ui64, 0x82ui64, L"%s_External.%s.%s", &v25, L"PSCapture", L"pcap");
          v12 = sub_502CC(0x200A033u);
          v13 = sub_502CC(0x200A008u);
          v14 = &qword_612A0;
        }
        else
        {
          sub_58B00((char *)&v23, 0x82ui64, 0x82ui64, L"%s.%s.%s", &v25, L"PSCapture", L"pcap");
          v12 = sub_502CC(0x200A033u);
          v13 = sub_502CC(0x200A008u);
          v14 = &qword_61290;
        }
        v15 = sub_4DE8C((__int64)L"\\SystemRoot\\system32\\drivers\\", (__int64)&v23, v13 << 20, v12, v14);
        if ( v15
          && off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 8u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_28B88(off_60148->Dpc.ProcessorHistory, 16i64, (__int64)&unk_5CDC8, v15, &v25);
        }
        goto LABEL_45;
      }
      v16 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 8u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_45;
      }
      v17 = 17;
      v18 = v9;
LABEL_44:
      sub_112FC(v16->Dpc.ProcessorHistory, v17, (__int64)&unk_5CDC8, v18);
      goto LABEL_45;
    }
    if ( qword_61290 )
      v8 = sub_4EC48((PVOID *)&qword_61290);
    if ( *(_QWORD *)&qword_61298 )
      v8 = sub_4EC48((PVOID *)&qword_61298);
    if ( qword_612A0 )
      v8 = sub_4EC48((PVOID *)&qword_612A0);
    if ( v8 )
    {
      v16 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 8u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
      {
        v17 = 18;
        v18 = v8;
        goto LABEL_44;
      }
    }
  }
LABEL_45:
  if ( _bittest((const signed __int32 *)a1, 0xBu) )
    dword_653E8 = sub_502CC(0x200A00Cu);
  if ( _bittest((const signed __int32 *)a1, 0xCu) )
    sub_2A0B4();
  if ( (*(_BYTE *)(a1 + 4) & 1) != 0 )
    sub_2A310();
  if ( _bittest((const signed __int32 *)(a1 + 4), 0x16u) )
    dword_65440 = sub_502CC(0x200A037u);
  if ( _bittest((const signed __int32 *)(a1 + 4), 0x17u) )
    dword_65444 = sub_502CC(0x200A038u);
  if ( _bittest((const signed __int32 *)(a1 + 4), 0x18u) && byte_62222 )
    sub_3DA44();
  if ( _bittest((const signed __int32 *)a1, 0xDu) )
    sub_2A65C();
  if ( _bittest((const signed __int32 *)a1, 0xEu) )
  {
    dword_65430 = sub_502CC(0x200A00Fu);
    if ( !dword_65430 )
    {
      v19 = sub_2FA74();
      if ( v19 )
      {
        v20 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        {
LABEL_72:
          sub_2F3D8();
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
          {
            sub_11008(off_60148->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_5CDC8);
          }
          goto LABEL_76;
        }
        if ( !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
          || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
        {
LABEL_68:
          if ( v20 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v20->Dpc.DeferredContext + 1, 0xEu)
            && BYTE1(v20->Dpc.DeferredContext) >= 2u )
          {
            sub_11008(v20->Dpc.ProcessorHistory, 0x14u, (__int64)&unk_5CDC8);
          }
          goto LABEL_72;
        }
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_5CDC8, v19);
      }
      v20 = off_60148;
      goto LABEL_68;
    }
  }
LABEL_76:
  if ( (*(_BYTE *)a1 & 1) != 0 )
    dword_653E4 = sub_502CC(0x200A001u);
  if ( _bittest((const signed __int32 *)a1, 0x18u) )
    dword_653F4 = sub_502CC(0x200A019u);
  if ( _bittest((const signed __int32 *)(a1 + 4), 0xAu) )
    dword_65428 = sub_502CC(0x200A02Bu);
  if ( _bittest((const signed __int32 *)(a1 + 4), 0xBu) )
    dword_6542C = sub_502CC(0x200A02Cu);
  if ( (*(_BYTE *)a1 & 0x10) != 0 )
    dword_65434 = sub_502CC(0x200A005u);
  if ( (*(_BYTE *)a1 & 0x20) != 0 )
    dword_65438 = sub_502CC(0x200A006u);
  if ( *(char *)(a1 + 4) < 0 )
    dword_6543C = sub_502CC(0x200A028u);
  if ( _bittest((const signed __int32 *)a1, 0x1Bu) )
    dword_653F8 = sub_502CC(0x200A01Cu);
  if ( _bittest((const signed __int32 *)a1, 0x1Cu) )
    dword_653FC = sub_502CC(0x200A01Du);
  if ( _bittest((const signed __int32 *)(a1 + 4), 9u) )
    dword_65414 = sub_502CC(0x200A02Au);
  if ( _bittest((const signed __int32 *)a1, 0x1Fu) )
    dword_65404 = sub_502CC(0x200A020u);
  if ( (*(_BYTE *)(a1 + 4) & 2) != 0 )
    dword_65408 = sub_502CC(0x200A022u);
  if ( (*(_BYTE *)(a1 + 4) & 4) != 0 )
    dword_6540C = sub_502CC(0x200A023u);
  if ( _bittest((const signed __int32 *)a1, 0x1Eu) )
    dword_65400 = sub_502CC(0x200A01Fu);
  if ( (*(_BYTE *)(a1 + 4) & 0x20) != 0 )
  {
    if ( (unsigned int)sub_502CC(0x200A026u) )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x17u, (__int64)&unk_5CDC8);
      }
      v21 = qword_613E8;
      byte_6128A = 1;
      if ( qword_613E8 )
      {
        v22 = 1;
        goto LABEL_118;
      }
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x16u, (__int64)&unk_5CDC8);
      }
      v21 = qword_613E8;
      byte_6128A = 0;
      if ( qword_613E8 )
      {
        v22 = 0;
LABEL_118:
        sub_58100(v21, 0i64, v22);
        goto LABEL_119;
      }
    }
  }
LABEL_119:
  if ( _bittest((const signed __int32 *)(a1 + 4), 8u) )
    dword_65410 = sub_502CC(0x200A029u);
  if ( _bittest((const signed __int32 *)(a1 + 4), 0xFu) )
    dword_65418 = sub_502CC(0x200A030u);
  if ( _bittest((const signed __int32 *)(a1 + 4), 0x10u) )
    dword_6541C = sub_502CC(0x200A031u);
  if ( _bittest((const signed __int32 *)(a1 + 4), 0x11u) )
    dword_65420 = sub_502CC(0x200A032u);
  if ( _bittest((const signed __int32 *)(a1 + 4), 0x13u) && (unsigned int)sub_502CC(0x200A034u) == -553727280 )
    KeBugCheckEx(0xE2u, 0i64, 0i64, 0i64, 0i64);
  if ( _bittest((const signed __int32 *)a1, 0xAu) )
    dword_65424 = sub_502CC(0x200A00Bu);
  if ( _bittest((const signed __int32 *)(a1 + 4), 0x19u) )
    dword_65448 = sub_502CC(0x200A03Au);
  if ( _bittest((const signed __int32 *)(a1 + 4), 0x1Fu) )
    dword_6544C = sub_502CC(0x200A040u);
  if ( _bittest((const signed __int32 *)(a1 + 8), 9u) )
    dword_65458 = sub_502CC(0x200A04Au);
  if ( *(char *)(a1 + 8) < 0 )
    byte_65451 = sub_502CC(0x200A048u);
  if ( _bittest((const signed __int32 *)(a1 + 8), 8u) )
    dword_65454 = sub_502CC(0x200A049u);
  if ( (*(_BYTE *)(a1 + 8) & 1) != 0 )
    byte_65450 = sub_502CC(0x200A041u);
  if ( (*(_BYTE *)(a1 + 8) & 8) != 0 )
    byte_6546C = sub_502CC(0x200A044u);
  if ( (*(_BYTE *)(a1 + 8) & 4) != 0 )
    dword_65468 = sub_502CC(0x200A043u);
  if ( (*(_BYTE *)(a1 + 8) & 2) != 0 )
    qword_65460 = sub_50538(0x200A042u);
  if ( (*(_BYTE *)(a1 + 8) & 0x40) != 0 )
    byte_6547C = sub_502CC(0x200A047u);
  if ( (*(_BYTE *)(a1 + 8) & 0x20) != 0 )
    dword_65478 = sub_502CC(0x200A046u);
  if ( (*(_BYTE *)(a1 + 8) & 0x10) != 0 )
    qword_65470 = sub_50538(0x200A045u);
  if ( (*(_BYTE *)(a1 + 12) & 1) != 0 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x18u, (__int64)&unk_5CDC8);
    }
    sub_2B354();
  }
  if ( (*(_BYTE *)(a1 + 12) & 2) != 0 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x19u, (__int64)&unk_5CDC8);
    }
    sub_2B828();
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Au, (__int64)&unk_5CDC8);
  }
}
// 5AD30: using guessed type wchar_t aPcap[5];
// 5AD40: using guessed type wchar_t aSInternalSS[18];
// 5AD70: using guessed type wchar_t aSystemrootSyst[30];
// 5ADB0: using guessed type wchar_t aSExternalSS[18];
// 5ADE0: using guessed type wchar_t aSSS[9];
// 61270: using guessed type __int64 qword_61270;
// 6128A: using guessed type char byte_6128A;
// 61290: using guessed type __int64 qword_61290;
// 612A0: using guessed type __int64 qword_612A0;
// 62222: using guessed type char byte_62222;
// 653E0: using guessed type char byte_653E0;
// 653E4: using guessed type int dword_653E4;
// 653E8: using guessed type int dword_653E8;
// 653EC: using guessed type int dword_653EC;
// 653F0: using guessed type int dword_653F0;
// 653F4: using guessed type int dword_653F4;
// 653F8: using guessed type int dword_653F8;
// 653FC: using guessed type int dword_653FC;
// 65400: using guessed type int dword_65400;
// 65404: using guessed type int dword_65404;
// 65408: using guessed type int dword_65408;
// 6540C: using guessed type int dword_6540C;
// 65410: using guessed type int dword_65410;
// 65414: using guessed type int dword_65414;
// 65418: using guessed type int dword_65418;
// 6541C: using guessed type int dword_6541C;
// 65420: using guessed type int dword_65420;
// 65424: using guessed type int dword_65424;
// 65428: using guessed type int dword_65428;
// 6542C: using guessed type int dword_6542C;
// 65430: using guessed type int dword_65430;
// 65434: using guessed type int dword_65434;
// 65438: using guessed type int dword_65438;
// 6543C: using guessed type int dword_6543C;
// 65440: using guessed type int dword_65440;
// 65444: using guessed type int dword_65444;
// 65448: using guessed type int dword_65448;
// 6544C: using guessed type int dword_6544C;
// 65450: using guessed type char byte_65450;
// 65451: using guessed type char byte_65451;
// 65454: using guessed type int dword_65454;
// 65458: using guessed type int dword_65458;
// 65460: using guessed type __int64 qword_65460;
// 65468: using guessed type int dword_65468;
// 6546C: using guessed type char byte_6546C;
// 65470: using guessed type __int64 qword_65470;
// 65478: using guessed type int dword_65478;
// 6547C: using guessed type char byte_6547C;

//----- (0000000000029F60) ----------------------------------------------------
__int64 sub_29F60()
{
  int v0; // eax
  __int64 v2[4]; // [rsp+20h] [rbp-C8h] BYREF
  int v3; // [rsp+40h] [rbp-A8h] BYREF
  char Dst[32]; // [rsp+44h] [rbp-A4h] BYREF
  char v5[96]; // [rsp+64h] [rbp-84h] BYREF
  int v6[3]; // [rsp+C4h] [rbp-24h] BYREF

  v3 = 33595392;
  memmove(Dst, L"NetworkProvider", 0x20ui64);
  memset(v5, 0, sizeof(v5));
  qmemcpy(v6, "NNSPd", 5);
  v2[0] = (__int64)sub_28C34;
  v2[1] = (__int64)sub_2920C;
  v2[2] = (__int64)sub_2957C;
  v2[3] = (__int64)sub_2B228;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x1Bu, (__int64)&unk_5CDC8);
  }
  dword_61430 = 0;
  dword_61444 = 0;
  v0 = sub_4F45C((__int64)&v3, 13304i64, v2);
  if ( !v0 )
    return 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 1) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x1Cu, (__int64)&unk_5CDC8, v0);
  }
  return 258i64;
}
// 5AE00: using guessed type wchar_t aNetworkprovide[16];
// 61430: using guessed type int dword_61430;
// 61444: using guessed type int dword_61444;

//----- (000000000002A0B4) ----------------------------------------------------
__int64 sub_2A0B4()
{
  char v0; // r14
  char *v1; // rax
  char *v2; // r12
  _WORD *v3; // r13
  __int64 v4; // rsi
  __int64 v5; // rbp
  __int16 v6; // ax
  __int64 v7; // rcx
  _WORD *v8; // rdi
  bool v9; // zf
  ULONG Value; // [rsp+20h] [rbp-58h] BYREF
  UNICODE_STRING String; // [rsp+28h] [rbp-50h] BYREF
  _BYTE v13[12]; // [rsp+38h] [rbp-40h] BYREF

  *(_WORD *)v13 = 0;
  *(_QWORD *)&v13[2] = 0i64;
  *(_WORD *)&v13[10] = 0;
  Value = 0;
  v0 = 1;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Du, (__int64)&unk_5CDC8);
  }
  v1 = sub_50F88(0x200A00Du);
  v2 = v1;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1127C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Eu, (__int64)&unk_5CDC8, (const wchar_t *)v1);
  }
  v3 = &unk_613F0;
  _InterlockedExchange(&dword_61430, 1);
  word_6142C = 0;
  memset(&unk_613F0, 0, 0x3Cui64);
  v4 = 0i64;
  v5 = 0i64;
  do
  {
    while ( 1 )
    {
      v6 = *(_WORD *)&v2[2 * v4];
      if ( v6 == 124 || !v6 || v5 > 5 )
        break;
      *(_WORD *)&v13[2 * v5++] = v6;
      ++v4;
    }
    v7 = -1i64;
    v8 = v13;
    do
    {
      if ( !v7 )
        break;
      v9 = *v8++ == 0;
      --v7;
    }
    while ( !v9 );
    String.Buffer = (PWSTR)v13;
    String.Length = 2 * (-(__int16)v7 - 2);
    String.MaximumLength = String.Length;
    RtlUnicodeStringToInteger(&String, 0, &Value);
    if ( Value - 1 > 0xFFFE )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Fu, (__int64)&unk_5CDC8, Value);
      }
    }
    else
    {
      *v3 = Value;
      ++word_6142C;
      ++v3;
    }
    if ( *(_WORD *)&v2[2 * v4] && v4 < 512 )
    {
      v5 = 0i64;
      ++v4;
      *(_QWORD *)v13 = 0i64;
      *(_DWORD *)&v13[8] = 0;
    }
    else
    {
      v0 = 0;
    }
  }
  while ( v0 );
  sub_51168();
  _InterlockedExchange(&dword_61430, 0);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x20u, (__int64)&unk_5CDC8);
  }
  return 0i64;
}
// 6142C: using guessed type __int16 word_6142C;
// 61430: using guessed type int dword_61430;

//----- (000000000002A310) ----------------------------------------------------
__int64 sub_2A310()
{
  PVOID v0; // r12
  unsigned int v1; // ebp
  void *v2; // rsi
  char *v3; // rax
  char *v4; // rdi
  int v6; // eax
  unsigned int v7; // ebx
  PVOID v8; // rax
  PDEVICE_OBJECT v9; // rcx
  PDEVICE_OBJECT v10; // rcx
  union _LARGE_INTEGER Interval; // [rsp+30h] [rbp-38h] BYREF

  v0 = qword_61438;
  v1 = 0;
  v2 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x21u, (__int64)&unk_5CDC8);
  }
  v3 = sub_50F88(0x200A021u);
  v4 = v3;
  if ( !v3 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x22u, (__int64)&unk_5CDC8);
    }
    sub_51168();
    return 6i64;
  }
  v6 = *(_DWORD *)v3;
  if ( v6 )
  {
    if ( v6 == 1 )
      v7 = 28;
    else
      v7 = 8 * (3 * v6 - 3) + 28;
  }
  else
  {
    v7 = 0;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x23u, (__int64)&unk_5CDC8, v7);
  }
  if ( v7 )
  {
    v8 = sub_3F66C(2, v7, 0x7061694Eu);
    v2 = v8;
    if ( !v8 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x24u, (__int64)&unk_5CDC8);
      }
      v1 = 3;
      sub_51168();
      goto LABEL_49;
    }
    sub_588AC(v8, v7, v4, v7);
  }
  sub_51168();
  byte_6128B = 1;
  while ( _InterlockedCompareExchange(&dword_613CC, 0, 0) > 0 )
  {
    v9 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x25u, (__int64)&unk_5CDC8);
      v9 = off_60148;
    }
    Interval.QuadPart = -5000000i64;
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&v9->AlignmentRequirement, 0x26u, (__int64)&unk_5CDC8);
    }
    KeDelayExecutionThread(0, 0, &Interval);
  }
  v10 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x27u, (__int64)&unk_5CDC8, qword_61438, v2);
    v10 = off_60148;
  }
  qword_61438 = v2;
  if ( !v0 )
    goto LABEL_50;
  if ( v10 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v10->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_2F80C(*(_QWORD *)&v10->AlignmentRequirement, 0x28u, (__int64)&unk_5CDC8, v0);
  }
  sub_3F6F0(v0, 0x7061694Eu);
LABEL_49:
  v10 = off_60148;
LABEL_50:
  byte_6128B = 0;
  if ( v10 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v10->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v10->AlignmentRequirement, 0x29u, (__int64)&unk_5CDC8);
  }
  return v1;
}
// 6128B: using guessed type char byte_6128B;
// 613CC: using guessed type int dword_613CC;

//----- (000000000002A65C) ----------------------------------------------------
__int64 sub_2A65C()
{
  int v0; // ebp
  char v1; // r15
  char *v2; // rax
  char *v3; // r12
  PDEVICE_OBJECT v4; // rcx
  __int64 v5; // r14
  wchar_t *v6; // rdx
  __int64 v7; // rbx
  const wchar_t *v8; // rsi
  __int16 v9; // ax
  const wchar_t *v10; // r13
  __int64 v11; // rcx
  const wchar_t *v12; // rdi
  bool v13; // zf
  size_t v14; // rdi
  __int64 v15; // rcx
  const wchar_t *v16; // rdi
  wchar_t v17; // ax
  __int16 v18; // bx
  char *v19; // rax
  unsigned __int16 v20; // dx
  unsigned __int16 j; // di
  PDEVICE_OBJECT v22; // rcx
  wchar_t *i; // [rsp+50h] [rbp+8h]

  v0 = 0;
  v1 = 1;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Au, (__int64)&unk_5CDC8);
  }
  v2 = sub_50F88(0x200A00Eu);
  v3 = v2;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_1127C(off_60148->Dpc.ProcessorHistory, 0x2Bu, (__int64)&unk_5CDC8, (const wchar_t *)v2);
  }
  _InterlockedExchange(&dword_61444, 1);
  word_61440 = 0;
  memset(Dst, 0, 0x7E4ui64);
  v4 = off_60148;
  v5 = 0i64;
  v6 = Dst;
  for ( i = Dst; ; v6 = i )
  {
    v7 = v0;
    v8 = (const wchar_t *)&v3[2 * v0];
    if ( !*v8 )
    {
      if ( v4 == (PDEVICE_OBJECT)&off_60148 )
        goto LABEL_95;
      if ( _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 9u) && BYTE1(v4->Dpc.DeferredContext) >= 4u )
      {
        v20 = 44;
        goto LABEL_90;
      }
      goto LABEL_91;
    }
    if ( *v8 == 124 )
    {
      if ( v4 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 9u)
        && BYTE1(v4->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v4->Dpc.ProcessorHistory, 0x2Du, (__int64)&unk_5CDC8);
        v4 = off_60148;
      }
      if ( *v8 != 124 )
      {
        v9 = *(_WORD *)&v3[2 * v0];
        do
        {
          if ( !v9 )
            break;
          ++v7;
          ++v0;
          v9 = *(_WORD *)&v3[2 * v7];
        }
        while ( v9 != 124 );
      }
      if ( *(_WORD *)&v3[2 * v0] == 124 )
      {
        if ( v4 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 9u)
          && BYTE1(v4->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(v4->Dpc.ProcessorHistory, 0x2Eu, (__int64)&unk_5CDC8);
          v4 = off_60148;
        }
        ++v0;
      }
      continue;
    }
    v10 = v6;
    if ( !byte_61288 )
      goto LABEL_40;
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 9u)
      && BYTE1(v4->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(v4->Dpc.ProcessorHistory, 0x2Fu, (__int64)&unk_5CDC8);
    }
    v11 = -1i64;
    v12 = L"vms_mp";
    do
    {
      if ( !v11 )
        break;
      v13 = *v12++ == 0;
      --v11;
    }
    while ( !v13 );
    v14 = -v11 - 2;
    if ( wcsnicmp((const wchar_t *)&v3[2 * v0], L"vms_mp", v14) )
    {
      v15 = -1i64;
      v16 = L"vms_vsmp";
      do
      {
        if ( !v15 )
          break;
        v13 = *v16++ == 0;
        --v15;
      }
      while ( !v13 );
      v14 = -v15 - 2;
      if ( wcsnicmp((const wchar_t *)&v3[2 * v0], L"vms_vsmp", v14) )
      {
        v4 = off_60148;
        v6 = i;
LABEL_40:
        if ( *v8 != 124 )
        {
          v17 = *(_WORD *)&v3[2 * v0];
          do
          {
            if ( !v17 )
              break;
            if ( v5 >= 100 )
              break;
            ++v7;
            v6[v5] = v17;
            ++v0;
            v17 = *(_WORD *)&v3[2 * v7];
            ++v5;
          }
          while ( v17 != 124 );
        }
        v6[v5] = 0;
        ++word_61440;
        i = v6 + 101;
        if ( v4 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 9u)
          && BYTE1(v4->Dpc.DeferredContext) >= 4u )
        {
          sub_1127C(v4->Dpc.ProcessorHistory, 0x31u, (__int64)&unk_5CDC8, v10);
          v4 = off_60148;
        }
        goto LABEL_49;
      }
    }
    v0 += v14;
    v18 = *(_WORD *)&v3[2 * v0];
    *(_WORD *)&v3[2 * v0] = 0;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_1127C(off_60148->Dpc.ProcessorHistory, 0x30u, (__int64)&unk_5CDC8, v8);
    }
    *(_WORD *)&v3[2 * v0] = v18;
    v4 = off_60148;
LABEL_49:
    if ( word_61440 == 10 )
      break;
    if ( *(_WORD *)&v3[2 * v0] == 124 )
    {
      if ( v4 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 9u)
        && BYTE1(v4->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v4->Dpc.ProcessorHistory, 0x33u, (__int64)&unk_5CDC8);
        v4 = off_60148;
      }
    }
    else
    {
      if ( !*(_WORD *)&v3[2 * v0] )
      {
        if ( v4 == (PDEVICE_OBJECT)&off_60148 )
          goto LABEL_95;
        if ( _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 9u) && BYTE1(v4->Dpc.DeferredContext) >= 4u )
        {
          v20 = 52;
LABEL_90:
          sub_11008(v4->Dpc.ProcessorHistory, v20, (__int64)&unk_5CDC8);
          v4 = off_60148;
          goto LABEL_91;
        }
        goto LABEL_91;
      }
      if ( v5 == 100 )
      {
        if ( v4 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 9u)
          && BYTE1(v4->Dpc.DeferredContext) >= 4u )
        {
          sub_11008(v4->Dpc.ProcessorHistory, 0x35u, (__int64)&unk_5CDC8);
          v4 = off_60148;
        }
        v19 = &v3[2 * v0];
        do
        {
          v19 += 2;
          ++v0;
        }
        while ( *(_WORD *)v19 != 124 && *(_WORD *)v19 );
      }
      else
      {
        if ( v4 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 9u)
          && BYTE1(v4->Dpc.DeferredContext) >= 3u )
        {
          sub_11008(v4->Dpc.ProcessorHistory, 0x36u, (__int64)&unk_5CDC8);
          v4 = off_60148;
        }
        v1 = 0;
      }
    }
    if ( !v1 )
      goto LABEL_91;
    ++v0;
    v5 = 0i64;
  }
  if ( v4 == (PDEVICE_OBJECT)&off_60148 )
    goto LABEL_95;
  if ( _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 9u) && BYTE1(v4->Dpc.DeferredContext) >= 4u )
  {
    v20 = 50;
    goto LABEL_90;
  }
LABEL_91:
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 9u)
    && BYTE1(v4->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(v4->Dpc.ProcessorHistory, 0x37u, (__int64)&unk_5CDC8);
    v4 = off_60148;
  }
LABEL_95:
  for ( j = 0; j < (unsigned __int16)word_61440; ++j )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 9u)
      && BYTE1(v4->Dpc.DeferredContext) >= 4u )
    {
      sub_1127C(v4->Dpc.ProcessorHistory, 0x38u, (__int64)&unk_5CDC8, &Dst[101 * j]);
      v4 = off_60148;
    }
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 9u)
    && BYTE1(v4->Dpc.DeferredContext) >= 4u )
  {
    sub_112FC(v4->Dpc.ProcessorHistory, 0x39u, (__int64)&unk_5CDC8, (unsigned __int16)word_61440);
  }
  sub_51168();
  _InterlockedExchange(&dword_61444, 0);
  if ( !(unsigned int)sub_190CC() )
  {
LABEL_110:
    v22 = off_60148;
    goto LABEL_111;
  }
  v22 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 9u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x3Au, (__int64)&unk_5CDC8);
      goto LABEL_110;
    }
LABEL_111:
    if ( v22 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v22->Dpc.DeferredContext + 1, 9u)
      && BYTE1(v22->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v22->Dpc.ProcessorHistory, 0x3Bu, (__int64)&unk_5CDC8);
    }
  }
  return 0i64;
}
// 2AAE3: conditional instruction was optimized away because of 'r15.1==1'
// 61288: using guessed type char byte_61288;
// 61440: using guessed type __int16 word_61440;
// 61444: using guessed type int dword_61444;

//----- (000000000002ACF8) ----------------------------------------------------
__int64 __fastcall sub_2ACF8(wchar_t *Str2, _DWORD *a2)
{
  unsigned int v2; // ebx
  int v5; // esi
  char v6; // r13
  const wchar_t *v7; // rbp
  __int64 v8; // rcx
  const wchar_t *v9; // rdi
  bool v10; // zf
  PDEVICE_OBJECT v11; // rcx

  v2 = 0;
  v5 = 0;
  v6 = 1;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Cu, (__int64)&unk_5CDC8);
  }
  *a2 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1127C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Du, (__int64)&unk_5CDC8, Str2);
  }
  if ( _InterlockedCompareExchange(&dword_61444, 1, 1) )
  {
    v11 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x40u, (__int64)&unk_5CDC8);
      v11 = off_60148;
    }
    v2 = 1;
  }
  else
  {
    v7 = &Dst;
    while ( 1 )
    {
      if ( *v7 )
      {
        v8 = -1i64;
        v9 = v7;
        do
        {
          if ( !v8 )
            break;
          v10 = *v9++ == 0;
          --v8;
        }
        while ( !v10 );
        if ( !wcsnicmp(v7, Str2, -v8 - 2) )
          break;
      }
      ++v5;
      v7 += 101;
      if ( v5 >= 1010 || v5 >= 10 )
      {
        v6 = 0;
        v11 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
          return v2;
        if ( !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 4u )
        {
          goto LABEL_35;
        }
        sub_114E4(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Fu, (__int64)&unk_5CDC8, v5);
      }
      if ( !v6 )
        goto LABEL_29;
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Eu, (__int64)&unk_5CDC8, v5);
    }
    *a2 = 1;
LABEL_29:
    v11 = off_60148;
  }
LABEL_35:
  if ( v11 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v11->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v11->AlignmentRequirement, 0x41u, (__int64)&unk_5CDC8);
  }
  return v2;
}
// 61444: using guessed type int dword_61444;

//----- (000000000002AF40) ----------------------------------------------------
PVOID __fastcall sub_2AF40(_WORD *a1)
{
  int v2; // er12
  int v3; // er13
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  char *v7; // rax
  PVOID v8; // rbx
  char *v9; // r15
  __int64 v10; // r14
  wchar_t *v11; // rbp
  __int64 v12; // rcx
  wchar_t *v13; // rdi
  bool v14; // zf
  size_t v15; // rdi
  PDEVICE_OBJECT v16; // rcx
  PVOID v17; // [rsp+70h] [rbp+8h]

  v2 = 0;
  v3 = 0;
  *a1 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x42u, (__int64)&unk_5CDC8);
  }
  if ( _InterlockedCompareExchange(&dword_61444, 1, 1) == 1 )
  {
    v4 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
      return 0i64;
    if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x43u, (__int64)&unk_5CDC8);
      v4 = off_60148;
    }
    if ( v4 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v4->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v4->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
      return 0i64;
    }
    v5 = 68;
LABEL_14:
    sub_11008(*(_QWORD *)&v4->AlignmentRequirement, v5, (__int64)&unk_5CDC8);
    return 0i64;
  }
  if ( !word_61440 )
  {
    v4 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
      return 0i64;
    if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x45u, (__int64)&unk_5CDC8);
      v4 = off_60148;
    }
    if ( v4 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v4->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v4->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
      return 0i64;
    }
    v5 = 70;
    goto LABEL_14;
  }
  v7 = (char *)ExAllocatePoolWithTag(NonPagedPool, 0x3F2ui64, 0x7845734Eu);
  v8 = v7;
  v17 = v7;
  if ( v7 )
  {
    v9 = v7;
    memset(v7, 0, 0x3F2ui64);
    v10 = 0i64;
    v11 = &Dst;
    while ( 1 )
    {
      v12 = -1i64;
      v13 = v11;
      do
      {
        if ( !v12 )
          break;
        v14 = *v13++ == 0;
        --v12;
      }
      while ( !v14 );
      v15 = 2i64 * ~(_DWORD)v12;
      memmove(v9, v11, v15);
      v9 += v15;
      if ( !v11[v10] )
        break;
      v11 += 101;
      ++v10;
      ++v2;
      ++v3;
      ++*a1;
    }
    v16 = off_60148;
    v8 = v17;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_114E4(*(_QWORD *)&off_60148->AlignmentRequirement, 0x47u, (__int64)&unk_5CDC8, v2);
LABEL_40:
        v16 = off_60148;
        goto LABEL_41;
      }
      goto LABEL_41;
    }
  }
  else
  {
    v16 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x48u, (__int64)&unk_5CDC8);
        goto LABEL_40;
      }
LABEL_41:
      if ( v16 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v16->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v16->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v16->AlignmentRequirement, 0x49u, (__int64)&unk_5CDC8);
      }
      return v8;
    }
  }
  return v8;
}
// 61440: using guessed type __int16 word_61440;
// 61444: using guessed type int dword_61444;

//----- (000000000002B228) ----------------------------------------------------
__int64 __fastcall sub_2B228(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  _DWORD *v3; // rax
  __int64 result; // rax
  unsigned int v5; // eax
  unsigned int v6; // ebx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x4Au, (__int64)&unk_5CDC8);
    v2 = off_60148;
  }
  v3 = *(_DWORD **)(a1 + 56);
  if ( v3 )
  {
    if ( *v3 == 8 )
    {
      v5 = sub_34694(a1);
      v2 = off_60148;
      v6 = v5;
    }
    else
    {
      if ( v2 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_11008(*(_QWORD *)&v2->AlignmentRequirement, 0x4Cu, (__int64)&unk_5CDC8);
        v2 = off_60148;
      }
      v6 = 17;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&v2->AlignmentRequirement, 0x4Du, (__int64)&unk_5CDC8);
    }
    result = v6;
  }
  else
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v2->AlignmentRequirement, 0x4Bu, (__int64)&unk_5CDC8);
    }
    result = 6i64;
  }
  return result;
}

//----- (000000000002B354) ----------------------------------------------------
__int64 sub_2B354()
{
  int v0; // ebp
  char *v1; // rax
  char *v2; // r12
  __int64 v3; // rax
  __int64 v4; // rcx
  __int16 v5; // dx
  int v6; // er13
  unsigned __int16 *v7; // r15
  char v8; // r14
  __int64 v9; // rsi
  __int64 i; // rcx
  __int16 v11; // ax
  __int64 v12; // rcx
  _WORD *v13; // rdi
  bool v14; // zf
  int v15; // er9
  __int64 v16; // rax
  PDEVICE_OBJECT v17; // rdi
  unsigned __int16 v18; // dx
  __int64 v19; // rcx
  unsigned __int16 v20; // dx
  char v22; // [rsp+30h] [rbp-88h]
  unsigned int v23; // [rsp+34h] [rbp-84h]
  ULONG Value; // [rsp+38h] [rbp-80h] BYREF
  int v25; // [rsp+3Ch] [rbp-7Ch] BYREF
  __int64 v26; // [rsp+40h] [rbp-78h]
  UNICODE_STRING String; // [rsp+48h] [rbp-70h] BYREF
  _BYTE v28[12]; // [rsp+58h] [rbp-60h] BYREF
  __int16 Dst[16]; // [rsp+68h] [rbp-50h] BYREF

  Dst[0] = 0;
  *(_WORD *)v28 = 0;
  *(_QWORD *)&v28[2] = 0i64;
  v23 = 0;
  v0 = 0;
  v22 = 1;
  v25 = 0;
  Value = 0;
  *(_QWORD *)&Dst[1] = 0i64;
  *(_QWORD *)&Dst[5] = 0i64;
  *(_QWORD *)&Dst[9] = 0i64;
  *(_DWORD *)&Dst[13] = 0;
  Dst[15] = 0;
  *(_WORD *)&v28[10] = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x4Eu, (__int64)&unk_5CDC8);
  }
  v1 = sub_50F88(0x200A061u);
  v2 = v1;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1127C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x4Fu, (__int64)&unk_5CDC8, (const wchar_t *)v1);
  }
  _InterlockedExchange(&dword_65080, 1);
  memset(word_64EA0, 0, sizeof(word_64EA0));
  v26 = 0i64;
  while ( 2 )
  {
    v3 = v0;
    v4 = 0i64;
    if ( *(_WORD *)&v2[2 * v0] != 58 )
    {
      v5 = *(_WORD *)&v2[2 * v0];
      do
      {
        if ( !v5 )
          break;
        if ( v4 > 16 )
          break;
        ++v3;
        Dst[v4] = v5;
        ++v0;
        v5 = *(_WORD *)&v2[2 * v3];
        ++v4;
      }
      while ( v5 != 58 );
    }
    ++v0;
    sub_2BA8C(Dst, &v25);
    v6 = v25;
    if ( v25 )
    {
      v7 = &word_64EA0[20 * v25];
      *(_DWORD *)v7 = v25;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x51u, (__int64)&unk_5CDC8, v6);
      }
      v8 = 1;
      v9 = v0;
      while ( 1 )
      {
        for ( i = 0i64; ; ++i )
        {
          v11 = *(_WORD *)&v2[2 * v9];
          if ( v11 == 58 || v11 == 124 || !v11 || i > 6 )
            break;
          *(_WORD *)&v28[2 * i] = v11;
          ++v0;
          ++v9;
        }
        v12 = -1i64;
        v13 = v28;
        do
        {
          if ( !v12 )
            break;
          v14 = *v13++ == 0;
          --v12;
        }
        while ( !v14 );
        String.Buffer = (PWSTR)v28;
        String.Length = 2 * (-(__int16)v12 - 2);
        String.MaximumLength = String.Length;
        RtlUnicodeStringToInteger(&String, 0, &Value);
        v15 = Value;
        if ( Value - 1 > 0xFFFE )
        {
          v17 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x53u, (__int64)&unk_5CDC8, Value);
            v17 = off_60148;
          }
          v23 = 4;
          v8 = 0;
          v22 = 0;
        }
        else
        {
          v16 = v26;
          v7[v26 + 2] = Value;
          ++v7[18];
          v17 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x52u, (__int64)&unk_5CDC8, v15);
            v17 = off_60148;
            v16 = v26;
          }
          v26 = v16 + 1;
        }
        if ( *(_WORD *)&v2[2 * v9] == 124 || v9 >= 512 )
          break;
        if ( !*(_WORD *)&v2[2 * v9] )
        {
          if ( v17 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v17->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(v17->DeviceQueue.DeviceListHead.Flink) >= 4u )
          {
            v19 = *(_QWORD *)&v17->AlignmentRequirement;
            v20 = 85;
            goto LABEL_64;
          }
          goto LABEL_65;
        }
        ++v0;
        ++v9;
        *(_QWORD *)v28 = 0i64;
        *(_DWORD *)&v28[8] = 0;
        if ( v17 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v17->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          && BYTE1(v17->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          v18 = 86;
LABEL_52:
          sub_112FC(*(_QWORD *)&v17->AlignmentRequirement, v18, (__int64)&unk_5CDC8, v6);
        }
        if ( !v8 )
          goto LABEL_54;
      }
      ++v0;
      ++v9;
      *(_QWORD *)v28 = 0i64;
      *(_DWORD *)&v28[8] = 0;
      memset(Dst, 0, sizeof(Dst));
      v8 = 0;
      v26 = 0i64;
      if ( v17 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&v17->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        || BYTE1(v17->DeviceQueue.DeviceListHead.Flink) < 4u )
      {
LABEL_54:
        if ( !v22 )
          goto LABEL_65;
        continue;
      }
      v18 = 84;
      goto LABEL_52;
    }
    break;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    v19 = *(_QWORD *)&off_60148->AlignmentRequirement;
    v20 = 80;
LABEL_64:
    sub_11008(v19, v20, (__int64)&unk_5CDC8);
  }
LABEL_65:
  sub_51168();
  _InterlockedExchange(&dword_65080, 0);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x57u, (__int64)&unk_5CDC8);
  }
  return v23;
}
// 65080: using guessed type int dword_65080;

//----- (000000000002B828) ----------------------------------------------------
__int64 sub_2B828()
{
  char v0; // r13
  int v1; // ebp
  char *v2; // rax
  char *v3; // r12
  __int64 v4; // rsi
  __int64 v5; // r15
  __int64 v6; // r14
  __int64 v7; // rcx
  __int16 v8; // ax
  __int64 v9; // rcx
  __int16 *v10; // rdi
  bool v11; // zf
  __int64 v12; // rdx
  ULONG Value; // [rsp+20h] [rbp-58h] BYREF
  UNICODE_STRING String; // [rsp+28h] [rbp-50h] BYREF
  __int16 v16; // [rsp+38h] [rbp-40h] BYREF
  int v17; // [rsp+3Ah] [rbp-3Eh]
  __int16 v18; // [rsp+3Eh] [rbp-3Ah]

  v0 = 1;
  v1 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x20) != 0
    && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148[1].DeviceType, 0x58u, (__int64)&unk_5CDC8);
  }
  v2 = sub_50F88(0x200A062u);
  v3 = v2;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x20) != 0
    && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 4u )
  {
    sub_1127C(*(_QWORD *)&off_60148[1].DeviceType, 0x59u, (__int64)&unk_5CDC8, (const wchar_t *)v2);
  }
  v4 = 0i64;
  _InterlockedExchange(&dword_64E94, 1);
  v5 = 0i64;
  v6 = 0i64;
  qword_64E60[0] = 0i64;
  dword_64E68 = 0;
  do
  {
    if ( v1 >= 3 )
      break;
    Value = 0;
    v7 = 0i64;
    v17 = 0;
    v18 = 0;
    v16 = 0;
    while ( 1 )
    {
      v8 = *(_WORD *)&v3[2 * v4];
      if ( v8 == 46 || v8 == 124 || !v8 || v7 > 4 )
        break;
      *(&v16 + v7++) = v8;
      ++v4;
    }
    v9 = -1i64;
    v10 = &v16;
    do
    {
      if ( !v9 )
        break;
      v11 = *v10++ == 0;
      --v9;
    }
    while ( !v11 );
    String.Buffer = (PWSTR)&v16;
    String.Length = 2 * (-(__int16)v9 - 2);
    String.MaximumLength = String.Length;
    RtlUnicodeStringToInteger(&String, 0, &Value);
    v12 = v6 + v5++;
    *((_BYTE *)qword_64E60 + v12) = Value;
    if ( *(_WORD *)&v3[2 * v4] == 124 || !*(_WORD *)&v3[2 * v4] )
    {
      ++v1;
      v6 += 16i64;
      v5 = 0i64;
      if ( !*(_WORD *)&v3[2 * v4] )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x20) != 0
          && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 4u )
        {
          sub_112FC(*(_QWORD *)&off_60148[1].DeviceType, 0x5Au, (__int64)&unk_5CDC8, v1);
        }
        v0 = 0;
      }
    }
    ++v4;
  }
  while ( v0 );
  dword_64E90 = v1;
  sub_51168();
  _InterlockedExchange(&dword_64E94, 0);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x20) != 0
    && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148[1].DeviceType, 0x5Bu, (__int64)&unk_5CDC8);
  }
  return 0i64;
}
// 64E60: using guessed type __int64 qword_64E60[];
// 64E68: using guessed type int dword_64E68;
// 64E90: using guessed type int dword_64E90;
// 64E94: using guessed type int dword_64E94;

//----- (000000000002BA8C) ----------------------------------------------------
__int64 __fastcall sub_2BA8C(_WORD *a1, _DWORD *a2)
{
  bool v2; // zf
  _WORD *v3; // rax
  _WORD *v4; // rsi
  const wchar_t *v5; // rdi
  __int64 v6; // rcx
  PDEVICE_OBJECT v8; // rcx
  const wchar_t *v9; // rdi
  _WORD *v10; // rsi
  __int64 v11; // rcx
  const wchar_t *v12; // rdi
  _WORD *v13; // rsi
  __int64 v14; // rcx
  const wchar_t *v15; // rdi
  _WORD *v16; // rsi
  __int64 v17; // rcx
  const wchar_t *v18; // rdi
  _WORD *v19; // rsi
  __int64 v20; // rcx
  const wchar_t *v21; // rdi
  _WORD *v22; // rsi
  __int64 v23; // rcx
  const wchar_t *v24; // rdi
  _WORD *v25; // rsi
  __int64 v26; // rcx
  const wchar_t *v27; // rdi
  _WORD *v28; // rsi
  __int64 v29; // rcx

  v2 = 0;
  v3 = a1;
  v4 = a1;
  v5 = L"HTTP";
  v6 = 5i64;
  do
  {
    if ( !v6 )
      break;
    v2 = *v4++ == *v5++;
    --v6;
  }
  while ( v2 );
  if ( v2 )
  {
    v8 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x5Cu, (__int64)&unk_5CDC8);
      v8 = off_60148;
    }
    *a2 = 4;
  }
  else
  {
    v9 = L"HTTPS";
    v10 = v3;
    v11 = 6i64;
    do
    {
      if ( !v11 )
        break;
      v2 = *v10++ == *v9++;
      --v11;
    }
    while ( v2 );
    if ( v2 )
    {
      v8 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x5Du, (__int64)&unk_5CDC8);
        v8 = off_60148;
      }
      *a2 = 5;
    }
    else
    {
      v12 = L"POP3";
      v13 = v3;
      v14 = 5i64;
      do
      {
        if ( !v14 )
          break;
        v2 = *v13++ == *v12++;
        --v14;
      }
      while ( v2 );
      if ( v2 )
      {
        v8 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x5Eu, (__int64)&unk_5CDC8);
          v8 = off_60148;
        }
        *a2 = 9;
      }
      else
      {
        v15 = L"SMTP";
        v16 = v3;
        v17 = 5i64;
        do
        {
          if ( !v17 )
            break;
          v2 = *v16++ == *v15++;
          --v17;
        }
        while ( v2 );
        if ( v2 )
        {
          v8 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
          {
            sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x5Fu, (__int64)&unk_5CDC8);
            v8 = off_60148;
          }
          *a2 = 7;
        }
        else
        {
          v18 = L"FTP";
          v19 = v3;
          v20 = 4i64;
          do
          {
            if ( !v20 )
              break;
            v2 = *v19++ == *v18++;
            --v20;
          }
          while ( v2 );
          if ( v2 )
          {
            v8 = off_60148;
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
              && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
            {
              sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x60u, (__int64)&unk_5CDC8);
              v8 = off_60148;
            }
            *a2 = 8;
          }
          else
          {
            v21 = L"DNS";
            v22 = v3;
            v23 = 4i64;
            do
            {
              if ( !v23 )
                break;
              v2 = *v22++ == *v21++;
              --v23;
            }
            while ( v2 );
            if ( v2 )
            {
              v8 = off_60148;
              if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
                && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
              {
                sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x61u, (__int64)&unk_5CDC8);
                v8 = off_60148;
              }
              *a2 = 2;
            }
            else
            {
              v24 = L"DHCP";
              v25 = v3;
              v26 = 5i64;
              do
              {
                if ( !v26 )
                  break;
                v2 = *v25++ == *v24++;
                --v26;
              }
              while ( v2 );
              if ( v2 )
              {
                v8 = off_60148;
                if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                  && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
                  && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
                {
                  sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x62u, (__int64)&unk_5CDC8);
                  v8 = off_60148;
                }
                *a2 = 3;
              }
              else
              {
                v27 = L"DHCPV6";
                v28 = v3;
                v29 = 7i64;
                do
                {
                  if ( !v29 )
                    break;
                  v2 = *v28++ == *v27++;
                  --v29;
                }
                while ( v2 );
                if ( v2 )
                {
                  v8 = off_60148;
                  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
                    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
                  {
                    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x63u, (__int64)&unk_5CDC8);
                    v8 = off_60148;
                  }
                  *a2 = 11;
                }
                else
                {
                  v8 = off_60148;
                  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
                    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
                  {
                    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x64u, (__int64)&unk_5CDC8);
                    v8 = off_60148;
                  }
                  *a2 = 0;
                }
              }
            }
          }
        }
      }
    }
  }
  if ( v8 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v8[1].Queue.Wcb.DmaWaitEntry.Blink) & 1) != 0
    && BYTE1(v8[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v8[1].DeviceType, 0x65u, (__int64)&unk_5CDC8);
  }
  return 0i64;
}
// 5AE50: using guessed type wchar_t aHttp_0[5];
// 5AE60: using guessed type wchar_t aHttps_0[6];
// 5AE70: using guessed type wchar_t aPop3[5];
// 5AE80: using guessed type wchar_t aSmtp_0[5];
// 5AE90: using guessed type wchar_t aFtp[4];
// 5AEA0: using guessed type wchar_t aDns_0[4];
// 5AEB0: using guessed type wchar_t aDhcp_0[5];
// 5AEC0: using guessed type wchar_t aDhcpv6_0[7];

//----- (000000000002BE50) ----------------------------------------------------
__int64 __fastcall sub_2BE50(__int64 a1, __int64 a2, __int64 a3, int a4, char a5, const char *a6)
{
  int v8; // [rsp+88h] [rbp+20h] BYREF

  v8 = a4;
  if ( a6 )
    strlen(a6);
  return qword_61238(a1, 43i64, &unk_5CDB8, 14i64, &v8);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002BEEC) ----------------------------------------------------
__int64 __fastcall sub_2BEEC(int **a1)
{
  PDEVICE_OBJECT v2; // r10
  int v3; // edx
  int v4; // edx
  __int64 v5; // rdi
  int v6; // edx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_5CDB8);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Dpc.DeferredContext) & 0x10) != 0
      && BYTE1(v2->Dpc.DeferredContext) >= 4u )
    {
      sub_2BE50(v2->Dpc.ProcessorHistory, 14i64, (__int64)&unk_5CDB8, **a1, (*a1)[37], (const char *)*a1 + 4);
      v2 = off_60148;
    }
  }
  v3 = (*a1)[37];
  if ( !v3 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Dpc.DeferredContext) & 0x10) != 0
      && BYTE1(v2->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(v2->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_5CDB8);
    }
    _InterlockedAdd64(&qword_61358, 1ui64);
    v6 = 2;
    goto LABEL_33;
  }
  v4 = v3 - 1;
  if ( !v4 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Dpc.DeferredContext) & 0x10) != 0
      && BYTE1(v2->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(v2->Dpc.ProcessorHistory, 0x12u, (__int64)&unk_5CDB8);
    }
    _InterlockedAdd64(&qword_61368, 1ui64);
    v6 = 3;
LABEL_33:
    sub_2C130(*a1, v6);
LABEL_34:
    v2 = off_60148;
    goto LABEL_35;
  }
  if ( v4 == 2 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Dpc.DeferredContext) & 0x10) != 0
      && BYTE1(v2->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(v2->Dpc.ProcessorHistory, 0x10u, (__int64)&unk_5CDB8);
    }
    _InterlockedAdd64(&qword_61360, 1ui64);
    v5 = _InterlockedCompareExchange64(&qword_61270, 0i64, 0i64);
    if ( v5 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_5CDB8);
      }
      sub_502CC(0x200A004u);
      sub_48AD0(v5);
    }
    sub_2C274(*a1);
    goto LABEL_34;
  }
LABEL_35:
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v2->Dpc.DeferredContext) & 0x10) != 0
    && BYTE1(v2->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v2->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_5CDB8);
  }
  return 0i64;
}
// 61270: using guessed type __int64 qword_61270;
// 61358: using guessed type __int64 qword_61358;
// 61360: using guessed type __int64 qword_61360;
// 61368: using guessed type __int64 qword_61368;

//----- (000000000002C130) ----------------------------------------------------
PVOID __fastcall sub_2C130(int *a1, int a2)
{
  int v4; // eax
  PVOID result; // rax
  PDEVICE_OBJECT v6; // rcx
  int v7[8]; // [rsp+20h] [rbp-38h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x14u, (__int64)&unk_5CDB8);
  }
  v7[0] = *a1;
  v7[1] = a1[38];
  v4 = a1[92];
  v7[5] = a2;
  v7[6] = v4;
  result = (PVOID)sub_4D1A4(40020, v7, 0x1Cu);
  if ( !(_DWORD)result )
    goto LABEL_12;
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    result = (PVOID)sub_11008(off_60148->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_5CDB8);
    v6 = off_60148;
  }
  if ( (unsigned int)dword_622E4 > 0xA )
  {
    result = P;
    _InterlockedAdd((volatile signed __int32 *)P + 10, 1u);
LABEL_12:
    v6 = off_60148;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v6->Dpc.DeferredContext) & 0x10) != 0
    && BYTE1(v6->Dpc.DeferredContext) >= 5u )
  {
    result = (PVOID)sub_11008(v6->Dpc.ProcessorHistory, 0x16u, (__int64)&unk_5CDB8);
  }
  return result;
}
// 622E4: using guessed type int dword_622E4;

//----- (000000000002C274) ----------------------------------------------------
__int64 __fastcall sub_2C274(int *a1)
{
  int v2; // eax
  __int64 result; // rax
  PDEVICE_OBJECT v4; // rcx

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x17u, (__int64)&unk_5CDB8);
  }
  v2 = sub_502CC(0x200A025u);
  sub_23BD0((__int64)a1, (unsigned int)(1000 * v2));
  sub_28048(a1);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x18u, (__int64)&unk_5CDB8);
  }
  result = sub_24560((__int64)a1);
  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Dpc.DeferredContext) & 0x10) != 0 && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      result = sub_11008(off_60148->Dpc.ProcessorHistory, 0x19u, (__int64)&unk_5CDB8);
      v4 = off_60148;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v4->Dpc.DeferredContext) & 0x10) != 0
      && BYTE1(v4->Dpc.DeferredContext) >= 5u )
    {
      result = sub_11008(v4->Dpc.ProcessorHistory, 0x1Au, (__int64)&unk_5CDB8);
    }
  }
  return result;
}

//----- (000000000002C3A4) ----------------------------------------------------
__int64 __fastcall sub_2C3A4(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+138h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CDA8, 48i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002C4A8) ----------------------------------------------------
__int64 __fastcall sub_2C4A8(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+E8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CDA8, 45i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002C55C) ----------------------------------------------------
__int64 __fastcall sub_2C55C(__int64 a1, __int64 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CDA8, 80i64, v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002C648) ----------------------------------------------------
__int64 __fastcall sub_2C648(__int64 a1, __int64 a2, _DWORD *a3)
{
  unsigned __int16 v5; // r11
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v8; // [rsp+40h] [rbp+8h] BYREF
  unsigned __int16 v9; // [rsp+50h] [rbp+18h] BYREF

  v8 = 0;
  v9 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_5CDA8);
  }
  *a3 = 0;
  sub_453E8(*(_QWORD *)(a1 + 32), &v9);
  if ( v9 != 2048 )
  {
    v6 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
      return 0i64;
    if ( !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      || BYTE1(off_60148->Dpc.DeferredContext) < 5u )
    {
      goto LABEL_21;
    }
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_5CDA8, v9);
    goto LABEL_20;
  }
  sub_454AC(*(_QWORD *)(a1 + 32), &v8);
  v5 = v8;
  if ( (unsigned int)v8 - 1 <= 1 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_5CDA8);
      v5 = v8;
    }
    sub_2C80C(a1, 2i64, v5 == 1, a3);
    goto LABEL_20;
  }
  v6 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return 0i64;
  if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0xCu, (__int64)&unk_5CDA8, v8);
LABEL_20:
    v6 = off_60148;
  }
LABEL_21:
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(v6->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v6->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_5CDA8);
  }
  return 0i64;
}

//----- (000000000002C80C) ----------------------------------------------------
__int64 __fastcall sub_2C80C(__int64 a1, __int64 a2, char a3, _DWORD *a4)
{
  __int64 v7; // rax
  int v8; // edi
  __int64 v9; // rbx
  PDEVICE_OBJECT v10; // rcx
  __int64 v11; // rbx
  int v12; // edi
  PDEVICE_OBJECT v13; // rcx
  __int64 v14; // rbx
  int v15; // edi
  PDEVICE_OBJECT v16; // rcx
  __int64 v17; // rbx
  int v18; // edi
  PDEVICE_OBJECT v19; // rbx
  unsigned __int16 v20; // dx
  int v21; // eax
  int v23; // eax
  unsigned int v24; // edi
  PDEVICE_OBJECT v25; // rcx
  unsigned __int8 v26; // si
  char v27; // bl
  int v28; // eax
  _BYTE *v29; // rbx
  unsigned __int8 v30; // [rsp+50h] [rbp-1E8h] BYREF
  char v31[3]; // [rsp+51h] [rbp-1E7h] BYREF
  int v32; // [rsp+54h] [rbp-1E4h] BYREF
  __int128 v33; // [rsp+58h] [rbp-1E0h] BYREF
  __int64 Dst; // [rsp+70h] [rbp-1C8h] BYREF
  int v35; // [rsp+78h] [rbp-1C0h]
  int v36; // [rsp+7Ch] [rbp-1BCh] BYREF
  __int16 v37; // [rsp+80h] [rbp-1B8h]
  int v38; // [rsp+82h] [rbp-1B6h] BYREF
  __int16 v39; // [rsp+86h] [rbp-1B2h]
  int v40; // [rsp+88h] [rbp-1B0h]
  int v41; // [rsp+8Ch] [rbp-1ACh]
  int v42[4]; // [rsp+90h] [rbp-1A8h] BYREF
  unsigned __int8 v43; // [rsp+A0h] [rbp-198h] BYREF
  int v44; // [rsp+1BDh] [rbp-7Bh]
  unsigned __int8 v45; // [rsp+1C1h] [rbp-77h] BYREF
  int v46; // [rsp+1EBh] [rbp-4Dh]
  int v47; // [rsp+1EFh] [rbp-49h]
  int v48; // [rsp+1F3h] [rbp-45h]

  LODWORD(Dst) = 0;
  memset((char *)&Dst + 4, 0, 0x187ui64);
  v32 = 0;
  v33 = 0ui64;
  v30 = 0;
  v31[0] = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xFu, (__int64)&unk_5CDA8);
  }
  *a4 = 0;
  v7 = *(_QWORD *)(a1 + 8);
  v8 = 1;
  v35 = 1;
  Dst = v7;
  v44 = 2;
  sub_588AC(&v45, 6ui64, (const void *)(a1 + 384), 6ui64);
  v9 = *(_QWORD *)(a1 + 32);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0xE3u, (__int64)&unk_5CCA8, *(_QWORD *)(a1 + 32), &v36);
  }
  if ( sub_45570((__int16 *)v9) )
  {
    v8 = 0;
    v36 = *(_DWORD *)(v9 + 8);
    v37 = *(_WORD *)(v9 + 12);
  }
  v10 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xE4u, (__int64)&unk_5CCA8, v8);
    v10 = off_60148;
  }
  v40 |= 2u;
  v11 = *(_QWORD *)(a1 + 32);
  v12 = 1;
  if ( v10 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v10->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&v10->AlignmentRequirement, 0xE7u, (__int64)&unk_5CCA8, *(_QWORD *)(a1 + 32), v42);
  }
  if ( sub_45570((__int16 *)v11) )
  {
    v12 = 0;
    v42[0] = *(_DWORD *)(v11 + 14);
  }
  v13 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xE8u, (__int64)&unk_5CCA8, v12);
    v13 = off_60148;
  }
  v40 |= 1u;
  v14 = *(_QWORD *)(a1 + 32);
  v41 = 2048;
  v15 = 1;
  if ( v13 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v13->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v13->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&v13->AlignmentRequirement, 0xEBu, (__int64)&unk_5CCA8, v14, &v38);
  }
  if ( sub_45570((__int16 *)v14) )
  {
    v15 = 0;
    v38 = *(_DWORD *)(v14 + 18);
    v39 = *(_WORD *)(v14 + 22);
  }
  v16 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xECu, (__int64)&unk_5CCA8, v15);
    v16 = off_60148;
  }
  v17 = *(_QWORD *)(a1 + 32);
  v18 = 1;
  if ( v16 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v16->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v16->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&v16->AlignmentRequirement, 0xEFu, (__int64)&unk_5CCA8, *(_QWORD *)(a1 + 32), &v33);
  }
  if ( sub_45570((__int16 *)v17) )
  {
    v18 = 0;
    LODWORD(v33) = *(_DWORD *)(v17 + 24);
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xF0u, (__int64)&unk_5CCA8, v18);
  }
  v40 |= 4u;
  sub_588AC(&v43, 4ui64, &v33, 4ui64);
  if ( a3 )
  {
    v47 = 1;
    v19 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      v20 = 16;
LABEL_54:
      sub_11008(v19->Dpc.ProcessorHistory, v20, (__int64)&unk_5CDA8);
      v19 = off_60148;
      goto LABEL_55;
    }
  }
  else
  {
    v47 = 2;
    v19 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      v20 = 17;
      goto LABEL_54;
    }
  }
LABEL_55:
  v21 = *(_DWORD *)(a1 + 396);
  v48 = 1;
  v46 = v21;
  if ( v19 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0xCu) && BYTE1(v19->Dpc.DeferredContext) >= 4u )
    {
      sub_11148(v19->Dpc.ProcessorHistory, 0x12u, (__int64)&unk_5CDA8, 2);
      v19 = off_60148;
    }
    if ( v19 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0xCu)
        && BYTE1(v19->Dpc.DeferredContext) >= 4u )
      {
        sub_1102C(v19->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_5CDA8, v45);
        v19 = off_60148;
      }
      if ( v19 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0xCu)
          && BYTE1(v19->Dpc.DeferredContext) >= 4u )
        {
          sub_112FC(v19->Dpc.ProcessorHistory, 0x14u, (__int64)&unk_5CDA8, v46);
          v19 = off_60148;
        }
        if ( v19 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0xCu)
            && BYTE1(v19->Dpc.DeferredContext) >= 4u )
          {
            sub_1102C(v19->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_5CDA8, (unsigned __int8)v36);
            v19 = off_60148;
          }
          if ( v19 != (PDEVICE_OBJECT)&off_60148 )
          {
            if ( _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0xCu)
              && BYTE1(v19->Dpc.DeferredContext) >= 4u )
            {
              sub_114E4(v19->Dpc.ProcessorHistory, 0x16u, (__int64)&unk_5CDA8, LOBYTE(v42[0]));
              v19 = off_60148;
            }
            if ( v19 != (PDEVICE_OBJECT)&off_60148 )
            {
              if ( _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0xCu)
                && BYTE1(v19->Dpc.DeferredContext) >= 4u )
              {
                sub_1102C(v19->Dpc.ProcessorHistory, 0x17u, (__int64)&unk_5CDA8, (unsigned __int8)v38);
                v19 = off_60148;
              }
              if ( v19 != (PDEVICE_OBJECT)&off_60148 )
              {
                if ( _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0xCu)
                  && BYTE1(v19->Dpc.DeferredContext) >= 4u )
                {
                  sub_114E4(v19->Dpc.ProcessorHistory, 0x18u, (__int64)&unk_5CDA8, v43);
                  v19 = off_60148;
                }
                if ( v19 != (PDEVICE_OBJECT)&off_60148
                  && _bittest((const signed __int32 *)&v19->Dpc.DeferredContext + 1, 0xCu)
                  && BYTE1(v19->Dpc.DeferredContext) >= 4u )
                {
                  sub_112FC(v19->Dpc.ProcessorHistory, 0x19u, (__int64)&unk_5CDA8, v47);
                }
              }
            }
          }
        }
      }
    }
  }
  v33 = 0ui64;
  if ( !sub_47ADC(4, v42, (__int64)&v33) )
  {
    v23 = sub_30A80(&Dst, &v30, &v32, v31);
    v24 = v23;
    if ( v23 )
    {
      v25 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return v24;
      if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x20u, (__int64)&unk_5CDA8, v23);
        v25 = off_60148;
      }
LABEL_134:
      if ( v25 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v25->Dpc.DeferredContext + 1, 0xCu)
        && BYTE1(v25->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v25->Dpc.ProcessorHistory, 0x21u, (__int64)&unk_5CDA8);
      }
      return v24;
    }
    v25 = off_60148;
    v26 = v30;
    v27 = v31[0];
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11430(off_60148->Dpc.ProcessorHistory, 0x1Bu, (__int64)&unk_5CDA8, v30);
      v25 = off_60148;
    }
    if ( v26 )
    {
      if ( !v27 )
      {
        if ( v47 == 2 && v32 == 3 )
        {
          if ( v25 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v25->Dpc.DeferredContext + 1, 0xCu)
            && BYTE1(v25->Dpc.DeferredContext) >= 2u )
          {
            sub_11008(v25->Dpc.ProcessorHistory, 0x1Eu, (__int64)&unk_5CDA8);
          }
          *a4 = 4;
          goto LABEL_118;
        }
LABEL_119:
        v29 = &unk_61CE0;
        do
        {
          if ( !*v29 )
          {
            if ( sub_47C5C(&v38, (__int64)&unk_61C70) )
            {
              if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
                && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
              {
                sub_11008(off_60148->Dpc.ProcessorHistory, 0x1Fu, (__int64)&unk_5CDA8);
              }
              *a4 = 4;
            }
            v25 = off_60148;
          }
          v29 += 168;
        }
        while ( (__int64)v29 < (__int64)&byte_62220 );
        goto LABEL_134;
      }
    }
    else if ( !v27 )
    {
      goto LABEL_109;
    }
    v48 = 4;
LABEL_109:
    v28 = sub_4D1A4(40022, &Dst, 0x18Bu);
    v24 = v28;
    if ( v28 )
    {
      v25 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
        || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_119;
      }
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x1Cu, (__int64)&unk_5CDA8, v28);
    }
    else
    {
      v25 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
        || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
      {
        goto LABEL_119;
      }
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x1Du, (__int64)&unk_5CDA8);
    }
LABEL_118:
    v25 = off_60148;
    goto LABEL_119;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x1Au, (__int64)&unk_5CDA8);
  }
  return 0i64;
}
// 62220: using guessed type char byte_62220;

//----- (000000000002D248) ----------------------------------------------------
__int64 __fastcall sub_2D248(unsigned int a1, __int64 a2, unsigned __int8 *a3, int *a4, unsigned __int8 *a5, __int64 a6, int a7)
{
  unsigned int v7; // er12
  __int64 v12; // rdi
  __int64 v13; // rcx
  _BYTE *v14; // rax
  _BYTE *v15; // rbx
  PDEVICE_OBJECT v16; // rcx
  PDEVICE_OBJECT v17; // rcx
  PDEVICE_OBJECT v18; // rcx
  PDEVICE_OBJECT v19; // rcx
  PDEVICE_OBJECT v20; // rcx
  int v21; // edi
  PDEVICE_OBJECT v22; // r10
  int v23; // edi
  PDEVICE_OBJECT v24; // rcx
  int v25; // edi
  PDEVICE_OBJECT v26; // r10
  int v27; // esi
  int *v28; // rax
  int v29; // er9
  void *v30; // r8
  _DWORD *v31; // rax
  int v32; // eax
  int v33; // eax
  int v34; // eax
  __int64 v36; // [rsp+20h] [rbp-D8h]
  __int64 v37; // [rsp+28h] [rbp-D0h]
  __int64 v38; // [rsp+30h] [rbp-C8h]
  PLARGE_INTEGER v39; // [rsp+38h] [rbp-C0h]
  int v40; // [rsp+50h] [rbp-A8h]
  int v41; // [rsp+50h] [rbp-A8h]
  __int16 v42; // [rsp+54h] [rbp-A4h]
  __int16 v43; // [rsp+54h] [rbp-A4h]
  __int64 v44; // [rsp+60h] [rbp-98h] BYREF
  __int64 v45; // [rsp+68h] [rbp-90h]
  __int128 v46; // [rsp+70h] [rbp-88h]
  int v47; // [rsp+80h] [rbp-78h]
  __int16 v48; // [rsp+84h] [rbp-74h]
  char v49; // [rsp+86h] [rbp-72h]
  int v50; // [rsp+90h] [rbp-68h] BYREF
  __int16 v51; // [rsp+94h] [rbp-64h]
  _DWORD v52[2]; // [rsp+A0h] [rbp-58h]
  int v53; // [rsp+A8h] [rbp-50h]
  __int16 v54; // [rsp+ACh] [rbp-4Ch]

  v7 = 0;
  *(_DWORD *)(a2 + 372) = 0;
  *(_DWORD *)(a2 + 120) |= 0x10u;
  *(_DWORD *)((char *)v52 + 1) = 0;
  BYTE1(v52[1]) = 0;
  LOBYTE(v52[0]) = 0;
  *(_QWORD *)a2 = _InterlockedIncrement64(&qword_627A8) | 0x8000000000000000ui64;
  if ( a6 )
  {
    v52[0] = *(_DWORD *)a6;
    LOWORD(v52[1]) = *(_WORD *)(a6 + 4);
  }
  v12 = *(_QWORD *)(a2 + 16);
  v53 = -1;
  v54 = -1;
  v40 = *a4;
  v42 = *((_WORD *)a4 + 2);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_42A20(
      *(_QWORD *)&off_60148->AlignmentRequirement,
      0xF3u,
      (__int64)&unk_5CCA8,
      v12,
      (unsigned __int8)v40,
      BYTE1(v40),
      BYTE2(v40),
      HIBYTE(v40),
      (unsigned __int8)v42,
      HIBYTE(v42));
  }
  *(_DWORD *)(v12 + 6) = v40;
  *(_WORD *)(v12 + 10) = v42;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xF4u, (__int64)&unk_5CCA8);
  }
  v50 = v53;
  v13 = *(_QWORD *)(a2 + 16);
  v51 = v54;
  sub_45670(v13, (unsigned __int8 *)&v50);
  sub_45760(*(_QWORD *)(a2 + 16), 0x806u);
  v14 = sub_42C74(*(_QWORD *)(a2 + 16), 7);
  v15 = v14;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    LODWORD(v36) = 1;
    sub_11230(*(_QWORD *)&off_60148->AlignmentRequirement, 0xD1u, (__int64)&unk_5CCA8, v14, v36);
  }
  *(_WORD *)v15 = 256;
  v16 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xD2u, (__int64)&unk_5CCA8);
      v16 = off_60148;
    }
    if ( v16 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v16->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v16->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      LODWORD(v36) = 2048;
      sub_11230(*(_QWORD *)&v16->AlignmentRequirement, 0xD5u, (__int64)&unk_5CCA8, v15, v36);
    }
  }
  *((_WORD *)v15 + 1) = 8;
  v17 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xD6u, (__int64)&unk_5CCA8);
      v17 = off_60148;
    }
    if ( v17 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v17->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v17->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      LODWORD(v36) = 6;
      sub_11230(*(_QWORD *)&v17->AlignmentRequirement, 0xD9u, (__int64)&unk_5CCA8, v15, v36);
    }
  }
  v15[4] = 6;
  v18 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xDAu, (__int64)&unk_5CCA8);
      v18 = off_60148;
    }
    if ( v18 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v18->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v18->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      LODWORD(v36) = 4;
      sub_11230(*(_QWORD *)&v18->AlignmentRequirement, 0xDDu, (__int64)&unk_5CCA8, v15, v36);
    }
  }
  v15[5] = 4;
  v19 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xDEu, (__int64)&unk_5CCA8);
      v19 = off_60148;
    }
    if ( v19 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v19->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v19->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      LODWORD(v36) = 1;
      sub_11230(*(_QWORD *)&v19->AlignmentRequirement, 0xE1u, (__int64)&unk_5CCA8, v15, v36);
    }
  }
  *((_WORD *)v15 + 3) = 256;
  v20 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xE2u, (__int64)&unk_5CCA8);
    v20 = off_60148;
  }
  v21 = 1;
  v41 = *a4;
  v43 = *((_WORD *)a4 + 2);
  if ( v20 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v20->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v20->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_2F80C(*(_QWORD *)&v20->AlignmentRequirement, 0xE5u, (__int64)&unk_5CCA8, v15);
  }
  if ( sub_45570((__int16 *)v15) )
  {
    v21 = 0;
    *((_DWORD *)v15 + 2) = v41;
    *((_WORD *)v15 + 6) = v43;
  }
  v22 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xE6u, (__int64)&unk_5CCA8, v21);
    v22 = off_60148;
  }
  v23 = 1;
  if ( v22 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v22->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v22->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    LODWORD(v39) = a3[3];
    LODWORD(v38) = a3[2];
    LODWORD(v37) = a3[1];
    LODWORD(v36) = *a3;
    sub_42B1C(*(_QWORD *)&v22->AlignmentRequirement, 0xE9u, (__int64)&unk_5CCA8, v15, v36, v37, v38, v39);
  }
  if ( sub_45570((__int16 *)v15) )
  {
    v23 = 0;
    *(_DWORD *)(v15 + 14) = *(_DWORD *)a3;
  }
  v24 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xEAu, (__int64)&unk_5CCA8, v23);
    v24 = off_60148;
  }
  v25 = 1;
  if ( v24 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v24->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v24->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_2F80C(*(_QWORD *)&v24->AlignmentRequirement, 0xEDu, (__int64)&unk_5CCA8, v15);
  }
  if ( sub_45570((__int16 *)v15) )
  {
    v25 = 0;
    *(_DWORD *)(v15 + 18) = v52[0];
    *((_WORD *)v15 + 11) = v52[1];
  }
  v26 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xEEu, (__int64)&unk_5CCA8, v25);
    v26 = off_60148;
  }
  v27 = 1;
  if ( v26 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v26->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v26->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    LODWORD(v39) = a5[3];
    LODWORD(v38) = a5[2];
    LODWORD(v37) = a5[1];
    LODWORD(v36) = *a5;
    sub_42B1C(*(_QWORD *)&v26->AlignmentRequirement, 0xF1u, (__int64)&unk_5CCA8, v15, v36, v37, v38, v39);
  }
  if ( sub_45570((__int16 *)v15) )
  {
    *((_DWORD *)v15 + 6) = *(_DWORD *)a5;
    v27 = 0;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xF2u, (__int64)&unk_5CCA8, v27);
  }
  *(_QWORD *)(a2 + 8) = MEMORY[0xFFFFF78000000014];
  sub_17784(a2);
  sub_4ED98(a2, "REINJECTED_ARP_SCAN", 0x13ui64);
  sub_17648(a2);
  v28 = *(int **)(a2 + 132);
  if ( v28 )
    v29 = *v28;
  else
    v29 = 0;
  v30 = v28 + 1;
  if ( !v28 )
    v30 = 0i64;
  sub_18B70(
    *(const void **)(a2 + 16),
    *(_DWORD *)(a2 + 124),
    v30,
    v29,
    *(_DWORD *)(a2 + 120),
    *(_DWORD *)(a2 + 128),
    *(_DWORD *)(a2 + 208),
    (PLARGE_INTEGER)(a2 + 8),
    0);
  v31 = *(_DWORD **)(a2 + 132);
  *(_DWORD *)(a2 + 140) = a7;
  if ( v31 )
    *v31 = 0;
  if ( byte_61288 )
  {
    v45 = 0i64;
    v46 = 0ui64;
    v47 = 0;
    v48 = 0;
    v49 = 0;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x22u, (__int64)&unk_5CDA8);
    }
    v44 = *(_QWORD *)(a2 + 16);
    LODWORD(v45) = *(_DWORD *)(a2 + 124);
    v32 = *(_DWORD *)(a2 + 396);
    LODWORD(v46) = 1;
    BYTE4(v46) = 1;
    *(_QWORD *)((char *)&v46 + 5) = 0i64;
    HIDWORD(v45) = v32;
    v33 = sub_4D1A4(40036, &v44, 0x27u);
    v7 = v33;
    if ( v33 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x23u, (__int64)&unk_5CDA8, v33);
      }
    }
    else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
           && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
           && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x24u, (__int64)&unk_5CDA8);
    }
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x25u, (__int64)&unk_5CDA8);
    }
    if ( (unsigned int)sub_28A70() )
    {
      v34 = qword_650C8(
              *(unsigned int *)(a2 + 124),
              *(_QWORD *)(a2 + 16),
              a1,
              (*(_BYTE *)(a2 + 120) & 0x10) == 16,
              0i64);
      if ( v34 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_112FC(off_60148->Dpc.ProcessorHistory, 0x26u, (__int64)&unk_5CDA8, v34);
        }
        v7 = 1;
      }
      sub_28AD8();
      if ( (unsigned int)dword_622E4 > 2 )
        _InterlockedAdd((volatile signed __int32 *)P + 2, 1u);
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x27u, (__int64)&unk_5CDA8);
      }
      v7 = 9;
    }
  }
  return v7;
}
// 2D452: variable 'v36' is possibly undefined
// 2D793: variable 'v37' is possibly undefined
// 2D793: variable 'v38' is possibly undefined
// 2D793: variable 'v39' is possibly undefined
// 61288: using guessed type char byte_61288;
// 622E4: using guessed type int dword_622E4;
// 627A8: using guessed type __int64 qword_627A8;
// 650C8: using guessed type __int64 (__fastcall *qword_650C8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002DC54) ----------------------------------------------------
__int64 __fastcall sub_2DC54(__int64 a1, __int64 a2)
{
  int v2; // er12
  __int64 v3; // rdi
  int v4; // ebp
  unsigned int v5; // ebx
  unsigned int v6; // esi
  PDEVICE_OBJECT v7; // rax
  __int64 v8; // rax
  __int64 v9; // r15
  PDEVICE_OBJECT v10; // rcx
  __int64 result; // rax
  int v12; // er9
  int v13; // er13
  unsigned int v14; // er12
  int v15; // eax
  int v16; // er12
  unsigned int v17; // er13
  PDEVICE_OBJECT v18; // rbp
  unsigned int v19; // er14
  unsigned int v20; // eax
  __int128 v21; // xmm6
  int *v22; // r12
  int v23; // edi
  PDEVICE_OBJECT v24; // rax
  unsigned int v25; // [rsp+90h] [rbp-D8h]
  int v26; // [rsp+98h] [rbp-D0h]
  int v27; // [rsp+A0h] [rbp-C8h]
  unsigned int v28; // [rsp+A4h] [rbp-C4h]
  unsigned int v29; // [rsp+A8h] [rbp-C0h] BYREF
  __int128 v30; // [rsp+B0h] [rbp-B8h]
  unsigned int v31; // [rsp+C0h] [rbp-A8h]
  union _LARGE_INTEGER Interval; // [rsp+C8h] [rbp-A0h] BYREF
  int v33; // [rsp+D0h] [rbp-98h]
  unsigned __int8 *v34; // [rsp+D8h] [rbp-90h]
  __int64 v35; // [rsp+E0h] [rbp-88h]
  __int64 v36; // [rsp+E8h] [rbp-80h]
  int *v37; // [rsp+F0h] [rbp-78h]
  __int64 v38; // [rsp+F8h] [rbp-70h]
  __int128 v39; // [rsp+100h] [rbp-68h] BYREF
  int v40; // [rsp+110h] [rbp-58h] BYREF
  __int16 v41; // [rsp+114h] [rbp-54h]

  v2 = *(_DWORD *)(a1 + 70);
  v3 = a1;
  v4 = *(_DWORD *)(a1 + 54);
  v34 = (unsigned __int8 *)(a1 + 54);
  v35 = a1;
  v5 = 0;
  v37 = (int *)(a1 + 48);
  v36 = a2;
  v33 = v2;
  v29 = 0;
  v6 = sub_502CC(0x200A011u);
  v28 = v6;
  v31 = sub_502CC(0x200A016u);
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x28u, (__int64)&unk_5CDA8);
      v7 = off_60148;
    }
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(v7->Dpc.DeferredContext) >= 5u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x29u, (__int64)&unk_5CDA8, KeGetCurrentThread());
    }
  }
  v40 = *(_DWORD *)(v3 + 48);
  v41 = *(_WORD *)(v3 + 52);
  sub_19410((__int64)&v40, &v29);
  v8 = sub_26328(512i64, MEMORY[0xFFFFF78000000014], v29);
  v9 = v8;
  v38 = v8;
  if ( v8 )
  {
    v12 = *(_DWORD *)(v3 + 156);
    *(_DWORD *)(v8 + 396) = v12;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x2Cu, (__int64)&unk_5CDA8, v12);
    }
    *(_DWORD *)(v9 + 128) = 2;
    v40 = sub_502CC(0x200A009u);
    v13 = (HIBYTE(v4) | (unsigned __int16)(BYTE2(v4) << 8))
        + ((BYTE1(v4) | (unsigned __int16)((unsigned __int8)v4 << 8)) << 16);
    v14 = (HIBYTE(v2) | (unsigned __int16)(BYTE2(v2) << 8))
        + ((BYTE1(v33) | (unsigned __int16)((unsigned __int8)v2 << 8)) << 16);
    v15 = ~v14;
    if ( v14 >= 0xFFFFFF00 )
    {
      v16 = v13 & v14;
      v17 = v15 | v13;
    }
    else
    {
      if ( !v6 )
        v6 = 255;
      v28 = v6;
      v16 = v13 - (v6 >> 1);
      v17 = (v6 >> 1) + v13;
    }
    v25 = v17;
    v18 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2C4A8(off_60148->Dpc.ProcessorHistory, 45i64, (__int64)&unk_5CDA8, HIBYTE(v16));
      v18 = off_60148;
      v3 = v35;
      v6 = v28;
      v5 = 0;
    }
    v19 = v16 + 1;
    v20 = 1;
    v26 = 1;
    v27 = v16 + 1;
    if ( v16 + 1 < v17 )
    {
      while ( v20 <= v6 )
      {
        v30 = 0ui64;
        if ( v3 != -16 )
        {
          Interval.QuadPart = 0i64;
          if ( !KeWaitForSingleObject((PVOID)(v3 + 16), Executive, 0, 0, &Interval) )
          {
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
              && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
            {
              sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Eu, (__int64)&unk_5CDA8);
            }
            KeResetEvent((PRKEVENT)(v3 + 16));
            v5 = 7;
            break;
          }
          v18 = off_60148;
        }
        Interval.QuadPart = -10000 * v36;
        if ( v18 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v18->Dpc.DeferredContext + 1, 0xCu)
          && BYTE1(v18->Dpc.DeferredContext) >= 5u )
        {
          sub_112FC(v18->Dpc.ProcessorHistory, 0x2Fu, (__int64)&unk_5CDA8, v36);
        }
        KeDelayExecutionThread(0, 0, &Interval);
        BYTE3(v30) = v19;
        BYTE1(v30) = BYTE2(v19);
        BYTE2(v30) = BYTE1(v19);
        LOBYTE(v30) = HIBYTE(v19);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_2C3A4(off_60148->Dpc.ProcessorHistory, 48i64, (__int64)&unk_5CDA8, HIBYTE(v19));
          v17 = v25;
          v19 = v27;
          v6 = v28;
          v5 = 0;
        }
        v21 = v30;
        v9 = v38;
        v22 = v37;
        v23 = 0;
        while ( 1 )
        {
          v39 = v21;
          if ( (unsigned int)sub_2D248(v29, v9, v34, v22, (unsigned __int8 *)&v39, 0i64, v40) )
            break;
          if ( ++v23 > v31 )
            goto LABEL_53;
        }
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x31u, (__int64)&unk_5CDA8);
        }
LABEL_53:
        memset(*(void **)(v9 + 16), 0, 0x200ui64);
        ++v19;
        v20 = v26 + 1;
        v27 = v19;
        ++v26;
        if ( v19 >= v17 )
          break;
        v18 = off_60148;
        v3 = v35;
      }
    }
    sub_1864C(v9, 1);
    v24 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x32u, (__int64)&unk_5CDA8);
        v24 = off_60148;
      }
      if ( v24 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v24->Dpc.DeferredContext + 1, 0xCu)
        && BYTE1(v24->Dpc.DeferredContext) >= 5u )
      {
        sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x33u, (__int64)&unk_5CDA8, KeGetCurrentThread());
      }
    }
    result = v5;
  }
  else
  {
    v10 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Au, (__int64)&unk_5CDA8);
        v10 = off_60148;
      }
      if ( v10 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v10->Dpc.DeferredContext + 1, 0xCu)
        && BYTE1(v10->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v10->Dpc.ProcessorHistory, 0x2Bu, (__int64)&unk_5CDA8);
      }
    }
    result = 3i64;
  }
  return result;
}

//----- (000000000002E44C) ----------------------------------------------------
void __fastcall sub_2E44C(PVOID StartContext)
{
  PDEVICE_OBJECT v2; // rcx
  int v3; // er9
  int v4; // eax
  int v5; // ebx
  PDEVICE_OBJECT v6; // rcx
  int v7; // eax
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  unsigned int v10; // eax
  __int64 v11; // rbx
  unsigned __int16 v12; // dx
  int v13; // eax
  PDEVICE_OBJECT v14; // rcx
  union _LARGE_INTEGER Time; // [rsp+30h] [rbp+8h] BYREF

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x34u, (__int64)&unk_5CDA8);
    v2 = off_60148;
  }
  v3 = *((_DWORD *)StartContext + 11);
  if ( v3 != 2048 )
  {
    if ( v3 == 34525
      || v2 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xCu)
      || BYTE1(v2->Dpc.DeferredContext) < 3u )
    {
      goto LABEL_51;
    }
    v12 = 61;
LABEL_50:
    sub_112FC(v2->Dpc.ProcessorHistory, v12, (__int64)&unk_5CDA8, v3);
    goto LABEL_51;
  }
  v4 = sub_502CC(0x200A015u);
  Time.QuadPart = 0i64;
  v5 = v4;
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x35u, (__int64)&unk_5CDA8, v4);
    v6 = off_60148;
  }
  if ( v5 == 1 || v5 == 3 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(v6->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(v6->Dpc.ProcessorHistory, 0x36u, (__int64)&unk_5CDA8, 0i64);
    }
    v7 = sub_2DC54((__int64)StartContext, 0i64);
    if ( v7 )
    {
      v8 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        v9 = 55;
LABEL_21:
        sub_112FC(v8->Dpc.ProcessorHistory, v9, (__int64)&unk_5CDA8, v7);
        goto LABEL_51;
      }
      goto LABEL_51;
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x38u, (__int64)&unk_5CDA8);
    }
  }
  if ( v5 != 2 && v5 != 3 )
  {
LABEL_41:
    Time.QuadPart = MEMORY[0xFFFFF78000000014];
    RtlTimeToSecondsSince1970(&Time, (PULONG)StartContext);
    v2 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
    {
      goto LABEL_51;
    }
    v3 = *(_DWORD *)StartContext;
    v12 = 60;
    goto LABEL_50;
  }
  v10 = sub_502CC(0x200A014u);
  v11 = v10;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x39u, (__int64)&unk_5CDA8, v10);
  }
  v7 = sub_2DC54((__int64)StartContext, v11);
  if ( !v7 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x3Bu, (__int64)&unk_5CDA8);
    }
    goto LABEL_41;
  }
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    v9 = 58;
    goto LABEL_21;
  }
LABEL_51:
  v13 = sub_2F084((__int64)StartContext + 48, 1);
  if ( !v13 )
  {
LABEL_56:
    v14 = off_60148;
    goto LABEL_57;
  }
  v14 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    goto LABEL_61;
  if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x3Eu, (__int64)&unk_5CDA8, v13);
    goto LABEL_56;
  }
LABEL_57:
  if ( v14 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v14->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(v14->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v14->Dpc.ProcessorHistory, 0x3Fu, (__int64)&unk_5CDA8);
  }
LABEL_61:
  PsTerminateSystemThread(0);
}

//----- (000000000002E7B8) ----------------------------------------------------
__int64 __fastcall sub_2E7B8(void *Src)
{
  __int64 result; // rax
  int v3; // ebx
  PDEVICE_OBJECT v4; // rcx
  int v5; // [rsp+40h] [rbp+8h] BYREF
  int v6; // [rsp+48h] [rbp+10h] BYREF
  int v7; // [rsp+50h] [rbp+18h] BYREF

  v5 = 0;
  v6 = 0;
  v7 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x40u, (__int64)&unk_5CDA8);
  }
  result = sub_19410((__int64)Src + 8, &v5);
  if ( v5 )
  {
    sub_195E4((__int64)Src + 8, &v6);
    v3 = v6;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x41u, (__int64)&unk_5CDA8, v6);
    }
    *((_DWORD *)Src + 29) = v3;
    result = (__int64)sub_2EC90(Src, &v7);
    if ( v7 )
    {
      v4 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return result;
      if ( !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
        || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_20;
      }
      result = sub_112FC(off_60148->Dpc.ProcessorHistory, 0x42u, (__int64)&unk_5CDA8, v7);
    }
    goto LABEL_19;
  }
  v4 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return result;
  if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
  {
    result = sub_11008(off_60148->Dpc.ProcessorHistory, 0x43u, (__int64)&unk_5CDA8);
LABEL_19:
    v4 = off_60148;
  }
LABEL_20:
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(v4->Dpc.DeferredContext) >= 5u )
  {
    result = sub_11008(v4->Dpc.ProcessorHistory, 0x44u, (__int64)&unk_5CDA8);
  }
  return result;
}

//----- (000000000002E948) ----------------------------------------------------
__int64 __fastcall sub_2E948(__int64 a1)
{
  __int64 v2; // rbx
  __int64 v3; // rax
  __int64 v4; // rdi
  __int64 result; // rax
  int v6; // eax
  __m128i v7; // xmm6
  int v8; // ebx
  int v9; // eax
  unsigned int v10; // ebx
  unsigned int v11[4]; // [rsp+40h] [rbp-58h] BYREF
  __m128i v12; // [rsp+50h] [rbp-48h] BYREF
  char v13; // [rsp+60h] [rbp-38h] BYREF
  int v14; // [rsp+61h] [rbp-37h]
  char v15; // [rsp+65h] [rbp-33h]

  v11[0] = 0;
  v14 = 0;
  v15 = 0;
  v13 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x45u, (__int64)&unk_5CDA8);
  }
  v2 = MEMORY[0xFFFFF78000000014];
  sub_19410(a1 + 337, v11);
  v3 = sub_26328(512i64, v2, v11[0]);
  v4 = v3;
  if ( v3 )
  {
    *(_DWORD *)(v3 + 128) = 2;
    *(_DWORD *)(v3 + 396) = *(_DWORD *)(a1 + 379);
    v6 = sub_502CC(0x200A009u);
    v7 = _mm_loadu_si128((const __m128i *)(a1 + 32));
    v8 = v6;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x47u, (__int64)&unk_5CDA8);
    }
    v12 = v7;
    v9 = sub_2D248(
           v11[0],
           v4,
           (unsigned __int8 *)(a1 + 347),
           (int *)(a1 + 337),
           (unsigned __int8 *)&v12,
           (__int64)&v13,
           v8);
    v10 = v9;
    if ( v9
      && off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x48u, (__int64)&unk_5CDA8, v9);
    }
    sub_1864C(v4, 1);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x49u, (__int64)&unk_5CDA8);
    }
    result = v10;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x46u, (__int64)&unk_5CDA8);
    }
    result = 3i64;
  }
  return result;
}

//----- (000000000002EB84) ----------------------------------------------------
__int64 sub_2EB84()
{
  char *v0; // rbx
  struct _KEVENT *v1; // rdi
  __int64 v2; // rsi
  __int64 result; // rax

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x4Au, (__int64)&unk_5CDA8);
  }
  v0 = (char *)&unk_61C48;
  v1 = &Event;
  v2 = 8i64;
  do
  {
    v0[152] = 1;
    memset(&v1[1], 0, 0x78ui64);
    KeInitializeEvent(v1, NotificationEvent, 0);
    *(_QWORD *)v0 = 0i64;
    v0 += 168;
    v1 += 7;
    --v2;
  }
  while ( v2 );
  result = sub_3FD2C(&Resource);
  byte_61434 = 1;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    result = sub_11008(off_60148->Dpc.ProcessorHistory, 0x4Bu, (__int64)&unk_5CDA8);
  }
  return result;
}
// 61434: using guessed type char byte_61434;

//----- (000000000002EC90) ----------------------------------------------------
char *__fastcall sub_2EC90(void *Src, _DWORD *a2)
{
  char *v4; // r13
  _BYTE *v5; // rbx
  int v6; // esi
  _BYTE *v7; // rbp
  __int64 v8; // rdi
  int v9; // edi
  PDEVICE_OBJECT v10; // rbx
  __int64 v11; // rdi
  struct _OBJECT_ATTRIBUTES ObjectAttributes; // [rsp+50h] [rbp-48h] BYREF

  v4 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x4Eu, (__int64)&unk_5CDA8);
  }
  *a2 = 5;
  KeEnterCriticalRegion();
  sub_3FED4(&Resource);
  v5 = &unk_61CE0;
  v6 = 0;
  v7 = &unk_61CE0;
  do
  {
    if ( !*v7 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x4Fu, (__int64)&unk_5CDA8, v6);
      }
      v8 = 168i64 * v6;
      if ( !stricmp((const char *)&unk_61C40 + v8 + 124, (const char *)Src + 84) )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          sub_2C55C(off_60148->Dpc.ProcessorHistory, 80i64, (__int64)&unk_5CDA8, (const char *)Src + 84);
        }
        goto LABEL_26;
      }
      if ( sub_47C5C((_BYTE *)&unk_61C40 + v8 + 48, (__int64)Src + 8) )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x51u, (__int64)&unk_5CDA8);
        }
LABEL_26:
        *a2 = 0x2000;
        goto LABEL_36;
      }
    }
    ++v6;
    v7 += 168;
  }
  while ( v6 < 8 );
  v9 = 0;
  while ( !*v5 )
  {
    v5 += 168;
    ++v9;
    if ( (__int64)v5 >= (__int64)&byte_62220 )
      goto LABEL_36;
  }
  ObjectAttributes.Length = 0;
  memset(&ObjectAttributes.RootDirectory, 0, 0x28ui64);
  v10 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x52u, (__int64)&unk_5CDA8, v9);
    v10 = off_60148;
  }
  v11 = 168i64 * v9;
  memmove((char *)&unk_61C40 + v11 + 40, Src, 0x78ui64);
  ObjectAttributes.RootDirectory = 0i64;
  ObjectAttributes.ObjectName = 0i64;
  ObjectAttributes.SecurityDescriptor = 0i64;
  ObjectAttributes.SecurityQualityOfService = 0i64;
  *((_BYTE *)&unk_61C40 + v11 + 160) = 0;
  v4 = (char *)&unk_61C40 + v11;
  ObjectAttributes.Length = 48;
  ObjectAttributes.Attributes = 512;
  if ( v10 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v10->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(v10->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v10->Dpc.ProcessorHistory, 0x55u, (__int64)&unk_5CDA8);
  }
  PsCreateSystemThread(
    (PHANDLE)((char *)&unk_61C40 + v11 + 8),
    0x110000u,
    &ObjectAttributes,
    0i64,
    0i64,
    (PKSTART_ROUTINE)sub_2E44C,
    (char *)&unk_61C40 + v11);
  *a2 = 0;
LABEL_36:
  sub_40084(&Resource);
  KeLeaveCriticalRegion();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x56u, (__int64)&unk_5CDA8);
  }
  return v4;
}
// 62220: using guessed type char byte_62220;

//----- (000000000002F084) ----------------------------------------------------
__int64 __fastcall sub_2F084(__int64 a1, char a2)
{
  unsigned int v4; // esi
  int v5; // ebx
  _BYTE *v6; // rdi
  PDEVICE_OBJECT v7; // rcx
  __int64 v8; // rbx
  void *v9; // rcx
  __int64 v10; // rbx

  v4 = 5;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x57u, (__int64)&unk_5CDA8);
  }
  KeEnterCriticalRegion();
  sub_3FFAC(&Resource);
  v5 = 0;
  v6 = &unk_61CE0;
  while ( 1 )
  {
    if ( !*v6 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x58u, (__int64)&unk_5CDA8, v5);
      }
      if ( sub_47C5C((_BYTE *)&unk_61C70 + 168 * v5, a1) )
        break;
    }
    ++v5;
    v6 += 168;
    if ( v5 >= 8 )
      goto LABEL_33;
  }
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x59u, (__int64)&unk_5CDA8, v5);
    v7 = off_60148;
  }
  if ( a2 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(v7->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v7->Dpc.ProcessorHistory, 0x5Au, (__int64)&unk_5CDA8);
    }
    v8 = 168i64 * v5;
    memset((char *)&unk_61C40 + v8 + 40, 0, 0x78ui64);
    v9 = *(void **)((char *)&unk_61C40 + v8 + 8);
    *((_BYTE *)&unk_61C40 + v8 + 160) = 1;
    ZwClose(v9);
    *(_QWORD *)((char *)&unk_61C40 + v8 + 8) = 0i64;
  }
  else
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(v7->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v7->Dpc.ProcessorHistory, 0x5Bu, (__int64)&unk_5CDA8);
    }
    v10 = 168i64 * v5;
    KeSetEvent((PRKEVENT)((char *)&unk_61C40 + v10 + 16), 0, 0);
    ZwWaitForSingleObject(*(HANDLE *)((char *)&unk_61C40 + v10 + 8), 0, 0i64);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x5Cu, (__int64)&unk_5CDA8);
    }
  }
  v4 = 0;
LABEL_33:
  sub_40084(&Resource);
  KeLeaveCriticalRegion();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x5Du, (__int64)&unk_5CDA8);
  }
  return v4;
}

//----- (000000000002F338) ----------------------------------------------------
__int64 __fastcall sub_2F338(__int64 a1)
{
  __int64 result; // rax

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x5Eu, (__int64)&unk_5CDA8);
  }
  result = sub_2F084(a1, 0);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    result = sub_11008(off_60148->Dpc.ProcessorHistory, 0x60u, (__int64)&unk_5CDA8);
  }
  return result;
}

//----- (000000000002F3D8) ----------------------------------------------------
void sub_2F3D8()
{
  PDEVICE_OBJECT v0; // rcx
  PDEVICE_OBJECT v1; // rcx
  int v2; // ebx
  HANDLE *v3; // rdi
  struct _KEVENT *v4; // rsi
  int v5; // eax

  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x61u, (__int64)&unk_5CDA8);
    v0 = off_60148;
  }
  if ( byte_61434 )
  {
    KeEnterCriticalRegion();
    sub_3FFAC(&Resource);
    v1 = off_60148;
    v2 = 0;
    v3 = (HANDLE *)&unk_61C48;
    v4 = &Event;
    do
    {
      if ( !*((_BYTE *)v3 + 152) )
      {
        if ( v1 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v1->Dpc.DeferredContext + 1, 0xCu)
          && BYTE1(v1->Dpc.DeferredContext) >= 5u )
        {
          sub_112FC(v1->Dpc.ProcessorHistory, 0x62u, (__int64)&unk_5CDA8, v2);
        }
        KeSetEvent(v4, 0, 0);
        v5 = ZwWaitForSingleObject(*v3, 0, 0i64);
        v1 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          sub_112FC(off_60148->Dpc.ProcessorHistory, 0x63u, (__int64)&unk_5CDA8, v5);
          v1 = off_60148;
        }
      }
      ++v2;
      v4 += 7;
      v3 += 21;
    }
    while ( v2 < 8 );
    sub_40084(&Resource);
    KeLeaveCriticalRegion();
    v0 = off_60148;
  }
  if ( v0 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v0->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(v0->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v0->Dpc.ProcessorHistory, 0x64u, (__int64)&unk_5CDA8);
  }
}
// 61434: using guessed type char byte_61434;

//----- (000000000002F598) ----------------------------------------------------
__int64 __fastcall sub_2F598(__int64 a1, _DWORD *a2)
{
  unsigned int v2; // esi
  __int64 v5; // rcx
  bool v6; // zf
  bool v7; // cf
  int v8; // eax
  PDEVICE_OBJECT v9; // rcx
  int v11; // [rsp+20h] [rbp-38h] BYREF
  unsigned int v12; // [rsp+24h] [rbp-34h]
  unsigned __int16 v13; // [rsp+28h] [rbp-30h]
  _BYTE v14[12]; // [rsp+2Ch] [rbp-2Ch] BYREF

  v2 = 0;
  v11 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xBu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_5CD98);
  }
  *a2 = 0;
  if ( (*(_BYTE *)(a1 + 120) & 0x10) == 0 && *(_QWORD *)(a1 + 32) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xBu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_5CD98, *(_QWORD *)a1);
    }
    sub_2C648(a1, 2i64, a2);
  }
  v5 = *(_QWORD *)(a1 + 24);
  v6 = (*(_BYTE *)(a1 + 120) & 0x10) == 0;
  *(_DWORD *)&v14[1] = 0;
  v14[5] = 0;
  v14[0] = 0;
  v12 = -1;
  v13 = -1;
  if ( v6 )
  {
    sub_438AC(v5, (__int64)v14);
    goto LABEL_19;
  }
  sub_43964(v5, (__int64)v14);
  v7 = v12 < *(_DWORD *)v14;
  if ( v12 == *(_DWORD *)v14 && (v7 = v13 < *(_WORD *)&v14[4], v13 == *(_WORD *)&v14[4]) )
    v8 = 0;
  else
    v8 = -v7 - (v7 - 1);
  if ( v8 )
  {
LABEL_19:
    v2 = sub_318C8(v14, &v11, 1);
    if ( !v2 && v11 == 2 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xBu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xCu, (__int64)&unk_5CD98);
      }
      *a2 = 4;
    }
    goto LABEL_30;
  }
  v9 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return v2;
  if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xBu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_5CD98);
LABEL_30:
    v9 = off_60148;
  }
  if ( v9 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v9->Dpc.DeferredContext + 1, 0xBu)
    && BYTE1(v9->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v9->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_5CD98);
  }
  return v2;
}

//----- (000000000002F7B8) ----------------------------------------------------
__int64 sub_2F7B8(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CD78, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002F80C) ----------------------------------------------------
__int64 sub_2F80C(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+68h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, a3, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002F848) ----------------------------------------------------
__int64 sub_2F848()
{
  unsigned int v0; // ebx
  __int64 result; // rax
  unsigned int v2; // eax
  int v3; // [rsp+70h] [rbp+8h] BYREF

  v0 = 0;
  v3 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_5CD88);
  }
  qword_62180 = sub_3F8D8(1, 0x198u, 0x6443734Eu);
  if ( qword_62180 )
  {
    v2 = sub_502CC(0x200A010u);
    qword_64DC0 = (ULONG_PTR)sub_53288(
                               3,
                               0,
                               1,
                               0x6443734Eu,
                               v2,
                               2,
                               0i64,
                               0i64,
                               (__int64)sub_2FBE4,
                               (__int64)sub_30678,
                               &v3);
    if ( v3 )
    {
      sub_3F95C(qword_62180);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0xCu, (__int64)&unk_5CD88, v3);
      }
      v0 = 3;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_5CD88);
      }
      sub_404B8((__int64)&FastMutex);
      byte_61435 = 1;
      qword_62188 = (PVOID)sub_40820(1u);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_5CD88);
      }
    }
    result = v0;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_5CD88);
    }
    result = 3i64;
  }
  return result;
}
// 61435: using guessed type char byte_61435;

//----- (000000000002FA74) ----------------------------------------------------
__int64 sub_2FA74()
{
  unsigned int v0; // ebx
  PDEVICE_OBJECT v1; // rcx
  int v2; // eax
  int v3; // edi

  v0 = 0;
  v1 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x12u, (__int64)&unk_5CD88);
    v1 = off_60148;
  }
  if ( qword_64DC0 && byte_61435 )
  {
    sub_40598(&FastMutex);
    v2 = sub_541A0(qword_64DC0);
    v3 = v2;
    if ( v2 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_5CD88, v2);
      }
      v0 = sub_57F30(v3);
    }
    sub_40664(&FastMutex);
    goto LABEL_18;
  }
  if ( v1 == (PDEVICE_OBJECT)&off_60148 )
    return v0;
  if ( _bittest((const signed __int32 *)&v1->Dpc.DeferredContext + 1, 0xEu) && BYTE1(v1->Dpc.DeferredContext) >= 2u )
  {
    sub_11008(v1->Dpc.ProcessorHistory, 0x14u, (__int64)&unk_5CD88);
LABEL_18:
    v1 = off_60148;
  }
  if ( v1 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v1->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(v1->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v1->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_5CD88);
  }
  return v0;
}
// 61435: using guessed type char byte_61435;

//----- (000000000002FBE4) ----------------------------------------------------
__int64 __fastcall sub_2FBE4(_QWORD *a1)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x19u, (__int64)&unk_5CD88);
    v2 = off_60148;
  }
  if ( a1 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(v2->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(v2->Dpc.ProcessorHistory, 0x1Au, (__int64)&unk_5CD88, *a1);
    }
    sub_30678((__int64)a1);
    sub_3FAE4((__int64)qword_62180, (__int64)a1);
    v2 = off_60148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(v2->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v2->Dpc.ProcessorHistory, 0x1Bu, (__int64)&unk_5CD88);
  }
  return 0i64;
}

//----- (000000000002FCDC) ----------------------------------------------------
_QWORD *__fastcall sub_2FCDC(void *Src, ULONG_PTR **a2, int *a3)
{
  __m128i *v6; // rsi
  __m128i *v7; // rbp
  PDEVICE_OBJECT v8; // rcx
  int v9; // eax
  __m128i v10; // xmm0
  __m128i v11; // xmm1
  int v12; // ebx
  PDEVICE_OBJECT v14; // r11
  bool v15; // cf
  unsigned __int64 v16; // rdx
  int v17; // eax
  __int64 v18; // rcx
  __int64 v19; // rdx
  char v20; // al
  bool v21; // cf
  int v22; // eax
  _DWORD *v23; // rax
  _QWORD *v24; // rbx
  PDEVICE_OBJECT v25; // rcx
  char v26; // [rsp+3Fh] [rbp-99h]
  __int128 v27; // [rsp+40h] [rbp-98h]
  int v28[2]; // [rsp+50h] [rbp-88h] BYREF
  __int128 v29; // [rsp+58h] [rbp-80h]
  int v30; // [rsp+68h] [rbp-70h] BYREF
  __int16 v31; // [rsp+6Ch] [rbp-6Ch]
  int v32; // [rsp+6Eh] [rbp-6Ah]
  __m128i v33; // [rsp+72h] [rbp-66h] BYREF
  __m128i v34; // [rsp+82h] [rbp-56h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x1Eu, (__int64)&unk_5CD88);
  }
  *a3 = 0;
  v6 = (__m128i *)((char *)Src + 363);
  v7 = (__m128i *)((char *)Src + 347);
  LOBYTE(v30) = 0;
  memset((char *)&v30 + 1, 0, 0x29ui64);
  v28[0] = 0;
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x5Cu, (__int64)&unk_5CD88);
    v8 = off_60148;
  }
  if ( Src == (void *)-337i64 || Src == (void *)-347i64 || Src == (void *)-363i64 )
  {
    if ( v8 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v8->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(v8->Dpc.DeferredContext) >= 2u )
    {
      sub_385D4(
        v8->Dpc.ProcessorHistory,
        0x5Du,
        (__int64)&unk_5CD88,
        (char *)Src + 337,
        (char *)Src + 347,
        (char *)Src + 363);
    }
    v12 = 4;
  }
  else
  {
    v30 = *(_DWORD *)((char *)Src + 337);
    v31 = *(_WORD *)((char *)Src + 341);
    v9 = sub_49D44(40002i64, &v30, 42i64, dword_65434, v28);
    v10 = _mm_loadu_si128(&v33);
    v11 = _mm_loadu_si128(&v34);
    v12 = v9;
    *(_DWORD *)((char *)Src + 343) = v32;
    *v7 = v10;
    *v6 = v11;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x5Eu, (__int64)&unk_5CD88);
    }
  }
  *a3 = v12;
  if ( v12 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x1Fu, (__int64)&unk_5CD88, v12);
    }
    return 0i64;
  }
  v27 = 0ui64;
  v14 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xCu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_114E4(off_60148->Dpc.ProcessorHistory, 0x20u, (__int64)&unk_5CD88, v7->m128i_u8[0]);
    v14 = off_60148;
  }
  v15 = v7->m128i_i64[0] < (unsigned __int64)v27;
  if ( v7->m128i_i64[0] == (_QWORD)v27
    && (v16 = *(_QWORD *)((char *)Src + 355), v15 = v16 < *((_QWORD *)&v27 + 1), v16 == *((_QWORD *)&v27 + 1)) )
  {
    v17 = 0;
  }
  else
  {
    v17 = -v15 - (v15 - 1);
  }
  if ( !v17 )
  {
    if ( v14 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v14->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(v14->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(v14->Dpc.ProcessorHistory, 0x21u, (__int64)&unk_5CD88);
    }
    *a3 = 6;
    return 0i64;
  }
  v29 = 0ui64;
  v27 = 0ui64;
  if ( v14 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&v14->Dpc.DeferredContext + 1, 0xCu) && BYTE1(v14->Dpc.DeferredContext) >= 4u )
    {
      sub_114E4(v14->Dpc.ProcessorHistory, 0x22u, (__int64)&unk_5CD88, v7->m128i_u8[0]);
      v14 = off_60148;
    }
    if ( v14 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v14->Dpc.DeferredContext + 1, 0xCu)
      && BYTE1(v14->Dpc.DeferredContext) >= 4u )
    {
      sub_114E4(v14->Dpc.ProcessorHistory, 0x23u, (__int64)&unk_5CD88, *((unsigned __int8 *)Src + 32));
      v14 = off_60148;
    }
  }
  v18 = 0i64;
  v19 = 16i64;
  do
  {
    *((_BYTE *)&v28[1] + ++v18 + 3) = v6->m128i_i8[0] & v6[-1].m128i_i8[0];
    v20 = v6->m128i_i8[0] & v6[-21].m128i_i8[5];
    v6 = (__m128i *)((char *)v6 + 1);
    --v19;
    *(&v26 + v18) = v20;
  }
  while ( v19 );
  v21 = (unsigned __int64)v29 < (unsigned __int64)v27;
  if ( (_QWORD)v29 == (_QWORD)v27
    && (v21 = *((_QWORD *)&v29 + 1) < *((_QWORD *)&v27 + 1), *((_QWORD *)&v29 + 1) == *((_QWORD *)&v27 + 1)) )
  {
    v22 = 0;
  }
  else
  {
    v22 = -v21 - (v21 - 1);
  }
  if ( v22 )
  {
    if ( v14 == (PDEVICE_OBJECT)&off_60148 )
      goto LABEL_64;
    if ( _bittest((const signed __int32 *)&v14->Dpc.DeferredContext + 1, 0xEu) && BYTE1(v14->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(v14->Dpc.ProcessorHistory, 0x24u, (__int64)&unk_5CD88);
      v14 = off_60148;
    }
  }
  if ( v14 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v14->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(v14->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v14->Dpc.ProcessorHistory, 0x16u, (__int64)&unk_5CD88);
  }
LABEL_64:
  v23 = sub_3FA7C((__int64)qword_62180);
  v24 = v23;
  if ( !v23 )
  {
    v25 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x17u, (__int64)&unk_5CD88);
        v25 = off_60148;
      }
      if ( v25 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v25->Dpc.DeferredContext + 1, 0xEu)
        && BYTE1(v25->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(v25->Dpc.ProcessorHistory, 0x25u, (__int64)&unk_5CD88);
      }
    }
    *a3 = 3;
    return 0i64;
  }
  memset(v23, 0, 0x198ui64);
  sub_588AC(v24, 6ui64, (char *)Src + 12, 6ui64);
  memmove((char *)v24 + 12, Src, 0x18Bui64);
  *(_DWORD *)((char *)v24 + 403) = sub_502CC(0x200A017u);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x18u, (__int64)&unk_5CD88);
  }
  if ( (unsigned int)sub_55180(qword_64DC0, *v24, (__int64)v24, a2) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x26u, (__int64)&unk_5CD88, *v24);
    }
    sub_2FBE4(v24);
    *a3 = 13;
    return 0i64;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x27u, (__int64)&unk_5CD88, *v24);
  }
  sub_30678((__int64)v24);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x28u, (__int64)&unk_5CD88);
  }
  return v24;
}
// 65434: using guessed type int dword_65434;

//----- (0000000000030380) ----------------------------------------------------
__int64 __fastcall sub_30380(unsigned __int64 a1, _QWORD *a2, _DWORD *a3)
{
  ULONG_PTR v6; // rcx
  __int64 v7; // rbx
  PDEVICE_OBJECT v8; // rcx
  int v10; // [rsp+40h] [rbp+18h] BYREF

  v10 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x29u, (__int64)&unk_5CD88);
  }
  v6 = qword_64DC0;
  *a3 = 0;
  v7 = sub_559E0(v6, a1, a2, &v10);
  if ( v10 )
  {
    v8 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x2Bu, (__int64)&unk_5CD88, a1);
      v8 = off_60148;
    }
    *a3 = 5;
    v7 = 0i64;
  }
  else
  {
    v8 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x2Au, (__int64)&unk_5CD88, a1);
      v8 = off_60148;
    }
    *a3 = 0;
  }
  if ( v8 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v8->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(v8->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v8->Dpc.ProcessorHistory, 0x2Cu, (__int64)&unk_5CD88);
  }
  return v7;
}

//----- (00000000000304E0) ----------------------------------------------------
__int64 __fastcall sub_304E0(ULONG_PTR BugCheckParameter1)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x30u, (__int64)&unk_5CD88);
  }
  sub_56A10(qword_64DC0, BugCheckParameter1);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x31u, (__int64)&unk_5CD88);
  }
  return 0i64;
}

//----- (0000000000030588) ----------------------------------------------------
__int64 __fastcall sub_30588(ULONG_PTR BugCheckParameter1)
{
  unsigned int v2; // eax
  int v3; // eax
  PDEVICE_OBJECT v4; // rcx

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x35u, (__int64)&unk_5CD88);
  }
  v2 = sub_502CC(0x200A010u);
  v3 = sub_57D60(qword_64DC0, BugCheckParameter1, v2);
  if ( !v3 )
    goto LABEL_10;
  v4 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return 0i64;
  if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x36u, (__int64)&unk_5CD88, v3);
LABEL_10:
    v4 = off_60148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v4->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(v4->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v4->Dpc.ProcessorHistory, 0x37u, (__int64)&unk_5CD88);
  }
  return 0i64;
}

//----- (0000000000030678) ----------------------------------------------------
__int64 __fastcall sub_30678(__int64 a1)
{
  PDEVICE_OBJECT v2; // rbx
  __int64 result; // rax

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    result = sub_11008(off_60148->Dpc.ProcessorHistory, 0x38u, (__int64)&unk_5CD88);
    v2 = off_60148;
  }
  if ( !a1 )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_60148 )
      return result;
    if ( !_bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu) || BYTE1(v2->Dpc.DeferredContext) < 2u )
      goto LABEL_51;
    result = sub_11008(v2->Dpc.ProcessorHistory, 0x39u, (__int64)&unk_5CD88);
    goto LABEL_50;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu) && BYTE1(v2->Dpc.DeferredContext) >= 4u )
    {
      result = sub_11008(v2->Dpc.ProcessorHistory, 0x3Au, (__int64)&unk_5CD88);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu) && BYTE1(v2->Dpc.DeferredContext) >= 4u )
      {
        result = sub_11008(v2->Dpc.ProcessorHistory, 0x3Bu, (__int64)&unk_5CD88);
        v2 = off_60148;
      }
      if ( v2 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu)
          && BYTE1(v2->Dpc.DeferredContext) >= 4u )
        {
          result = sub_1102C(v2->Dpc.ProcessorHistory, 0x3Cu, (__int64)&unk_5CD88, *(unsigned __int8 *)(a1 + 349));
          v2 = off_60148;
        }
        if ( v2 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu)
            && BYTE1(v2->Dpc.DeferredContext) >= 4u )
          {
            result = sub_1102C(v2->Dpc.ProcessorHistory, 0x3Du, (__int64)&unk_5CD88, *(unsigned __int8 *)(a1 + 24));
            v2 = off_60148;
          }
          if ( v2 != (PDEVICE_OBJECT)&off_60148 )
          {
            if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu)
              && BYTE1(v2->Dpc.DeferredContext) >= 4u )
            {
              result = sub_114E4(v2->Dpc.ProcessorHistory, 0x3Eu, (__int64)&unk_5CD88, *(unsigned __int8 *)(a1 + 44));
              v2 = off_60148;
            }
            if ( v2 != (PDEVICE_OBJECT)&off_60148 )
            {
              if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu)
                && BYTE1(v2->Dpc.DeferredContext) >= 4u )
              {
                result = sub_1102C(v2->Dpc.ProcessorHistory, 0x3Fu, (__int64)&unk_5CD88, *(unsigned __int8 *)(a1 + 30));
                v2 = off_60148;
              }
              if ( v2 != (PDEVICE_OBJECT)&off_60148 )
              {
                if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu)
                  && BYTE1(v2->Dpc.DeferredContext) >= 4u )
                {
                  result = sub_114E4(
                             v2->Dpc.ProcessorHistory,
                             0x40u,
                             (__int64)&unk_5CD88,
                             *(unsigned __int8 *)(a1 + 60));
                  v2 = off_60148;
                }
                if ( v2 != (PDEVICE_OBJECT)&off_60148 )
                {
                  if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu)
                    && BYTE1(v2->Dpc.DeferredContext) >= 4u )
                  {
                    result = sub_112FC(v2->Dpc.ProcessorHistory, 0x41u, (__int64)&unk_5CD88, *(_DWORD *)(a1 + 395));
                    v2 = off_60148;
                  }
                  if ( v2 != (PDEVICE_OBJECT)&off_60148 )
                  {
                    if ( _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu)
                      && BYTE1(v2->Dpc.DeferredContext) >= 4u )
                    {
                      result = sub_112FC(v2->Dpc.ProcessorHistory, 0x42u, (__int64)&unk_5CD88, *(_DWORD *)(a1 + 399));
                      v2 = off_60148;
                    }
                    if ( v2 != (PDEVICE_OBJECT)&off_60148 )
                    {
                      if ( !_bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu)
                        || BYTE1(v2->Dpc.DeferredContext) < 4u )
                      {
LABEL_51:
                        if ( v2 != (PDEVICE_OBJECT)&off_60148
                          && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0xEu)
                          && BYTE1(v2->Dpc.DeferredContext) >= 5u )
                        {
                          result = sub_11008(v2->Dpc.ProcessorHistory, 0x44u, (__int64)&unk_5CD88);
                        }
                        return result;
                      }
                      result = sub_112FC(v2->Dpc.ProcessorHistory, 0x43u, (__int64)&unk_5CD88, *(_DWORD *)(a1 + 8));
LABEL_50:
                      v2 = off_60148;
                      goto LABEL_51;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return result;
}

//----- (0000000000030A80) ----------------------------------------------------
__int64 __fastcall sub_30A80(void *Src, _BYTE *a2, _DWORD *a3, _BYTE *a4)
{
  __int64 v8; // rbx
  __int64 v9; // rax
  unsigned int v10; // edi
  __int64 v11; // rbx
  ULONG_PTR v12; // rbx
  int v13; // eax
  unsigned __int64 v14; // rdx
  bool v15; // cf
  unsigned __int64 v16; // rdx
  int v17; // eax
  unsigned int v19; // [rsp+50h] [rbp+8h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+58h] [rbp+10h] BYREF

  v19 = 0;
  BugCheckParameter1 = 0i64;
  v8 = *(_QWORD *)((_BYTE *)Src + 12) & 0xFFFFFFFFFFFFi64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x45u, (__int64)&unk_5CD88);
  }
  *a2 = 0;
  *a4 = 0;
  sub_40598(&FastMutex);
  v9 = sub_30380(v8, &BugCheckParameter1, &v19);
  v10 = v19;
  v11 = v9;
  if ( v19 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x46u, (__int64)&unk_5CD88, v19);
    }
    sub_2FCDC(Src, (ULONG_PTR **)&BugCheckParameter1, (int *)&v19);
    v10 = v19;
    if ( v19
      && off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x47u, (__int64)&unk_5CD88, v19);
    }
    sub_40664(&FastMutex);
    v12 = BugCheckParameter1;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x48u, (__int64)&unk_5CD88, *(_DWORD *)(v9 + 399));
    }
    v13 = *(_DWORD *)(v11 + 399);
    *(_DWORD *)(v11 + 8) = 0;
    *(_DWORD *)(v11 + 399) = 1;
    v14 = *(_QWORD *)(v11 + 44);
    *a3 = v13;
    v15 = v14 < *((_QWORD *)Src + 4);
    if ( v14 == *((_QWORD *)Src + 4)
      && (v16 = *(_QWORD *)(v11 + 52), v15 = v16 < *((_QWORD *)Src + 5), v16 == *((_QWORD *)Src + 5)) )
    {
      v17 = 0;
    }
    else
    {
      v17 = -v15 - (v15 - 1);
    }
    if ( v17 )
    {
      *(__m128i *)(v11 + 44) = _mm_loadu_si128((const __m128i *)Src + 2);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x49u, (__int64)&unk_5CD88);
      }
      sub_30678(v11);
      *a4 = 1;
    }
    sub_40664(&FastMutex);
    v12 = BugCheckParameter1;
    *a2 = 1;
    sub_30588(v12);
  }
  if ( v12 )
    sub_304E0(v12);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x4Au, (__int64)&unk_5CD88);
  }
  return v10;
}

//----- (0000000000030D34) ----------------------------------------------------
__int64 sub_30D34()
{
  unsigned int v0; // ebx
  int v2; // [rsp+38h] [rbp+10h] BYREF

  v2 = 0;
  v0 = sub_55088(qword_64DC0, &v2);
  if ( v2
    && off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x4Bu, (__int64)&unk_5CD88, v2);
  }
  return v0;
}

//----- (0000000000030DA8) ----------------------------------------------------
void sub_30DA8()
{
  int v0; // eax

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x32u, (__int64)&unk_5CD88);
  }
  sub_40598(&FastMutex);
  v0 = sub_578A8(qword_64DC0);
  if ( v0
    && off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x33u, (__int64)&unk_5CD88, v0);
  }
  sub_40664(&FastMutex);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x34u, (__int64)&unk_5CD88);
  }
}

//----- (0000000000030EA8) ----------------------------------------------------
__int64 __fastcall sub_30EA8(void *Dst, _DWORD *a2)
{
  unsigned int v4; // ebx
  int v5; // eax
  __int64 i; // rax
  int v8; // [rsp+40h] [rbp+8h] BYREF
  ULONG_PTR v9; // [rsp+50h] [rbp+18h] BYREF

  v4 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x4Du, (__int64)&unk_5CD88);
  }
  sub_40598(&FastMutex);
  v5 = sub_30D34();
  if ( v5 )
  {
    if ( (unsigned int)(395 * v5) <= *a2 )
    {
      for ( i = sub_5621C(qword_64DC0, &v9, &v8); i; i = sub_563E8(qword_64DC0, &v9, 1, &v8) )
      {
        memmove(Dst, (const void *)(i + 12), 0x18Bui64);
        Dst = (char *)Dst + 395;
      }
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x4Eu, (__int64)&unk_5CD88);
      }
      v4 = 3;
    }
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
         && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x4Fu, (__int64)&unk_5CD88);
  }
  sub_40664(&FastMutex);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x50u, (__int64)&unk_5CD88, v4);
  }
  return v4;
}

//----- (0000000000031058) ----------------------------------------------------
__int64 __fastcall sub_31058(int *a1, _BYTE *a2, _QWORD *a3)
{
  __int64 result; // rax
  PDEVICE_OBJECT v7; // rcx
  unsigned int v8; // ebp
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  int v11; // [rsp+30h] [rbp-1C8h] BYREF
  char Dst[391]; // [rsp+34h] [rbp-1C4h] BYREF

  v11 = 0;
  result = (__int64)memset(Dst, 0, sizeof(Dst));
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    result = sub_11008(off_60148->Dpc.ProcessorHistory, 0x51u, (__int64)&unk_5CD88);
    v7 = off_60148;
  }
  if ( a1 && a2 && a3 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(v7->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(v7->Dpc.ProcessorHistory, 0x53u, (__int64)&unk_5CD88);
    }
    sub_30678((__int64)a1);
    result = *(unsigned int *)((char *)a1 + 399);
    if ( (_DWORD)result == 1 || (_DWORD)result == 3 && (result = sub_502CC(0x200A013u), a1[2] <= (unsigned int)result) )
    {
      *a2 = 0;
      result = sub_502CC(0x200A012u);
      *a3 = (unsigned int)result;
      ++a1[2];
      *(int *)((char *)a1 + 399) = 3;
      v9 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        result = sub_112FC(off_60148->Dpc.ProcessorHistory, 0x54u, (__int64)&unk_5CD88, a1[2]);
        v9 = off_60148;
      }
      if ( a1[10] == 2048 )
      {
        result = sub_2E948((__int64)(a1 + 3));
        goto LABEL_46;
      }
      if ( a1[10] == 34525 )
        goto LABEL_47;
      if ( v9 == (PDEVICE_OBJECT)&off_60148 )
        return result;
      if ( !_bittest((const signed __int32 *)&v9->Dpc.DeferredContext + 1, 0xEu) || BYTE1(v9->Dpc.DeferredContext) < 3u )
        goto LABEL_47;
      v10 = 85;
    }
    else if ( *(int *)((char *)a1 + 399) == 3 && (v8 = a1[2], result = sub_502CC(0x200A013u), v8 > (unsigned int)result) )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x56u, (__int64)&unk_5CD88, v8);
      }
      *a2 = 1;
      *a3 = 0i64;
      sub_588AC(&v11, 0x18Bui64, a1 + 3, 0x18Bui64);
      *(_DWORD *)&Dst[383] = 2;
      result = sub_4D1A4(40022, &v11, 0x18Bu);
      if ( (_DWORD)result )
      {
        v9 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
          return result;
        if ( !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
          || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
        {
          goto LABEL_47;
        }
        result = sub_112FC(off_60148->Dpc.ProcessorHistory, 0x57u, (__int64)&unk_5CD88, result);
LABEL_46:
        v9 = off_60148;
LABEL_47:
        if ( v9 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( _bittest((const signed __int32 *)&v9->Dpc.DeferredContext + 1, 0xEu)
            && BYTE1(v9->Dpc.DeferredContext) >= 4u )
          {
            result = sub_112FC(v9->Dpc.ProcessorHistory, 0x5Au, (__int64)&unk_5CD88, *(int *)((char *)a1 + 399));
            v9 = off_60148;
          }
          if ( v9 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v9->Dpc.DeferredContext + 1, 0xEu)
            && BYTE1(v9->Dpc.DeferredContext) >= 5u )
          {
            result = sub_11008(v9->Dpc.ProcessorHistory, 0x5Bu, (__int64)&unk_5CD88);
          }
        }
        return result;
      }
      v9 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return result;
      if ( !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
        || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
      {
        goto LABEL_47;
      }
      v10 = 88;
    }
    else
    {
      *a2 = 1;
      *a3 = 0i64;
      v9 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return result;
      if ( !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
        || BYTE1(off_60148->Dpc.DeferredContext) < 3u )
      {
        goto LABEL_47;
      }
      v10 = 89;
    }
    result = sub_11008(v9->Dpc.ProcessorHistory, v10, (__int64)&unk_5CD88);
    goto LABEL_46;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v7->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(v7->Dpc.DeferredContext) >= 2u )
  {
    result = sub_385D4(v7->Dpc.ProcessorHistory, 0x52u, (__int64)&unk_5CD88, a1, a2, a3);
  }
  *a2 = 1;
  *a3 = 0i64;
  return result;
}

//----- (0000000000031438) ----------------------------------------------------
__int64 __fastcall sub_31438(void *Dst, __int64 a2, const void *a3)
{
  PDEVICE_OBJECT v6; // rcx
  __int64 result; // rax

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x5Fu, (__int64)&unk_5CD88);
    v6 = off_60148;
  }
  if ( Dst && a2 && a3 )
  {
    memmove(Dst, a3, 0x2Aui64);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x61u, (__int64)&unk_5CD88);
    }
    result = 0i64;
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(v6->Dpc.DeferredContext) >= 2u )
    {
      sub_385D4(v6->Dpc.ProcessorHistory, 0x60u, (__int64)&unk_5CD88, Dst, a2, a3);
    }
    result = 4i64;
  }
  return result;
}

//----- (0000000000031554) ----------------------------------------------------
__int64 __fastcall sub_31554(__int64 a1, __int64 a2, const __m128i *a3)
{
  __int64 i; // rax
  unsigned int v7; // er8
  bool v8; // cf
  unsigned __int16 v9; // r8
  int v10; // eax
  __int64 v11; // r11
  ULONG_PTR v13[3]; // [rsp+20h] [rbp-18h] BYREF
  int v14; // [rsp+58h] [rbp+20h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x62u, (__int64)&unk_5CD88);
  }
  sub_40598(&FastMutex);
  if ( (unsigned int)sub_30D34() )
  {
    for ( i = sub_5621C(qword_64DC0, v13, &v14); ; i = sub_563E8(qword_64DC0, v13, 0, &v14) )
    {
      v11 = i;
      if ( !i )
        break;
      v7 = *(_DWORD *)(i + 349);
      v8 = v7 < *(_DWORD *)a1;
      if ( v7 == *(_DWORD *)a1 && (v9 = *(_WORD *)(i + 353), v8 = v9 < *(_WORD *)(a1 + 4), v9 == *(_WORD *)(a1 + 4)) )
        v10 = 0;
      else
        v10 = -v8 - (v8 - 1);
      if ( !v10 )
      {
        *(_DWORD *)(v11 + 349) = *(_DWORD *)a2;
        *(_WORD *)(v11 + 353) = *(_WORD *)(a2 + 4);
        *(__m128i *)(v11 + 359) = _mm_loadu_si128(a3);
      }
    }
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
         && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x63u, (__int64)&unk_5CD88);
  }
  sub_40664(&FastMutex);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x64u, (__int64)&unk_5CD88, 0);
  }
  return 0i64;
}

//----- (0000000000031700) ----------------------------------------------------
__int64 __fastcall sub_31700(__int64 a1)
{
  __int64 i; // rax
  __int64 v3; // r8
  unsigned int v4; // edx
  bool v5; // cf
  unsigned __int16 v6; // dx
  int v7; // eax
  int v9; // [rsp+38h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+40h] [rbp+18h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x65u, (__int64)&unk_5CD88);
  }
  sub_40598(&FastMutex);
  if ( (unsigned int)sub_30D34() )
  {
    for ( i = sub_5621C(qword_64DC0, &BugCheckParameter1, &v9); i; i = sub_563E8(
                                                                         qword_64DC0,
                                                                         &BugCheckParameter1,
                                                                         1,
                                                                         &v9) )
    {
      v4 = *(_DWORD *)(i + 349);
      v5 = v4 < *(_DWORD *)a1;
      if ( v4 == *(_DWORD *)a1 && (v6 = *(_WORD *)(i + 353), v5 = v6 < *(_WORD *)(a1 + 4), v6 == *(_WORD *)(a1 + 4)) )
        v7 = 0;
      else
        v7 = -v5 - (v5 - 1);
      if ( !v7 )
      {
        LOBYTE(v3) = 1;
        sub_5575C(qword_64DC0, BugCheckParameter1, v3, &v9);
        if ( v9 )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
          {
            sub_112FC(off_60148->Dpc.ProcessorHistory, 0x66u, (__int64)&unk_5CD88, v9);
          }
        }
      }
    }
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
         && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x67u, (__int64)&unk_5CD88);
  }
  sub_40664(&FastMutex);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x68u, (__int64)&unk_5CD88, 0);
  }
  return 0i64;
}
// 317C4: variable 'v3' is possibly undefined

//----- (00000000000318C8) ----------------------------------------------------
__int64 __fastcall sub_318C8(unsigned __int8 *a1, int *a2, char a3)
{
  __int64 v3; // rdi
  __int64 v6; // rdi
  __int64 v8; // rax
  unsigned int v9; // ebx
  __int64 v10; // rdi
  unsigned int v12; // [rsp+80h] [rbp+8h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+98h] [rbp+20h] BYREF

  BugCheckParameter1 = 0i64;
  v3 = *(_QWORD *)a1;
  v12 = 5;
  v6 = v3 & 0xFFFFFFFFFFFFi64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x69u, (__int64)&unk_5CD88);
  }
  sub_40598(&FastMutex);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_1102C(off_60148->Dpc.ProcessorHistory, 0x6Au, (__int64)&unk_5CD88, *a1);
  }
  v8 = sub_30380(v6, &BugCheckParameter1, &v12);
  v9 = v12;
  v10 = v8;
  if ( !v12 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, v12 + 107, (__int64)&unk_5CD88);
    }
    if ( a3 )
      *a2 = *(_DWORD *)(v10 + 403);
    else
      *(_DWORD *)(v10 + 403) = *a2;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x6Cu, (__int64)&unk_5CD88, *a2);
    }
    sub_304E0(BugCheckParameter1);
  }
  sub_40664(&FastMutex);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x6Du, (__int64)&unk_5CD88, v9);
  }
  return v9;
}

//----- (0000000000031AE0) ----------------------------------------------------
__int64 __fastcall sub_31AE0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CD78, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000031B40) ----------------------------------------------------
__int64 __fastcall sub_31B40(__int64 a1, __int64 a2, __int64 a3, char a4)
{
  char v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CD78, 74i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000031B98) ----------------------------------------------------
__int64 __fastcall sub_31B98(__int64 a1, __int64 a2, __int64 a3, int a4, char a5, char a6, const char *a7, char a8, char a9, const char *a10, char a11, const char *a12)
{
  int v14; // [rsp+E8h] [rbp+20h] BYREF

  v14 = a4;
  if ( a12 )
    strlen(a12);
  if ( a10 )
    strlen(a10);
  if ( a7 )
    strlen(a7);
  return qword_61238(a1, 43i64, &unk_5CD78, 72i64, &v14);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000031D34) ----------------------------------------------------
__int64 __fastcall sub_31D34(__int64 a1, __int64 a2, __int64 a3, int a4, char a5, const char *a6, const char *a7)
{
  int v9; // [rsp+98h] [rbp+20h] BYREF

  v9 = a4;
  if ( a7 )
    strlen(a7);
  if ( a6 )
    strlen(a6);
  return qword_61238(a1, 43i64, &unk_5CD78, 23i64, &v9);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000031E08) ----------------------------------------------------
__int64 __fastcall sub_31E08(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, const char *a5)
{
  int v7; // [rsp+78h] [rbp+20h] BYREF

  v7 = a4;
  if ( a5 )
    strlen(a5);
  return qword_61238(a1, 43i64, a3, a2, &v7);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000031E88) ----------------------------------------------------
__int64 __fastcall sub_31E88(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5, char a6, char a7, char a8, char a9, const char *a10)
{
  int v12; // [rsp+C8h] [rbp+20h] BYREF

  v12 = a4;
  if ( a10 )
    strlen(a10);
  if ( a5 )
    strlen(a5);
  return qword_61238(a1, 43i64, &unk_5CD78, 136i64, &v12);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000031FA4) ----------------------------------------------------
__int64 __fastcall sub_31FA4(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5, char a6, const char *a7, char a8, char a9, const char *a10)
{
  int v12; // [rsp+C8h] [rbp+20h] BYREF

  v12 = a4;
  if ( a10 )
    strlen(a10);
  if ( a7 )
    strlen(a7);
  if ( a5 )
    strlen(a5);
  return qword_61238(a1, 43i64, &unk_5CD78, 139i64, &v12);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000032110) ----------------------------------------------------
__int64 __fastcall sub_32110(__int64 a1, __int64 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CD78, 73i64, v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000321A4) ----------------------------------------------------
__int64 __fastcall sub_321A4(__int64 a1, __int64 a2, __int64 a3, const char *a4, char a5, const char *a6)
{
  const char *v7; // rcx

  if ( a6 )
    strlen(a6);
  if ( a4 )
    strlen(a4);
  v7 = "NULL";
  if ( a4 )
    v7 = a4;
  return qword_61238(a1, 43i64, &unk_5CD78, 138i64, v7);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003225C) ----------------------------------------------------
__int64 sub_3225C()
{
  _WORD *v0; // rax
  __int64 result; // rax
  int v2; // eax
  unsigned int v3; // ebx
  unsigned int v4; // eax
  int v5; // [rsp+70h] [rbp+8h] BYREF

  v5 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_5CD78);
  }
  v0 = sub_3F66C(2, 0xBu, 0x7270644Eu);
  qword_621D0 = v0;
  if ( v0 )
  {
    *v0 = 4;
    *(_DWORD *)(v0 + 3) = 10;
    sub_40150(&qword_621D8);
    v2 = sub_3502C();
    v3 = v2;
    if ( v2 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0xCu, (__int64)&unk_5CD78, v2);
      }
      v3 = 0;
    }
    v4 = sub_502CC(0x200A035u);
    qword_64DB8 = (ULONG_PTR)sub_53288(3, 0, 2, 0x6370644Eu, v4, 1, 0i64, 0i64, (__int64)sub_36A30, 0i64, &v5);
    if ( v5 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0xDu, (__int64)&unk_5CD78, v5);
      }
      result = 1i64;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xEu, (__int64)&unk_5CD78);
      }
      result = v3;
    }
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_5CD78);
    }
    result = 3i64;
  }
  return result;
}

//----- (000000000003246C) ----------------------------------------------------
__int64 __fastcall sub_3246C(__int64 a1, __int64 a2, _BYTE *a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  char v9[4]; // [rsp+20h] [rbp-18h] BYREF
  int v10; // [rsp+24h] [rbp-14h]
  __int64 v11; // [rsp+28h] [rbp-10h]

  v9[0] = 0;
  v10 = 0;
  v11 = 0i64;
  *a3 = 0;
  _InterlockedAdd(&dword_62194, 1u);
  if ( qword_621D0 )
  {
    if ( *(_DWORD *)((char *)qword_621D0 + 2) )
    {
      if ( !byte_61436 )
      {
        sub_32644(a1, (__int64)v9);
        if ( v9[0] )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
          {
            sub_112FC(off_60148->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_5CD78, *(_DWORD *)(v11 + 2));
          }
          sub_327A4(a1, (__int64)v9);
          if ( v9[0] )
          {
            sub_33FB0(a2, a1, (__int64)v9);
            if ( v10 == 1 || v10 == 2 )
            {
              _InterlockedAdd64(&qword_61340, 1ui64);
              if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
                && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
              {
                sub_11008(off_60148->Dpc.ProcessorHistory, 0x16u, (__int64)&unk_5CD78);
              }
              *a3 = 1;
            }
          }
        }
      }
    }
    else
    {
      v6 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        v7 = 20;
        goto LABEL_6;
      }
    }
  }
  else
  {
    v6 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      v7 = (_WORD)qword_621D0 + 19;
LABEL_6:
      sub_11008(v6->Dpc.ProcessorHistory, v7, (__int64)&unk_5CD78);
      goto LABEL_26;
    }
  }
LABEL_26:
  _InterlockedAdd(&dword_62194, 0xFFFFFFFF);
  return 0i64;
}
// 61340: using guessed type __int64 qword_61340;
// 61436: using guessed type char byte_61436;
// 62194: using guessed type int dword_62194;

//----- (0000000000032644) ----------------------------------------------------
__int64 __fastcall sub_32644(__int64 a1, __int64 a2)
{
  char *v3; // rcx
  __int64 v5; // rbx
  const char *v6; // rsi
  const char *v7; // rax
  unsigned int v8; // esi
  int v9; // eax

  *(_DWORD *)(a2 + 4) = 0;
  *(_QWORD *)(a2 + 8) = 0i64;
  v3 = (char *)qword_621D0;
  *(_BYTE *)a2 = 0;
  v5 = (__int64)(v3 + 10);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    if ( *(_DWORD *)(a1 + 16) == 1 )
    {
      v6 = "INCOMING";
    }
    else if ( *(_DWORD *)(a1 + 16) == 2 )
    {
      v6 = "OUTGOING";
    }
    else
    {
      v6 = "UNKNOWN";
    }
    v7 = sub_4D84C(*(_DWORD *)(a1 + 72));
    sub_31D34(
      off_60148->Dpc.ProcessorHistory,
      23i64,
      (__int64)&unk_5CD78,
      *(unsigned __int16 *)(a1 + 76),
      *(_WORD *)(a1 + 78),
      v6,
      v7);
    v3 = (char *)qword_621D0;
  }
  v8 = 0;
  if ( *(_DWORD *)(v3 + 2) )
  {
    while ( !sub_33270(a1, v5) )
    {
      ++v8;
      v5 += *(unsigned int *)(v5 + 37);
      if ( v8 >= *(_DWORD *)((char *)qword_621D0 + 2) )
        return 0i64;
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x18u, (__int64)&unk_5CD78, *(_DWORD *)(v5 + 2));
    }
    v9 = *(_DWORD *)(v5 + 6);
    *(_BYTE *)a2 = 1;
    *(_QWORD *)(a2 + 8) = v5;
    *(_DWORD *)(a2 + 4) = v9;
  }
  return 0i64;
}

//----- (00000000000327A4) ----------------------------------------------------
__int64 __fastcall sub_327A4(__int64 a1, __int64 a2)
{
  int v4; // er13
  unsigned __int64 v6; // rbp
  _QWORD *v7; // rax
  __int64 v8; // r8
  int v9; // esi
  _QWORD *v10; // r12
  ULONG_PTR v11; // r15
  int v12; // eax
  PDEVICE_OBJECT v13; // r10
  int v14; // ecx
  char v15; // r15
  int v16; // ebp
  _DWORD *v17; // r12
  __int64 v18; // r8
  PVOID v19; // rax
  __int64 v20; // rsi
  __int64 v21; // rcx
  int v22; // eax
  ULONG_PTR v23; // rcx
  __int64 v24; // r8
  __int64 v25; // rcx
  int v26; // er9
  _DWORD *v27; // rax
  unsigned __int16 v28; // dx
  int v29; // er8
  __int64 v30; // rcx
  int v31; // er9
  _DWORD *v32; // rax
  __int64 v33; // r9
  int v34; // er8
  _DWORD *v35; // rax
  __int64 v36; // rcx
  __int64 v37; // rcx
  unsigned __int16 v38; // dx
  __int64 v39; // [rsp+20h] [rbp-58h]
  _QWORD *v40; // [rsp+30h] [rbp-48h]
  int v41; // [rsp+90h] [rbp+18h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+98h] [rbp+20h] BYREF

  BugCheckParameter1 = 0i64;
  v41 = 0;
  v4 = 0;
  if ( !*(_DWORD *)(*(_QWORD *)(a2 + 8) + 28i64) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x19u, (__int64)&unk_5CD78);
    }
    return 0i64;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x1Au, (__int64)&unk_5CD78);
  }
  v6 = (unsigned int)sub_368DC(a1);
  v7 = (_QWORD *)sub_559E0(qword_64DB8, v6, &BugCheckParameter1, &v41);
  v9 = v41;
  v10 = v7;
  v40 = v7;
  if ( !v7 || v41 )
  {
    v11 = BugCheckParameter1;
    goto LABEL_23;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x1Bu, (__int64)&unk_5CD78, *v7);
  }
  v11 = BugCheckParameter1;
  v12 = sub_57D60(qword_64DB8, BugCheckParameter1, 0i64);
  v9 = v12;
  v41 = v12;
  if ( !v12 )
    goto LABEL_23;
  v13 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    goto LABEL_28;
  if ( (BYTE4(off_60148[1].AttachedDevice) & 2) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 3u )
  {
    sub_2F7B8((__int64)off_60148[1].DriverObject, 0x1Cu, (__int64)&unk_5CD78, *v10, v12);
LABEL_23:
    v13 = off_60148;
  }
  if ( v13 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(v13->Dpc.DeferredContext) >= 4u )
  {
    sub_112FC(v13->Dpc.ProcessorHistory, 0x1Du, (__int64)&unk_5CD78, *(_DWORD *)(*(_QWORD *)(a2 + 8) + 32i64));
    v13 = off_60148;
  }
LABEL_28:
  v14 = *(_DWORD *)(*(_QWORD *)(a2 + 8) + 28i64);
  switch ( v14 )
  {
    case 1:
      if ( v13 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v13->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v13->Dpc.ProcessorHistory, 0x1Eu, (__int64)&unk_5CD78);
        v13 = off_60148;
      }
      if ( !v10 || v9 )
      {
        if ( v13 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(v13->Dpc.DeferredContext) >= 4u )
        {
          sub_2F80C(v13->Dpc.ProcessorHistory, 0x23u, (__int64)&unk_5CD78, v6);
        }
        v19 = sub_3F66C(2, 0x28u, 0x6570644Eu);
        v20 = (__int64)v19;
        if ( v19 )
        {
          memset(v19, 0, 0x28ui64);
          v21 = *(_QWORD *)(a2 + 8);
          *(_QWORD *)v20 = v6;
          *(_DWORD *)(v20 + 8) = *(_DWORD *)(v21 + 2);
          v22 = *(_DWORD *)(v21 + 32);
          v23 = qword_64DB8;
          *(_DWORD *)(v20 + 12) = v22;
          if ( (unsigned int)sub_55180(v23, v6, v20, (ULONG_PTR **)&BugCheckParameter1) )
          {
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
              && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
            {
              sub_31AE0(
                off_60148->Dpc.ProcessorHistory,
                0x25u,
                (__int64)&unk_5CD78,
                *(_DWORD *)(*(_QWORD *)(a2 + 8) + 2i64));
            }
            v4 = 13;
          }
          else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                 && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
                 && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
          {
            sub_31AE0(
              off_60148->Dpc.ProcessorHistory,
              0x26u,
              (__int64)&unk_5CD78,
              *(_DWORD *)(*(_QWORD *)(a2 + 8) + 2i64));
          }
        }
        else
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
          {
            sub_11008(off_60148->Dpc.ProcessorHistory, 0x24u, (__int64)&unk_5CD78);
          }
          v4 = 3;
        }
        break;
      }
      v15 = 0;
      v16 = 0;
      v17 = (_DWORD *)v10 + 3;
      do
      {
        if ( *v17 == *(_DWORD *)(*(_QWORD *)(a2 + 8) + 32i64) )
        {
          if ( v13 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
            && BYTE1(v13->Dpc.DeferredContext) >= 3u )
          {
            sub_112FC(v13->Dpc.ProcessorHistory, 0x1Fu, (__int64)&unk_5CD78, v16);
            v13 = off_60148;
          }
          v15 = 1;
        }
        if ( !(_BYTE)v9 && !*v17 )
        {
          if ( v13 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
            && BYTE1(v13->Dpc.DeferredContext) >= 4u )
          {
            sub_112FC(v13->Dpc.ProcessorHistory, 0x20u, (__int64)&unk_5CD78, v16);
            v13 = off_60148;
          }
          LOBYTE(v9) = 1;
          v4 = v16;
        }
        ++v16;
        v17 += 2;
      }
      while ( v16 < 4 );
      if ( v15 )
      {
        if ( (_BYTE)v9 )
        {
LABEL_56:
          v4 = 0;
          break;
        }
      }
      else if ( (_BYTE)v9 )
      {
        v18 = *(_QWORD *)(a2 + 8);
        HIDWORD(v40[v4 + 1]) = *(_DWORD *)(v18 + 32);
        LODWORD(v40[v4 + 1]) = *(_DWORD *)(v18 + 2);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11430(off_60148->Dpc.ProcessorHistory, 0x21u, (__int64)&unk_5CD78, *(_DWORD *)(v18 + 32));
        }
        goto LABEL_56;
      }
      if ( v13 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v13->Dpc.DeferredContext) >= 3u )
      {
        sub_11008(v13->Dpc.ProcessorHistory, 0x22u, (__int64)&unk_5CD78);
      }
      goto LABEL_56;
    case 5:
      if ( v13 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v13->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v13->Dpc.ProcessorHistory, 0x27u, (__int64)&unk_5CD78);
        v13 = off_60148;
      }
      if ( !v10 || v9 )
      {
        if ( v13 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
            && BYTE1(v13->Dpc.DeferredContext) >= 4u )
          {
            sub_2F80C(v13->Dpc.ProcessorHistory, 0x2Cu, (__int64)&unk_5CD78, v6);
            v13 = off_60148;
          }
          if ( v13 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
            && BYTE1(v13->Dpc.DeferredContext) >= 4u )
          {
            v28 = 45;
LABEL_121:
            sub_11008(v13->Dpc.ProcessorHistory, v28, (__int64)&unk_5CD78);
          }
        }
      }
      else
      {
        v24 = 0i64;
        v25 = 0i64;
        v26 = *(_DWORD *)(*(_QWORD *)(a2 + 8) + 32i64);
        v27 = (_DWORD *)v10 + 3;
        do
        {
          if ( *v27 == v26 )
          {
            if ( v13 != (PDEVICE_OBJECT)&off_60148 )
            {
              if ( _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
                && BYTE1(v13->Dpc.DeferredContext) >= 4u )
              {
                sub_11430(v13->Dpc.ProcessorHistory, 0x28u, (__int64)&unk_5CD78, v26);
                v13 = off_60148;
              }
              if ( v13 != (PDEVICE_OBJECT)&off_60148
                && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
                && BYTE1(v13->Dpc.DeferredContext) >= 4u )
              {
                sub_11008(v13->Dpc.ProcessorHistory, 0x29u, (__int64)&unk_5CD78);
              }
            }
            LOBYTE(v24) = 1;
            sub_5575C(qword_64DB8, v11, v24, &v41);
            if ( v41 )
            {
              if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0xEu)
                && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
              {
                LODWORD(v39) = v41;
                sub_2F7B8(off_60148->Dpc.ProcessorHistory, 0x2Au, (__int64)&unk_5CD78, v6, v39);
              }
              v4 = 5;
            }
            goto LABEL_57;
          }
          ++v25;
          v24 = (unsigned int)(v24 + 1);
          v27 += 2;
        }
        while ( v25 < 4 );
        if ( v13 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(v13->Dpc.DeferredContext) >= 4u )
        {
          v28 = 43;
          goto LABEL_121;
        }
      }
LABEL_122:
      *(_BYTE *)a2 = 0;
      break;
    case 6:
      if ( v13 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v13->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v13->Dpc.ProcessorHistory, 0x2Eu, (__int64)&unk_5CD78);
        v13 = off_60148;
      }
      if ( !v10 || v9 )
      {
        if ( v13 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(v13->Dpc.DeferredContext) >= 4u )
        {
          sub_2F80C(v13->Dpc.ProcessorHistory, 0x32u, (__int64)&unk_5CD78, v6);
        }
LABEL_149:
        *(_BYTE *)a2 = 1;
        break;
      }
      v29 = 0;
      v30 = 0i64;
      v31 = *(_DWORD *)(*(_QWORD *)(a2 + 8) + 32i64);
      v32 = (_DWORD *)v10 + 3;
      while ( *v32 != v31 )
      {
        ++v30;
        ++v29;
        v32 += 2;
        if ( v30 >= 4 )
        {
          if ( v13 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
            && BYTE1(v13->Dpc.DeferredContext) >= 4u )
          {
            sub_11008(v13->Dpc.ProcessorHistory, 0x31u, (__int64)&unk_5CD78);
          }
          goto LABEL_149;
        }
      }
      if ( v13 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(v13->Dpc.DeferredContext) >= 4u )
        {
          sub_11430(v13->Dpc.ProcessorHistory, 0x2Fu, (__int64)&unk_5CD78, v31);
          v13 = off_60148;
        }
        if ( v13 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(v13->Dpc.DeferredContext) >= 4u )
        {
          v28 = 48;
          goto LABEL_121;
        }
      }
      goto LABEL_122;
    case 3:
      if ( v13 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v13->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v13->Dpc.ProcessorHistory, 0x33u, (__int64)&unk_5CD78);
        v13 = off_60148;
      }
      if ( v10 && !v9 )
      {
        v33 = *(_QWORD *)(a2 + 8);
        v34 = 0;
        v35 = (_DWORD *)v10 + 3;
        v36 = 0i64;
        while ( *v35 != *(_DWORD *)(v33 + 32) )
        {
          ++v36;
          ++v34;
          v35 += 2;
          if ( v36 >= 4 )
            goto LABEL_57;
        }
        HIDWORD(v10[v34 + 1]) = 0;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_11430(off_60148->Dpc.ProcessorHistory, 0x34u, (__int64)&unk_5CD78, *(_DWORD *)(v33 + 32));
        }
        break;
      }
      if ( v13 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v13->Dpc.DeferredContext) >= 4u )
      {
        v37 = v13->Dpc.ProcessorHistory;
        v38 = 53;
LABEL_169:
        sub_2F80C(v37, v38, (__int64)&unk_5CD78, v6);
        break;
      }
      break;
    case 8:
      if ( v13 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v13->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v13->Dpc.ProcessorHistory, 0x36u, (__int64)&unk_5CD78);
        v13 = off_60148;
      }
      if ( !v10 || v9 )
        break;
      if ( v13 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v13->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v13->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v13->Dpc.ProcessorHistory, 0x37u, (__int64)&unk_5CD78);
      }
      LOBYTE(v8) = 1;
      sub_553BC(qword_64DB8, v6, v8, &v41);
      if ( v41 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_112FC(off_60148->Dpc.ProcessorHistory, 0x38u, (__int64)&unk_5CD78, v41);
        }
        v4 = 1;
        break;
      }
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        v37 = off_60148->Dpc.ProcessorHistory;
        v38 = 57;
        goto LABEL_169;
      }
      break;
    default:
      break;
  }
LABEL_57:
  if ( BugCheckParameter1 )
    sub_56A10(qword_64DB8, BugCheckParameter1);
  return (unsigned int)v4;
}
// 32E1A: variable 'v24' is possibly undefined
// 32E66: variable 'v39' is possibly undefined
// 331DC: variable 'v8' is possibly undefined

//----- (0000000000033270) ----------------------------------------------------
char __fastcall sub_33270(__int64 a1, __int64 a2)
{
  int v2; // er8
  char v5; // bl
  int v6; // ecx
  __int16 v7; // dx
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  unsigned __int16 v10; // dx
  unsigned __int16 v11; // ax
  PDEVICE_OBJECT v12; // rcx
  unsigned __int16 v13; // dx
  unsigned __int16 v14; // ax
  unsigned __int16 v15; // ax
  __int16 v16; // dx
  unsigned __int16 v17; // dx
  unsigned __int16 v18; // ax
  unsigned __int16 v19; // ax
  unsigned __int16 v20; // ax
  unsigned int v21; // ecx
  const char *v22; // rax
  __int64 v23; // rsi
  unsigned int v24; // er12
  unsigned int v26; // [rsp+58h] [rbp+10h] BYREF

  v2 = *(_DWORD *)(a2 + 49);
  v5 = 1;
  if ( v2 && !*(_DWORD *)(a1 + 96) )
    return 0;
  v6 = *(_DWORD *)(a1 + 32);
  if ( *(_BYTE *)(a2 + 18) )
  {
    if ( (v6 & 0x10) != 0 )
    {
      v10 = *(_WORD *)(a2 + 19);
      if ( v10 )
      {
        if ( *(_DWORD *)(a2 + 10) == 1 )
        {
          v11 = *(_WORD *)(a1 + 76);
          if ( v11 < v10 || v11 > *(_WORD *)(a2 + 21) )
          {
            v12 = off_60148;
            if ( off_60148 == (PDEVICE_OBJECT)&off_60148
              || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
              || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
            {
              return 0;
            }
            v13 = 60;
            goto LABEL_89;
          }
        }
        if ( *(_DWORD *)(a2 + 10) == 2 )
        {
          v14 = *(_WORD *)(a1 + 76);
          if ( v14 < v10 || v14 > *(_WORD *)(a2 + 21) )
          {
            v15 = *(_WORD *)(a1 + 78);
            if ( v15 < v10 || v15 > *(_WORD *)(a2 + 21) )
            {
              v12 = off_60148;
              if ( off_60148 == (PDEVICE_OBJECT)&off_60148
                || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
                || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
              {
                return 0;
              }
              v13 = 61;
              goto LABEL_89;
            }
          }
        }
      }
    }
  }
  else if ( (v6 & 0x10) != 0 )
  {
    v7 = *(_WORD *)(a2 + 19);
    if ( v7 )
    {
      if ( *(_DWORD *)(a2 + 10) == 1 && *(_WORD *)(a1 + 76) != v7 )
      {
        v8 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148
          || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
        {
          return 0;
        }
        v9 = 58;
        goto LABEL_12;
      }
      if ( *(_DWORD *)(a2 + 10) == 2 && *(_WORD *)(a1 + 76) != v7 && *(_WORD *)(a1 + 78) != v7 )
      {
        v8 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148
          || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
        {
          return 0;
        }
        v9 = 59;
        goto LABEL_12;
      }
    }
  }
  if ( *(_BYTE *)(a2 + 23) )
  {
    if ( (v6 & 0x20) != 0 )
    {
      v17 = *(_WORD *)(a2 + 24);
      if ( v17 )
      {
        if ( *(_DWORD *)(a2 + 10) == 1 )
        {
          v18 = *(_WORD *)(a1 + 78);
          if ( v18 < v17 || v18 > *(_WORD *)(a2 + 26) )
          {
            v12 = off_60148;
            if ( off_60148 == (PDEVICE_OBJECT)&off_60148
              || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
              || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
            {
              return 0;
            }
            v13 = 64;
            goto LABEL_89;
          }
        }
        if ( *(_DWORD *)(a2 + 10) == 2 )
        {
          v19 = *(_WORD *)(a1 + 78);
          if ( v19 < v17 || v19 > *(_WORD *)(a2 + 26) )
          {
            v20 = *(_WORD *)(a1 + 76);
            if ( v20 < v17 || v20 > *(_WORD *)(a2 + 26) )
            {
              v12 = off_60148;
              if ( off_60148 == (PDEVICE_OBJECT)&off_60148
                || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
                || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
              {
                return 0;
              }
              v13 = 65;
              goto LABEL_89;
            }
          }
        }
      }
    }
  }
  else if ( (v6 & 0x20) != 0 )
  {
    v16 = *(_WORD *)(a2 + 24);
    if ( v16 )
    {
      if ( *(_DWORD *)(a2 + 10) == 1 && *(_WORD *)(a1 + 78) != v16 )
      {
        v8 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148
          || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
        {
          return 0;
        }
        v9 = 62;
        goto LABEL_12;
      }
      if ( *(_DWORD *)(a2 + 10) == 2 && *(_WORD *)(a1 + 78) != v16 && *(_WORD *)(a1 + 76) != v16 )
      {
        v8 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148
          || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
        {
          return 0;
        }
        v9 = 63;
LABEL_12:
        sub_11430(v8->Dpc.ProcessorHistory, v9, (__int64)&unk_5CD78, *(_DWORD *)(a2 + 2));
        return 0;
      }
    }
  }
  v21 = *(_DWORD *)(a2 + 14);
  if ( v21 != *(_DWORD *)(a1 + 72) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      v22 = sub_4D84C(v21);
      sub_31E08(off_60148->Dpc.ProcessorHistory, 0x42u, (__int64)&unk_5CD78, *(_DWORD *)(a2 + 2), v22);
    }
    return 0;
  }
  v23 = a2 + 53;
  v24 = 0;
  v26 = *(_DWORD *)(a2 + 61);
  if ( v2 )
  {
    while ( sub_33740(a1, (_DWORD *)v23, &v26) )
    {
      if ( ++v24 < *(_DWORD *)(a2 + 49) )
      {
        v23 += *(unsigned int *)(v23 + 17) + 29i64;
        if ( *(_BYTE *)(v23 + 12) )
          v26 += *(_DWORD *)(v23 + 8);
        else
          v26 = *(_DWORD *)(v23 + 8);
        if ( v24 < *(_DWORD *)(a2 + 49) )
          continue;
      }
      return v5;
    }
    v12 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
    {
      return 0;
    }
    v13 = 67;
LABEL_89:
    sub_4DE38(v12->Dpc.ProcessorHistory, v13, (__int64)&unk_5CD78, *(_DWORD *)(a2 + 2));
    return 0;
  }
  return v5;
}

//----- (0000000000033740) ----------------------------------------------------
char __fastcall sub_33740(__int64 a1, _DWORD *a2, unsigned int *a3)
{
  unsigned int v3; // er9
  unsigned int v5; // er8
  char v6; // r15
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  unsigned int v11; // eax
  unsigned int v12; // er10
  unsigned int v13; // er10
  unsigned int v14; // ecx
  unsigned int v15; // edi
  PDEVICE_OBJECT v16; // rbp
  const char *v17; // rax
  const char *v18; // r8
  char v19; // r9
  char v20; // r10
  const char *v21; // r11
  int v22; // eax
  unsigned __int8 *v23; // rdx
  int v24; // er9
  unsigned __int16 v25; // dx
  __int64 v26; // rcx
  __int64 v27; // rbp
  _BYTE *v28; // rdx
  __int64 v29; // rdi
  unsigned int l; // ebp
  PDEVICE_OBJECT v31; // rcx
  unsigned int k; // ebp
  unsigned __int8 *v33; // rdx
  unsigned int j; // ebp
  unsigned int i; // ebp
  __int64 v36; // rbp
  _BYTE *v37; // rdx
  __int64 v38; // rdi
  unsigned int v39; // er12
  const char *v40; // rax
  size_t v42; // rdx
  const void *v43; // r9
  __int64 v44; // rax
  const char *v45; // r9
  __int64 v46; // [rsp+A0h] [rbp+8h]
  __int64 v47; // [rsp+A8h] [rbp+10h] BYREF

  v46 = a1;
  v3 = *(_DWORD *)((char *)a2 + 17);
  v5 = a2[1];
  v6 = 0;
  if ( v3 > v5 )
  {
    v9 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      v10 = 68;
LABEL_6:
      sub_11430(v9->Dpc.ProcessorHistory, v10, (__int64)&unk_5CD78, v3);
      return v6;
    }
    return v6;
  }
  v11 = *a3;
  v12 = *(_DWORD *)(a1 + 96);
  if ( *a3 <= v12 )
  {
    if ( v3 > v12 )
    {
      v9 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        v10 = 70;
        goto LABEL_6;
      }
      return v6;
    }
    v13 = v12 - v11;
    if ( v3 > v13 )
    {
      v9 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
      {
        v10 = 71;
        goto LABEL_6;
      }
      return v6;
    }
    v14 = v13;
    if ( v5 < v13 )
      v14 = a2[1];
    v15 = v14 + v11 - v3;
    LODWORD(v47) = v14;
    v16 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      v17 = sub_4DD74(*(_DWORD *)((char *)a2 + 13));
      sub_31B98(v16->Dpc.ProcessorHistory, 72i64, (__int64)&unk_5CD78, v15, v47, v20, v17, a2[1], *a3, v18, v19, v21);
      v16 = off_60148;
    }
    v22 = *(_DWORD *)((char *)a2 + 13);
    if ( v22 <= 0 )
      goto LABEL_114;
    if ( v22 <= 2 )
    {
      v39 = *a3;
      if ( *a3 > v15 )
        goto LABEL_114;
      v42 = *(unsigned int *)((char *)a2 + 17);
      v43 = (char *)a2 + 29;
      v44 = *(_QWORD *)(v46 + 88);
      v47 = v44;
      while ( memcmp((const void *)(v44 + v39), v43, v42) )
      {
        v42 = *(unsigned int *)((char *)a2 + 17);
        v44 = v47;
        ++v39;
        v43 = (char *)a2 + 29;
        if ( v39 > v15 )
          goto LABEL_114;
      }
      if ( v16 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v16->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v16->Dpc.DeferredContext) >= 4u )
      {
        v45 = "STRING";
        if ( *(_DWORD *)((char *)a2 + 13) == 1 )
          v45 = "BUFFER";
        sub_32110(v16->Dpc.ProcessorHistory, 73i64, (__int64)&unk_5CD78, v45);
      }
    }
    else
    {
      if ( v22 != 3 )
      {
        if ( v22 == 4 )
        {
          switch ( *(_DWORD *)((char *)a2 + 21) )
          {
            case 1:
              if ( *a3 <= v15 )
              {
                v36 = *a3;
                v37 = (char *)a2 + 29;
                v38 = v15 - *a3 + 1;
                do
                {
                  LODWORD(v47) = 0;
                  sub_4EEF8(
                    (char *)(v36 + *(_QWORD *)(a1 + 88)),
                    v37,
                    *(_DWORD *)((char *)a2 + 25) == 1,
                    *(_DWORD *)((char *)a2 + 17),
                    (int *)&v47);
                  if ( !(_DWORD)v47 )
                  {
                    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
                      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
                    {
                      sub_11430(
                        off_60148->Dpc.ProcessorHistory,
                        0x4Bu,
                        (__int64)&unk_5CD78,
                        *(unsigned __int8 *)(*(_QWORD *)(a1 + 88) + v36));
                    }
                    v6 = 1;
                  }
                  ++v36;
                  --v38;
                  v37 = (char *)a2 + 29;
                }
                while ( v38 );
              }
              return v6;
            case 2:
              for ( i = *a3; i <= v15; ++i )
              {
                LODWORD(v47) = 0;
                sub_4EEF8(
                  (char *)(*(_QWORD *)(a1 + 88) + i),
                  (_BYTE *)a2 + 29,
                  *(_DWORD *)((char *)a2 + 25) == 1,
                  *(_DWORD *)((char *)a2 + 17),
                  (int *)&v47);
                if ( (int)v47 > 0 )
                {
                  v31 = off_60148;
                  if ( off_60148 == (PDEVICE_OBJECT)&off_60148
                    || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
                    || BYTE1(off_60148->Dpc.DeferredContext) < 4u )
                  {
                    return 1;
                  }
                  v24 = *(unsigned __int8 *)(i + *(_QWORD *)(a1 + 88));
                  v25 = 79;
LABEL_67:
                  v26 = v31->Dpc.ProcessorHistory;
                  goto LABEL_46;
                }
              }
              return v6;
            case 3:
              for ( j = *a3; j <= v15; ++j )
              {
                LODWORD(v47) = 0;
                sub_4EEF8(
                  (char *)(*(_QWORD *)(a1 + 88) + j),
                  (_BYTE *)a2 + 29,
                  *(_DWORD *)((char *)a2 + 25) == 1,
                  *(_DWORD *)((char *)a2 + 17),
                  (int *)&v47);
                if ( (int)v47 < 0 )
                {
                  v31 = off_60148;
                  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
                    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
                  {
                    v24 = *(unsigned __int8 *)(j + *(_QWORD *)(a1 + 88));
                    v25 = 80;
                    goto LABEL_67;
                  }
                  return 1;
                }
              }
              return v6;
            case 4:
              v33 = *(unsigned __int8 **)(a1 + 88);
              if ( (v33[*a3] & *((_BYTE *)a2 + 29)) == 0 )
                return v6;
              if ( v16 == (PDEVICE_OBJECT)&off_60148
                || !_bittest((const signed __int32 *)&v16->Dpc.DeferredContext + 1, 0x14u)
                || BYTE1(v16->Dpc.DeferredContext) < 4u )
              {
                return 1;
              }
              v24 = *v33;
              v25 = 77;
              break;
            case 6:
              for ( k = *a3; k <= v15; ++k )
              {
                LODWORD(v47) = 0;
                sub_4EEF8(
                  (char *)(*(_QWORD *)(a1 + 88) + k),
                  (_BYTE *)a2 + 29,
                  *(_DWORD *)((char *)a2 + 25) == 1,
                  *(_DWORD *)((char *)a2 + 17),
                  (int *)&v47);
                if ( (int)v47 >= 0 )
                {
                  v31 = off_60148;
                  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
                    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
                  {
                    v24 = *(unsigned __int8 *)(k + *(_QWORD *)(a1 + 88));
                    v25 = 81;
                    goto LABEL_67;
                  }
                  return 1;
                }
              }
              return v6;
            case 7:
              for ( l = *a3; l <= v15; ++l )
              {
                LODWORD(v47) = 0;
                sub_4EEF8(
                  (char *)(*(_QWORD *)(a1 + 88) + l),
                  (_BYTE *)a2 + 29,
                  *(_DWORD *)((char *)a2 + 25) == 1,
                  *(_DWORD *)((char *)a2 + 17),
                  (int *)&v47);
                if ( (int)v47 <= 0 )
                {
                  v31 = off_60148;
                  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
                    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
                  {
                    v24 = *(unsigned __int8 *)(l + *(_QWORD *)(a1 + 88));
                    v25 = 82;
                    goto LABEL_67;
                  }
                  return 1;
                }
              }
              return v6;
            case 8:
              if ( *a3 <= v15 )
              {
                v27 = *a3;
                v28 = (char *)a2 + 29;
                v29 = v15 - *a3 + 1;
                do
                {
                  LODWORD(v47) = 0;
                  sub_4EEF8(
                    (char *)(v27 + *(_QWORD *)(a1 + 88)),
                    v28,
                    *(_DWORD *)((char *)a2 + 25) == 1,
                    *(_DWORD *)((char *)a2 + 17),
                    (int *)&v47);
                  if ( (_DWORD)v47 )
                  {
                    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
                      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
                    {
                      sub_11430(
                        off_60148->Dpc.ProcessorHistory,
                        0x4Cu,
                        (__int64)&unk_5CD78,
                        *(unsigned __int8 *)(*(_QWORD *)(a1 + 88) + v27));
                    }
                    v6 = 1;
                  }
                  ++v27;
                  --v29;
                  v28 = (char *)a2 + 29;
                }
                while ( v29 );
              }
              return v6;
            case 9:
              v23 = *(unsigned __int8 **)(a1 + 88);
              if ( (v23[*a3] & *((_BYTE *)a2 + 29)) != 0 )
                return v6;
              if ( v16 == (PDEVICE_OBJECT)&off_60148
                || !_bittest((const signed __int32 *)&v16->Dpc.DeferredContext + 1, 0x14u)
                || BYTE1(v16->Dpc.DeferredContext) < 4u )
              {
                return 1;
              }
              v24 = *v23;
              v25 = 78;
              break;
            default:
              return v6;
          }
          v26 = v16->Dpc.ProcessorHistory;
LABEL_46:
          sub_11430(v26, v25, (__int64)&unk_5CD78, v24);
          return 1;
        }
LABEL_114:
        *a3 = 0;
        return v6;
      }
      v39 = *a3;
      if ( *a3 > v15 )
        goto LABEL_114;
      v40 = (char *)a2 + 29;
      while ( strnicmp((const char *)(*(_QWORD *)(v46 + 88) + v39), v40, *(unsigned int *)((char *)a2 + 17)) )
      {
        ++v39;
        v40 = (char *)a2 + 29;
        if ( v39 > v15 )
          goto LABEL_114;
      }
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_31B40(off_60148->Dpc.ProcessorHistory, 74i64, (__int64)&unk_5CD78, *(_BYTE *)(v39 + *(_QWORD *)(v46 + 88)));
      }
    }
    v6 = 1;
    *a3 = v39 + *(_DWORD *)((char *)a2 + 17);
    return v6;
  }
  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    v10 = 69;
    v3 = *a3;
    goto LABEL_6;
  }
  return v6;
}
// 3398F: variable 'v20' is possibly undefined
// 3398F: variable 'v18' is possibly undefined
// 3398F: variable 'v19' is possibly undefined
// 3398F: variable 'v21' is possibly undefined

//----- (0000000000033FB0) ----------------------------------------------------
__int64 __fastcall sub_33FB0(__int64 a1, __int64 a2, __int64 a3)
{
  char *v3; // rbx
  unsigned int v7; // er13
  char v8; // si
  PDEVICE_OBJECT v9; // rcx
  __int64 v10; // rcx
  int v11; // eax
  int v12; // eax
  __int64 v13; // rcx
  PDEVICE_OBJECT v14; // rcx
  unsigned __int16 v15; // dx
  __int64 v16; // rcx
  __int64 v17; // rdi
  _DWORD *v18; // rsi
  __int64 v19; // r12
  unsigned __int64 v20; // rcx
  int v21; // er8
  void *v22; // rcx
  PVOID v23; // rdi
  int v24; // edi
  int v25; // er12
  int v26; // esi
  const char *v27; // rax
  __int64 v29; // [rsp+20h] [rbp-328h]
  KIRQL v30[8]; // [rsp+50h] [rbp-2F8h] BYREF
  union _LARGE_INTEGER v31; // [rsp+58h] [rbp-2F0h] BYREF
  int Src; // [rsp+60h] [rbp-2E8h] BYREF
  __int16 Dst[182]; // [rsp+64h] [rbp-2E4h] BYREF
  char v34[304]; // [rsp+1D0h] [rbp-178h] BYREF

  v3 = 0i64;
  v7 = 0;
  Src = 0;
  memset(Dst, 0, 0x15Eui64);
  v8 = 1;
  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x53u, (__int64)&unk_5CD78);
    v9 = off_60148;
  }
  if ( dword_65414 == 2 )
  {
    *(_DWORD *)(a3 + 4) = 3;
    v9 = off_60148;
  }
  if ( *(_DWORD *)(a3 + 4) == 2 )
  {
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v9->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(v9->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(v9->Dpc.ProcessorHistory, 0x54u, (__int64)&unk_5CD78);
      v9 = off_60148;
    }
    v8 = 0;
  }
  if ( *(_BYTE *)(*(_QWORD *)(a3 + 8) + 36i64) )
  {
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v9->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(v9->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(v9->Dpc.ProcessorHistory, 0x55u, (__int64)&unk_5CD78);
    }
    v8 = 0;
  }
  v10 = *(_QWORD *)(a3 + 8);
  Src = *(_DWORD *)(a3 + 4);
  Dst[0] = *(_WORD *)v10;
  *(_DWORD *)&Dst[1] = *(_DWORD *)(v10 + 2);
  sub_588AC(&Dst[3], 0xFFui64, (const void *)(v10 + *(unsigned int *)(v10 + 41)), *(unsigned int *)(v10 + 45));
  if ( v8 )
  {
    if ( *(_QWORD *)a1 )
    {
      v11 = sub_438AC(*(_QWORD *)a1, a2 + 20);
      if ( v11
        && off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x56u, (__int64)&unk_5CD78, v11);
      }
      v12 = sub_43964(*(_QWORD *)a1, a2 + 26);
      v7 = v12;
      if ( v12
        && off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x57u, (__int64)&unk_5CD78, v12);
      }
    }
    v13 = *(_QWORD *)(a1 + 16);
    if ( v13 )
    {
      if ( (unsigned int)sub_43FF0(v13, (_DWORD *)(a2 + 40)) )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x58u, (__int64)&unk_5CD78);
        }
      }
      else
      {
        *(_DWORD *)(a2 + 32) |= 2u;
      }
      v7 = sub_440A0(*(_QWORD *)(a1 + 16), (_DWORD *)(a2 + 56));
      if ( v7 )
      {
        v14 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          v15 = 89;
LABEL_55:
          sub_11008(v14->Dpc.ProcessorHistory, v15, (__int64)&unk_5CD78);
          goto LABEL_57;
        }
        goto LABEL_57;
      }
    }
    else
    {
      v16 = *(_QWORD *)(a1 + 24);
      if ( !v16 )
        goto LABEL_57;
      if ( (unsigned int)sub_4484C(v16, (__m128i *)(a2 + 40)) )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x5Au, (__int64)&unk_5CD78);
        }
      }
      else
      {
        *(_DWORD *)(a2 + 32) |= 2u;
      }
      v7 = sub_44900(*(_QWORD *)(a1 + 24), (__m128i *)(a2 + 56));
      if ( v7 )
      {
        v14 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          v15 = 91;
          goto LABEL_55;
        }
LABEL_57:
        sub_588AC(&Dst[133], 0x54ui64, (const void *)a2, 0x54ui64);
        if ( dword_65400 )
        {
          v17 = MEMORY[0xFFFFF78000000014];
          sub_401B8(&qword_621D8, v30);
          if ( dword_621E0 && (v18 = qword_621E8) != 0i64 )
          {
            v19 = 3i64 * (unsigned __int16)Dst[0];
            v20 = v17 - *((_QWORD *)qword_621E8 + 3 * (unsigned __int16)Dst[0]);
            ++*((_DWORD *)qword_621E8 + 2 * v19 + 2);
            v21 = v18[2 * v19 + 2];
            if ( v20 / 0x989680 < (unsigned int)dword_65400 )
            {
              if ( v21 == 1 )
              {
                HIDWORD(v29) = 0;
                v23 = sub_3F66C(2, 0x162u, 0x6970644Eu);
                memmove(v23, &Src, 0x162ui64);
                *(_QWORD *)&v18[2 * v19 + 4] = v23;
              }
              if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
                && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
              {
                sub_31E08(
                  off_60148->Dpc.ProcessorHistory,
                  0x5Cu,
                  (__int64)&unk_5CD78,
                  *((_DWORD *)qword_621E8 + 6 * (unsigned __int16)Dst[0] + 2),
                  (const char *)&Dst[3]);
              }
            }
            else
            {
              *(_QWORD *)&v18[2 * v19] = v17;
              *(_DWORD *)&Dst[131] = v21;
              sub_35FD4(&Src);
              v22 = *(void **)&v18[2 * v19 + 4];
              if ( v22 )
              {
                sub_3F6F0(v22, 0x6970644Eu);
                *(_QWORD *)&v18[2 * v19 + 4] = 0i64;
              }
              v18[2 * v19 + 2] = 0;
              *(_QWORD *)&v18[2 * v19] = v17;
            }
          }
          else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                 && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
                 && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
          {
            sub_11008(off_60148->Dpc.ProcessorHistory, 0x5Du, (__int64)&unk_5CD78);
          }
          sub_40230(&qword_621D8, v30[0]);
        }
        else
        {
          *(_DWORD *)&Dst[131] = 1;
          sub_35FD4(&Src);
        }
        goto LABEL_76;
      }
    }
    *(_DWORD *)(a2 + 32) |= 4u;
    goto LABEL_57;
  }
LABEL_76:
  if ( qword_61290 )
  {
    v31.QuadPart = 0i64;
    v24 = 0;
    if ( Src == 2 || (v25 = 1, Src == 1) )
      v25 = 2;
    v26 = 0;
    v31.QuadPart = MEMORY[0xFFFFF78000000014];
    if ( dword_65420 )
    {
      v27 = sub_4DA20(Src);
      LODWORD(v29) = *(_DWORD *)&Dst[1];
      sub_58888(
        v34,
        0x12Dui64,
        0x12Dui64,
        "|DPIF MATCH-RuleSid:%d-RuleMsg:%s-Action:%s|",
        v29,
        (const char *)&Dst[3],
        v27);
      v3 = v34;
      v24 = strlen(v34);
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_1182C(off_60148->Dpc.ProcessorHistory, 0x5Eu, (__int64)&unk_5CD78, v34);
    }
    if ( *(_DWORD *)(a2 + 16) == 2 )
      v26 = 16;
    if ( (*(_BYTE *)(a1 + 88) & 1) != 0 )
      v26 |= 1u;
    sub_18B70(*(const void **)a1, *(_DWORD *)(a1 + 72), v3, v24, v26, 1, v25, &v31, 1);
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x5Fu, (__int64)&unk_5CD78);
  }
  return v7;
}
// 34578: variable 'v29' is possibly undefined
// 61290: using guessed type __int64 qword_61290;
// 621E0: using guessed type int dword_621E0;
// 65400: using guessed type int dword_65400;
// 65414: using guessed type int dword_65414;
// 65420: using guessed type int dword_65420;

//----- (0000000000034694) ----------------------------------------------------
__int64 __fastcall sub_34694(__int64 a1)
{
  unsigned int v2; // ebx
  PDEVICE_OBJECT v3; // rcx
  __int64 v4; // rax
  unsigned __int16 v5; // dx
  unsigned int *v6; // rbp
  int v7; // er8
  int v8; // edx
  int v9; // eax
  unsigned int v10; // edi
  _DWORD *v11; // rsi
  __int64 v12; // rax
  unsigned int v13; // edi
  char *v14; // rsi
  int v15; // eax
  PDEVICE_OBJECT v16; // rcx
  unsigned __int16 v17; // dx
  _DWORD *v18; // rax
  void *v19; // rdi
  size_t MaxCount; // [rsp+30h] [rbp-48h] BYREF
  char Src[10]; // [rsp+38h] [rbp-40h] BYREF
  char v23; // [rsp+42h] [rbp-36h]

  v2 = 6;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x60u, (__int64)&unk_5CD78);
    v3 = off_60148;
  }
  v4 = *(_QWORD *)(a1 + 56);
  if ( !v4 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u) && BYTE1(v3->Dpc.DeferredContext) >= 2u )
      {
        v5 = 97;
LABEL_10:
        sub_11008(v3->Dpc.ProcessorHistory, v5, (__int64)&unk_5CD78);
LABEL_23:
        v3 = off_60148;
        goto LABEL_24;
      }
      goto LABEL_24;
    }
    goto LABEL_28;
  }
  v6 = (unsigned int *)(v4 + 4);
  if ( v4 == -4 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u) && BYTE1(v3->Dpc.DeferredContext) >= 2u )
      {
        v5 = v4 + 102;
        goto LABEL_10;
      }
LABEL_24:
      if ( v3 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v3->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(v3->Dpc.ProcessorHistory, 0x6Fu, (__int64)&unk_5CD78);
      }
    }
LABEL_28:
    v8 = 17;
LABEL_39:
    sub_4C35C(a1, v8, 0, 0i64);
    goto LABEL_92;
  }
  v7 = *(_DWORD *)(v4 + 20);
  if ( v7 == 4 )
  {
LABEL_56:
    *(_WORD *)Src = 4;
    *(_QWORD *)&Src[2] = 0i64;
    v23 = 0;
    if ( v7 == 6 )
    {
      if ( v3 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v3->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v3->Dpc.ProcessorHistory, 0x63u, (__int64)&unk_5CD78);
        v3 = off_60148;
      }
      v12 = v6[9];
      if ( (unsigned int *)((char *)v6 + v12) == (unsigned int *)-40i64 )
      {
        if ( v3 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(v3->Dpc.DeferredContext) >= 2u )
        {
          sub_11008(v3->Dpc.ProcessorHistory, 0x64u, (__int64)&unk_5CD78);
        }
        v8 = 4;
        goto LABEL_39;
      }
      v13 = *(unsigned int *)((char *)v6 + v12 + 40);
      v14 = (char *)v6 + v12 + 44;
    }
    else
    {
      if ( v3 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v3->Dpc.DeferredContext) >= 4u )
      {
        sub_11008(v3->Dpc.ProcessorHistory, 0x65u, (__int64)&unk_5CD78);
      }
      v13 = 10;
      v14 = Src;
      *(_DWORD *)&Src[6] = 10;
    }
    v15 = sub_365AC(v14, v13);
    v2 = v15;
    if ( v15 )
    {
      v16 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_79;
      }
      v17 = 102;
    }
    else
    {
      sub_351D4();
      v15 = sub_50CBC(*v6, 0x200A01Eu, (__int64)v14, v13);
      v2 = v15;
      if ( !v15 )
      {
        v18 = sub_3F66C(1, 8u, 0x6270644Eu);
        v19 = v18;
        if ( v18 )
        {
          v18[1] = 0;
          *v18 = 4;
          sub_4C35C(a1, 0, 8u, v18);
          sub_3F6F0(v19, 0x6270644Eu);
          goto LABEL_92;
        }
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x68u, (__int64)&unk_5CD78);
        }
        v8 = 3;
        goto LABEL_39;
      }
      v16 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
      {
        goto LABEL_79;
      }
      v17 = 103;
    }
    sub_112FC(v16->Dpc.ProcessorHistory, v17, (__int64)&unk_5CD78, v15);
LABEL_79:
    v8 = v2;
    goto LABEL_39;
  }
  if ( *(_DWORD *)(v4 + 20) != 5 )
  {
    if ( *(_DWORD *)(v4 + 20) != 6 )
    {
      if ( v3 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(v3->Dpc.DeferredContext) >= 4u )
        {
          sub_112FC(v3->Dpc.ProcessorHistory, 0x6Eu, (__int64)&unk_5CD78, v7);
          goto LABEL_23;
        }
        goto LABEL_24;
      }
      goto LABEL_28;
    }
    goto LABEL_56;
  }
  *(_QWORD *)Src = 0i64;
  LODWORD(MaxCount) = 0;
  if ( v3 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(v3->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(v3->Dpc.ProcessorHistory, 0x69u, (__int64)&unk_5CD78);
  }
  v9 = sub_34C44(Src, &MaxCount);
  v2 = v9;
  if ( v9 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x6Au, (__int64)&unk_5CD78, v9);
    }
    v8 = 0x80000000;
    goto LABEL_39;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_4DE38(off_60148->Dpc.ProcessorHistory, 0x6Bu, (__int64)&unk_5CD78, (unsigned __int16)**(_WORD **)Src);
  }
  v10 = MaxCount + 4;
  v11 = sub_3F66C(1, (int)MaxCount + 4, 0x6270644Eu);
  if ( v11 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x6Du, (__int64)&unk_5CD78, v10);
    }
    *v11 = MaxCount;
    memmove(v11 + 1, *(const void **)Src, (unsigned int)MaxCount);
    sub_4C35C(a1, 0, v10, v11);
    sub_3F6F0(v11, 0x7552504Eu);
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x6Cu, (__int64)&unk_5CD78, 0);
    }
    sub_4C35C(a1, 0x80000000, 0, 0i64);
    v2 = 3;
  }
  sub_34EF4((PVOID *)Src);
LABEL_92:
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x70u, (__int64)&unk_5CD78, v2);
  }
  return v2;
}

//----- (0000000000034C44) ----------------------------------------------------
__int64 __fastcall sub_34C44(_QWORD *a1, _DWORD *a2)
{
  unsigned int v4; // ebx
  char *v5; // rax
  size_t v6; // rbp
  PVOID v7; // rax
  PVOID v8; // r12

  v4 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x71u, (__int64)&unk_5CD78);
  }
  _InterlockedAdd(&dword_62194, 1u);
  if ( a1 && a2 )
  {
    *a1 = 0i64;
    *a2 = 0;
    if ( byte_61436 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x73u, (__int64)&unk_5CD78);
      }
      v4 = 19;
    }
    else
    {
      v5 = (char *)qword_621D0;
      if ( qword_621D0 )
      {
        if ( *(_DWORD *)((char *)qword_621D0 + 6) )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
          {
            sub_11008(off_60148->Dpc.ProcessorHistory, 0x76u, (__int64)&unk_5CD78);
            v5 = (char *)qword_621D0;
          }
          v6 = *(unsigned int *)(v5 + 6);
          v7 = sub_3F66C(2, *(_DWORD *)(v5 + 6), 0x6270644Eu);
          v8 = v7;
          if ( v7 )
          {
            sub_588AC(v7, v6, qword_621D0, v6);
            *a1 = v8;
            *a2 = v6;
          }
          else
          {
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
              && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
            {
              sub_11008(off_60148->Dpc.ProcessorHistory, 0x77u, (__int64)&unk_5CD78);
            }
            v4 = 3;
          }
        }
        else
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
          {
            sub_11008(off_60148->Dpc.ProcessorHistory, 0x75u, (__int64)&unk_5CD78);
          }
          v4 = 5;
        }
      }
      else
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x74u, (__int64)&unk_5CD78);
        }
        v4 = 6;
      }
    }
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_1D3B0(off_60148->Dpc.ProcessorHistory, 0x72u, (__int64)&unk_5CD78, a1, a2);
    }
    v4 = 4;
  }
  _InterlockedAdd(&dword_62194, 0xFFFFFFFF);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x78u, (__int64)&unk_5CD78);
  }
  return v4;
}
// 61436: using guessed type char byte_61436;
// 62194: using guessed type int dword_62194;

//----- (0000000000034EF4) ----------------------------------------------------
__int64 __fastcall sub_34EF4(PVOID *a1)
{
  unsigned int v2; // ebx
  PDEVICE_OBJECT v3; // rcx

  v2 = 0;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x79u, (__int64)&unk_5CD78);
    v3 = off_60148;
  }
  if ( a1 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(v3->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(v3->Dpc.ProcessorHistory, 0x7Bu, (__int64)&unk_5CD78);
    }
    sub_3F6F0(*a1, 0x6270644Eu);
    *a1 = 0i64;
    v3 = off_60148;
  }
  else
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(v3->Dpc.DeferredContext) >= 2u )
    {
      sub_2F80C(v3->Dpc.ProcessorHistory, 0x7Au, (__int64)&unk_5CD78, 0i64);
      v3 = off_60148;
    }
    v2 = 4;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(v3->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v3->Dpc.ProcessorHistory, 0x7Cu, (__int64)&unk_5CD78);
  }
  return v2;
}

//----- (000000000003502C) ----------------------------------------------------
__int64 sub_3502C()
{
  int v0; // eax
  unsigned int v1; // ebx
  PDEVICE_OBJECT v2; // rcx
  int v3; // eax
  unsigned int v5; // [rsp+30h] [rbp+8h] BYREF
  _WORD *v6; // [rsp+38h] [rbp+10h] BYREF

  v6 = 0i64;
  v5 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x7Du, (__int64)&unk_5CD78);
  }
  v0 = sub_507A8(0i64, 0x200A01Eu, &v6, &v5);
  v1 = v0;
  if ( !v0 )
  {
    v3 = sub_365AC(v6, v5);
    v1 = v3;
    if ( v3
      && off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x7Fu, (__int64)&unk_5CD78, v3);
    }
    sub_351D4();
    goto LABEL_16;
  }
  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x7Eu, (__int64)&unk_5CD78, v0);
LABEL_16:
    v2 = off_60148;
  }
  if ( v6 )
  {
    if ( !(unsigned int)sub_50A80((__int64)v6) )
    {
LABEL_23:
      v2 = off_60148;
      goto LABEL_24;
    }
    v2 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
      return v1;
    if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x80u, (__int64)&unk_5CD78);
      goto LABEL_23;
    }
  }
LABEL_24:
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(v2->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(v2->Dpc.ProcessorHistory, 0x81u, (__int64)&unk_5CD78, v1);
  }
  return v1;
}

//----- (00000000000351D4) ----------------------------------------------------
void sub_351D4()
{
  unsigned __int16 *v0; // r13
  PDEVICE_OBJECT v1; // rcx
  unsigned __int16 v2; // dx
  PDEVICE_OBJECT v3; // rdi
  unsigned int v4; // er15
  unsigned __int16 *i; // rsi
  const char *v6; // r14
  __int16 v7; // bx
  const char *v8; // rax
  char v9; // r8
  char v10; // r10
  char v11; // r11
  int v12; // ecx
  int v13; // ecx
  int v14; // ecx
  int v15; // ecx
  int v16; // ecx
  int v17; // ecx
  int v18; // ecx
  int v19; // ecx
  const char *v20; // r9
  const char *v21; // rax
  unsigned int v22; // er14
  _DWORD *j; // rbx
  const char *v24; // rax
  const char *v25; // r8
  const char *v26; // r9
  char v27; // [rsp+50h] [rbp-138h] BYREF
  char Dst[255]; // [rsp+51h] [rbp-137h] BYREF

  v0 = (unsigned __int16 *)qword_621D0;
  _InterlockedAdd(&dword_62194, 1u);
  if ( qword_621D0 )
  {
    if ( byte_61436 )
    {
      v1 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 3u )
      {
        v2 = 131;
        goto LABEL_6;
      }
    }
    else
    {
      v3 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x84u, (__int64)&unk_5CD78, qword_621D0);
          v3 = off_60148;
        }
        if ( v3 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(v3->Dpc.DeferredContext) >= 5u )
        {
          sub_4DE38(v3->Dpc.ProcessorHistory, 0x85u, (__int64)&unk_5CD78, *v0);
          v3 = off_60148;
        }
      }
      v4 = 0;
      for ( i = v0 + 5; v4 < *(_DWORD *)(v0 + 1); i = (unsigned __int16 *)((char *)i + *(unsigned int *)((char *)i + 37)) )
      {
        v27 = 0;
        memset(Dst, 0, sizeof(Dst));
        sub_588AC(&v27, 0xFFui64, (char *)i + *(unsigned int *)((char *)i + 41), *(unsigned int *)((char *)i + 45));
        v3 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
          {
            sub_112FC(off_60148->Dpc.ProcessorHistory, 0x86u, (__int64)&unk_5CD78, v4);
            v3 = off_60148;
          }
          if ( v3 != (PDEVICE_OBJECT)&off_60148 )
          {
            if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
              && BYTE1(v3->Dpc.DeferredContext) >= 5u )
            {
              sub_1182C(v3->Dpc.ProcessorHistory, 0x87u, (__int64)&unk_5CD78, &v27);
              v3 = off_60148;
            }
            if ( v3 != (PDEVICE_OBJECT)&off_60148 )
            {
              if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
                && BYTE1(v3->Dpc.DeferredContext) >= 5u )
              {
                if ( *(_DWORD *)(i + 5) == 1 )
                {
                  v6 = "TO_DESTINATION";
                }
                else if ( *(_DWORD *)(i + 5) == 2 )
                {
                  v6 = "BIDIRECTIONAL";
                }
                else
                {
                  v6 = "UNKNOWN";
                }
                v7 = *(unsigned __int16 *)((char *)i + 19);
                v8 = sub_4DA20(*(_DWORD *)(i + 3));
                sub_31E88(v3->Dpc.ProcessorHistory, 136i64, (__int64)&unk_5CD78, *i, v8, v7, v11, v10, v9, v6);
                v3 = off_60148;
              }
              if ( v3 != (PDEVICE_OBJECT)&off_60148 )
              {
                if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
                  && BYTE1(v3->Dpc.DeferredContext) >= 5u )
                {
                  sub_112FC(v3->Dpc.ProcessorHistory, 0x89u, (__int64)&unk_5CD78, *(_DWORD *)(i + 1));
                  v3 = off_60148;
                }
                if ( v3 != (PDEVICE_OBJECT)&off_60148
                  && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
                  && BYTE1(v3->Dpc.DeferredContext) >= 5u )
                {
                  v12 = *((_DWORD *)i + 7);
                  if ( v12 )
                  {
                    v13 = v12 - 1;
                    if ( v13 )
                    {
                      v14 = v13 - 1;
                      if ( v14 )
                      {
                        v15 = v14 - 1;
                        if ( v15 )
                        {
                          v16 = v15 - 1;
                          if ( v16 )
                          {
                            v17 = v16 - 1;
                            if ( v17 )
                            {
                              v18 = v17 - 1;
                              if ( v18 )
                              {
                                v19 = v18 - 1;
                                if ( v19 )
                                {
                                  if ( v19 == 1 )
                                    v20 = "RESET";
                                  else
                                    v20 = "ERROR_UNKNOWN";
                                }
                                else
                                {
                                  v20 = "NOALERT";
                                }
                              }
                              else
                              {
                                v20 = "ISNOTSET";
                              }
                            }
                            else
                            {
                              v20 = "ISSET";
                            }
                          }
                          else
                          {
                            v20 = "TOGGLE";
                          }
                        }
                        else
                        {
                          v20 = "UNSET";
                        }
                      }
                      else
                      {
                        v20 = "SETX";
                      }
                    }
                    else
                    {
                      v20 = "SET";
                    }
                  }
                  else
                  {
                    v20 = "NONE";
                  }
                  v21 = "FALSE";
                  if ( *((_BYTE *)i + 36) )
                    v21 = "TRUE";
                  sub_321A4(v3->Dpc.ProcessorHistory, 138i64, (__int64)&unk_5CD78, v20, *((_DWORD *)i + 8), v21);
                  v3 = off_60148;
                }
              }
            }
          }
        }
        v22 = 0;
        for ( j = (_DWORD *)((char *)i + 53);
              v22 < *(_DWORD *)((char *)i + 49);
              j = (_DWORD *)((char *)j + *(unsigned int *)((char *)j + 17) + 29) )
        {
          if ( v3 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
            && BYTE1(v3->Dpc.DeferredContext) >= 5u )
          {
            v24 = sub_4DD74(*(_DWORD *)((char *)j + 13));
            sub_31FA4(
              v3->Dpc.ProcessorHistory,
              139i64,
              (__int64)&unk_5CD78,
              v22,
              v24,
              *(_DWORD *)((char *)j + 17),
              v26,
              j[1],
              j[2],
              v25);
            v3 = off_60148;
          }
          ++v22;
        }
        ++v4;
      }
      if ( v3 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v3->Dpc.DeferredContext) >= 5u )
      {
        sub_2F80C(v3->Dpc.ProcessorHistory, 0x8Cu, (__int64)&unk_5CD78, v0);
      }
    }
  }
  else
  {
    v1 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      v2 = 130;
LABEL_6:
      sub_11008(v1->Dpc.ProcessorHistory, v2, (__int64)&unk_5CD78);
      goto LABEL_78;
    }
  }
LABEL_78:
  _InterlockedAdd(&dword_62194, 0xFFFFFFFF);
}
// 3548D: variable 'v11' is possibly undefined
// 3548D: variable 'v10' is possibly undefined
// 3548D: variable 'v9' is possibly undefined
// 35685: variable 'v26' is possibly undefined
// 35685: variable 'v25' is possibly undefined
// 61436: using guessed type char byte_61436;
// 62194: using guessed type int dword_62194;

//----- (0000000000035728) ----------------------------------------------------
__int64 __fastcall sub_35728(__int64 a1)
{
  __int64 result; // rax
  PDEVICE_OBJECT v3; // r14
  const char *v4; // rax
  const char *v5; // r9
  const char *v6; // rax
  int v7; // eax
  const char *v8; // rax
  const char *v9; // rsi
  const char *v10; // rax

  if ( !a1 )
  {
    result = (__int64)&off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      result = sub_11008(off_60148->Dpc.ProcessorHistory, 0x8Du, (__int64)&unk_5CD78);
    }
    return result;
  }
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x8Eu, (__int64)&unk_5CD78);
      v3 = off_60148;
    }
    if ( v3 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u) && BYTE1(v3->Dpc.DeferredContext) >= 4u )
      {
        sub_1182C(v3->Dpc.ProcessorHistory, 0x8Fu, (__int64)&unk_5CD78, (const char *)(a1 + 10));
        v3 = off_60148;
      }
      if ( v3 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(v3->Dpc.DeferredContext) >= 4u )
        {
          sub_112FC(v3->Dpc.ProcessorHistory, 0x90u, (__int64)&unk_5CD78, *(_DWORD *)(a1 + 6));
          v3 = off_60148;
        }
        if ( v3 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
            && BYTE1(v3->Dpc.DeferredContext) >= 4u )
          {
            v4 = sub_4DA20(*(_DWORD *)a1);
            sub_1182C(v3->Dpc.ProcessorHistory, 0x91u, (__int64)&unk_5CD78, v4);
            v3 = off_60148;
          }
          if ( v3 != (PDEVICE_OBJECT)&off_60148 )
          {
            if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
              && BYTE1(v3->Dpc.DeferredContext) >= 4u )
            {
              if ( *(_DWORD *)(a1 + 286) == 1 )
              {
                v5 = "INCOMING";
              }
              else if ( *(_DWORD *)(a1 + 286) == 2 )
              {
                v5 = "OUTGOING";
              }
              else
              {
                v5 = "UNKNOWN";
              }
              sub_1182C(v3->Dpc.ProcessorHistory, 0x92u, (__int64)&unk_5CD78, v5);
              v3 = off_60148;
            }
            if ( v3 != (PDEVICE_OBJECT)&off_60148 )
            {
              if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
                && BYTE1(v3->Dpc.DeferredContext) >= 5u )
              {
                sub_1102C(v3->Dpc.ProcessorHistory, 0x93u, (__int64)&unk_5CD78, *(unsigned __int8 *)(a1 + 296));
                v3 = off_60148;
              }
              if ( v3 != (PDEVICE_OBJECT)&off_60148 )
              {
                if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
                  && BYTE1(v3->Dpc.DeferredContext) >= 5u )
                {
                  sub_1102C(v3->Dpc.ProcessorHistory, 0x94u, (__int64)&unk_5CD78, *(unsigned __int8 *)(a1 + 290));
                  v3 = off_60148;
                }
                if ( v3 != (PDEVICE_OBJECT)&off_60148
                  && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
                  && BYTE1(v3->Dpc.DeferredContext) >= 4u )
                {
                  if ( (*(_BYTE *)(a1 + 302) & 1) != 0 )
                  {
                    v6 = sub_4D99C(*(_DWORD *)(a1 + 306));
                    v3 = off_60148;
                  }
                  else
                  {
                    v6 = (const char *)qword_5AA80;
                  }
                  sub_1182C(v3->Dpc.ProcessorHistory, 0x95u, (__int64)&unk_5CD78, v6);
                  v3 = off_60148;
                }
              }
            }
          }
        }
      }
    }
  }
  v7 = *(_DWORD *)(a1 + 302);
  if ( (v7 & 4) != 0 || (v7 & 2) != 0 )
  {
    if ( *(_DWORD *)(a1 + 306) == 2048 )
    {
      if ( v3 == (PDEVICE_OBJECT)&off_60148 )
        goto LABEL_73;
      if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u) && BYTE1(v3->Dpc.DeferredContext) >= 4u )
      {
        sub_114E4(v3->Dpc.ProcessorHistory, 0x96u, (__int64)&unk_5CD78, *(unsigned __int8 *)(a1 + 326));
        v3 = off_60148;
      }
      if ( v3 == (PDEVICE_OBJECT)&off_60148 )
        goto LABEL_73;
      if ( !_bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u) || BYTE1(v3->Dpc.DeferredContext) < 4u )
        goto LABEL_66;
      sub_114E4(v3->Dpc.ProcessorHistory, 0x97u, (__int64)&unk_5CD78, *(unsigned __int8 *)(a1 + 310));
      goto LABEL_65;
    }
    if ( v3 == (PDEVICE_OBJECT)&off_60148 )
      goto LABEL_73;
    if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u) && BYTE1(v3->Dpc.DeferredContext) >= 4u )
    {
      sub_110AC(
        v3->Dpc.ProcessorHistory,
        0x98u,
        (__int64)&unk_5CD78,
        (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 326)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 326) << 8));
      v3 = off_60148;
    }
    if ( v3 == (PDEVICE_OBJECT)&off_60148 )
      goto LABEL_73;
    if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u) && BYTE1(v3->Dpc.DeferredContext) >= 4u )
    {
      sub_110AC(
        v3->Dpc.ProcessorHistory,
        0x99u,
        (__int64)&unk_5CD78,
        (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 310)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 310) << 8));
LABEL_65:
      v3 = off_60148;
      goto LABEL_66;
    }
  }
LABEL_66:
  if ( v3 == (PDEVICE_OBJECT)&off_60148
    || !_bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
    || BYTE1(v3->Dpc.DeferredContext) < 4u )
  {
LABEL_73:
    v9 = (const char *)qword_5AA80;
    goto LABEL_74;
  }
  if ( (*(_BYTE *)(a1 + 302) & 8) != 0 )
  {
    v8 = sub_4D84C(*(_DWORD *)(a1 + 342));
    v3 = off_60148;
    v9 = (const char *)qword_5AA80;
  }
  else
  {
    v9 = (const char *)qword_5AA80;
    v8 = (const char *)qword_5AA80;
  }
  sub_1182C(v3->Dpc.ProcessorHistory, 0x9Au, (__int64)&unk_5CD78, v8);
  v3 = off_60148;
LABEL_74:
  result = *(unsigned int *)(a1 + 302);
  if ( (result & 0x20) == 0 && (result & 0x10) == 0 )
  {
LABEL_84:
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(v3->Dpc.DeferredContext) >= 4u )
    {
      if ( (*(_BYTE *)(a1 + 302) & 0x40) != 0 )
      {
        v10 = sub_4D8C4(*(_DWORD *)(a1 + 350));
        v3 = off_60148;
        v9 = v10;
      }
      result = sub_1182C(v3->Dpc.ProcessorHistory, 0x9Du, (__int64)&unk_5CD78, v9);
    }
    return result;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u) && BYTE1(v3->Dpc.DeferredContext) >= 4u )
    {
      result = sub_112FC(v3->Dpc.ProcessorHistory, 0x9Bu, (__int64)&unk_5CD78, *(unsigned __int16 *)(a1 + 348));
      v3 = off_60148;
    }
    if ( v3 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u) && BYTE1(v3->Dpc.DeferredContext) >= 4u )
      {
        result = sub_112FC(v3->Dpc.ProcessorHistory, 0x9Cu, (__int64)&unk_5CD78, *(unsigned __int16 *)(a1 + 346));
        v3 = off_60148;
      }
      goto LABEL_84;
    }
  }
  return result;
}
// 5AA80: using guessed type __int64 qword_5AA80[2];

//----- (0000000000035FD4) ----------------------------------------------------
__int64 __fastcall sub_35FD4(const void *a1)
{
  unsigned int v1; // ebx
  PDEVICE_OBJECT v3; // rcx
  __int64 result; // rax
  PVOID v5; // rax
  PVOID v6; // rdi
  _QWORD *v7; // rax
  PDEVICE_OBJECT v8; // rcx
  __int64 v9; // [rsp+40h] [rbp-38h]
  __int64 v10; // [rsp+50h] [rbp-28h]

  v1 = 0;
  HIDWORD(v10) = 0;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x9Eu, (__int64)&unk_5CD78);
    v3 = off_60148;
  }
  if ( qword_61280 )
  {
    sub_35728((__int64)a1);
    v5 = sub_3F66C(2, 0x162u, 0x6970644Eu);
    v6 = v5;
    if ( v5 )
    {
      sub_588AC(v5, 0x162ui64, a1, 0x162ui64);
      LODWORD(v9) = 0;
      LODWORD(v10) = 354;
      v7 = sub_40964((__int64)qword_61280, 24, (__int64)sub_1A670, 0i64);
      if ( v7 )
      {
        *v7 = v9;
        v7[1] = v6;
        v7[2] = v10;
        sub_40AF4((__int64)v7);
        v8 = off_60148;
      }
      else
      {
        v8 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0xA1u, (__int64)&unk_5CD78);
          v8 = off_60148;
        }
        v1 = 3;
      }
      if ( v8 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v8->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v8->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v8->Dpc.ProcessorHistory, 0xA2u, (__int64)&unk_5CD78);
      }
      result = v1;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xA0u, (__int64)&unk_5CD78);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(v3->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(v3->Dpc.ProcessorHistory, 0x9Fu, (__int64)&unk_5CD78);
    }
    result = 15i64;
  }
  return result;
}
// 36154: variable 'v9' is possibly undefined

//----- (0000000000036204) ----------------------------------------------------
__int64 __fastcall sub_36204(PVOID P, unsigned int a2)
{
  int v4; // eax
  unsigned int v5; // ebx
  PDEVICE_OBJECT v6; // rcx

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xA3u, (__int64)&unk_5CD78);
  }
  v4 = sub_4D1A4(40014, P, a2);
  v5 = v4;
  if ( v4 )
  {
    v6 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0xA4u, (__int64)&unk_5CD78, v4);
LABEL_14:
      v6 = off_60148;
      goto LABEL_15;
    }
  }
  else
  {
    v6 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xA5u, (__int64)&unk_5CD78);
      goto LABEL_14;
    }
  }
LABEL_15:
  if ( P )
  {
    sub_3F6F0(P, 0x6970644Eu);
    v6 = off_60148;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(v6->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(v6->Dpc.ProcessorHistory, 0xA6u, (__int64)&unk_5CD78, v5);
  }
  return v5;
}

//----- (0000000000036358) ----------------------------------------------------
__int64 __fastcall sub_36358(unsigned int a1)
{
  __int64 v1; // rsi
  unsigned int v2; // ebp
  unsigned int v3; // er8
  unsigned int v4; // edi
  __int64 v5; // rbx
  void *v6; // rcx
  PVOID v7; // rcx
  KIRQL v9; // [rsp+50h] [rbp+8h] BYREF

  v1 = a1;
  v2 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xA9u, (__int64)&unk_5CD78);
  }
  sub_401B8(&qword_621D8, &v9);
  v3 = dword_621E0;
  if ( dword_621E0 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0xAAu, (__int64)&unk_5CD78, dword_621E0);
      v3 = dword_621E0;
    }
    v4 = 0;
    if ( v3 )
    {
      v5 = 0i64;
      do
      {
        v6 = *(void **)((char *)qword_621E8 + v5 + 16);
        if ( v6 )
        {
          sub_3F6F0(v6, 0x6E70644Eu);
          v3 = dword_621E0;
        }
        ++v4;
        v5 += 24i64;
      }
      while ( v4 < v3 );
    }
    sub_3F6F0(qword_621E8, 0x6E70644Eu);
    dword_621E0 = 0;
  }
  if ( (_DWORD)v1 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0xABu, (__int64)&unk_5CD78, v1);
    }
    v7 = sub_3F66C(2, 24 * (int)v1, 0x6E70644Eu);
    qword_621E8 = v7;
    if ( v7 )
    {
      memset(v7, 0, 24 * v1);
      dword_621E0 = v1;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xACu, (__int64)&unk_5CD78);
      }
      v2 = 3;
    }
  }
  sub_40230(&qword_621D8, v9);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xADu, (__int64)&unk_5CD78);
  }
  return v2;
}
// 621E0: using guessed type int dword_621E0;

//----- (00000000000365AC) ----------------------------------------------------
__int64 __fastcall sub_365AC(_WORD *a1, unsigned int a2)
{
  size_t v2; // rdi
  unsigned int v4; // esi
  PDEVICE_OBJECT v5; // rcx
  PVOID v6; // r12
  unsigned __int16 *v7; // rax
  unsigned __int16 *v8; // rbp
  PDEVICE_OBJECT v9; // rcx
  PDEVICE_OBJECT v10; // rcx
  __int64 v12; // [rsp+20h] [rbp-48h]
  int v13; // [rsp+28h] [rbp-40h]
  union _LARGE_INTEGER Interval; // [rsp+70h] [rbp+8h] BYREF

  v2 = a2;
  v4 = 0;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xAEu, (__int64)&unk_5CD78);
    v5 = off_60148;
  }
  v6 = qword_621D0;
  byte_61436 = 1;
  if ( *a1 == *(_WORD *)qword_621D0 )
  {
    v13 = 0;
    v12 = 0i64;
    v7 = (unsigned __int16 *)sub_3F66C(2, v2, 0x7270644Eu);
    v8 = v7;
    if ( v7 )
    {
      sub_588AC(v7, v2, a1, v2);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        v13 = *(_DWORD *)(v8 + 3);
        LODWORD(v12) = *(_DWORD *)(v8 + 1);
        sub_114E4(off_60148->Dpc.ProcessorHistory, 0xB1u, (__int64)&unk_5CD78, *v8);
      }
      while ( _InterlockedCompareExchange(&dword_62194, 0, 0) > 0 )
      {
        v9 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0xB2u, (__int64)&unk_5CD78);
          v9 = off_60148;
        }
        Interval.QuadPart = -5000000i64;
        if ( v9 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v9->Dpc.DeferredContext + 1, 0x14u)
          && BYTE1(v9->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(v9->Dpc.ProcessorHistory, 0xB3u, (__int64)&unk_5CD78);
        }
        KeDelayExecutionThread(0, 0, &Interval);
      }
      v10 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_1D3B0(off_60148->Dpc.ProcessorHistory, 0xB4u, (__int64)&unk_5CD78, qword_621D0, v8, v13);
        v10 = off_60148;
      }
      qword_621D0 = v8;
      if ( v10 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v10->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(v10->Dpc.DeferredContext) >= 4u )
      {
        sub_2F80C(v10->Dpc.ProcessorHistory, 0xB5u, (__int64)&unk_5CD78, v6, v12);
      }
      sub_3F6F0(v6, 0x7270644Eu);
      sub_36358(*(_DWORD *)(v8 + 1));
      v5 = off_60148;
    }
    else
    {
      v5 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0xB0u, (__int64)&unk_5CD78);
        v5 = off_60148;
      }
      v4 = 3;
    }
  }
  else
  {
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(v5->Dpc.DeferredContext) >= 2u )
    {
      sub_11430(v5->Dpc.ProcessorHistory, 0xAFu, (__int64)&unk_5CD78, *(unsigned __int16 *)qword_621D0);
      v5 = off_60148;
    }
    v4 = 25;
  }
  byte_61436 = 0;
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(v5->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v5->Dpc.ProcessorHistory, 0xB6u, (__int64)&unk_5CD78);
  }
  return v4;
}
// 36856: variable 'v12' is possibly undefined
// 61436: using guessed type char byte_61436;
// 62194: using guessed type int dword_62194;

//----- (00000000000368DC) ----------------------------------------------------
__int64 __fastcall sub_368DC(__int64 a1)
{
  unsigned int v1; // edx
  __int64 v2; // r11
  __int64 v3; // r8
  int v4; // er10
  __int64 v5; // rbx
  unsigned __int8 *v6; // r9
  int v7; // eax
  int v8; // er9
  unsigned __int8 *v9; // r10
  int v10; // eax
  int v11; // er8
  __int64 v12; // r10
  unsigned __int8 *v13; // r9
  int v14; // eax
  unsigned __int8 *v15; // rcx
  int v16; // eax
  unsigned __int8 *v17; // r9
  int v18; // eax
  int v19; // er9
  unsigned __int8 *v20; // r10
  int v21; // eax
  int v22; // er8
  __int64 v23; // r10
  unsigned __int8 *v24; // r9
  int v25; // eax
  unsigned __int8 *v26; // rax
  int v27; // ecx

  v1 = 0;
  v2 = 16i64;
  if ( (*(_BYTE *)(a1 + 32) & 0x10) != 0 && (*(_BYTE *)(a1 + 32) & 0x20) != 0 )
  {
    v3 = 2i64;
    v4 = 0;
    v5 = 2i64;
    if ( *(_DWORD *)(a1 + 16) == 2 )
    {
      v6 = (unsigned __int8 *)(a1 + 76);
      do
      {
        v7 = *v6++;
        v4 = v7 ^ (-2128831035 * v4);
        --v5;
      }
      while ( v5 );
      v8 = 0;
      if ( v4 )
        v8 = v4;
      v9 = (unsigned __int8 *)(a1 + 78);
      do
      {
        v10 = *v9++;
        v8 = v10 ^ (-2128831035 * v8);
        --v3;
      }
      while ( v3 );
      v11 = 0;
      v12 = 16i64;
      if ( v8 )
        v11 = v8;
      v13 = (unsigned __int8 *)(a1 + 40);
      do
      {
        v14 = *v13++;
        v11 = v14 ^ (-2128831035 * v11);
        --v12;
      }
      while ( v12 );
      if ( v11 )
        v1 = v11;
      v15 = (unsigned __int8 *)(a1 + 56);
      do
      {
        v16 = *v15++;
        v1 = v16 ^ (-2128831035 * v1);
        --v2;
      }
      while ( v2 );
    }
    else
    {
      v17 = (unsigned __int8 *)(a1 + 78);
      do
      {
        v18 = *v17++;
        v4 = v18 ^ (-2128831035 * v4);
        --v5;
      }
      while ( v5 );
      v19 = 0;
      if ( v4 )
        v19 = v4;
      v20 = (unsigned __int8 *)(a1 + 76);
      do
      {
        v21 = *v20++;
        v19 = v21 ^ (-2128831035 * v19);
        --v3;
      }
      while ( v3 );
      v22 = 0;
      v23 = 16i64;
      if ( v19 )
        v22 = v19;
      v24 = (unsigned __int8 *)(a1 + 56);
      do
      {
        v25 = *v24++;
        v22 = v25 ^ (-2128831035 * v22);
        --v23;
      }
      while ( v23 );
      v26 = (unsigned __int8 *)(a1 + 40);
      if ( v22 )
        v1 = v22;
      do
      {
        v27 = *v26++;
        v1 = v27 ^ (-2128831035 * v1);
        --v2;
      }
      while ( v2 );
    }
  }
  return v1;
}

//----- (0000000000036A30) ----------------------------------------------------
__int64 __fastcall sub_36A30(PVOID P)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xB7u, (__int64)&unk_5CD78);
    v2 = off_60148;
  }
  if ( P )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(v2->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(v2->Dpc.ProcessorHistory, 0xB8u, (__int64)&unk_5CD78, *(_QWORD *)P);
    }
    sub_3F6F0(P, 0x6570644Eu);
    v2 = off_60148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x14u)
    && BYTE1(v2->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v2->Dpc.ProcessorHistory, 0xB9u, (__int64)&unk_5CD78);
  }
  return 0i64;
}

//----- (0000000000036B1C) ----------------------------------------------------
__int64 sub_36B1C()
{
  unsigned int v0; // ebx
  int v1; // eax
  int v2; // edi
  PDEVICE_OBJECT v3; // rcx

  v0 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0xAu, (__int64)&unk_5CD68);
  }
  sub_42594();
  sub_42594();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x1Eu, (__int64)&unk_5CD38);
  }
  v1 = sub_3A628();
  v2 = v1;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_112FC((__int64)off_60148[1].DriverObject, 0x1Fu, (__int64)&unk_5CD38, v1);
    v3 = off_60148;
  }
  if ( v2 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v3[1].AttachedDevice) & 1) != 0 && BYTE1(v3[1].AttachedDevice) >= 2u )
    {
      sub_112FC((__int64)v3[1].DriverObject, 0xBu, (__int64)&unk_5CD68, v2);
      v3 = off_60148;
    }
    v0 = (unsigned __int16)v2 | 0xE0020000;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v3[1].AttachedDevice) & 1) != 0 && BYTE1(v3[1].AttachedDevice) >= 5u )
    sub_112FC((__int64)v3[1].DriverObject, 0xCu, (__int64)&unk_5CD68, v0);
  return v0;
}

//----- (0000000000036C8C) ----------------------------------------------------
__int64 sub_36C8C(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+A8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CD58, 41i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000036D10) ----------------------------------------------------
__int64 sub_36D10(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CD58, 14i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000036D70) ----------------------------------------------------
__int64 sub_36D70(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+A8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CD58, 32i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000036DF4) ----------------------------------------------------
__int64 sub_36DF4(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+A8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CD58, 25i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000036E78) ----------------------------------------------------
__int64 __fastcall sub_36E78(__int64 a1, _QWORD *a2, _BYTE *a3)
{
  unsigned int v6; // ebx
  PDEVICE_OBJECT v7; // rcx
  unsigned int v8; // eax
  int v9; // er9
  __int64 v10; // rbx
  unsigned int v11; // eax
  _BYTE *v12; // rbx
  unsigned __int8 v13; // r11
  unsigned int v14; // eax
  unsigned __int16 v15; // dx
  unsigned int v16; // eax
  char *v17; // rax
  unsigned __int16 v19; // [rsp+40h] [rbp-58h] BYREF
  __m128i v20; // [rsp+48h] [rbp-50h] BYREF
  __m128i v21; // [rsp+58h] [rbp-40h] BYREF
  unsigned __int8 v22; // [rsp+A0h] [rbp+8h] BYREF
  unsigned __int8 v23; // [rsp+B8h] [rbp+20h] BYREF

  *(__int64 *)((char *)v21.m128i_i64 + 1) = 0i64;
  *(__int64 *)((char *)v20.m128i_i64 + 1) = 0i64;
  v21.m128i_i8[0] = 0;
  v20.m128i_i8[0] = 0;
  *(__int32 *)((char *)&v21.m128i_i32[2] + 1) = 0;
  *(__int16 *)((char *)&v21.m128i_i16[6] + 1) = 0;
  v21.m128i_i8[15] = 0;
  *(__int32 *)((char *)&v20.m128i_i32[2] + 1) = 0;
  *(__int16 *)((char *)&v20.m128i_i16[6] + 1) = 0;
  v20.m128i_i8[15] = 0;
  v6 = 5;
  v22 = 0;
  v19 = 0;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_36D10((__int64)off_60148[1].DriverObject, 14i64, (__int64)&unk_5CD58, a1, *(_QWORD *)a1, a2);
    v7 = off_60148;
  }
  v8 = dword_622E4;
  if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
  {
    if ( (unsigned int)dword_622E4 > 6 )
    {
      _InterlockedAdd((volatile signed __int32 *)P + 6, 1u);
      goto LABEL_10;
    }
  }
  else if ( (unsigned int)dword_622E4 > 5 )
  {
    _InterlockedAdd((volatile signed __int32 *)P + 5, 1u);
LABEL_10:
    v8 = dword_622E4;
    v7 = off_60148;
    goto LABEL_11;
  }
LABEL_11:
  v9 = *(_DWORD *)(a1 + 128);
  if ( v9 != 1 && v9 != 2 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v7[1].AttachedDevice) & 2) != 0 && BYTE1(v7[1].AttachedDevice) >= 3u )
      sub_11148((__int64)v7[1].DriverObject, 0xFu, (__int64)&unk_5CD58, v9);
    return 6;
  }
  if ( (*(_BYTE *)(a1 + 120) & 1) != 0 )
    return 6;
  if ( *(_QWORD *)(a1 + 48) )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v7[1].AttachedDevice) & 2) != 0 && BYTE1(v7[1].AttachedDevice) >= 4u )
      sub_11008((__int64)v7[1].DriverObject, 0x10u, (__int64)&unk_5CD58);
    v10 = *(_QWORD *)(a1 + 48);
    sub_44214(v10, &v22, 0i64, &v19);
    sub_4484C(v10, &v21);
    v11 = sub_44900(v10, &v20);
LABEL_25:
    v6 = v11;
LABEL_39:
    v7 = off_60148;
    v8 = dword_622E4;
    goto LABEL_40;
  }
  if ( *(_QWORD *)(a1 + 40) )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v7[1].AttachedDevice) & 2) != 0 && BYTE1(v7[1].AttachedDevice) >= 4u )
      sub_11008((__int64)v7[1].DriverObject, 0x11u, (__int64)&unk_5CD58);
    v12 = *(_BYTE **)(a1 + 40);
    sub_43C3C((__int64)v12, &v19);
    if ( v19 < 0x14u )
      return 6;
    sub_43B8C(v12, &v23);
    v13 = 4 * v23;
    v23 = v13;
    if ( v13 < 0x14u || v19 < v13 )
      return 6;
    v19 -= v13;
    sub_43F40((__int64)v12, &v22);
    sub_43FF0((__int64)v12, &v21);
    v11 = sub_440A0((__int64)v12, &v20);
    goto LABEL_25;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v7[1].AttachedDevice) & 2) != 0 && BYTE1(v7[1].AttachedDevice) >= 4u )
  {
    sub_11008((__int64)v7[1].DriverObject, 0x12u, (__int64)&unk_5CD58);
    goto LABEL_39;
  }
LABEL_40:
  if ( v22 == 6 )
  {
    if ( *(_QWORD *)(a1 + 56) )
    {
      if ( v8 > 7 )
      {
        _InterlockedAdd((volatile signed __int32 *)P + 7, 1u);
        v8 = dword_622E4;
      }
      if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
      {
        if ( v8 > 9 )
          _InterlockedAdd((volatile signed __int32 *)P + 9, 1u);
      }
      else if ( v8 > 8 )
      {
        _InterlockedAdd((volatile signed __int32 *)P + 8, 1u);
      }
      v6 = sub_38C30((__int64 *)a1, *(_WORD **)(a1 + 56), v19, &v21, &v20, a2, a3);
      v14 = dword_622E4;
      if ( v6 )
      {
        if ( (unsigned int)dword_622E4 > 0xB )
        {
          _InterlockedAdd((volatile signed __int32 *)P + 11, 1u);
          v14 = dword_622E4;
        }
        if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
        {
          if ( v14 > 0xF )
            _InterlockedAdd((volatile signed __int32 *)P + 15, 1u);
        }
        else if ( v14 > 0xE )
        {
          _InterlockedAdd((volatile signed __int32 *)P + 14, 1u);
        }
      }
      else
      {
        if ( (unsigned int)dword_622E4 > 0xA )
        {
          _InterlockedAdd((volatile signed __int32 *)P + 10, 1u);
          v14 = dword_622E4;
        }
        if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
        {
          if ( v14 > 0xD )
            _InterlockedAdd((volatile signed __int32 *)P + 13, 1u);
        }
        else if ( v14 > 0xC )
        {
          _InterlockedAdd((volatile signed __int32 *)P + 12, 1u);
        }
      }
      goto LABEL_55;
    }
    if ( v7 == (PDEVICE_OBJECT)&off_60148 )
      return v6;
    if ( (BYTE4(v7[1].AttachedDevice) & 2) == 0 || BYTE1(v7[1].AttachedDevice) < 3u )
      goto LABEL_108;
    v15 = 19;
    goto LABEL_69;
  }
  if ( v22 == 17 )
  {
    if ( *(_QWORD *)(a1 + 64) )
    {
      if ( v8 > 0x10 )
      {
        _InterlockedAdd((volatile signed __int32 *)P + 16, 1u);
        v8 = dword_622E4;
      }
      if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
      {
        if ( v8 > 0x12 )
          _InterlockedAdd((volatile signed __int32 *)P + 18, 1u);
      }
      else if ( v8 > 0x11 )
      {
        _InterlockedAdd((volatile signed __int32 *)P + 17, 1u);
      }
      v6 = sub_3B1B4((__int64 *)a1, *(_WORD **)(a1 + 64), v19, &v21, &v20, (__int64)a2, a3);
      v16 = dword_622E4;
      if ( v6 )
      {
        if ( (unsigned int)dword_622E4 > 0x14 )
        {
          _InterlockedAdd((volatile signed __int32 *)P + 20, 1u);
          v16 = dword_622E4;
        }
        if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
        {
          if ( v16 > 0x18 )
            _InterlockedAdd((volatile signed __int32 *)P + 24, 1u);
        }
        else if ( v16 > 0x17 )
        {
          _InterlockedAdd((volatile signed __int32 *)P + 23, 1u);
        }
      }
      else
      {
        if ( (unsigned int)dword_622E4 > 0x13 )
        {
          _InterlockedAdd((volatile signed __int32 *)P + 19, 1u);
          v16 = dword_622E4;
        }
        if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
        {
          if ( v16 > 0x16 )
            _InterlockedAdd((volatile signed __int32 *)P + 22, 1u);
        }
        else if ( v16 > 0x15 )
        {
          _InterlockedAdd((volatile signed __int32 *)P + 21, 1u);
        }
      }
      goto LABEL_55;
    }
    if ( v7 == (PDEVICE_OBJECT)&off_60148 )
      return v6;
    if ( (BYTE4(v7[1].AttachedDevice) & 2) == 0 || BYTE1(v7[1].AttachedDevice) < 3u )
      goto LABEL_108;
    v15 = 20;
LABEL_69:
    sub_112FC((__int64)v7[1].DriverObject, v15, (__int64)&unk_5CD58, *(_DWORD *)(a1 + 124));
    goto LABEL_55;
  }
  if ( v22 != 1 )
  {
    if ( v8 > 0x19 )
    {
      _InterlockedAdd((volatile signed __int32 *)P + 25, 1u);
      v7 = off_60148;
    }
    v6 = 5;
    goto LABEL_108;
  }
  v17 = sub_42C74(*(_QWORD *)(a1 + 16), 6);
  if ( !v17 )
  {
    v7 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
      return v6;
    if ( (BYTE4(off_60148[1].AttachedDevice) & 2) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 3u )
    {
      sub_112FC((__int64)off_60148[1].DriverObject, 0x15u, (__int64)&unk_5CD58, *(_DWORD *)(a1 + 124));
      v7 = off_60148;
    }
    goto LABEL_108;
  }
  v6 = sub_3B9B4((__int64 *)a1, v17, v19, (__int64)&v21, (int)&v20, a2);
LABEL_55:
  v7 = off_60148;
LABEL_108:
  if ( v7 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v7[1].AttachedDevice) & 2) != 0 && BYTE1(v7[1].AttachedDevice) >= 5u )
    sub_112FC((__int64)v7[1].DriverObject, 0x16u, (__int64)&unk_5CD58, v6);
  return v6;
}
// 622E4: using guessed type int dword_622E4;

//----- (0000000000037534) ----------------------------------------------------
void *__fastcall sub_37534(__int64 a1, __int64 a2, const void *a3, _QWORD *a4)
{
  void *result; // rax

  *(_QWORD *)a2 = _InterlockedIncrement64(&qword_627A8);
  *(_QWORD *)(a2 + 32) = *a4;
  if ( (unsigned __int8)sub_502CC(0x200A060u) )
  {
    sub_3BCB4(a1, *(_QWORD *)a2, (int *)(a2 + 8));
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
         && BYTE1(off_60148[1].AttachedDevice) >= 4u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x17u, (__int64)&unk_5CD58);
  }
  sub_404B8(a2 + 40);
  result = memmove((void *)(a2 + 96), a3, 0x24ui64);
  *(_BYTE *)(a2 + 161) = 0;
  *(_BYTE *)(a2 + 162) = 0;
  return result;
}
// 627A8: using guessed type __int64 qword_627A8;

//----- (000000000003760C) ----------------------------------------------------
__int64 __fastcall sub_3760C(_QWORD *a1)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 4u )
  {
    sub_1D3B0((__int64)off_60148[1].DriverObject, 0x18u, (__int64)&unk_5CD58, *a1, *(_QWORD *)((char *)a1 + 20));
  }
  return sub_37DB0(a1, 0);
}

//----- (0000000000037674) ----------------------------------------------------
int __fastcall sub_37674(void *Src, _BYTE *a2, const __m128i *a3, const __m128i *a4, __int16 a5, __int16 a6)
{
  __m128i v8; // xmm1
  int result; // eax
  _QWORD Dst[2]; // [rsp+20h] [rbp-28h] BYREF
  unsigned __int16 v11; // [rsp+30h] [rbp-18h]

  *(__m128i *)Src = _mm_loadu_si128(a3);
  v8 = _mm_loadu_si128(a4);
  *((_WORD *)Src + 8) = a5;
  *((_WORD *)Src + 17) = a6;
  *(__m128i *)((char *)Src + 18) = v8;
  result = memcmp(Src, (char *)Src + 18, 0x12ui64);
  if ( result <= 0 )
  {
    if ( a2 )
      *a2 = 0;
  }
  else
  {
    memmove(Dst, Src, 0x12ui64);
    *(_QWORD *)Src = *(_QWORD *)((char *)Src + 18);
    *((_QWORD *)Src + 1) = *(_QWORD *)((char *)Src + 26);
    *((_WORD *)Src + 8) = *((_WORD *)Src + 17);
    *(_QWORD *)((char *)Src + 18) = Dst[0];
    *(_QWORD *)((char *)Src + 26) = Dst[1];
    result = v11;
    *((_WORD *)Src + 17) = v11;
    if ( a2 )
      *a2 = 1;
  }
  return result;
}

//----- (0000000000037730) ----------------------------------------------------
ULONG_PTR __fastcall sub_37730(__int64 a1, ULONG_PTR a2, _DWORD *a3, _QWORD *a4, __int64 (*a5)(void), void (__fastcall *a6)(__int64), unsigned int a7, __int64 a8, char a9, ULONG_PTR **a10)
{
  ULONG_PTR v10; // rbx
  unsigned int v15; // er12
  __int64 (*v16)(void); // rdi
  unsigned __int64 v17; // rax
  ULONG_PTR **v18; // r15
  __int64 v19; // rax
  __int64 v20; // rdi
  unsigned __int64 v21; // rbp
  _WORD *v22; // rdi
  int v23; // eax
  int v24; // eax
  PDEVICE_OBJECT v25; // rcx
  __int64 v27; // [rsp+20h] [rbp-58h]
  unsigned __int64 v28; // [rsp+40h] [rbp-38h]
  __int64 v29; // [rsp+90h] [rbp+18h] BYREF

  v10 = 0i64;
  LODWORD(v29) = 0;
  v15 = a7;
  v16 = a5;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_36DF4((__int64)off_60148[1].DriverObject, 25i64, (__int64)&unk_5CD58, a2, a3, a4, a5, a7);
  }
  v17 = sub_37C68(a3 - 24);
  v18 = a10;
  v28 = v17;
  if ( !a9 )
  {
    v21 = v17;
    goto LABEL_37;
  }
  if ( v15 <= (unsigned int)sub_55088(a2, &v29) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 2u )
    {
      v23 = sub_55088(a2, &v29);
      sub_112FC((__int64)off_60148[1].DriverObject, 0x1Cu, (__int64)&unk_5CD58, v23);
      goto LABEL_32;
    }
LABEL_35:
    v21 = v28;
    goto LABEL_37;
  }
  v19 = v16();
  v20 = v19;
  if ( !v19 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 2u )
    {
      sub_11008((__int64)off_60148[1].DriverObject, 0x1Bu, (__int64)&unk_5CD58);
LABEL_32:
      v21 = v28;
      goto LABEL_33;
    }
    goto LABEL_35;
  }
  sub_37534(a1, v19, a3, a4);
  v21 = v28;
  v10 = sub_55D94(a2, v28, v20, v18, (__int64)&v29);
  if ( (_DWORD)v29
    && off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 2u )
  {
    HIDWORD(v27) = HIDWORD(v28);
    sub_11148((__int64)off_60148[1].DriverObject, 0x1Au, (__int64)&unk_5CD58, v29);
  }
  if ( v10 == v20 )
  {
    *(_BYTE *)(v10 + 160) = 1;
    *(_BYTE *)(v10 + 161) = 1;
    *(_BYTE *)(v10 + 162) = 1;
    v22 = sub_42C74(*(_QWORD *)(a1 + 16), 3);
    if ( v22 || (v22 = sub_42C74(*(_QWORD *)(a1 + 16), 4)) != 0i64 )
    {
      sub_44EC8(v22, (_WORD *)(v10 + 156));
      sub_44F8C((__int64)v22, (_WORD *)(v10 + 158));
    }
    *(_DWORD *)(v10 + 152) = 0;
    if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
      *(_DWORD *)(v10 + 152) = 1;
    if ( *(_DWORD *)(a1 + 128) == 1 )
    {
      if ( *(_QWORD *)(a1 + 56) )
      {
        _InterlockedAdd64(&qword_62260, 1ui64);
        _InterlockedAdd(&dword_62250, 1u);
      }
      else
      {
        _InterlockedAdd64(&qword_62270, 1ui64);
        _InterlockedAdd(&dword_62254, 1u);
      }
    }
  }
  else
  {
    a6(v20);
  }
LABEL_33:
  if ( v10 )
  {
LABEL_43:
    v25 = off_60148;
    goto LABEL_44;
  }
LABEL_37:
  v10 = sub_559E0(a2, v21, v18, &v29);
  if ( !v10 )
    goto LABEL_43;
  v24 = sub_57D60(a2, (ULONG_PTR)*v18, a8);
  if ( !v24 )
    goto LABEL_43;
  v25 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return v10;
  if ( (BYTE4(off_60148[1].AttachedDevice) & 2) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 3u )
  {
    LODWORD(v27) = v24;
    sub_11230((__int64)off_60148[1].DriverObject, 0x1Du, (__int64)&unk_5CD58, *(_QWORD *)v10, v27);
    goto LABEL_43;
  }
LABEL_44:
  if ( v25 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v25[1].AttachedDevice) & 2) != 0
    && BYTE1(v25[1].AttachedDevice) >= 5u )
  {
    sub_2F80C((__int64)v25[1].DriverObject, 0x1Eu, (__int64)&unk_5CD58, v10);
  }
  return v10;
}
// 37A8D: variable 'v27' is possibly undefined
// 62250: using guessed type int dword_62250;
// 62254: using guessed type int dword_62254;
// 62260: using guessed type __int64 qword_62260;
// 62270: using guessed type __int64 qword_62270;

//----- (0000000000037AF4) ----------------------------------------------------
__int64 __fastcall sub_37AF4(_QWORD *a1, _QWORD *a2, __int64 a3, __int64 a4, int a5, int a6, int a7, __int64 a8)
{
  PDEVICE_OBJECT v10; // r10
  int v12; // [rsp+30h] [rbp-18h]
  BOOL v13; // [rsp+38h] [rbp-10h]

  v10 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148[1].AttachedDevice) & 2) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 5u )
    {
      sub_11008((__int64)off_60148[1].DriverObject, 0x1Fu, (__int64)&unk_5CD58);
      v10 = off_60148;
    }
    if ( v10 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v10[1].AttachedDevice) & 2) != 0
      && BYTE1(v10[1].AttachedDevice) >= 4u )
    {
      v13 = (*(_BYTE *)(a8 + 120) & 0x10) == 16;
      v12 = *(_DWORD *)(a8 + 128);
      sub_36D70((__int64)v10[1].DriverObject, 32i64, (__int64)&unk_5CD58, a1, a2, *(_QWORD *)a8, v12, v13);
      v10 = off_60148;
    }
  }
  if ( *(_QWORD *)(a8 + 360) )
  {
    *(_QWORD *)((char *)a2 + 20) = *a1;
    *(_QWORD *)((char *)a1 + 20) = *a2;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 5u )
    {
      sub_11008((__int64)off_60148[1].DriverObject, 0x22u, (__int64)&unk_5CD58);
    }
  }
  else if ( v10 != (PDEVICE_OBJECT)&off_60148
         && (BYTE4(v10[1].AttachedDevice) & 2) != 0
         && BYTE1(v10[1].AttachedDevice) >= 3u )
  {
    sub_112FC((__int64)v10[1].DriverObject, 0x21u, (__int64)&unk_5CD58, 0);
  }
  return 0i64;
}

//----- (0000000000037C68) ----------------------------------------------------
unsigned __int64 __fastcall sub_37C68(_DWORD *a1)
{
  int v1; // er8
  int v2; // edx
  int v3; // eax
  int v5; // er8
  int v6; // er9
  int v7; // edx
  int v8; // eax
  int v9; // er9
  int v10; // eax
  int v11; // er8
  int v12; // ecx
  int v13; // eax
  int v14; // ecx
  int v15; // er9
  int v16; // edx
  int v17; // ecx
  int v18; // edx
  int v19; // eax
  int v20; // er8
  int v21; // edx
  int v22; // er8
  int v23; // ecx
  int v24; // er9
  int v25; // er8
  int v26; // er9
  int v27; // eax
  int v28; // ecx
  int v29; // er9
  int v30; // ecx
  int v31; // er8
  int v32; // eax
  int v33; // ecx
  int v34; // eax
  int v35; // er9
  int v36; // edx
  int v37; // eax
  int v38; // edx
  int v39; // ecx
  int v40; // er8
  int v41; // edx
  int v42; // er8
  int v43; // eax
  int v44; // er10
  int v45; // er8
  int v46; // er10
  int v47; // edx
  int v48; // ecx
  int v49; // er10
  int v50; // er9
  int v51; // edx
  int v52; // er10
  int v53; // er9
  int v54; // eax
  unsigned int v55; // er10

  v1 = a1[26];
  v2 = a1[25];
  v3 = a1[24] - v1;
  v5 = v2 + v1;
  v6 = v3 ^ __ROL4__(a1[26], 4);
  v7 = v2 - v6;
  v8 = v6;
  v9 = v5 + v6;
  v10 = v7 ^ __ROL4__(v8, 6);
  v11 = v5 - v10;
  v12 = v10;
  v13 = v9 + v10;
  v14 = v11 ^ __ROL4__(v12, 8);
  v15 = v9 - v14;
  v16 = v14;
  v17 = v13 + v14;
  v18 = v15 ^ __ROL4__(v16, 16);
  v19 = v13 - v18;
  v20 = v18;
  v21 = v17 + v18;
  v22 = v19 ^ __ROR4__(v20, 13);
  v23 = v17 - v22;
  v24 = v22;
  v25 = v21 + a1[28] + v22;
  v26 = a1[29] + (v23 ^ __ROL4__(v24, 4));
  v27 = a1[27] - v26;
  v28 = v26;
  v29 = v25 + v26;
  v30 = (v21 + v27) ^ __ROL4__(v28, 4);
  v31 = v25 - v30;
  v32 = v30;
  v33 = v29 + v30;
  v34 = v31 ^ __ROL4__(v32, 6);
  v35 = v29 - v34;
  v36 = v34;
  v37 = v33 + v34;
  v38 = v35 ^ __ROL4__(v36, 8);
  v39 = v33 - v38;
  v40 = v38;
  v41 = v37 + v38;
  v42 = v39 ^ __ROL4__(v40, 16);
  v43 = v37 - v42;
  v44 = v42;
  v45 = v41 + v42;
  v46 = v43 ^ __ROR4__(v44, 13);
  v47 = v41 - v46;
  v48 = v46;
  v49 = v45 + a1[31] + v46;
  v50 = (v49 ^ ((v47 ^ __ROL4__(v48, 4)) + a1[32])) - __ROL4__(v49, 14);
  v51 = (v50 ^ (v45 + a1[30])) - __ROL4__(v50, 11);
  v52 = (v51 ^ v49) - __ROR4__(v51, 7);
  v53 = (v52 ^ v50) - __ROL4__(v52, 16);
  v54 = (v51 ^ v53) - __ROL4__(v53, 4);
  v55 = (v54 ^ v52) - __ROL4__(v54, 14);
  return ((unsigned __int64)v55 << 32) | ((v55 ^ v53) - __ROR4__(v55, 8));
}

//----- (0000000000037DB0) ----------------------------------------------------
__int64 __fastcall sub_37DB0(_QWORD *a1, char a2)
{
  _QWORD *v4; // rdi

  if ( !*((_BYTE *)a1 + 161) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148[1].AttachedDevice) < 0
      && BYTE1(off_60148[1].AttachedDevice) >= 3u )
    {
      sub_2F80C((__int64)off_60148[1].DriverObject, 0x23u, (__int64)&unk_5CD58, *a1);
    }
    return 0i64;
  }
  v4 = sub_40964((__int64)qword_62248, 16, (__int64)sub_38148, 0i64);
  if ( v4 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148[1].AttachedDevice) < 0
      && BYTE1(off_60148[1].AttachedDevice) >= 4u )
    {
      sub_1D3B0(
        (__int64)off_60148[1].DriverObject,
        0x25u,
        (__int64)&unk_5CD58,
        *a1,
        *(_QWORD *)((char *)a1 + 20),
        0i64,
        0);
    }
    *(_DWORD *)v4 = 40019;
    *(_QWORD *)((char *)v4 + 4) = *a1;
    *((_BYTE *)v4 + 12) = a2;
    sub_40AF4((__int64)v4);
    *((_BYTE *)a1 + 161) = 0;
    return 0i64;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 2u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x24u, (__int64)&unk_5CD58);
  }
  return 3i64;
}

//----- (0000000000037F20) ----------------------------------------------------
__int64 __fastcall sub_37F20(__int64 a1)
{
  unsigned int v1; // edi
  PDEVICE_OBJECT v3; // r10
  unsigned __int16 v5; // dx
  __int16 v6; // cx
  __int16 v7; // ax
  __int64 v8; // r8
  __int64 v9; // r11
  int v10; // eax
  __int64 v11; // [rsp+40h] [rbp-28h] BYREF
  __int16 v12; // [rsp+4Ch] [rbp-1Ch]
  __int16 v13; // [rsp+4Eh] [rbp-1Ah]
  __int64 v14; // [rsp+50h] [rbp-18h]
  __int64 v15; // [rsp+58h] [rbp-10h]

  v1 = 0;
  LODWORD(v11) = 0;
  memset((char *)&v11 + 4, 0, 0x1Cui64);
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 0x40) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x26u, (__int64)&unk_5CD58);
    v3 = off_60148;
  }
  if ( !dword_65454 )
    return 0i64;
  if ( *(_DWORD *)(a1 + 12) )
  {
    if ( *(_BYTE *)(a1 + 162) )
    {
      v6 = *(_WORD *)(a1 + 156);
      v7 = *(_WORD *)(a1 + 158);
      v8 = *(_QWORD *)(a1 + 136);
      v9 = *(_QWORD *)(a1 + 144);
      v11 = *(_QWORD *)a1;
      v12 = v6;
      v13 = v7;
      v14 = v8;
      v15 = v9;
      if ( v3 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v3[1].AttachedDevice) & 0x40) != 0
        && BYTE1(v3[1].AttachedDevice) >= 5u )
      {
        sub_36C8C((__int64)v3[1].DriverObject, 41i64, (__int64)&unk_5CD58);
      }
      v10 = sub_4D1A4(40038, &v11, 0x20u);
      v1 = v10;
      if ( !v10 )
      {
        *(_BYTE *)(a1 + 162) = 0;
        goto LABEL_28;
      }
      v3 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( (BYTE4(off_60148[1].AttachedDevice) & 0x40) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 2u )
        {
          sub_112FC((__int64)off_60148[1].DriverObject, 0x2Au, (__int64)&unk_5CD58, v10);
          goto LABEL_28;
        }
        goto LABEL_29;
      }
    }
    else if ( v3 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(v3[1].AttachedDevice) & 0x40) != 0 && BYTE1(v3[1].AttachedDevice) >= 3u )
      {
        v5 = 40;
        goto LABEL_12;
      }
LABEL_29:
      if ( v3 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v3[1].AttachedDevice) & 2) != 0
        && BYTE1(v3[1].AttachedDevice) >= 5u )
      {
        sub_11008((__int64)v3[1].DriverObject, 0x2Bu, (__int64)&unk_5CD58);
      }
      return v1;
    }
  }
  else if ( v3 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(v3[1].AttachedDevice) & 0x40) != 0 && BYTE1(v3[1].AttachedDevice) >= 3u )
    {
      v5 = 39;
LABEL_12:
      sub_2F80C((__int64)v3[1].DriverObject, v5, (__int64)&unk_5CD58, *(_QWORD *)a1);
LABEL_28:
      v3 = off_60148;
      goto LABEL_29;
    }
    goto LABEL_29;
  }
  return v1;
}
// 65454: using guessed type int dword_65454;

//----- (0000000000038148) ----------------------------------------------------
__int64 __fastcall sub_38148(_DWORD *a1)
{
  __int64 result; // rax

  result = 40019i64;
  if ( *a1 == 40019 )
    result = sub_4D1A4(40019, a1 + 1, 9u);
  return result;
}

//----- (0000000000038174) ----------------------------------------------------
void __fastcall sub_38174(PVOID Object)
{
  ULONG_PTR v2; // rax
  PDEVICE_OBJECT v3; // rcx
  ULONG_PTR v4; // rax
  ULONG_PTR v5; // rax
  ULONG_PTR v6; // rax

  while ( !byte_62221 )
  {
    if ( !(unsigned int)sub_40B60(Object, 0x1D4C0u) )
      return;
    v2 = qword_621F0;
    if ( qword_621F0 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148[1].AttachedDevice) & 8) != 0
        && BYTE1(off_60148[1].AttachedDevice) >= 4u )
      {
        sub_11008((__int64)off_60148[1].DriverObject, 0x2Cu, (__int64)&unk_5CD58);
        v2 = qword_621F0;
      }
      sub_38400(v2, qword_65460);
      v3 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148[1].AttachedDevice) & 8) == 0
        || BYTE1(off_60148[1].AttachedDevice) < 4u )
      {
        goto LABEL_13;
      }
      sub_11008((__int64)off_60148[1].DriverObject, 0x2Du, (__int64)&unk_5CD58);
    }
    v3 = off_60148;
LABEL_13:
    v4 = qword_621F8;
    if ( qword_621F8 )
    {
      if ( v3 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v3[1].AttachedDevice) & 8) != 0
        && BYTE1(v3[1].AttachedDevice) >= 4u )
      {
        sub_11008((__int64)v3[1].DriverObject, 0x2Eu, (__int64)&unk_5CD58);
        v4 = qword_621F8;
      }
      sub_38400(v4, qword_65460);
      v3 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148[1].AttachedDevice) & 8) != 0
        && BYTE1(off_60148[1].AttachedDevice) >= 4u )
      {
        sub_11008((__int64)off_60148[1].DriverObject, 0x2Fu, (__int64)&unk_5CD58);
        v3 = off_60148;
      }
    }
    v5 = qword_62200;
    if ( qword_62200 )
    {
      if ( v3 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v3[1].AttachedDevice) & 8) != 0
        && BYTE1(v3[1].AttachedDevice) >= 4u )
      {
        sub_11008((__int64)v3[1].DriverObject, 0x30u, (__int64)&unk_5CD58);
        v5 = qword_62200;
      }
      sub_38400(v5, qword_65470);
      v3 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148[1].AttachedDevice) & 8) != 0
        && BYTE1(off_60148[1].AttachedDevice) >= 4u )
      {
        sub_11008((__int64)off_60148[1].DriverObject, 0x31u, (__int64)&unk_5CD58);
        v3 = off_60148;
      }
    }
    v6 = qword_62208;
    if ( qword_62208 )
    {
      if ( v3 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v3[1].AttachedDevice) & 8) != 0
        && BYTE1(v3[1].AttachedDevice) >= 4u )
      {
        sub_11008((__int64)v3[1].DriverObject, 0x32u, (__int64)&unk_5CD58);
        v6 = qword_62208;
      }
      sub_38400(v6, qword_65470);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148[1].AttachedDevice) & 8) != 0
        && BYTE1(off_60148[1].AttachedDevice) >= 4u )
      {
        sub_11008((__int64)off_60148[1].DriverObject, 0x33u, (__int64)&unk_5CD58);
      }
    }
  }
}
// 62221: using guessed type char byte_62221;
// 65460: using guessed type __int64 qword_65460;
// 65470: using guessed type __int64 qword_65470;

//----- (0000000000038400) ----------------------------------------------------
__int64 __fastcall sub_38400(ULONG_PTR BugCheckParameter2, __int64 a2)
{
  _QWORD *v4; // rbp
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx
  __int64 v7; // rbx
  __int64 v8; // r8
  __int64 v10; // [rsp+20h] [rbp-38h]
  int v11; // [rsp+70h] [rbp+18h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+78h] [rbp+20h] BYREF

  BugCheckParameter1 = 0i64;
  v11 = 0;
  v4 = (_QWORD *)sub_5621C(BugCheckParameter2, &BugCheckParameter1, &v11);
  if ( v4 )
  {
    while ( !byte_62221 )
    {
      v7 = MEMORY[0xFFFFF78000000014];
      sub_40598((PFAST_MUTEX)(v4 + 5));
      LOBYTE(v7) = a2 + v4[4] < v7;
      sub_40664((PFAST_MUTEX)(v4 + 5));
      if ( (_BYTE)v7 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148[1].AttachedDevice) & 8) != 0
          && BYTE1(off_60148[1].AttachedDevice) >= 4u )
        {
          sub_2F80C((__int64)off_60148[1].DriverObject, 0x35u, (__int64)&unk_5CD58, *v4);
        }
        LOBYTE(v8) = 1;
        sub_5575C(BugCheckParameter2, BugCheckParameter1, v8, &v11);
        if ( v11
          && off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148[1].AttachedDevice) & 8) != 0
          && BYTE1(off_60148[1].AttachedDevice) >= 2u )
        {
          LODWORD(v10) = v11;
          sub_11230((__int64)off_60148[1].DriverObject, 0x36u, (__int64)&unk_5CD58, *v4, v10);
        }
      }
      v4 = (_QWORD *)sub_563E8(BugCheckParameter2, &BugCheckParameter1, 1, &v11);
      if ( !v4 )
      {
        v5 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148[1].AttachedDevice) & 8) != 0
          && BYTE1(off_60148[1].AttachedDevice) >= 2u )
        {
          v6 = 55;
          goto LABEL_22;
        }
        return 0i64;
      }
    }
  }
  else
  {
    v5 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 8) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 2u )
    {
      v6 = 52;
LABEL_22:
      sub_112FC((__int64)v5[1].DriverObject, v6, (__int64)&unk_5CD58, v11);
    }
  }
  return 0i64;
}
// 38513: variable 'v8' is possibly undefined
// 3855C: variable 'v10' is possibly undefined
// 62221: using guessed type char byte_62221;

//----- (00000000000385D4) ----------------------------------------------------
__int64 sub_385D4(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, a3, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000038628) ----------------------------------------------------
__int64 sub_38628(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+A8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CD48, 48i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000386AC) ----------------------------------------------------
__int64 __fastcall sub_386AC(__int64 a1, __int64 a2)
{
  unsigned int v2; // ebx
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  unsigned __int16 v5; // dx
  int v6; // eax
  int v7; // eax
  int v9; // [rsp+98h] [rbp+10h] BYREF
  int v10; // [rsp+9Ch] [rbp+14h]

  v10 = HIDWORD(a2);
  v2 = 0;
  v9 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0xAu, (__int64)&unk_5CD48);
  }
  qword_621F0 = 0i64;
  qword_621F8 = 0i64;
  qword_62228 = sub_3F8D8(2, 0xC8u, 0x74736C54u);
  if ( qword_62228 )
  {
    qword_62230 = sub_3F8D8(1, 0x10u, 0x67736C54u);
    if ( qword_62230 )
    {
      qword_62238 = (ULONG_PTR)sub_53288(
                                 11,
                                 0,
                                 1,
                                 0x74736C54u,
                                 qword_65460,
                                 2,
                                 (__int64)sub_37C68,
                                 0i64,
                                 (__int64)sub_399D4,
                                 0i64,
                                 &v9);
      if ( qword_62238 )
      {
        qword_62240 = (ULONG_PTR)sub_53288(
                                   11,
                                   0,
                                   1,
                                   0x74736C54u,
                                   qword_65460,
                                   2,
                                   (__int64)sub_37C68,
                                   0i64,
                                   (__int64)sub_399D4,
                                   0i64,
                                   &v9);
        if ( qword_62240 )
        {
          qword_621F0 = qword_62238;
          qword_621F8 = qword_62240;
          goto LABEL_49;
        }
        v3 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148
          || (BYTE4(off_60148[1].AttachedDevice) & 1) == 0
          || BYTE1(off_60148[1].AttachedDevice) < 2u )
        {
          goto LABEL_28;
        }
        v5 = 14;
      }
      else
      {
        v3 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148
          || (BYTE4(off_60148[1].AttachedDevice) & 1) == 0
          || BYTE1(off_60148[1].AttachedDevice) < 2u )
        {
          goto LABEL_28;
        }
        v5 = 13;
      }
      sub_112FC((__int64)v3[1].DriverObject, v5, (__int64)&unk_5CD48, v9);
      goto LABEL_27;
    }
    v3 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 2u )
    {
      v4 = 12;
      goto LABEL_10;
    }
  }
  else
  {
    v3 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 2u )
    {
      v4 = 11;
LABEL_10:
      sub_11008((__int64)v3[1].DriverObject, v4, (__int64)&unk_5CD48);
LABEL_27:
      v3 = off_60148;
      goto LABEL_28;
    }
  }
LABEL_28:
  v2 = 3;
  if ( !qword_62238 )
    goto LABEL_36;
  v6 = sub_53950(qword_62238, 1);
  if ( v6 )
  {
    v3 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148[1].AttachedDevice) & 1) == 0
      || BYTE1(off_60148[1].AttachedDevice) < 2u )
    {
      goto LABEL_35;
    }
    sub_112FC((__int64)off_60148[1].DriverObject, 0xFu, (__int64)&unk_5CD48, v6);
  }
  v3 = off_60148;
LABEL_35:
  qword_62238 = 0i64;
LABEL_36:
  if ( !qword_62240 )
    goto LABEL_44;
  v7 = sub_53950(qword_62240, 1);
  if ( v7 )
  {
    v3 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148[1].AttachedDevice) & 1) == 0
      || BYTE1(off_60148[1].AttachedDevice) < 2u )
    {
      goto LABEL_43;
    }
    sub_112FC((__int64)off_60148[1].DriverObject, 0x10u, (__int64)&unk_5CD48, v7);
  }
  v3 = off_60148;
LABEL_43:
  qword_62240 = 0i64;
LABEL_44:
  if ( qword_62230 )
  {
    sub_3F95C(qword_62230);
    v3 = off_60148;
    qword_62230 = 0i64;
  }
  if ( qword_62228 )
  {
    sub_3F95C(qword_62228);
    qword_62228 = 0i64;
LABEL_49:
    v3 = off_60148;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v3[1].AttachedDevice) & 1) != 0 && BYTE1(v3[1].AttachedDevice) >= 5u )
    sub_112FC((__int64)v3[1].DriverObject, 0x11u, (__int64)&unk_5CD48, v2);
  return v2;
}
// 65460: using guessed type __int64 qword_65460;

//----- (0000000000038A90) ----------------------------------------------------
void sub_38A90()
{
  PDEVICE_OBJECT v0; // rcx
  int v1; // eax
  int v2; // eax

  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x12u, (__int64)&unk_5CD48);
    v0 = off_60148;
  }
  if ( qword_62238 )
  {
    v1 = sub_53950(qword_62238, 1);
    if ( v1 )
    {
      v0 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148[1].AttachedDevice) & 1) == 0
        || BYTE1(off_60148[1].AttachedDevice) < 2u )
      {
        goto LABEL_12;
      }
      sub_112FC((__int64)off_60148[1].DriverObject, 0x13u, (__int64)&unk_5CD48, v1);
    }
    v0 = off_60148;
LABEL_12:
    qword_62238 = 0i64;
  }
  if ( !qword_62240 )
    goto LABEL_21;
  v2 = sub_53950(qword_62240, 1);
  if ( v2 )
  {
    v0 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148[1].AttachedDevice) & 1) == 0
      || BYTE1(off_60148[1].AttachedDevice) < 2u )
    {
      goto LABEL_20;
    }
    sub_112FC((__int64)off_60148[1].DriverObject, 0x14u, (__int64)&unk_5CD48, v2);
  }
  v0 = off_60148;
LABEL_20:
  qword_62240 = 0i64;
LABEL_21:
  if ( qword_62230 )
  {
    sub_3F95C(qword_62230);
    qword_62230 = 0i64;
    v0 = off_60148;
  }
  if ( qword_62228 )
  {
    sub_3F95C(qword_62228);
    qword_62228 = 0i64;
    v0 = off_60148;
  }
  if ( v0 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v0[1].AttachedDevice) & 1) != 0 && BYTE1(v0[1].AttachedDevice) >= 5u )
    sub_11008((__int64)v0[1].DriverObject, 0x15u, (__int64)&unk_5CD48);
}

//----- (0000000000038C30) ----------------------------------------------------
__int64 __fastcall sub_38C30(__int64 *a1, _WORD *a2, unsigned __int16 a3, const __m128i *a4, const __m128i *a5, _QWORD *a6, _BYTE *a7)
{
  PDEVICE_OBJECT v11; // rcx
  unsigned int v12; // ebx
  ULONG_PTR v13; // rax
  _QWORD *v14; // rdi
  unsigned __int16 v15; // dx
  bool v16; // cf
  _QWORD *v17; // rcx
  _DWORD *v18; // rax
  __int64 v19; // r8
  __int64 v20; // rcx
  int v21; // eax
  __int64 v22; // [rsp+20h] [rbp-B8h]
  unsigned __int16 v23[2]; // [rsp+40h] [rbp-98h] BYREF
  unsigned __int8 v24[4]; // [rsp+44h] [rbp-94h] BYREF
  unsigned int v25; // [rsp+48h] [rbp-90h] BYREF
  __int16 v26; // [rsp+4Ch] [rbp-8Ch] BYREF
  __int16 v27[2]; // [rsp+50h] [rbp-88h] BYREF
  int v28; // [rsp+54h] [rbp-84h] BYREF
  ULONG_PTR BugCheckParameter2; // [rsp+58h] [rbp-80h] BYREF
  _DWORD *v30; // [rsp+60h] [rbp-78h]
  ULONG_PTR BugCheckParameter1; // [rsp+68h] [rbp-70h] BYREF
  __int64 v32; // [rsp+70h] [rbp-68h] BYREF
  _DWORD Src[24]; // [rsp+78h] [rbp-60h] BYREF
  char v34; // [rsp+E8h] [rbp+10h] BYREF
  unsigned __int16 v35; // [rsp+F0h] [rbp+18h]
  const __m128i *v36; // [rsp+F8h] [rbp+20h]

  v36 = a4;
  v35 = a3;
  v30 = 0i64;
  LOBYTE(Src[0]) = 0;
  memset((char *)Src + 1, 0, 0x23ui64);
  BugCheckParameter1 = 0i64;
  v28 = 0;
  BugCheckParameter2 = 0i64;
  v34 = 0;
  if ( a2 )
  {
    v11 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 5u )
    {
      sub_11230((__int64)off_60148[1].DriverObject, 0x17u, (__int64)&unk_5CD48, a2, a3);
      v11 = off_60148;
    }
    if ( !byte_6546C )
    {
      if ( v11 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v11[1].AttachedDevice) & 2) != 0
        && BYTE1(v11[1].AttachedDevice) >= 5u )
      {
        sub_11008((__int64)v11[1].DriverObject, 0x18u, (__int64)&unk_5CD48);
        v11 = off_60148;
      }
      v12 = 7;
      goto LABEL_82;
    }
    if ( a3 < 4u )
    {
      if ( v11 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v11[1].AttachedDevice) & 2) != 0
        && BYTE1(v11[1].AttachedDevice) >= 3u )
      {
        sub_11430((__int64)v11[1].DriverObject, 0x19u, (__int64)&unk_5CD48, a3);
        v11 = off_60148;
      }
      v12 = 6;
      goto LABEL_82;
    }
    v12 = sub_44EC8(a2, v27);
    if ( v12 )
      goto LABEL_81;
    v12 = sub_44F8C((__int64)a2, &v26);
    v25 = v12;
    if ( v12 )
      goto LABEL_81;
    sub_37674(Src, v24, v36, a5, v27[0], v26);
    v13 = sub_3929C(
            (__int64)a1,
            (__int64)a2,
            Src,
            dword_65468,
            qword_65460,
            &BugCheckParameter2,
            (ULONG_PTR **)&BugCheckParameter1,
            (__int64)&v25);
    v14 = (_QWORD *)v13;
    if ( !v13 )
    {
      v11 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148[1].AttachedDevice) & 2) == 0
        || BYTE1(off_60148[1].AttachedDevice) < 5u )
      {
        v12 = v25;
        goto LABEL_75;
      }
      v15 = v12 + 26;
      v12 = v25;
      v22 = *a1;
      sub_491C0((__int64)off_60148[1].DriverObject, v15, (__int64)&unk_5CD48, v25);
      goto LABEL_74;
    }
    sub_40598((PFAST_MUTEX)(v13 + 40));
    v14[4] = a1[1];
    sub_40664((PFAST_MUTEX)(v14 + 5));
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 4u )
    {
      sub_1D3B0((__int64)off_60148[1].DriverObject, 0x1Bu, (__int64)&unk_5CD48, *a1, *v14);
    }
    v16 = v35 < 0x14u;
    v17 = a6;
    *a6 = *v14;
    v17[1] = *(_QWORD *)((char *)v14 + 20);
    *((_DWORD *)v17 + 4) = 6;
    *((_DWORD *)v17 + 5) = *((_DWORD *)v14 + 2);
    *((_DWORD *)v17 + 6) = *((_DWORD *)v14 + 3);
    if ( v16 )
    {
      v12 = v25;
    }
    else
    {
      v18 = sub_3FA7C((__int64)qword_62230);
      v30 = v18;
      if ( !v18 )
      {
        v11 = off_60148;
        v12 = 3;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
          && BYTE1(off_60148[1].AttachedDevice) >= 3u )
        {
          sub_11008((__int64)off_60148[1].DriverObject, 0x1Cu, (__int64)&unk_5CD48);
          v11 = off_60148;
        }
        goto LABEL_72;
      }
      *(_QWORD *)v18 = *a1;
      v12 = sub_45100((__int64)a2, (_BYTE *)v18 + 8);
      if ( v12 )
        goto LABEL_71;
      v12 = sub_39AC4(v14, v24[0], (__int64)v30, &v34);
      v25 = v12;
      if ( v34 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
          && BYTE1(off_60148[1].AttachedDevice) >= 4u )
        {
          sub_2F80C((__int64)off_60148[1].DriverObject, 0x1Du, (__int64)&unk_5CD48, *v14);
        }
        LOBYTE(v19) = 1;
        sub_5575C(BugCheckParameter2, BugCheckParameter1, v19, &v28);
        if ( v28
          && off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
          && BYTE1(off_60148[1].AttachedDevice) >= 2u )
        {
          LODWORD(v22) = v28;
          sub_11230((__int64)off_60148[1].DriverObject, 0x1Eu, (__int64)&unk_5CD48, *v14, v22);
        }
        *((_BYTE *)v14 + 161) = 0;
        *((_DWORD *)a1 + 30) |= 0x80u;
        sub_37F20((__int64)v14);
      }
    }
    v20 = a1[2];
    v32 = 0i64;
    v23[0] = 0;
    if ( !(unsigned int)sub_47270(v20, &v32, v23) )
    {
      if ( (a1[15] & 0x10) != 0 )
        v14[18] += v23[0];
      else
        v14[17] += v23[0];
      v11 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148[1].AttachedDevice) & 0x20) == 0
        || BYTE1(off_60148[1].AttachedDevice) < 5u )
      {
        goto LABEL_64;
      }
      sub_385D4((__int64)off_60148[1].DriverObject, 0x1Fu, (__int64)&unk_5CD48, *v14, v14[17], v14[18]);
    }
    v11 = off_60148;
LABEL_64:
    if ( !dword_65458 || !*((_BYTE *)v14 + 163) )
      goto LABEL_72;
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v11[1].AttachedDevice) & 4) != 0
      && BYTE1(v11[1].AttachedDevice) >= 4u )
    {
      sub_1D3B0((__int64)v11[1].DriverObject, 0x20u, (__int64)&unk_5CD48, *a1, *v14);
    }
    *a7 = 1;
    _InterlockedAdd64(&qword_62280, 1ui64);
    v12 = 17;
LABEL_71:
    v11 = off_60148;
LABEL_72:
    if ( !v30 )
      goto LABEL_75;
    sub_3FAE4((__int64)qword_62230, (__int64)v30);
LABEL_74:
    v11 = off_60148;
LABEL_75:
    if ( v14 )
    {
      v21 = sub_56A10(BugCheckParameter2, BugCheckParameter1);
      if ( !v21 )
      {
LABEL_81:
        v11 = off_60148;
        goto LABEL_82;
      }
      v11 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return v12;
      if ( (BYTE4(off_60148[1].AttachedDevice) & 2) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 2u )
      {
        LODWORD(v22) = v21;
        sub_11230((__int64)off_60148[1].DriverObject, 0x22u, (__int64)&unk_5CD48, *v14, v22);
        goto LABEL_81;
      }
    }
LABEL_82:
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v11[1].AttachedDevice) & 2) != 0
      && BYTE1(v11[1].AttachedDevice) >= 5u )
    {
      sub_112FC((__int64)v11[1].DriverObject, 0x23u, (__int64)&unk_5CD48, v12);
    }
    return v12;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 2u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x16u, (__int64)&unk_5CD48);
  }
  return 4i64;
}
// 39062: variable 'v19' is possibly undefined
// 390A6: variable 'v22' is possibly undefined
// 62280: using guessed type __int64 qword_62280;
// 65458: using guessed type int dword_65458;
// 65460: using guessed type __int64 qword_65460;
// 65468: using guessed type int dword_65468;
// 6546C: using guessed type char byte_6546C;

//----- (000000000003929C) ----------------------------------------------------
ULONG_PTR __fastcall sub_3929C(__int64 a1, __int64 a2, _DWORD *a3, unsigned int a4, __int64 a5, ULONG_PTR *a6, ULONG_PTR **a7, __int64 a8)
{
  PDEVICE_OBJECT v11; // rcx
  _DWORD *v12; // r13
  __int64 v13; // rbx
  char v14; // si
  _BYTE *v15; // rax
  PDEVICE_OBJECT v16; // rcx
  ULONG_PTR v17; // rax
  ULONG_PTR *v18; // rbp
  __int64 *v19; // r12
  __int64 v20; // r14
  _DWORD *v21; // r8
  ULONG_PTR v22; // rax
  ULONG_PTR v23; // rbx
  int v25; // eax
  int v26; // eax
  _QWORD *v27; // rsi
  ULONG_PTR v28; // rdx
  ULONG_PTR v29; // rcx
  ULONG_PTR v30; // rdi
  int v31; // eax
  ULONG_PTR *v32; // rsi
  __int64 v33; // r12
  ULONG_PTR v34; // rax
  ULONG_PTR *v35; // r14
  ULONG_PTR v36; // rcx
  int v37; // eax
  __int64 v38; // [rsp+28h] [rbp-60h]
  __int64 v39; // [rsp+38h] [rbp-50h]
  __int64 v40; // [rsp+38h] [rbp-50h]
  ULONG_PTR **v41; // [rsp+48h] [rbp-40h]
  ULONG_PTR BugCheckParameter1; // [rsp+90h] [rbp+8h] BYREF
  _DWORD *v43; // [rsp+A0h] [rbp+18h]
  unsigned int v44; // [rsp+A8h] [rbp+20h]

  v44 = a4;
  v43 = a3;
  BugCheckParameter1 = 0i64;
  v11 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148[1].AttachedDevice) & 2) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 5u )
    {
      sub_11008((__int64)off_60148[1].DriverObject, 0x24u, (__int64)&unk_5CD48);
      v11 = off_60148;
    }
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v11[1].AttachedDevice) & 2) != 0
      && BYTE1(v11[1].AttachedDevice) >= 5u )
    {
      sub_11230((__int64)v11[1].DriverObject, 0x25u, (__int64)&unk_5CD48, a3, a4);
      v11 = off_60148;
    }
  }
  v12 = (_DWORD *)a8;
  v13 = *(_QWORD *)(a1 + 16);
  v14 = 0;
  *(_DWORD *)a8 = 0;
  if ( v11 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v11->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v11->AlignmentRequirement, 0x19Au, (__int64)&unk_5CCA8);
  }
  v15 = sub_42C74(v13, 3);
  if ( v15 )
  {
    sub_45100((__int64)v15, &a8);
    if ( (a8 & 2) != 0 && (a8 & 0x10) == 0 )
    {
      v16 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x19Bu, (__int64)&unk_5CCA8);
        v16 = off_60148;
      }
      v14 = 1;
      goto LABEL_26;
    }
LABEL_25:
    v16 = off_60148;
    goto LABEL_26;
  }
  v16 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    goto LABEL_64;
  if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x19Cu, (__int64)&unk_5CCA8);
    goto LABEL_25;
  }
LABEL_26:
  if ( v16 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v16->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v16->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v16->AlignmentRequirement, 0x19Du, (__int64)&unk_5CCA8);
  }
  if ( v14 )
  {
    v17 = qword_62240;
    v18 = a6;
    if ( *(_DWORD *)(a1 + 128) == 1 )
      v17 = qword_62238;
    v19 = (__int64 *)a7;
    v20 = a5;
    v21 = v43;
    v41 = a7;
    v39 = a5;
    *a6 = v17;
    v22 = sub_37730(a1, *v18, v21, (_QWORD *)(a1 + 8), (__int64 (*)(void))sub_398DC, sub_399D4, a4, v39, 1, v41);
    v23 = v22;
    if ( !v22 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
        && BYTE1(off_60148[1].AttachedDevice) >= 3u )
      {
        sub_11008((__int64)off_60148[1].DriverObject, 0x26u, (__int64)&unk_5CD48);
      }
      *v12 = 3;
      return 0i64;
    }
    *(_DWORD *)(v22 + 12) = (*(_DWORD *)(a1 + 128) != 1) + 1;
    v25 = *(_DWORD *)(a1 + 128);
    if ( v25 == 1 && (*(_BYTE *)(a1 + 120) & 0x10) != 0 || v25 == 2 && (*(_BYTE *)(a1 + 120) & 0x10) == 0 )
      v26 = 1;
    else
      v26 = 2;
    *(_DWORD *)(v23 + 16) = v26;
    if ( *(_DWORD *)(a1 + 128) == 2 )
    {
      v27 = (_QWORD *)sub_37730(
                        a1,
                        qword_62238,
                        v43,
                        (_QWORD *)(a1 + 8),
                        (__int64 (*)(void))sub_398DC,
                        sub_399D4,
                        v44,
                        v20,
                        0,
                        (ULONG_PTR **)&BugCheckParameter1);
      if ( !v27 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
          && BYTE1(off_60148[1].AttachedDevice) >= 3u )
        {
          sub_2F80C((__int64)off_60148[1].DriverObject, 0x27u, (__int64)&unk_5CD48, v23);
        }
        v28 = *v19;
        v29 = *v18;
        *v12 = 5;
        sub_56A10(v29, v28);
        return 0i64;
      }
      v40 = a1;
      v30 = BugCheckParameter1;
      v31 = sub_37AF4((_QWORD *)v23, v27, *v19, BugCheckParameter1, qword_62238, qword_62240, 0, v40);
      *v12 = v31;
      if ( v31 )
      {
        sub_56A10(qword_62238, v30);
        sub_56A10(*v18, *v19);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
          && BYTE1(off_60148[1].AttachedDevice) >= 3u )
        {
          LODWORD(v38) = *v12;
          sub_1D878((__int64)off_60148[1].DriverObject, 0x28u, (__int64)&unk_5CD48, v23, v27, v38);
        }
        return 0i64;
      }
      sub_56A10(*v18, v30);
    }
    goto LABEL_59;
  }
LABEL_64:
  v32 = (ULONG_PTR *)a7;
  v33 = a5;
  v34 = sub_37730(a1, qword_62238, a3, (_QWORD *)(a1 + 8), (__int64 (*)(void))sub_398DC, sub_399D4, a4, a5, 0, a7);
  v35 = a6;
  v36 = qword_62238;
  v23 = v34;
  *a6 = qword_62238;
  if ( v34 )
  {
    if ( !*(_QWORD *)(v34 + 20) )
      goto LABEL_59;
    if ( (v37 = *(_DWORD *)(a1 + 128), v37 == 1) && (*(_BYTE *)(a1 + 120) & 0x10) != 0
      || v37 == 2 && (*(_BYTE *)(a1 + 120) & 0x10) == 0 )
    {
      if ( *(_DWORD *)(v23 + 16) == 1 )
        goto LABEL_59;
    }
    if ( (v37 != 1 || (*(_BYTE *)(a1 + 120) & 0x10) == 0)
      && (v37 != 2 || (*(_BYTE *)(a1 + 120) & 0x10) != 0)
      && *(_DWORD *)(v23 + 16) == 2 )
    {
      goto LABEL_59;
    }
    sub_56A10(v36, *v32);
  }
  v23 = sub_37730(
          a1,
          qword_62240,
          v43,
          (_QWORD *)(a1 + 8),
          (__int64 (*)(void))sub_398DC,
          sub_399D4,
          v44,
          v33,
          0,
          (ULONG_PTR **)v32);
  *v35 = qword_62240;
  if ( !v23 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 3u )
    {
      sub_11008((__int64)off_60148[1].DriverObject, 0x29u, (__int64)&unk_5CD48);
    }
    *v12 = 5;
    return 0i64;
  }
LABEL_59:
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x2Au, (__int64)&unk_5CD48);
  }
  return v23;
}
// 396FE: variable 'v38' is possibly undefined

//----- (00000000000398DC) ----------------------------------------------------
_DWORD *sub_398DC()
{
  _DWORD *v0; // rbx
  PDEVICE_OBJECT v1; // rcx

  v0 = sub_3FA7C((__int64)qword_62228);
  v1 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x2Bu, (__int64)&unk_5CD48);
    v1 = off_60148;
  }
  if ( v0 )
  {
    memset(v0, 0, 0xC8ui64);
LABEL_11:
    v1 = off_60148;
    goto LABEL_12;
  }
  if ( v1 == (PDEVICE_OBJECT)&off_60148 )
    return v0;
  if ( (BYTE4(v1[1].AttachedDevice) & 2) != 0 && BYTE1(v1[1].AttachedDevice) >= 2u )
  {
    sub_11008((__int64)v1[1].DriverObject, 0x2Cu, (__int64)&unk_5CD48);
    goto LABEL_11;
  }
LABEL_12:
  if ( v1 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v1[1].AttachedDevice) & 2) != 0 && BYTE1(v1[1].AttachedDevice) >= 5u )
    sub_2F80C((__int64)v1[1].DriverObject, 0x2Du, (__int64)&unk_5CD48, v0);
  return v0;
}

//----- (00000000000399D4) ----------------------------------------------------
void __fastcall sub_399D4(__int64 a1)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_2F80C((__int64)off_60148[1].DriverObject, 0x2Eu, (__int64)&unk_5CD48, a1);
  }
  if ( *(_DWORD *)(a1 + 12) == 1 )
  {
    if ( *(_BYTE *)(a1 + 160) )
    {
      _InterlockedAdd64(&qword_62268, 1ui64);
      _InterlockedAdd(&dword_62250, 0xFFFFFFFF);
      if ( *(_BYTE *)(a1 + 163) )
        _InterlockedAdd(&dword_62258, 0xFFFFFFFF);
    }
  }
  sub_37F20(a1);
  sub_3760C((_QWORD *)a1);
  sub_3FAE4((__int64)qword_62228, a1);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x2Fu, (__int64)&unk_5CD48);
  }
}
// 62250: using guessed type int dword_62250;
// 62258: using guessed type int dword_62258;
// 62268: using guessed type __int64 qword_62268;

//----- (0000000000039AC4) ----------------------------------------------------
__int64 __fastcall sub_39AC4(_QWORD *a1, unsigned __int8 a2, __int64 a3, _BYTE *a4)
{
  _QWORD *v8; // rsi
  _QWORD *v9; // rbp
  PDEVICE_OBJECT v10; // rcx

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_38628(
      (__int64)off_60148[1].DriverObject,
      48i64,
      (__int64)&unk_5CD48,
      a1,
      (__int64)*a1 >> 16,
      *(_DWORD *)a1,
      a2,
      a3);
  }
  *a4 = 0;
  if ( a2 )
  {
    v8 = (_QWORD *)((char *)a1 + 180);
    v9 = a1 + 21;
  }
  else
  {
    v8 = a1 + 21;
    v9 = (_QWORD *)((char *)a1 + 180);
  }
  sub_40598((PFAST_MUTEX)(a1 + 5));
  if ( (*(_BYTE *)(a3 + 8) & 4) != 0 )
  {
    *((_DWORD *)a1 + 48) = 1;
    *a4 = 1;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 5u )
    {
      sub_2F80C((__int64)off_60148[1].DriverObject, 0x31u, (__int64)&unk_5CD48, a3);
    }
    goto LABEL_36;
  }
  if ( (*(_BYTE *)(a3 + 8) & 1) != 0 && !*((_DWORD *)v8 + 2) )
    *((_DWORD *)v8 + 2) = 1;
  if ( (*(_BYTE *)(a3 + 8) & 0x10) != 0 )
  {
    v10 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 5u )
    {
      sub_2F80C((__int64)off_60148[1].DriverObject, 0x34u, (__int64)&unk_5CD48, a3);
      v10 = off_60148;
    }
    if ( *((_DWORD *)v9 + 2) != 1 && *((_DWORD *)v9 + 2) != 2 )
      goto LABEL_25;
    *((_DWORD *)v9 + 2) = 2;
  }
  v10 = off_60148;
LABEL_25:
  if ( *((_DWORD *)v8 + 2) == 2 && *((_DWORD *)v9 + 2) == 2 )
  {
    *((_DWORD *)a1 + 48) = 1;
    v10 = off_60148;
    *a4 = 1;
  }
  if ( *((_BYTE *)a1 + 163) && *(_QWORD *)((char *)a1 + 20) && *((_DWORD *)v8 + 2) == 1 )
  {
    if ( v10 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v10[1].AttachedDevice) & 2) != 0
      && BYTE1(v10[1].AttachedDevice) >= 4u )
    {
      sub_1D3B0((__int64)v10[1].DriverObject, 0x32u, (__int64)&unk_5CD48, *a1, *(_QWORD *)((char *)a1 + 20));
    }
    *((_DWORD *)a1 + 48) = 1;
    *a4 = 1;
  }
LABEL_36:
  sub_40664((PFAST_MUTEX)(a1 + 5));
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11430((__int64)off_60148[1].DriverObject, 0x33u, (__int64)&unk_5CD48, 0);
  }
  return 0i64;
}

//----- (0000000000039D5C) ----------------------------------------------------
__int64 __fastcall sub_39D5C(__int64 a1, __int64 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CD38, 13i64, v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000039DF4) ----------------------------------------------------
__int64 __fastcall sub_39DF4(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int *a5)
{
  unsigned int v5; // edi
  PDEVICE_OBJECT v7; // rcx
  const char *v8; // r9
  __int64 v9; // rbx
  int v10; // ecx
  const char *v11; // rax
  int v12; // eax
  const char *v13; // rax
  const char *v14; // rax
  int v15; // eax
  char v17[8]; // [rsp+30h] [rbp-E8h] BYREF
  __int64 v18; // [rsp+38h] [rbp-E0h]
  __int64 v19; // [rsp+40h] [rbp-D8h]
  __int64 v20; // [rsp+48h] [rbp-D0h]
  __int64 Src[2]; // [rsp+50h] [rbp-C8h] BYREF
  int v22; // [rsp+64h] [rbp-B4h]
  char v23[128]; // [rsp+70h] [rbp-A8h] BYREF

  v5 = 0;
  LODWORD(Src[0]) = 0;
  memset((char *)Src + 4, 0, 0x1Cui64);
  v18 = 0i64;
  v17[0] = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 0x10) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0xAu, (__int64)&unk_5CD38);
  }
  *a5 = 1;
  if ( dword_6544C != 1 )
  {
    v7 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
      return v5;
    if ( (BYTE4(off_60148[1].AttachedDevice) & 0x10) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 4u )
    {
      sub_11008((__int64)off_60148[1].DriverObject, 0xBu, (__int64)&unk_5CD38);
LABEL_10:
      v7 = off_60148;
      goto LABEL_61;
    }
    goto LABEL_61;
  }
  if ( !a2 )
  {
    v7 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 0x10) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 2u )
    {
      sub_11148((__int64)off_60148[1].DriverObject, 0xCu, (__int64)&unk_5CD38, 400);
      v7 = off_60148;
    }
    v5 = 6;
    goto LABEL_61;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 0x10) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    v8 = "Original";
    if ( *(_DWORD *)(a2 + 128) == 2 )
      v8 = "Reinjected";
    sub_39D5C((__int64)off_60148[1].DriverObject, 13i64, (__int64)&unk_5CD38, v8);
  }
  if ( (*(_BYTE *)(a2 + 120) & 8) != 0 )
  {
    v19 = 0i64;
    v9 = 0i64;
    v18 = 0i64;
  }
  else
  {
    v9 = v18;
  }
  if ( dword_622E4 )
  {
    _InterlockedAdd((volatile signed __int32 *)P, 1u);
    v9 = v18;
  }
  v5 = sub_36E78(a2, Src, v17);
  if ( v5 )
  {
    v10 = 3;
    if ( (unsigned int)dword_622E4 > 3 )
    {
      _InterlockedAdd((volatile signed __int32 *)P + 3, 1u);
      v9 = v18;
    }
    if ( v17[0] )
    {
      if ( *(_DWORD *)(a2 + 128) == 2 )
        v10 = 1;
      *a5 = v10;
    }
  }
  else
  {
    if ( (unsigned int)dword_622E4 > 1 )
    {
      _InterlockedAdd((volatile signed __int32 *)P + 1, 1u);
      v9 = v18;
    }
    memmove((void *)(a2 + 312), Src, 0x20ui64);
    v5 = 0;
    if ( (unsigned int)dword_622E4 > 2 )
    {
      _InterlockedAdd((volatile signed __int32 *)P + 2, 1u);
      v9 = v18;
    }
  }
  if ( (*(_BYTE *)(a2 + 120) & 4) == 0 )
    goto LABEL_52;
  if ( v5 )
  {
    v11 = "Other";
    if ( v17[0] )
      v11 = "Passthru";
    sub_587C8(v23, 0x80ui64, "|TLSC-%I64u-W_ALLOW-not colorized-Reason_%s-result: 0x%x|", v9, v11, v5);
  }
  else
  {
    sub_587C8(v23, 0x80ui64, "|TLSC-%I64u-W_ALLOW-session id: %I64u-result: 0x%x|", v9, Src[0], 0);
  }
  v12 = sub_4ED98(a2, v23, strlen(v23));
  if ( v12 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 0x10) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 2u )
    {
      sub_112FC((__int64)off_60148[1].DriverObject, 0xFu, (__int64)&unk_5CD38, v12);
    }
    v13 = sub_4D8C4(v22);
    sub_587C8(v23, 0x80ui64, "|ALPC-%I64u-W_ALLOW-protocol:%s-unable to colorize|", v9, v13);
  }
  else
  {
    v14 = sub_4D8C4(v22);
    sub_587C8(v23, 0x80ui64, "|ALPC-%I64u-W_ALLOW-protocol:%s|", v9, v14);
  }
  v15 = sub_4ED98(a2, v23, strlen(v23));
  v5 = v15;
  if ( !v15 )
    goto LABEL_52;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 0x10) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 2u )
  {
    sub_112FC((__int64)off_60148[1].DriverObject, 0x10u, (__int64)&unk_5CD38, v15);
LABEL_52:
    v7 = off_60148;
  }
  if ( (*(_BYTE *)(a2 + 120) & 8) != 0 )
  {
    v20 = 0i64;
    if ( (unsigned int)dword_622E4 > 0x1B )
    {
      *((_DWORD *)P + 27) = -(int)v9;
      goto LABEL_10;
    }
  }
LABEL_61:
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v7[1].AttachedDevice) & 0x10) != 0
    && BYTE1(v7[1].AttachedDevice) >= 5u )
  {
    sub_112FC((__int64)v7[1].DriverObject, 0x12u, (__int64)&unk_5CD38, v5);
  }
  return v5;
}
// 622E4: using guessed type int dword_622E4;
// 6544C: using guessed type int dword_6544C;

//----- (000000000003A268) ----------------------------------------------------
__int64 __fastcall sub_3A268(__int64 a1, __int64 a2, __int64 a3, __int64 a4, _DWORD *a5)
{
  *a5 = 1;
  return 0i64;
}

//----- (000000000003A27C) ----------------------------------------------------
__int64 __fastcall sub_3A27C(__int64 a1, __int64 *a2)
{
  PDEVICE_OBJECT v3; // r10
  int v4; // ecx
  __int64 v5; // r9
  ULONG_PTR v6; // rsi
  ULONG_PTR v7; // r12
  unsigned __int16 v8; // dx
  unsigned __int64 v9; // rax
  unsigned __int64 v10; // rbp
  __int64 v11; // rax
  _QWORD *v12; // rdi
  __int64 v13; // rax
  _QWORD *v14; // rdi
  unsigned __int16 v15; // dx
  __int64 v17; // [rsp+0h] [rbp-98h] BYREF
  __int64 v18; // [rsp+20h] [rbp-78h]
  __int64 v19; // [rsp+28h] [rbp-70h]
  char Src[104]; // [rsp+30h] [rbp-68h] BYREF
  int v21; // [rsp+A8h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+B8h] [rbp+20h] BYREF

  v21 = 0;
  BugCheckParameter1 = 0i64;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148[1].AttachedDevice) & 4) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 5u )
    {
      sub_11008((__int64)off_60148[1].DriverObject, 0x13u, (__int64)&unk_5CD38);
      v3 = off_60148;
    }
    if ( v3 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v3[1].AttachedDevice) & 4) != 0 && BYTE1(v3[1].AttachedDevice) >= 4u )
    {
      v4 = *((unsigned __int8 *)a2 + 12);
      v5 = *a2;
      LODWORD(v19) = *((_DWORD *)a2 + 2);
      LODWORD(v18) = v4;
      sub_25CAC((__int64)v3[1].DriverObject, 0x14u, (__int64)&unk_5CD38, v5, v18, v19);
      v3 = off_60148;
    }
  }
  if ( !*((_BYTE *)a2 + 12) )
    goto LABEL_45;
  if ( *((_DWORD *)a2 + 2) == 6 )
  {
    v6 = qword_62238;
    v7 = qword_62240;
    if ( v3 == (PDEVICE_OBJECT)&off_60148 || (BYTE4(v3[1].AttachedDevice) & 4) == 0 || BYTE1(v3[1].AttachedDevice) < 4u )
      goto LABEL_21;
    v8 = 21;
LABEL_20:
    sub_2F80C((__int64)v3[1].DriverObject, v8, (__int64)&unk_5CD38, v6);
LABEL_21:
    sub_37674(
      Src,
      0i64,
      (const __m128i *)((char *)a2 + 17),
      (const __m128i *)((char *)a2 + 33),
      *(_WORD *)((char *)a2 + 13),
      *(_WORD *)((char *)a2 + 15));
    v9 = sub_37C68((_DWORD *)&v17 - 12);
    v10 = v9;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 4) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 4u )
    {
      sub_2F80C((__int64)off_60148[1].DriverObject, 0x18u, (__int64)&unk_5CD38, v9);
    }
    v11 = sub_559E0(v6, v10, &BugCheckParameter1, &v21);
    v12 = (_QWORD *)v11;
    if ( !v11 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148[1].AttachedDevice) & 4) != 0
        && BYTE1(off_60148[1].AttachedDevice) >= 3u )
      {
        sub_112FC((__int64)off_60148[1].DriverObject, 0x1Au, (__int64)&unk_5CD38, v21);
      }
      return 0i64;
    }
    *(_BYTE *)(v11 + 163) = *((_BYTE *)a2 + 12);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 4) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 4u )
    {
      sub_2F80C((__int64)off_60148[1].DriverObject, 0x19u, (__int64)&unk_5CD38, *(_QWORD *)v11);
    }
    if ( *((_DWORD *)a2 + 2) == 6 )
    {
      _InterlockedAdd(&dword_62258, 1u);
    }
    else if ( *((_DWORD *)a2 + 2) == 17 )
    {
      _InterlockedAdd(&dword_6225C, 1u);
    }
    sub_37DB0(v12, 1);
    sub_56A10(v6, BugCheckParameter1);
    v13 = sub_559E0(v7, v10, &BugCheckParameter1, &v21);
    v14 = (_QWORD *)v13;
    if ( v13 )
    {
      *(_BYTE *)(v13 + 163) = *((_BYTE *)a2 + 12);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148[1].AttachedDevice) & 4) != 0
        && BYTE1(off_60148[1].AttachedDevice) >= 4u )
      {
        sub_2F80C((__int64)off_60148[1].DriverObject, 0x1Bu, (__int64)&unk_5CD38, *(_QWORD *)v13);
      }
      sub_37DB0(v14, 1);
      sub_56A10(v7, BugCheckParameter1);
    }
    else
    {
      v3 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return 0i64;
      if ( (BYTE4(off_60148[1].AttachedDevice) & 4) == 0 || BYTE1(off_60148[1].AttachedDevice) < 3u )
        goto LABEL_45;
      sub_112FC((__int64)off_60148[1].DriverObject, 0x1Cu, (__int64)&unk_5CD38, v21);
    }
    v3 = off_60148;
LABEL_45:
    if ( v3 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v3[1].AttachedDevice) & 4) != 0 && BYTE1(v3[1].AttachedDevice) >= 5u )
    {
      v15 = 29;
LABEL_49:
      sub_11008((__int64)v3[1].DriverObject, v15, (__int64)&unk_5CD38);
      return 0i64;
    }
    return 0i64;
  }
  if ( *((_DWORD *)a2 + 2) == 17 )
  {
    v6 = qword_62298;
    v7 = qword_622A0;
    if ( v3 == (PDEVICE_OBJECT)&off_60148 || (BYTE4(v3[1].AttachedDevice) & 4) == 0 || BYTE1(v3[1].AttachedDevice) < 4u )
      goto LABEL_21;
    v8 = 22;
    goto LABEL_20;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v3[1].AttachedDevice) & 4) != 0 && BYTE1(v3[1].AttachedDevice) >= 5u )
  {
    v15 = 23;
    goto LABEL_49;
  }
  return 0i64;
}
// 62258: using guessed type int dword_62258;
// 6225C: using guessed type int dword_6225C;

//----- (000000000003A628) ----------------------------------------------------
__int64 sub_3A628()
{
  unsigned int v0; // ebx
  PDEVICE_OBJECT v1; // rcx
  int v3; // edi

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x22u, (__int64)&unk_5CD38);
  }
  sub_4D74C(28, (__int64)aTlscreceivedpa);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0xAu, (__int64)&unk_5CD58);
  }
  byte_62221 = 0;
  v0 = sub_386AC((__int64)&qword_621F0, (__int64)&qword_621F8);
  if ( !v0 )
  {
    byte_61437 = 1;
    v0 = sub_3ACB8((__int64)&qword_62200, (__int64)&qword_62208);
    if ( !v0 )
    {
      byte_62220 = 1;
      if ( sub_402A4((struct _KEVENT **)&qword_62210, 0) && sub_40730(&Object, (__int64)sub_38174, (__int64)qword_62210) )
        goto LABEL_20;
      v0 = 1;
    }
  }
  if ( qword_62210 )
  {
    sub_4031C(qword_62210);
    qword_62210 = 0i64;
  }
  if ( byte_62220 )
  {
    sub_3B040();
    byte_62220 = 0;
  }
  if ( byte_61437 )
  {
    sub_38A90();
    byte_61437 = 0;
  }
LABEL_20:
  v1 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_112FC((__int64)off_60148[1].DriverObject, 0xBu, (__int64)&unk_5CD58, v0);
    v1 = off_60148;
  }
  if ( !v0 )
  {
    if ( !byte_65450 )
    {
      if ( v1 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v1[1].AttachedDevice) & 1) != 0 && BYTE1(v1[1].AttachedDevice) )
      {
        sub_11008((__int64)v1[1].DriverObject, 0x24u, (__int64)&unk_5CD38);
        v1 = off_60148;
      }
      v0 = 19;
      goto LABEL_30;
    }
    v3 = (unsigned __int8)byte_65450;
    qword_62248 = (PVOID)sub_40820((unsigned __int8)byte_65450);
    if ( !qword_62248 )
    {
      v1 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
        && BYTE1(off_60148[1].AttachedDevice) )
      {
        sub_112FC((__int64)off_60148[1].DriverObject, 0x25u, (__int64)&unk_5CD38, v3);
        v1 = off_60148;
      }
      v0 = 3;
      goto LABEL_30;
    }
    goto LABEL_29;
  }
  if ( v1 == (PDEVICE_OBJECT)&off_60148 )
    return v0;
  if ( (BYTE4(v1[1].AttachedDevice) & 1) != 0 && BYTE1(v1[1].AttachedDevice) )
  {
    sub_112FC((__int64)v1[1].DriverObject, 0x23u, (__int64)&unk_5CD38, v0);
LABEL_29:
    v1 = off_60148;
  }
LABEL_30:
  if ( v1 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v1[1].AttachedDevice) & 1) != 0 && BYTE1(v1[1].AttachedDevice) >= 5u )
    sub_112FC((__int64)v1[1].DriverObject, 0x26u, (__int64)&unk_5CD38, v0);
  return v0;
}
// 60190: using guessed type wchar_t aTlscreceivedpa[20];
// 61437: using guessed type char byte_61437;
// 62220: using guessed type char byte_62220;
// 62221: using guessed type char byte_62221;
// 65450: using guessed type char byte_65450;

//----- (000000000003A928) ----------------------------------------------------
__int64 sub_3A928()
{
  PDEVICE_OBJECT v0; // rcx

  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148[1].AttachedDevice) & 1) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 5u )
    {
      sub_11008((__int64)off_60148[1].DriverObject, 0x27u, (__int64)&unk_5CD38);
      v0 = off_60148;
    }
    if ( v0 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v0[1].AttachedDevice) & 1) != 0 && BYTE1(v0[1].AttachedDevice) >= 5u )
    {
      sub_11008((__int64)v0[1].DriverObject, 0xCu, (__int64)&unk_5CD58);
      v0 = off_60148;
    }
  }
  byte_62221 = 1;
  if ( Object )
  {
    sub_40384((PRKEVENT)qword_62210);
    sub_40B60(Object, 0xFFFFFFFF);
    sub_407B8(Object);
    Object = 0i64;
    v0 = off_60148;
  }
  if ( qword_62210 )
  {
    sub_4031C(qword_62210);
    qword_62210 = 0i64;
    v0 = off_60148;
  }
  if ( byte_62220 )
  {
    sub_3B040();
    v0 = off_60148;
    byte_62220 = 0;
  }
  if ( byte_61437 )
  {
    sub_38A90();
    v0 = off_60148;
    byte_61437 = 0;
  }
  if ( v0 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v0[1].AttachedDevice) & 1) != 0 && BYTE1(v0[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)v0[1].DriverObject, 0xDu, (__int64)&unk_5CD58);
    v0 = off_60148;
  }
  if ( qword_62248 )
  {
    sub_408F0(qword_62248);
    v0 = off_60148;
  }
  if ( P )
  {
    sub_3F6F0(P, 0x72746E63u);
    P = 0i64;
    v0 = off_60148;
  }
  if ( v0 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v0[1].AttachedDevice) & 1) != 0 && BYTE1(v0[1].AttachedDevice) >= 5u )
    sub_11008((__int64)v0[1].DriverObject, 0x28u, (__int64)&unk_5CD38);
  return 0i64;
}
// 61437: using guessed type char byte_61437;
// 62220: using guessed type char byte_62220;
// 62221: using guessed type char byte_62221;

//----- (000000000003AB3C) ----------------------------------------------------
__int64 __fastcall sub_3AB3C(int a1, __int64 a2, int a3, _DWORD *a4, void **a5, _DWORD *a6)
{
  PDEVICE_OBJECT v9; // rcx
  __int64 result; // rax
  PVOID v11; // rax

  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 0x10) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_112FC((__int64)off_60148[1].DriverObject, 0x29u, (__int64)&unk_5CD38, a1);
    v9 = off_60148;
  }
  if ( a3 == 64 )
  {
    v11 = sub_3F66C(2, 0x40u, 0x64446C54u);
    *a5 = v11;
    if ( v11 )
    {
      *a4 = 64;
      *a6 = 1682205780;
      memmove(*a5, &dword_62250, 0x40ui64);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148[1].AttachedDevice) & 0x10) != 0
        && BYTE1(off_60148[1].AttachedDevice) >= 5u )
      {
        sub_11008((__int64)off_60148[1].DriverObject, 0x2Cu, (__int64)&unk_5CD38);
      }
      result = 0i64;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148[1].AttachedDevice) & 0x10) != 0
        && BYTE1(off_60148[1].AttachedDevice) >= 2u )
      {
        sub_11008((__int64)off_60148[1].DriverObject, 0x2Bu, (__int64)&unk_5CD38);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v9[1].AttachedDevice) & 0x10) != 0
      && BYTE1(v9[1].AttachedDevice) >= 2u )
    {
      sub_112FC((__int64)v9[1].DriverObject, 0x2Au, (__int64)&unk_5CD38, a3);
    }
    result = 6i64;
  }
  return result;
}
// 62250: using guessed type int dword_62250;

//----- (000000000003ACB8) ----------------------------------------------------
__int64 __fastcall sub_3ACB8(__int64 a1, __int64 a2)
{
  unsigned int v2; // ebx
  PDEVICE_OBJECT v3; // rcx
  _DWORD *v4; // rax
  _DWORD *v5; // r8
  int v6; // eax
  int v7; // eax
  int v9; // [rsp+88h] [rbp+10h] BYREF
  int v10; // [rsp+8Ch] [rbp+14h]

  v10 = HIDWORD(a2);
  v2 = 0;
  v9 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0xAu, (__int64)&unk_5CD28);
  }
  qword_62200 = 0i64;
  qword_62208 = 0i64;
  qword_62290 = sub_3F8D8(2, 0xA8u, 0x75736C54u);
  if ( !qword_62290 )
  {
    v3 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148[1].AttachedDevice) & 1) == 0
      || BYTE1(off_60148[1].AttachedDevice) < 2u )
    {
      goto LABEL_22;
    }
    sub_11008((__int64)off_60148[1].DriverObject, 0xBu, (__int64)&unk_5CD28);
LABEL_21:
    v3 = off_60148;
LABEL_22:
    v5 = (_DWORD *)qword_622A0;
LABEL_23:
    v4 = (_DWORD *)qword_62298;
    goto LABEL_24;
  }
  v4 = sub_53288(11, 0, 1, 0x75736C54u, qword_65470, 2, (__int64)sub_37C68, 0i64, (__int64)sub_3B844, 0i64, &v9);
  qword_62298 = (ULONG_PTR)v4;
  if ( v4 )
  {
    v5 = sub_53288(11, 0, 1, 0x75736C54u, qword_65470, 2, (__int64)sub_37C68, 0i64, (__int64)sub_3B844, 0i64, &v9);
    qword_622A0 = (ULONG_PTR)v5;
    if ( v5 )
    {
      qword_62208 = (ULONG_PTR)v5;
      qword_62200 = qword_62298;
      goto LABEL_43;
    }
    v3 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148[1].AttachedDevice) & 1) == 0
      || BYTE1(off_60148[1].AttachedDevice) < 2u )
    {
      goto LABEL_23;
    }
    sub_112FC((__int64)off_60148[1].DriverObject, 0xDu, (__int64)&unk_5CD28, v9);
    goto LABEL_21;
  }
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 2u )
  {
    sub_112FC((__int64)off_60148[1].DriverObject, 0xCu, (__int64)&unk_5CD28, v9);
    v3 = off_60148;
    v4 = (_DWORD *)qword_62298;
  }
  v5 = (_DWORD *)qword_622A0;
LABEL_24:
  v2 = 3;
  if ( !v4 )
    goto LABEL_32;
  v6 = sub_53950((ULONG_PTR)v4, 1);
  if ( v6 )
  {
    v3 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148[1].AttachedDevice) & 1) == 0
      || BYTE1(off_60148[1].AttachedDevice) < 2u )
    {
      goto LABEL_31;
    }
    sub_112FC((__int64)off_60148[1].DriverObject, 0xEu, (__int64)&unk_5CD28, v6);
  }
  v3 = off_60148;
LABEL_31:
  v5 = (_DWORD *)qword_622A0;
  qword_62298 = 0i64;
LABEL_32:
  if ( !v5 )
    goto LABEL_40;
  v7 = sub_53950((ULONG_PTR)v5, 1);
  if ( v7 )
  {
    v3 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148[1].AttachedDevice) & 1) == 0
      || BYTE1(off_60148[1].AttachedDevice) < 2u )
    {
      goto LABEL_39;
    }
    sub_112FC((__int64)off_60148[1].DriverObject, 0xFu, (__int64)&unk_5CD28, v7);
  }
  v3 = off_60148;
LABEL_39:
  qword_622A0 = 0i64;
LABEL_40:
  if ( qword_62290 )
  {
    sub_3F95C(qword_62290);
    qword_62290 = 0i64;
LABEL_43:
    v3 = off_60148;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v3[1].AttachedDevice) & 1) != 0 && BYTE1(v3[1].AttachedDevice) >= 5u )
    sub_112FC((__int64)v3[1].DriverObject, 0x10u, (__int64)&unk_5CD28, v2);
  return v2;
}
// 65470: using guessed type __int64 qword_65470;

//----- (000000000003B040) ----------------------------------------------------
void sub_3B040()
{
  PDEVICE_OBJECT v0; // rcx
  int v1; // eax
  int v2; // eax

  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 1) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x11u, (__int64)&unk_5CD28);
    v0 = off_60148;
  }
  if ( qword_62298 )
  {
    v1 = sub_53950(qword_62298, 1);
    if ( v1 )
    {
      v0 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148[1].AttachedDevice) & 1) == 0
        || BYTE1(off_60148[1].AttachedDevice) < 2u )
      {
        goto LABEL_12;
      }
      sub_112FC((__int64)off_60148[1].DriverObject, 0x12u, (__int64)&unk_5CD28, v1);
    }
    v0 = off_60148;
LABEL_12:
    qword_62298 = 0i64;
  }
  if ( !qword_622A0 )
    goto LABEL_21;
  v2 = sub_53950(qword_622A0, 1);
  if ( v2 )
  {
    v0 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148[1].AttachedDevice) & 1) == 0
      || BYTE1(off_60148[1].AttachedDevice) < 2u )
    {
      goto LABEL_20;
    }
    sub_112FC((__int64)off_60148[1].DriverObject, 0x13u, (__int64)&unk_5CD28, v2);
  }
  v0 = off_60148;
LABEL_20:
  qword_622A0 = 0i64;
LABEL_21:
  if ( qword_62290 )
  {
    sub_3F95C(qword_62290);
    qword_62290 = 0i64;
    v0 = off_60148;
  }
  if ( v0 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v0[1].AttachedDevice) & 1) != 0 && BYTE1(v0[1].AttachedDevice) >= 5u )
    sub_11008((__int64)v0[1].DriverObject, 0x14u, (__int64)&unk_5CD28);
}

//----- (000000000003B1B4) ----------------------------------------------------
__int64 __fastcall sub_3B1B4(__int64 *a1, _WORD *a2, unsigned __int16 a3, const __m128i *a4, const __m128i *a5, __int64 a6, _BYTE *a7)
{
  PDEVICE_OBJECT v11; // rcx
  unsigned int v12; // ebx
  ULONG_PTR v13; // rax
  _QWORD *v14; // rdi
  struct _FAST_MUTEX *v15; // rbx
  __int64 v16; // rcx
  PDEVICE_OBJECT v17; // rcx
  __int64 v18; // rax
  int v19; // eax
  __int64 v21; // [rsp+20h] [rbp-98h]
  unsigned __int16 v22[2]; // [rsp+50h] [rbp-68h] BYREF
  unsigned int v23; // [rsp+54h] [rbp-64h] BYREF
  __int16 v24[2]; // [rsp+58h] [rbp-60h] BYREF
  __int16 v25; // [rsp+5Ch] [rbp-5Ch] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+60h] [rbp-58h] BYREF
  ULONG_PTR BugCheckParameter2; // [rsp+68h] [rbp-50h] BYREF
  __int64 v28; // [rsp+70h] [rbp-48h] BYREF
  _DWORD Src[10]; // [rsp+78h] [rbp-40h] BYREF

  LOBYTE(Src[0]) = 0;
  memset((char *)Src + 1, 0, 0x23ui64);
  BugCheckParameter1 = 0i64;
  BugCheckParameter2 = 0i64;
  v11 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11230((__int64)off_60148[1].DriverObject, 0x15u, (__int64)&unk_5CD28, a2, a3);
    v11 = off_60148;
  }
  if ( !byte_6547C )
  {
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v11[1].AttachedDevice) & 2) != 0
      && BYTE1(v11[1].AttachedDevice) >= 5u )
    {
      sub_11008((__int64)v11[1].DriverObject, 0x16u, (__int64)&unk_5CD28);
      v11 = off_60148;
    }
    v12 = 7;
    goto LABEL_58;
  }
  if ( a3 < 8u )
  {
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v11[1].AttachedDevice) & 2) != 0
      && BYTE1(v11[1].AttachedDevice) >= 3u )
    {
      sub_11430((__int64)v11[1].DriverObject, 0x17u, (__int64)&unk_5CD28, a3);
      v11 = off_60148;
    }
    v12 = 6;
    goto LABEL_58;
  }
  v12 = sub_451B0(a2, v24);
  if ( v12 )
    goto LABEL_57;
  v12 = sub_45274((__int64)a2, &v25);
  v23 = v12;
  if ( v12 )
    goto LABEL_57;
  sub_37674(Src, 0i64, a4, a5, v24[0], v25);
  v13 = sub_3B668(
          (__int64)a1,
          Src,
          (__int64)sub_3B934,
          (__int64)sub_3B844,
          dword_65478,
          qword_65470,
          &BugCheckParameter2,
          &BugCheckParameter1,
          &v23);
  v14 = (_QWORD *)v13;
  if ( v13 )
  {
    v15 = (struct _FAST_MUTEX *)(v13 + 40);
    sub_40598((PFAST_MUTEX)(v13 + 40));
    v14[4] = a1[1];
    sub_40664(v15);
    v16 = a1[2];
    v28 = 0i64;
    v22[0] = 0;
    if ( !(unsigned int)sub_47270(v16, &v28, v22) )
    {
      if ( (a1[15] & 0x10) != 0 )
        v14[18] += v22[0];
      else
        v14[17] += v22[0];
      v17 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148[1].AttachedDevice) & 0x20) == 0
        || BYTE1(off_60148[1].AttachedDevice) < 5u )
      {
LABEL_34:
        if ( dword_65458 )
        {
          if ( *((_BYTE *)v14 + 163) )
          {
            if ( v17 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(v17[1].AttachedDevice) & 4) != 0
              && BYTE1(v17[1].AttachedDevice) >= 4u )
            {
              sub_1D3B0((__int64)v17[1].DriverObject, 0x1Au, (__int64)&unk_5CD28, *a1, *v14);
            }
            *a7 = 1;
            _InterlockedAdd64(&qword_62288, 1ui64);
            v12 = 17;
            goto LABEL_50;
          }
        }
        else
        {
          if ( v17 == (PDEVICE_OBJECT)&off_60148 )
          {
LABEL_49:
            *(_QWORD *)a6 = *v14;
            v18 = *(_QWORD *)((char *)v14 + 20);
            *(_DWORD *)(a6 + 16) = 17;
            v12 = v23;
            *(_QWORD *)(a6 + 8) = v18;
            *(_DWORD *)(a6 + 20) = *((_DWORD *)v14 + 2);
            *(_DWORD *)(a6 + 24) = *((_DWORD *)v14 + 3);
            goto LABEL_50;
          }
          if ( (BYTE4(v17[1].AttachedDevice) & 4) != 0 && BYTE1(v17[1].AttachedDevice) >= 5u )
          {
            sub_11008((__int64)v17[1].DriverObject, 0x1Bu, (__int64)&unk_5CD28);
            v17 = off_60148;
          }
        }
        if ( v17 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v17[1].AttachedDevice) & 4) != 0
          && BYTE1(v17[1].AttachedDevice) >= 4u )
        {
          sub_1D3B0((__int64)v17[1].DriverObject, 0x1Cu, (__int64)&unk_5CD28, *a1, *v14);
        }
        goto LABEL_49;
      }
      sub_385D4((__int64)off_60148[1].DriverObject, 0x19u, (__int64)&unk_5CD28, *v14, v14[17], v14[18]);
    }
    v17 = off_60148;
    goto LABEL_34;
  }
  v11 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148
    || (BYTE4(off_60148[1].AttachedDevice) & 2) == 0
    || BYTE1(off_60148[1].AttachedDevice) < 5u )
  {
    v12 = v23;
    goto LABEL_51;
  }
  v12 = v23;
  v21 = *a1;
  sub_491C0((__int64)off_60148[1].DriverObject, 0x18u, (__int64)&unk_5CD28, v23);
LABEL_50:
  v11 = off_60148;
LABEL_51:
  if ( v14 )
  {
    v19 = sub_56A10(BugCheckParameter2, BugCheckParameter1);
    if ( !v19 )
    {
LABEL_57:
      v11 = off_60148;
      goto LABEL_58;
    }
    v11 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
      return v12;
    if ( (BYTE4(off_60148[1].AttachedDevice) & 2) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 2u )
    {
      LODWORD(v21) = v19;
      sub_11230((__int64)off_60148[1].DriverObject, 0x1Du, (__int64)&unk_5CD28, *v14, v21);
      goto LABEL_57;
    }
  }
LABEL_58:
  if ( v11 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v11[1].AttachedDevice) & 2) != 0
    && BYTE1(v11[1].AttachedDevice) >= 5u )
  {
    sub_112FC((__int64)v11[1].DriverObject, 0x1Eu, (__int64)&unk_5CD28, v12);
  }
  return v12;
}
// 3B603: variable 'v21' is possibly undefined
// 62288: using guessed type __int64 qword_62288;
// 65458: using guessed type int dword_65458;
// 65470: using guessed type __int64 qword_65470;
// 65478: using guessed type int dword_65478;
// 6547C: using guessed type char byte_6547C;

//----- (000000000003B668) ----------------------------------------------------
ULONG_PTR __fastcall sub_3B668(__int64 a1, _DWORD *a2, __int64 a3, __int64 a4, unsigned int a5, __int64 a6, _QWORD *a7, _QWORD *a8, _DWORD *a9)
{
  PDEVICE_OBJECT v11; // rcx
  unsigned int v12; // er12
  _DWORD *v13; // rsi
  ULONG_PTR v14; // rdx
  int v15; // ebx
  ULONG_PTR v16; // rax
  ULONG_PTR v17; // r11
  ULONG_PTR result; // rax
  bool v19; // zf
  int v20; // eax
  ULONG_PTR *v21; // [rsp+70h] [rbp+8h] BYREF

  v21 = 0i64;
  v11 = off_60148;
  v12 = a5;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148[1].AttachedDevice) & 2) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 5u )
    {
      sub_11008((__int64)off_60148[1].DriverObject, 0x1Fu, (__int64)&unk_5CD28);
      v11 = off_60148;
    }
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v11[1].AttachedDevice) & 2) != 0
      && BYTE1(v11[1].AttachedDevice) >= 5u )
    {
      sub_1D878((__int64)v11[1].DriverObject, 0x20u, (__int64)&unk_5CD28, a2, sub_3B934, v12);
    }
  }
  v13 = a9;
  v14 = qword_62298;
  *a9 = 0;
  v15 = 1;
  v16 = sub_37730(a1, v14, a2, (_QWORD *)(a1 + 8), (__int64 (*)(void))sub_3B934, sub_3B844, v12, a6, 1, &v21);
  v17 = v16;
  if ( v16 )
  {
    v19 = *(_DWORD *)(v16 + 12) == 0;
    *a8 = v21;
    *a7 = qword_62298;
    if ( v19 && *(_DWORD *)(a1 + 128) == 1 )
      *(_DWORD *)(v16 + 12) = 1;
    v20 = *(_DWORD *)(a1 + 128);
    if ( (v20 != 1 || (*(_BYTE *)(a1 + 120) & 0x10) == 0) && (v20 != 2 || (*(_BYTE *)(a1 + 120) & 0x10) != 0) )
      v15 = 2;
    *(_DWORD *)(v17 + 16) = v15;
    result = v17;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
      && BYTE1(off_60148[1].AttachedDevice) >= 2u )
    {
      sub_11008((__int64)off_60148[1].DriverObject, 0x21u, (__int64)&unk_5CD28);
    }
    *v13 = 3;
    result = 0i64;
  }
  return result;
}

//----- (000000000003B844) ----------------------------------------------------
void __fastcall sub_3B844(__int64 a1)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_2F80C((__int64)off_60148[1].DriverObject, 0x23u, (__int64)&unk_5CD28, a1);
  }
  if ( *(_DWORD *)(a1 + 12) == 1 )
  {
    if ( *(_BYTE *)(a1 + 160) )
    {
      _InterlockedAdd64(&qword_62278, 1ui64);
      _InterlockedAdd(&dword_62254, 0xFFFFFFFF);
      if ( *(_BYTE *)(a1 + 163) )
        _InterlockedAdd(&dword_6225C, 0xFFFFFFFF);
    }
  }
  sub_37F20(a1);
  sub_3760C((_QWORD *)a1);
  sub_3FAE4((__int64)qword_62290, a1);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
    && BYTE1(off_60148[1].AttachedDevice) >= 5u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x24u, (__int64)&unk_5CD28);
  }
}
// 62254: using guessed type int dword_62254;
// 6225C: using guessed type int dword_6225C;
// 62278: using guessed type __int64 qword_62278;

//----- (000000000003B934) ----------------------------------------------------
_DWORD *sub_3B934()
{
  _DWORD *v0; // rax
  _DWORD *v1; // rbx

  v0 = sub_3FA7C((__int64)qword_62290);
  v1 = v0;
  if ( v0 )
  {
    memset(v0, 0, 0xA8ui64);
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && (BYTE4(off_60148[1].AttachedDevice) & 2) != 0
         && BYTE1(off_60148[1].AttachedDevice) >= 2u )
  {
    sub_11008((__int64)off_60148[1].DriverObject, 0x25u, (__int64)&unk_5CD28);
  }
  return v1;
}

//----- (000000000003B9B4) ----------------------------------------------------
__int64 __fastcall sub_3B9B4(__int64 *a1, char *a2, unsigned __int16 a3, __int64 a4, int a5, _QWORD *a6)
{
  unsigned int v6; // edi
  PDEVICE_OBJECT v9; // rcx
  char v10; // al
  _BYTE *v11; // rax
  __int64 v12; // rbx
  _WORD *v13; // rax
  _QWORD *v14; // rbx
  unsigned int v15; // eax
  _WORD *v16; // rax
  char v18; // [rsp+40h] [rbp-38h] BYREF
  char v19; // [rsp+41h] [rbp-37h] BYREF
  char v20[6]; // [rsp+42h] [rbp-36h] BYREF
  __int64 v21; // [rsp+48h] [rbp-30h] BYREF
  __m128i v22; // [rsp+50h] [rbp-28h] BYREF
  __m128i v23; // [rsp+60h] [rbp-18h] BYREF
  char v24; // [rsp+88h] [rbp+10h] BYREF

  v6 = 0;
  v20[0] = 0;
  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148[1].AttachedDevice) & 2) != 0 && BYTE1(off_60148[1].AttachedDevice) >= 5u )
    {
      sub_11230((__int64)off_60148[1].DriverObject, 0xAu, (__int64)&unk_5CD18, a2, a3);
      v9 = off_60148;
    }
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v9->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_1D3B0(*(_QWORD *)&v9->AlignmentRequirement, 0xBBu, (__int64)&unk_5CCA8, a2, &v19);
      v9 = off_60148;
    }
  }
  v19 = *a2;
  if ( v9 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(v9->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0 && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&v9->AlignmentRequirement, 0xBCu, (__int64)&unk_5CCA8);
      v9 = off_60148;
    }
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v9->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_1D3B0(*(_QWORD *)&v9->AlignmentRequirement, 0xBDu, (__int64)&unk_5CCA8, a2, &v18);
      v9 = off_60148;
    }
  }
  v10 = a2[1];
  v18 = v10;
  if ( v9 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v9->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v9->AlignmentRequirement, 0xBEu, (__int64)&unk_5CCA8);
    v10 = v18;
    v9 = off_60148;
  }
  if ( v19 == 3 && v10 == 4 )
  {
    v21 = 0i64;
    sub_45338((__int64)a2, &v21);
    v11 = sub_42C74(v21, 2048);
    v12 = (__int64)v11;
    if ( v11 )
    {
      v24 = 0;
      sub_43F40((__int64)v11, &v24);
      if ( v24 == 6 || v24 == 17 )
      {
        sub_43FF0(v12, &v23);
        sub_440A0(v12, &v22);
        if ( v24 == 6 )
        {
          v13 = sub_42C74(v21, 3);
          v14 = a6;
          v15 = sub_38C30(a1, v13, 8u, &v23, &v22, a6, v20);
          goto LABEL_30;
        }
        if ( v24 == 17 )
        {
          v16 = sub_42C74(v21, 4);
          v14 = a6;
          v15 = sub_3B1B4(a1, v16, 8u, &v23, &v22, (__int64)a6, v20);
LABEL_30:
          v6 = v15;
          if ( !v15 )
            *((_DWORD *)v14 + 4) = 1;
          goto LABEL_32;
        }
      }
    }
LABEL_32:
    v9 = off_60148;
  }
  if ( v9 != (PDEVICE_OBJECT)&off_60148 && (BYTE4(v9[1].AttachedDevice) & 2) != 0 && BYTE1(v9[1].AttachedDevice) >= 5u )
    sub_112FC((__int64)v9[1].DriverObject, 0xBu, (__int64)&unk_5CD18, v6);
  return v6;
}

//----- (000000000003BCB4) ----------------------------------------------------
__int64 __fastcall sub_3BCB4(__int64 a1, __int64 a2, int *a3)
{
  char v5; // r12
  int v6; // edi
  PDEVICE_OBJECT v7; // rcx
  _WORD *v8; // rbx
  _WORD *v9; // rbx
  unsigned int v10; // ebx
  char v12; // [rsp+80h] [rbp+8h] BYREF
  __int64 v13; // [rsp+88h] [rbp+10h]
  __int16 v14; // [rsp+90h] [rbp+18h] BYREF
  unsigned __int16 v15; // [rsp+98h] [rbp+20h] BYREF

  v13 = a2;
  v5 = 0;
  v12 = 0;
  v15 = 0;
  v14 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
    && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148[1].DeviceType, 0xAu, (__int64)&unk_5CD08);
  }
  *a3 = 0;
  v6 = 0;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
    && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148[1].DeviceType, 0x24u, (__int64)&unk_5CD08);
    v7 = off_60148;
  }
  v8 = *(_WORD **)(a1 + 56);
  if ( v8 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v7[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
      && BYTE1(v7[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
    {
      sub_11008(*(_QWORD *)&v7[1].DeviceType, 0x25u, (__int64)&unk_5CD08);
    }
    sub_44EC8(v8, &v15);
    sub_44F8C((__int64)v8, &v14);
    v6 = 1;
LABEL_21:
    v7 = off_60148;
    goto LABEL_22;
  }
  v9 = *(_WORD **)(a1 + 64);
  if ( v9 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v7[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
      && BYTE1(v7[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
    {
      sub_11008(*(_QWORD *)&v7[1].DeviceType, 0x26u, (__int64)&unk_5CD08);
    }
    sub_44EC8(v9, &v15);
    sub_44F8C((__int64)v9, &v14);
    v6 = 2;
    goto LABEL_21;
  }
LABEL_22:
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v7[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
    && BYTE1(v7[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v7[1].DeviceType, 0x27u, (__int64)&unk_5CD08);
    v7 = off_60148;
  }
  if ( v6 )
  {
    v10 = sub_3C08C(v15, v14, a3);
    if ( v10
      && off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
      && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148[1].DeviceType, 0xCu, (__int64)&unk_5CD08);
    }
    if ( (unsigned __int8)sub_502CC(0x200A063u) )
    {
      sub_3C448(a1, &v12);
      v5 = v12;
    }
    if ( (unsigned __int8)sub_502CC(0x200A064u) && !*a3 )
      sub_3C6D8(v15, v14, v5, a3);
    if ( v5 )
    {
      if ( *a3 == 4 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x20) != 0
          && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 4u )
        {
          sub_2F80C(*(_QWORD *)&off_60148[1].DeviceType, 0xEu, (__int64)&unk_5CD08, v13);
        }
        *(_DWORD *)(a1 + 120) |= 0x200u;
      }
    }
    else if ( *a3 == 4 || *a3 == 5 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
        && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 4u )
      {
        sub_2F80C(*(_QWORD *)&off_60148[1].DeviceType, 0xDu, (__int64)&unk_5CD08, v13);
      }
      *(_DWORD *)(a1 + 120) |= 0x2000u;
    }
    v7 = off_60148;
  }
  else
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v7[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
      && BYTE1(v7[1].Queue.Wcb.DmaWaitEntry.Blink) >= 3u )
    {
      sub_11008(*(_QWORD *)&v7[1].DeviceType, 0xBu, (__int64)&unk_5CD08);
      v7 = off_60148;
    }
    v10 = 18;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(v7[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0 && BYTE1(v7[1].Queue.Wcb.DmaWaitEntry.Blink) >= 4u )
    {
      sub_11148(*(_QWORD *)&v7[1].DeviceType, 0xFu, (__int64)&unk_5CD08, *a3);
      v7 = off_60148;
    }
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v7[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
      && BYTE1(v7[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
    {
      sub_11008(*(_QWORD *)&v7[1].DeviceType, 0x10u, (__int64)&unk_5CD08);
    }
  }
  return v10;
}

//----- (000000000003C08C) ----------------------------------------------------
__int64 __fastcall sub_3C08C(unsigned __int16 a1, __int16 a2, int *a3)
{
  PDEVICE_OBJECT v6; // rcx
  __int64 result; // rax

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
    && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148[1].DeviceType, 0x11u, (__int64)&unk_5CD08);
    v6 = off_60148;
  }
  if ( a3 )
  {
    *a3 = 0;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
      && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
    {
      sub_11430(*(_QWORD *)&off_60148[1].DeviceType, 0x13u, (__int64)&unk_5CD08, a1);
    }
    if ( sub_3C2D8(4, a1, a2) )
    {
      *a3 = 4;
    }
    else if ( sub_3C2D8(5, a1, a2) )
    {
      *a3 = 5;
    }
    else if ( sub_3C2D8(2, a1, a2) )
    {
      *a3 = 2;
    }
    else if ( sub_3C2D8(3, a1, a2) )
    {
      *a3 = 3;
    }
    else if ( sub_3C2D8(7, a1, a2) )
    {
      *a3 = 7;
    }
    else if ( sub_3C2D8(8, a1, a2) )
    {
      *a3 = 8;
    }
    else if ( sub_3C2D8(9, a1, a2) )
    {
      *a3 = 9;
    }
    else if ( sub_3C2D8(10, a1, a2) )
    {
      *a3 = 10;
    }
    else if ( sub_3C2D8(11, a1, a2) )
    {
      *a3 = 11;
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
      && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
    {
      sub_112FC(*(_QWORD *)&off_60148[1].DeviceType, 0x14u, (__int64)&unk_5CD08, *a3);
    }
    result = 5i64;
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v6[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
      && BYTE1(v6[1].Queue.Wcb.DmaWaitEntry.Blink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v6[1].DeviceType, 0x12u, (__int64)&unk_5CD08);
    }
    result = 4i64;
  }
  return result;
}

//----- (000000000003C2D8) ----------------------------------------------------
char __fastcall sub_3C2D8(int a1, __int16 a2, __int16 a3)
{
  __int64 v5; // rbp
  char v6; // bl
  int v7; // er8
  unsigned __int16 *v8; // rax
  PDEVICE_OBJECT v9; // rcx

  v5 = a1;
  v6 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
    && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
  {
    sub_4DE38(*(_QWORD *)&off_60148[1].DeviceType, 0x15u, (__int64)&unk_5CD08, a1);
  }
  if ( _InterlockedCompareExchange(&dword_65080, 1, 1) || (v7 = 0, !word_64EA0[20 * v5 + 18]) )
  {
LABEL_11:
    v9 = off_60148;
  }
  else
  {
    v8 = &word_64EA0[20 * v5 + 2];
    while ( a2 != *v8 && a3 != *v8 )
    {
      ++v7;
      ++v8;
      if ( v7 >= word_64EA0[20 * v5 + 18] )
        goto LABEL_11;
    }
    v9 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
      && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 4u )
    {
      sub_11430(*(_QWORD *)&off_60148[1].DeviceType, 0x16u, (__int64)&unk_5CD08, word_64EA0[20 * v5 + 2 + v7]);
      v9 = off_60148;
    }
    v6 = 1;
  }
  if ( v9 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v9[1].Queue.Wcb.DmaWaitEntry.Blink) & 4) != 0
    && BYTE1(v9[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v9[1].DeviceType, 0x17u, (__int64)&unk_5CD08);
  }
  return v6;
}
// 65080: using guessed type int dword_65080;

//----- (000000000003C448) ----------------------------------------------------
__int64 __fastcall sub_3C448(__int64 a1, _BYTE *a2)
{
  PDEVICE_OBJECT v4; // rcx
  bool v5; // zf
  unsigned __int16 v6; // dx
  int v7; // eax
  unsigned int v8; // ebx
  int v10; // ebx
  _DWORD v11[6]; // [rsp+40h] [rbp-18h] BYREF

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x20) != 0
    && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148[1].DeviceType, 0x18u, (__int64)&unk_5CD08);
    v4 = off_60148;
  }
  v5 = *(_QWORD *)(a1 + 40) == 0i64;
  *a2 = 0;
  if ( v5 )
  {
    if ( v4 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(v4[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x20) == 0
      || BYTE1(v4[1].Queue.Wcb.DmaWaitEntry.Blink) < 5u )
    {
      return 0i64;
    }
    v6 = 25;
LABEL_38:
    sub_11008(*(_QWORD *)&v4[1].DeviceType, v6, (__int64)&unk_5CD08);
    return 0i64;
  }
  if ( (*(_BYTE *)(a1 + 120) & 0x10) == 0 )
  {
    if ( v4 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(v4[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x20) == 0
      || BYTE1(v4[1].Queue.Wcb.DmaWaitEntry.Blink) < 5u )
    {
      return 0i64;
    }
    v6 = 26;
    goto LABEL_38;
  }
  v7 = sub_440A0(*(_QWORD *)(a1 + 40), v11);
  v8 = v7;
  if ( !v7 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x20) != 0
      && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 4u )
    {
      sub_114E4(*(_QWORD *)&off_60148[1].DeviceType, 0x1Cu, (__int64)&unk_5CD08, LOBYTE(v11[0]));
    }
    if ( _InterlockedCompareExchange(&dword_64E94, 1, 1) )
    {
LABEL_33:
      v4 = off_60148;
    }
    else
    {
      v4 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x20) != 0
        && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
      {
        sub_11008(*(_QWORD *)&off_60148[1].DeviceType, 0x1Du, (__int64)&unk_5CD08);
        v4 = off_60148;
      }
      v10 = 0;
      if ( dword_64E90 > 0 )
      {
        while ( !sub_47ADC(4, v11, (__int64)&qword_64E60[2 * v10]) )
        {
          if ( ++v10 >= dword_64E90 )
            goto LABEL_33;
        }
        v4 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x20) != 0
          && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 4u )
        {
          sub_11008(*(_QWORD *)&off_60148[1].DeviceType, 0x1Eu, (__int64)&unk_5CD08);
          v4 = off_60148;
        }
        *a2 = 1;
      }
    }
    if ( v4 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(v4[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x20) == 0
      || BYTE1(v4[1].Queue.Wcb.DmaWaitEntry.Blink) < 5u )
    {
      return 0i64;
    }
    v6 = 31;
    goto LABEL_38;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x20) != 0
    && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 2u )
  {
    sub_112FC(*(_QWORD *)&off_60148[1].DeviceType, 0x1Bu, (__int64)&unk_5CD08, v7);
  }
  return v8;
}
// 64E60: using guessed type __int64 qword_64E60[];
// 64E90: using guessed type int dword_64E90;
// 64E94: using guessed type int dword_64E94;

//----- (000000000003C6D8) ----------------------------------------------------
__int64 __fastcall sub_3C6D8(__int64 a1, unsigned __int16 a2, char a3, _DWORD *a4)
{
  PDEVICE_OBJECT v7; // rcx

  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x40) != 0
    && BYTE1(off_60148[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148[1].DeviceType, 0x20u, (__int64)&unk_5CD08);
    v7 = off_60148;
  }
  if ( !a3 )
    goto LABEL_17;
  if ( a2 >= 0x400u )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v7[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x40) != 0
      && BYTE1(v7[1].Queue.Wcb.DmaWaitEntry.Blink) >= 4u )
    {
      sub_112FC(*(_QWORD *)&v7[1].DeviceType, 0x22u, (__int64)&unk_5CD08, a2);
    }
    *a4 = 4;
    goto LABEL_16;
  }
  if ( v7 == (PDEVICE_OBJECT)&off_60148 )
    return 0i64;
  if ( (BYTE4(v7[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x40) != 0 && BYTE1(v7[1].Queue.Wcb.DmaWaitEntry.Blink) >= 3u )
  {
    sub_112FC(*(_QWORD *)&v7[1].DeviceType, 0x21u, (__int64)&unk_5CD08, a2);
LABEL_16:
    v7 = off_60148;
  }
LABEL_17:
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v7[1].Queue.Wcb.DmaWaitEntry.Blink) & 0x40) != 0
    && BYTE1(v7[1].Queue.Wcb.DmaWaitEntry.Blink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v7[1].DeviceType, 0x23u, (__int64)&unk_5CD08);
  }
  return 0i64;
}

//----- (000000000003C814) ----------------------------------------------------
__int64 __fastcall sub_3C814(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+E8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CCF8, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003C8C4) ----------------------------------------------------
__int64 __fastcall sub_3C8C4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+A8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CCF8, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003C940) ----------------------------------------------------
__int64 sub_3C940(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CCF8, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003C994) ----------------------------------------------------
__int64 sub_3C994(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CCF8, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003C9F4) ----------------------------------------------------
__int64 sub_3C9F4()
{
  __int64 result; // rax
  int v1; // [rsp+70h] [rbp+8h] BYREF

  v1 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0xAu, (__int64)&unk_5CCF8);
  }
  sub_404B8((__int64)&stru_622A8);
  byte_62222 = 1;
  qword_64DB0 = (ULONG_PTR)sub_53288(3, 0, 2, 0x70737241u, 0i64, 1, 0i64, 0i64, (__int64)sub_3CFDC, 0i64, &v1);
  if ( qword_64DB0 )
  {
    sub_3DEC8();
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xCu, (__int64)&unk_5CCF8);
    }
    result = 0i64;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0xBu, (__int64)&unk_5CCF8);
    }
    result = 16i64;
  }
  return result;
}
// 62222: using guessed type char byte_62222;

//----- (000000000003CB34) ----------------------------------------------------
__int64 __fastcall sub_3CB34(unsigned __int8 *a1, ULONG_PTR **a2, _DWORD *a3)
{
  char *v6; // rax
  __int64 v7; // rdi
  unsigned int v9; // er11
  unsigned __int8 *v10; // rcx
  __int64 v11; // rdx
  int v12; // eax
  unsigned __int64 v13; // rbx
  unsigned int v14; // eax
  int v15; // eax
  PDEVICE_OBJECT v16; // rcx
  unsigned int v17; // [rsp+60h] [rbp+18h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x11u, (__int64)&unk_5CCF8);
  }
  *a3 = 0;
  v6 = (char *)sub_3F66C(2, 0x48u, 0x65637241u);
  v7 = (__int64)v6;
  if ( !v6 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x12u, (__int64)&unk_5CCF8);
    }
    *a3 = 3;
    return 0i64;
  }
  sub_588AC(v6 + 24, 0x2Cui64, a1, 0x2Cui64);
  v9 = 0;
  v10 = a1 + 16;
  v11 = 16i64;
  do
  {
    v12 = *v10++;
    v9 = v12 ^ (-2128831035 * v9);
    --v11;
  }
  while ( v11 );
  v13 = v9;
  *(_QWORD *)(v7 + 16) = v9;
  *(_QWORD *)(v7 + 8) = MEMORY[0xFFFFF78000000014];
  sub_40150((_QWORD *)v7);
  v14 = sub_55180(qword_64DB0, v13, v7, a2);
  v17 = v14;
  if ( v14 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_3C940(off_60148->Dpc.ProcessorHistory, 0x13u, (__int64)&unk_5CCF8, *(_QWORD *)(v7 + 16), v14, 0);
    }
    sub_3F6F0((PVOID)v7, 0x65637241u);
    *a3 = 13;
    return 0i64;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
  {
    sub_3C940(
      off_60148->Dpc.ProcessorHistory,
      0x14u,
      (__int64)&unk_5CCF8,
      *(_QWORD *)(v7 + 16),
      *(unsigned int *)(v7 + 32),
      0);
  }
  v15 = sub_55088(qword_64DB0, &v17);
  v16 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x15u, (__int64)&unk_5CCF8, v15);
      v16 = off_60148;
    }
    if ( v16 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v16->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(v16->Dpc.DeferredContext) >= 5u )
    {
      sub_11008(v16->Dpc.ProcessorHistory, 0x16u, (__int64)&unk_5CCF8);
    }
  }
  return v7;
}

//----- (000000000003CDAC) ----------------------------------------------------
__int64 __fastcall sub_3CDAC(unsigned __int64 *a1, ULONG_PTR **a2)
{
  PVOID v4; // rax
  __int64 v5; // rbx
  __int64 result; // rax
  unsigned int v7; // eax
  int v8; // eax
  PDEVICE_OBJECT v9; // rcx
  unsigned int v10; // [rsp+60h] [rbp+18h] BYREF

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x17u, (__int64)&unk_5CCF8);
  }
  v4 = sub_3F66C(2, 0x48u, 0x65637241u);
  v5 = (__int64)v4;
  if ( v4 )
  {
    sub_588AC(v4, 0x48ui64, a1, 0x48ui64);
    sub_40150((_QWORD *)v5);
    v7 = sub_55180(qword_64DB0, a1[2], v5, a2);
    v10 = v7;
    if ( v7 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_3C940(off_60148->Dpc.ProcessorHistory, 0x19u, (__int64)&unk_5CCF8, *(_QWORD *)(v5 + 16), v7, 0);
      }
      sub_3F6F0((PVOID)v5, 0x65637241u);
      result = 13i64;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_3C940(
          off_60148->Dpc.ProcessorHistory,
          0x1Au,
          (__int64)&unk_5CCF8,
          *(_QWORD *)(v5 + 16),
          *(unsigned int *)(v5 + 32),
          0);
      }
      v8 = sub_55088(qword_64DB0, &v10);
      v9 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_112FC(off_60148->Dpc.ProcessorHistory, 0x1Bu, (__int64)&unk_5CCF8, v8);
          v9 = off_60148;
        }
        if ( v9 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v9->Dpc.DeferredContext + 1, 0x18u)
          && BYTE1(v9->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(v9->Dpc.ProcessorHistory, 0x1Cu, (__int64)&unk_5CCF8);
        }
      }
      result = 0i64;
    }
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x18u, (__int64)&unk_5CCF8);
    }
    result = 3i64;
  }
  return result;
}

//----- (000000000003CFDC) ----------------------------------------------------
__int64 __fastcall sub_3CFDC(PVOID P)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x26u, (__int64)&unk_5CCF8);
    v2 = off_60148;
  }
  if ( P )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(v2->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(v2->Dpc.ProcessorHistory, 0x27u, (__int64)&unk_5CCF8);
    }
    sub_3F6F0(P, 0x65637241u);
    v2 = off_60148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(v2->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v2->Dpc.ProcessorHistory, 0x28u, (__int64)&unk_5CCF8);
  }
  return 0i64;
}

//----- (000000000003D0C8) ----------------------------------------------------
__int64 __fastcall sub_3D0C8(ULONG_PTR BugCheckParameter1)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x29u, (__int64)&unk_5CCF8);
  }
  sub_56A10(qword_64DB0, BugCheckParameter1);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Au, (__int64)&unk_5CCF8);
  }
  return 0i64;
}

//----- (000000000003D170) ----------------------------------------------------
__int64 __fastcall sub_3D170(__int64 a1)
{
  unsigned __int16 *v1; // r12
  unsigned int v2; // ebx
  PDEVICE_OBJECT v3; // rcx
  int v5; // eax
  PDEVICE_OBJECT v6; // r14
  unsigned int v7; // er13
  __int16 *v8; // r15
  __int16 *v9; // rsi
  __int16 v10; // cx
  __int16 v11; // r8
  __int16 v12; // dx
  __int16 v13; // r9
  __int16 v14; // bx
  __int16 v15; // si
  __int16 v16; // r12
  __int16 *v17; // rdx
  __int64 v18; // r8
  unsigned int v19; // ecx
  int v20; // eax
  __int64 v21; // rdi
  __int64 v22; // rbx
  PDEVICE_OBJECT v23; // rcx
  int v24; // edi
  __int64 v25; // rax
  __int64 v26; // rdi
  PDEVICE_OBJECT v27; // rcx
  unsigned int v28; // ebp
  unsigned __int16 *v29; // rsi
  unsigned __int16 *v30; // rdi
  __int16 v31; // ax
  int v32; // esi
  PDEVICE_OBJECT v33; // rcx
  KIRQL v34[4]; // [rsp+60h] [rbp-98h] BYREF
  unsigned int v35; // [rsp+64h] [rbp-94h] BYREF
  unsigned int v36; // [rsp+68h] [rbp-90h] BYREF
  __int16 v37; // [rsp+70h] [rbp-88h]
  __int16 v38; // [rsp+78h] [rbp-80h]
  __int16 v39; // [rsp+80h] [rbp-78h]
  __int16 v40; // [rsp+88h] [rbp-70h]
  __int16 v41; // [rsp+90h] [rbp-68h]
  __int16 v42; // [rsp+98h] [rbp-60h]
  __int16 v43; // [rsp+A0h] [rbp-58h]
  __int16 v44; // [rsp+A8h] [rbp-50h]
  ULONG_PTR BugCheckParameter1; // [rsp+B0h] [rbp-48h] BYREF
  unsigned __int16 *v46; // [rsp+B8h] [rbp-40h]

  v1 = (unsigned __int16 *)a1;
  v46 = (unsigned __int16 *)a1;
  v2 = 0;
  BugCheckParameter1 = 0i64;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Bu, (__int64)&unk_5CCF8);
    v3 = off_60148;
  }
  if ( *v1 != 1 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(v3->Dpc.DeferredContext) >= 2u )
    {
      sub_11430(v3->Dpc.ProcessorHistory, 0x2Cu, (__int64)&unk_5CCF8, *v1);
    }
    return 10i64;
  }
  sub_40598(&stru_622A8);
  if ( *(_DWORD *)(v1 + 1) )
    goto LABEL_22;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x2Du, (__int64)&unk_5CCF8);
  }
  v5 = sub_541A0(qword_64DB0);
  if ( !v5 )
  {
LABEL_22:
    v6 = off_60148;
  }
  else
  {
    v6 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x2Eu, (__int64)&unk_5CCF8, v5);
      v6 = off_60148;
    }
    v2 = 1;
  }
  v7 = 0;
  v35 = 0;
  if ( *(_DWORD *)(v1 + 1) )
  {
    v8 = (__int16 *)(v1 + 19);
    while ( 1 )
    {
      v9 = v8 - 14;
      if ( *((_DWORD *)v8 - 4) == 34525 )
      {
        if ( v6 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x18u)
          && BYTE1(v6->Dpc.DeferredContext) >= 4u )
        {
          v10 = *v8;
          v11 = *(v8 - 2);
          v12 = *(v8 - 1);
          v13 = *(v8 - 3);
          v14 = *(v8 - 4);
          v15 = *(v8 - 5);
          v16 = *(v8 - 6);
          v41 = v8[1];
          v40 = v10;
          v39 = v11;
          v43 = v13;
          v42 = v12;
          v37 = v14;
          v44 = v15;
          v7 = v35;
          v38 = v16;
          sub_3C814(v6->Dpc.ProcessorHistory, 0x2Fu, (__int64)&unk_5CCF8, v35);
          v1 = v46;
          v9 = v8 - 14;
LABEL_34:
          v6 = off_60148;
          goto LABEL_35;
        }
      }
      else if ( v6 != (PDEVICE_OBJECT)&off_60148
             && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x18u)
             && BYTE1(v6->Dpc.DeferredContext) >= 4u )
      {
        sub_3C8C4(v6->Dpc.ProcessorHistory, 0x30u, (__int64)&unk_5CCF8, v7);
        goto LABEL_34;
      }
LABEL_35:
      v35 = 0;
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x18u)
        && BYTE1(v6->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v6->Dpc.ProcessorHistory, 0x1Du, (__int64)&unk_5CCF8);
      }
      v17 = v8 - 6;
      v18 = 16i64;
      v19 = 0;
      do
      {
        v20 = *(unsigned __int8 *)v17;
        v17 = (__int16 *)((char *)v17 + 1);
        v19 = v20 ^ (-2128831035 * v19);
        --v18;
      }
      while ( v18 );
      v21 = v19;
      v22 = sub_559E0(qword_64DB0, v19, &BugCheckParameter1, &v35);
      if ( v35 )
      {
        v23 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x1Fu, (__int64)&unk_5CCF8, v21);
          v23 = off_60148;
        }
        v24 = 5;
        v22 = 0i64;
        v36 = 5;
      }
      else
      {
        v23 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
        {
          sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x1Eu, (__int64)&unk_5CCF8, v21);
          v23 = off_60148;
        }
        v24 = 0;
        v36 = 0;
      }
      if ( v23 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v23->Dpc.DeferredContext + 1, 0x18u)
        && BYTE1(v23->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v23->Dpc.ProcessorHistory, 0x20u, (__int64)&unk_5CCF8);
        v23 = off_60148;
      }
      if ( v24 == 5 )
      {
        v25 = sub_3CB34((unsigned __int8 *)v9, (ULONG_PTR **)&BugCheckParameter1, &v36);
        v2 = v36;
        v26 = v25;
        if ( v36 )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
          {
            sub_112FC(off_60148->Dpc.ProcessorHistory, 0x31u, (__int64)&unk_5CCF8, v36);
          }
        }
        else
        {
          v27 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
            && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
          {
            sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x32u, (__int64)&unk_5CCF8, *(_QWORD *)(v25 + 16));
            v27 = off_60148;
          }
          v28 = 0;
          if ( *(_WORD *)(v26 + 56) )
          {
            v29 = (unsigned __int16 *)(v26 + 58);
            do
            {
              if ( v27 != (PDEVICE_OBJECT)&off_60148
                && _bittest((const signed __int32 *)&v27->Dpc.DeferredContext + 1, 0x18u)
                && BYTE1(v27->Dpc.DeferredContext) >= 4u )
              {
                sub_112FC(v27->Dpc.ProcessorHistory, 0x33u, (__int64)&unk_5CCF8, *v29);
                v27 = off_60148;
              }
              ++v28;
              ++v29;
            }
            while ( v28 < *(unsigned __int16 *)(v26 + 56) );
          }
          if ( v27 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v27->Dpc.DeferredContext + 1, 0x18u)
            && BYTE1(v27->Dpc.DeferredContext) >= 4u )
          {
            sub_112FC(v27->Dpc.ProcessorHistory, 0x34u, (__int64)&unk_5CCF8, *(_DWORD *)(v26 + 32));
          }
        }
      }
      else
      {
        if ( v23 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( _bittest((const signed __int32 *)&v23->Dpc.DeferredContext + 1, 0x18u)
            && BYTE1(v23->Dpc.DeferredContext) >= 4u )
          {
            sub_2F80C(v23->Dpc.ProcessorHistory, 0x35u, (__int64)&unk_5CCF8, *(_QWORD *)(v22 + 16));
            v23 = off_60148;
          }
          if ( v23 != (PDEVICE_OBJECT)&off_60148 )
          {
            if ( _bittest((const signed __int32 *)&v23->Dpc.DeferredContext + 1, 0x18u)
              && BYTE1(v23->Dpc.DeferredContext) >= 4u )
            {
              sub_11008(v23->Dpc.ProcessorHistory, 0x36u, (__int64)&unk_5CCF8);
              v23 = off_60148;
            }
            if ( v23 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&v23->Dpc.DeferredContext + 1, 0x18u)
              && BYTE1(v23->Dpc.DeferredContext) >= 5u )
            {
              sub_11008(v23->Dpc.ProcessorHistory, 0x21u, (__int64)&unk_5CCF8);
            }
          }
        }
        sub_401B8((PKSPIN_LOCK)v22, v34);
        v30 = (unsigned __int16 *)(v22 + 58);
        *(_QWORD *)(v22 + 8) = MEMORY[0xFFFFF78000000014];
        *(_DWORD *)(v22 + 32) = *((_DWORD *)v9 + 2);
        *(_QWORD *)(v22 + 58) = *(_QWORD *)(v9 + 17);
        *(_WORD *)(v22 + 66) = v9[21];
        v31 = v9[16];
        v32 = 0;
        *(_WORD *)(v22 + 56) = v31;
        v33 = off_60148;
        if ( v31 )
        {
          do
          {
            if ( v33 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&v33->Dpc.DeferredContext + 1, 0x18u)
              && BYTE1(v33->Dpc.DeferredContext) >= 4u )
            {
              sub_112FC(v33->Dpc.ProcessorHistory, 0x22u, (__int64)&unk_5CCF8, *v30);
              v33 = off_60148;
            }
            ++v32;
            ++v30;
          }
          while ( v32 < *(unsigned __int16 *)(v22 + 56) );
        }
        if ( v33 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v33->Dpc.DeferredContext + 1, 0x18u)
          && BYTE1(v33->Dpc.DeferredContext) >= 4u )
        {
          sub_112FC(v33->Dpc.ProcessorHistory, 0x23u, (__int64)&unk_5CCF8, *(_DWORD *)(v22 + 32));
        }
        sub_40230((PKSPIN_LOCK)v22, v34[0]);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x24u, (__int64)&unk_5CCF8);
        }
        v2 = v36;
      }
      sub_3D0C8(BugCheckParameter1);
      ++v7;
      v8 += 22;
      v35 = v7;
      if ( v7 >= *(_DWORD *)(v1 + 1) )
        break;
      v6 = off_60148;
    }
  }
  sub_40664(&stru_622A8);
  sub_3DBA0();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x37u, (__int64)&unk_5CCF8);
  }
  return v2;
}

//----- (000000000003DA44) ----------------------------------------------------
__int64 sub_3DA44()
{
  unsigned int v0; // ebx
  int v1; // eax
  PDEVICE_OBJECT v2; // rcx

  v0 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x38u, (__int64)&unk_5CCF8);
  }
  sub_40598(&stru_622A8);
  if ( qword_64DB0 )
  {
    v1 = sub_541A0(qword_64DB0);
    if ( v1 )
    {
      v2 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_112FC(off_60148->Dpc.ProcessorHistory, 0x39u, (__int64)&unk_5CCF8, v1);
        v2 = off_60148;
      }
      v0 = 1;
    }
    else
    {
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v2->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(v2->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(v2->Dpc.ProcessorHistory, 0x3Au, (__int64)&unk_5CCF8);
    }
  }
  sub_40664(&stru_622A8);
  sub_3DBA0();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x3Bu, (__int64)&unk_5CCF8);
  }
  return v0;
}

//----- (000000000003DBA0) ----------------------------------------------------
__int64 sub_3DBA0()
{
  __int64 v0; // rbp
  int v1; // eax
  int v2; // ebx
  PDEVICE_OBJECT v3; // r10
  int v4; // edi
  _WORD *v5; // rax
  _WORD *v6; // rsi
  ULONG_PTR v7; // rcx
  const void *v8; // r11
  int v9; // eax
  int v10; // eax
  int v12; // [rsp+60h] [rbp+8h] BYREF
  ULONG_PTR v13; // [rsp+68h] [rbp+10h] BYREF

  v13 = 0i64;
  v12 = 0;
  v0 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x3Cu, (__int64)&unk_5CCF8);
  }
  sub_40598(&stru_622A8);
  v1 = sub_55088(qword_64DB0, &v12);
  v2 = v1;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x3Du, (__int64)&unk_5CCF8, v1);
    v3 = off_60148;
  }
  if ( !v2 || v2 == 1 )
    v4 = 88;
  else
    v4 = 8 * (9 * v2 - 9) + 88;
  if ( v3 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v3->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(v3->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(v3->Dpc.ProcessorHistory, 0x3Eu, (__int64)&unk_5CCF8, v4);
  }
  v5 = sub_3F66C(2, v4, 0x4C637241u);
  v6 = v5;
  if ( v5 )
  {
    v7 = qword_64DB0;
    *((_DWORD *)v5 + 1) = v2;
    *((_DWORD *)v5 + 2) = v4;
    v8 = (const void *)sub_5621C(v7, &v13, &v12);
    if ( v8 )
    {
      do
      {
        sub_588AC(&v6[36 * v0 + 8], 0x48ui64, v8, 0x48ui64);
        v0 = (unsigned int)(v0 + 1);
        v8 = (const void *)sub_563E8(qword_64DB0, &v13, 1, &v12);
      }
      while ( v8 );
    }
    else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
           && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
           && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      v9 = sub_57F30(v12);
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x40u, (__int64)&unk_5CCF8, v9);
    }
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
         && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Fu, (__int64)&unk_5CCF8);
  }
  sub_40664(&stru_622A8);
  *v6 = 1;
  v10 = sub_50CBC(0, 0x200A036u, (__int64)v6, v4);
  if ( v10 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x41u, (__int64)&unk_5CCF8, v10);
    }
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
         && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x42u, (__int64)&unk_5CCF8);
  }
  sub_3F6F0(v6, 0x4C637241u);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x43u, (__int64)&unk_5CCF8);
  }
  return 0i64;
}

//----- (000000000003DEC8) ----------------------------------------------------
__int64 sub_3DEC8()
{
  int v0; // eax
  PDEVICE_OBJECT v1; // r14
  __int64 v2; // rcx
  int v3; // eax
  unsigned __int16 *v5; // rdi
  unsigned int v6; // ebx
  unsigned __int16 *v7; // r15
  int v8; // eax
  unsigned __int16 *v9; // [rsp+80h] [rbp-68h] BYREF
  unsigned int v10; // [rsp+88h] [rbp-60h]
  int v11; // [rsp+8Ch] [rbp-5Ch] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+90h] [rbp-58h] BYREF
  unsigned __int16 *v13; // [rsp+98h] [rbp-50h]

  BugCheckParameter1 = 0i64;
  v9 = 0i64;
  v11 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x44u, (__int64)&unk_5CCF8);
  }
  v0 = sub_507A8(0i64, 0x200A036u, &v9, &v11);
  if ( v0 )
  {
    v1 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      || BYTE1(off_60148->Dpc.DeferredContext) < 2u )
    {
      goto LABEL_11;
    }
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x45u, (__int64)&unk_5CCF8, v0);
LABEL_10:
    v1 = off_60148;
LABEL_11:
    v2 = (__int64)v9;
    goto LABEL_12;
  }
  v2 = (__int64)v9;
  v5 = v9;
  v13 = v9;
  v1 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_4DE38(off_60148->Dpc.ProcessorHistory, 0x46u, (__int64)&unk_5CCF8, *v9);
    v2 = (__int64)v9;
    v1 = off_60148;
  }
  if ( *v5 == 1 )
  {
    v6 = 0;
    v10 = 0;
    if ( !*((_DWORD *)v5 + 1) )
    {
LABEL_12:
      if ( v2 )
      {
        v3 = sub_50A80(v2);
        if ( !v3 )
        {
LABEL_18:
          v1 = off_60148;
          goto LABEL_19;
        }
        v1 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
          return 0i64;
        if ( _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_112FC(off_60148->Dpc.ProcessorHistory, 0x4Du, (__int64)&unk_5CCF8, v3);
          goto LABEL_18;
        }
      }
LABEL_19:
      if ( v1 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v1->Dpc.DeferredContext + 1, 0x18u)
        && BYTE1(v1->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v1->Dpc.ProcessorHistory, 0x4Eu, (__int64)&unk_5CCF8);
      }
      return 0i64;
    }
    v7 = v5 + 34;
    while ( 1 )
    {
      if ( *((_DWORD *)v7 - 4) == 34525 )
      {
        if ( v1 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v1->Dpc.DeferredContext + 1, 0x18u)
          && BYTE1(v1->Dpc.DeferredContext) >= 4u )
        {
          v6 = v10;
          sub_3C814(v1->Dpc.ProcessorHistory, 0x49u, (__int64)&unk_5CCF8, v10);
          v5 = v13;
        }
      }
      else if ( v1 != (PDEVICE_OBJECT)&off_60148
             && _bittest((const signed __int32 *)&v1->Dpc.DeferredContext + 1, 0x18u)
             && BYTE1(v1->Dpc.DeferredContext) >= 4u )
      {
        sub_3C8C4(v1->Dpc.ProcessorHistory, 0x4Au, (__int64)&unk_5CCF8, v6);
      }
      v8 = sub_3CDAC((unsigned __int64 *)(v7 - 26), (ULONG_PTR **)&BugCheckParameter1);
      if ( v8 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_112FC(off_60148->Dpc.ProcessorHistory, 0x4Bu, (__int64)&unk_5CCF8, v8);
        }
      }
      else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
             && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
             && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
      {
        sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x4Cu, (__int64)&unk_5CCF8, *(_QWORD *)(v7 - 18));
      }
      sub_3D0C8(BugCheckParameter1);
      ++v6;
      v7 += 36;
      v10 = v6;
      if ( v6 >= *((_DWORD *)v5 + 1) )
        break;
      v1 = off_60148;
    }
    goto LABEL_10;
  }
  if ( v1 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&v1->Dpc.DeferredContext + 1, 0x14u) && BYTE1(v1->Dpc.DeferredContext) >= 2u )
    {
      sub_11430(v1->Dpc.ProcessorHistory, 0x47u, (__int64)&unk_5CCF8, *v5);
      v1 = off_60148;
    }
    if ( v1 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v1->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(v1->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(v1->Dpc.ProcessorHistory, 0x48u, (__int64)&unk_5CCF8);
    }
  }
  return 25i64;
}

//----- (000000000003E3D4) ----------------------------------------------------
__int64 __fastcall sub_3E3D4(__int64 a1, __int64 a2, _BYTE *a3)
{
  char v3; // r15
  PDEVICE_OBJECT v5; // r13
  unsigned int v7; // ecx
  __int64 v8; // rdi
  unsigned __int8 *v9; // rdx
  int v10; // eax
  unsigned __int64 v11; // rdi
  unsigned __int16 v12; // dx
  unsigned __int8 *v13; // rdx
  int v14; // eax
  __int64 v15; // rbx
  PDEVICE_OBJECT v16; // rcx
  unsigned int v17; // er12
  __int64 v18; // rax
  _WORD *v19; // rdx
  char *v20; // rdi
  int v21; // ebp
  const char *v22; // rax
  int v23; // ecx
  int v24; // eax
  __int64 v25; // [rsp+20h] [rbp-148h]
  int v26; // [rsp+30h] [rbp-138h]
  int v27; // [rsp+38h] [rbp-130h]
  int v28; // [rsp+40h] [rbp-128h]
  int v29; // [rsp+48h] [rbp-120h]
  int v30; // [rsp+50h] [rbp-118h]
  int v31; // [rsp+E0h] [rbp-88h] BYREF
  union _LARGE_INTEGER v32; // [rsp+E8h] [rbp-80h] BYREF
  _BYTE *v33; // [rsp+F0h] [rbp-78h]
  ULONG_PTR BugCheckParameter1; // [rsp+F8h] [rbp-70h] BYREF
  __int64 v35; // [rsp+100h] [rbp-68h]
  char v36[32]; // [rsp+108h] [rbp-60h] BYREF

  v31 = 0;
  v3 = 0;
  BugCheckParameter1 = 0i64;
  v33 = a3;
  v35 = a2;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x4Fu, (__int64)&unk_5CCF8);
    v5 = off_60148;
  }
  if ( (*(_BYTE *)(a1 + 32) & 4) == 0 && (*(_BYTE *)(a1 + 32) & 2) == 0 )
  {
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(v5->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(v5->Dpc.ProcessorHistory, 0x50u, (__int64)&unk_5CCF8);
    }
    return 0i64;
  }
  if ( *(_DWORD *)(a1 + 36) == 2048 )
  {
    if ( v5 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x18u) && BYTE1(v5->Dpc.DeferredContext) >= 4u )
      {
        v26 = *(unsigned __int8 *)(a1 + 59);
        sub_114E4(v5->Dpc.ProcessorHistory, 0x51u, (__int64)&unk_5CCF8, *(unsigned __int8 *)(a1 + 56));
        v5 = off_60148;
      }
      if ( v5 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x18u)
        && BYTE1(v5->Dpc.DeferredContext) >= 4u )
      {
        v26 = *(unsigned __int8 *)(a1 + 43);
        sub_114E4(v5->Dpc.ProcessorHistory, 0x52u, (__int64)&unk_5CCF8, *(unsigned __int8 *)(a1 + 40));
LABEL_30:
        v5 = off_60148;
        goto LABEL_31;
      }
    }
  }
  else if ( *(_DWORD *)(a1 + 36) == 34525 && v5 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x18u) && BYTE1(v5->Dpc.DeferredContext) >= 4u )
    {
      v30 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 70)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 70) << 8);
      v29 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 68)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 68) << 8);
      v28 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 66)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 66) << 8);
      v27 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 64)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 64) << 8);
      v26 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 62)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 62) << 8);
      sub_110AC(
        v5->Dpc.ProcessorHistory,
        0x53u,
        (__int64)&unk_5CCF8,
        (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 56)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 56) << 8));
      v5 = off_60148;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(v5->Dpc.DeferredContext) >= 4u )
    {
      v30 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 54)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 54) << 8);
      v29 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 52)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 52) << 8);
      v28 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 50)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 50) << 8);
      v27 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 48)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 48) << 8);
      v26 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 46)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 46) << 8);
      sub_110AC(
        v5->Dpc.ProcessorHistory,
        0x54u,
        (__int64)&unk_5CCF8,
        (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 40)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 40) << 8));
      goto LABEL_30;
    }
  }
LABEL_31:
  v7 = 0;
  v8 = 16i64;
  if ( *(_DWORD *)(a1 + 16) == 2 )
  {
    v9 = (unsigned __int8 *)(a1 + 56);
    do
    {
      v10 = *v9++;
      v7 = v10 ^ (-2128831035 * v7);
      --v8;
    }
    while ( v8 );
    v11 = v7;
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(v5->Dpc.DeferredContext) >= 4u )
    {
      v12 = 85;
LABEL_44:
      sub_3C994(
        v5->Dpc.ProcessorHistory,
        v12,
        (__int64)&unk_5CCF8,
        v11,
        *(unsigned __int16 *)(a1 + 78),
        *(unsigned __int16 *)(a1 + 76),
        v26,
        v27,
        v28,
        v29,
        v30);
      goto LABEL_45;
    }
  }
  else
  {
    v13 = (unsigned __int8 *)(a1 + 40);
    do
    {
      v14 = *v13++;
      v7 = v14 ^ (-2128831035 * v7);
      --v8;
    }
    while ( v8 );
    v11 = v7;
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(v5->Dpc.DeferredContext) >= 4u )
    {
      v12 = 86;
      goto LABEL_44;
    }
  }
LABEL_45:
  v15 = sub_559E0(qword_64DB0, v11, &BugCheckParameter1, &v31);
  if ( v31 )
  {
    v16 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x58u, (__int64)&unk_5CCF8, v11);
      v16 = off_60148;
    }
    v17 = 5;
    v15 = 0i64;
  }
  else
  {
    v16 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_2F80C(off_60148->Dpc.ProcessorHistory, 0x57u, (__int64)&unk_5CCF8, v11);
      v16 = off_60148;
    }
    v17 = 0;
  }
  if ( v15 )
  {
    if ( v16 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v16->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(v16->Dpc.DeferredContext) >= 4u )
    {
      LODWORD(v25) = *(unsigned __int16 *)(v15 + 56);
      sub_3C940(v16->Dpc.ProcessorHistory, 0x59u, (__int64)&unk_5CCF8, v11, v25);
      v16 = off_60148;
    }
    if ( !*(_WORD *)(v15 + 56) )
    {
LABEL_73:
      v3 = 1;
      goto LABEL_74;
    }
    if ( (*(_BYTE *)(a1 + 32) & 0x20) != 0 || (*(_BYTE *)(a1 + 32) & 0x10) != 0 )
    {
      v18 = 0i64;
      v19 = (_WORD *)(v15 + 58);
      while ( *(_WORD *)(a1 + 78) != *v19 && *(_WORD *)(a1 + 76) != *v19 )
      {
        v18 = (unsigned int)(v18 + 1);
        ++v19;
        if ( (unsigned int)v18 >= 5 )
          goto LABEL_74;
      }
      if ( v16 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v16->Dpc.DeferredContext + 1, 0x18u)
        && BYTE1(v16->Dpc.DeferredContext) >= 4u )
      {
        sub_112FC(v16->Dpc.ProcessorHistory, 0x5Au, (__int64)&unk_5CCF8, *(unsigned __int16 *)(v15 + 2 * v18 + 58));
        v16 = off_60148;
      }
      goto LABEL_73;
    }
  }
LABEL_74:
  if ( BugCheckParameter1 )
  {
    sub_3D0C8(BugCheckParameter1);
    v16 = off_60148;
  }
  if ( qword_61290 )
  {
    if ( !v3 )
      goto LABEL_98;
    v20 = 0i64;
    v21 = 0;
    v32.QuadPart = MEMORY[0xFFFFF78000000014];
    if ( dword_65420 )
    {
      v22 = sub_4D7E8(2);
      sub_58888(v36, (unsigned int)(v23 + 29), 0xFFFFFFFFFFFFFFFFui64, "|AR MATCH-Action:%s|", v22);
      v20 = v36;
      v21 = strlen(v36);
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x14u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      sub_1182C(off_60148->Dpc.ProcessorHistory, 0x5Bu, (__int64)&unk_5CCF8, v36);
    }
    v24 = 0;
    if ( *(_DWORD *)(a1 + 16) == 2 )
      v24 = 16;
    if ( (*(_BYTE *)(v35 + 88) & 1) != 0 )
      v24 |= 1u;
    sub_18B70(*(const void **)v35, *(_DWORD *)(v35 + 72), v20, v21, v24, 1, 2, &v32, 1);
    v16 = off_60148;
  }
  if ( v3 )
  {
    if ( v16 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v16->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(v16->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(v16->Dpc.ProcessorHistory, 0x5Cu, (__int64)&unk_5CCF8);
    }
    _InterlockedAdd64(&qword_61350, 1ui64);
    if ( v15 && dword_65444 == 1 )
      sub_3F25C(v15, (const void *)a1);
    *v33 = 1;
    goto LABEL_99;
  }
LABEL_98:
  *v33 = 0;
LABEL_99:
  _InterlockedAdd(&dword_62224, 0xFFFFFFFF);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x5Du, (__int64)&unk_5CCF8);
  }
  return v17;
}
// 3E91B: variable 'v26' is possibly undefined
// 3E91B: variable 'v27' is possibly undefined
// 3E91B: variable 'v28' is possibly undefined
// 3E91B: variable 'v29' is possibly undefined
// 3E91B: variable 'v30' is possibly undefined
// 3EA15: variable 'v25' is possibly undefined
// 3EB0B: variable 'v23' is possibly undefined
// 61290: using guessed type __int64 qword_61290;
// 61350: using guessed type __int64 qword_61350;
// 62224: using guessed type int dword_62224;
// 65420: using guessed type int dword_65420;
// 65444: using guessed type int dword_65444;

//----- (000000000003ECD8) ----------------------------------------------------
__int64 sub_3ECD8()
{
  char v0; // di
  int v1; // eax
  __int64 v2; // r8
  __int64 v3; // r11
  int v4; // eax
  __int64 v5; // rsi
  unsigned __int64 v6; // rbx
  int v7; // eax
  int v8; // eax
  __int64 v10; // [rsp+20h] [rbp-28h]
  int v11; // [rsp+50h] [rbp+8h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+58h] [rbp+10h] BYREF

  BugCheckParameter1 = 0i64;
  v11 = 0;
  v0 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x62u, (__int64)&unk_5CCF8);
  }
  sub_40598(&stru_622A8);
  v1 = sub_55088(qword_64DB0, &v11);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x63u, (__int64)&unk_5CCF8, v1);
  }
  v3 = sub_5621C(qword_64DB0, &BugCheckParameter1, &v11);
  if ( v3 )
  {
    do
    {
      if ( *(_DWORD *)(v3 + 32) )
      {
        v5 = *(_QWORD *)(v3 + 16);
        v6 = (MEMORY[0xFFFFF78000000014] - *(_QWORD *)(v3 + 8)) / 10000i64;
        if ( v6 > (unsigned int)(1000 * *(_DWORD *)(v3 + 32)) )
        {
          LOBYTE(v2) = 1;
          sub_5575C(qword_64DB0, BugCheckParameter1, v2, &v11);
          if ( v11 )
          {
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
              && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
            {
              v7 = sub_57F30(v11);
              sub_112FC(off_60148->Dpc.ProcessorHistory, 0x65u, (__int64)&unk_5CCF8, v7);
            }
          }
          else
          {
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
              && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
            {
              LODWORD(v10) = v6;
              sub_3C940(off_60148->Dpc.ProcessorHistory, 0x66u, (__int64)&unk_5CCF8, v5, v10);
            }
            v0 = 1;
          }
        }
      }
      v3 = sub_563E8(qword_64DB0, &BugCheckParameter1, 1, &v11);
    }
    while ( v3 );
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
         && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    v4 = sub_57F30(v11);
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x64u, (__int64)&unk_5CCF8, v4);
  }
  v8 = sub_55088(qword_64DB0, &v11);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x67u, (__int64)&unk_5CCF8, v8);
  }
  sub_40664(&stru_622A8);
  if ( v0 )
    sub_3DBA0();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x68u, (__int64)&unk_5CCF8);
  }
  return 0i64;
}
// 3EE6E: variable 'v2' is possibly undefined
// 3EEF4: variable 'v10' is possibly undefined

//----- (000000000003EFD8) ----------------------------------------------------
__int64 __fastcall sub_3EFD8(_QWORD *a1, int *a2)
{
  int v3; // ebp
  int v5; // eax
  int v6; // edi
  PDEVICE_OBJECT v7; // rcx
  int v8; // ebx
  char *v9; // rax
  char *v10; // rsi
  PDEVICE_OBJECT v11; // rcx
  ULONG_PTR v12; // rcx
  __int64 v13; // rax
  int v14; // eax
  int v16; // [rsp+60h] [rbp+8h] BYREF
  ULONG_PTR v17; // [rsp+68h] [rbp+10h] BYREF

  v17 = 0i64;
  v16 = 0;
  v3 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x69u, (__int64)&unk_5CCF8);
  }
  v5 = sub_55088(qword_64DB0, &v16);
  v6 = v5;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
  {
    sub_112FC(off_60148->Dpc.ProcessorHistory, 0x6Au, (__int64)&unk_5CCF8, v5);
    v7 = off_60148;
  }
  if ( !v6 || v6 == 1 )
    v8 = 54;
  else
    v8 = 44 * (v6 - 1) + 54;
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v7->AlignmentRequirement, 0x6Bu, (__int64)&unk_5CCF8, v8);
  }
  v9 = (char *)sub_3F66C(2, v8, 0x474D7241u);
  v10 = v9;
  if ( v9 )
  {
    v12 = qword_64DB0;
    *(_WORD *)v9 = 1;
    *(_DWORD *)(v9 + 2) = v6;
    v13 = sub_5621C(v12, &v17, &v16);
    if ( v13 )
    {
      do
      {
        sub_588AC(&v10[44 * v3 + 10], 0x2Cui64, (const void *)(v13 + 24), 0x2Cui64);
        v13 = sub_563E8(qword_64DB0, &v17, 1, &v16);
        ++v3;
      }
      while ( v13 );
      goto LABEL_28;
    }
    v11 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
    {
      v14 = sub_57F30(v16);
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x6Du, (__int64)&unk_5CCF8, v14);
      goto LABEL_28;
    }
  }
  else
  {
    v11 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x6Cu, (__int64)&unk_5CCF8);
LABEL_28:
      v11 = off_60148;
      goto LABEL_29;
    }
  }
LABEL_29:
  *a1 = v10;
  *a2 = v8;
  if ( v11 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v11->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(v11->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(v11->Dpc.ProcessorHistory, 0x6Eu, (__int64)&unk_5CCF8);
  }
  return 0i64;
}

//----- (000000000003F25C) ----------------------------------------------------
__int64 __fastcall sub_3F25C(__int64 a1, const void *a2)
{
  unsigned int v2; // ebx
  PDEVICE_OBJECT v5; // rcx
  __int64 result; // rax
  _DWORD *v7; // rax
  _DWORD *v8; // rdi
  _QWORD *v9; // rax
  PDEVICE_OBJECT v10; // rcx
  __int64 v11; // [rsp+40h] [rbp-38h]
  __int64 v12; // [rsp+50h] [rbp-28h]

  v2 = 0;
  HIDWORD(v12) = 0;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x6Fu, (__int64)&unk_5CCF8);
    v5 = off_60148;
  }
  if ( qword_61280 )
  {
    v7 = sub_3F66C(2, 0x60u, 0x70727241u);
    v8 = v7;
    if ( v7 )
    {
      *(_QWORD *)v7 = *(_QWORD *)(a1 + 24);
      v7[2] = *(_DWORD *)(a1 + 32);
      sub_588AC(v7 + 3, 0x54ui64, a2, 0x54ui64);
      LODWORD(v11) = 2;
      LODWORD(v12) = 96;
      v9 = sub_40964((__int64)qword_61280, 24, (__int64)sub_1A670, 0i64);
      if ( v9 )
      {
        *v9 = v11;
        v9[1] = v8;
        v9[2] = v12;
        sub_40AF4((__int64)v9);
        v10 = off_60148;
      }
      else
      {
        v10 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
          && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
        {
          sub_11008(off_60148->Dpc.ProcessorHistory, 0x72u, (__int64)&unk_5CCF8);
          v10 = off_60148;
        }
        v2 = 3;
      }
      if ( v10 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v10->Dpc.DeferredContext + 1, 0x18u)
        && BYTE1(v10->Dpc.DeferredContext) >= 5u )
      {
        sub_11008(v10->Dpc.ProcessorHistory, 0x73u, (__int64)&unk_5CCF8);
      }
      result = v2;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
        && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
      {
        sub_11008(off_60148->Dpc.ProcessorHistory, 0x71u, (__int64)&unk_5CCF8);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v5->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(v5->Dpc.DeferredContext) >= 2u )
    {
      sub_11008(v5->Dpc.ProcessorHistory, 0x70u, (__int64)&unk_5CCF8);
    }
    result = 15i64;
  }
  return result;
}
// 3F3E6: variable 'v11' is possibly undefined

//----- (000000000003F498) ----------------------------------------------------
__int64 __fastcall sub_3F498(PVOID P, unsigned int a2)
{
  int v4; // eax
  unsigned int v5; // ebx
  PDEVICE_OBJECT v6; // rcx

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(off_60148->Dpc.DeferredContext) >= 5u )
  {
    sub_11008(off_60148->Dpc.ProcessorHistory, 0x74u, (__int64)&unk_5CCF8);
  }
  v4 = sub_4D1A4(40025, P, a2);
  v5 = v4;
  if ( v4 )
  {
    v6 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 2u )
    {
      sub_112FC(off_60148->Dpc.ProcessorHistory, 0x75u, (__int64)&unk_5CCF8, v4);
LABEL_14:
      v6 = off_60148;
      goto LABEL_15;
    }
  }
  else
  {
    v6 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->Dpc.DeferredContext + 1, 0x18u)
      && BYTE1(off_60148->Dpc.DeferredContext) >= 4u )
    {
      sub_11008(off_60148->Dpc.ProcessorHistory, 0x76u, (__int64)&unk_5CCF8);
      goto LABEL_14;
    }
  }
LABEL_15:
  if ( P )
  {
    sub_3F6F0(P, 0x70727241u);
    v6 = off_60148;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v6->Dpc.DeferredContext + 1, 0x18u)
    && BYTE1(v6->Dpc.DeferredContext) >= 5u )
  {
    sub_112FC(v6->Dpc.ProcessorHistory, 0x77u, (__int64)&unk_5CCF8, v5);
  }
  return v5;
}

//----- (000000000003F5EC) ----------------------------------------------------
__int64 __fastcall sub_3F5EC(__int64 a1, unsigned __int16 a2)
{
  strlen(aUnknownModule);
  return qword_61238(a1, 43i64, &unk_5CCE8, a2, aUnknownModule);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003F66C) ----------------------------------------------------
PVOID __fastcall sub_3F66C(int a1, unsigned int a2, ULONG a3)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0xAu);
  }
  return sub_40D90(a1, a2, a3);
}

//----- (000000000003F6F0) ----------------------------------------------------
void __fastcall sub_3F6F0(PVOID P, ULONG Tag)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0xBu);
  }
  sub_40EAC(P, Tag);
}

//----- (000000000003F764) ----------------------------------------------------
PVOID __fastcall sub_3F764(__int64 a1, void *a2, unsigned int a3, unsigned int a4)
{
  size_t v5; // rsi
  PDEVICE_OBJECT v7; // rcx
  PVOID v8; // rax
  PVOID v9; // rbx

  v5 = a3;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 4) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0xCu);
      v7 = off_60148;
    }
    if ( v7 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(v7->Queue.Wcb.DeviceRoutine) & 2) != 0 && BYTE1(v7->Queue.Wcb.DeviceRoutine) >= 4u )
      {
        sub_11008((__int64)v7->Queue.ListEntry.Blink, 0x10u, (__int64)&unk_5CCD8);
        v7 = off_60148;
      }
      if ( v7 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v7->Queue.Wcb.DeviceRoutine) & 4) != 0
        && BYTE1(v7->Queue.Wcb.DeviceRoutine) >= 6u )
      {
        sub_40C64((__int64)v7->Queue.ListEntry.Blink, 17i64, (__int64)&unk_5CCD8, (int)a2);
      }
    }
  }
  v8 = sub_40D90(1, a4, 0x706D744Eu);
  v9 = v8;
  if ( v8 && a2 )
  {
    memmove(v8, a2, v5);
    sub_40EAC(a2, 0x706D744Eu);
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x12u, (__int64)&unk_5CCD8, (int)v9);
  }
  return v9;
}

//----- (000000000003F8D8) ----------------------------------------------------
char *__fastcall sub_3F8D8(int a1, unsigned int a2, ULONG a3)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0xDu);
  }
  return sub_40FA4(a1, a2, a3);
}

//----- (000000000003F95C) ----------------------------------------------------
void __fastcall sub_3F95C(PVOID P)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 4) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0xEu);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0 && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
      {
        sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x16u, (__int64)&unk_5CCD8);
        v2 = off_60148;
      }
      if ( v2 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 4) != 0
        && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x17u, (__int64)&unk_5CCD8);
      }
    }
  }
  if ( *(_DWORD *)P == 2 )
  {
    ExDeleteNPagedLookasideList((PNPAGED_LOOKASIDE_LIST)((char *)P + 64));
  }
  else if ( *(_DWORD *)P == 1 )
  {
    ExDeletePagedLookasideList((PPAGED_LOOKASIDE_LIST)((char *)P + 64));
  }
  sub_40EAC(P, *((_DWORD *)P + 2));
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x18u, (__int64)&unk_5CCD8);
  }
}

//----- (000000000003FA7C) ----------------------------------------------------
_DWORD *__fastcall sub_3FA7C(__int64 a1)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0xFu);
  }
  return sub_41158(a1);
}

//----- (000000000003FAE4) ----------------------------------------------------
void __fastcall sub_3FAE4(__int64 a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  struct _SLIST_ENTRY *v5; // rdi

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 4) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x10u);
      v4 = off_60148;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11008((__int64)v4->Queue.ListEntry.Blink, 0x1Bu, (__int64)&unk_5CCD8);
      v4 = off_60148;
    }
  }
  v5 = (struct _SLIST_ENTRY *)(a2 - 4);
  if ( LODWORD(v5->Next) )
  {
    if ( LODWORD(v5->Next) == 1 )
    {
      sub_40EAC(v5, *(_DWORD *)(a1 + 8));
LABEL_18:
      v4 = off_60148;
      goto LABEL_19;
    }
  }
  else if ( *(_DWORD *)a1 == 2 || *(_DWORD *)a1 == 1 )
  {
    ++*(_DWORD *)(a1 + 92);
    if ( ExQueryDepthSList((PSLIST_HEADER)(a1 + 64)) < *(_WORD *)(a1 + 80) )
    {
      ExpInterlockedPushEntrySList((PSLIST_HEADER)(a1 + 64), v5);
    }
    else
    {
      ++*(_DWORD *)(a1 + 96);
      (*(void (__fastcall **)(struct _SLIST_ENTRY *))(a1 + 120))(v5);
    }
    goto LABEL_18;
  }
LABEL_19:
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)v4->Queue.ListEntry.Blink, 0x1Cu, (__int64)&unk_5CCD8);
  }
}

//----- (000000000003FC10) ----------------------------------------------------
_DWORD *__fastcall sub_3FC10(__int64 a1, unsigned int a2)
{
  PDEVICE_OBJECT v4; // rcx
  _DWORD *v5; // rbx
  _DWORD *v6; // rax

  v4 = off_60148;
  v5 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 4) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x11u);
      v4 = off_60148;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11008((__int64)v4->Queue.ListEntry.Blink, 0x1Du, (__int64)&unk_5CCD8);
    }
  }
  if ( a2 > *(_DWORD *)(a1 + 4) )
  {
    v6 = sub_40D90(*(_DWORD *)a1, a2 + 7, *(_DWORD *)(a1 + 8));
    if ( v6 )
    {
      v5 = v6 + 1;
      *v6 = 1;
      memset(v6 + 1, 0, *(unsigned int *)(a1 + 4));
    }
  }
  else
  {
    v5 = sub_41158(a1);
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x1Eu, (__int64)&unk_5CCD8, (int)v5);
  }
  return v5;
}

//----- (000000000003FD2C) ----------------------------------------------------
__int64 __fastcall sub_3FD2C(PERESOURCE Resource)
{
  PDEVICE_OBJECT v2; // rcx
  int v3; // eax
  unsigned int v4; // ebx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x12u);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x1Fu, (__int64)&unk_5CCD8);
    }
  }
  v3 = ExInitializeResourceLite(Resource);
  v4 = v3;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x20u, (__int64)&unk_5CCD8, v3);
  }
  return v4;
}

//----- (000000000003FE00) ----------------------------------------------------
__int64 __fastcall sub_3FE00(PERESOURCE Resource)
{
  PDEVICE_OBJECT v2; // rcx
  int v3; // eax
  unsigned int v4; // ebx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x13u);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x21u, (__int64)&unk_5CCD8);
    }
  }
  v3 = ExDeleteResourceLite(Resource);
  v4 = v3;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x22u, (__int64)&unk_5CCD8, v3);
  }
  return v4;
}

//----- (000000000003FED4) ----------------------------------------------------
BOOLEAN __fastcall sub_3FED4(PERESOURCE Resource)
{
  PDEVICE_OBJECT v2; // rcx
  BOOLEAN v3; // al
  BOOLEAN v4; // bl

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x15u);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x25u, (__int64)&unk_5CCD8);
    }
  }
  v3 = ExAcquireResourceExclusiveLite(Resource, 1u);
  v4 = v3;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x26u, (__int64)&unk_5CCD8, v3);
  }
  return v4;
}

//----- (000000000003FFAC) ----------------------------------------------------
BOOLEAN __fastcall sub_3FFAC(PERESOURCE Resource)
{
  PDEVICE_OBJECT v2; // rcx
  BOOLEAN v3; // al
  BOOLEAN v4; // bl

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x16u);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x27u, (__int64)&unk_5CCD8);
    }
  }
  v3 = ExAcquireResourceSharedLite(Resource, 1u);
  v4 = v3;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x28u, (__int64)&unk_5CCD8, v3);
  }
  return v4;
}

//----- (0000000000040084) ----------------------------------------------------
void __fastcall sub_40084(PERESOURCE Resource)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x18u);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x2Bu, (__int64)&unk_5CCD8);
    }
  }
  ExReleaseResourceLite(Resource);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x2Cu, (__int64)&unk_5CCD8);
  }
}

//----- (0000000000040150) ----------------------------------------------------
__int64 __fastcall sub_40150(_QWORD *a1)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x1Au);
  }
  return sub_4125C(a1);
}

//----- (00000000000401B8) ----------------------------------------------------
void __fastcall sub_401B8(PKSPIN_LOCK SpinLock, KIRQL *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x1Bu);
  }
  sub_412E0(SpinLock, a2);
}

//----- (0000000000040230) ----------------------------------------------------
void __fastcall sub_40230(PKSPIN_LOCK SpinLock, KIRQL a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x1Cu);
  }
  sub_41398(SpinLock, a2);
}

//----- (00000000000402A4) ----------------------------------------------------
bool __fastcall sub_402A4(struct _KEVENT **a1, char a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x1Du);
  }
  return sub_4143C(a1, a2);
}

//----- (000000000004031C) ----------------------------------------------------
void __fastcall sub_4031C(PVOID P)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x1Eu);
  }
  sub_41524(P);
}

//----- (0000000000040384) ----------------------------------------------------
int __fastcall sub_40384(PRKEVENT Event)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x1Fu);
  }
  return sub_415BC(Event);
}

//----- (00000000000403EC) ----------------------------------------------------
int __fastcall sub_403EC(PRKEVENT Event)
{
  PDEVICE_OBJECT v2; // rcx
  int result; // eax

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x20u);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x3Bu, (__int64)&unk_5CCD8);
    }
  }
  result = KeResetEvent(Event);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    result = sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x3Cu, (__int64)&unk_5CCD8);
  }
  return result;
}

//----- (00000000000404B8) ----------------------------------------------------
void __fastcall sub_404B8(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x21u);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x3Du, (__int64)&unk_5CCD8);
    }
  }
  *(_QWORD *)(a1 + 8) = 0i64;
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)a1 = 1;
  KeInitializeEvent((PRKEVENT)(a1 + 24), SynchronizationEvent, 0);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x3Eu, (__int64)&unk_5CCD8);
  }
}

//----- (0000000000040598) ----------------------------------------------------
void __fastcall sub_40598(PFAST_MUTEX FastMutex)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x22u);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x3Fu, (__int64)&unk_5CCD8);
    }
  }
  ExAcquireFastMutex(FastMutex);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x40u, (__int64)&unk_5CCD8);
  }
}

//----- (0000000000040664) ----------------------------------------------------
void __fastcall sub_40664(PFAST_MUTEX FastMutex)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x24u);
      v2 = off_60148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x43u, (__int64)&unk_5CCD8);
    }
  }
  ExReleaseFastMutex(FastMutex);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x44u, (__int64)&unk_5CCD8);
  }
}

//----- (0000000000040730) ----------------------------------------------------
unsigned __int8 __fastcall sub_40730(PVOID *Object, __int64 a2, __int64 a3)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x10) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x27u);
  }
  return sub_416E8(Object, a2, a3);
}

//----- (00000000000407B8) ----------------------------------------------------
__int64 __fastcall sub_407B8(PVOID Object)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x10) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x28u);
  }
  return sub_41858(Object);
}

//----- (0000000000040820) ----------------------------------------------------
__int64 __fastcall sub_40820(unsigned int a1)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x2Bu);
  }
  return sub_41BF8(a1, 0);
}

//----- (0000000000040888) ----------------------------------------------------
__int64 __fastcall sub_40888(unsigned int a1)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x2Cu);
  }
  return sub_41BF8(a1, 1);
}

//----- (00000000000408F0) ----------------------------------------------------
__int64 __fastcall sub_408F0(PVOID P)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x2Du);
  }
  return sub_41EAC(P);
}

//----- (0000000000040964) ----------------------------------------------------
_QWORD *__fastcall sub_40964(__int64 a1, int a2, __int64 a3, __int64 a4)
{
  PDEVICE_OBJECT v8; // rcx
  _QWORD *v9; // rbx
  _QWORD *v10; // rdi
  unsigned int v11; // ebp

  v8 = off_60148;
  v9 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x2Eu);
    v8 = off_60148;
  }
  v10 = 0i64;
  v11 = a2 + 40;
  if ( v8 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v8->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v8->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)v8->Queue.ListEntry.Blink, 0x68u, (__int64)&unk_5CCD8);
    v8 = off_60148;
  }
  if ( a1 && a3 && a2 )
  {
    v10 = sub_40D90(2, v11, 0x6E635749u);
LABEL_17:
    if ( v10 )
    {
      memset(v10, 0, v11);
      v10[1] = v10;
      *v10 = v10;
      v10[3] = a3;
      v10[4] = a4;
      v10[2] = a1;
      v9 = v10 + 5;
    }
    v8 = off_60148;
    goto LABEL_20;
  }
  if ( v8 == (PDEVICE_OBJECT)&off_60148 )
    return v9;
  if ( SBYTE4(v8->Queue.Wcb.DeviceRoutine) < 0 && BYTE1(v8->Queue.Wcb.DeviceRoutine) >= 3u )
  {
    sub_11008((__int64)v8->Queue.ListEntry.Blink, 0x69u, (__int64)&unk_5CCD8);
    goto LABEL_17;
  }
LABEL_20:
  if ( v8 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v8->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v8->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)v8->Queue.ListEntry.Blink, 0x6Au, (__int64)&unk_5CCD8, (int)v9);
  }
  return v9;
}

//----- (0000000000040AF4) ----------------------------------------------------
void __fastcall sub_40AF4(__int64 a1)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x30u);
  }
  sub_422CC(a1);
}

//----- (0000000000040B60) ----------------------------------------------------
__int64 __fastcall sub_40B60(PVOID Object, unsigned int a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x32u);
  }
  return sub_423B0(Object, a2);
}

//----- (0000000000040BD4) ----------------------------------------------------
__int64 __fastcall sub_40BD4(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+B8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CCD8, 14i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000040C64) ----------------------------------------------------
__int64 __fastcall sub_40C64(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+C8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CCD8, 17i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000040D00) ----------------------------------------------------
__int64 __fastcall sub_40D00(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+B8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CCD8, 11i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000040D90) ----------------------------------------------------
PVOID __fastcall sub_40D90(int a1, unsigned int a2, ULONG a3)
{
  SIZE_T v4; // rdi
  PDEVICE_OBJECT v6; // rcx
  PVOID v7; // rax
  PVOID v8; // rbx

  v4 = a2;
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0xAu, (__int64)&unk_5CCD8);
      v6 = off_60148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v6->Queue.Wcb.DeviceRoutine) & 4) != 0
      && BYTE1(v6->Queue.Wcb.DeviceRoutine) >= 6u )
    {
      sub_40D00((__int64)v6->Queue.ListEntry.Blink, 11i64, (__int64)&unk_5CCD8, v4);
    }
  }
  v7 = ExAllocatePoolWithTag((POOL_TYPE)(a1 != 2), v4, a3);
  v8 = v7;
  if ( v7 )
    memset(v7, 0, v4);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0xCu, (__int64)&unk_5CCD8, (int)v8);
  }
  return v8;
}

//----- (0000000000040EAC) ----------------------------------------------------
void __fastcall sub_40EAC(PVOID P, ULONG Tag)
{
  PDEVICE_OBJECT v4; // rcx

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0xDu, (__int64)&unk_5CCD8);
      v4 = off_60148;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 4) != 0
      && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 6u )
    {
      sub_40BD4((__int64)v4->Queue.ListEntry.Blink, 14i64, (__int64)&unk_5CCD8, (int)P);
      v4 = off_60148;
    }
  }
  if ( P )
  {
    ExFreePoolWithTag(P, Tag);
    v4 = off_60148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)v4->Queue.ListEntry.Blink, 0xFu, (__int64)&unk_5CCD8);
  }
}

//----- (0000000000040FA4) ----------------------------------------------------
char *__fastcall sub_40FA4(int a1, unsigned int a2, ULONG a3)
{
  __int64 v4; // rsi
  char *v5; // rbx
  PDEVICE_OBJECT v7; // rcx
  bool v8; // dl
  char *v9; // rax

  v4 = a2;
  v5 = 0i64;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x13u, (__int64)&unk_5CCD8);
    v7 = off_60148;
  }
  v8 = (_DWORD)v4 != 0;
  if ( a1 != 2 && a1 != 1 )
    v8 = 0;
  if ( v8 )
  {
    v9 = (char *)sub_40D90(2, 0xC0u, a3);
    v5 = v9;
    if ( v9 )
    {
      memset(v9, 0, 0xC0ui64);
      *((_DWORD *)v5 + 1) = v4;
      *(_DWORD *)v5 = a1;
      *((_DWORD *)v5 + 2) = a3;
      v7 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 4) != 0
        && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x14u, (__int64)&unk_5CCD8);
        v7 = off_60148;
      }
      if ( *(_DWORD *)v5 == 2 )
      {
        ExInitializeNPagedLookasideList((PNPAGED_LOOKASIDE_LIST)(v5 + 64), 0i64, 0i64, 0, v4 + 7, a3, 0);
        v7 = off_60148;
      }
      if ( *(_DWORD *)v5 == 1 )
      {
        ExInitializePagedLookasideList((PPAGED_LOOKASIDE_LIST)(v5 + 64), 0i64, 0i64, 0, v4 + 7, a3, 0);
        v7 = off_60148;
      }
    }
    else
    {
      v7 = off_60148;
    }
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v7->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v7->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)v7->Queue.ListEntry.Blink, 0x15u, (__int64)&unk_5CCD8, (int)v5);
  }
  return v5;
}

//----- (0000000000041158) ----------------------------------------------------
_DWORD *__fastcall sub_41158(__int64 a1)
{
  _DWORD *v2; // rbx
  _DWORD *v3; // rax

  v2 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x19u, (__int64)&unk_5CCD8);
  }
  if ( (*(_DWORD *)a1 == 2 || *(_DWORD *)a1 == 1)
    && ((++*(_DWORD *)(a1 + 84), (v3 = ExpInterlockedPopEntrySList((PSLIST_HEADER)(a1 + 64))) != 0i64)
     || (++*(_DWORD *)(a1 + 88),
         (v3 = (_DWORD *)(*(__int64 (__fastcall **)(_QWORD, _QWORD, _QWORD))(a1 + 112))(
                           *(unsigned int *)(a1 + 100),
                           *(unsigned int *)(a1 + 108),
                           *(unsigned int *)(a1 + 104))) != 0i64)) )
  {
    *v3 = 0;
  }
  else
  {
    v3 = sub_40D90(*(_DWORD *)a1, *(_DWORD *)(a1 + 4) + 7, *(_DWORD *)(a1 + 8));
    if ( !v3 )
      goto LABEL_14;
    *v3 = 1;
  }
  v2 = v3 + 1;
  if ( v3 != (_DWORD *)-4i64 )
    memset(v3 + 1, 0, *(unsigned int *)(a1 + 4));
LABEL_14:
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x1Au, (__int64)&unk_5CCD8, (int)v2);
  }
  return v2;
}

//----- (000000000004125C) ----------------------------------------------------
__int64 __fastcall sub_4125C(_QWORD *a1)
{
  __int64 result; // rax

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    result = sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x2Fu, (__int64)&unk_5CCD8);
  }
  *a1 = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    result = sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x30u, (__int64)&unk_5CCD8);
  }
  return result;
}

//----- (00000000000412E0) ----------------------------------------------------
void __fastcall sub_412E0(PKSPIN_LOCK SpinLock, KIRQL *a2)
{
  unsigned __int8 v4; // si

  v4 = KeGetCurrentIrql();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x31u, (__int64)&unk_5CCD8);
  }
  if ( v4 == 2 )
  {
    *a2 = 2;
    KeAcquireSpinLockAtDpcLevel(SpinLock);
  }
  else
  {
    *a2 = KeAcquireSpinLockRaiseToDpc(SpinLock);
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x32u, (__int64)&unk_5CCD8);
  }
}

//----- (0000000000041398) ----------------------------------------------------
void __fastcall sub_41398(PKSPIN_LOCK SpinLock, KIRQL a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x33u, (__int64)&unk_5CCD8);
  }
  if ( a2 == 2 )
    KeReleaseSpinLockFromDpcLevel(SpinLock);
  else
    KeReleaseSpinLock(SpinLock, a2);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x34u, (__int64)&unk_5CCD8);
  }
}

//----- (000000000004143C) ----------------------------------------------------
bool __fastcall sub_4143C(struct _KEVENT **a1, char a2)
{
  struct _KEVENT *v4; // rax
  struct _KEVENT *v5; // rdi

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x35u, (__int64)&unk_5CCD8);
  }
  *a1 = 0i64;
  v4 = (struct _KEVENT *)sub_40D90(2, 0x18u, 0x6E634556u);
  v5 = v4;
  if ( v4 )
  {
    KeInitializeEvent(v4, (EVENT_TYPE)(a2 == 0), 0);
    *a1 = v5;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x36u, (__int64)&unk_5CCD8, v5 != 0i64);
  }
  return v5 != 0i64;
}

//----- (0000000000041524) ----------------------------------------------------
void __fastcall sub_41524(PVOID P)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x37u, (__int64)&unk_5CCD8);
  }
  KeClearEvent((PRKEVENT)P);
  sub_40EAC(P, 0x6E634556u);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x38u, (__int64)&unk_5CCD8);
  }
}

//----- (00000000000415BC) ----------------------------------------------------
int __fastcall sub_415BC(PRKEVENT Event)
{
  int result; // eax

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x39u, (__int64)&unk_5CCD8);
  }
  result = KeSetEvent(Event, 0, 0);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    result = sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x3Au, (__int64)&unk_5CCD8);
  }
  return result;
}

//----- (000000000004164C) ----------------------------------------------------
void __fastcall HandleInformation(PVOID StartContext)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x49u, (__int64)&unk_5CCD8);
  }
  (*(void (__fastcall **)(_QWORD))StartContext)(*((_QWORD *)StartContext + 1));
  sub_40EAC(StartContext, 0x6E635448u);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x4Au, (__int64)&unk_5CCD8);
  }
  PsTerminateSystemThread(0);
}

//----- (00000000000416E8) ----------------------------------------------------
unsigned __int8 __fastcall sub_416E8(PVOID *Object, __int64 a2, __int64 a3)
{
  unsigned __int8 v6; // bl
  _QWORD *v7; // rax
  _QWORD *StartContext; // rsi
  struct _OBJECT_ATTRIBUTES ObjectAttributes; // [rsp+40h] [rbp-48h] BYREF
  void *ThreadHandle; // [rsp+90h] [rbp+8h] BYREF

  v6 = 1;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x4Bu, (__int64)&unk_5CCD8);
  }
  v7 = sub_40D90(2, 0x10u, 0x6E635448u);
  *Object = 0i64;
  StartContext = v7;
  if ( !v7 )
    goto LABEL_10;
  memset(&ObjectAttributes.RootDirectory, 0, 0x28ui64);
  ThreadHandle = 0i64;
  ObjectAttributes.Length = 48;
  *StartContext = a2;
  StartContext[1] = a3;
  if ( !PsCreateSystemThread(
          &ThreadHandle,
          0x1FFFFFu,
          &ObjectAttributes,
          0i64,
          0i64,
          (PKSTART_ROUTINE)HandleInformation,
          StartContext) )
  {
    ObReferenceObjectByHandle(ThreadHandle, 0, 0i64, 0, Object, 0i64);
    ZwClose(ThreadHandle);
  }
  if ( !*Object )
  {
    sub_40EAC(StartContext, 0x6E635448u);
LABEL_10:
    v6 = 0;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x4Cu, (__int64)&unk_5CCD8, v6);
  }
  return v6;
}

//----- (0000000000041858) ----------------------------------------------------
__int64 __fastcall sub_41858(PVOID Object)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 result; // rax

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    result = sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x4Du, (__int64)&unk_5CCD8);
    v2 = off_60148;
  }
  if ( Object )
  {
    result = ObfDereferenceObject(Object);
    v2 = off_60148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    result = sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x4Eu, (__int64)&unk_5CCD8);
  }
  return result;
}

//----- (00000000000418EC) ----------------------------------------------------
__int64 __fastcall sub_418EC(void ***a1)
{
  void **v1; // r12
  __int64 v2; // rdi
  void *v4; // rax
  ULONG v5; // er14
  void *v6; // rdx
  PDEVICE_OBJECT v7; // r10
  unsigned int v8; // ebp
  __int64 v9; // rsi
  __int64 v10; // r13
  __int64 v11; // rsi
  _QWORD **v12; // rcx
  _QWORD *v13; // rbx
  _QWORD *v14; // rax
  char *v15; // rcx
  void (__fastcall *v16)(_QWORD *); // rax
  __int64 result; // rax
  PDEVICE_OBJECT v18; // rcx
  PVOID v19[2]; // [rsp+30h] [rbp-48h] BYREF
  __int64 v20; // [rsp+40h] [rbp-38h]
  KIRQL v21; // [rsp+80h] [rbp+8h] BYREF

  v1 = *a1;
  v2 = *((int *)a1 + 2);
  v4 = **a1;
  v5 = 2;
  v21 = 0;
  v19[0] = v4;
  v6 = (void *)*((_QWORD *)v1[3] + 3);
  v20 = 0i64;
  v19[1] = v6;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x53u, (__int64)&unk_5CCD8);
    v7 = off_60148;
  }
  if ( *((_BYTE *)v1 + 12) )
  {
    v5 = 3;
    v20 = *((_QWORD *)v1[3] + 4 * (unsigned int)v2 + 3);
  }
  if ( a1[2] )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v7->Queue.Wcb.DeviceRoutine) < 0
      && BYTE1(v7->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_112FC((__int64)v7->Queue.ListEntry.Blink, 0x54u, (__int64)&unk_5CCD8, v2);
    }
    sub_415BC((PRKEVENT)a1[2]);
  }
  while ( 1 )
  {
    result = sub_42488(v5, v19);
    if ( !(_DWORD)result )
      break;
    v8 = 0;
    v9 = 0i64;
    if ( (_DWORD)result == 2 )
    {
      v8 = v2;
      v9 = v2;
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
      && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x56u, (__int64)&unk_5CCD8, v2);
    }
    v10 = 32i64 * v8;
    sub_412E0((PKSPIN_LOCK)((char *)v1[3] + v10), &v21);
    v11 = 32 * v9;
    v12 = (_QWORD **)((char *)v1[3] + v11 + 8);
    v13 = 0i64;
    if ( *v12 != v12 )
    {
      v13 = *v12;
      v14 = (_QWORD *)**v12;
      *v12 = v14;
      v14[1] = v12;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
        && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_11430((__int64)off_60148->Queue.ListEntry.Blink, 0x57u, (__int64)&unk_5CCD8, v2);
      }
      v15 = (char *)v1[3];
      if ( *(char **)&v15[v11 + 8] != &v15[v11 + 8] )
        sub_415BC(*(PRKEVENT *)&v15[v11 + 24]);
    }
    sub_41398((PKSPIN_LOCK)((char *)v1[3] + v10), v21);
    if ( v13 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
        && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_11430((__int64)off_60148->Queue.ListEntry.Blink, 0x58u, (__int64)&unk_5CCD8, v2);
      }
      v16 = (void (__fastcall *)(_QWORD *))v13[3];
      if ( v16 )
        v16(v13 + 5);
      sub_42208((__int64)(v13 + 5), 0);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
        && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_11430((__int64)off_60148->Queue.ListEntry.Blink, 0x59u, (__int64)&unk_5CCD8, v2);
      }
    }
  }
  v18 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0 && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      result = sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x55u, (__int64)&unk_5CCD8, v2);
      v18 = off_60148;
    }
    if ( v18 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v18->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v18->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      result = sub_11008((__int64)v18->Queue.ListEntry.Blink, 0x5Au, (__int64)&unk_5CCD8);
    }
  }
  return result;
}

//----- (0000000000041BF8) ----------------------------------------------------
__int64 __fastcall sub_41BF8(unsigned int a1, char a2)
{
  __int64 v3; // r12
  int v4; // esi
  __int64 v5; // r14
  PVOID v6; // rax
  __int64 v7; // rdi
  unsigned int v8; // ebx
  PVOID v9; // rax
  _QWORD *v10; // r11
  __int64 v11; // r13
  unsigned int v12; // ebp
  __int64 v13; // rbx
  _QWORD *v14; // rax
  __int64 v16; // [rsp+30h] [rbp-48h] BYREF
  unsigned int v17; // [rsp+38h] [rbp-40h]
  PVOID P; // [rsp+40h] [rbp-38h] BYREF

  v3 = a1;
  v4 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x5Bu, (__int64)&unk_5CCD8);
  }
  v5 = 32i64;
  v6 = sub_40D90(2, 0x20u, 0x6E635450u);
  v7 = (__int64)v6;
  if ( !v6 )
    goto LABEL_24;
  memset(v6, 0, 0x20ui64);
  sub_4143C((struct _KEVENT **)v7, 1);
  *(_DWORD *)(v7 + 8) = v3;
  *(_BYTE *)(v7 + 12) = a2;
  *(_QWORD *)(v7 + 16) = sub_40D90(2, 8 * (int)v3, 0x6E635450u);
  v8 = a2 ? 32 * (v3 + 1) : 32;
  v9 = sub_40D90(2, v8, 0x6E635450u);
  *(_QWORD *)(v7 + 24) = v9;
  if ( *(_QWORD *)(v7 + 16) && v9 )
  {
    v16 = v7;
    sub_4143C((struct _KEVENT **)&P, 0);
    memset(*(void **)(v7 + 16), 0, 8 * v3);
    memset(*(void **)(v7 + 24), 0, v8);
    sub_4125C(*(_QWORD **)(v7 + 24));
    sub_4143C((struct _KEVENT **)(*(_QWORD *)(v7 + 24) + 24i64), 0);
    v10 = (_QWORD *)(*(_QWORD *)(v7 + 24) + 8i64);
    v10[1] = v10;
    *v10 = v10;
    if ( (_DWORD)v3 )
    {
      v11 = 0i64;
      v12 = 1;
      while ( 1 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
          && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_11430((__int64)off_60148->Queue.ListEntry.Blink, 0x5Cu, (__int64)&unk_5CCD8, v12);
        }
        v17 = v12;
        if ( a2 )
        {
          v13 = 32i64 * v12;
          sub_4125C((_QWORD *)(v13 + *(_QWORD *)(v7 + 24)));
          sub_4143C((struct _KEVENT **)(v13 + *(_QWORD *)(v7 + 24) + 24), 0);
          v14 = (_QWORD *)(v5 + *(_QWORD *)(v7 + 24) + 8);
          v14[1] = v14;
          *v14 = v14;
        }
        sub_416E8((PVOID *)(*(_QWORD *)(v7 + 16) + 8i64 * (v12 - 1)), (__int64)sub_418EC, (__int64)&v16);
        if ( !*(_QWORD *)(v11 + *(_QWORD *)(v7 + 16)) )
          break;
        sub_423B0(P, 0xFFFFFFFF);
        ++v12;
        v5 += 32i64;
        v11 += 8i64;
        if ( v12 - 1 >= (unsigned int)v3 )
          goto LABEL_23;
      }
      v4 = -16777213;
    }
LABEL_23:
    sub_41524(P);
  }
  else
  {
LABEL_24:
    v4 = -16777213;
  }
  if ( v4 && v7 )
  {
    sub_41EAC((PVOID)v7);
    v7 = 0i64;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x5Du, (__int64)&unk_5CCD8, v7);
  }
  return v7;
}

//----- (0000000000041EAC) ----------------------------------------------------
__int64 __fastcall sub_41EAC(PVOID P)
{
  PDEVICE_OBJECT v2; // rcx
  unsigned int v3; // eax
  __int64 v4; // rsi
  __int64 v5; // rbp
  __int64 v6; // r12
  PDEVICE_OBJECT v7; // rcx
  __int64 v8; // rdx
  _QWORD **v9; // rcx
  _QWORD *v10; // rdi
  _QWORD *v11; // rax
  unsigned int v12; // esi
  __int64 v13; // rdi
  __int64 v14; // rbp
  KIRQL v16; // [rsp+50h] [rbp+8h] BYREF

  v16 = 0;
  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x5Eu, (__int64)&unk_5CCD8);
    v2 = off_60148;
  }
  if ( *((_BYTE *)P + 12) )
    v3 = *((_DWORD *)P + 2) + 1;
  else
    v3 = 1;
  if ( v3 )
  {
    v4 = 0i64;
    v5 = 0i64;
    v6 = v3;
    do
    {
      sub_412E0((PKSPIN_LOCK)(v5 + *((_QWORD *)P + 3)), &v16);
      v7 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
        && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x5Fu, (__int64)&unk_5CCD8);
        v7 = off_60148;
      }
      v8 = *((_QWORD *)P + 3);
      if ( *(_QWORD *)(v4 + v8 + 8) != v4 + v8 + 8 )
      {
        do
        {
          v9 = (_QWORD **)(v4 + v8 + 8);
          v10 = *v9;
          v11 = (_QWORD *)**v9;
          *v9 = v11;
          v11[1] = v9;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
            && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 5u )
          {
            sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x60u, (__int64)&unk_5CCD8, (int)v10);
          }
          sub_42208((__int64)(v10 + 5), 1);
          v8 = *((_QWORD *)P + 3);
        }
        while ( *(_QWORD *)(v4 + v8 + 8) != v4 + v8 + 8 );
        v7 = off_60148;
      }
      if ( v7 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(v7->Queue.Wcb.DeviceRoutine) < 0
        && BYTE1(v7->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_11008((__int64)v7->Queue.ListEntry.Blink, 0x61u, (__int64)&unk_5CCD8);
      }
      sub_41398((PKSPIN_LOCK)(v5 + *((_QWORD *)P + 3)), v16);
      v5 += 32i64;
      v4 += 32i64;
      --v6;
    }
    while ( v6 );
    v2 = off_60148;
  }
  if ( *(_QWORD *)P )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v2->Queue.Wcb.DeviceRoutine) < 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x62u, (__int64)&unk_5CCD8);
    }
    sub_415BC(*(PRKEVENT *)P);
    v2 = off_60148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v2->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_112FC((__int64)v2->Queue.ListEntry.Blink, 0x63u, (__int64)&unk_5CCD8, *((_DWORD *)P + 2));
    v2 = off_60148;
  }
  v12 = 0;
  if ( *((_DWORD *)P + 2) )
  {
    v13 = 0i64;
    v14 = 32i64;
    do
    {
      if ( *(_QWORD *)(v13 + *((_QWORD *)P + 2)) )
      {
        if ( v2 != (PDEVICE_OBJECT)&off_60148
          && SBYTE4(v2->Queue.Wcb.DeviceRoutine) < 0
          && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_112FC((__int64)v2->Queue.ListEntry.Blink, 0x64u, (__int64)&unk_5CCD8, v12);
        }
        sub_423B0(*(PVOID *)(v13 + *((_QWORD *)P + 2)), 0xFFFFFFFF);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
          && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x65u, (__int64)&unk_5CCD8, v12);
        }
        sub_41858(*(PVOID *)(v13 + *((_QWORD *)P + 2)));
        *(_QWORD *)(v13 + *((_QWORD *)P + 2)) = 0i64;
        if ( *((_BYTE *)P + 12) )
          sub_41524(*(PVOID *)(*((_QWORD *)P + 3) + v14 + 24));
        v2 = off_60148;
      }
      ++v12;
      v14 += 32i64;
      v13 += 8i64;
    }
    while ( v12 < *((_DWORD *)P + 2) );
  }
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v2->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x66u, (__int64)&unk_5CCD8);
  }
  sub_41524(*(PVOID *)(*((_QWORD *)P + 3) + 24i64));
  sub_41524(*(PVOID *)P);
  sub_40EAC(*((PVOID *)P + 2), 0x6E635450u);
  sub_40EAC(*((PVOID *)P + 3), 0x6E635450u);
  sub_40EAC(P, 0x6E635450u);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x67u, (__int64)&unk_5CCD8);
  }
  return 0i64;
}

//----- (0000000000042208) ----------------------------------------------------
void __fastcall sub_42208(__int64 a1, char a2)
{
  PDEVICE_OBJECT v4; // rcx
  void (__fastcall *v5)(__int64); // rax

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x6Bu, (__int64)&unk_5CCD8);
    v4 = off_60148;
  }
  if ( a1 )
  {
    if ( a2 )
    {
      v5 = *(void (__fastcall **)(__int64))(a1 - 8);
      if ( v5 )
        v5(a1);
    }
    sub_40EAC((PVOID)(a1 - 40), 0x6E635749u);
    v4 = off_60148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)v4->Queue.ListEntry.Blink, 0x6Cu, (__int64)&unk_5CCD8);
  }
}

//----- (00000000000422CC) ----------------------------------------------------
void __fastcall sub_422CC(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 v3; // rdi
  _QWORD *v4; // rbx
  KSPIN_LOCK *v5; // rcx
  __int64 v6; // r11
  _QWORD *v7; // rax
  KIRQL v8; // [rsp+30h] [rbp+8h] BYREF

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x6Du, (__int64)&unk_5CCD8);
    v2 = off_60148;
  }
  if ( a1 )
  {
    v3 = *(_QWORD *)(a1 - 24);
    v4 = (_QWORD *)(a1 - 40);
    v5 = *(KSPIN_LOCK **)(v3 + 24);
    v8 = 0;
    sub_412E0(v5, &v8);
    v6 = *(_QWORD *)(v3 + 24);
    v7 = *(_QWORD **)(v6 + 16);
    v6 += 8i64;
    v4[1] = v7;
    *v4 = v6;
    *v7 = v4;
    *(_QWORD *)(v6 + 8) = v4;
    sub_415BC(*(PRKEVENT *)(*(_QWORD *)(v3 + 24) + 24i64));
    sub_41398(*(PKSPIN_LOCK *)(v3 + 24), v8);
    v2 = off_60148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)v2->Queue.ListEntry.Blink, 0x6Eu, (__int64)&unk_5CCD8);
  }
}

//----- (00000000000423B0) ----------------------------------------------------
__int64 __fastcall sub_423B0(PVOID Object, unsigned int a2)
{
  __int64 v2; // rbx
  int v4; // eax
  unsigned int v5; // ebx
  union _LARGE_INTEGER v7; // [rsp+40h] [rbp+8h] BYREF

  v7.QuadPart = 0i64;
  v2 = a2;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x6Fu, (__int64)&unk_5CCD8);
  }
  if ( (_DWORD)v2 == -1 )
  {
    v4 = KeWaitForSingleObject(Object, Executive, 0, 0, 0i64);
  }
  else
  {
    v7.QuadPart = -10000 * v2;
    v4 = KeWaitForSingleObject(Object, Executive, 0, 0, &v7);
  }
  v5 = v4;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x70u, (__int64)&unk_5CCD8, v4);
  }
  return v5;
}

//----- (0000000000042488) ----------------------------------------------------
__int64 __fastcall sub_42488(ULONG Count, PVOID Object[])
{
  struct _KWAIT_BLOCK *WaitBlockArray; // rdi
  unsigned int v6; // ebx

  WaitBlockArray = 0i64;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11008((__int64)off_60148->Queue.ListEntry.Blink, 0x71u, (__int64)&unk_5CCD8);
  }
  if ( Count > 3 )
  {
    WaitBlockArray = (struct _KWAIT_BLOCK *)sub_40D90(2, 48 * Count, 0x6E635742u);
    if ( !WaitBlockArray )
      return 4278190083i64;
  }
  v6 = KeWaitForMultipleObjects(Count, Object, WaitAny, Executive, 0, 0, 0i64, WaitBlockArray);
  if ( WaitBlockArray )
    sub_40EAC(WaitBlockArray, 0x6E635742u);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_112FC((__int64)off_60148->Queue.ListEntry.Blink, 0x72u, (__int64)&unk_5CCD8, v6);
  }
  return v6;
}

//----- (0000000000042594) ----------------------------------------------------
__int64 sub_42594()
{
  unsigned __int8 v0; // bl
  unsigned __int8 v2; // [rsp+48h] [rbp+10h]
  unsigned __int8 v3; // [rsp+50h] [rbp+18h]

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x12u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xAu, (__int64)&unk_5CCB8, 1);
  }
  v0 = KeGetCurrentIrql();
  __writecr8(2ui64);
  v3 = 0;
  KeStallExecutionProcessor(1u);
  v2 = 0;
  __writecr8(v0);
  qword_62308 = v2 - (unsigned __int64)v3;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x12u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11148(*(_QWORD *)&off_60148->AlignmentRequirement, 0xBu, (__int64)&unk_5CCB8, 1);
  }
  KeQueryPerformanceCounter(&PerformanceFrequency);
  byte_62223 = 1;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x12u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xCu, (__int64)&unk_5CCB8, 0);
  }
  return 0i64;
}
// 62223: using guessed type char byte_62223;
// 62308: using guessed type __int64 qword_62308;

//----- (00000000000426C8) ----------------------------------------------------
__int64 sub_426C8()
{
  PDEVICE_OBJECT v0; // rcx

  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x12u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xDu, (__int64)&unk_5CCB8);
      v0 = off_60148;
    }
    if ( v0 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v0->DeviceQueue.DeviceListHead.Flink + 1, 0x12u)
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_112FC(*(_QWORD *)&v0->AlignmentRequirement, 0xEu, (__int64)&unk_5CCB8, 0);
    }
  }
  return 0i64;
}

//----- (0000000000042754) ----------------------------------------------------
__int64 __fastcall sub_42754(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+168h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CCA8, 119i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000042898) ----------------------------------------------------
__int64 __fastcall sub_42898(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5, const char *a6)
{
  int v8; // [rsp+88h] [rbp+20h] BYREF

  v8 = a4;
  if ( a6 )
    strlen(a6);
  if ( a5 )
    strlen(a5);
  return qword_61238(a1, 43i64, &unk_5CCA8, 336i64, &v8);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000042960) ----------------------------------------------------
__int64 __fastcall sub_42960(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CCA8, 39i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000429B4) ----------------------------------------------------
__int64 sub_429B4(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  *((int *)va + 4) = 0;
  *((int *)va + 2) = 0;
  return qword_61238(a1, 43i64, &unk_5CCA8, 264i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000042A20) ----------------------------------------------------
__int64 sub_42A20(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+C8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CCA8, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000042AB8) ----------------------------------------------------
__int64 sub_42AB8(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CCA8, 321i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000042B1C) ----------------------------------------------------
__int64 sub_42B1C(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+A8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CCA8, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000042B9C) ----------------------------------------------------
__int64 sub_42B9C(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CCA8, 32i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000042C00) ----------------------------------------------------
__int64 sub_42C00(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CCA8, 317i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000042C74) ----------------------------------------------------
_BYTE *__fastcall sub_42C74(__int64 a1, int a2)
{
  __int64 v2; // rbx
  unsigned __int16 v5; // dx
  _BYTE *v6; // rdi
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  int v12; // eax
  unsigned __int8 v13; // al
  __int64 v14; // rbx
  unsigned __int16 v15; // dx
  __int64 v16[9]; // [rsp+30h] [rbp-48h] BYREF
  unsigned __int8 v17; // [rsp+88h] [rbp+10h] BYREF
  char v18; // [rsp+90h] [rbp+18h] BYREF
  unsigned __int16 v19; // [rsp+98h] [rbp+20h] BYREF

  v2 = 0i64;
  v18 = 0;
  v16[0] = 0i64;
  v17 = -1;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11148(*(_QWORD *)&off_60148->AlignmentRequirement, 0xAu, (__int64)&unk_5CCA8, a2);
  }
  sub_43A18(a1, &v19);
  v5 = v19;
  v6 = (_BYTE *)(a1 + 14);
  if ( v19 == 2048 || v19 == 0x86DD )
  {
    sub_43ADC(v6, &v18);
    v5 = v19;
    if ( v19 == 2048 && v18 != 4 || v19 == 0x86DD && v18 != 6 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0xDu, (__int64)&unk_5CCA8, v19);
      }
      return 0i64;
    }
LABEL_20:
    switch ( a2 )
    {
      case 1:
        if ( v5 != 2048 )
        {
          v7 = off_60148;
          if ( off_60148 == (PDEVICE_OBJECT)&off_60148
            || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
            || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
          {
            return 0i64;
          }
          v8 = 15;
          goto LABEL_119;
        }
        v9 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          v10 = 14;
LABEL_26:
          sub_11008(*(_QWORD *)&v9->AlignmentRequirement, v10, (__int64)&unk_5CCA8);
          return v6;
        }
        return v6;
      case 2:
        if ( v5 != 0x86DD )
        {
          v7 = off_60148;
          if ( off_60148 == (PDEVICE_OBJECT)&off_60148
            || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
            || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
          {
            return 0i64;
          }
          v8 = 17;
          goto LABEL_119;
        }
        v9 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          v10 = 16;
          goto LABEL_26;
        }
        return v6;
      case 7:
        if ( v5 != 2054 )
        {
          v7 = off_60148;
          if ( off_60148 == (PDEVICE_OBJECT)&off_60148
            || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
            || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
          {
            return 0i64;
          }
          v8 = 19;
          goto LABEL_119;
        }
        v9 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          v10 = 18;
          goto LABEL_26;
        }
        return v6;
    }
    if ( v5 == 2048 )
    {
      if ( sub_45B18((__int64)v6) )
      {
        v7 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148
          || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
          || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 3u )
        {
          return 0i64;
        }
        v8 = 20;
        goto LABEL_119;
      }
      v14 = 4 * (*v6 & 0xF);
      v13 = v6[9];
      v17 = v13;
      v2 = (__int64)&v6[v14];
    }
    else
    {
      if ( v5 == 34525 )
      {
        if ( sub_46BE8((__int64)v6) )
        {
          v7 = off_60148;
          if ( off_60148 == (PDEVICE_OBJECT)&off_60148
            || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
            || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 3u )
          {
            return 0i64;
          }
          v8 = 21;
          goto LABEL_119;
        }
        v12 = sub_44214((__int64)v6, &v17, v16, 0i64);
        if ( v12 )
        {
          v7 = off_60148;
          if ( off_60148 == (PDEVICE_OBJECT)&off_60148
            || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
            || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
          {
            v2 = v16[0];
            v13 = v17;
LABEL_74:
            if ( v13 != 6 && v13 != 17 && v13 != 1 && v13 != 58 )
            {
              if ( v7 == (PDEVICE_OBJECT)&off_60148
                || (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
                || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
              {
                return 0i64;
              }
              v8 = 23;
              goto LABEL_119;
            }
            switch ( a2 )
            {
              case 3:
                if ( v13 != 6 )
                {
                  if ( v7 == (PDEVICE_OBJECT)&off_60148
                    || (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
                    || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
                  {
                    return 0i64;
                  }
                  v8 = 25;
                  goto LABEL_119;
                }
                if ( v7 != (PDEVICE_OBJECT)&off_60148
                  && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
                  && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
                {
                  v15 = 24;
LABEL_88:
                  sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v15, (__int64)&unk_5CCA8);
                  return (_BYTE *)v2;
                }
                break;
              case 4:
                if ( v13 != 17 )
                {
                  if ( v7 == (PDEVICE_OBJECT)&off_60148
                    || (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
                    || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
                  {
                    return 0i64;
                  }
                  v8 = 27;
                  goto LABEL_119;
                }
                if ( v7 != (PDEVICE_OBJECT)&off_60148
                  && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
                  && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
                {
                  v15 = 26;
                  goto LABEL_88;
                }
                break;
              case 6:
                if ( v13 != 1 && v13 != 58 )
                {
                  if ( v7 == (PDEVICE_OBJECT)&off_60148
                    || (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
                    || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
                  {
                    return 0i64;
                  }
                  v8 = 29;
                  goto LABEL_119;
                }
                if ( v7 != (PDEVICE_OBJECT)&off_60148
                  && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
                  && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
                {
                  v15 = 28;
                  goto LABEL_88;
                }
                break;
              default:
                if ( v7 == (PDEVICE_OBJECT)&off_60148
                  || (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
                  || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
                {
                  return 0i64;
                }
                v8 = 31;
                goto LABEL_119;
            }
            return (_BYTE *)v2;
          }
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x16u, (__int64)&unk_5CCA8, v12);
        }
        v2 = v16[0];
      }
      v13 = v17;
    }
    v7 = off_60148;
    goto LABEL_74;
  }
  if ( v19 == 2054 )
    goto LABEL_20;
  v7 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148
    || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
    || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
  {
    return 0i64;
  }
  v8 = 12;
LABEL_119:
  sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_5CCA8);
  return 0i64;
}

//----- (00000000000431D0) ----------------------------------------------------
__int64 __fastcall sub_431D0(__int64 a1, unsigned int a2, __int64 *a3)
{
  __int64 result; // rax
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  int v11; // eax
  __int64 v12; // rdx
  unsigned __int8 v13; // al
  _BYTE *v14; // rcx
  __int64 v15; // rdx
  __int64 v16; // rax
  unsigned __int16 v17[2]; // [rsp+30h] [rbp-38h] BYREF
  int v18; // [rsp+34h] [rbp-34h] BYREF
  __int64 v19; // [rsp+38h] [rbp-30h] BYREF
  char v20; // [rsp+78h] [rbp+10h] BYREF
  unsigned __int8 v21; // [rsp+88h] [rbp+20h] BYREF

  v21 = -1;
  v19 = 0i64;
  v17[0] = 0;
  v18 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_42B9C(*(_QWORD *)&off_60148->AlignmentRequirement, 32i64, (__int64)&unk_5CCA8, a3, a2, a1);
  }
  result = (__int64)memset(a3, 0, 0x60ui64);
  if ( a2 < 0xE )
  {
    v7 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v8 = 33;
      return sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_5CCA8);
    }
    return result;
  }
  *a3 = a1;
  result = sub_43A18(a1, v17);
  if ( v17[0] == 2048 )
  {
    if ( a2 < 0x17 )
    {
      v7 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v8 = 34;
        return sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_5CCA8);
      }
      return result;
    }
    result = sub_43ADC((_BYTE *)(a1 + 14), &v20);
    if ( v20 != 4 )
    {
      v7 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v8 = 35;
        return sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_5CCA8);
      }
      return result;
    }
    a3[2] = a1 + 14;
    if ( sub_45B18(a1 + 14) )
    {
      *((_WORD *)a3 + 44) |= 1u;
      v9 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v10 = 36;
        goto LABEL_59;
      }
      goto LABEL_85;
    }
    v14 = (_BYTE *)a3[2];
    v15 = 4 * (*v14 & 0xF);
    v13 = v14[9];
    v21 = v13;
    v12 = (__int64)&v14[v15];
    goto LABEL_61;
  }
  if ( v17[0] == 2054 )
  {
    a3[1] = (__int64)sub_42C74(a1, 7);
    goto LABEL_85;
  }
  if ( v17[0] != 34525 )
  {
    v9 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v10 = 42;
LABEL_59:
      sub_11008(*(_QWORD *)&v9->AlignmentRequirement, v10, (__int64)&unk_5CCA8);
      goto LABEL_85;
    }
    goto LABEL_85;
  }
  if ( a2 >= 0x14 )
  {
    result = sub_43ADC((_BYTE *)(a1 + 14), &v20);
    if ( v20 != 6 )
    {
      v7 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v8 = 38;
        return sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_5CCA8);
      }
      return result;
    }
    result = sub_44150(a1 + 14, &v18);
    if ( a2 < v18 + 14 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        result = sub_42960(*(_QWORD *)&off_60148->AlignmentRequirement, 39i64, (__int64)&unk_5CCA8, a2);
      }
      return result;
    }
    a3[3] = a1 + 14;
    if ( sub_46BE8(a1 + 14) )
    {
      *((_WORD *)a3 + 44) |= 1u;
      v9 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v10 = 40;
        goto LABEL_59;
      }
      goto LABEL_85;
    }
    v11 = sub_44214(a3[3], &v21, &v19, 0i64);
    if ( v11 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x29u, (__int64)&unk_5CCA8, v11);
      }
      goto LABEL_85;
    }
    v12 = v19;
    v13 = v21;
LABEL_61:
    if ( a2 >= (int)v12 - (int)a1 )
    {
      if ( v13 == 1 )
      {
        a3[7] = v12;
        goto LABEL_85;
      }
      if ( v13 == 6 )
      {
        a3[4] = v12;
        result = (unsigned int)v12 + ((*(unsigned __int8 *)(v12 + 12) >> 2) & 0x3C) - (_DWORD)a1;
        if ( a2 < (unsigned int)result )
        {
          v7 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            v8 = 45;
            return sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_5CCA8);
          }
          return result;
        }
        v16 = v12 + (((unsigned __int64)*(unsigned __int8 *)(v12 + 12) >> 2) & 0x3C);
      }
      else
      {
        if ( v13 != 17 )
        {
          if ( v13 == 58 )
            a3[8] = v12;
          goto LABEL_85;
        }
        result = (unsigned int)(v12 - a1 + 8);
        a3[5] = v12;
        if ( a2 < (unsigned int)result )
        {
          v7 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            v8 = 44;
            return sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_5CCA8);
          }
          return result;
        }
        v16 = v12 + 8;
      }
      a3[6] = v16;
      goto LABEL_85;
    }
    v9 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v10 = 43;
      goto LABEL_59;
    }
LABEL_85:
    result = sub_4371C(a1, a2, (__int64)a3);
    v7 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v8 = 46;
      return sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_5CCA8);
    }
    return result;
  }
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    v8 = 37;
    return sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_5CCA8);
  }
  return result;
}

//----- (000000000004371C) ----------------------------------------------------
__int64 __fastcall sub_4371C(__int64 a1, int a2, __int64 a3)
{
  _BYTE *v3; // rcx
  __int64 v5; // rcx
  int v6; // er11
  int v7; // eax
  int v8; // er11
  __int64 v9; // rcx
  __int64 v10; // rcx
  __int64 v11; // rcx
  PDEVICE_OBJECT v12; // rcx
  int v13; // edx
  unsigned int v14; // er9
  __int64 result; // rax
  unsigned __int16 v16; // [rsp+58h] [rbp+10h] BYREF
  int v17; // [rsp+60h] [rbp+18h] BYREF

  v3 = *(_BYTE **)(a3 + 16);
  *(_DWORD *)(a3 + 72) = a2;
  if ( v3 )
  {
    LOBYTE(v16) = 0;
    LOWORD(v17) = 0;
    sub_43B8C(v3, &v16);
    v5 = *(_QWORD *)(a3 + 16);
    LOBYTE(v16) = 4 * v16;
    sub_43C3C(v5, &v17);
    v6 = (unsigned __int16)v17;
    v7 = (unsigned __int8)v16;
    *(_DWORD *)(a3 + 76) = (unsigned __int16)v17;
    v8 = v6 - v7;
  }
  else
  {
    v9 = *(_QWORD *)(a3 + 24);
    if ( !v9 )
      goto LABEL_6;
    v17 = 0;
    v16 = 0;
    sub_446D0(v9, &v16);
    v10 = *(_QWORD *)(a3 + 24);
    *(_DWORD *)(a3 + 76) = v16 + 40;
    sub_46554(v10, &v17);
    v8 = v16 - v17;
  }
  *(_DWORD *)(a3 + 80) = v8;
LABEL_6:
  v11 = *(_QWORD *)(a3 + 32);
  if ( v11 )
  {
    LOBYTE(v16) = 0;
    sub_45050(v11, &v16);
    *(_DWORD *)(a3 + 84) = *(_DWORD *)(a3 + 80) - (unsigned __int8)(4 * v16);
  }
  else if ( *(_QWORD *)(a3 + 40) )
  {
    *(_DWORD *)(a3 + 84) = *(_DWORD *)(a3 + 80) - 8;
  }
  v12 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_114E4(*(_QWORD *)&off_60148->AlignmentRequirement, 0x2Fu, (__int64)&unk_5CCA8, *(_DWORD *)(a3 + 72));
    v12 = off_60148;
  }
  v13 = *(_DWORD *)(a3 + 76);
  v14 = *(_DWORD *)(a3 + 72);
  result = (unsigned int)(v13 + 14);
  if ( v14 > (unsigned int)result
    && v12 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v12->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v12->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    result = sub_112FC(*(_QWORD *)&v12->AlignmentRequirement, 0x30u, (__int64)&unk_5CCA8, v14 - v13 - 14);
  }
  return result;
}

//----- (00000000000438AC) ----------------------------------------------------
__int64 __fastcall sub_438AC(__int64 a1, __int64 a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x31u, (__int64)&unk_5CCA8, a1, a2);
  }
  *(_DWORD *)a2 = *(_DWORD *)(a1 + 6);
  *(_WORD *)(a2 + 4) = *(_WORD *)(a1 + 10);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x32u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000043964) ----------------------------------------------------
__int64 __fastcall sub_43964(__int64 a1, __int64 a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x33u, (__int64)&unk_5CCA8, a1, a2);
  }
  *(_DWORD *)a2 = *(_DWORD *)a1;
  *(_WORD *)(a2 + 4) = *(_WORD *)(a1 + 4);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x34u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000043A18) ----------------------------------------------------
__int64 __fastcall sub_43A18(__int64 a1, _WORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x35u, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 12)) | ((unsigned __int8)*(_WORD *)(a1 + 12) << 8);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x36u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000043ADC) ----------------------------------------------------
__int64 __fastcall sub_43ADC(_BYTE *a1, _BYTE *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x37u, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = *a1 >> 4;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x38u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000043B8C) ----------------------------------------------------
__int64 __fastcall sub_43B8C(_BYTE *a1, _BYTE *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x39u, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = *a1 & 0xF;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Au, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000043C3C) ----------------------------------------------------
__int64 __fastcall sub_43C3C(__int64 a1, _WORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Du, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 2)) | ((unsigned __int8)*(_WORD *)(a1 + 2) << 8);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Eu, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000043D00) ----------------------------------------------------
__int64 __fastcall sub_43D00(__int64 a1, _WORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Fu, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 4)) | ((unsigned __int8)*(_WORD *)(a1 + 4) << 8);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x40u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000043DC4) ----------------------------------------------------
__int64 __fastcall sub_43DC4(__int64 a1, _BYTE *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x41u, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = *(_BYTE *)(a1 + 6) >> 5;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x42u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000043E74) ----------------------------------------------------
__int64 __fastcall sub_43E74(__int64 a1, _WORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x43u, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = _byteswap_ushort(*(_WORD *)(a1 + 6)) & 0x1FFF;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x44u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000043F40) ----------------------------------------------------
__int64 __fastcall sub_43F40(__int64 a1, _BYTE *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x47u, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = *(_BYTE *)(a1 + 9);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x48u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000043FF0) ----------------------------------------------------
__int64 __fastcall sub_43FF0(__int64 a1, _DWORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x4Bu, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = *(_DWORD *)(a1 + 12);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x4Cu, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (00000000000440A0) ----------------------------------------------------
__int64 __fastcall sub_440A0(__int64 a1, _DWORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x4Du, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = *(_DWORD *)(a1 + 16);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x4Eu, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000044150) ----------------------------------------------------
__int64 __fastcall sub_44150(__int64 a1, _DWORD *a2)
{
  unsigned __int16 v5; // [rsp+38h] [rbp+10h] BYREF

  v5 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x51u, (__int64)&unk_5CCA8, a1);
  }
  sub_446D0(a1, &v5);
  *a2 = v5 + 40;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x52u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000044214) ----------------------------------------------------
__int64 __fastcall sub_44214(__int64 a1, unsigned __int8 *a2, _QWORD *a3, _WORD *a4)
{
  PDEVICE_OBJECT v8; // rcx
  unsigned int v9; // ebx
  unsigned __int8 v10; // si
  unsigned __int8 v11; // di
  unsigned __int64 v13; // [rsp+30h] [rbp-58h] BYREF
  __int16 v14[20]; // [rsp+38h] [rbp-50h] BYREF
  char v15; // [rsp+90h] [rbp+8h]
  char v16; // [rsp+91h] [rbp+9h]
  char v17; // [rsp+92h] [rbp+Ah]

  v13 = 0i64;
  memset(v14, 0, sizeof(v14));
  v15 = 6;
  v16 = 17;
  v17 = 58;
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x53u, (__int64)&unk_5CCA8);
    v8 = off_60148;
  }
  if ( a1 && a2 )
  {
    *a2 = 0;
    if ( a4 )
      *a4 = 0;
    if ( a3 )
      *a3 = 0i64;
    if ( sub_444FC(a1) )
    {
      v8 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x55u, (__int64)&unk_5CCA8);
        v8 = off_60148;
      }
      v9 = 18;
    }
    else
    {
      v8 = off_60148;
      v10 = 0;
      while ( 1 )
      {
        v11 = *(&v15 + v10);
        if ( v8 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_112FC(*(_QWORD *)&v8->AlignmentRequirement, 0x56u, (__int64)&unk_5CCA8, v11);
        }
        v9 = sub_461F4(a1, v11, &v13);
        if ( !v9 )
          break;
        v8 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x58u, (__int64)&unk_5CCA8, v9);
          v8 = off_60148;
        }
        if ( ++v10 >= 3u )
          goto LABEL_43;
      }
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x57u, (__int64)&unk_5CCA8, v11);
      }
      *a2 = v11;
      if ( a4 )
        *a4 = v14[8];
      if ( a3 )
        *a3 = v13;
      v8 = off_60148;
    }
  }
  else
  {
    if ( v8 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_385D4(*(_QWORD *)&v8->AlignmentRequirement, 0x54u, (__int64)&unk_5CCA8, a1, a2, a4);
      v8 = off_60148;
    }
    v9 = 4;
  }
LABEL_43:
  if ( v8 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v8->AlignmentRequirement, 0x59u, (__int64)&unk_5CCA8);
  }
  return v9;
}

//----- (00000000000444FC) ----------------------------------------------------
char __fastcall sub_444FC(__int64 a1)
{
  char v1; // bl
  PDEVICE_OBJECT v3; // rcx
  unsigned __int64 v5; // [rsp+20h] [rbp-38h] BYREF
  _BYTE v6[40]; // [rsp+28h] [rbp-30h] BYREF
  unsigned __int16 v7; // [rsp+60h] [rbp+8h] BYREF

  v1 = 0;
  v5 = 0i64;
  memset(v6, 0, sizeof(v6));
  v7 = 0;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x5Au, (__int64)&unk_5CCA8);
    v3 = off_60148;
  }
  if ( a1 )
  {
    sub_446D0(a1, &v7);
    if ( !(unsigned int)sub_461F4(a1, 0, &v5) )
    {
      v3 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x5Cu, (__int64)&unk_5CCA8);
        v3 = off_60148;
      }
      if ( !v7 )
      {
        if ( v3 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 3u )
        {
          sub_11008(*(_QWORD *)&v3->AlignmentRequirement, 0x5Du, (__int64)&unk_5CCA8);
          v3 = off_60148;
        }
        v1 = 1;
      }
      goto LABEL_26;
    }
    v3 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
      return v1;
    if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
      goto LABEL_26;
    }
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x5Eu, (__int64)&unk_5CCA8);
    goto LABEL_25;
  }
  if ( v3 == (PDEVICE_OBJECT)&off_60148 )
    return v1;
  if ( (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0 && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_2F80C(*(_QWORD *)&v3->AlignmentRequirement, 0x5Bu, (__int64)&unk_5CCA8, 0i64, v5);
LABEL_25:
    v3 = off_60148;
  }
LABEL_26:
  if ( v3 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v3->AlignmentRequirement, 0x5Fu, (__int64)&unk_5CCA8);
  }
  return v1;
}

//----- (00000000000446D0) ----------------------------------------------------
__int64 __fastcall sub_446D0(__int64 a1, unsigned __int16 *a2)
{
  unsigned __int16 v4; // dx

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x68u, (__int64)&unk_5CCA8, a1, a2);
  }
  v4 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 4)) | ((unsigned __int8)*(_WORD *)(a1 + 4) << 8);
  *a2 = v4;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x69u, (__int64)&unk_5CCA8, v4);
  }
  return 0i64;
}

//----- (0000000000044798) ----------------------------------------------------
__int64 __fastcall sub_44798(__int64 a1, unsigned __int8 *a2)
{
  unsigned __int8 v4; // al

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Au, (__int64)&unk_5CCA8, a1, a2);
  }
  v4 = *(_BYTE *)(a1 + 6);
  *a2 = v4;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Bu, (__int64)&unk_5CCA8, v4);
  }
  return 0i64;
}

//----- (000000000004484C) ----------------------------------------------------
__int64 __fastcall sub_4484C(__int64 a1, __m128i *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Eu, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = _mm_loadu_si128((const __m128i *)(a1 + 8));
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Fu, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000044900) ----------------------------------------------------
__int64 __fastcall sub_44900(__int64 a1, __m128i *a2)
{
  int v4; // eax
  PDEVICE_OBJECT v5; // rcx
  unsigned __int64 v7; // [rsp+30h] [rbp-38h] BYREF
  _BYTE v8[40]; // [rsp+38h] [rbp-30h] BYREF

  v7 = 0i64;
  memset(v8, 0, sizeof(v8));
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x70u, (__int64)&unk_5CCA8, a1, a2);
  }
  if ( (unsigned int)sub_461F4(a1, 0x2Bu, &v7) )
    goto LABEL_11;
  v4 = sub_44A5C(&v7, a2);
  if ( v4 )
  {
    v5 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    {
LABEL_16:
      *a2 = _mm_loadu_si128((const __m128i *)(a1 + 24));
      goto LABEL_17;
    }
    if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
LABEL_12:
      if ( v5 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v5->AlignmentRequirement, 0x72u, (__int64)&unk_5CCA8);
      }
      goto LABEL_16;
    }
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x71u, (__int64)&unk_5CCA8, v4);
LABEL_11:
    v5 = off_60148;
    goto LABEL_12;
  }
LABEL_17:
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x73u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000044A5C) ----------------------------------------------------
__int64 __fastcall sub_44A5C(_BYTE *a1, __m128i *a2)
{
  __m128i *v2; // r12
  const __m128i *v4; // r15
  unsigned __int8 v5; // di
  PDEVICE_OBJECT v6; // rcx
  bool v7; // bp
  const char *v8; // r8
  __int64 v9; // rcx
  const char *v10; // rax
  unsigned int v11; // ebx
  unsigned __int8 v12; // di
  __int64 v13; // rax
  unsigned __int16 v14; // r9
  unsigned __int16 v15; // ax
  unsigned __int16 v17; // [rsp+F0h] [rbp+8h]
  __m128i *v18; // [rsp+F8h] [rbp+10h]
  const __m128i *v19; // [rsp+108h] [rbp+20h]

  v18 = a2;
  v2 = a2;
  v4 = 0i64;
  v19 = 0i64;
  v5 = -1;
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x74u, (__int64)&unk_5CCA8);
    v6 = off_60148;
  }
  v7 = 0;
  if ( *(_QWORD *)a1 )
  {
    v5 = *(_BYTE *)(*(_QWORD *)a1 + 2i64);
    if ( !v5 || v5 > 1u && v5 <= 3u )
      v7 = 1;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    if ( v5 )
    {
      switch ( v5 )
      {
        case 1u:
          v8 = "NIMROD";
          break;
        case 2u:
          v8 = "MOBILITY";
          break;
        case 3u:
          v8 = "RPL";
          break;
        case 4u:
          v8 = "SEGMENT";
          break;
        case 0xFDu:
          v8 = "EXP_1";
          break;
        case 0xFEu:
          v8 = "EXP_2";
          break;
        default:
          v8 = "UNKNOWN";
          break;
      }
    }
    else
    {
      v8 = "SOURCE_ROUTE";
    }
    v9 = *(_QWORD *)&v6->AlignmentRequirement;
    v10 = "NOT";
    if ( v7 )
      v10 = (const char *)&unk_5CE78;
    sub_42898(v9, 336i64, (__int64)&unk_5CCA8, v5, v8, v10);
    v6 = off_60148;
  }
  if ( v7 )
  {
    if ( *(_QWORD *)a1 && *(_BYTE *)(*(_QWORD *)a1 + 3i64) )
    {
      v12 = (unsigned __int8)(a1[24] - 8) >> 4;
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x76u, (__int64)&unk_5CCA8);
        v6 = off_60148;
      }
      v13 = *(_QWORD *)a1;
      if ( *(_QWORD *)a1 )
      {
        v4 = (const __m128i *)(v13 + 8);
        v19 = (const __m128i *)(v13 + 8);
      }
      v14 = 0;
      v17 = 0;
      if ( v12 )
      {
        do
        {
          if ( v6 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            v4 = v19;
            sub_42754(*(_QWORD *)&off_60148->AlignmentRequirement, 119i64, (__int64)&unk_5CCA8, v17);
            v6 = off_60148;
            v14 = v17;
            v2 = v18;
          }
          ++v14;
          v15 = v12;
          v17 = v14;
          if ( v14 == v12 )
          {
            if ( v6 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
              && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
            {
              sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x78u, (__int64)&unk_5CCA8);
              v14 = v17;
              v15 = v12;
            }
            *v2 = _mm_loadu_si128(v4);
          }
          else
          {
            v19 = ++v4;
          }
          v6 = off_60148;
        }
        while ( v14 < v15 );
      }
      v11 = 0;
      *v2 = _mm_loadu_si128(v4);
    }
    else
    {
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x75u, (__int64)&unk_5CCA8);
      }
      v11 = 6;
    }
  }
  else
  {
    v11 = 18;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x79u, (__int64)&unk_5CCA8);
  }
  return v11;
}

//----- (0000000000044EC8) ----------------------------------------------------
__int64 __fastcall sub_44EC8(_WORD *a1, _WORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x7Au, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*a1) | ((unsigned __int8)*a1 << 8);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x7Bu, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000044F8C) ----------------------------------------------------
__int64 __fastcall sub_44F8C(__int64 a1, _WORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x7Cu, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 2)) | ((unsigned __int8)*(_WORD *)(a1 + 2) << 8);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x7Du, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000045050) ----------------------------------------------------
__int64 __fastcall sub_45050(__int64 a1, _BYTE *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x82u, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = *(_BYTE *)(a1 + 12) >> 4;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x83u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000045100) ----------------------------------------------------
__int64 __fastcall sub_45100(__int64 a1, _BYTE *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x86u, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = *(_BYTE *)(a1 + 13);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x87u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (00000000000451B0) ----------------------------------------------------
__int64 __fastcall sub_451B0(_WORD *a1, _WORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0xB3u, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*a1) | ((unsigned __int8)*a1 << 8);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xB4u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000045274) ----------------------------------------------------
__int64 __fastcall sub_45274(__int64 a1, _WORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0xB5u, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 2)) | ((unsigned __int8)*(_WORD *)(a1 + 2) << 8);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xB6u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000045338) ----------------------------------------------------
__int64 __fastcall sub_45338(__int64 a1, _QWORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0xC5u, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = a1 + 8;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xC6u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (00000000000453E8) ----------------------------------------------------
__int64 __fastcall sub_453E8(__int64 a1, _WORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0xD3u, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 2)) | ((unsigned __int8)*(_WORD *)(a1 + 2) << 8);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xD4u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (00000000000454AC) ----------------------------------------------------
__int64 __fastcall sub_454AC(__int64 a1, _WORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0xDFu, (__int64)&unk_5CCA8, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 6)) | ((unsigned __int8)*(_WORD *)(a1 + 6) << 8);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xE0u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000045570) ----------------------------------------------------
char __fastcall sub_45570(__int16 *a1)
{
  PDEVICE_OBJECT v2; // r10
  __int16 v3; // ax
  char v4; // r11
  __int16 v6; // [rsp+40h] [rbp+8h] BYREF
  __int16 v7; // [rsp+48h] [rbp+10h] BYREF

  v6 = 0;
  v7 = 0;
  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0xCFu, (__int64)&unk_5CCA8, a1, &v6);
    v2 = off_60148;
  }
  v3 = *a1;
  HIBYTE(v6) = HIBYTE(*a1);
  v6 = HIBYTE(v6) | ((unsigned __int8)v3 << 8);
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v2->AlignmentRequirement, 0xD0u, (__int64)&unk_5CCA8);
  }
  sub_453E8((__int64)a1, &v7);
  v4 = 1;
  if ( v6 != 1 || v7 != 2048 )
    v4 = 0;
  return v4;
}

//----- (0000000000045670) ----------------------------------------------------
__int64 __fastcall sub_45670(__int64 a1, unsigned __int8 *a2)
{
  int v5; // [rsp+20h] [rbp-38h]
  int v6; // [rsp+28h] [rbp-30h]
  int v7; // [rsp+30h] [rbp-28h]
  int v8; // [rsp+38h] [rbp-20h]
  int v9; // [rsp+40h] [rbp-18h]
  int v10; // [rsp+48h] [rbp-10h]

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v10 = a2[5];
    v9 = a2[4];
    v8 = a2[3];
    v7 = a2[2];
    v6 = a2[1];
    v5 = *a2;
    sub_42A20(*(_QWORD *)&off_60148->AlignmentRequirement, 0xF5u, (__int64)&unk_5CCA8, a1, v5, v6, v7, v8, v9, v10);
  }
  *(_DWORD *)a1 = *(_DWORD *)a2;
  *(_WORD *)(a1 + 4) = *((_WORD *)a2 + 2);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xF6u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000045760) ----------------------------------------------------
__int64 __fastcall sub_45760(__int64 a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_11230(*(_QWORD *)&off_60148->AlignmentRequirement, 0xF7u, (__int64)&unk_5CCA8, a1, v5);
  }
  *(_WORD *)(a1 + 12) = v6 | (v2 << 8);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xF8u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000045824) ----------------------------------------------------
char __fastcall sub_45824(__int64 a1, __int64 a2, unsigned int a3)
{
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  __int16 v7; // [rsp+30h] [rbp+8h] BYREF

  sub_43A18(a1, &v7);
  if ( v7 == 2048 )
  {
    if ( a3 < 0x17 )
    {
      v4 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
        || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 3u )
      {
        return 0;
      }
      v5 = 249;
LABEL_7:
      sub_112FC(*(_QWORD *)&v4->AlignmentRequirement, v5, (__int64)&unk_5CCA8, a3);
      return 0;
    }
  }
  else if ( v7 == 40 && a3 < 0x36 )
  {
    v4 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 3u )
    {
      return 0;
    }
    v5 = 250;
    goto LABEL_7;
  }
  return 1;
}

//----- (00000000000458D8) ----------------------------------------------------
__int64 __fastcall sub_458D8(__int64 a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_11230(*(_QWORD *)&off_60148->AlignmentRequirement, 0x102u, (__int64)&unk_5CCA8, a1, v5);
  }
  *(_WORD *)(a1 + 2) = v6 | (v2 << 8);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x103u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (000000000004599C) ----------------------------------------------------
__int64 __fastcall sub_4599C(__int64 a1, unsigned __int8 a2)
{
  int v5; // [rsp+20h] [rbp-18h]

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_11230(*(_QWORD *)&off_60148->AlignmentRequirement, 0x106u, (__int64)&unk_5CCA8, a1, v5);
  }
  *(_BYTE *)(a1 + 6) &= 0x1Fu;
  *(_BYTE *)(a1 + 6) |= 32 * a2;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x107u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000045A54) ----------------------------------------------------
__int64 __fastcall sub_45A54(__int64 a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_11230(*(_QWORD *)&off_60148->AlignmentRequirement, 0x10Eu, (__int64)&unk_5CCA8, a1, v5);
  }
  *(_WORD *)(a1 + 10) = v6 | (v2 << 8);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x10Fu, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000045B18) ----------------------------------------------------
char __fastcall sub_45B18(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  unsigned __int16 v3; // dx
  char v5; // [rsp+38h] [rbp+10h] BYREF
  __int16 v6; // [rsp+40h] [rbp+18h] BYREF

  v5 = 0;
  v6 = 0;
  sub_43DC4(a1, &v5);
  if ( (v5 & 1) != 0 )
  {
    v2 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
      return 1;
    }
    v3 = 276;
LABEL_6:
    sub_11008(*(_QWORD *)&v2->AlignmentRequirement, v3, (__int64)&unk_5CCA8);
    return 1;
  }
  sub_43E74(a1, &v6);
  if ( v6 )
  {
    v2 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
      return 1;
    }
    v3 = 277;
    goto LABEL_6;
  }
  return 0;
}

//----- (0000000000045BD8) ----------------------------------------------------
__int64 __fastcall sub_45BD8(__int64 a1, int a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  int v7; // eax
  unsigned int v8; // edi
  __int64 v9; // rax
  int v11; // [rsp+28h] [rbp-10h]

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x116u, (__int64)&unk_5CCA8);
    v6 = off_60148;
  }
  if ( a1 && a3 && a2 )
  {
    *(_QWORD *)a3 = a1 + 40;
    sub_44798(a1, (unsigned __int8 *)(a3 + 8));
    v7 = sub_45F84(a1, a2, a3);
    v8 = v7;
    if ( v7 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x118u, (__int64)&unk_5CCA8, v7);
      }
      v8 = 0;
    }
    v9 = *(_QWORD *)a3;
    *(_QWORD *)(a3 + 32) = a1;
    *(_BYTE *)(a3 + 40) = -1;
    *(_QWORD *)(a3 + 16) = v9 + 2;
    sub_4686C(a3);
    v6 = off_60148;
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      v11 = a2;
      sub_1D878(*(_QWORD *)&v6->AlignmentRequirement, 0x117u, (__int64)&unk_5CCA8, a1, a3, v11);
      v6 = off_60148;
    }
    v8 = 4;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x119u, (__int64)&unk_5CCA8);
  }
  return v8;
}

//----- (0000000000045D6C) ----------------------------------------------------
__int64 __fastcall sub_45D6C(__int64 a1, unsigned int a2, unsigned __int16 *a3)
{
  __int64 v3; // rbx
  PDEVICE_OBJECT v6; // r10
  unsigned int v7; // ebx
  char v8; // al
  int v9; // eax
  int v11; // [rsp+28h] [rbp-40h]
  __int64 Src; // [rsp+30h] [rbp-38h] BYREF
  __int64 v13[5]; // [rsp+38h] [rbp-30h] BYREF

  Src = 0i64;
  v3 = a2;
  memset(v13, 0, sizeof(v13));
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x11Au, (__int64)&unk_5CCA8);
    v6 = off_60148;
  }
  if ( a1 && a3 && (_DWORD)v3 )
  {
    if ( *(_QWORD *)a3 + (unsigned __int64)a3[12] < v3 + a1 - 1 )
    {
      v8 = **(_BYTE **)a3;
      Src = *(_QWORD *)a3 + a3[12];
      LOBYTE(v13[0]) = v8;
      v9 = sub_45F84(a1, v3, (__int64)&Src);
      v7 = v9;
      if ( v9 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
        {
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x11Du, (__int64)&unk_5CCA8, v9);
        }
        v7 = 0;
      }
      v13[1] = Src + 2;
      v13[3] = *(_QWORD *)a3;
      LOBYTE(v13[4]) = *((_BYTE *)a3 + 8);
      memmove(a3, &Src, 0x30ui64);
      sub_4686C((__int64)a3);
      v6 = off_60148;
    }
    else
    {
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x11Cu, (__int64)&unk_5CCA8);
        v6 = off_60148;
      }
      v7 = 10;
    }
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      v11 = v3;
      sub_1D878(*(_QWORD *)&v6->AlignmentRequirement, 0x11Bu, (__int64)&unk_5CCA8, a1, a3, v11, Src);
      v6 = off_60148;
    }
    v7 = 4;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x11Eu, (__int64)&unk_5CCA8);
  }
  return v7;
}

//----- (0000000000045F84) ----------------------------------------------------
__int64 __fastcall sub_45F84(__int64 a1, int a2, __int64 a3)
{
  unsigned int v5; // esi
  PDEVICE_OBJECT v7; // rcx
  __int16 v8; // cx

  v5 = 0;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x11Fu, (__int64)&unk_5CCA8);
    v7 = off_60148;
  }
  if ( !a1 || !a3 || !a2 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1D878(*(_QWORD *)&v7->AlignmentRequirement, 0x120u, (__int64)&unk_5CCA8, a1, a3, a2);
      v7 = off_60148;
    }
    v5 = 4;
    goto LABEL_39;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v7->AlignmentRequirement, 0x121u, (__int64)&unk_5CCA8, *(unsigned __int8 *)(a3 + 8));
    v7 = off_60148;
  }
  switch ( *(_BYTE *)(a3 + 8) )
  {
    case 0:
      goto LABEL_28;
    case 6:
    case 0x11:
LABEL_27:
      *(_WORD *)(a3 + 24) = a1 + a2 - *(_WORD *)a3;
      goto LABEL_30;
    case 0x2B:
LABEL_28:
      v8 = 8 * (*(unsigned __int8 *)(*(_QWORD *)a3 + 1i64) + 1);
      goto LABEL_29;
  }
  if ( *(_BYTE *)(a3 + 8) != 44 )
  {
    if ( *(_BYTE *)(a3 + 8) == 51 )
    {
      v8 = 4 * *(unsigned __int8 *)(*(_QWORD *)a3 + 1i64) + 2;
LABEL_29:
      *(_WORD *)(a3 + 24) = v8;
      goto LABEL_30;
    }
    if ( *(_BYTE *)(a3 + 8) != 58 )
    {
      if ( *(_BYTE *)(a3 + 8) != 60 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_112FC(*(_QWORD *)&v7->AlignmentRequirement, 0x122u, (__int64)&unk_5CCA8, *(unsigned __int8 *)(a3 + 8));
        }
        v5 = 5;
        *(_WORD *)(a3 + 24) = 0;
        goto LABEL_30;
      }
      goto LABEL_28;
    }
    goto LABEL_27;
  }
  *(_WORD *)(a3 + 24) = 8;
LABEL_30:
  *(_WORD *)(a3 + 26) = *(_WORD *)a3 - a1;
  v7 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return v5;
  if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x123u, (__int64)&unk_5CCA8, *(unsigned __int16 *)(a3 + 24));
    v7 = off_60148;
  }
LABEL_39:
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v7->AlignmentRequirement, 0x124u, (__int64)&unk_5CCA8);
  }
  return v5;
}

//----- (00000000000461F4) ----------------------------------------------------
__int64 __fastcall sub_461F4(__int64 a1, unsigned __int8 a2, unsigned __int64 *a3)
{
  unsigned int v3; // ebx
  PDEVICE_OBJECT v7; // r10
  const char *v8; // rax
  __int64 v9; // r10
  int v10; // eax
  unsigned __int16 v11; // dx
  unsigned __int8 v12; // cl
  unsigned __int64 v13; // rsi
  unsigned __int16 v14; // dx
  __int64 Src; // [rsp+30h] [rbp-48h] BYREF
  char v17[40]; // [rsp+38h] [rbp-40h] BYREF
  unsigned int v18; // [rsp+80h] [rbp+8h] BYREF

  v3 = 0;
  Src = 0i64;
  memset(v17, 0, sizeof(v17));
  v18 = 0;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x125u, (__int64)&unk_5CCA8);
    v7 = off_60148;
  }
  if ( !a1 || !a3 )
  {
    if ( v7 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_57;
    }
    sub_1D3B0(*(_QWORD *)&v7->AlignmentRequirement, 0x126u, (__int64)&unk_5CCA8, a1, a3);
    goto LABEL_56;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    v8 = sub_47CFC(a2);
    sub_31E08(*(_QWORD *)(v9 + 152), 0x127u, (__int64)&unk_5CCA8, a2, v8);
  }
  sub_44150(a1, &v18);
  v10 = sub_45BD8(a1, v18, (__int64)&Src);
  if ( v10 )
  {
    v7 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_57;
    }
    v11 = 296;
LABEL_16:
    sub_112FC(*(_QWORD *)&v7->AlignmentRequirement, v11, (__int64)&unk_5CCA8, v10);
    goto LABEL_56;
  }
  v12 = v17[0];
  if ( v17[0] == 59 )
  {
LABEL_56:
    v7 = off_60148;
    goto LABEL_57;
  }
  v13 = v18 + a1 - 1;
  while ( 1 )
  {
    if ( *a3 >= v13 )
    {
      v7 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v14 = 297;
        goto LABEL_38;
      }
      goto LABEL_57;
    }
    if ( a2 == v12 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x12Au, (__int64)&unk_5CCA8);
      }
      memmove(a3, &Src, 0x30ui64);
      v7 = off_60148;
      goto LABEL_58;
    }
    if ( (v12 > 0x3Cu || v12 != 60 && v12 && (v12 <= 0x2Au || v12 > 0x2Cu && (v12 == 50 || v12 != 51)))
      && v12 != 6
      && v12 != 17
      && v12 != 58 )
    {
      v7 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v14 = 299;
LABEL_38:
        sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v14, (__int64)&unk_5CCA8);
        goto LABEL_56;
      }
      goto LABEL_57;
    }
    v10 = sub_45D6C(a1, v18, (unsigned __int16 *)&Src);
    if ( v10 )
      break;
    v12 = v17[0];
    if ( v17[0] == 59 )
      goto LABEL_56;
  }
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    v11 = 300;
    goto LABEL_16;
  }
LABEL_57:
  v3 = 5;
LABEL_58:
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v7->AlignmentRequirement, 0x12Du, (__int64)&unk_5CCA8);
  }
  return v3;
}
// 462AD: variable 'v9' is possibly undefined

//----- (0000000000046554) ----------------------------------------------------
__int64 __fastcall sub_46554(__int64 a1, int *a2)
{
  int v4; // er12
  PDEVICE_OBJECT v5; // rcx
  unsigned int v6; // eax
  unsigned int v7; // ebx
  unsigned __int16 v8; // dx
  int v9; // er9
  int v10; // eax
  unsigned __int64 v12; // [rsp+30h] [rbp-48h] BYREF
  __int16 v13[20]; // [rsp+38h] [rbp-40h] BYREF
  unsigned int v14; // [rsp+80h] [rbp+8h] BYREF

  v12 = 0i64;
  memset(v13, 0, sizeof(v13));
  v4 = 0;
  v14 = 0;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x12Eu, (__int64)&unk_5CCA8);
    v5 = off_60148;
  }
  if ( a1 && a2 )
  {
    sub_44150(a1, &v14);
    v6 = sub_45BD8(a1, v14, (__int64)&v12);
    v7 = v6;
    if ( v6 )
    {
      v5 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return v7;
      if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        v8 = 304;
        v9 = v6;
LABEL_12:
        sub_112FC(*(_QWORD *)&v5->AlignmentRequirement, v8, (__int64)&unk_5CCA8, v9);
        v5 = off_60148;
      }
    }
    else
    {
      while ( LOBYTE(v13[0]) != 59 && LOBYTE(v13[0]) != 6 && LOBYTE(v13[0]) != 17 && LOBYTE(v13[0]) != 58 )
      {
        if ( v12 >= (unsigned __int64)v14 + a1 - 1 )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
          {
            sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x131u, (__int64)&unk_5CCA8);
          }
          v7 = 10;
          break;
        }
        if ( LOBYTE(v13[0]) > 0x3Cu
          || LOBYTE(v13[0]) != 60
          && LOBYTE(v13[0])
          && (LOBYTE(v13[0]) <= 0x2Au || LOBYTE(v13[0]) > 0x2Cu && (LOBYTE(v13[0]) == 50 || LOBYTE(v13[0]) != 51)) )
        {
          v5 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
          {
            sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x132u, (__int64)&unk_5CCA8);
            v5 = off_60148;
          }
          v7 = 18;
          goto LABEL_49;
        }
        v4 += (unsigned __int16)v13[8];
        v10 = sub_45D6C(a1, v14, (unsigned __int16 *)&v12);
        v7 = v10;
        if ( v10 )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
          {
            sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x133u, (__int64)&unk_5CCA8, v10);
          }
          break;
        }
      }
      *a2 = v4;
      v5 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return v7;
      if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v8 = 308;
        v9 = v4;
        goto LABEL_12;
      }
    }
  }
  else
  {
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1D3B0(*(_QWORD *)&v5->AlignmentRequirement, 0x12Fu, (__int64)&unk_5CCA8, a1, a2);
      v5 = off_60148;
    }
    v7 = 4;
  }
LABEL_49:
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v5->AlignmentRequirement, 0x135u, (__int64)&unk_5CCA8);
  }
  return v7;
}

//----- (000000000004686C) ----------------------------------------------------
__int64 __fastcall sub_4686C(__int64 a1)
{
  unsigned int v1; // edi
  PDEVICE_OBJECT v3; // r10
  const char *v4; // rax
  __int64 v5; // r10
  int v6; // er9

  v1 = 0;
  if ( !a1 )
    return 4;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x136u, (__int64)&unk_5CCA8);
      v3 = off_60148;
    }
    if ( v3 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_2F80C(*(_QWORD *)&v3->AlignmentRequirement, 0x137u, (__int64)&unk_5CCA8, *(_QWORD *)a1);
        v3 = off_60148;
      }
      if ( v3 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          v4 = sub_47CFC(*(_BYTE *)(a1 + 8));
          sub_31E08(*(_QWORD *)(v5 + 152), 0x138u, (__int64)&unk_5CCA8, v6, v4);
          v3 = off_60148;
        }
        if ( v3 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            sub_112FC(*(_QWORD *)&v3->AlignmentRequirement, 0x139u, (__int64)&unk_5CCA8, *(unsigned __int16 *)(a1 + 24));
            v3 = off_60148;
          }
          if ( v3 != (PDEVICE_OBJECT)&off_60148 )
          {
            if ( (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
              && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
            {
              sub_112FC(
                *(_QWORD *)&v3->AlignmentRequirement,
                0x13Au,
                (__int64)&unk_5CCA8,
                *(unsigned __int16 *)(a1 + 26));
              v3 = off_60148;
            }
            if ( v3 != (PDEVICE_OBJECT)&off_60148 )
            {
              if ( (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
                && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
              {
                sub_2F80C(*(_QWORD *)&v3->AlignmentRequirement, 0x13Bu, (__int64)&unk_5CCA8, *(_QWORD *)(a1 + 32));
                v3 = off_60148;
              }
              if ( v3 != (PDEVICE_OBJECT)&off_60148
                && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
                && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
              {
                sub_112FC(
                  *(_QWORD *)&v3->AlignmentRequirement,
                  0x13Cu,
                  (__int64)&unk_5CCA8,
                  *(unsigned __int8 *)(a1 + 40));
              }
            }
          }
        }
      }
    }
  }
  return v1;
}
// 46941: variable 'v5' is possibly undefined
// 46955: variable 'v6' is possibly undefined

//----- (0000000000046A6C) ----------------------------------------------------
__int64 __fastcall sub_46A6C(unsigned __int8 **a1, unsigned __int8 *a2)
{
  PDEVICE_OBJECT v4; // rcx
  unsigned __int8 v5; // si
  unsigned __int8 *v6; // rax
  unsigned __int8 v7; // dl
  int v9; // [rsp+20h] [rbp-28h]
  int v10; // [rsp+30h] [rbp-18h]

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    v10 = *((unsigned __int8 *)a1 + 40);
    v9 = *((unsigned __int8 *)a1 + 8);
    sub_42C00(*(_QWORD *)&off_60148->AlignmentRequirement, 317i64, (__int64)&unk_5CCA8, *a1, v9, a1[4], v10);
    v4 = off_60148;
  }
  v5 = **a1;
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_112FC(*(_QWORD *)&v4->AlignmentRequirement, 0x13Eu, (__int64)&unk_5CCA8, v5);
  }
  if ( *((_BYTE *)a1 + 40) == 0xFF )
  {
    if ( a2 )
    {
      sub_44798((__int64)a1[4], a2);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x13Fu, (__int64)&unk_5CCA8, *a2);
      }
    }
    a1[4][6] = v5;
  }
  else
  {
    if ( a2 )
    {
      v6 = a1[4];
      v7 = *v6;
      *a2 = *v6;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x140u, (__int64)&unk_5CCA8, v7);
      }
    }
    *a1[4] = v5;
  }
  return 0i64;
}

//----- (0000000000046BE8) ----------------------------------------------------
bool __fastcall sub_46BE8(__int64 a1)
{
  unsigned __int64 v3; // [rsp+20h] [rbp-38h] BYREF
  char Dst[40]; // [rsp+28h] [rbp-30h] BYREF

  v3 = 0i64;
  memset(Dst, 0, sizeof(Dst));
  return (unsigned int)sub_461F4(a1, 0x2Cu, &v3) == 0;
}

//----- (0000000000046C28) ----------------------------------------------------
__int64 __fastcall sub_46C28(__int64 a1, _WORD *a2)
{
  PDEVICE_OBJECT v4; // r9

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x142u, (__int64)&unk_5CCA8);
    v4 = off_60148;
  }
  *a2 = (32 * (unsigned __int8)*(_WORD *)(a1 + 2)) | ((unsigned __int8)HIBYTE(*(_WORD *)(a1 + 2)) >> 3);
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x143u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000046CEC) ----------------------------------------------------
__int64 __fastcall sub_46CEC(__int64 a1, _BYTE *a2)
{
  PDEVICE_OBJECT v4; // rcx

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x146u, (__int64)&unk_5CCA8);
    v4 = off_60148;
  }
  *a2 = *(_BYTE *)(a1 + 3) & 7;
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x147u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000046D94) ----------------------------------------------------
__int64 __fastcall sub_46D94(__int64 a1, _DWORD *a2)
{
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x148u, (__int64)&unk_5CCA8);
  }
  *a2 = ((unsigned __int8)HIBYTE(*(_DWORD *)(a1 + 4)) | (unsigned __int16)((unsigned __int8)BYTE2(*(_DWORD *)(a1 + 4)) << 8))
      + (((unsigned __int8)BYTE1(*(_DWORD *)(a1 + 4)) | (unsigned __int16)((unsigned __int8)*(_DWORD *)(a1 + 4) << 8)) << 16);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x149u, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000046E70) ----------------------------------------------------
__int64 __fastcall sub_46E70(__int64 a1, __int64 a2, _QWORD *a3, _WORD *a4)
{
  int v9; // [rsp+48h] [rbp+10h] BYREF

  v9 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x14Au, (__int64)&unk_5CCA8);
  }
  if ( a3 )
    *a3 = *(_QWORD *)a2 + *(unsigned __int16 *)(a2 + 24);
  sub_44150(a1, &v9);
  *a4 = v9 - *(_WORD *)(a2 + 26) - *(_WORD *)(a2 + 24);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x14Bu, (__int64)&unk_5CCA8);
  }
  return 0i64;
}

//----- (0000000000046F54) ----------------------------------------------------
__int64 __fastcall sub_46F54(__int64 a1, __int64 a2, _DWORD *a3)
{
  __int64 v6; // rbx
  int v7; // edi
  unsigned __int16 v8; // bx
  PDEVICE_OBJECT v9; // rcx
  __int64 result; // rax
  unsigned __int16 v11[2]; // [rsp+30h] [rbp-38h] BYREF
  __int16 v12[26]; // [rsp+34h] [rbp-34h] BYREF
  char v13; // [rsp+78h] [rbp+10h] BYREF
  __int16 v14; // [rsp+88h] [rbp+20h] BYREF

  v14 = 0;
  v11[0] = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x14Cu, (__int64)&unk_5CCA8);
  }
  v6 = *(_QWORD *)a2;
  sub_46CEC(*(_QWORD *)a2, &v13);
  sub_46C28(v6, v12);
  if ( (v13 & 1) != 0 || !v12[0] )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x14Du, (__int64)&unk_5CCA8);
    }
    result = 6i64;
  }
  else
  {
    v7 = *(unsigned __int16 *)(a2 + 26);
    sub_46C28(*(_QWORD *)a2, &v14);
    v8 = 8 * v14;
    sub_46E70(a1, a2, 0i64, v11);
    *a3 = v11[0] + v7 + v8;
    v9 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_4DE38(*(_QWORD *)&off_60148->AlignmentRequirement, 0x14Eu, (__int64)&unk_5CCA8, v7);
        v9 = off_60148;
      }
      if ( v9 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v9->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v9->AlignmentRequirement, 0x14Fu, (__int64)&unk_5CCA8);
      }
    }
    result = 0i64;
  }
  return result;
}

//----- (0000000000047100) ----------------------------------------------------
__int16 __fastcall sub_47100(unsigned __int16 *a1)
{
  unsigned int v2; // ebx
  unsigned __int16 *v3; // rcx
  unsigned __int8 v4; // r11
  __int64 v5; // rdx
  int v6; // eax
  unsigned __int16 *v7; // rcx
  __int64 v8; // rdx
  int v9; // eax
  int v10; // ebx
  PDEVICE_OBJECT v11; // rcx
  char v13; // [rsp+38h] [rbp+10h] BYREF
  int v14; // [rsp+40h] [rbp+18h]

  v2 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x16Bu, (__int64)&unk_5CCA8, a1);
  }
  sub_43B8C(a1, &v13);
  v3 = a1;
  v4 = 4 * v13;
  v5 = 5i64;
  v13 *= 4;
  do
  {
    v6 = *v3++;
    v2 += v6;
    --v5;
  }
  while ( v5 );
  if ( v4 > 0xCu )
  {
    v7 = a1 + 6;
    v8 = (unsigned __int8)(((unsigned __int8)(v4 - 13) >> 1) + 1);
    do
    {
      v9 = *v7++;
      v2 += v9;
      --v8;
    }
    while ( v8 );
  }
  while ( HIWORD(v2) )
    v2 = HIWORD(v2) + (unsigned __int16)v2;
  v10 = ~v2;
  v14 = v10;
  v11 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x16Cu, (__int64)&unk_5CCA8, (unsigned __int16)v10);
      v11 = off_60148;
    }
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v11->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_112FC(
        *(_QWORD *)&v11->AlignmentRequirement,
        0x16Du,
        (__int64)&unk_5CCA8,
        BYTE1(v14) | (unsigned __int16)((unsigned __int8)v10 << 8));
    }
  }
  return BYTE1(v14) | ((unsigned __int8)v10 << 8);
}

//----- (0000000000047270) ----------------------------------------------------
__int64 __fastcall sub_47270(__int64 a1, _QWORD *a2, unsigned __int16 *a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned int v7; // ebx
  _BYTE *v8; // rax
  _BYTE *v9; // rdi
  PDEVICE_OBJECT v10; // rcx
  int v11; // er9
  unsigned __int16 v12; // dx
  _BYTE *v13; // rax
  __int64 result; // rax
  bool v15; // zf
  unsigned __int16 v16; // dx
  PDEVICE_OBJECT v17; // rcx
  unsigned __int8 v18[4]; // [rsp+20h] [rbp-28h] BYREF
  unsigned __int16 v19; // [rsp+24h] [rbp-24h] BYREF
  __int16 v20[16]; // [rsp+28h] [rbp-20h] BYREF
  unsigned __int8 v21; // [rsp+68h] [rbp+20h] BYREF

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x186u, (__int64)&unk_5CCA8);
    v6 = off_60148;
  }
  v7 = 1;
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x189u, (__int64)&unk_5CCA8);
  }
  v8 = sub_42C74(a1, 1);
  v9 = v8;
  if ( v8 )
  {
    sub_43C3C((__int64)v8, v20);
    sub_43B8C(v9, &v21);
    v21 *= 4;
    v19 = v20[0] - v21;
    v10 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
      goto LABEL_20;
    }
    v11 = (unsigned __int16)(v20[0] - v21);
    v12 = 394;
LABEL_19:
    sub_112FC(*(_QWORD *)&v10->AlignmentRequirement, v12, (__int64)&unk_5CCA8, v11);
    v10 = off_60148;
LABEL_20:
    v7 = 0;
    goto LABEL_25;
  }
  v13 = sub_42C74(a1, 2);
  if ( v13 )
  {
    sub_446D0((__int64)v13, &v19);
    v10 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
      goto LABEL_20;
    }
    v11 = v19;
    v12 = 395;
    goto LABEL_19;
  }
  v10 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return v7;
  if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x18Cu, (__int64)&unk_5CCA8);
    v10 = off_60148;
  }
LABEL_25:
  if ( v10 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v10->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v10->AlignmentRequirement, 0x18Du, (__int64)&unk_5CCA8);
  }
  if ( v7 )
    return v7;
  result = sub_47524(a1, v18, a2);
  if ( !(_DWORD)result )
  {
    v16 = v19 - v18[0];
    v15 = v19 == (unsigned __int16)v18[0];
    *a3 = v16;
    if ( v15 )
      *a2 = 0i64;
    v17 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x187u, (__int64)&unk_5CCA8, v16);
        v17 = off_60148;
      }
      if ( v17 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v17->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v17->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v17->AlignmentRequirement, 0x188u, (__int64)&unk_5CCA8);
      }
    }
    result = 0i64;
  }
  return result;
}

//----- (0000000000047524) ----------------------------------------------------
__int64 __fastcall sub_47524(__int64 a1, unsigned __int8 *a2, _QWORD *a3)
{
  unsigned int v6; // ebx
  _BYTE *v7; // rax
  _BYTE *v8; // rsi
  unsigned __int8 v9; // r11
  PDEVICE_OBJECT v10; // rcx
  int v11; // er9
  unsigned __int16 v12; // dx

  v6 = 1;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x18Eu, (__int64)&unk_5CCA8);
  }
  v7 = sub_42C74(a1, 3);
  v8 = v7;
  if ( v7 )
  {
    sub_45050((__int64)v7, a2);
    v9 = 4 * *a2;
    *a2 = v9;
    v10 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v11 = v9;
      v12 = 399;
LABEL_15:
      sub_112FC(*(_QWORD *)&v10->AlignmentRequirement, v12, (__int64)&unk_5CCA8, v11);
      v10 = off_60148;
      goto LABEL_16;
    }
    goto LABEL_16;
  }
  v8 = sub_42C74(a1, 4);
  if ( v8 )
  {
    *a2 = 8;
    v10 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v12 = 400;
      v11 = 8;
      goto LABEL_15;
    }
LABEL_16:
    v6 = 0;
    if ( a3 )
      *a3 = &v8[*a2];
    goto LABEL_22;
  }
  v10 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return v6;
  if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x191u, (__int64)&unk_5CCA8);
    v10 = off_60148;
  }
LABEL_22:
  if ( v10 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v10->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v10->AlignmentRequirement, 0x192u, (__int64)&unk_5CCA8);
  }
  return v6;
}

//----- (00000000000476DC) ----------------------------------------------------
char __fastcall sub_476DC(__int64 a1, unsigned __int16 a2)
{
  char v4; // bl
  int v5; // er9
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  char v11; // [rsp+30h] [rbp-38h] BYREF
  __int64 v12; // [rsp+31h] [rbp-37h]
  int v13; // [rsp+39h] [rbp-2Fh]
  __int16 v14; // [rsp+3Dh] [rbp-2Bh]
  char v15; // [rsp+3Fh] [rbp-29h]
  char v16; // [rsp+40h] [rbp-28h] BYREF
  __int64 v17; // [rsp+41h] [rbp-27h]
  int v18; // [rsp+49h] [rbp-1Fh]
  __int16 v19; // [rsp+4Dh] [rbp-1Bh]
  char v20; // [rsp+4Fh] [rbp-19h]
  unsigned __int16 v21; // [rsp+78h] [rbp+10h] BYREF

  v16 = 0;
  v17 = 0i64;
  v11 = 0;
  v12 = 0i64;
  v13 = 0;
  v14 = 0;
  v15 = 0;
  v4 = 1;
  v18 = 0;
  v19 = 0;
  v20 = 0;
  sub_43C3C(a1, &v21);
  v5 = v21 + 14;
  if ( v5 > a2 )
  {
    v6 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 3u )
    {
      goto LABEL_23;
    }
    v7 = 434;
    goto LABEL_6;
  }
  if ( v5 < 34 )
  {
    v6 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 3u )
    {
      goto LABEL_23;
    }
    v7 = 435;
LABEL_6:
    sub_11430(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_5CCA8, v5);
    goto LABEL_23;
  }
  if ( v5 >= 65550 )
  {
    v8 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 3u )
    {
      goto LABEL_23;
    }
    v9 = 436;
    goto LABEL_22;
  }
  if ( v21 )
    goto LABEL_24;
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    v9 = 437;
    v5 = 0;
LABEL_22:
    sub_112FC(*(_QWORD *)&v8->AlignmentRequirement, v9, (__int64)&unk_5CCA8, v5);
  }
LABEL_23:
  v4 = 0;
LABEL_24:
  sub_43FF0(a1, &v16);
  sub_440A0(a1, &v11);
  if ( sub_47A78(4, &v11) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1B7u, (__int64)&unk_5CCA8);
    }
    v4 = 0;
  }
  return v4;
}

//----- (00000000000478B8) ----------------------------------------------------
char __fastcall sub_478B8(__int64 a1, unsigned __int16 a2)
{
  char v4; // di
  PDEVICE_OBJECT v5; // rbx
  __m128i v7; // [rsp+30h] [rbp-28h] BYREF
  __m128i v8; // [rsp+40h] [rbp-18h] BYREF
  int v9; // [rsp+68h] [rbp+10h] BYREF

  v7.m128i_i8[0] = 0;
  *(__int64 *)((char *)v7.m128i_i64 + 1) = 0i64;
  v8.m128i_i8[0] = 0;
  *(__int64 *)((char *)v8.m128i_i64 + 1) = 0i64;
  *(__int32 *)((char *)&v8.m128i_i32[2] + 1) = 0;
  *(__int16 *)((char *)&v8.m128i_i16[6] + 1) = 0;
  v8.m128i_i8[15] = 0;
  v4 = 1;
  *(__int32 *)((char *)&v7.m128i_i32[2] + 1) = 0;
  *(__int16 *)((char *)&v7.m128i_i16[6] + 1) = 0;
  v7.m128i_i8[15] = 0;
  sub_44150(a1, &v9);
  if ( v9 + 14 <= (unsigned int)a2 )
  {
    if ( v9 )
      goto LABEL_12;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1BAu, (__int64)&unk_5CCA8, 0);
    }
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
         && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1B8u, (__int64)&unk_5CCA8, v9);
  }
  v4 = 0;
LABEL_12:
  sub_4484C(a1, &v7);
  sub_44900(a1, &v8);
  if ( sub_47A78(6, &v7) )
  {
    v5 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1BBu, (__int64)&unk_5CCA8);
      v5 = off_60148;
    }
    v4 = 0;
  }
  else
  {
    v5 = off_60148;
  }
  if ( sub_47A78(6, &v8) )
  {
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_11008(*(_QWORD *)&v5->AlignmentRequirement, 0x1BCu, (__int64)&unk_5CCA8);
    }
    v4 = 0;
  }
  return v4;
}

//----- (0000000000047A78) ----------------------------------------------------
bool __fastcall sub_47A78(char a1, const void *a2)
{
  unsigned __int16 v2; // ax
  char Buf2; // [rsp+20h] [rbp-18h] BYREF
  __int64 v5; // [rsp+21h] [rbp-17h]
  int v6; // [rsp+29h] [rbp-Fh]
  __int16 v7; // [rsp+2Dh] [rbp-Bh]
  char v8; // [rsp+2Fh] [rbp-9h]

  v2 = 0;
  Buf2 = 0;
  v5 = 0i64;
  v6 = 0;
  v7 = 0;
  v8 = 0;
  if ( a1 == 4 )
  {
    v2 = 4;
  }
  else if ( a1 == 6 )
  {
    v2 = 16;
  }
  return memcmp(a2, &Buf2, v2) == 0;
}

//----- (0000000000047ADC) ----------------------------------------------------
char __fastcall sub_47ADC(char a1, _BYTE *a2, __int64 a3)
{
  char v5; // r12
  unsigned int v6; // ebp
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  unsigned int v9; // edx
  __int64 v10; // r14
  unsigned __int16 v11; // dx

  v5 = 1;
  if ( a1 == 4 )
  {
    v6 = 4;
    v7 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      v8 = 446;
LABEL_11:
      sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_5CCA8);
      v7 = off_60148;
      goto LABEL_12;
    }
  }
  else
  {
    v6 = 16;
    if ( a1 != 16 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1C0u, (__int64)&unk_5CCA8);
      }
      return 0;
    }
    v7 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      v8 = 447;
      goto LABEL_11;
    }
  }
LABEL_12:
  v9 = 0;
  v10 = a3 - (_QWORD)a2;
  while ( *a2 == a2[v10] )
  {
    ++v9;
    ++a2;
    if ( v9 >= v6 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v11 = 449;
LABEL_20:
        sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v11, (__int64)&unk_5CCA8);
        return v5;
      }
      return v5;
    }
  }
  v5 = 0;
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    v11 = 450;
    goto LABEL_20;
  }
  return v5;
}
// 47B8D: conditional instruction was optimized away because of 'ebp.4 in (==4|==10)'

//----- (0000000000047C5C) ----------------------------------------------------
char __fastcall sub_47C5C(_BYTE *a1, __int64 a2)
{
  unsigned int v2; // er8
  char v3; // bl
  __int64 v4; // rdx
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx

  v2 = 0;
  v3 = 1;
  v4 = a2 - (_QWORD)a1;
  while ( *a1 == a1[v4] )
  {
    ++v2;
    ++a1;
    if ( v2 >= 6 )
    {
      v5 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v6 = 453;
LABEL_12:
        sub_11008(*(_QWORD *)&v5->AlignmentRequirement, v6, (__int64)&unk_5CCA8);
        return v3;
      }
      return v3;
    }
  }
  v3 = 0;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    v6 = 454;
    goto LABEL_12;
  }
  return v3;
}

//----- (0000000000047CFC) ----------------------------------------------------
const char *__fastcall sub_47CFC(unsigned __int8 a1)
{
  if ( a1 <= 0x3Au )
  {
    switch ( a1 )
    {
      case 0x3Au:
        return "IPv6_ICMPV6_HEADER";
      case 0u:
        return "IPv6_HOP_BY_HOP_HEADER";
      case 4u:
        return "IPv6_IPV4_OVER_IPV6";
      case 6u:
        return "IPv6_TCP_HEADER";
      case 0x11u:
        return "IPv6_UDP_HEADER";
      case 0x2Bu:
        return "IPv6_ROUTING_HEADER";
      case 0x2Cu:
        return "IPv6_FRAGMENT_HEADER";
      case 0x32u:
        return "IPv6_IPSEC_ESP_HEADER";
      case 0x33u:
        return "IPv6_AH_HEADER";
    }
    return "UNKNOWN";
  }
  switch ( a1 )
  {
    case 0x3Bu:
      return "IPv6_NO_NEXT_HEADER";
    case 0x3Cu:
      return "IPv6_DESTINATION_OPTIONS_HEADER";
    case 0x87u:
      return "IPv6_MOBILITY_HEADER";
    case 0x8Bu:
      return "IPv6_HOST_IDENTITY_HEADER";
    case 0x8Cu:
      return "IPv6_SHIM6_HEADER";
    case 0xFDu:
      return "IPv6_EXPERIMENT_TESTING_1";
    case 0xFEu:
      return "IPv6_EXPERIMENT_TESTING_2";
  }
  if ( a1 != 255 )
    return "UNKNOWN";
  return "IPv6_HEADER";
}

//----- (0000000000047DEC) ----------------------------------------------------
__int64 __fastcall sub_47DEC(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CC98, 18i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000047E50) ----------------------------------------------------
__int64 __fastcall sub_47E50(PVOID **a1)
{
  PVOID *v1; // rbp
  __int64 v2; // rdi
  ULONG v4; // er15
  _QWORD *v5; // rax
  void *v6; // rdx
  PDEVICE_OBJECT v7; // r10
  struct _KTHREAD *v8; // rsi
  int v9; // eax
  int v10; // ebx
  PDEVICE_OBJECT v11; // rcx
  __int64 result; // rax
  unsigned int v13; // esi
  __int64 v14; // rbx
  __int64 v15; // r12
  _QWORD *v16; // rax
  _QWORD *v17; // rcx
  __int64 *v18; // rbx
  void (__fastcall *v19)(__int64 *); // rax
  PDEVICE_OBJECT v20; // rcx
  __int64 *v21; // [rsp+40h] [rbp-58h] BYREF
  __int64 **v22; // [rsp+48h] [rbp-50h]
  PVOID v23[2]; // [rsp+50h] [rbp-48h] BYREF
  __int64 v24; // [rsp+60h] [rbp-38h]
  KIRQL v25; // [rsp+A0h] [rbp+8h] BYREF

  v1 = *a1;
  v2 = *((int *)a1 + 2);
  v4 = 2;
  v23[0] = **a1;
  v5 = v1[3];
  v25 = 0;
  v6 = (void *)v5[4];
  v24 = 0i64;
  v23[1] = v6;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xAu, (__int64)&unk_5CC98);
    v7 = off_60148;
  }
  if ( *((_BYTE *)v1 + 12) )
  {
    v4 = 3;
    v24 = *((_QWORD *)v1[3] + 5 * (unsigned int)v2 + 4);
  }
  if ( a1[2] )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_112FC(*(_QWORD *)&v7->AlignmentRequirement, 0xBu, (__int64)&unk_5CC98, v2);
    }
    sub_40384((PRKEVENT)a1[2]);
  }
  v8 = KeGetCurrentThread();
  v9 = KeQueryPriorityThread(v8);
  v10 = v9;
  if ( v9 >= 31 )
    goto LABEL_27;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xCu, (__int64)&unk_5CC98, v9);
  }
  KeSetPriorityThread(v8, 31);
  if ( KeQueryPriorityThread(v8) == v10 )
  {
    v11 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
      goto LABEL_32;
    if ( !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 3u )
    {
      goto LABEL_28;
    }
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xDu, (__int64)&unk_5CC98);
    goto LABEL_27;
  }
  v11 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    goto LABEL_32;
  if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xEu, (__int64)&unk_5CC98, 31);
LABEL_27:
    v11 = off_60148;
    goto LABEL_28;
  }
  while ( 1 )
  {
LABEL_28:
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v11->Queue.Wcb.DeviceRoutine) & 0x20) != 0
      && BYTE1(v11->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)v11->Queue.ListEntry.Blink, 0x33u);
    }
LABEL_32:
    result = sub_42488(v4, v23);
    if ( !(_DWORD)result )
      break;
    v13 = 0;
    v14 = 0i64;
    v22 = &v21;
    v15 = 0i64;
    v21 = (__int64 *)&v21;
    if ( (_DWORD)result == 2 )
    {
      v13 = v2;
      v14 = v2;
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x10u, (__int64)&unk_5CC98, v2);
    }
    sub_401B8((PKSPIN_LOCK)v1[3] + 5 * v13, &v25);
    v16 = v1[3];
    if ( (_QWORD *)v16[5 * v14 + 1] != &v16[5 * v14 + 1] )
    {
      v21 = (__int64 *)v16[5 * v14 + 1];
      v22 = (__int64 **)*((_QWORD *)v1[3] + 5 * v14 + 2);
      *(_QWORD *)(*((_QWORD *)v1[3] + 5 * v14 + 1) + 8i64) = &v21;
      **((_QWORD **)v1[3] + 5 * v14 + 2) = &v21;
      *((_QWORD *)v1[3] + 5 * v14 + 3) = 0i64;
      v17 = (char *)v1[3] + 40 * v14 + 8;
      v17[1] = v17;
      *v17 = v17;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_115F4(*(_QWORD *)&off_60148->AlignmentRequirement, 0x11u, (__int64)&unk_5CC98, v2);
      }
    }
    sub_40230((PKSPIN_LOCK)v1[3] + 5 * v13, v25);
    v18 = v21;
    if ( v21 == (__int64 *)&v21 )
    {
      v11 = off_60148;
    }
    else
    {
      do
      {
        ++v15;
        v21 = (__int64 *)*v18;
        v21[1] = (__int64)&v21;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_47DEC(*(_QWORD *)&off_60148->AlignmentRequirement, 18i64, (__int64)&unk_5CC98, v2);
        }
        v19 = (void (__fastcall *)(__int64 *))v18[3];
        if ( v19 )
          v19(v18 + 5);
        sub_48E4C((__int64)(v18 + 5), 0);
        v11 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x13u, (__int64)&unk_5CC98, v2);
          v11 = off_60148;
        }
        v18 = v21;
      }
      while ( v21 != (__int64 *)&v21 );
    }
  }
  v20 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      result = sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xFu, (__int64)&unk_5CC98, v2);
      v20 = off_60148;
    }
    if ( v20 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v20->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
      && BYTE1(v20->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      result = sub_11008(*(_QWORD *)&v20->AlignmentRequirement, 0x14u, (__int64)&unk_5CC98);
    }
  }
  return result;
}

//----- (0000000000048380) ----------------------------------------------------
__int64 __fastcall sub_48380(unsigned int a1)
{
  __int64 v1; // r12
  int v2; // esi
  __int64 v3; // r14
  PVOID v4; // rax
  __int64 v5; // rdi
  PVOID v6; // rax
  _QWORD *v7; // r11
  __int64 v8; // r13
  unsigned int v9; // ebp
  _QWORD *v10; // rcx
  _QWORD *v11; // rax
  __int64 v13; // [rsp+30h] [rbp-48h] BYREF
  unsigned int v14; // [rsp+38h] [rbp-40h]
  PVOID P; // [rsp+40h] [rbp-38h] BYREF

  v1 = a1;
  v2 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x15u, (__int64)&unk_5CC98);
  }
  v3 = 40i64;
  v4 = sub_3F66C(2, 0x28u, 0x6E735450u);
  v5 = (__int64)v4;
  if ( !v4 )
    goto LABEL_19;
  memset(v4, 0, 0x28ui64);
  *(_DWORD *)(v5 + 32) = 0;
  sub_402A4((struct _KEVENT **)v5, 1);
  *(_DWORD *)(v5 + 8) = v1;
  *(_BYTE *)(v5 + 12) = 1;
  *(_QWORD *)(v5 + 16) = sub_3F66C(2, 8 * (int)v1, 0x6E735450u);
  v6 = sub_3F66C(2, 8 * (5 * (int)v1 + 5), 0x6E735450u);
  *(_QWORD *)(v5 + 24) = v6;
  if ( !*(_QWORD *)(v5 + 16) )
    goto LABEL_19;
  if ( v6 )
  {
    v13 = v5;
    sub_402A4((struct _KEVENT **)&P, 0);
    memset(*(void **)(v5 + 16), 0, 8 * v1);
    memset(*(void **)(v5 + 24), 0, (unsigned int)(8 * (5 * v1 + 5)));
    sub_40150(*(_QWORD **)(v5 + 24));
    sub_402A4((struct _KEVENT **)(*(_QWORD *)(v5 + 24) + 32i64), 0);
    v7 = (_QWORD *)(*(_QWORD *)(v5 + 24) + 8i64);
    v7[1] = v7;
    *v7 = v7;
    if ( (_DWORD)v1 )
    {
      v8 = 0i64;
      v9 = 1;
      while ( 1 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x16u, (__int64)&unk_5CC98, v9);
        }
        v10 = (_QWORD *)(*(_QWORD *)(v5 + 24) + 40i64 * v9);
        v14 = v9;
        sub_40150(v10);
        sub_402A4((struct _KEVENT **)(*(_QWORD *)(v5 + 24) + 40i64 * v9 + 32), 0);
        v11 = (_QWORD *)(*(_QWORD *)(v5 + 24) + v3 + 8);
        v11[1] = v11;
        *v11 = v11;
        sub_40730((PVOID *)(*(_QWORD *)(v5 + 16) + 8i64 * (v9 - 1)), (__int64)sub_47E50, (__int64)&v13);
        if ( !*(_QWORD *)(v8 + *(_QWORD *)(v5 + 16)) )
          break;
        sub_40B60(P, 0xFFFFFFFF);
        ++v9;
        v3 += 40i64;
        v8 += 8i64;
        if ( v9 - 1 >= (unsigned int)v1 )
          goto LABEL_18;
      }
      v2 = 3;
    }
LABEL_18:
    sub_4031C(P);
  }
  else
  {
LABEL_19:
    v2 = 3;
  }
  if ( v2 && v5 )
  {
    sub_486D4((PVOID)v5);
    v5 = 0i64;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x17u, (__int64)&unk_5CC98, v5);
  }
  return v5;
}

//----- (00000000000486D4) ----------------------------------------------------
__int64 __fastcall sub_486D4(PVOID P)
{
  unsigned int v2; // edi
  unsigned int v3; // ebp
  __int64 v4; // r12
  __int64 v5; // rsi
  KSPIN_LOCK *i; // rcx
  __int64 v7; // r11
  PDEVICE_OBJECT v8; // rcx
  unsigned int v9; // esi
  __int64 v10; // rdi
  __int64 v11; // rbp
  KIRQL v13; // [rsp+70h] [rbp+8h] BYREF
  union _LARGE_INTEGER Interval; // [rsp+80h] [rbp+18h] BYREF

  v13 = 0;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x18u, (__int64)&unk_5CC98);
  }
  _InterlockedAdd((volatile signed __int32 *)P + 8, 1u);
  if ( *((_BYTE *)P + 12) )
    v2 = *((_DWORD *)P + 2) + 1;
  else
    v2 = 1;
  v3 = 0;
  if ( v2 )
  {
    v4 = 0i64;
    v5 = 0i64;
    do
    {
      Interval.QuadPart = 0i64;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x19u, (__int64)&unk_5CC98, v3);
      }
      for ( i = (KSPIN_LOCK *)(v5 + *((_QWORD *)P + 3)); ; i = (KSPIN_LOCK *)(v5 + *((_QWORD *)P + 3)) )
      {
        sub_401B8(i, &v13);
        v7 = *((_QWORD *)P + 3);
        if ( *(_QWORD *)(v4 + v7 + 8) == v4 + v7 + 8 )
          break;
        sub_40230((PKSPIN_LOCK)(v5 + v7), v13);
        Interval.QuadPart = -3000000i64;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Au, (__int64)&unk_5CC98, v3);
        }
        KeDelayExecutionThread(0, 0, &Interval);
      }
      sub_40230((PKSPIN_LOCK)(v5 + v7), v13);
      ++v3;
      v5 += 40i64;
      v4 += 40i64;
    }
    while ( v3 < v2 );
  }
  if ( *(_QWORD *)P )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Bu, (__int64)&unk_5CC98);
    }
    sub_40384(*(PRKEVENT *)P);
  }
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Cu, (__int64)&unk_5CC98, *((_DWORD *)P + 2));
    v8 = off_60148;
  }
  v9 = 0;
  if ( *((_DWORD *)P + 2) )
  {
    v10 = 0i64;
    v11 = 40i64;
    do
    {
      if ( *(_QWORD *)(v10 + *((_QWORD *)P + 2)) )
      {
        if ( v8 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v8->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
          && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_112FC(*(_QWORD *)&v8->AlignmentRequirement, 0x1Du, (__int64)&unk_5CC98, v9);
        }
        sub_40B60(*(PVOID *)(v10 + *((_QWORD *)P + 2)), 0xFFFFFFFF);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Eu, (__int64)&unk_5CC98, v9);
        }
        sub_407B8(*(PVOID *)(v10 + *((_QWORD *)P + 2)));
        *(_QWORD *)(v10 + *((_QWORD *)P + 2)) = 0i64;
        if ( *((_BYTE *)P + 12) )
          sub_4031C(*(PVOID *)(*((_QWORD *)P + 3) + v11 + 32));
        v8 = off_60148;
      }
      ++v9;
      v11 += 40i64;
      v10 += 8i64;
    }
    while ( v9 < *((_DWORD *)P + 2) );
  }
  if ( v8 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v8->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v8->AlignmentRequirement, 0x1Fu, (__int64)&unk_5CC98);
  }
  sub_4031C(*(PVOID *)(*((_QWORD *)P + 3) + 32i64));
  sub_4031C(*(PVOID *)P);
  sub_3F6F0(*((PVOID *)P + 2), 0x6E735450u);
  sub_3F6F0(*((PVOID *)P + 3), 0x6E735450u);
  sub_3F6F0(P, 0x6E735450u);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x20u, (__int64)&unk_5CC98);
  }
  return 0i64;
}

//----- (0000000000048AD0) ----------------------------------------------------
__int64 __fastcall sub_48AD0(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  unsigned int v3; // ebx
  unsigned int v4; // esi
  __int64 v5; // r12
  __int64 v6; // rbp
  __int64 v7; // r11
  KIRQL v8; // dl
  KIRQL v10; // [rsp+60h] [rbp+8h] BYREF
  union _LARGE_INTEGER Interval; // [rsp+70h] [rbp+18h] BYREF

  v10 = 0;
  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x21u, (__int64)&unk_5CC98);
    v2 = off_60148;
  }
  if ( *(_BYTE *)(a1 + 12) )
    v3 = *(_DWORD *)(a1 + 8) + 1;
  else
    v3 = 1;
  v4 = 0;
  if ( v3 )
  {
    v5 = 0i64;
    v6 = 0i64;
    do
    {
      Interval.QuadPart = 0i64;
      if ( v2 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
        && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_112FC(*(_QWORD *)&v2->AlignmentRequirement, 0x22u, (__int64)&unk_5CC98, v4);
      }
      while ( 1 )
      {
        sub_401B8((PKSPIN_LOCK)(v6 + *(_QWORD *)(a1 + 24)), &v10);
        v7 = *(_QWORD *)(a1 + 24);
        v8 = v10;
        if ( *(_QWORD *)(v5 + v7 + 8) == v5 + v7 + 8 )
          break;
        sub_40230((PKSPIN_LOCK)(v7 + v6), v10);
        Interval.QuadPart = -3000000i64;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x23u, (__int64)&unk_5CC98, v4);
        }
        KeDelayExecutionThread(0, 0, &Interval);
      }
      *(_QWORD *)(v5 + v7 + 24) = 0i64;
      sub_40230((PKSPIN_LOCK)(v6 + *(_QWORD *)(a1 + 24)), v8);
      v2 = off_60148;
      ++v4;
      v6 += 40i64;
      v5 += 40i64;
    }
    while ( v4 < v3 );
  }
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&v2->AlignmentRequirement, 0x24u, (__int64)&unk_5CC98);
  }
  return 0i64;
}

//----- (0000000000048CA0) ----------------------------------------------------
_QWORD *__fastcall sub_48CA0(__int64 a1, int a2, __int64 a3, __int64 a4)
{
  _QWORD *v7; // rdi
  unsigned int v8; // er12
  PDEVICE_OBJECT v9; // rcx
  PDEVICE_OBJECT v10; // rcx
  _QWORD *v11; // rax
  _QWORD *v12; // rbx

  v7 = 0i64;
  v8 = a2 + 40;
  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x25u, (__int64)&unk_5CC98);
    v9 = off_60148;
  }
  if ( a1 && a3 )
  {
    if ( _InterlockedCompareExchange((volatile signed __int32 *)(a1 + 32), 1, 1) == 1 )
    {
      v10 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return v7;
      if ( !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
        || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 3u )
      {
LABEL_15:
        if ( v10 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v10->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
          && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_112FC(*(_QWORD *)&v10->AlignmentRequirement, 0x28u, (__int64)&unk_5CC98, (int)v7);
        }
        return v7;
      }
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x27u, (__int64)&unk_5CC98);
    }
    else
    {
      v11 = sub_3F66C(2, v8, 0x6E735749u);
      v12 = v11;
      if ( v11 )
      {
        memset(v11, 0, v8);
        v12[1] = v12;
        *v12 = v12;
        v12[3] = a3;
        v12[4] = a4;
        v12[2] = a1;
        v7 = v12 + 5;
      }
    }
    v10 = off_60148;
    goto LABEL_15;
  }
  if ( v9 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    sub_11008(*(_QWORD *)&v9->AlignmentRequirement, 0x26u, (__int64)&unk_5CC98);
  }
  return 0i64;
}

//----- (0000000000048E4C) ----------------------------------------------------
void __fastcall sub_48E4C(__int64 a1, char a2)
{
  PDEVICE_OBJECT v4; // rcx
  void (__fastcall *v5)(__int64); // rax

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x29u, (__int64)&unk_5CC98);
    v4 = off_60148;
  }
  if ( a1 )
  {
    if ( a2 )
    {
      v5 = *(void (__fastcall **)(__int64))(a1 - 8);
      if ( v5 )
        v5(a1);
    }
    sub_3F6F0((PVOID)(a1 - 40), 0x6E735749u);
    v4 = off_60148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v4->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x2Au, (__int64)&unk_5CC98);
  }
}

//----- (0000000000048F24) ----------------------------------------------------
__int64 __fastcall sub_48F24(__int64 a1, unsigned int a2)
{
  unsigned int v4; // edi
  PDEVICE_OBJECT v5; // rcx
  __int64 *v6; // r12
  __int64 v7; // rsi
  __int64 v8; // r11
  __int64 v9; // rcx
  __int64 **v10; // rax
  KIRQL v12; // [rsp+60h] [rbp+8h] BYREF

  v4 = 0;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x2Bu, (__int64)&unk_5CC98);
    v5 = off_60148;
  }
  if ( a1 )
  {
    v6 = (__int64 *)(a1 - 40);
    v12 = 0;
    v7 = *(_QWORD *)(a1 - 40 + 16);
    if ( a2 > *(_DWORD *)(v7 + 8) || !*(_BYTE *)(v7 + 12) )
      a2 = 0;
    if ( _InterlockedCompareExchange((volatile signed __int32 *)(v7 + 32), 1, 1) == 1 )
    {
      v5 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x2Du, (__int64)&unk_5CC98);
        v5 = off_60148;
      }
      v4 = 16;
    }
    else
    {
      sub_401B8((PKSPIN_LOCK)(*(_QWORD *)(v7 + 24) + 40i64 * a2), &v12);
      v8 = *(_QWORD *)(v7 + 24);
      v9 = v8 + 40i64 * a2 + 8;
      v10 = *(__int64 ***)(v8 + 40i64 * a2 + 16);
      *v6 = v9;
      v6[1] = (__int64)v10;
      *v10 = v6;
      *(_QWORD *)(v9 + 8) = v6;
      ++*(_QWORD *)(*(_QWORD *)(v7 + 24) + 40i64 * a2 + 24);
      sub_40384(*(PRKEVENT *)(*(_QWORD *)(v7 + 24) + 40i64 * a2 + 32));
      sub_40230((PKSPIN_LOCK)(*(_QWORD *)(v7 + 24) + 40i64 * a2), v12);
      v5 = off_60148;
    }
  }
  else
  {
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v5->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
      && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_2F80C(*(_QWORD *)&v5->AlignmentRequirement, 0x2Cu, (__int64)&unk_5CC98, 0i64);
      v5 = off_60148;
    }
    v4 = 4;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v5->DeviceQueue.DeviceListHead.Flink + 1, 0x17u)
    && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&v5->AlignmentRequirement, 0x2Eu, (__int64)&unk_5CC98);
  }
  return v4;
}

//----- (0000000000049110) ----------------------------------------------------
__int64 __fastcall sub_49110(__int64 a1, __int64 a2, __int64 a3, const wchar_t *a4)
{
  __int64 v5; // rcx
  const wchar_t *v6; // rdi
  bool v7; // zf

  if ( a4 && *a4 )
  {
    v5 = -1i64;
    v6 = a4;
    do
    {
      if ( !v5 )
        break;
      v7 = *v6++ == 0;
      --v5;
    }
    while ( !v7 );
  }
  if ( a4 )
  {
    if ( !*a4 )
      a4 = L"<NULL>";
  }
  else
  {
    a4 = L"NULL";
  }
  return qword_61238(a1, 43i64, &unk_5CC88, 71i64, a4);
}
// 5D020: using guessed type wchar_t aNull_1[7];
// 5D030: using guessed type wchar_t aNull_2[5];
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000491C0) ----------------------------------------------------
__int64 __fastcall sub_491C0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, a3, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000049218) ----------------------------------------------------
__int64 sub_49218(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, a3, a2, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004927C) ----------------------------------------------------
__int64 sub_4927C(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_61238(a1, 43i64, &unk_5CC88, 134i64, (__int64 *)va);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000492E8) ----------------------------------------------------
__int64 __fastcall sub_492E8(__int16 *a1, int a2, unsigned int *a3)
{
  PDEVICE_OBJECT v6; // rbx
  __int64 v7; // rcx
  unsigned __int16 v8; // dx

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xAu, (__int64)&unk_5CC88);
    v6 = off_60148;
  }
  if ( !byte_62792 )
  {
    memset(&qword_62330, 0, 0x470ui64);
    if ( a3 )
    {
      if ( !(unsigned int)sub_4C114(a3) )
      {
        dword_62788 = 0;
        dword_6278C = 0;
        byte_62793 = 0;
        byte_62790 = 0;
        byte_62791 = 0;
        sub_5A678(word_62350, 520i64, a1);
        dword_62760 = a2;
        byte_62792 = 1;
        sub_494BC(1);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xEu, (__int64)&unk_5CC88, 0);
        }
        return 0i64;
      }
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) == 0
        || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        return 264i64;
      }
      v7 = *(_QWORD *)&off_60148->AlignmentRequirement;
      v8 = 13;
    }
    else
    {
      if ( v6 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) == 0
        || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        return 264i64;
      }
      v7 = *(_QWORD *)&v6->AlignmentRequirement;
      v8 = 12;
    }
    sub_11008(v7, v8, (__int64)&unk_5CC88);
    return 264i64;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0xBu, (__int64)&unk_5CC88);
  }
  return 0i64;
}
// 62760: using guessed type int dword_62760;
// 62788: using guessed type int dword_62788;
// 6278C: using guessed type int dword_6278C;
// 62790: using guessed type char byte_62790;
// 62791: using guessed type char byte_62791;
// 62792: using guessed type char byte_62792;
// 62793: using guessed type char byte_62793;

//----- (00000000000494BC) ----------------------------------------------------
__int64 __fastcall sub_494BC(char a1)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xFu, (__int64)&unk_5CC88);
    v2 = off_60148;
  }
  byte_62794 = a1;
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v2->AlignmentRequirement, 0x10u, (__int64)&unk_5CC88, 0);
  }
  return 0i64;
}
// 62794: using guessed type char byte_62794;

//----- (0000000000049558) ----------------------------------------------------
__int64 __fastcall sub_49558(int a1, int a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  _QWORD *v6; // rax
  _QWORD *v7; // rcx
  PDEVICE_OBJECT v8; // rcx

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x11u, (__int64)&unk_5CC88);
    v4 = off_60148;
  }
  if ( byte_62792 )
  {
    if ( !dword_62788 )
    {
      qword_62338 = (__int64)&qword_62330;
      qword_62330 = &qword_62330;
    }
    v6 = sub_3F66C(2, 0x28u, 0x74785072u);
    if ( v6 )
    {
      v6[4] = 0i64;
      *((_DWORD *)v6 + 4) = a1;
      *((_DWORD *)v6 + 6) = a2;
      *((_DWORD *)v6 + 7) = 2;
      v7 = (_QWORD *)qword_62338;
      *v6 = &qword_62330;
      v6[1] = v7;
      *v7 = v6;
      ++dword_62788;
      qword_62338 = (__int64)v6;
      v8 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x14u, (__int64)&unk_5CC88, a1);
          v8 = off_60148;
        }
        if ( v8 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_112FC(*(_QWORD *)&v8->AlignmentRequirement, 0x15u, (__int64)&unk_5CC88, 0);
        }
      }
      result = 0i64;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x13u, (__int64)&unk_5CC88);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x12u, (__int64)&unk_5CC88);
    }
    result = 258i64;
  }
  return result;
}
// 62338: using guessed type __int64 qword_62338;
// 62788: using guessed type int dword_62788;
// 62792: using guessed type char byte_62792;

//----- (0000000000049738) ----------------------------------------------------
__int64 __fastcall sub_49738(int a1, __int64 a2, int a3)
{
  PDEVICE_OBJECT v6; // rcx
  __int64 result; // rax
  _QWORD *v8; // rax
  _QWORD *v9; // rcx
  PDEVICE_OBJECT v10; // rcx

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x16u, (__int64)&unk_5CC88);
    v6 = off_60148;
  }
  if ( byte_62792 )
  {
    if ( !dword_6278C )
    {
      qword_62348 = (__int64)&qword_62340;
      qword_62340 = &qword_62340;
    }
    v8 = sub_3F66C(2, 0x48u, 0x746D436Eu);
    if ( v8 )
    {
      v8[6] = 0i64;
      *((_DWORD *)v8 + 4) = a1;
      v8[4] = a2;
      *((_DWORD *)v8 + 6) = 1;
      *((_DWORD *)v8 + 7) = a3;
      v8[8] = &qword_62330;
      v9 = (_QWORD *)qword_62348;
      *v8 = &qword_62340;
      v8[1] = v9;
      *v9 = v8;
      ++dword_6278C;
      qword_62348 = (__int64)v8;
      v10 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x19u, (__int64)&unk_5CC88, a1);
          v10 = off_60148;
        }
        if ( v10 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v10->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_112FC(*(_QWORD *)&v10->AlignmentRequirement, 0x1Au, (__int64)&unk_5CC88, 0);
        }
      }
      result = 0i64;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x18u, (__int64)&unk_5CC88);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x17u, (__int64)&unk_5CC88);
    }
    result = 258i64;
  }
  return result;
}
// 62348: using guessed type __int64 qword_62348;
// 6278C: using guessed type int dword_6278C;
// 62792: using guessed type char byte_62792;

//----- (000000000004992C) ----------------------------------------------------
__int64 sub_4992C()
{
  PDEVICE_OBJECT v0; // rcx
  PDEVICE_OBJECT v2; // rcx
  unsigned __int16 v3; // dx

  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Bu, (__int64)&unk_5CC88);
    v0 = off_60148;
  }
  if ( !byte_62792 )
  {
    if ( v0 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v0->AlignmentRequirement, 0x1Cu, (__int64)&unk_5CC88);
    }
    return 258i64;
  }
  if ( !dword_62788
    && !dword_6278C
    && v0 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v0->AlignmentRequirement, 0x1Du, (__int64)&unk_5CC88);
  }
  if ( (unsigned int)sub_4A2C0() )
  {
    v2 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) == 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 257i64;
    }
    v3 = 30;
LABEL_22:
    sub_11008(*(_QWORD *)&v2->AlignmentRequirement, v3, (__int64)&unk_5CC88);
    return 257i64;
  }
  if ( (unsigned int)sub_4A90C() )
  {
    v2 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) == 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 257i64;
    }
    v3 = 31;
    goto LABEL_22;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x20u, (__int64)&unk_5CC88);
  }
  sub_4D654();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x21u, (__int64)&unk_5CC88, 0);
  }
  return 0i64;
}
// 62788: using guessed type int dword_62788;
// 6278C: using guessed type int dword_6278C;
// 62792: using guessed type char byte_62792;

//----- (0000000000049AEC) ----------------------------------------------------
__int64 __fastcall sub_49AEC(int a1, const void *a2, unsigned int a3, int a4, int *a5, void (__fastcall *a6)(const void *, _QWORD))
{
  unsigned int v10; // ebx
  PDEVICE_OBJECT v11; // rcx
  PDEVICE_OBJECT v13; // rcx

  v10 = 0;
  v11 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x22u, (__int64)&unk_5CC88);
    v11 = off_60148;
  }
  if ( !byte_62793 )
  {
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v11->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v11->AlignmentRequirement, 0x23u, (__int64)&unk_5CC88);
    }
    return 260i64;
  }
  if ( (unsigned int)(a1 - 40000) > 0x4D )
  {
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v11->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v11->AlignmentRequirement, 0x24u, (__int64)&unk_5CC88);
    }
    return 261i64;
  }
  if ( !a2 )
  {
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v11->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v11->AlignmentRequirement, 0x25u, (__int64)&unk_5CC88);
    }
    return 4i64;
  }
  if ( *((_QWORD *)qword_62778 + 8 * (unsigned __int64)(unsigned int)(a1 - 40000) + 4) )
  {
    if ( (unsigned int)sub_4BC68(a1, a2, a3, a5) )
    {
      v13 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x27u, (__int64)&unk_5CC88);
        v13 = off_60148;
      }
      v10 = 262;
      goto LABEL_37;
    }
  }
  else if ( (unsigned int)sub_4B3D0(a1, a2, a3, a4, a5, a6) )
  {
    v13 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x26u, (__int64)&unk_5CC88);
      v13 = off_60148;
    }
    v10 = 263;
    goto LABEL_37;
  }
  v13 = off_60148;
LABEL_37:
  if ( v13 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v13->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(v13->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v13->AlignmentRequirement, 0x28u, (__int64)&unk_5CC88, v10);
  }
  return v10;
}
// 62793: using guessed type char byte_62793;

//----- (0000000000049D44) ----------------------------------------------------
__int64 __fastcall sub_49D44(__int64 a1, void *a2, __int64 a3, int a4, int *a5)
{
  unsigned int v7; // ebx
  PDEVICE_OBJECT v8; // rcx
  __int64 result; // rax

  v7 = 0;
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x29u, (__int64)&unk_5CC88);
    v8 = off_60148;
  }
  if ( byte_62793 )
  {
    if ( a2 )
    {
      if ( !*((_QWORD *)qword_62778 + 20) )
      {
        if ( (unsigned int)sub_4B718(40002i64, a2, 42i64, a4, a5) )
        {
          v8 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x2Du, (__int64)&unk_5CC88);
            v8 = off_60148;
          }
          v7 = 263;
        }
        else
        {
          v8 = off_60148;
        }
      }
      if ( v8 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v8->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_112FC(*(_QWORD *)&v8->AlignmentRequirement, 0x2Eu, (__int64)&unk_5CC88, v7);
      }
      result = v7;
    }
    else
    {
      if ( v8 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v8->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&v8->AlignmentRequirement, 0x2Cu, (__int64)&unk_5CC88);
      }
      result = 4i64;
    }
  }
  else
  {
    if ( v8 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v8->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v8->AlignmentRequirement, 0x2Au, (__int64)&unk_5CC88);
    }
    result = 260i64;
  }
  return result;
}
// 62793: using guessed type char byte_62793;

//----- (0000000000049F00) ----------------------------------------------------
__int64 __fastcall sub_49F00(unsigned int a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  int v6; // eax

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x35u, (__int64)&unk_5CC88);
    v4 = off_60148;
  }
  if ( byte_62793 )
  {
    if ( qword_62768 && a2 )
    {
      v6 = (*(__int64 (__fastcall **)(_QWORD, _QWORD, __int64))(*((_QWORD *)qword_62768 + 1) + 8i64))(
             **((_QWORD **)qword_62768 + 1),
             a1,
             a2);
      v4 = off_60148;
    }
    else
    {
      v6 = 1796;
    }
    if ( v6 )
    {
      if ( v4 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&v4->AlignmentRequirement, 0x37u, (__int64)&unk_5CC88, v6);
      }
      result = 257i64;
    }
    else
    {
      if ( v4 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_112FC(*(_QWORD *)&v4->AlignmentRequirement, 0x38u, (__int64)&unk_5CC88, 0);
      }
      result = 0i64;
    }
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x36u, (__int64)&unk_5CC88);
    }
    result = 260i64;
  }
  return result;
}
// 62793: using guessed type char byte_62793;

//----- (000000000004A050) ----------------------------------------------------
__int64 sub_4A050()
{
  PDEVICE_OBJECT v0; // rcx
  int v2; // eax
  unsigned int v3; // edi
  PDEVICE_OBJECT v4; // rbx
  PVOID *v5; // rcx
  PVOID *v6; // rcx

  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x39u, (__int64)&unk_5CC88);
    v0 = off_60148;
  }
  if ( byte_62792 )
  {
    v2 = sub_4B070();
    v3 = v2;
    if ( v2 )
    {
      v4 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Bu, (__int64)&unk_5CC88, v2);
        v4 = off_60148;
      }
      if ( v3 != 260 )
        return v3;
    }
    else
    {
      v4 = off_60148;
    }
    if ( dword_62788 )
    {
      v5 = (PVOID *)qword_62330;
      if ( qword_62330 != &qword_62330 )
      {
        do
        {
          qword_62330 = *v5;
          *((_QWORD *)qword_62330 + 1) = &qword_62330;
          sub_3F6F0(v5, 0x74785072u);
          v5 = (PVOID *)qword_62330;
        }
        while ( qword_62330 != &qword_62330 );
        v4 = off_60148;
      }
    }
    if ( dword_6278C )
    {
      v6 = (PVOID *)qword_62340;
      if ( qword_62340 != &qword_62340 )
      {
        do
        {
          qword_62340 = *v6;
          *((_QWORD *)qword_62340 + 1) = &qword_62340;
          sub_3F6F0(v6, 0x746D436Eu);
          v6 = (PVOID *)qword_62340;
        }
        while ( qword_62340 != &qword_62340 );
        v4 = off_60148;
      }
    }
    if ( qword_62778 && byte_62790 == 1 )
    {
      sub_3F6F0(qword_62778, 0x74785072u);
      qword_62778 = 0i64;
      v4 = off_60148;
    }
    if ( qword_62780 && byte_62791 == 1 )
    {
      sub_3F6F0(qword_62780, 0x746D436Eu);
      v4 = off_60148;
    }
    memset(&qword_62330, 0, 0x470ui64);
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_112FC(*(_QWORD *)&v4->AlignmentRequirement, 0x3Cu, (__int64)&unk_5CC88, v3);
    }
    return v3;
  }
  if ( v0 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v0->AlignmentRequirement, 0x3Au, (__int64)&unk_5CC88);
  }
  return 0i64;
}
// 62788: using guessed type int dword_62788;
// 6278C: using guessed type int dword_6278C;
// 62790: using guessed type char byte_62790;
// 62791: using guessed type char byte_62791;
// 62792: using guessed type char byte_62792;

//----- (000000000004A2C0) ----------------------------------------------------
__int64 sub_4A2C0()
{
  PDEVICE_OBJECT v0; // rcx
  PVOID v1; // rax
  PVOID v3; // rax

  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Du, (__int64)&unk_5CC88);
    v0 = off_60148;
  }
  if ( dword_62788 )
  {
    v1 = sub_3F66C(2, 0x1340u, 0x74785072u);
    qword_62778 = v1;
    if ( !v1 )
      return 3i64;
    memset(v1, 0, 0x1340ui64);
    if ( (unsigned int)sub_4A548(0) )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Eu, (__int64)&unk_5CC88);
      }
      sub_3F6F0(qword_62778, 0x74785072u);
      qword_62778 = 0i64;
      return 1i64;
    }
    v0 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Fu, (__int64)&unk_5CC88);
      v0 = off_60148;
    }
    byte_62790 = 1;
  }
  if ( dword_6278C )
  {
    v3 = sub_3F66C(2, 0x9A0u, 0x746D436Eu);
    qword_62780 = v3;
    if ( v3 )
    {
      memset(v3, 0, 0x9A0ui64);
      if ( (unsigned int)sub_4A548(1) )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x40u, (__int64)&unk_5CC88);
        }
        sub_3F6F0(qword_62780, 0x746D436Eu);
        qword_62780 = 0i64;
        return 1i64;
      }
      v0 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x41u, (__int64)&unk_5CC88);
        v0 = off_60148;
      }
      byte_62791 = 1;
      goto LABEL_33;
    }
    return 3i64;
  }
LABEL_33:
  if ( v0 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v0->AlignmentRequirement, 0x42u, (__int64)&unk_5CC88, 0);
  }
  return 0i64;
}
// 62788: using guessed type int dword_62788;
// 6278C: using guessed type int dword_6278C;
// 62790: using guessed type char byte_62790;
// 62791: using guessed type char byte_62791;

//----- (000000000004A548) ----------------------------------------------------
__int64 __fastcall sub_4A548(int a1)
{
  unsigned int v2; // edi
  PDEVICE_OBJECT v3; // rcx
  PVOID *j; // rbx
  int v5; // edx
  unsigned int v6; // er9
  unsigned __int64 v7; // r8
  PVOID *i; // rbx
  unsigned int v9; // er9
  __int64 v10; // r8
  __int64 (__fastcall *v11)(__int64, __int64, __int64); // rcx
  int v12; // eax

  v2 = 0;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x43u, (__int64)&unk_5CC88);
    v3 = off_60148;
  }
  if ( a1 )
  {
    for ( i = (PVOID *)qword_62340; i != &qword_62340; i = (PVOID *)*i )
    {
      v9 = *((_DWORD *)i + 4) - 40000;
      if ( v9 >= 0x4D )
      {
        if ( v3 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_112FC(*(_QWORD *)&v3->AlignmentRequirement, 0x45u, (__int64)&unk_5CC88, v9);
          v3 = off_60148;
        }
        v2 = 1;
      }
      else
      {
        v10 = 32i64 * v9;
        *(_DWORD *)((char *)qword_62780 + v10) = *((_DWORD *)i + 4);
        *(_DWORD *)((char *)qword_62780 + v10 + 4) = -1;
        *(_DWORD *)((char *)qword_62780 + v10 + 8) = *((_DWORD *)i + 6);
        *(_DWORD *)((char *)qword_62780 + v10 + 12) = *((_DWORD *)i + 7);
        *(_QWORD *)((char *)qword_62780 + v10 + 24) = i + 3;
        if ( *((_DWORD *)i + 4) == 40005 )
        {
          v11 = sub_4CAE4;
        }
        else
        {
          v12 = *((_DWORD *)i + 4);
          if ( v12 == 40015
            || v12 == 40016
            || v12 == 40017
            || v12 == 40018
            || v12 == 40019
            || v12 == 40020
            || v12 == 40021
            || v12 == 40023
            || v12 == 40022
            || v12 == 40039
            || v12 == 40044
            || v12 == 40024
            || v12 == 40036
            || v12 == 40012
            || v12 == 40037
            || v12 == 40014
            || v12 == 40041
            || v12 == 40042
            || v12 == 40013
            || v12 == 40038
            || v12 == 40025 )
          {
            v11 = sub_4D4B0;
          }
          else if ( v12 == 40011
                 || v12 == 40053
                 || v12 == 40050
                 || v12 == 40051
                 || v12 == 40052
                 || v12 == 40045
                 || v12 == 40003 )
          {
            v11 = sub_4C7CC;
          }
          else
          {
            v11 = sub_4C558;
          }
        }
        *(_QWORD *)((char *)qword_62780 + v10 + 16) = v11;
        v3 = off_60148;
      }
    }
  }
  else
  {
    for ( j = (PVOID *)qword_62330; j != &qword_62330; j = (PVOID *)*j )
    {
      v5 = *((_DWORD *)j + 4);
      v6 = v5 - 40000;
      if ( (unsigned int)(v5 - 40000) >= 0x4D )
      {
        if ( v3 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_112FC(*(_QWORD *)&v3->AlignmentRequirement, 0x44u, (__int64)&unk_5CC88, v6);
          v3 = off_60148;
        }
        v2 = 1;
      }
      else
      {
        v7 = (unsigned __int64)v6 << 6;
        *(_DWORD *)((char *)qword_62778 + v7) = v5;
        *(_DWORD *)((char *)qword_62778 + v7 + 4) = *((_DWORD *)j + 6);
        *(_DWORD *)((char *)qword_62778 + v7 + 8) = -1;
        *(_QWORD *)((char *)qword_62778 + v7 + 16) = 0i64;
        *(_DWORD *)((char *)qword_62778 + v7 + 24) = *((_DWORD *)j + 7);
        *(_QWORD *)((char *)qword_62778 + v7 + 32) = (unsigned __int64)sub_4BEBC & -(__int64)(j[4] != 0i64);
        *(_QWORD *)((char *)qword_62778 + v7 + 40) = j + 3;
        *(_DWORD *)((char *)qword_62778 + v7 + 48) = 0;
        *(_QWORD *)((char *)qword_62778 + v7 + 56) = 0i64;
        v3 = off_60148;
      }
    }
  }
  if ( v3 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v3->AlignmentRequirement, 0x46u, (__int64)&unk_5CC88, v2);
  }
  return v2;
}

//----- (000000000004A90C) ----------------------------------------------------
__int64 sub_4A90C()
{
  PDEVICE_OBJECT v0; // rcx
  _QWORD *v1; // rax
  _QWORD *v2; // rbx
  int v3; // edi
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  int v6; // er9
  unsigned int v7; // esi
  __int64 v8; // rdi
  _QWORD *v9; // rbp
  int v10; // er12
  int v11; // eax
  __int64 v12; // rax
  int v13; // eax
  __int64 v14; // r9
  __int64 v15; // r8
  __int64 v16; // rcx
  PDEVICE_OBJECT v18; // r10
  unsigned int v19; // ebx
  __int64 v20; // rdi
  int v21; // er9
  __int64 v22; // rax
  unsigned int v23; // ebx
  __int64 v24; // rdi
  __int64 v25; // rax
  __int64 v26; // rax
  unsigned __int16 v27; // dx
  __int64 (__fastcall **v28)(_QWORD *, _QWORD, void *); // [rsp+60h] [rbp+8h] BYREF

  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_49110(*(_QWORD *)&off_60148->AlignmentRequirement, 71i64, (__int64)&unk_5CC88, word_62350);
    v0 = off_60148;
  }
  if ( byte_62790 || byte_62791 )
    goto LABEL_11;
  if ( v0 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0 && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v0->AlignmentRequirement, 0x48u, (__int64)&unk_5CC88);
      v0 = off_60148;
    }
LABEL_11:
    if ( v0 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_2F80C(*(_QWORD *)&v0->AlignmentRequirement, 0x49u, (__int64)&unk_5CC88, &qword_62768);
    }
  }
  qword_62768 = 0i64;
  v1 = sub_3F66C(2, 0x38u, 0x41434E50u);
  v2 = v1;
  if ( !v1 )
  {
    v3 = 1793;
LABEL_25:
    v4 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) == 0
      || !BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) )
    {
      return 260i64;
    }
    v5 = 74;
    v6 = v3;
LABEL_53:
    v16 = *(_QWORD *)&v4->AlignmentRequirement;
    goto LABEL_54;
  }
  memset(v1, 0, 0x38ui64);
  v3 = sub_583D8(v2 + 6, v2 + 1);
  if ( v3
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531842i64,
               v2 + 2)) != 0
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531845i64,
               v2 + 5)) != 0
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531843i64,
               v2 + 4)) != 0
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531844i64,
               v2 + 3)) != 0 )
  {
    sub_5855C(v2);
    v2 = qword_62768;
  }
  else
  {
    *(_BYTE *)v2 = 1;
    qword_62768 = v2;
  }
  if ( v3 )
    goto LABEL_25;
  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x4Bu, (__int64)&unk_5CC88, &qword_62768, 0i64, 0);
    v4 = off_60148;
    v2 = qword_62768;
  }
  v7 = dword_62760;
  v8 = 0i64;
  v9 = v2;
  v10 = 1796;
  if ( v2 )
  {
    v11 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(v2[1] + 8i64))(*(_QWORD *)v2[1], 1i64, &v28);
    v4 = off_60148;
    v2 = qword_62768;
    if ( !v11 )
    {
      v12 = (*v28)(v9, v7, word_62350);
      v4 = off_60148;
      v2 = qword_62768;
      v8 = v12;
    }
  }
  qword_62770 = v8;
  if ( !v8 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) )
    {
      sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x4Cu, (__int64)&unk_5CC88);
    }
    return 260i64;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_385D4(*(_QWORD *)&v4->AlignmentRequirement, 0x4Du, (__int64)&unk_5CC88, v2, v8, &qword_62318);
    v4 = off_60148;
    v8 = qword_62770;
    v2 = qword_62768;
  }
  v13 = 1796;
  if ( !v8 || (v14 = *(_QWORD *)(v8 + 1112)) == 0 )
  {
LABEL_49:
    if ( v4 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) == 0
      || !BYTE1(v4->DeviceQueue.DeviceListHead.Flink) )
    {
      return 260i64;
    }
    v5 = 78;
    v6 = v13;
    goto LABEL_53;
  }
  v13 = (*(__int64 (__fastcall **)(_QWORD *, __int64, __int64 *))(v14 + 112))(v2, v8, &qword_62318);
  if ( v13 )
  {
    v4 = off_60148;
    goto LABEL_49;
  }
  v18 = off_60148;
  if ( !dword_62788 )
  {
LABEL_71:
    if ( dword_6278C )
    {
      v23 = 0;
      v24 = 0i64;
      do
      {
        if ( v18 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v18->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v18->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_385D4(
            *(_QWORD *)&v18->AlignmentRequirement,
            0x52u,
            (__int64)&unk_5CC88,
            qword_62768,
            qword_62770,
            (char *)qword_62780 + 32 * v23);
          v18 = off_60148;
        }
        if ( *(_DWORD *)((char *)qword_62780 + v24) )
        {
          v21 = 1796;
          if ( !qword_62770 )
            goto LABEL_105;
          v25 = *(_QWORD *)(qword_62770 + 1112);
          if ( !v25 )
            goto LABEL_105;
          v21 = (*(__int64 (__fastcall **)(__int64, char *, __int64, __int64))(v25 + 40))(
                  qword_62770,
                  (char *)qword_62780 + 32 * v23,
                  v15,
                  1796i64);
          if ( v21 )
          {
            v18 = off_60148;
LABEL_105:
            if ( v18 != (PDEVICE_OBJECT)&off_60148
              && (BYTE4(v18->DeviceQueue.DeviceListHead.Flink) & 1) != 0
              && BYTE1(v18->DeviceQueue.DeviceListHead.Flink) )
            {
              v27 = 83;
LABEL_103:
              sub_11430(*(_QWORD *)&v18->AlignmentRequirement, v27, (__int64)&unk_5CC88, v21);
            }
            return 260i64;
          }
          v18 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) )
          {
            sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x54u, (__int64)&unk_5CC88, v23);
            v18 = off_60148;
          }
        }
        ++v23;
        v24 += 32i64;
      }
      while ( v23 < 0x4D );
    }
    if ( v18 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v18->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v18->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_1D3B0(*(_QWORD *)&v18->AlignmentRequirement, 0x55u, (__int64)&unk_5CC88, qword_62768, qword_62770);
      v18 = off_60148;
    }
    if ( qword_62770 )
    {
      v26 = *(_QWORD *)(qword_62770 + 1112);
      if ( v26 )
      {
        v10 = (*(__int64 (__fastcall **)(PVOID))(v26 + 8))(qword_62768);
        if ( !v10 )
        {
          byte_62793 = 1;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x57u, (__int64)&unk_5CC88, 0);
          }
          return 0i64;
        }
        v18 = off_60148;
      }
    }
    if ( v18 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(v18->DeviceQueue.DeviceListHead.Flink) & 1) == 0
      || !BYTE1(v18->DeviceQueue.DeviceListHead.Flink) )
    {
      return 260i64;
    }
    v16 = *(_QWORD *)&v18->AlignmentRequirement;
    v5 = 86;
    v6 = v10;
LABEL_54:
    sub_112FC(v16, v5, (__int64)&unk_5CC88, v6);
    return 260i64;
  }
  v19 = 0;
  v20 = 0i64;
  while ( 1 )
  {
    if ( v18 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v18->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v18->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_385D4(
        *(_QWORD *)&v18->AlignmentRequirement,
        0x4Fu,
        (__int64)&unk_5CC88,
        qword_62768,
        qword_62770,
        (char *)qword_62778 + 64 * (unsigned __int64)v19);
      v18 = off_60148;
    }
    if ( !*(_DWORD *)((char *)qword_62778 + v20) )
      goto LABEL_70;
    v21 = 1796;
    if ( !qword_62770 )
      goto LABEL_99;
    v22 = *(_QWORD *)(qword_62770 + 1112);
    if ( !v22 )
      goto LABEL_99;
    v21 = (*(__int64 (__fastcall **)(__int64, char *, __int64, __int64))(v22 + 64))(
            qword_62770,
            (char *)qword_62778 + 64 * (unsigned __int64)v19,
            v15,
            1796i64);
    if ( v21 )
      break;
    v18 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x51u, (__int64)&unk_5CC88, v19);
      v18 = off_60148;
    }
LABEL_70:
    ++v19;
    v20 += 64i64;
    if ( v19 >= 0x4D )
      goto LABEL_71;
  }
  v18 = off_60148;
LABEL_99:
  if ( v18 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v18->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v18->DeviceQueue.DeviceListHead.Flink) )
  {
    v27 = 80;
    goto LABEL_103;
  }
  return 260i64;
}
// 4AD89: variable 'v15' is possibly undefined
// 62318: using guessed type __int64 qword_62318;
// 62760: using guessed type int dword_62760;
// 62770: using guessed type __int64 qword_62770;
// 62788: using guessed type int dword_62788;
// 6278C: using guessed type int dword_6278C;
// 62790: using guessed type char byte_62790;
// 62791: using guessed type char byte_62791;
// 62793: using guessed type char byte_62793;

//----- (000000000004B070) ----------------------------------------------------
__int64 sub_4B070()
{
  PDEVICE_OBJECT v0; // rcx
  unsigned int v2; // ebx
  __int64 v3; // rdx
  unsigned int v4; // eax
  PVOID v5; // rdi
  __int64 v6; // rax
  int v7; // esi
  int v8; // eax
  int v9; // er11
  char v10; // al
  __int64 v11; // rax
  __int64 v12; // r8
  int v13; // eax
  __int64 v14; // rdx
  __int64 v15; // [rsp+20h] [rbp-28h]
  __int64 v16; // [rsp+50h] [rbp+8h] BYREF

  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x58u, (__int64)&unk_5CC88);
    v0 = off_60148;
  }
  if ( !byte_62793 )
  {
    if ( v0 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v0->AlignmentRequirement, 0x59u, (__int64)&unk_5CC88);
    }
    return 260i64;
  }
  if ( v0 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_2F80C(*(_QWORD *)&v0->AlignmentRequirement, 0x5Au, (__int64)&unk_5CC88, qword_62770);
    v0 = off_60148;
  }
  v2 = 0;
  if ( qword_62770 )
  {
    v3 = *(_QWORD *)(qword_62770 + 1112);
    if ( v3 )
    {
      v4 = (*(__int64 (__fastcall **)(__int64))(v3 + 88))(qword_62770);
      v0 = off_60148;
      v2 = v4;
    }
  }
  if ( v0 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11230(*(_QWORD *)&v0->AlignmentRequirement, 0x5Bu, (__int64)&unk_5CC88, qword_62768, v2);
    v0 = off_60148;
  }
  v5 = qword_62768;
  v6 = 0i64;
  v7 = 1796;
  v16 = 0i64;
  if ( qword_62768 )
  {
    v8 = (*(__int64 (__fastcall **)(_QWORD, __int64, __int64 *))(*((_QWORD *)qword_62768 + 1) + 8i64))(
           **((_QWORD **)qword_62768 + 1),
           1i64,
           &v16);
    v0 = off_60148;
    v9 = v8;
    v6 = v16;
  }
  else
  {
    v9 = 1796;
  }
  if ( !v9 )
  {
    v10 = (*(__int64 (__fastcall **)(PVOID, _QWORD))(v6 + 80))(v5, v2);
    v0 = off_60148;
    if ( v10 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        LODWORD(v15) = v2;
        sub_11230(*(_QWORD *)&off_60148->AlignmentRequirement, 0x5Du, (__int64)&unk_5CC88, qword_62768, v15);
        v0 = off_60148;
      }
      v11 = qword_62770;
      if ( qword_62770 )
      {
        v12 = *(_QWORD *)(qword_62770 + 1112);
        if ( v12 )
        {
          v13 = (*(__int64 (__fastcall **)(PVOID, __int64))(v12 + 16))(qword_62768, qword_62770);
          v0 = off_60148;
          v7 = v13;
          v11 = qword_62770;
        }
      }
      if ( v7 )
      {
        if ( v0 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_112FC(*(_QWORD *)&v0->AlignmentRequirement, 0x5Eu, (__int64)&unk_5CC88, v7 != 0);
        }
        return 257i64;
      }
      if ( v0 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&v0->AlignmentRequirement, 0x5Fu, (__int64)&unk_5CC88);
        v0 = off_60148;
        v11 = qword_62770;
      }
      if ( !v11 )
        goto LABEL_52;
      v14 = *(_QWORD *)(v11 + 1112);
      if ( !v14 )
        goto LABEL_52;
      (*(void (__fastcall **)(__int64))(v14 + 32))(v11);
      goto LABEL_51;
    }
  }
  if ( v0 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) == 0 || BYTE1(v0->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
LABEL_52:
      if ( v0 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_2F80C(*(_QWORD *)&v0->AlignmentRequirement, 0x60u, (__int64)&unk_5CC88, qword_62768);
      }
      goto LABEL_56;
    }
    sub_11008(*(_QWORD *)&v0->AlignmentRequirement, 0x5Cu, (__int64)&unk_5CC88);
LABEL_51:
    v0 = off_60148;
    goto LABEL_52;
  }
LABEL_56:
  sub_5855C(qword_62768);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x61u, (__int64)&unk_5CC88, 0);
  }
  return 0i64;
}
// 4B238: variable 'v15' is possibly undefined
// 62770: using guessed type __int64 qword_62770;
// 62793: using guessed type char byte_62793;

//----- (000000000004B3D0) ----------------------------------------------------
__int64 __fastcall sub_4B3D0(int a1, const void *a2, unsigned int a3, int a4, int *a5, void (__fastcall *a6)(const void *, _QWORD))
{
  unsigned int v6; // ebp
  size_t v8; // rsi
  PDEVICE_OBJECT v11; // r10
  __int64 v12; // rdx
  int v13; // er9
  __int64 v14; // rax
  int v16; // eax
  PDEVICE_OBJECT v17; // rcx
  __int64 v18; // rdx
  int *v19; // rbx
  PDEVICE_OBJECT v20; // rcx
  char v21[8]; // [rsp+40h] [rbp-38h] BYREF
  __int64 v22; // [rsp+48h] [rbp-30h] BYREF
  int v23; // [rsp+80h] [rbp+8h] BYREF

  v6 = 0;
  v8 = a3;
  v22 = 0i64;
  v23 = 0;
  v11 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_491C0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x62u, (__int64)&unk_5CC88, a1);
      v11 = off_60148;
    }
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v11->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_49218(*(_QWORD *)&v11->AlignmentRequirement, 0x63u, (__int64)&unk_5CC88, qword_62768, &unk_62350, v8, &v22);
      v11 = off_60148;
    }
  }
  v12 = *((_QWORD *)qword_62778 + 8 * (unsigned __int64)(unsigned int)(a1 - 40000) + 2);
  v22 = 0i64;
  if ( !qword_62768 )
  {
    v13 = 1799;
    goto LABEL_15;
  }
  if ( !v12 )
  {
    v13 = 1796;
    goto LABEL_15;
  }
  v14 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(*((_QWORD *)qword_62768 + 5) + 16i64))(
          **((_QWORD **)qword_62768 + 5),
          v12,
          (unsigned int)v8);
  v22 = v14;
  if ( !v14 )
  {
    v11 = off_60148;
    v13 = 1798;
LABEL_15:
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v11->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&v11->AlignmentRequirement, 0x64u, (__int64)&unk_5CC88, v13);
    }
    return 1i64;
  }
  if ( a4 )
  {
    *(_DWORD *)(v14 + 32) = a4;
    v14 = v22;
  }
  memmove(*(void **)(v14 + 56), a2, v8);
  v16 = sub_585CC((__int64)qword_62768, v22);
  if ( v16 )
  {
    v17 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x66u, (__int64)&unk_5CC88, v16);
      v17 = off_60148;
    }
    v6 = 263;
  }
  else
  {
    v17 = off_60148;
  }
  v18 = v22;
  if ( qword_62768 && v22 )
  {
    v19 = a5;
    (*(void (__fastcall **)(_QWORD, __int64, int *, int *, char *, _QWORD))(*((_QWORD *)qword_62768 + 5) + 32i64))(
      **((_QWORD **)qword_62768 + 5),
      v22,
      &v23,
      a5,
      v21,
      0i64);
    v18 = v22;
  }
  else
  {
    if ( v17 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v17->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v17->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&v17->AlignmentRequirement, 0x67u, (__int64)&unk_5CC88);
      v18 = v22;
    }
    v19 = a5;
    *a5 = 0;
  }
  v20 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x68u, (__int64)&unk_5CC88, *v19);
    v18 = v22;
    v20 = off_60148;
  }
  if ( a6 )
  {
    a6(a2, *(_QWORD *)(v18 + 56));
    v18 = v22;
    v20 = off_60148;
  }
  if ( v18 && qword_62768 )
  {
    (*(void (__fastcall **)(_QWORD))(*((_QWORD *)qword_62768 + 5) + 24i64))(**((_QWORD **)qword_62768 + 5));
    v20 = off_60148;
  }
  if ( v20 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v20->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(v20->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v20->AlignmentRequirement, 0x69u, (__int64)&unk_5CC88, v6);
  }
  return v6;
}

//----- (000000000004B718) ----------------------------------------------------
__int64 __fastcall sub_4B718(__int64 a1, void *a2, __int64 a3, int a4, int *a5)
{
  void *v6; // rbp
  unsigned int v7; // esi
  PVOID v8; // rdi
  PDEVICE_OBJECT v9; // rcx
  __int64 v10; // rdx
  int v11; // er9
  __int64 v12; // rax
  int v14; // eax
  __int64 v15; // r8
  int *v16; // rbx
  PDEVICE_OBJECT v17; // rcx
  __int64 v18; // r9
  unsigned __int16 v19; // dx
  void *v20; // [rsp+20h] [rbp-58h]
  int v21; // [rsp+28h] [rbp-50h]
  int v22; // [rsp+40h] [rbp-38h] BYREF
  __int64 v23; // [rsp+48h] [rbp-30h] BYREF
  unsigned int v24; // [rsp+80h] [rbp+8h] BYREF

  v6 = a2;
  v7 = 0;
  v23 = 0i64;
  v22 = 0;
  v24 = 0;
  v8 = 0i64;
  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v21 = 42;
      v20 = a2;
      sub_491C0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Au, (__int64)&unk_5CC88, 40002);
      v9 = off_60148;
    }
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_49218(*(_QWORD *)&v9->AlignmentRequirement, 0x6Bu, (__int64)&unk_5CC88, qword_62768, &unk_62350, 42, &v23);
      v9 = off_60148;
    }
  }
  v10 = *((_QWORD *)qword_62778 + 18);
  v23 = 0i64;
  if ( !qword_62768 )
  {
    v11 = 1799;
    goto LABEL_15;
  }
  if ( !v10 )
  {
    v11 = 1796;
    goto LABEL_15;
  }
  v12 = (*(__int64 (__fastcall **)(_QWORD, __int64, __int64))(*((_QWORD *)qword_62768 + 5) + 16i64))(
          **((_QWORD **)qword_62768 + 5),
          v10,
          42i64);
  v23 = v12;
  if ( !v12 )
  {
    v9 = off_60148;
    v11 = 1798;
LABEL_15:
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&v9->AlignmentRequirement, 0x6Cu, (__int64)&unk_5CC88, v11);
    }
    return 1i64;
  }
  if ( a4 )
  {
    *(_DWORD *)(v12 + 32) = a4;
    v12 = v23;
  }
  memmove(*(void **)(v12 + 56), v6, 0x2Aui64);
  v14 = sub_585CC((__int64)qword_62768, v23);
  if ( v14 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Eu, (__int64)&unk_5CC88, v14);
    }
    v7 = 263;
  }
  if ( qword_62768 && v23 )
  {
    v16 = a5;
    (*(void (__fastcall **)(_QWORD, __int64, int *, int *, unsigned int *, _QWORD))(*((_QWORD *)qword_62768 + 5) + 32i64))(
      **((_QWORD **)qword_62768 + 5),
      v23,
      &v22,
      a5,
      &v24,
      0i64);
  }
  else
  {
    v16 = a5;
    *a5 = 0;
  }
  v17 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Fu, (__int64)&unk_5CC88, *v16);
    v17 = off_60148;
  }
  if ( !qword_62768 )
  {
    v18 = 1799i64;
    goto LABEL_64;
  }
  if ( !v23 )
  {
    v18 = 1796i64;
    goto LABEL_64;
  }
  (*(void (__fastcall **)(_QWORD, __int64, int *, int *, unsigned int *, _QWORD))(*((_QWORD *)qword_62768 + 5) + 32i64))(
    **((_QWORD **)qword_62768 + 5),
    v23,
    &v22,
    v16,
    &v24,
    0i64);
  v18 = 0i64;
  if ( v24 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x70u, (__int64)&unk_5CC88, v24);
    }
    v21 = 0;
    v20 = 0i64;
    v8 = sub_3F66C(2, v24, 0x726D624Eu);
    if ( v8 )
    {
      if ( !qword_62768 )
      {
        v18 = 1799i64;
        goto LABEL_50;
      }
      if ( !v23 )
      {
        v18 = 1796i64;
LABEL_50:
        v17 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148
          || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
          || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
        {
          goto LABEL_69;
        }
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x72u, (__int64)&unk_5CC88, v18);
        goto LABEL_68;
      }
      (*(void (__fastcall **)(_QWORD, __int64, int *, int *, unsigned int *, PVOID))(*((_QWORD *)qword_62768 + 5) + 32i64))(
        **((_QWORD **)qword_62768 + 5),
        v23,
        &v22,
        v16,
        &v24,
        v8);
      v17 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 4u )
      {
        goto LABEL_69;
      }
      v19 = 113;
    }
    else
    {
      v17 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_69;
      }
      v19 = 115;
    }
    sub_11008(*(_QWORD *)&v17->AlignmentRequirement, v19, (__int64)&unk_5CC88);
    goto LABEL_68;
  }
  v17 = off_60148;
LABEL_64:
  if ( v17 == (PDEVICE_OBJECT)&off_60148
    || !_bittest((const signed __int32 *)&v17->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    || BYTE1(v17->DeviceQueue.DeviceListHead.Flink) < 2u )
  {
    goto LABEL_69;
  }
  LODWORD(v20) = v24;
  sub_11430(*(_QWORD *)&v17->AlignmentRequirement, 0x74u, (__int64)&unk_5CC88, v18);
LABEL_68:
  v17 = off_60148;
LABEL_69:
  if ( sub_31438 )
  {
    sub_31438(v6, *(_QWORD *)(v23 + 56), v8);
    v17 = off_60148;
  }
  if ( v8 )
  {
    LODWORD(v20) = 0;
    sub_3F6F0(v8, 0x726D624Eu);
    v17 = off_60148;
  }
  if ( v23 && qword_62768 )
  {
    (*(void (__fastcall **)(_QWORD, __int64, __int64, __int64, void *, int))(*((_QWORD *)qword_62768 + 5) + 24i64))(
      **((_QWORD **)qword_62768 + 5),
      v23,
      v15,
      v18,
      v20,
      v21);
    v17 = off_60148;
  }
  if ( v17 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v17->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(v17->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v17->AlignmentRequirement, 0x75u, (__int64)&unk_5CC88, v7);
  }
  return v7;
}
// 4BC0D: variable 'v15' is possibly undefined
// 4BC0D: variable 'v18' is possibly undefined
// 4BC0D: variable 'v20' is possibly undefined
// 4BC0D: variable 'v21' is possibly undefined

//----- (000000000004BC68) ----------------------------------------------------
__int64 __fastcall sub_4BC68(int a1, const void *a2, unsigned int a3, _DWORD *a4)
{
  size_t v5; // rdi
  const void *v6; // rsi
  __int64 v8; // rdx
  int v9; // eax
  __int64 v10; // rax
  __int64 v11; // rbx
  PDEVICE_OBJECT v13; // rcx
  _QWORD *v14; // rdx
  int v15; // eax
  const void *v16; // [rsp+20h] [rbp-28h]

  v5 = a3;
  v6 = a2;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v16 = a2;
    sub_491C0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x7Eu, (__int64)&unk_5CC88, a1);
  }
  *a4 = 0;
  v8 = *((_QWORD *)qword_62778 + 8 * (unsigned __int64)(unsigned int)(a1 - 40000) + 2);
  if ( !qword_62768 )
  {
    v9 = 1799;
LABEL_11:
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x7Fu, (__int64)&unk_5CC88, v9);
    }
    return 1i64;
  }
  if ( !v8 )
  {
    v9 = 1796;
    goto LABEL_11;
  }
  v10 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(*((_QWORD *)qword_62768 + 5) + 16i64))(
          **((_QWORD **)qword_62768 + 5),
          v8,
          (unsigned int)v5);
  v11 = v10;
  if ( !v10 )
  {
    v9 = 1798;
    goto LABEL_11;
  }
  memmove(*(void **)(v10 + 56), v6, v5);
  v13 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_385D4(*(_QWORD *)&off_60148->AlignmentRequirement, 0x81u, (__int64)&unk_5CC88, qword_62768, v11, sub_4BEBC);
    v13 = off_60148;
  }
  v14 = qword_62768;
  if ( !qword_62768 )
  {
    v15 = 1799;
LABEL_26:
    if ( v13 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v13->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v13->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&v13->AlignmentRequirement, 0x82u, (__int64)&unk_5CC88, v15);
      v14 = qword_62768;
    }
    if ( v14 )
      (*(void (__fastcall **)(_QWORD, __int64))(v14[5] + 24i64))(*(_QWORD *)v14[5], v11);
    return 1i64;
  }
  if ( sub_4BEBC )
  {
    LOBYTE(v16) = 0;
    v15 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, const void *, __int64 (__fastcall *)(__int64, __int64, __int64)))(*((_QWORD *)qword_62768 + 3) + 16i64))(
            **((_QWORD **)qword_62768 + 3),
            v11,
            0i64,
            0i64,
            v16,
            sub_4BEBC);
    v13 = off_60148;
    v14 = qword_62768;
  }
  else
  {
    v15 = 1796;
  }
  if ( v15 )
    goto LABEL_26;
  if ( v13 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v13->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(v13->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v13->AlignmentRequirement, 0x83u, (__int64)&unk_5CC88, 0);
  }
  return 0i64;
}
// 4BDFC: variable 'v16' is possibly undefined

//----- (000000000004BEBC) ----------------------------------------------------
__int64 __fastcall sub_4BEBC(__int64 a1, __int64 a2, __int64 a3)
{
  unsigned int v3; // esi
  PDEVICE_OBJECT v7; // rcx
  void (__fastcall *v9)(_QWORD, _QWORD, _QWORD, int *); // rdi
  unsigned __int16 v10; // dx
  char v11[40]; // [rsp+40h] [rbp-28h] BYREF
  int v12; // [rsp+80h] [rbp+18h] BYREF
  char v13; // [rsp+88h] [rbp+20h] BYREF

  v3 = 0;
  v12 = 0;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_385D4(*(_QWORD *)&off_60148->AlignmentRequirement, 0x84u, (__int64)&unk_5CC88, a1, a2, a3);
    v7 = off_60148;
  }
  if ( a3 )
  {
    if ( a2 )
    {
      v9 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, int *))(a2 + 8);
      if ( v9 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
          && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_4927C(*(_QWORD *)&v7->AlignmentRequirement, 134i64, (__int64)&unk_5CC88, qword_62768, a3, &v13, &v12);
          v7 = off_60148;
        }
        if ( qword_62768 )
        {
          (*(void (__fastcall **)(_QWORD, __int64, char *, int *, char *, _QWORD))(*((_QWORD *)qword_62768 + 5) + 32i64))(
            **((_QWORD **)qword_62768 + 5),
            a3,
            &v13,
            &v12,
            v11,
            0i64);
        }
        else
        {
          v3 = 1799;
          if ( v7 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
            && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            sub_112FC(*(_QWORD *)&v7->AlignmentRequirement, 0x87u, (__int64)&unk_5CC88, 1799);
          }
        }
        v9(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), &v12);
        if ( qword_62768 )
          (*(void (__fastcall **)(_QWORD, __int64))(*((_QWORD *)qword_62768 + 5) + 24i64))(
            **((_QWORD **)qword_62768 + 5),
            a3);
        goto LABEL_34;
      }
      if ( v7 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
          && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          v10 = 136;
LABEL_33:
          sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v10, (__int64)&unk_5CC88);
LABEL_34:
          v7 = off_60148;
          goto LABEL_35;
        }
        goto LABEL_35;
      }
    }
    else if ( v7 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        v10 = 137;
        goto LABEL_33;
      }
LABEL_35:
      if ( v7 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_112FC(*(_QWORD *)&v7->AlignmentRequirement, 0x8Au, (__int64)&unk_5CC88, v3);
      }
      return v3;
    }
    return v3;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v7->AlignmentRequirement, 0x85u, (__int64)&unk_5CC88);
  }
  return 3899654172i64;
}

//----- (000000000004C114) ----------------------------------------------------
__int64 __fastcall sub_4C114(unsigned int *a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 result; // rax

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x8Bu, (__int64)&unk_5CC88);
    v2 = off_60148;
  }
  qword_62318 = 0i64;
  qword_62320 = 0i64;
  qword_62328 = 0i64;
  qword_62318 = *a1;
  HIDWORD(qword_62318) = *((unsigned __int8 *)a1 + 4);
  qword_62320 = *((_QWORD *)a1 + 1);
  if ( *((_QWORD *)a1 + 2) )
  {
    qword_62328 = (__int64)sub_4C270;
    qword_62798 = (__int64 (__fastcall *)(_QWORD))*((_QWORD *)a1 + 2);
    if ( v2 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 1) != 0 && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&v2->AlignmentRequirement, 0x8Cu, (__int64)&unk_5CC88);
        v2 = off_60148;
      }
      if ( v2 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_112FC(*(_QWORD *)&v2->AlignmentRequirement, 0x8Eu, (__int64)&unk_5CC88, 0);
      }
    }
    result = 0i64;
  }
  else
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v2->AlignmentRequirement, 0x8Du, (__int64)&unk_5CC88);
    }
    result = 264i64;
  }
  return result;
}
// 62318: using guessed type __int64 qword_62318;
// 62320: using guessed type __int64 qword_62320;
// 62328: using guessed type __int64 qword_62328;
// 62798: using guessed type __int64 (__fastcall *qword_62798)(_QWORD);

//----- (000000000004C270) ----------------------------------------------------
__int64 __fastcall sub_4C270(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v4; // rcx

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x8Fu, (__int64)&unk_5CC88);
      v4 = off_60148;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v4->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_2F80C(*(_QWORD *)&v4->AlignmentRequirement, 0x90u, (__int64)&unk_5CC88, a3);
      v4 = off_60148;
    }
  }
  if ( qword_62798 )
  {
    qword_62798(a3);
    v4 = off_60148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v4->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v4->AlignmentRequirement, 0x91u, (__int64)&unk_5CC88, 0);
  }
  return 0i64;
}
// 62798: using guessed type __int64 (__fastcall *qword_62798)(_QWORD);

//----- (000000000004C35C) ----------------------------------------------------
__int64 __fastcall sub_4C35C(__int64 a1, int a2, unsigned int a3, void *a4)
{
  unsigned int v8; // ebx
  PDEVICE_OBJECT v9; // rcx
  _DWORD *v11; // rdi
  __int64 v12; // r8
  int v13; // eax

  v8 = 6;
  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x92u, (__int64)&unk_5CC88, a2);
    v9 = off_60148;
  }
  if ( !byte_62793 )
  {
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v9->AlignmentRequirement, 0x93u, (__int64)&unk_5CC88);
    }
    return 260i64;
  }
  v11 = *(_DWORD **)(a1 + 56);
  if ( v11 )
  {
    if ( a2
      && v9 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_112FC(*(_QWORD *)&v9->AlignmentRequirement, 0x94u, (__int64)&unk_5CC88, a2);
      v9 = off_60148;
    }
    v12 = a2 != 0 ? 0x80000000 : 0;
    if ( *v11 == 3 || *v11 == 8 )
    {
      v13 = sub_58610((__int64)qword_62768, a1, v12, a3, a4);
    }
    else
    {
      if ( !qword_62768 )
      {
        v13 = 1799;
        goto LABEL_24;
      }
      v13 = (*(__int64 (__fastcall **)(_QWORD, __int64, __int64, _QWORD, _QWORD))(*((_QWORD *)qword_62768 + 3) + 24i64))(
              **((_QWORD **)qword_62768 + 3),
              a1,
              v12,
              0i64,
              0i64);
    }
    v9 = off_60148;
LABEL_24:
    if ( v13 )
    {
      if ( v9 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&v9->AlignmentRequirement, 0x95u, (__int64)&unk_5CC88, v13);
        v9 = off_60148;
      }
      v8 = 273;
    }
    else
    {
      v8 = 0;
    }
  }
  if ( v9 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v9->AlignmentRequirement, 0x96u, (__int64)&unk_5CC88, v8);
  }
  return v8;
}
// 62793: using guessed type char byte_62793;

//----- (000000000004C558) ----------------------------------------------------
__int64 __fastcall sub_4C558(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, _QWORD, __int64, unsigned int *); // rax
  unsigned int v8; // ebx
  unsigned int v9; // eax
  unsigned __int16 v11; // dx
  unsigned int v12; // [rsp+58h] [rbp+20h] BYREF

  v12 = 3;
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_385D4(*(_QWORD *)&off_60148->AlignmentRequirement, 0x97u, (__int64)&unk_5CC88, a1, a2, a3);
      v6 = off_60148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_112FC(*(_QWORD *)&v6->AlignmentRequirement, 0x98u, (__int64)&unk_5CC88, *(_DWORD *)a3);
      v6 = off_60148;
    }
  }
  if ( !byte_62794 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x99u, (__int64)&unk_5CC88);
    }
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_37;
      }
      v11 = 157;
LABEL_36:
      sub_11008(*(_QWORD *)&v6->AlignmentRequirement, v11, (__int64)&unk_5CC88);
      v6 = off_60148;
      goto LABEL_37;
    }
    return 0i64;
  }
  v7 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, __int64, unsigned int *))(a2 + 8);
  if ( !v7 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_37;
      }
      v11 = 156;
      goto LABEL_36;
    }
    return 0i64;
  }
  v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), a3, &v12);
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x9Au, (__int64)&unk_5CC88, v12);
    v6 = off_60148;
  }
  if ( !qword_62768 )
  {
    v8 = 1799;
    goto LABEL_23;
  }
  v9 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, _QWORD))(*((_QWORD *)qword_62768 + 3) + 24i64))(
         **((_QWORD **)qword_62768 + 3),
         a3,
         v12,
         0i64,
         0i64);
  v6 = off_60148;
  v8 = v9;
  if ( !v9 )
  {
LABEL_37:
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_112FC(*(_QWORD *)&v6->AlignmentRequirement, 0x9Eu, (__int64)&unk_5CC88, 0);
    }
    return 0i64;
  }
LABEL_23:
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_112FC(*(_QWORD *)&v6->AlignmentRequirement, 0x9Bu, (__int64)&unk_5CC88, v8);
  }
  return v8;
}
// 62794: using guessed type char byte_62794;

//----- (000000000004C7CC) ----------------------------------------------------
__int64 __fastcall sub_4C7CC(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, _QWORD, unsigned int *, PVOID *, __int64 *); // rax
  PDEVICE_OBJECT v8; // rcx
  int v9; // eax
  unsigned int v10; // ebx
  unsigned __int16 v12; // dx
  __int64 v13; // [rsp+20h] [rbp-28h]
  __int64 Tag; // [rsp+30h] [rbp-18h] BYREF
  PVOID P[2]; // [rsp+38h] [rbp-10h] BYREF
  unsigned int v16; // [rsp+68h] [rbp+20h] BYREF

  P[0] = 0i64;
  v16 = 0;
  LODWORD(Tag) = 0;
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_385D4(*(_QWORD *)&off_60148->AlignmentRequirement, 0x9Fu, (__int64)&unk_5CC88, a1, a2, a3, Tag);
      v6 = off_60148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_112FC(*(_QWORD *)&v6->AlignmentRequirement, 0xA0u, (__int64)&unk_5CC88, *(_DWORD *)a3);
      v6 = off_60148;
    }
  }
  if ( !byte_62794 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0xA1u, (__int64)&unk_5CC88);
    }
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148 )
      return 0i64;
    if ( !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_46;
    }
    v12 = 167;
    goto LABEL_44;
  }
  v7 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, unsigned int *, PVOID *, __int64 *))(a2 + 16);
  if ( !v7 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148 )
      return 0i64;
    if ( !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_46;
    }
    v12 = 166;
LABEL_44:
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, v12, (__int64)&unk_5CC88);
    goto LABEL_45;
  }
  v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), &v16, P, &Tag);
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xA2u, (__int64)&unk_5CC88, 5);
      v8 = off_60148;
    }
    if ( v8 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v8->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_112FC(*(_QWORD *)&v8->AlignmentRequirement, 0xA3u, (__int64)&unk_5CC88, v16);
    }
  }
  v9 = sub_58610((__int64)qword_62768, a3, 5i64, v16, P[0]);
  v10 = v9;
  if ( !v9 )
  {
    if ( !P[0] || !v16 )
      goto LABEL_45;
    LODWORD(v13) = 0;
    sub_3F6F0(P[0], Tag);
    v6 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0xA5u, (__int64)&unk_5CC88, P[0], v13);
LABEL_45:
        v6 = off_60148;
      }
LABEL_46:
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_112FC(*(_QWORD *)&v6->AlignmentRequirement, 0xA8u, (__int64)&unk_5CC88, 0);
      }
    }
    return 0i64;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xA4u, (__int64)&unk_5CC88, v9);
  }
  return v10;
}
// 4CA3B: variable 'v13' is possibly undefined
// 62794: using guessed type char byte_62794;

//----- (000000000004CAE4) ----------------------------------------------------
__int64 __fastcall sub_4CAE4(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, __int64, __int64); // rax
  unsigned __int16 v8; // dx

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_385D4(*(_QWORD *)&off_60148->AlignmentRequirement, 0xF7u, (__int64)&unk_5CC88, a1, a2, a3);
      v6 = off_60148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_112FC(*(_QWORD *)&v6->AlignmentRequirement, 0xF8u, (__int64)&unk_5CC88, *(_DWORD *)a3);
      v6 = off_60148;
    }
  }
  if ( !byte_62794 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0xF9u, (__int64)&unk_5CC88);
    }
    return 0i64;
  }
  if ( a2 )
  {
    v7 = *(void (__fastcall **)(_QWORD, _QWORD, __int64, __int64))(a2 + 24);
    if ( v7 )
    {
      v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), 1024i64, a1);
      v6 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        return 0i64;
      if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) == 0
        || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 4u )
      {
        goto LABEL_30;
      }
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xFAu, (__int64)&unk_5CC88, 3);
      goto LABEL_29;
    }
    if ( v6 == (PDEVICE_OBJECT)&off_60148 )
      return 0i64;
    if ( (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) == 0 || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      goto LABEL_30;
    v8 = 251;
  }
  else
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148 )
      return 0i64;
    if ( (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) == 0 || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      goto LABEL_30;
    v8 = 252;
  }
  sub_11008(*(_QWORD *)&v6->AlignmentRequirement, v8, (__int64)&unk_5CC88);
LABEL_29:
  v6 = off_60148;
LABEL_30:
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v6->AlignmentRequirement, 0xFDu, (__int64)&unk_5CC88, 0);
  }
  return 0i64;
}
// 4CBE7: variable 'a1' is possibly undefined
// 62794: using guessed type char byte_62794;

//----- (000000000004CCC4) ----------------------------------------------------
__int64 __fastcall sub_4CCC4(int a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 result; // rax
  int v4; // eax
  unsigned int v5; // ebx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xFEu, (__int64)&unk_5CC88);
    v2 = off_60148;
  }
  if ( byte_62792 )
  {
    v4 = sub_49558(a1, 2);
    v5 = v4;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x100u, (__int64)&unk_5CC88, v4);
    }
    result = v5;
  }
  else
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v2->AlignmentRequirement, 0xFFu, (__int64)&unk_5CC88);
    }
    result = 258i64;
  }
  return result;
}
// 62792: using guessed type char byte_62792;

//----- (000000000004CDB4) ----------------------------------------------------
__int64 __fastcall sub_4CDB4(int a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  _QWORD *v6; // rax
  _QWORD *v7; // rcx
  PDEVICE_OBJECT v8; // rcx

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x101u, (__int64)&unk_5CC88);
    v4 = off_60148;
  }
  if ( byte_62792 )
  {
    if ( !dword_6278C )
    {
      qword_62348 = (__int64)&qword_62340;
      qword_62340 = &qword_62340;
    }
    v6 = sub_3F66C(2, 0x48u, 0x746D436Eu);
    if ( v6 )
    {
      v6[4] = 0i64;
      v6[6] = 0i64;
      *((_DWORD *)v6 + 7) = 0;
      *((_DWORD *)v6 + 4) = a1;
      v6[7] = a2;
      *((_DWORD *)v6 + 6) = 1;
      v6[8] = &qword_62330;
      v7 = (_QWORD *)qword_62348;
      *v6 = &qword_62340;
      v6[1] = v7;
      *v7 = v6;
      ++dword_6278C;
      qword_62348 = (__int64)v6;
      v8 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x104u, (__int64)&unk_5CC88, a1);
          v8 = off_60148;
        }
        if ( v8 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_112FC(*(_QWORD *)&v8->AlignmentRequirement, 0x105u, (__int64)&unk_5CC88, 0);
        }
      }
      result = 0i64;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x103u, (__int64)&unk_5CC88);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x102u, (__int64)&unk_5CC88);
    }
    result = 258i64;
  }
  return result;
}
// 62348: using guessed type __int64 qword_62348;
// 6278C: using guessed type int dword_6278C;
// 62792: using guessed type char byte_62792;

//----- (000000000004CFA8) ----------------------------------------------------
__int64 __fastcall sub_4CFA8(int a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  _QWORD *v6; // rax
  _QWORD *v7; // rcx
  PDEVICE_OBJECT v8; // rcx

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x106u, (__int64)&unk_5CC88);
    v4 = off_60148;
  }
  if ( byte_62792 )
  {
    if ( !dword_6278C )
    {
      qword_62348 = (__int64)&qword_62340;
      qword_62340 = &qword_62340;
    }
    v6 = sub_3F66C(2, 0x48u, 0x746D436Eu);
    if ( v6 )
    {
      v6[4] = 0i64;
      v6[6] = 0i64;
      v6[7] = 0i64;
      *((_DWORD *)v6 + 7) = 0;
      *((_DWORD *)v6 + 4) = a1;
      v6[5] = a2;
      *((_DWORD *)v6 + 6) = 1;
      v6[8] = &qword_62330;
      v7 = (_QWORD *)qword_62348;
      *v6 = &qword_62340;
      v6[1] = v7;
      *v7 = v6;
      ++dword_6278C;
      qword_62348 = (__int64)v6;
      v8 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x109u, (__int64)&unk_5CC88, a1);
          v8 = off_60148;
        }
        if ( v8 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_112FC(*(_QWORD *)&v8->AlignmentRequirement, 0x10Au, (__int64)&unk_5CC88, 0);
        }
      }
      result = 0i64;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x108u, (__int64)&unk_5CC88);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x107u, (__int64)&unk_5CC88);
    }
    result = 258i64;
  }
  return result;
}
// 62348: using guessed type __int64 qword_62348;
// 6278C: using guessed type int dword_6278C;
// 62792: using guessed type char byte_62792;

//----- (000000000004D1A4) ----------------------------------------------------
__int64 __fastcall sub_4D1A4(int a1, const void *a2, unsigned int a3)
{
  unsigned int v3; // ebx
  size_t v4; // rsi
  PDEVICE_OBJECT v7; // r10
  unsigned int v9; // edi
  __int64 v10; // rdx
  __int64 v11; // rax
  __int64 v12; // rcx
  unsigned __int16 v13; // dx
  int v14; // eax
  PDEVICE_OBJECT v15; // rcx
  __int64 v16; // [rsp+78h] [rbp+20h] BYREF

  v3 = 0;
  v4 = a3;
  v16 = 0i64;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x10Bu, (__int64)&unk_5CC88);
    v7 = off_60148;
  }
  if ( !byte_62793 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v7->AlignmentRequirement, 0x10Cu, (__int64)&unk_5CC88);
    }
    return 260i64;
  }
  v9 = a1 - 40000;
  if ( v9 <= 0x4D )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_49218(*(_QWORD *)&v7->AlignmentRequirement, 0x10Eu, (__int64)&unk_5CC88, qword_62768, &unk_62350, v4, &v16);
      v7 = off_60148;
    }
    v10 = *((_QWORD *)qword_62778 + 8 * (unsigned __int64)v9 + 2);
    v16 = 0i64;
    if ( qword_62768 )
    {
      if ( v10 )
      {
        v11 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(*((_QWORD *)qword_62768 + 5) + 16i64))(
                **((_QWORD **)qword_62768 + 5),
                v10,
                (unsigned int)v4);
        v16 = v11;
        if ( v11 )
        {
          memmove(*(void **)(v11 + 56), a2, v4);
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
          {
            sub_1D3B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x111u, (__int64)&unk_5CC88, qword_62768, v16);
          }
          v14 = sub_585CC((__int64)qword_62768, v16);
          if ( v14 )
          {
            v15 = off_60148;
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
              && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
            {
              sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x112u, (__int64)&unk_5CC88, v14);
              v15 = off_60148;
            }
            v3 = 263;
          }
          else
          {
            v15 = off_60148;
          }
          if ( v16 )
          {
            if ( qword_62768 )
            {
              (*(void (__fastcall **)(_QWORD))(*((_QWORD *)qword_62768 + 5) + 24i64))(**((_QWORD **)qword_62768 + 5));
              v15 = off_60148;
            }
            v16 = 0i64;
          }
          if ( v15 == (PDEVICE_OBJECT)&off_60148
            || !_bittest((const signed __int32 *)&v15->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
            || BYTE1(v15->DeviceQueue.DeviceListHead.Flink) < 5u )
          {
            return v3;
          }
          v12 = *(_QWORD *)&v15->AlignmentRequirement;
          v13 = 275;
          goto LABEL_50;
        }
        v7 = off_60148;
        v3 = 1798;
      }
      else
      {
        v3 = 1796;
      }
    }
    else
    {
      v3 = 1799;
    }
    if ( v7 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
      || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return v3;
    }
    v12 = *(_QWORD *)&v7->AlignmentRequirement;
    v13 = 271;
LABEL_50:
    sub_112FC(v12, v13, (__int64)&unk_5CC88, v3);
    return v3;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v7->AlignmentRequirement, 0x10Du, (__int64)&unk_5CC88);
  }
  return 261i64;
}
// 62793: using guessed type char byte_62793;

//----- (000000000004D4B0) ----------------------------------------------------
__int64 __fastcall sub_4D4B0(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, _QWORD, __int64); // rax
  unsigned __int16 v8; // dx

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_385D4(*(_QWORD *)&off_60148->AlignmentRequirement, 0x114u, (__int64)&unk_5CC88, a1, a2, a3);
      v6 = off_60148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_112FC(*(_QWORD *)&v6->AlignmentRequirement, 0x115u, (__int64)&unk_5CC88, *(_DWORD *)a3);
      v6 = off_60148;
    }
  }
  if ( !byte_62794 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x116u, (__int64)&unk_5CC88);
    }
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148 )
      return 0i64;
    if ( (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) == 0 || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      goto LABEL_27;
    v8 = 280;
    goto LABEL_25;
  }
  v7 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, __int64))(a2 + 32);
  if ( !v7 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148 )
      return 0i64;
    if ( (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) == 0 || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      goto LABEL_27;
    v8 = 279;
LABEL_25:
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, v8, (__int64)&unk_5CC88);
    goto LABEL_26;
  }
  v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), a1);
LABEL_26:
  v6 = off_60148;
LABEL_27:
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v6->AlignmentRequirement, 0x119u, (__int64)&unk_5CC88, 0);
  }
  return 0i64;
}
// 4D5B1: variable 'a1' is possibly undefined
// 62794: using guessed type char byte_62794;

//----- (000000000004D654) ----------------------------------------------------
__int64 sub_4D654()
{
  unsigned int v0; // ebx
  PDEVICE_OBJECT v1; // rcx
  int v2; // eax

  v0 = 0;
  v1 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x11Au, (__int64)&unk_5CC88);
    v1 = off_60148;
  }
  if ( qword_627A0 )
    goto LABEL_12;
  v2 = sub_49F00(9u, (__int64)&qword_627A0);
  v0 = v2;
  if ( !v2 )
    goto LABEL_11;
  v1 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return v0;
  if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x11Bu, (__int64)&unk_5CC88, v2);
LABEL_11:
    v1 = off_60148;
  }
LABEL_12:
  if ( v1 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v1->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v1->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v1->AlignmentRequirement, 0x11Cu, (__int64)&unk_5CC88, v0);
  }
  return v0;
}
// 627A0: using guessed type __int64 qword_627A0;

//----- (000000000004D74C) ----------------------------------------------------
void __fastcall sub_4D74C(int a1, __int64 a2)
{
  unsigned int v2; // ebx
  PVOID v3; // rax

  if ( !P )
  {
    dword_622E4 = a1;
    qword_64DA8 = a2;
    v2 = 4 * a1;
    v3 = sub_3F66C(2, 4 * a1, 0x72746E63u);
    P = v3;
    if ( v3 )
      memset(v3, 0, v2);
  }
}
// 622E4: using guessed type int dword_622E4;
// 64DA8: using guessed type __int64 qword_64DA8;

//----- (000000000004D7B4) ----------------------------------------------------
void __fastcall DeferredRoutine(_KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)
{
  if ( DeferredContext )
    ((void (__fastcall *)(_KDPC *, PVOID, PVOID, PVOID))DeferredContext)(
      Dpc,
      DeferredContext,
      SystemArgument1,
      SystemArgument2);
  KeSetTimer(&Timer, (LARGE_INTEGER)qword_650B8, &::Dpc);
}
// 650B8: using guessed type __int64 qword_650B8;

//----- (000000000004D7E8) ----------------------------------------------------
const char *__fastcall sub_4D7E8(int a1)
{
  const char *result; // rax

  if ( !(_WORD)a1 )
    return "UNKNOWN";
  switch ( (unsigned __int16)a1 )
  {
    case 1u:
      return "W_ALLOW";
    case 2u:
      return "W_DENY";
    case 3u:
      return "S_ALLOW";
  }
  if ( (unsigned __int16)a1 != 4 )
  {
    if ( (unsigned __int16)a1 == 5 )
      return "NOT_PROCESSED";
    return "UNKNOWN";
  }
  if ( _bittest(&a1, 0x1Eu) )
    result = "S_DENY_PENDING";
  else
    result = "S_DENY";
  return result;
}

//----- (000000000004D84C) ----------------------------------------------------
const char *__fastcall sub_4D84C(unsigned int a1)
{
  switch ( a1 )
  {
    case 0u:
      return "UNKNOWN";
    case 1u:
      return "ICMP";
    case 6u:
      return "TCP";
    case 0x11u:
      return "UDP";
    case 0x3Au:
      return "ICMPV6";
  }
  sub_587C8(byte_61268, 4ui64, "%d", a1);
  return byte_61268;
}

//----- (000000000004D8C4) ----------------------------------------------------
const char *__fastcall sub_4D8C4(int a1)
{
  __int64 v1; // r9
  int v3; // ecx
  int v4; // ecx
  int v5; // ecx
  int v6; // ecx

  v1 = (unsigned int)a1;
  if ( a1 <= 5 )
  {
    switch ( a1 )
    {
      case 5:
        return "HTTPS";
      case 0:
        return "UNKNOWN";
      case 1:
        return "PENDING";
      case 2:
        return "DNS";
      case 3:
        return "DHCP";
      case 4:
        return "HTTP";
    }
    goto LABEL_19;
  }
  v3 = a1 - 7;
  if ( !v3 )
    return "SMTP";
  v4 = v3 - 1;
  if ( !v4 )
    return "FTP";
  v5 = v4 - 1;
  if ( !v5 )
    return "POP3";
  v6 = v5 - 1;
  if ( !v6 )
    return "PAP";
  if ( v6 != 1 )
  {
LABEL_19:
    sub_587C8(byte_61260, 4ui64, "%d", v1);
    return byte_61260;
  }
  return "DHCPV6";
}

//----- (000000000004D99C) ----------------------------------------------------
const char *__fastcall sub_4D99C(unsigned int a1)
{
  switch ( a1 )
  {
    case 0u:
      return "UNKNOWN";
    case 0x800u:
      return "IPv4";
    case 0x806u:
      return "ARP";
    case 0x8035u:
      return "RARP";
    case 0x86DDu:
      return "IPv6";
  }
  sub_587C8(byte_61264, 4ui64, "%d", a1);
  return byte_61264;
}

//----- (000000000004DA20) ----------------------------------------------------
const char *__fastcall sub_4DA20(int a1)
{
  int v1; // ecx
  int v2; // ecx

  if ( !a1 )
    return "PASS";
  v1 = a1 - 1;
  if ( !v1 )
    return "DROP";
  v2 = v1 - 1;
  if ( !v2 )
    return "SDROP";
  if ( v2 == 1 )
    return "ALERT";
  return "UNKNOWN";
}

//----- (000000000004DA64) ----------------------------------------------------
const char *__fastcall sub_4DA64(int a1)
{
  int v1; // ecx
  int v2; // ecx

  if ( !a1 )
    return "DISABLED";
  v1 = a1 - 1;
  if ( !v1 )
    return "DISABLED_UDP";
  v2 = v1 - 1;
  if ( !v2 )
    return "DISABLED_TCP";
  if ( v2 == 1 )
    return "ENABLED";
  return "UNKNOWN";
}

//----- (000000000004DAA8) ----------------------------------------------------
const char *__fastcall sub_4DAA8(int a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // ecx
  int v4; // ecx
  int v5; // ecx
  int v7; // ecx
  int v8; // ecx
  int v9; // ecx
  int v10; // ecx
  int v11; // ecx
  int v12; // ecx
  int v13; // ecx
  int v14; // ecx
  int v15; // ecx
  int v16; // ecx
  int v17; // ecx
  int v18; // ecx
  int v19; // ecx
  int v20; // ecx
  int v21; // ecx
  int v22; // ecx
  int v23; // ecx
  int v24; // ecx
  int v25; // ecx
  int v26; // ecx
  int v27; // ecx
  int v28; // ecx
  int v29; // ecx
  int v30; // ecx
  int v31; // ecx
  int v32; // ecx
  int v33; // ecx
  int v34; // ecx
  int v35; // ecx

  if ( a1 <= 26 )
  {
    if ( a1 == 26 )
      return "MAIN_PUBLISH_FRAGMENT_COMPLETED_RELATED_RELEASE";
    if ( a1 > 13 )
    {
      if ( a1 > 20 )
      {
        v15 = a1 - 21;
        if ( !v15 )
          return "MAIN_PUBLISH_FRAGMENT_ADD";
        v16 = v15 - 1;
        if ( !v16 )
          return "MAIN_PUBLISH_FRAGMENT_MANAGED_IP_ADD";
        v17 = v16 - 1;
        if ( !v17 )
          return "MAIN_PUBLISH_FRAGMENT_PROCESS_NP_ADD";
        v18 = v17 - 1;
        if ( !v18 )
          return "MAIN_PUBLISH_FRAGMENT_DISCARD_RELEASE";
        if ( v18 == 1 )
          return "MAIN_PUBLISH_FRAGMENT_RELEASE";
      }
      else
      {
        if ( a1 == 20 )
          return "STORE_FRAGMENT_RELEASE";
        v11 = a1 - 14;
        if ( !v11 )
          return "MAIN_REPUBLISH_RELEASE";
        v12 = v11 - 1;
        if ( !v12 )
          return "MAIN_REPUBLISH_STORE_RELEASE";
        v13 = v12 - 2;
        if ( !v13 )
          return "STORE_FRAGMENT_ADD";
        v14 = v13 - 1;
        if ( !v14 )
          return "STORE_FRAGMENT_PENDING_ADD";
        if ( v14 == 1 )
          return "STORE_FRAGMENT_EXTRACT_FIRST_ADD";
      }
    }
    else
    {
      if ( a1 == 13 )
        return "MAIN_REPUBLISH_ADD";
      if ( a1 > 7 )
      {
        v7 = a1 - 8;
        if ( !v7 )
          return "MAIN_PUBLISH_RECONSTRUCTED_ALLOW_RELEASE";
        v8 = v7 - 1;
        if ( !v8 )
          return "MAIN_PUBLISH_RECONSTRUCTED_DENY_RELEASE";
        v9 = v8 - 1;
        if ( !v9 )
          return "MAIN_GET_RECONSTRUCT_FRAGMENT_ADD";
        v10 = v9 - 1;
        if ( !v10 )
          return "PACKET_PENDING";
        if ( v10 == 1 )
          return "MAIN_REPUBLISH_STORE_ADD";
      }
      else
      {
        if ( a1 == 7 )
          return "MAIN_PUBLISH_ALLOW_RELEASE";
        v1 = a1 - 1;
        if ( !v1 )
          return "MAIN_STORE_ADD";
        v2 = v1 - 1;
        if ( !v2 )
          return "MAIN_STORE_RELEASE";
        v3 = v2 - 1;
        if ( !v3 )
          return "MAIN_PUBLISH_ADD";
        v4 = v3 - 1;
        if ( !v4 )
          return "MAIN_PUBLISH_RECONSTRUCTED_ADD";
        v5 = v4 - 1;
        if ( !v5 )
          return "MAIN_PUBLISH_WITH_ERROR_RELEASE";
        if ( v5 == 1 )
          return "MAIN_PUBLISH_DENY_RELEASE";
      }
    }
    return "UNKNOWN";
  }
  if ( a1 <= 39 )
  {
    if ( a1 == 39 )
      return "STRM_CONTEXT_RELEASE";
    if ( a1 > 33 )
    {
      v24 = a1 - 34;
      if ( !v24 )
        return "MAIN_PUBLISH_REASSEMBLED_ADD";
      v25 = v24 - 1;
      if ( !v25 )
        return "MAIN_PUBLISH_REASSEMBLED_RELEASE";
      v26 = v25 - 1;
      if ( !v26 )
        return "CLEAN_REASSEMBLED_ADD";
      v27 = v26 - 1;
      if ( !v27 )
        return "CLEAN_REASSEMBLED_RELEASE";
      if ( v27 == 1 )
        return "STRM_CONTEXT_ADD";
    }
    else
    {
      if ( a1 == 33 )
        return "MAIN_STORE_REASSEMBLED_RELEASE";
      v19 = a1 - 27;
      if ( !v19 )
        return "CLEAN_FRAGMENT_ADD";
      v20 = v19 - 1;
      if ( !v20 )
        return "CLEAN_FRAGMENT_RELEASE";
      v21 = v20 - 1;
      if ( !v21 )
        return "FRAG_PACKET_PENDING";
      v22 = v21 - 1;
      if ( !v22 )
        return "FRAG_PACKET_PASS";
      v23 = v22 - 1;
      if ( !v23 )
        return "PACKET_DISCARD";
      if ( v23 == 1 )
        return "MAIN_STORE_REASSEMBLED_ADD";
    }
    return "UNKNOWN";
  }
  if ( a1 <= 45 )
  {
    if ( a1 == 45 )
      return "PROTECTOR_PUBLISH_RELEASE";
    v28 = a1 - 40;
    if ( !v28 )
      return "STRM_CONTEXT_PUBLISH_RELEASE";
    v29 = v28 - 1;
    if ( !v29 )
      return "STRM_PACKET_PENDING";
    v30 = v29 - 1;
    if ( !v30 )
      return "PROT_COMPLETE";
    v31 = v30 - 1;
    if ( !v31 )
      return "PROTECTOR_ADD";
    if ( v31 == 1 )
      return "PROTECTOR_RELEASE";
    return "UNKNOWN";
  }
  v32 = a1 - 46;
  if ( !v32 )
    return "PROTECTOR_PACKET_PENDING";
  v33 = v32 - 1;
  if ( !v33 )
    return "PENDING_SIMULATOR_ADD";
  v34 = v33 - 1;
  if ( !v34 )
    return "PENDING_SIMULATOR_RELEASE";
  v35 = v34 - 1;
  if ( !v35 )
    return "UNLOAD";
  if ( v35 != 1 )
    return "UNKNOWN";
  return "AGE";
}

//----- (000000000004DD74) ----------------------------------------------------
const char *__fastcall sub_4DD74(int a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // ecx
  int v4; // ecx
  int v5; // ecx
  int v6; // ecx

  if ( !a1 )
    return "UNKNOWN";
  v1 = a1 - 1;
  if ( !v1 )
    return "BUFFER";
  v2 = v1 - 1;
  if ( !v2 )
    return "STRING";
  v3 = v2 - 1;
  if ( !v3 )
    return "STRING_INSENSITIVE";
  v4 = v3 - 1;
  if ( !v4 )
    return "BYTE_TEST";
  v5 = v4 - 1;
  if ( !v5 )
    return "BYTE_JUMP";
  v6 = v5 - 1;
  if ( !v6 )
    return "BYTE_EXTRACT";
  if ( v6 == 1 )
    return "BYTE_MATH";
  return "UNKNOWN_STRING";
}

//----- (000000000004DDE8) ----------------------------------------------------
const char *__fastcall sub_4DDE8(int a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // ecx

  if ( !a1 )
    return "NONE";
  v1 = a1 - 1;
  if ( !v1 )
    return "BEFORE_NBL_ENQUEUE";
  v2 = v1 - 1;
  if ( !v2 )
    return "AFTER_NBL_UNENQUEUE";
  v3 = v2 - 1;
  if ( !v3 )
    return "BEFORE_NWP_PROCESS";
  if ( v3 == 1 )
    return "BEFORE_NWP_NANO_SEND";
  return "UNKNOWN";
}

//----- (000000000004DE38) ----------------------------------------------------
__int64 __fastcall sub_4DE38(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, a3, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004DE8C) ----------------------------------------------------
__int64 __fastcall sub_4DE8C(__int64 a1, __int64 a2, int a3, int a4, _QWORD *a5)
{
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  _DWORD *v11; // rax
  _DWORD *v12; // rsi
  __int64 v13; // rax
  unsigned int v14; // er12
  PDEVICE_OBJECT v15; // rcx
  char FileInformation[8]; // [rsp+60h] [rbp-2C8h] BYREF
  union _LARGE_INTEGER ByteOffset; // [rsp+68h] [rbp-2C0h] BYREF
  int Buffer; // [rsp+70h] [rbp-2B8h] BYREF
  __int16 v19; // [rsp+74h] [rbp-2B4h]
  int v20; // [rsp+76h] [rbp-2B2h]
  __int16 v21; // [rsp+7Ah] [rbp-2AEh]
  int v22; // [rsp+7Ch] [rbp-2ACh]
  int v23; // [rsp+80h] [rbp-2A8h]
  int v24; // [rsp+84h] [rbp-2A4h]
  _UNICODE_STRING DestinationString; // [rsp+88h] [rbp-2A0h] BYREF
  __int64 v26; // [rsp+98h] [rbp-290h]
  struct _IO_STATUS_BLOCK IoStatusBlock; // [rsp+A0h] [rbp-288h] BYREF
  struct _OBJECT_ATTRIBUTES ObjectAttributes; // [rsp+B0h] [rbp-278h] BYREF
  WCHAR SourceString[264]; // [rsp+E0h] [rbp-248h] BYREF

  DestinationString.Length = 0;
  DestinationString.MaximumLength = 0;
  DestinationString.Buffer = 0i64;
  ByteOffset.QuadPart = 0i64;
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xAu, (__int64)&unk_5CC78);
    v8 = off_60148;
  }
  if ( !a5 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 0x40) == 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 4i64;
    }
    v9 = 11;
LABEL_10:
    sub_11008(*(_QWORD *)&v8->AlignmentRequirement, v9, (__int64)&unk_5CC78);
    return 4i64;
  }
  if ( *a5 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 0x40) == 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 4i64;
    }
    v9 = 12;
    goto LABEL_10;
  }
  v11 = sub_3F66C(2, 0x20u, 0x74616350u);
  v12 = v11;
  if ( v11 )
  {
    memset(v11, 0, 0x20ui64);
    v26 = MEMORY[0xFFFFF78000000014];
    sub_5A75C(
      (char *)SourceString,
      0x103ui64,
      L"%ws%I64u.%ws",
      L"\\SystemRoot\\system32\\drivers\\",
      MEMORY[0xFFFFF78000000014],
      a2);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_1127C(*(_QWORD *)&off_60148->AlignmentRequirement, 0xEu, (__int64)&unk_5CC78, SourceString);
    }
    RtlInitUnicodeString(&DestinationString, SourceString);
    ObjectAttributes.RootDirectory = 0i64;
    ObjectAttributes.SecurityDescriptor = 0i64;
    ObjectAttributes.SecurityQualityOfService = 0i64;
    ObjectAttributes.Length = 48;
    ObjectAttributes.Attributes = 576;
    ObjectAttributes.ObjectName = &DestinationString;
    if ( ZwCreateFile((PHANDLE)v12, 0x100004u, &ObjectAttributes, &IoStatusBlock, 0i64, 0x80u, 0, 3u, 0x20u, 0i64, 0) )
    {
      v15 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x12u, (__int64)&unk_5CC78);
        v15 = off_60148;
      }
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xFu, (__int64)&unk_5CC78);
      }
      ByteOffset.QuadPart = -1i64;
      v21 = 0;
      v22 = 0;
      Buffer = -1582119980;
      v19 = 2;
      v20 = 4;
      v23 = 0xFFFF;
      v24 = 1;
      if ( !ZwWriteFile(*(HANDLE *)v12, 0i64, 0i64, 0i64, &IoStatusBlock, &Buffer, 0x18u, &ByteOffset, 0i64) )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x10u, (__int64)&unk_5CC78);
        }
        v13 = MEMORY[0xFFFFF78000000014];
        v12[4] += 24;
        v12[6] = a4;
        *((_QWORD *)v12 + 1) = v13;
        v12[5] = a3;
        v14 = 0;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x14u, (__int64)&unk_5CC78, v12);
        }
        *a5 = v12;
LABEL_51:
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x15u, (__int64)&unk_5CC78);
        }
        return v14;
      }
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x11u, (__int64)&unk_5CC78);
      }
      FileInformation[0] = 1;
      ZwSetInformationFile(*(HANDLE *)v12, &IoStatusBlock, FileInformation, 1u, FileDispositionInformation);
      ZwClose(*(HANDLE *)v12);
      v15 = off_60148;
    }
    v14 = 1;
    if ( v15 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v15->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
      && BYTE1(v15->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&v15->AlignmentRequirement, 0x13u, (__int64)&unk_5CC78, 1);
    }
    sub_3F6F0(v12, 0x74616350u);
    *a5 = 0i64;
    goto LABEL_51;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xDu, (__int64)&unk_5CC78);
  }
  return 3i64;
}
// 5AD70: using guessed type wchar_t aSystemrootSyst[30];
// 5D888: using guessed type wchar_t aWsI64uWs[13];

//----- (000000000004E420) ----------------------------------------------------
__int64 __fastcall sub_4E420(PVOID *a1, const void *a2, unsigned int a3, const void *a4, int a5, PLARGE_INTEGER Time)
{
  const void *v7; // rax
  size_t v8; // r13
  PDEVICE_OBJECT v9; // rcx
  _DWORD *v10; // rdi
  size_t v11; // r12
  unsigned int v12; // ebx
  char v13; // r14
  PDEVICE_OBJECT v14; // rcx
  unsigned __int16 v15; // dx
  __int64 result; // rax
  int v17; // er15
  unsigned int v18; // ebp
  char *v19; // rax
  char *Buffer; // rsi
  PDEVICE_OBJECT v21; // rcx
  LONGLONG v22; // rcx
  int v23; // eax
  KIRQL v24; // dl
  ULONG ElapsedSeconds; // [rsp+50h] [rbp-68h] BYREF
  union _LARGE_INTEGER ByteOffset; // [rsp+58h] [rbp-60h] BYREF
  int v27[4]; // [rsp+60h] [rbp-58h] BYREF
  struct _IO_STATUS_BLOCK IoStatusBlock; // [rsp+70h] [rbp-48h] BYREF
  KIRQL v29; // [rsp+C0h] [rbp+8h] BYREF
  const void *v30; // [rsp+C8h] [rbp+10h]
  const void *v31; // [rsp+D8h] [rbp+20h]

  v31 = a4;
  v30 = a2;
  v7 = a4;
  v8 = a3;
  ByteOffset.QuadPart = 0i64;
  ElapsedSeconds = 0;
  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x16u, (__int64)&unk_5CC78);
    v9 = off_60148;
    v7 = v31;
  }
  if ( a1 && (v10 = *a1) != 0i64 )
  {
    v11 = (unsigned int)a5;
    v12 = 1;
    if ( !v7 || (v13 = 1, !a5) )
      v13 = 0;
    sub_401B8(&qword_64DA0, &v29);
    if ( v10[4] > v10[5] )
    {
      v14 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) == 0
        || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 4u )
      {
        goto LABEL_16;
      }
      v15 = 25;
LABEL_15:
      sub_11008(*(_QWORD *)&v14->AlignmentRequirement, v15, (__int64)&unk_5CC78);
LABEL_16:
      sub_40230(&qword_64DA0, v29);
      sub_4EC48(a1);
      return 0i64;
    }
    if ( (int)Time->QuadPart / 10000000 - (unsigned int)(*((_QWORD *)v10 + 1) / 10000000i64) > v10[6] )
    {
      v14 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) == 0
        || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 4u )
      {
        goto LABEL_16;
      }
      v15 = 26;
      goto LABEL_15;
    }
    sub_40230(&qword_64DA0, v29);
    v17 = v8;
    if ( v13 )
      v17 = v8 + v11 + 20;
    v18 = v17 + 16;
    v19 = (char *)sub_3F66C(2, v17 + 16, 0x74616350u);
    Buffer = v19;
    if ( v19 )
    {
      memset(v19, 0, v18);
      RtlTimeToSecondsSince1970(Time, &ElapsedSeconds);
      v22 = Time->QuadPart;
      v27[0] = ElapsedSeconds;
      v27[2] = v17;
      v27[3] = v17;
      v27[1] = v22 % 10000000 / 10;
      sub_588AC(Buffer, 0x10ui64, v27, 0x10ui64);
      sub_588AC(Buffer + 16, v8, v30, v8);
      if ( v13 )
      {
        sub_588AC(&Buffer[v8 + 16], 0xCui64, "<-NNSINFO->", 0xCui64);
        sub_588AC(&Buffer[v8 + 28], v11, v31, v11);
      }
      ByteOffset.QuadPart = -1i64;
      v23 = ZwWriteFile(*(HANDLE *)v10, 0i64, 0i64, 0i64, &IoStatusBlock, Buffer, v17 + 16, &ByteOffset, 0i64);
      if ( v23 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Du, (__int64)&unk_5CC78, v23);
        }
      }
      else
      {
        sub_401B8(&qword_64DA0, &v29);
        v24 = v29;
        v10[4] += v18;
        sub_40230(&qword_64DA0, v24);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_4DE38(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Cu, (__int64)&unk_5CC78, v18);
        }
        v12 = 0;
      }
      sub_3F6F0(Buffer, 0x74616350u);
      v21 = off_60148;
    }
    else
    {
      v21 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Bu, (__int64)&unk_5CC78);
        v21 = off_60148;
      }
      v12 = 3;
    }
    if ( v21 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v21->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
      && BYTE1(v21->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_112FC(*(_QWORD *)&v21->AlignmentRequirement, 0x1Eu, (__int64)&unk_5CC78, v12);
    }
    result = v12;
  }
  else
  {
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v9->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v9->AlignmentRequirement, 0x17u, (__int64)&unk_5CC78);
    }
    result = 1i64;
  }
  return result;
}

//----- (000000000004E948) ----------------------------------------------------
void __fastcall sub_4E948(__int64 a1)
{
  void *v2; // rcx
  void *v3; // rcx

  if ( a1 )
  {
    v2 = *(void **)(a1 + 8);
    if ( v2 )
      sub_3F6F0(v2, 0x624E734Eu);
    v3 = *(void **)(a1 + 24);
    if ( v3 )
      sub_3F6F0(v3, 0x6175624Eu);
  }
}

//----- (000000000004E9A0) ----------------------------------------------------
void __fastcall sub_4E9A0(__int64 a1)
{
  void *v2; // rcx

  if ( a1 )
  {
    sub_4E420(
      *(PVOID **)a1,
      *(const void **)(a1 + 8),
      *(_DWORD *)(a1 + 16),
      *(const void **)(a1 + 24),
      *(_DWORD *)(a1 + 32),
      (PLARGE_INTEGER)(a1 + 40));
    sub_3F6F0(*(PVOID *)(a1 + 8), 0x624E734Eu);
    v2 = *(void **)(a1 + 24);
    if ( v2 )
      sub_3F6F0(v2, 0x6175624Eu);
  }
}

//----- (000000000004EA14) ----------------------------------------------------
__int64 __fastcall sub_4EA14(__int64 a1, __int64 a2, const void *a3, unsigned int a4, void *Src, unsigned int MaxCount, _QWORD *a7)
{
  size_t v7; // rdi
  _QWORD *v11; // rbx
  PVOID v12; // rax
  PVOID v13; // rax
  void *v14; // rcx
  void *v15; // rcx

  v7 = a4;
  if ( !a4 )
    return 4i64;
  v11 = sub_40964(a1, 48, (__int64)sub_4E9A0, (__int64)sub_4E948);
  if ( !v11 )
    return 1i64;
  v12 = sub_3F66C(2, v7, 0x624E734Eu);
  v11[1] = v12;
  if ( !v12 )
  {
    v14 = (void *)v11[3];
    if ( v14 )
      sub_3F6F0(v14, 0x6175624Eu);
    v15 = (void *)v11[1];
    if ( v15 )
      sub_3F6F0(v15, 0x624E734Eu);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->Queue.Wcb.DeviceRoutine) < 0
      && BYTE1(off_60148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3F5EC((__int64)off_60148->Queue.ListEntry.Blink, 0x2Fu);
    }
    sub_42208((__int64)v11, 0);
    return 1i64;
  }
  *((_DWORD *)v11 + 4) = v7;
  memmove(v12, a3, v7);
  if ( Src && MaxCount )
  {
    *((_DWORD *)v11 + 8) = MaxCount;
    v13 = sub_3F66C(2, MaxCount, 0x6175624Eu);
    v11[3] = v13;
    if ( v13 )
      memmove(v13, Src, MaxCount);
  }
  else
  {
    *((_DWORD *)v11 + 8) = 0;
    v11[3] = 0i64;
  }
  *v11 = a2;
  v11[5] = *a7;
  sub_40AF4((__int64)v11);
  return 0i64;
}

//----- (000000000004EBEC) ----------------------------------------------------
__int64 __fastcall sub_4EBEC(PVOID *a1, const void *a2, unsigned int a3, void *a4, int a5, PLARGE_INTEGER Time, char a7)
{
  __int64 result; // rax

  if ( a7 )
    result = sub_4EA14((__int64)qword_61278, (__int64)a1, a2, a3, a4, a5, Time);
  else
    result = sub_4E420(a1, a2, a3, a4, a5, Time);
  return result;
}

//----- (000000000004EC48) ----------------------------------------------------
__int64 __fastcall sub_4EC48(PVOID *a1)
{
  unsigned int v2; // ebx
  PDEVICE_OBJECT v3; // rcx
  HANDLE *v4; // rsi

  v2 = 0;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Fu, (__int64)&unk_5CC78);
    v3 = off_60148;
  }
  if ( a1 && (v4 = (HANDLE *)*a1) != 0i64 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
      && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&v3->AlignmentRequirement, 0x21u, (__int64)&unk_5CC78);
    }
    ZwClose(*v4);
    sub_3F6F0(*a1, 0x74616350u);
    *a1 = 0i64;
    v3 = off_60148;
  }
  else
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
      && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&v3->AlignmentRequirement, 0x20u, (__int64)&unk_5CC78);
      v3 = off_60148;
    }
    v2 = 1;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
    && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v3->AlignmentRequirement, 0x22u, (__int64)&unk_5CC78, v2);
  }
  return v2;
}

//----- (000000000004ED98) ----------------------------------------------------
__int64 __fastcall sub_4ED98(__int64 a1, const void *a2, size_t a3)
{
  PDEVICE_OBJECT v6; // rcx
  _DWORD *v7; // rdx
  int v8; // eax
  size_t v9; // rdx

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x23u, (__int64)&unk_5CC78);
    v6 = off_60148;
  }
  v7 = *(_DWORD **)(a1 + 132);
  if ( !v7 || (v8 = *(_DWORD *)(a1 + 140)) == 0 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148 )
      return 0i64;
    if ( (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x40) == 0 || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 4u )
    {
LABEL_19:
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
        && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x26u, (__int64)&unk_5CC78);
      }
      return 0i64;
    }
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x25u, (__int64)&unk_5CC78);
LABEL_18:
    v6 = off_60148;
    goto LABEL_19;
  }
  v9 = (unsigned int)(v8 - *v7);
  if ( v9 > a3 )
  {
    sub_588AC((void *)(**(unsigned int **)(a1 + 132) + *(_QWORD *)(a1 + 132) + 4i64), v9, a2, a3);
    **(_DWORD **)(a1 + 132) += a3;
    goto LABEL_18;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x24u, (__int64)&unk_5CC78);
  }
  return 10i64;
}

//----- (000000000004EEF8) ----------------------------------------------------
__int64 __fastcall sub_4EEF8(char *a1, _BYTE *a2, char a3, unsigned int a4, int *a5)
{
  unsigned int v5; // er10
  _BYTE *v6; // r11
  _BYTE *v8; // rcx
  char *v9; // rdx
  __int64 result; // rax

  v5 = 0;
  v6 = a2;
  if ( a1 && a2 && a4 )
  {
    if ( a3 )
    {
      *a5 = 0;
      v8 = a2;
      v9 = &a1[a4 - 1];
      while ( *v8 == *v9 )
      {
        ++v5;
        --v9;
        ++v8;
        if ( v5 >= a4 )
          goto LABEL_12;
      }
      *a5 = a1[a4 - v5 - 1] - (char)v6[v5];
    }
    else
    {
      *a5 = memcmp(a1, a2, a4);
    }
LABEL_12:
    result = 0i64;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x15u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_49218(*(_QWORD *)&off_60148->AlignmentRequirement, 0x11u, (__int64)&unk_5CC68, a1, a2, a4, a5);
    }
    result = 4i64;
  }
  return result;
}
// 4EF3A: conditional instruction was optimized away because of 'er9.4!=0'

//----- (000000000004EFDC) ----------------------------------------------------
char sub_4EFDC()
{
  char v0; // bl
  int v1; // er9
  struct _OSVERSIONINFOW VersionInformation; // [rsp+30h] [rbp-138h] BYREF

  v0 = 0;
  memset(&VersionInformation, 0, sizeof(VersionInformation));
  VersionInformation.dwOSVersionInfoSize = 276;
  v1 = RtlGetVersion(&VersionInformation);
  if ( v1 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x15u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x13u, (__int64)&unk_5CC68, v1);
    }
  }
  else if ( VersionInformation.dwMajorVersion > 6
         || VersionInformation.dwMajorVersion == 6 && VersionInformation.dwMinorVersion >= 2 )
  {
    v0 = 1;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x15u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11430(
        *(_QWORD *)&off_60148->AlignmentRequirement,
        0x12u,
        (__int64)&unk_5CC68,
        VersionInformation.dwMajorVersion);
    }
  }
  return v0;
}

//----- (000000000004F0EC) ----------------------------------------------------
char sub_4F0EC()
{
  ULONGLONG v0; // rax
  int v1; // eax
  char v2; // bl
  struct _OSVERSIONINFOEXW VersionInfo; // [rsp+20h] [rbp-138h] BYREF

  memset(&VersionInfo.dwMajorVersion, 0, 0x118ui64);
  VersionInfo.dwOSVersionInfoSize = 284;
  VersionInfo.wProductType = 2;
  v0 = VerSetConditionMask(0i64, 0x80u, 3u);
  v1 = RtlVerifyVersionInfo(&VersionInfo, 0x80u, v0);
  v2 = 0;
  if ( v1 < 0 )
  {
    if ( v1 == -1073741735 )
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x15u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x15u, (__int64)&unk_5CC68);
      }
    }
    else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
           && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x15u)
           && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x16u, (__int64)&unk_5CC68, v1);
    }
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 0x15u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x14u, (__int64)&unk_5CC68);
    }
    v2 = 1;
  }
  return v2;
}

//----- (000000000004F240) ----------------------------------------------------
__int64 __fastcall sub_4F240(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6, int a7)
{
  int v8; // [rsp+98h] [rbp+20h] BYREF

  v8 = a4;
  a7 = 0;
  return qword_61238(a1, 43i64, &unk_5CC58, 125i64, &v8);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004F2B0) ----------------------------------------------------
__int64 __fastcall sub_4F2B0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CC58, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004F31C) ----------------------------------------------------
__int64 __fastcall sub_4F31C(__int64 a1)
{
  int v2; // [rsp+98h] [rbp+20h] BYREF

  v2 = 0;
  return qword_61238(a1, 43i64, &unk_5CC58, 58i64, &v2);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004F390) ----------------------------------------------------
__int64 __fastcall sub_4F390(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CC58, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004F3EC) ----------------------------------------------------
__int64 __fastcall sub_4F3EC(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CC58, 115i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004F45C) ----------------------------------------------------
__int64 __fastcall sub_4F45C(__int64 a1, __int64 a2, _QWORD *a3)
{
  bool v5; // r12
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  char *v8; // rbx
  unsigned int v9; // edi
  int v10; // er9
  unsigned int v11; // eax
  _WORD *v12; // rdx
  char *v13; // rax
  PVOID v14; // rax
  unsigned int v15; // edx
  __int64 v16; // r8
  _QWORD *v17; // rax
  char *v18; // rcx
  unsigned int *v19; // rbx
  unsigned int v20; // eax
  void *v21; // rcx
  void *v22; // rcx

  v5 = 0;
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xAu, (__int64)&unk_5CC58);
    v6 = off_60148;
  }
  if ( !a1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_12;
    }
    v7 = 11;
    goto LABEL_10;
  }
  v10 = *(_DWORD *)a1;
  if ( (*(_DWORD *)a1 & 0xFF000000) != 0x2000000 || (v10 & 0xFFFF00) == 0 || (_BYTE)v10 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&v6->AlignmentRequirement, 0xCu, (__int64)&unk_5CC58, v10);
      v6 = off_60148;
    }
    v9 = 4;
    goto LABEL_59;
  }
  v11 = 0;
  v12 = (_WORD *)(a1 + 4);
  do
  {
    if ( !*v12 )
      break;
    ++v11;
    ++v12;
  }
  while ( v11 < 0x40 );
  if ( v11 < 0x40 )
  {
    if ( !a3 || !*a3 )
    {
      if ( v6 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_12;
      }
      sub_2F80C(*(_QWORD *)&v6->AlignmentRequirement, 0xEu, (__int64)&unk_5CC58, a3);
      goto LABEL_11;
    }
    v13 = (char *)sub_3F66C(2, 0x3558u, 0x66634E4Eu);
    v8 = v13;
    qword_627B8 = v13;
    if ( !v13 )
    {
      v6 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xFu, (__int64)&unk_5CC58, 13304);
        v6 = off_60148;
        v8 = (char *)qword_627B8;
      }
      v9 = 3;
      goto LABEL_66;
    }
    memset(v13, 0, 0x3558ui64);
    if ( v8 == (char *)-128i64 )
    {
LABEL_35:
      v6 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x10u, (__int64)&unk_5CC58);
        v6 = off_60148;
        v8 = (char *)qword_627B8;
      }
      v9 = 9;
      goto LABEL_66;
    }
    v5 = sub_402A4((struct _KEVENT **)v8 + 23, 1);
    sub_404B8((__int64)(v8 + 128));
    *((_DWORD *)v8 + 48) = 0;
    *((_DWORD *)v8 + 49) = 0;
    v8[200] = 0;
    if ( !v5 )
    {
      v8 = (char *)qword_627B8;
      goto LABEL_35;
    }
    v14 = sub_3F66C(1, 4 * (unsigned int)*(unsigned __int8 *)(a1 + 136), 0x66634E4Eu);
    v8 = (char *)qword_627B8;
    *((_QWORD *)qword_627B8 + 26) = v14;
    if ( !v14 )
    {
      v6 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) )
      {
        sub_112FC(
          *(_QWORD *)&off_60148->AlignmentRequirement,
          0x11u,
          (__int64)&unk_5CC58,
          4 * *(unsigned __int8 *)(a1 + 136));
        v6 = off_60148;
        v8 = (char *)qword_627B8;
      }
      v9 = 3;
LABEL_61:
      if ( v5 && v8 != (char *)-128i64 )
      {
        v21 = (void *)*((_QWORD *)v8 + 23);
        *((_DWORD *)v8 + 49) = 0;
        if ( v21 )
        {
          sub_4031C(v21);
          v8 = (char *)qword_627B8;
        }
        v6 = off_60148;
      }
      goto LABEL_66;
    }
    v15 = 0;
    if ( *(_BYTE *)(a1 + 136) )
    {
      v16 = 0i64;
      do
      {
        *(_DWORD *)(v16 + *((_QWORD *)v8 + 26)) = *(_DWORD *)a1 | ++v15;
        v16 += 4i64;
      }
      while ( v15 < *(unsigned __int8 *)(a1 + 136) );
    }
    *(_DWORD *)v8 = 2;
    *((_DWORD *)v8 + 1) = 13304;
    v8[8] = 0;
    *((_DWORD *)v8 + 4) = *(_DWORD *)a1;
    v8[20] = *(_BYTE *)(a1 + 136);
    *((_QWORD *)v8 + 3) = *((_QWORD *)v8 + 26);
    *((_QWORD *)v8 + 4) = sub_5124C;
    sub_3FD2C((PERESOURCE)(v8 + 216));
    v17 = (char *)qword_627B8 + 56;
    v18 = (char *)qword_627B8 + 72;
    *((_QWORD *)qword_627B8 + 8) = (char *)qword_627B8 + 56;
    *v17 = v17;
    sub_404B8((__int64)v18);
    v19 = (unsigned int *)qword_627B8;
    memmove((char *)qword_627B8 + 320, a3, 0x20ui64);
    v20 = sub_492E8((__int16 *)(a1 + 4), *(_DWORD *)(a1 + 132), v19 + 4);
    v6 = off_60148;
    v9 = v20;
LABEL_59:
    if ( !v9 )
      goto LABEL_70;
    v8 = (char *)qword_627B8;
    goto LABEL_61;
  }
  if ( v6 == (PDEVICE_OBJECT)&off_60148
    || !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
  {
    goto LABEL_12;
  }
  v7 = 13;
LABEL_10:
  sub_11008(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_5CC58);
LABEL_11:
  v6 = off_60148;
LABEL_12:
  v8 = (char *)qword_627B8;
  v9 = 4;
LABEL_66:
  if ( v8 )
  {
    v22 = (void *)*((_QWORD *)v8 + 26);
    if ( v22 )
    {
      sub_3F6F0(v22, 0x66634E4Eu);
      v8 = (char *)qword_627B8;
    }
    sub_3F6F0(v8, 0x66634E4Eu);
    v6 = off_60148;
    qword_627B8 = 0i64;
  }
LABEL_70:
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v6->AlignmentRequirement, 0x12u, (__int64)&unk_5CC58, v9);
  }
  return v9;
}

//----- (000000000004F9A0) ----------------------------------------------------
__int64 sub_4F9A0()
{
  char v0; // di
  PDEVICE_OBJECT v1; // rcx
  PVOID v2; // rdx
  unsigned int v3; // ebx
  void *v4; // rcx
  int v5; // eax
  _QWORD *v6; // rax
  unsigned int v7; // eax
  PRKEVENT *v8; // rbx
  int v9; // eax

  v0 = 0;
  v1 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x13u, (__int64)&unk_5CC58);
    v1 = off_60148;
  }
  v2 = qword_627B8;
  if ( !qword_627B8 )
  {
    if ( v1 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v1->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v1->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v1->AlignmentRequirement, 0x14u, (__int64)&unk_5CC58);
      v1 = off_60148;
    }
    v3 = 16;
    goto LABEL_62;
  }
  if ( *((_QWORD *)qword_627B8 + 5) )
  {
    if ( v1 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v1->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v1->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v1->AlignmentRequirement, 0x15u, (__int64)&unk_5CC58);
      v1 = off_60148;
    }
    v3 = 6;
    goto LABEL_62;
  }
  v4 = (void *)*((_QWORD *)qword_627B8 + 26);
  if ( v4 )
  {
    sub_3F6F0(v4, 0x66634E4Eu);
    v2 = qword_627B8;
    *((_QWORD *)qword_627B8 + 26) = 0i64;
  }
  v5 = sub_49F00(6u, (__int64)v2 + 40);
  v3 = v5;
  if ( v5 )
  {
    v1 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x16u, (__int64)&unk_5CC58, v5);
      v1 = off_60148;
    }
LABEL_54:
    if ( !v3 || !v0 )
      goto LABEL_62;
    sub_582AC((PFAST_MUTEX)((char *)qword_627B8 + 128));
LABEL_26:
    v1 = off_60148;
    goto LABEL_62;
  }
  v6 = (_QWORD *)*((_QWORD *)qword_627B8 + 5);
  if ( !v6 || !*v6 || !v6[1] || !v6[2] || !v6[3] || !v6[4] || !v6[5] || !v6[6] || !v6[7] || !v6[8] || !v6[9] || !v6[10] )
  {
    v3 = 2;
    goto LABEL_26;
  }
  v7 = ((__int64 (__fastcall *)(_QWORD, char *))*v6)(*((unsigned int *)qword_627B8 + 4), (char *)qword_627B8 + 48);
  if ( v7 < 0x700 )
  {
    v8 = (PRKEVENT *)((char *)qword_627B8 + 128);
    if ( qword_627B8 != (PVOID)-128i64
      && !*((_DWORD *)qword_627B8 + 48)
      && !*((_BYTE *)qword_627B8 + 200)
      && !*((_DWORD *)qword_627B8 + 49) )
    {
      sub_40598((PFAST_MUTEX)((char *)qword_627B8 + 128));
      sub_40384(v8[7]);
      v0 = 1;
      *((_BYTE *)v8 + 72) = 1;
      sub_40664((PFAST_MUTEX)v8);
      v9 = sub_51804();
      v3 = v9;
      if ( !v9 )
        goto LABEL_26;
      v1 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x19u, (__int64)&unk_5CC58, v9);
        v1 = off_60148;
      }
      v3 = 0;
      goto LABEL_54;
    }
    v1 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x18u, (__int64)&unk_5CC58);
      v1 = off_60148;
    }
    v3 = 9;
  }
  else
  {
    v1 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x17u, (__int64)&unk_5CC58, v7);
      v1 = off_60148;
    }
    v3 = 8;
  }
LABEL_62:
  if ( v1 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v1->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v1->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v1->AlignmentRequirement, 0x1Au, (__int64)&unk_5CC58, v3);
  }
  return v3;
}

//----- (000000000004FD40) ----------------------------------------------------
__int64 (**sub_4FD40())(void)
{
  PDEVICE_OBJECT v0; // rcx
  __int64 (**result)(void); // rax
  unsigned __int16 v2; // dx

  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Bu, (__int64)&unk_5CC58);
    v0 = off_60148;
  }
  result = (__int64 (**)(void))qword_627B8;
  if ( qword_627B8 )
  {
    sub_582AC((PFAST_MUTEX)((char *)qword_627B8 + 128));
    result = (__int64 (**)(void))*((_QWORD *)qword_627B8 + 5);
    if ( result && *((_QWORD *)qword_627B8 + 6) )
    {
      result = (__int64 (**)(void))result[1]();
      *((_QWORD *)qword_627B8 + 6) = 0i64;
    }
    v0 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v2 = 30;
      return (__int64 (**)(void))sub_11008(*(_QWORD *)&v0->AlignmentRequirement, v2, (__int64)&unk_5CC58);
    }
  }
  else if ( v0 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&v0->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      result = (__int64 (**)(void))sub_11008(
                                     *(_QWORD *)&v0->AlignmentRequirement,
                                     (unsigned __int16)qword_627B8 + 28,
                                     (__int64)&unk_5CC58);
      v0 = off_60148;
    }
    if ( v0 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v0->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v2 = 29;
      return (__int64 (**)(void))sub_11008(*(_QWORD *)&v0->AlignmentRequirement, v2, (__int64)&unk_5CC58);
    }
  }
  return result;
}

//----- (000000000004FE6C) ----------------------------------------------------
void sub_4FE6C()
{
  PDEVICE_OBJECT v0; // rcx
  unsigned __int16 v1; // dx
  char *v2; // rcx
  PVOID *v3; // rax
  _QWORD *v4; // rcx
  _QWORD *v5; // rax
  _QWORD **v6; // rdx

  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Fu, (__int64)&unk_5CC58);
    v0 = off_60148;
  }
  if ( qword_627B8 )
  {
    sub_4A050();
    v2 = (char *)qword_627B8;
    v3 = (PVOID *)((char *)qword_627B8 + 128);
    if ( qword_627B8 != (PVOID)-128i64 )
    {
      *((_DWORD *)qword_627B8 + 49) = 0;
      if ( v3[7] )
      {
        sub_4031C(v3[7]);
        v2 = (char *)qword_627B8;
      }
    }
    if ( !*((_QWORD *)v2 + 26) )
      goto LABEL_21;
    v4 = (_QWORD *)*((_QWORD *)v2 + 26);
    while ( 1 )
    {
      sub_3F6F0(v4, 0x66634E4Eu);
      v2 = (char *)qword_627B8;
LABEL_21:
      v6 = (_QWORD **)(v2 + 56);
      if ( *v6 == v6 )
        break;
      v5 = (_QWORD *)**v6;
      v4 = *v6 - 5;
      *v6 = v5;
      v5[1] = v6;
    }
    sub_3FE00((PERESOURCE)(v2 + 216));
    sub_3F6F0(qword_627B8, 0x66634E4Eu);
    qword_627B8 = 0i64;
    v0 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v1 = 34;
      goto LABEL_26;
    }
  }
  else if ( v0 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&v0->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v0->AlignmentRequirement, 0x20u, (__int64)&unk_5CC58);
      v0 = off_60148;
    }
    if ( v0 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v0->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v1 = 33;
LABEL_26:
      sub_11008(*(_QWORD *)&v0->AlignmentRequirement, v1, (__int64)&unk_5CC58);
      return;
    }
  }
}

//----- (0000000000050028) ----------------------------------------------------
__int64 __fastcall sub_50028(__int64 a1, void *a2)
{
  void *v2; // rsi
  unsigned int v3; // edi
  PDEVICE_OBJECT v4; // rcx
  char *v5; // rbx
  int v8; // [rsp+28h] [rbp-30h]
  unsigned int v9; // [rsp+30h] [rbp-28h] BYREF
  char v10[36]; // [rsp+34h] [rbp-24h] BYREF
  size_t MaxCount; // [rsp+78h] [rbp+20h] BYREF

  v2 = a2;
  v3 = 0;
  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v8 = 260;
    sub_491C0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x25u, (__int64)&unk_5CC58, 33595402);
    v4 = off_60148;
  }
  if ( qword_627B8 )
  {
    if ( *((_BYTE *)qword_627B8 + 20) > 9u )
    {
      if ( v2 )
      {
        if ( (*((unsigned __int8 (__fastcall **)(__int64, unsigned int *, size_t *, char *, void *, int))qword_627B8 + 40))(
               33595402i64,
               &v9,
               &MaxCount,
               v10,
               a2,
               v8) )
        {
          if ( (unsigned int)MaxCount <= 0x104 )
          {
            KeEnterCriticalRegion();
            sub_3FFAC((PERESOURCE)((char *)qword_627B8 + 216));
            v5 = (char *)qword_627B8;
            memmove(v2, (char *)qword_627B8 + v9 + 352, (unsigned int)MaxCount);
            sub_40084((PERESOURCE)(v5 + 216));
            KeLeaveCriticalRegion();
            v4 = off_60148;
            goto LABEL_34;
          }
          v4 = off_60148;
          if ( off_60148 == (PDEVICE_OBJECT)&off_60148
            || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
          {
            goto LABEL_17;
          }
          sub_4F390(*(_QWORD *)&off_60148->AlignmentRequirement, 0x2Au, (__int64)&unk_5CC58, MaxCount);
        }
        else
        {
          v4 = off_60148;
          if ( off_60148 == (PDEVICE_OBJECT)&off_60148
            || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
          {
            goto LABEL_17;
          }
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x29u, (__int64)&unk_5CC58, 33595402);
        }
      }
      else
      {
        if ( v4 == (PDEVICE_OBJECT)&off_60148
          || !_bittest((const signed __int32 *)&v4->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          || BYTE1(v4->DeviceQueue.DeviceListHead.Flink) < 2u )
        {
          goto LABEL_17;
        }
        sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x28u, (__int64)&unk_5CC58);
      }
    }
    else
    {
      if ( v4 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&v4->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        || BYTE1(v4->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_17;
      }
      sub_11430(*(_QWORD *)&v4->AlignmentRequirement, 0x27u, (__int64)&unk_5CC58, 33595402);
    }
    v4 = off_60148;
LABEL_17:
    v3 = 4;
    goto LABEL_34;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v4->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x26u, (__int64)&unk_5CC58);
    v4 = off_60148;
  }
  v3 = 16;
LABEL_34:
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v4->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v4->AlignmentRequirement, 0x2Bu, (__int64)&unk_5CC58, v3);
  }
  return v3;
}
// 50175: variable 'a2' is possibly undefined
// 50175: variable 'v8' is possibly undefined

//----- (00000000000502CC) ----------------------------------------------------
__int64 __fastcall sub_502CC(unsigned int a1)
{
  PDEVICE_OBJECT v2; // r10
  unsigned __int16 v3; // dx
  unsigned __int8 (__fastcall *v5)(_QWORD, unsigned int *, size_t *, char *); // r11
  __int64 v6; // rcx
  unsigned __int16 v7; // dx
  char *v8; // rbx
  char v9[40]; // [rsp+30h] [rbp-28h] BYREF
  unsigned int Dst; // [rsp+68h] [rbp+10h] BYREF
  size_t MaxCount; // [rsp+70h] [rbp+18h] BYREF
  unsigned int v12; // [rsp+78h] [rbp+20h] BYREF

  Dst = 0;
  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x2Cu, (__int64)&unk_5CC58, a1);
    v2 = off_60148;
  }
  if ( !qword_627B8 )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v2->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 0i64;
    }
    v3 = (_WORD)qword_627B8 + 45;
    goto LABEL_10;
  }
  v5 = (unsigned __int8 (__fastcall *)(_QWORD, unsigned int *, size_t *, char *))*((_QWORD *)qword_627B8 + 40);
  if ( !v5 )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v2->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 0i64;
    }
    v3 = 46;
LABEL_10:
    sub_11008(*(_QWORD *)&v2->AlignmentRequirement, v3, (__int64)&unk_5CC58);
    return 0i64;
  }
  if ( (unsigned __int8)(a1 - 1) >= (unsigned int)*((unsigned __int8 *)qword_627B8 + 20) )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v2->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 0i64;
    }
    v6 = *(_QWORD *)&v2->AlignmentRequirement;
    v7 = 47;
    goto LABEL_22;
  }
  if ( !v5(a1, &v12, &MaxCount, v9) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x30u, (__int64)&unk_5CC58, a1);
    }
    return 0i64;
  }
  if ( (unsigned int)MaxCount > 4 )
  {
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 0i64;
    }
    v6 = *(_QWORD *)&off_60148->AlignmentRequirement;
    v7 = 49;
LABEL_22:
    sub_4F390(v6, v7, (__int64)&unk_5CC58, a1);
    return 0i64;
  }
  KeEnterCriticalRegion();
  sub_3FFAC((PERESOURCE)((char *)qword_627B8 + 216));
  v8 = (char *)qword_627B8;
  memmove(&Dst, (char *)qword_627B8 + v12 + 352, (unsigned int)MaxCount);
  sub_40084((PERESOURCE)(v8 + 216));
  KeLeaveCriticalRegion();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x32u, (__int64)&unk_5CC58, Dst);
  }
  return Dst;
}

//----- (0000000000050538) ----------------------------------------------------
__int64 __fastcall sub_50538(unsigned int a1)
{
  PDEVICE_OBJECT v2; // r10
  unsigned __int16 v3; // dx
  unsigned __int8 (__fastcall *v5)(_QWORD, unsigned int *, size_t *, char *); // r11
  __int64 v6; // rcx
  unsigned __int16 v7; // dx
  char *v8; // rbx
  __int64 Dst[5]; // [rsp+30h] [rbp-28h] BYREF
  size_t MaxCount; // [rsp+68h] [rbp+10h] BYREF
  unsigned int v11; // [rsp+70h] [rbp+18h] BYREF
  char v12; // [rsp+78h] [rbp+20h] BYREF

  Dst[0] = 0i64;
  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x33u, (__int64)&unk_5CC58, a1);
    v2 = off_60148;
  }
  if ( !qword_627B8 )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v2->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 0i64;
    }
    v3 = (_WORD)qword_627B8 + 52;
    goto LABEL_10;
  }
  v5 = (unsigned __int8 (__fastcall *)(_QWORD, unsigned int *, size_t *, char *))*((_QWORD *)qword_627B8 + 40);
  if ( !v5 )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v2->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 0i64;
    }
    v3 = 53;
LABEL_10:
    sub_11008(*(_QWORD *)&v2->AlignmentRequirement, v3, (__int64)&unk_5CC58);
    return 0i64;
  }
  if ( (unsigned __int8)(a1 - 1) >= (unsigned int)*((unsigned __int8 *)qword_627B8 + 20) )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v2->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 0i64;
    }
    v6 = *(_QWORD *)&v2->AlignmentRequirement;
    v7 = 54;
    goto LABEL_22;
  }
  if ( !v5(a1, &v11, &MaxCount, &v12) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11148(*(_QWORD *)&off_60148->AlignmentRequirement, 0x37u, (__int64)&unk_5CC58, a1);
    }
    return 0i64;
  }
  if ( (unsigned int)MaxCount > 8 )
  {
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 0i64;
    }
    v6 = *(_QWORD *)&off_60148->AlignmentRequirement;
    v7 = 56;
LABEL_22:
    sub_115F4(v6, v7, (__int64)&unk_5CC58, a1);
    return 0i64;
  }
  KeEnterCriticalRegion();
  sub_3FFAC((PERESOURCE)((char *)qword_627B8 + 216));
  v8 = (char *)qword_627B8;
  memmove(Dst, (char *)qword_627B8 + v11 + 352, (unsigned int)MaxCount);
  sub_40084((PERESOURCE)(v8 + 216));
  KeLeaveCriticalRegion();
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x39u, (__int64)&unk_5CC58, Dst[0], 0);
  }
  return Dst[0];
}

//----- (00000000000507A8) ----------------------------------------------------
__int64 __fastcall sub_507A8(__int64 a1, unsigned int a2, _QWORD *a3, _DWORD *a4)
{
  _DWORD *v4; // rbp
  _QWORD *v5; // rdi
  unsigned int v7; // ebx
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  unsigned __int16 v10; // dx
  __int64 v11; // rsi
  __int64 v12; // r12
  int v13; // eax
  char v17; // [rsp+80h] [rbp+18h] BYREF

  v4 = a4;
  v5 = a3;
  v7 = 0;
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_4F31C(*(_QWORD *)&off_60148->AlignmentRequirement);
    v8 = off_60148;
  }
  if ( !v5 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v8->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v9 = 59;
LABEL_10:
    sub_11008(*(_QWORD *)&v8->AlignmentRequirement, v9, (__int64)&unk_5CC58);
    v8 = off_60148;
LABEL_11:
    v7 = 4;
    goto LABEL_47;
  }
  if ( !v4 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v8->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v9 = 60;
    goto LABEL_10;
  }
  if ( !qword_627B8 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v8->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_23;
    }
    v10 = 61;
LABEL_22:
    sub_11008(*(_QWORD *)&v8->AlignmentRequirement, v10, (__int64)&unk_5CC58);
    v8 = off_60148;
LABEL_23:
    v7 = 16;
    goto LABEL_47;
  }
  v11 = *((_QWORD *)qword_627B8 + 5);
  if ( !v11 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v8->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_23;
    }
    v10 = 62;
    goto LABEL_22;
  }
  v12 = *((_QWORD *)qword_627B8 + 6);
  if ( (*(unsigned int (__fastcall **)(__int64, _QWORD, char *))(v11 + 40))(v12, 0i64, &v17) || !v17 )
  {
    v8 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_46;
    }
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Fu, (__int64)&unk_5CC58, 0);
    goto LABEL_45;
  }
  *v5 = 0i64;
  *v4 = 0;
  v13 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD *, _DWORD *, _QWORD *, _DWORD *))(v11 + 16))(
          v12,
          0i64,
          a2,
          v5,
          v4,
          a3,
          a4);
  if ( v13 || !*v5 )
  {
    v8 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_46;
    }
    sub_4DE38(*(_QWORD *)&off_60148->AlignmentRequirement, 0x40u, (__int64)&unk_5CC58, v13);
LABEL_45:
    v8 = off_60148;
LABEL_46:
    v7 = 8;
    goto LABEL_47;
  }
  v8 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return v7;
  if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_4F2B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x41u, (__int64)&unk_5CC58, a2);
    v8 = off_60148;
  }
LABEL_47:
  if ( v8 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v8->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v8->AlignmentRequirement, 0x42u, (__int64)&unk_5CC58, v7);
  }
  return v7;
}
// 5093A: variable 'a3' is possibly undefined
// 5093A: variable 'a4' is possibly undefined

//----- (0000000000050A80) ----------------------------------------------------
__int64 __fastcall sub_50A80(__int64 a1)
{
  unsigned int v2; // ebx
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  char v5; // si
  int v6; // eax

  v2 = 0;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x43u, (__int64)&unk_5CC58, a1);
    v3 = off_60148;
  }
  if ( !a1 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v3->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v3->AlignmentRequirement, 0x44u, (__int64)&unk_5CC58);
      v3 = off_60148;
    }
    v2 = 4;
    goto LABEL_38;
  }
  if ( !qword_627B8 )
  {
    if ( v3 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v3->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v3->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_17;
    }
    v4 = (_WORD)qword_627B8 + 69;
LABEL_16:
    sub_11008(*(_QWORD *)&v3->AlignmentRequirement, v4, (__int64)&unk_5CC58);
    v3 = off_60148;
LABEL_17:
    v2 = 16;
    goto LABEL_38;
  }
  if ( !*((_QWORD *)qword_627B8 + 5) )
  {
    if ( v3 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v3->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v3->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_17;
    }
    v4 = 70;
    goto LABEL_16;
  }
  v5 = sub_5830C((PFAST_MUTEX)((char *)qword_627B8 + 128));
  if ( v5 )
  {
    v6 = (*(__int64 (__fastcall **)(_QWORD, __int64))(*((_QWORD *)qword_627B8 + 5) + 32i64))(
           *((_QWORD *)qword_627B8 + 6),
           a1);
    if ( v6 )
    {
      v3 = off_60148;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x48u, (__int64)&unk_5CC58, v6);
        v3 = off_60148;
      }
      v2 = 8;
    }
    else
    {
      v3 = off_60148;
    }
  }
  else
  {
    v3 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x47u, (__int64)&unk_5CC58);
      v3 = off_60148;
    }
    v2 = 9;
  }
  if ( v5 )
  {
    sub_58374((PFAST_MUTEX)((char *)qword_627B8 + 128));
    v3 = off_60148;
  }
LABEL_38:
  if ( v3 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v3->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v3->AlignmentRequirement, 0x49u, (__int64)&unk_5CC58, v2);
  }
  return v2;
}

//----- (0000000000050CBC) ----------------------------------------------------
__int64 __fastcall sub_50CBC(unsigned int a1, unsigned int a2, __int64 a3, int a4)
{
  __int64 v5; // rsi
  unsigned int v6; // er12
  __int64 v7; // r9
  unsigned int v8; // ebx
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  __int64 v11; // rdi
  __int64 v12; // rbp
  int v13; // eax
  int v17; // [rsp+30h] [rbp-38h]
  char v18; // [rsp+80h] [rbp+18h] BYREF

  v5 = a3;
  v6 = a2;
  v7 = a1;
  v8 = 0;
  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v17 = a4;
    sub_4F2B0(*(_QWORD *)&off_60148->AlignmentRequirement, 0x4Au, (__int64)&unk_5CC58, v7);
    v9 = off_60148;
  }
  if ( !v5 )
  {
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v9->AlignmentRequirement, 0x4Bu, (__int64)&unk_5CC58);
      v9 = off_60148;
    }
    v8 = 4;
    goto LABEL_44;
  }
  if ( !qword_627B8 )
  {
    if ( v9 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v9->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_17;
    }
    v10 = 76;
LABEL_16:
    sub_11008(*(_QWORD *)&v9->AlignmentRequirement, v10, (__int64)&unk_5CC58);
    v9 = off_60148;
LABEL_17:
    v8 = 16;
    goto LABEL_44;
  }
  v11 = *((_QWORD *)qword_627B8 + 5);
  if ( !v11 )
  {
    if ( v9 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v9->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_17;
    }
    v10 = 77;
    goto LABEL_16;
  }
  v12 = *((_QWORD *)qword_627B8 + 6);
  if ( v9 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11008(*(_QWORD *)&v9->AlignmentRequirement, 0x4Eu, (__int64)&unk_5CC58);
  }
  if ( (*(unsigned int (__fastcall **)(__int64, _QWORD, char *, __int64, unsigned int, __int64, int))(v11 + 40))(
         v12,
         0i64,
         &v18,
         v7,
         a2,
         a3,
         v17)
    || !v18 )
  {
    v9 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_43;
    }
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x4Fu, (__int64)&unk_5CC58, 0);
    goto LABEL_42;
  }
  v13 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, __int64, int))(v11 + 24))(
          v12,
          0i64,
          0i64,
          v6,
          v5,
          a4);
  if ( v13 )
  {
    v9 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_43;
    }
    sub_4DE38(*(_QWORD *)&off_60148->AlignmentRequirement, 0x50u, (__int64)&unk_5CC58, v13);
LABEL_42:
    v9 = off_60148;
LABEL_43:
    v8 = 8;
    goto LABEL_44;
  }
  v9 = off_60148;
  if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
    return v8;
  if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x51u, (__int64)&unk_5CC58, v6);
    v9 = off_60148;
  }
LABEL_44:
  if ( v9 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v9->AlignmentRequirement, 0x52u, (__int64)&unk_5CC58, v8);
  }
  return v8;
}
// 50E28: variable 'v7' is possibly undefined
// 50E28: variable 'a2' is possibly undefined
// 50E28: variable 'a3' is possibly undefined
// 50E28: variable 'v17' is possibly undefined

//----- (0000000000050F88) ----------------------------------------------------
char *__fastcall sub_50F88(unsigned int a1)
{
  char *v2; // rbx
  PDEVICE_OBJECT v3; // r10
  unsigned int v5; // [rsp+58h] [rbp+10h] BYREF
  char v6; // [rsp+60h] [rbp+18h] BYREF
  char v7; // [rsp+68h] [rbp+20h] BYREF

  v2 = 0i64;
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x53u, (__int64)&unk_5CC58, a1);
    v3 = off_60148;
  }
  if ( qword_627B8 )
  {
    if ( (unsigned __int8)(a1 - 1) < (unsigned int)*((unsigned __int8 *)qword_627B8 + 20) )
    {
      if ( (*((unsigned __int8 (__fastcall **)(_QWORD, unsigned int *, char *, char *))qword_627B8 + 40))(
             a1,
             &v5,
             &v7,
             &v6) )
      {
        KeEnterCriticalRegion();
        sub_3FFAC((PERESOURCE)((char *)qword_627B8 + 216));
        v2 = (char *)qword_627B8 + v5 + 352;
      }
      else
      {
        v3 = off_60148;
        if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
          return v2;
        if ( !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
        {
          goto LABEL_22;
        }
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x56u, (__int64)&unk_5CC58, a1);
      }
    }
    else
    {
      if ( v3 == (PDEVICE_OBJECT)&off_60148 )
        return v2;
      if ( !_bittest((const signed __int32 *)&v3->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        || BYTE1(v3->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_22;
      }
      sub_11430(*(_QWORD *)&v3->AlignmentRequirement, 0x55u, (__int64)&unk_5CC58, a1);
    }
    goto LABEL_21;
  }
  if ( v3 == (PDEVICE_OBJECT)&off_60148 )
    return v2;
  if ( _bittest((const signed __int32 *)&v3->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v3->AlignmentRequirement, 0x54u, (__int64)&unk_5CC58);
LABEL_21:
    v3 = off_60148;
  }
LABEL_22:
  if ( v3 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v3->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_2F80C(*(_QWORD *)&v3->AlignmentRequirement, 0x57u, (__int64)&unk_5CC58, v2);
  }
  return v2;
}

//----- (0000000000051168) ----------------------------------------------------
void sub_51168()
{
  PDEVICE_OBJECT v0; // rcx

  v0 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x58u, (__int64)&unk_5CC58);
    v0 = off_60148;
  }
  if ( qword_627B8 )
  {
    sub_40084((PERESOURCE)((char *)qword_627B8 + 216));
    KeLeaveCriticalRegion();
    goto LABEL_11;
  }
  if ( v0 == (PDEVICE_OBJECT)&off_60148 )
    return;
  if ( _bittest((const signed __int32 *)&v0->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v0->AlignmentRequirement, (_WORD)qword_627B8 + 89, (__int64)&unk_5CC58);
LABEL_11:
    v0 = off_60148;
  }
  if ( v0 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v0->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v0->AlignmentRequirement, 0x5Au, (__int64)&unk_5CC58);
  }
}

//----- (000000000005124C) ----------------------------------------------------
__int64 __fastcall sub_5124C(__int64 a1)
{
  char *v1; // r8
  unsigned int v2; // ebx
  __int64 (__fastcall **v4)(_QWORD, _QWORD); // r13
  __int64 v5; // r14
  int v6; // ebp
  PDEVICE_OBJECT v7; // rcx
  _DWORD *v8; // rdi
  unsigned __int16 v10; // dx
  unsigned __int16 v11; // dx
  int v12; // edx
  int *v13; // rdi
  int *v14; // rbp
  int v15; // edi
  int *v16; // rbp
  int v17; // edi

  v1 = (char *)qword_627B8;
  v2 = 0;
  v4 = (__int64 (__fastcall **)(_QWORD, _QWORD))*((_QWORD *)qword_627B8 + 5);
  v5 = *((_QWORD *)qword_627B8 + 6);
  v6 = 0;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x5Bu, (__int64)&unk_5CC58);
    v1 = (char *)qword_627B8;
    v7 = off_60148;
  }
  if ( !a1 )
    goto LABEL_6;
  v8 = *(_DWORD **)(a1 + 56);
  if ( !v8 )
    goto LABEL_6;
  switch ( *v8 )
  {
    case 0:
      v16 = v8 + 1;
      if ( v7 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&v7->AlignmentRequirement, 0x5Cu, (__int64)&unk_5CC58);
        v1 = (char *)qword_627B8;
        v7 = off_60148;
      }
      if ( v8 != (_DWORD *)-4i64 )
      {
        if ( !sub_5830C((PFAST_MUTEX)(v1 + 128)) )
          goto LABEL_26;
        v2 = sub_5288C(*v16);
        if ( v2 )
          goto LABEL_65;
        v17 = v4[9](v5, (unsigned int)*v16);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, v2 + 93, (__int64)&unk_5CC58, *v16);
        }
        sub_58374((PFAST_MUTEX)((char *)qword_627B8 + 128));
        if ( !v17 )
          goto LABEL_26;
        v2 = 8;
        v7 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            v10 = 94;
            goto LABEL_91;
          }
          goto LABEL_93;
        }
        goto LABEL_53;
      }
LABEL_6:
      v2 = 2;
      goto LABEL_93;
    case 1:
      v14 = v8 + 1;
      if ( v7 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&v7->AlignmentRequirement, 0x5Fu, (__int64)&unk_5CC58);
        v1 = (char *)qword_627B8;
        v7 = off_60148;
      }
      if ( v8 != (_DWORD *)-4i64 )
      {
        if ( !sub_5830C((PFAST_MUTEX)(v1 + 128)) )
          goto LABEL_26;
        v2 = sub_529E8(*v14);
        if ( v2 )
        {
LABEL_65:
          sub_58374((PFAST_MUTEX)((char *)qword_627B8 + 128));
LABEL_92:
          v7 = off_60148;
          goto LABEL_93;
        }
        v15 = v4[10](v5, (unsigned int)*v14);
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x60u, (__int64)&unk_5CC58, *v14);
        }
        sub_58374((PFAST_MUTEX)((char *)qword_627B8 + 128));
        if ( !v15 )
          goto LABEL_26;
        v2 = 8;
        v7 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            v10 = 97;
            goto LABEL_91;
          }
LABEL_93:
          if ( v7 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            sub_11008(*(_QWORD *)&v7->AlignmentRequirement, 0x68u, (__int64)&unk_5CC58);
          }
          if ( v2 )
            goto LABEL_53;
          goto LABEL_98;
        }
LABEL_53:
        v12 = v2;
        goto LABEL_27;
      }
      goto LABEL_6;
    case 2:
      if ( sub_5830C((PFAST_MUTEX)(v1 + 128)) )
      {
        v2 = sub_51ED0(v8[1], v8[2], v8[3], v8 + 4);
        sub_58374((PFAST_MUTEX)((char *)qword_627B8 + 128));
      }
      goto LABEL_53;
    case 3:
      if ( sub_5830C((PFAST_MUTEX)(v1 + 128)) )
      {
        v2 = sub_524C8((unsigned int)v8[1], v8[2], a1);
        sub_58374((PFAST_MUTEX)((char *)qword_627B8 + 128));
      }
      goto LABEL_28;
    case 4:
      v13 = v8 + 1;
      if ( v7 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&v7->AlignmentRequirement, 0x62u, (__int64)&unk_5CC58);
        v1 = (char *)qword_627B8;
      }
      if ( sub_5830C((PFAST_MUTEX)(v1 + 128)) )
      {
        if ( v13 )
        {
          v6 = v4[8](v5, (unsigned int)*v13);
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
          {
            sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x63u, (__int64)&unk_5CC58, *v13);
          }
        }
        sub_58374((PFAST_MUTEX)((char *)qword_627B8 + 128));
        if ( !v13 || v6 )
        {
          v2 = 8;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x64u, (__int64)&unk_5CC58);
          }
        }
      }
      goto LABEL_53;
    case 5:
      if ( v7 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 4u )
      {
        goto LABEL_26;
      }
      v11 = 101;
      goto LABEL_25;
  }
  if ( *v8 != 6 )
  {
    if ( *((_QWORD *)v1 + 43) )
      return (*((__int64 (__fastcall **)(__int64, _QWORD, char *, void *))v1 + 43))(
               a1,
               (unsigned int)(*v8 - 5),
               v1,
               &unk_5CC58);
    if ( v7 == (PDEVICE_OBJECT)&off_60148 )
    {
LABEL_98:
      v2 = 17;
      goto LABEL_53;
    }
    if ( _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      v10 = 103;
LABEL_91:
      sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v10, (__int64)&unk_5CC58);
      goto LABEL_92;
    }
    goto LABEL_93;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    v11 = 102;
LABEL_25:
    sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v11, (__int64)&unk_5CC58);
  }
LABEL_26:
  v12 = 0;
LABEL_27:
  sub_4C35C(a1, v12, 0, 0i64);
LABEL_28:
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x69u, (__int64)&unk_5CC58, v2);
  }
  return v2;
}

//----- (0000000000051804) ----------------------------------------------------
__int64 sub_51804()
{
  __int64 v0; // rsi
  __int64 v1; // r15
  unsigned int v2; // er13
  int v3; // eax
  void *v4; // rbp
  void **v5; // r14
  unsigned int v6; // er12
  void (__fastcall *v7)(char *); // rax
  int v8; // eax
  PDEVICE_OBJECT v9; // r10
  _DWORD *v10; // r11
  unsigned int i; // er9
  void (__fastcall *v12)(int *); // rax
  PVOID v13; // r11
  int v14; // esi
  unsigned int v15; // eax
  unsigned int v16; // esi
  PVOID v17; // rax
  char *v18; // rbx
  int v19; // eax
  int v20; // ebx
  unsigned int v21; // eax
  unsigned int v22; // ebx
  int v23; // eax
  char *v24; // rsi
  size_t v25; // r8
  void (__fastcall *v26)(int *); // rax
  __int64 v28; // [rsp+20h] [rbp-A8h]
  __int64 v29; // [rsp+28h] [rbp-A0h]
  __int64 v30; // [rsp+30h] [rbp-98h]
  int v31; // [rsp+38h] [rbp-90h]
  char v32[8]; // [rsp+40h] [rbp-88h] BYREF
  void *Src; // [rsp+48h] [rbp-80h] BYREF
  __int64 v34; // [rsp+50h] [rbp-78h]
  int v35[28]; // [rsp+58h] [rbp-70h] BYREF
  _BYTE v36[28]; // [rsp+5Ch] [rbp-6Ch] BYREF
  char v37; // [rsp+D0h] [rbp+8h] BYREF
  size_t MaxCount; // [rsp+D8h] [rbp+10h] BYREF
  unsigned int v39; // [rsp+E0h] [rbp+18h] BYREF
  size_t v40; // [rsp+E8h] [rbp+20h] BYREF

  v0 = *((_QWORD *)qword_627B8 + 6);
  v1 = *((_QWORD *)qword_627B8 + 5);
  v34 = v0;
  v2 = 0;
  v37 = 0;
  v35[0] = 0;
  memset(v36, 0, sizeof(v36));
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Au, (__int64)&unk_5CC58);
  }
  v3 = (*(__int64 (__fastcall **)(__int64, _QWORD, char *))(v1 + 40))(v0, 0i64, &v37);
  if ( !v3 )
  {
    v13 = qword_627B8;
    v20 = *((_DWORD *)qword_627B8 + 4);
    v21 = v20 | *((char *)qword_627B8 + 20);
    v22 = v20 | 1;
    if ( v22 > v21 )
    {
LABEL_73:
      v9 = off_60148;
      goto LABEL_74;
    }
    while ( 1 )
    {
      Src = 0i64;
      LODWORD(MaxCount) = 0;
      if ( (*((unsigned __int8 (__fastcall **)(_QWORD, unsigned int *, size_t *, char *, _DWORD))v13 + 40))(
             v22,
             &v39,
             &v40,
             v32,
             v28) )
      {
        v23 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, void **, size_t *))(v1 + 16))(
                v0,
                0i64,
                v22,
                &Src,
                &MaxCount);
        if ( v23 || !Src )
        {
          v9 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            LODWORD(v28) = v22;
            sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x70u, (__int64)&unk_5CC58, v23);
            v9 = off_60148;
          }
          v2 = 8;
          goto LABEL_66;
        }
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x71u, (__int64)&unk_5CC58, v22);
        }
        KeEnterCriticalRegion();
        LODWORD(v28) = 0;
        sub_3FED4((PERESOURCE)((char *)qword_627B8 + 216));
        v24 = (char *)qword_627B8;
        v25 = (unsigned int)MaxCount;
        if ( (unsigned int)MaxCount >= (unsigned int)v40 )
          v25 = (unsigned int)v40;
        memmove((char *)qword_627B8 + v39 + 352, Src, v25);
        sub_40084((PERESOURCE)(v24 + 216));
        KeLeaveCriticalRegion();
        v0 = v34;
        (*(void (__fastcall **)(__int64, void *))(v1 + 32))(v34, Src);
        v35[(unsigned __int8)(v22 - 1) >> 5] |= 1 << ((v22 - 1) & 0x1F);
      }
      v9 = off_60148;
LABEL_66:
      v13 = qword_627B8;
      if ( ++v22 > (*((_DWORD *)qword_627B8 + 4) | (unsigned int)*((char *)qword_627B8 + 20)) )
        goto LABEL_74;
    }
  }
  v4 = 0i64;
  v5 = 0i64;
  v6 = 0;
  if ( v3 == 1879048199 || v3 == 1879048193 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Bu, (__int64)&unk_5CC58, 0);
    }
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
         && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    LODWORD(v28) = 0;
    sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Cu, (__int64)&unk_5CC58, v3);
  }
  v7 = (void (__fastcall *)(char *))*((_QWORD *)qword_627B8 + 41);
  if ( v7 )
    v7((char *)qword_627B8 + 352);
  v8 = (*(__int64 (__fastcall **)(__int64, _QWORD))(v1 + 64))(v0, 0i64);
  if ( v8 )
  {
    v9 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Du, (__int64)&unk_5CC58, v8);
      v9 = off_60148;
    }
    v10 = qword_627B8;
    for ( i = *((_DWORD *)qword_627B8 + 4) | 1; i <= (v10[4] | (unsigned int)*((char *)v10 + 20)); ++i )
      v35[(unsigned __int8)(i - 1) >> 5] |= 1 << ((i - 1) & 0x1F);
    v12 = (void (__fastcall *)(int *))*((_QWORD *)v10 + 42);
    if ( v12 )
    {
      v12(v35);
      v9 = off_60148;
    }
    v2 = 8;
    goto LABEL_76;
  }
  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Eu, (__int64)&unk_5CC58, 0);
    v9 = off_60148;
  }
  v13 = qword_627B8;
  v14 = *((_DWORD *)qword_627B8 + 4);
  v15 = v14 | *((char *)qword_627B8 + 20);
  v16 = v14 | 1;
  if ( v16 > v15 )
    goto LABEL_74;
  do
  {
    if ( !(*((unsigned __int8 (__fastcall **)(_QWORD, unsigned int *, size_t *, size_t *, __int64, __int64))v13 + 40))(
            v16,
            &v39,
            &MaxCount,
            &v40,
            v28,
            v29) )
      goto LABEL_44;
    if ( (unsigned int)MaxCount > v6 )
    {
      if ( (unsigned int)MaxCount > 8 )
      {
        if ( v4 )
        {
          v31 = 0;
          v30 = 0i64;
          v29 = 0i64;
          LODWORD(v28) = 1886221390;
          v17 = sub_3F764(1i64, v4, v6, MaxCount);
        }
        else
        {
          LODWORD(v29) = 0;
          v28 = 0i64;
          v17 = sub_3F66C(1, MaxCount, 0x706D744Eu);
        }
        v4 = v17;
        v5 = (void **)v17;
        v6 = v17 != 0i64 ? MaxCount : 0;
      }
      else
      {
        v5 = &Src;
        v6 = 8;
      }
    }
    v35[(unsigned __int8)(v16 - 1) >> 5] |= 1 << ((v16 - 1) & 0x1F);
    if ( !v5 )
    {
      v2 = 3;
LABEL_44:
      v9 = off_60148;
      goto LABEL_45;
    }
    KeEnterCriticalRegion();
    sub_3FFAC((PERESOURCE)((char *)qword_627B8 + 216));
    v18 = (char *)qword_627B8;
    memmove(v5, (char *)qword_627B8 + v39 + 352, (unsigned int)MaxCount);
    sub_40084((PERESOURCE)(v18 + 216));
    KeLeaveCriticalRegion();
    LODWORD(v29) = MaxCount;
    v19 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, void **, __int64, __int64, int))(v1 + 24))(
            v34,
            0i64,
            0i64,
            v16,
            v5,
            v29,
            v30,
            v31);
    if ( !v19 )
      goto LABEL_44;
    v9 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      LODWORD(v28) = v16;
      sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Fu, (__int64)&unk_5CC58, v19);
      v9 = off_60148;
    }
    v2 = 8;
LABEL_45:
    v13 = qword_627B8;
    ++v16;
  }
  while ( v16 <= (*((_DWORD *)qword_627B8 + 4) | (unsigned int)*((char *)qword_627B8 + 20)) );
  if ( v4 )
  {
    sub_3F6F0(v4, 0x706D744Eu);
    v13 = qword_627B8;
    goto LABEL_73;
  }
LABEL_74:
  v26 = (void (__fastcall *)(int *))*((_QWORD *)v13 + 42);
  if ( v26 )
  {
    v26(v35);
    v9 = off_60148;
  }
LABEL_76:
  if ( v9 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&v9->AlignmentRequirement, 0x72u, (__int64)&unk_5CC58, v2);
  }
  return v2;
}
// 51A8A: variable 'v28' is possibly undefined
// 51A8A: variable 'v29' is possibly undefined
// 51C07: variable 'v30' is possibly undefined
// 51C07: variable 'v31' is possibly undefined
// 51804: using guessed type int var_70[28];

//----- (0000000000051ED0) ----------------------------------------------------
__int64 __fastcall sub_51ED0(unsigned int a1, int a2, unsigned int a3, _DWORD *a4)
{
  _QWORD *v4; // rsi
  __int64 v6; // rax
  __int64 v7; // r15
  _QWORD *v9; // r14
  unsigned int v10; // ebx
  PDEVICE_OBJECT v13; // rcx
  _QWORD *i; // rax
  char *v16; // rsi
  size_t v17; // r8
  char *v18; // rcx
  _QWORD *v19; // rax
  void (__fastcall *v20)(int *); // rdx
  int v21; // eax
  PDEVICE_OBJECT v22; // rcx
  unsigned __int16 v23; // dx
  __int64 v24; // r9
  PDEVICE_OBJECT v25; // rcx
  unsigned __int16 v26; // dx
  unsigned __int64 v27; // r11
  __int64 v28; // rcx
  int v29; // eax
  int v30; // [rsp+20h] [rbp-78h]
  __int64 v31; // [rsp+20h] [rbp-78h]
  unsigned int v32; // [rsp+28h] [rbp-70h]
  __int64 v33; // [rsp+28h] [rbp-70h]
  _DWORD *v34; // [rsp+30h] [rbp-68h]
  unsigned int v35; // [rsp+40h] [rbp-58h] BYREF
  int v36; // [rsp+44h] [rbp-54h] BYREF
  __int64 v37; // [rsp+48h] [rbp-50h]
  int v38[8]; // [rsp+50h] [rbp-48h] BYREF
  _BYTE v39[28]; // [rsp+54h] [rbp-44h] BYREF
  size_t MaxCount; // [rsp+A0h] [rbp+8h] BYREF

  v4 = qword_627B8;
  v6 = *((_QWORD *)qword_627B8 + 6);
  v7 = *((_QWORD *)qword_627B8 + 5);
  v9 = 0i64;
  v10 = 0;
  v35 = 0;
  LODWORD(MaxCount) = 0;
  v38[0] = 0;
  v37 = v6;
  memset(v39, 0, sizeof(v39));
  v13 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      v34 = a4;
      v32 = a3;
      v30 = a2;
      sub_4F3EC(*(_QWORD *)&off_60148->AlignmentRequirement, 115i64, (__int64)&unk_5CC58, a1);
      v4 = qword_627B8;
      v13 = off_60148;
    }
    if ( v13 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v13->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v13->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&v13->AlignmentRequirement, 0x74u, (__int64)&unk_5CC58);
      v4 = qword_627B8;
      v13 = off_60148;
    }
  }
  if ( a1 )
  {
    for ( i = (_QWORD *)v4[7]; i != v4 + 7; i = (_QWORD *)*i )
    {
      v9 = i - 5;
      if ( *((_DWORD *)i - 10) == a1 )
        goto LABEL_15;
    }
    v9 = 0i64;
LABEL_15:
    if ( !v9 )
    {
      if ( v13 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v13->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v13->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&v13->AlignmentRequirement, 0x75u, (__int64)&unk_5CC58, a1);
      }
      return 4i64;
    }
  }
  if ( !((unsigned __int8 (__fastcall *)(_QWORD, unsigned int *, size_t *, int *, int, unsigned int))v4[40])(
          a3,
          &v35,
          &MaxCount,
          &v36,
          v30,
          v32) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x76u, (__int64)&unk_5CC58, a3);
    }
    return 4i64;
  }
  if ( a1 )
  {
    v16 = (char *)v9 + v35 + 56;
    sub_40598((PFAST_MUTEX)((char *)qword_627B8 + 72));
  }
  else
  {
    v16 = (char *)qword_627B8 + v35 + 352;
    KeEnterCriticalRegion();
    sub_3FED4((PERESOURCE)((char *)qword_627B8 + 216));
  }
  if ( v36 < 0 )
    goto LABEL_34;
  if ( v36 <= 1 )
    goto LABEL_77;
  if ( v36 == 2 )
  {
    if ( a4 )
    {
      v24 = (unsigned int)*a4;
      if ( 2 * v24 <= (unsigned __int64)(unsigned int)MaxCount )
      {
        memmove(v16, a4 + 1, 2 * v24);
        v27 = 2i64 * (unsigned int)*a4;
        if ( v27 >= (unsigned int)MaxCount )
          goto LABEL_44;
        v17 = (unsigned int)MaxCount - v27;
        v18 = &v16[v27];
        goto LABEL_43;
      }
      v22 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148
        || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
LABEL_64:
        v10 = 6;
        goto LABEL_44;
      }
      v23 = 121;
LABEL_58:
      sub_4DE38(*(_QWORD *)&v22->AlignmentRequirement, v23, (__int64)&unk_5CC58, v24);
      goto LABEL_64;
    }
    v25 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_64;
    }
    v26 = 122;
LABEL_63:
    sub_11008(*(_QWORD *)&v25->AlignmentRequirement, v26, (__int64)&unk_5CC58);
    goto LABEL_64;
  }
  if ( v36 > 4 )
  {
    if ( v36 > 7 )
    {
LABEL_34:
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x7Bu, (__int64)&unk_5CC58);
      }
      v10 = 4;
      goto LABEL_44;
    }
LABEL_77:
    memmove(v16, a4, (unsigned int)MaxCount);
    goto LABEL_44;
  }
  if ( !a4 )
  {
    v25 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_64;
    }
    v26 = 120;
    goto LABEL_63;
  }
  if ( *a4 > (unsigned int)MaxCount )
  {
    v22 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_64;
    }
    v23 = 119;
    LODWORD(v24) = *a4;
    goto LABEL_58;
  }
  memmove(v16, a4 + 1, (unsigned int)*a4);
  if ( *a4 < (unsigned int)MaxCount )
  {
    v17 = (unsigned int)(MaxCount - *a4);
    v18 = &v16[*a4];
LABEL_43:
    memset(v18, 0, v17);
  }
LABEL_44:
  if ( a1 )
  {
    if ( !v10 )
    {
      v28 = v37;
      *((_DWORD *)v9 + (((a3 - 1) >> 5) & 7) + 1) |= 1 << ((a3 - 1) & 0x1F);
      v29 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, char *, _DWORD))(v7 + 24))(
              v28,
              a1,
              0i64,
              a3,
              v16,
              MaxCount);
      if ( v29 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          LODWORD(v33) = a3;
          LODWORD(v31) = a1;
          sub_4F240(*(_QWORD *)&off_60148->AlignmentRequirement, 125i64, (__int64)&unk_5CC58, v29, v31, v33, 0);
        }
        v10 = 8;
      }
    }
    sub_40664((PFAST_MUTEX)((char *)qword_627B8 + 72));
  }
  else
  {
    sub_40084((PERESOURCE)((char *)qword_627B8 + 216));
    KeLeaveCriticalRegion();
    if ( !v10 )
    {
      v19 = qword_627B8;
      v38[((a3 - 1) >> 5) & 7] |= 1 << ((a3 - 1) & 0x1F);
      v20 = (void (__fastcall *)(int *))v19[42];
      if ( v20 )
        v20(v38);
      v21 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, char *, _DWORD, _DWORD *))(v7 + 24))(
              v37,
              0i64,
              0i64,
              a3,
              v16,
              MaxCount,
              v34);
      if ( v21 )
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_4DE38(*(_QWORD *)&off_60148->AlignmentRequirement, 0x7Cu, (__int64)&unk_5CC58, v21);
        }
        v10 = 8;
      }
    }
  }
  return v10;
}
// 52120: conditional instruction was optimized away because of 'eax.4>=3'
// 52052: variable 'v30' is possibly undefined
// 52052: variable 'v32' is possibly undefined
// 52241: variable 'v34' is possibly undefined
// 5247F: variable 'v31' is possibly undefined
// 5247F: variable 'v33' is possibly undefined
// 51ED0: using guessed type int var_48[8];

//----- (00000000000524C8) ----------------------------------------------------
__int64 __fastcall sub_524C8(__int64 a1, unsigned int a2, __int64 a3)
{
  unsigned int v5; // ebx
  PDEVICE_OBJECT v6; // rcx
  PDEVICE_OBJECT v7; // rcx
  int v8; // edx
  char *v9; // rbp
  unsigned int v10; // er8
  __int64 *v11; // r9
  unsigned int v12; // er12
  _DWORD *v13; // rsi
  unsigned __int16 v14; // dx
  int v15; // eax
  __int64 Dst; // [rsp+30h] [rbp-38h] BYREF
  unsigned int v18; // [rsp+38h] [rbp-30h] BYREF
  int v19; // [rsp+3Ch] [rbp-2Ch] BYREF
  size_t MaxCount; // [rsp+88h] [rbp+20h] BYREF

  v5 = 0;
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x7Eu, (__int64)&unk_5CC58);
      v6 = off_60148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_112FC(*(_QWORD *)&v6->AlignmentRequirement, 0x7Fu, (__int64)&unk_5CC58, a2);
    }
  }
  if ( !(*((unsigned __int8 (__fastcall **)(_QWORD, unsigned int *, size_t *, int *))qword_627B8 + 40))(
          a2,
          &v18,
          &MaxCount,
          &v19) )
  {
    v7 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x80u, (__int64)&unk_5CC58, a2);
LABEL_46:
        v7 = off_60148;
      }
LABEL_47:
      if ( v7 != (PDEVICE_OBJECT)&off_60148
        && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&v7->AlignmentRequirement, 0x85u, (__int64)&unk_5CC58);
      }
    }
LABEL_51:
    v8 = 17;
LABEL_52:
    v11 = 0i64;
    v5 = v8;
    v10 = 0;
    goto LABEL_53;
  }
  if ( !(_DWORD)MaxCount )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x81u, (__int64)&unk_5CC58, a2);
    }
    v8 = 12;
    goto LABEL_52;
  }
  v9 = (char *)qword_627B8 + v18 + 352;
  if ( v19 < 0 )
  {
LABEL_41:
    v7 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
      goto LABEL_51;
    if ( !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_47;
    }
    v14 = 132;
    goto LABEL_45;
  }
  if ( v19 <= 1 )
  {
LABEL_40:
    LODWORD(Dst) = 0;
    memmove(&Dst, (char *)qword_627B8 + v18 + 352, (unsigned int)MaxCount);
    v8 = 0;
    v10 = 4;
    v11 = &Dst;
    goto LABEL_53;
  }
  if ( v19 == 2 )
  {
    v12 = MaxCount + 4;
    v13 = sub_3F66C(1, (int)MaxCount + 4, 0x66634E4Eu);
    if ( !v13 )
    {
      v7 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        goto LABEL_51;
      if ( !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_47;
      }
      v14 = 131;
      goto LABEL_45;
    }
    v15 = (unsigned int)MaxCount >> 1;
  }
  else
  {
    if ( v19 > 4 )
    {
      if ( v19 > 6 )
      {
        if ( v19 == 7 )
        {
          Dst = 0i64;
          memmove(&Dst, (char *)qword_627B8 + v18 + 352, (unsigned int)MaxCount);
          v8 = 0;
          v10 = 8;
          v11 = &Dst;
LABEL_53:
          sub_4C35C(a3, v8, v10, v11);
          goto LABEL_54;
        }
        goto LABEL_41;
      }
      goto LABEL_40;
    }
    v12 = MaxCount + 4;
    v13 = sub_3F66C(1, (int)MaxCount + 4, 0x66634E4Eu);
    if ( !v13 )
    {
      v7 = off_60148;
      if ( off_60148 == (PDEVICE_OBJECT)&off_60148 )
        goto LABEL_51;
      if ( !_bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_47;
      }
      v14 = 130;
LABEL_45:
      sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v14, (__int64)&unk_5CC58);
      goto LABEL_46;
    }
    v15 = MaxCount;
  }
  *v13 = v15;
  memmove(v13 + 1, v9, (unsigned int)MaxCount);
  sub_4C35C(a3, 0, v12, v13);
  sub_3F6F0(v13, 0x66634E4Eu);
LABEL_54:
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && _bittest((const signed __int32 *)&off_60148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x86u, (__int64)&unk_5CC58, v5);
  }
  return v5;
}
// 5264C: conditional instruction was optimized away because of 'eax.4>=3'

//----- (000000000005288C) ----------------------------------------------------
__int64 __fastcall sub_5288C(int a1)
{
  unsigned int v1; // edi
  char *v4; // r10
  char *i; // rax
  char *v6; // rax
  _DWORD *v7; // rax
  _QWORD *v8; // rsi
  char *v9; // rbx
  _QWORD *v10; // rdx
  __int64 v11; // rcx

  v1 = 0;
  if ( !a1 )
    return 6i64;
  sub_40598((PFAST_MUTEX)((char *)qword_627B8 + 72));
  v4 = (char *)qword_627B8;
  for ( i = (char *)*((_QWORD *)qword_627B8 + 7); i != (char *)qword_627B8 + 56; i = (char *)*((_QWORD *)v6 + 5) )
  {
    v6 = i - 40;
    if ( *(_DWORD *)v6 == a1 )
      goto LABEL_8;
  }
  v6 = 0i64;
LABEL_8:
  if ( v6 )
  {
    v1 = 6;
  }
  else
  {
    v7 = sub_3F66C(1, *((_DWORD *)qword_627B8 + 1) + 56, 0x66634E4Eu);
    v8 = v7;
    if ( v7 )
    {
      *v7 = a1;
      memset(v7 + 1, 0, 0x20ui64);
      KeEnterCriticalRegion();
      sub_3FFAC((PERESOURCE)((char *)qword_627B8 + 216));
      v9 = (char *)qword_627B8;
      memmove(v8 + 7, (char *)qword_627B8 + 352, *((unsigned int *)qword_627B8 + 1));
      sub_40084((PERESOURCE)(v9 + 216));
      KeLeaveCriticalRegion();
      v4 = (char *)qword_627B8;
      v10 = (char *)qword_627B8 + 56;
      v11 = *((_QWORD *)qword_627B8 + 7);
      v8[6] = (char *)qword_627B8 + 56;
      v8[5] = v11;
      *(_QWORD *)(v11 + 8) = v8 + 5;
      *v10 = v8 + 5;
    }
    else
    {
      v4 = (char *)qword_627B8;
      v1 = 3;
    }
  }
  sub_40664((PFAST_MUTEX)(v4 + 72));
  return v1;
}

//----- (00000000000529E8) ----------------------------------------------------
__int64 __fastcall sub_529E8(int a1)
{
  __int64 result; // rax
  char *v3; // r11
  _QWORD *i; // rax
  char *v5; // rdi
  __int64 v6; // rcx
  _QWORD *v7; // rax
  char *v8; // rbx
  void (__fastcall *v9)(char *); // rax

  if ( !a1 )
    return 6i64;
  sub_40598((PFAST_MUTEX)((char *)qword_627B8 + 72));
  v3 = (char *)qword_627B8;
  for ( i = (_QWORD *)*((_QWORD *)qword_627B8 + 7); i != (_QWORD *)((char *)qword_627B8 + 56); i = (_QWORD *)*i )
  {
    v5 = (char *)(i - 5);
    if ( *((_DWORD *)i - 10) == a1 )
      goto LABEL_8;
  }
  v5 = 0i64;
LABEL_8:
  if ( v5 )
  {
    v6 = *((_QWORD *)v5 + 5);
    v7 = (_QWORD *)*((_QWORD *)v5 + 6);
    *v7 = v6;
    *(_QWORD *)(v6 + 8) = v7;
    sub_40664((PFAST_MUTEX)(v3 + 72));
    KeEnterCriticalRegion();
    sub_3FED4((PERESOURCE)((char *)qword_627B8 + 216));
    v8 = (char *)qword_627B8;
    memmove((char *)qword_627B8 + 352, v5 + 56, *((unsigned int *)qword_627B8 + 1));
    sub_40084((PERESOURCE)(v8 + 216));
    KeLeaveCriticalRegion();
    v9 = (void (__fastcall *)(char *))*((_QWORD *)qword_627B8 + 42);
    if ( v9 )
      v9(v5 + 4);
    sub_3F6F0(v5, 0x66634E4Eu);
    result = 0i64;
  }
  else
  {
    sub_40664((PFAST_MUTEX)((char *)qword_627B8 + 72));
    result = 5i64;
  }
  return result;
}

//----- (0000000000052B10) ----------------------------------------------------
__int64 __fastcall sub_52B10(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CBD0, a2, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000052B6C) ----------------------------------------------------
__int64 __fastcall sub_52B6C(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_61238(a1, 43i64, &unk_5CBD0, 189i64, &v5);
}
// 61238: using guessed type __int64 (__fastcall *qword_61238)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000052BDC) ----------------------------------------------------
__int64 __fastcall sub_52BDC(int a1, _QWORD *a2)
{
  PDEVICE_OBJECT v4; // rcx
  int v6; // ebx

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xAu, (__int64)&unk_5CBD0);
    v4 = off_60148;
  }
  if ( a2 )
  {
    if ( a1 )
    {
      v6 = a1 - 1;
      if ( !v6 )
      {
        if ( v4 != (PDEVICE_OBJECT)&off_60148
          && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
          && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0xDu, (__int64)&unk_5CBD0);
        }
        sub_40150(a2);
        goto LABEL_28;
      }
      if ( v6 == 1 )
      {
        if ( v4 != (PDEVICE_OBJECT)&off_60148
          && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
          && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0xEu, (__int64)&unk_5CBD0);
        }
        sub_404B8((__int64)a2);
        goto LABEL_28;
      }
    }
    else
    {
      if ( v4 == (PDEVICE_OBJECT)&off_60148 )
        return 0i64;
      if ( SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0xCu, (__int64)&unk_5CBD0);
LABEL_28:
        v4 = off_60148;
        goto LABEL_29;
      }
    }
LABEL_29:
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0xFu, (__int64)&unk_5CBD0);
    }
    return 0i64;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0xBu, (__int64)&unk_5CBD0);
  }
  return 3i64;
}

//----- (0000000000052D80) ----------------------------------------------------
__int64 __fastcall sub_52D80(int a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  int v6; // ebx
  unsigned __int16 v7; // dx

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x10u, (__int64)&unk_5CBD0);
    v4 = off_60148;
  }
  if ( a2 )
  {
    if ( a1 )
    {
      v6 = a1 - 1;
      if ( v6 )
      {
        if ( v6 != 1 )
          goto LABEL_27;
        if ( v4 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            v7 = 20;
LABEL_26:
            sub_11008(*(_QWORD *)&v4->AlignmentRequirement, v7, (__int64)&unk_5CBD0);
            v4 = off_60148;
            goto LABEL_27;
          }
          goto LABEL_27;
        }
      }
      else if ( v4 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          v7 = 19;
          goto LABEL_26;
        }
LABEL_27:
        if ( v4 != (PDEVICE_OBJECT)&off_60148
          && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
          && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x15u, (__int64)&unk_5CBD0);
        }
        return 0i64;
      }
    }
    else if ( v4 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        v7 = 18;
        goto LABEL_26;
      }
      goto LABEL_27;
    }
    return 0i64;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x11u, (__int64)&unk_5CBD0);
  }
  return 3i64;
}

//----- (0000000000052EE0) ----------------------------------------------------
__int64 __fastcall sub_52EE0(int a1, struct _FAST_MUTEX *a2, KIRQL *a3)
{
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  int v6; // ecx

  if ( !a2 )
  {
    v3 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v4 = 22;
LABEL_6:
    sub_11008(*(_QWORD *)&v3->AlignmentRequirement, v4, (__int64)&unk_5CBD0);
    return 3i64;
  }
  if ( !a3 )
  {
    v3 = off_60148;
    if ( off_60148 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v4 = 23;
    goto LABEL_6;
  }
  v6 = a1 - 1;
  if ( v6 )
  {
    if ( v6 == 1 )
      sub_40598(a2);
  }
  else
  {
    sub_401B8((PKSPIN_LOCK)a2, a3);
  }
  return 0i64;
}

//----- (0000000000052FA4) ----------------------------------------------------
__int64 __fastcall sub_52FA4(int a1, struct _FAST_MUTEX *a2, KIRQL a3)
{
  __int64 result; // rax
  int v4; // ecx

  if ( a2 )
  {
    v4 = a1 - 1;
    if ( v4 )
    {
      if ( v4 == 1 )
        sub_40664(a2);
    }
    else
    {
      sub_40230((PKSPIN_LOCK)a2, a3);
    }
    result = 0i64;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x18u, (__int64)&unk_5CBD0);
    }
    result = 3i64;
  }
  return result;
}

//----- (0000000000053038) ----------------------------------------------------
__int64 __fastcall sub_53038(__int64 a1, __int64 a2, char a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x19u, (__int64)&unk_5CBD0);
    v6 = off_60148;
  }
  if ( !a1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 26;
LABEL_10:
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_5CBD0);
    return 3i64;
  }
  if ( !a2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 27;
    goto LABEL_10;
  }
  *(_DWORD *)(a2 + 16) = 0;
  *(_QWORD *)(a2 + 8) = a2;
  *(_QWORD *)a2 = a2;
  if ( a3 )
    sub_52BDC(*(_DWORD *)(a1 + 24), (_QWORD *)(a2 + 24));
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Cu, (__int64)&unk_5CBD0);
  }
  return 0i64;
}

//----- (0000000000053164) ----------------------------------------------------
__int64 __fastcall sub_53164(__int64 a1, __int64 a2, char a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x1Du, (__int64)&unk_5CBD0);
    v6 = off_60148;
  }
  if ( !a1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 30;
LABEL_10:
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_5CBD0);
    return 3i64;
  }
  if ( !a2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 31;
    goto LABEL_10;
  }
  if ( a3 )
  {
    sub_52D80(*(_DWORD *)(a1 + 24), a2 + 24);
    v6 = off_60148;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x20u, (__int64)&unk_5CBD0);
  }
  return 0i64;
}

//----- (0000000000053288) ----------------------------------------------------
_DWORD *__fastcall sub_53288(char a1, int a2, int a3, ULONG a4, __int64 a5, int a6, __int64 a7, __int64 a8, __int64 a9, __int64 a10, _DWORD *a11)
{
  int v15; // ebx
  int v16; // eax
  int v17; // er12
  bool v19; // zf
  _DWORD *v20; // rbx
  char *v21; // rax
  unsigned int i; // edi
  PDEVICE_OBJECT v23; // rcx

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x21u, (__int64)&unk_5CBD0);
  }
  *a11 = 0;
  v15 = 1 << a1;
  v16 = sub_57FD0(v15);
  v17 = v16;
  if ( !v16 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x23u, (__int64)&unk_5CBD0, v15);
    }
LABEL_10:
    *a11 = 3;
    return 0i64;
  }
  if ( !a6 )
    goto LABEL_23;
  if ( a3 == 1 )
  {
    v19 = a6 == 2;
LABEL_18:
    if ( !v19 )
      goto LABEL_19;
    goto LABEL_23;
  }
  if ( a3 != 2 )
  {
LABEL_19:
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11430(*(_QWORD *)&off_60148->AlignmentRequirement, 0x24u, (__int64)&unk_5CBD0, a3);
    }
    goto LABEL_10;
  }
  if ( a6 != 2 )
  {
    v19 = a6 == 1;
    goto LABEL_18;
  }
LABEL_23:
  v20 = sub_3F66C(2, 16 * (5 * v16 + 5), a4);
  if ( !v20 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x25u, (__int64)&unk_5CBD0);
    }
LABEL_28:
    *a11 = 2;
    return 0i64;
  }
  v21 = sub_3F8D8(a3, 0x38u, a4);
  *((_QWORD *)v20 + 9) = v21;
  if ( !v21 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x26u, (__int64)&unk_5CBD0);
    }
    sub_3F6F0(v20, a4);
    goto LABEL_28;
  }
  v20[3] = a4;
  *v20 = a2;
  v20[1] = v17;
  v20[2] = 0;
  v20[6] = a6;
  *((_QWORD *)v20 + 2) = a5;
  for ( i = 0; i < v20[1]; ++i )
    sub_53038((__int64)v20, (__int64)&v20[20 * i + 20], 1);
  *((_QWORD *)v20 + 6) = 0i64;
  *((_QWORD *)v20 + 5) = a7;
  *((_QWORD *)v20 + 7) = a9;
  *((_QWORD *)v20 + 8) = a10;
  v23 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_52B10(*(_QWORD *)&off_60148->AlignmentRequirement, 0x27u, (__int64)&unk_5CBD0, v20[1]);
      v23 = off_60148;
    }
    if ( v23 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v23->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v23->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&v23->AlignmentRequirement, 0x28u, (__int64)&unk_5CBD0);
    }
  }
  return v20;
}

//----- (00000000000535C8) ----------------------------------------------------
__int64 __fastcall sub_535C8(__int64 a1)
{
  __int64 v1; // rdi
  PDEVICE_OBJECT v2; // rcx
  __int64 result; // rax
  unsigned int v4; // er12
  unsigned int v5; // esi
  __int64 **v6; // rbp
  int v7; // ecx
  struct _FAST_MUTEX *v8; // r15
  __int64 *v9; // r13
  __int64 v10; // r14
  __int64 *v11; // rbx
  PDEVICE_OBJECT v12; // rcx
  unsigned int i; // ebx
  PDEVICE_OBJECT v14; // rcx
  __int64 v15; // [rsp+30h] [rbp-88h] BYREF
  _BYTE v16[72]; // [rsp+38h] [rbp-80h] BYREF
  __int64 v17; // [rsp+C0h] [rbp+8h] BYREF
  struct _FAST_MUTEX *v18; // [rsp+D8h] [rbp+20h]

  v17 = a1;
  v1 = qword_613E8;
  LODWORD(v18) = 0;
  v15 = 0i64;
  memset(v16, 0, sizeof(v16));
  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x29u, (__int64)&unk_5CBD0, 0i64);
    v2 = off_60148;
  }
  if ( v1 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_52B10(*(_QWORD *)&v2->AlignmentRequirement, 0x2Bu, (__int64)&unk_5CBD0, *(_DWORD *)(v1 + 4));
        v2 = off_60148;
      }
      if ( v2 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_2F80C(*(_QWORD *)&v2->AlignmentRequirement, 0x30u, (__int64)&unk_5CBD0, 0i64);
      }
    }
    _InterlockedAdd((volatile signed __int32 *)(v1 + 28), 1u);
    v4 = (unsigned int)v18;
    v5 = 0;
    if ( *(_DWORD *)(v1 + 4) )
    {
      v6 = (__int64 **)(v1 + 80);
      do
      {
        v7 = *(_DWORD *)(v1 + 24);
        v8 = (struct _FAST_MUTEX *)(v1 + 80i64 * v5 + 104);
        v18 = v8;
        sub_52EE0(v7, v8, (KIRQL *)&v17);
        v9 = *v6;
        v10 = v1 + 80i64 * v5 + 80;
        if ( *v6 != (__int64 *)v10 )
        {
          do
          {
            v11 = v9;
            v9 = (__int64 *)*v9;
            v4 = sub_54AB0(v1, v5, v11, 1);
            if ( v4 )
            {
              if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
                && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
              {
                sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x31u, (__int64)&unk_5CBD0);
              }
            }
            else
            {
              sub_54CBC(v1, (__int64)&v15, (__int64)v11);
            }
          }
          while ( v9 != (__int64 *)v10 );
          v8 = v18;
        }
        sub_52FA4(*(_DWORD *)(v1 + 24), v8, v17);
        ++v5;
        v6 += 10;
      }
      while ( v5 < *(_DWORD *)(v1 + 4) );
    }
    sub_54E3C(v1, (__int64)&v15, 1);
    v12 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x32u, (__int64)&unk_5CBD0);
        v12 = off_60148;
      }
      if ( v12 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v12->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(v12->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v12->AlignmentRequirement, 0x33u, (__int64)&unk_5CBD0);
      }
    }
    for ( i = 0; i < *(_DWORD *)(v1 + 4); ++i )
      sub_53164(v1, v1 + 16 * (5i64 * i + 5), 1);
    sub_3F95C(*(PVOID *)(v1 + 72));
    sub_3F6F0((PVOID)v1, *(_DWORD *)(v1 + 12));
    v14 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x34u, (__int64)&unk_5CBD0);
        v14 = off_60148;
      }
      if ( v14 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v14->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(v14->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v14->AlignmentRequirement, 0x35u, (__int64)&unk_5CBD0);
      }
    }
    result = v4;
  }
  else
  {
    if ( v2 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v2->AlignmentRequirement, 0x2Au, (__int64)&unk_5CBD0);
    }
    result = 3i64;
  }
  return result;
}

//----- (0000000000053950) ----------------------------------------------------
__int64 __fastcall sub_53950(ULONG_PTR BugCheckParameter2, char a2)
{
  char v3; // r15
  PDEVICE_OBJECT v4; // rcx
  unsigned int v6; // esi
  _QWORD **v7; // r12
  _QWORD *v8; // rbp
  ULONG_PTR v9; // r13
  PDEVICE_OBJECT v10; // rcx
  ULONG_PTR v11; // rbx
  int v12; // eax
  int i; // ebx
  unsigned int j; // ebx
  PDEVICE_OBJECT v15; // rcx
  __int64 v16; // [rsp+20h] [rbp-A8h]
  __int64 v17; // [rsp+30h] [rbp-98h] BYREF
  char Dst[72]; // [rsp+38h] [rbp-90h] BYREF
  KIRQL v19; // [rsp+D0h] [rbp+8h] BYREF
  char v20; // [rsp+D8h] [rbp+10h]
  unsigned int v21; // [rsp+E0h] [rbp+18h] BYREF
  union _LARGE_INTEGER Interval; // [rsp+E8h] [rbp+20h] BYREF

  v20 = a2;
  v3 = a2;
  v21 = 0;
  v17 = 0i64;
  memset(Dst, 0, sizeof(Dst));
  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x36u, (__int64)&unk_5CBD0);
    v4 = off_60148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x37u, (__int64)&unk_5CBD0);
    }
    return 3i64;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_52B10(*(_QWORD *)&v4->AlignmentRequirement, 0x38u, (__int64)&unk_5CBD0, *(_DWORD *)(BugCheckParameter2 + 4));
  }
  _InterlockedAdd((volatile signed __int32 *)(BugCheckParameter2 + 28), 1u);
  v6 = 0;
  if ( *(_DWORD *)(BugCheckParameter2 + 4) )
  {
    v7 = (_QWORD **)(BugCheckParameter2 + 80);
    while ( 1 )
    {
      sub_52EE0(
        *(_DWORD *)(BugCheckParameter2 + 24),
        (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v6 + 104),
        &v19);
      v8 = *v7;
      v9 = BugCheckParameter2 + 80i64 * v6 + 80;
      if ( *v7 != (_QWORD *)v9 )
        break;
LABEL_36:
      sub_52FA4(
        *(_DWORD *)(BugCheckParameter2 + 24),
        (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v6++ + 104),
        v19);
      v7 += 10;
      if ( v6 >= *(_DWORD *)(BugCheckParameter2 + 4) )
      {
        v3 = v20;
        goto LABEL_38;
      }
    }
    v10 = off_60148;
    while ( 1 )
    {
      v11 = (ULONG_PTR)v8;
      v8 = (_QWORD *)*v8;
      if ( *(_BYTE *)(v11 + 44) )
      {
        if ( v10 == (PDEVICE_OBJECT)&off_60148
          || SBYTE4(v10->DeviceQueue.DeviceListHead.Flink) >= 0
          || BYTE1(v10->DeviceQueue.DeviceListHead.Flink) < 4u )
        {
          goto LABEL_35;
        }
        LODWORD(v16) = *(_DWORD *)(v11 + 40);
        sub_11230(*(_QWORD *)&v10->AlignmentRequirement, 0x39u, (__int64)&unk_5CBD0, *(_QWORD *)(v11 + 16), v16);
      }
      else
      {
        if ( !sub_571E0((_BYTE *)BugCheckParameter2, &v21) )
          v21 = sub_56F18(BugCheckParameter2, v11, 1);
        if ( *(_DWORD *)(v11 + 40) )
        {
          *(_BYTE *)(v11 + 44) = 1;
        }
        else
        {
          v21 = sub_54AB0(BugCheckParameter2, v6, (__int64 *)v11, 0);
          if ( v21 )
          {
            v10 = off_60148;
            if ( off_60148 == (PDEVICE_OBJECT)&off_60148
              || SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) >= 0
              || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 3u )
            {
              goto LABEL_35;
            }
            sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Au, (__int64)&unk_5CBD0);
          }
          else
          {
            sub_54CBC(BugCheckParameter2, (__int64)&v17, v11);
          }
        }
      }
      v10 = off_60148;
LABEL_35:
      if ( v8 == (_QWORD *)v9 )
        goto LABEL_36;
    }
  }
LABEL_38:
  sub_54E3C(BugCheckParameter2, (__int64)&v17, v3);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Bu, (__int64)&unk_5CBD0);
  }
  v12 = sub_55088(BugCheckParameter2, &v21);
  if ( v12 )
  {
    Interval.QuadPart = -5000000i64;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Cu, (__int64)&unk_5CBD0, v12);
    }
    for ( i = 0; i < 10; ++i )
    {
      if ( !(unsigned int)sub_55088(BugCheckParameter2, &v21) )
        break;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Du, (__int64)&unk_5CBD0, i);
      }
      KeDelayExecutionThread(0, 0, &Interval);
    }
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Eu, (__int64)&unk_5CBD0);
  }
  for ( j = 0; j < *(_DWORD *)(BugCheckParameter2 + 4); ++j )
    sub_53164(BugCheckParameter2, BugCheckParameter2 + 16 * (5i64 * j + 5), 1);
  sub_3F95C(*(PVOID *)(BugCheckParameter2 + 72));
  sub_3F6F0((PVOID)BugCheckParameter2, *(_DWORD *)(BugCheckParameter2 + 12));
  v15 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x3Fu, (__int64)&unk_5CBD0);
      v15 = off_60148;
    }
    if ( v15 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v15->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v15->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&v15->AlignmentRequirement, 0x40u, (__int64)&unk_5CBD0);
    }
  }
  return v21;
}
// 53AEA: variable 'v16' is possibly undefined

//----- (0000000000053DDC) ----------------------------------------------------
__int64 __fastcall sub_53DDC(__int64 a1, __int64 a2, unsigned __int64 a3)
{
  __int64 v3; // rdi
  unsigned int v4; // ebp
  PDEVICE_OBJECT v6; // rcx
  __int64 result; // rax
  int v8; // esi
  unsigned __int64 v9; // rbx
  PDEVICE_OBJECT v10; // rcx
  int i; // esi
  __int64 v12; // rsi
  __int64 **v13; // r12
  __int64 *v14; // r13
  __int64 *v15; // rbx
  PDEVICE_OBJECT v16; // rcx
  __int64 v17; // [rsp+30h] [rbp-88h] BYREF
  _BYTE v18[72]; // [rsp+38h] [rbp-80h] BYREF
  unsigned int v19; // [rsp+C0h] [rbp+8h] BYREF
  int v20; // [rsp+C4h] [rbp+Ch]
  union _LARGE_INTEGER Interval; // [rsp+D8h] [rbp+20h] BYREF

  v20 = HIDWORD(a1);
  v3 = qword_613E8;
  v4 = 0;
  v17 = 0i64;
  v19 = 0;
  memset(v18, 0, sizeof(v18));
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x41u, (__int64)&unk_5CBD0, a3);
    v6 = off_60148;
  }
  if ( v3 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_52B10(*(_QWORD *)&v6->AlignmentRequirement, 0x43u, (__int64)&unk_5CBD0, *(_DWORD *)(v3 + 4));
      v6 = off_60148;
    }
    if ( a3 < 0x1F4 )
    {
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_2F80C(*(_QWORD *)&v6->AlignmentRequirement, 0x48u, (__int64)&unk_5CBD0, a3);
      }
    }
    else
    {
      if ( v6 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_2F80C(*(_QWORD *)&v6->AlignmentRequirement, 0x44u, (__int64)&unk_5CBD0, a3);
      }
      v8 = sub_55088(v3, &v19);
      if ( v8 )
      {
        Interval.QuadPart = -5000000i64;
        v9 = a3 / 0x1F4;
        v10 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
        {
          if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x45u, (__int64)&unk_5CBD0, v9);
            v10 = off_60148;
          }
          if ( v10 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(v10->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
            && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 3u )
          {
            sub_112FC(*(_QWORD *)&v10->AlignmentRequirement, 0x46u, (__int64)&unk_5CBD0, v8);
          }
        }
        for ( i = 0; i < v9; ++i )
        {
          if ( !(unsigned int)sub_55088(v3, &v19) )
            break;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x47u, (__int64)&unk_5CBD0, i);
          }
          KeDelayExecutionThread(0, 0, &Interval);
        }
      }
      v4 = v19;
    }
    v12 = 0i64;
    if ( *(_DWORD *)(v3 + 4) )
    {
      v13 = (__int64 **)(v3 + 80);
      do
      {
        sub_52EE0(*(_DWORD *)(v3 + 24), (struct _FAST_MUTEX *)(v3 + 80 * v12 + 104), (KIRQL *)&v19);
        v14 = *v13;
        while ( v14 != (__int64 *)(v3 + 80 * v12 + 80) )
        {
          v15 = v14;
          v14 = (__int64 *)*v14;
          v4 = sub_54AB0(v3, v12, v15, 1);
          if ( !v4 )
            sub_54CBC(v3, (__int64)&v17, (__int64)v15);
        }
        sub_52FA4(*(_DWORD *)(v3 + 24), (struct _FAST_MUTEX *)(v3 + 80 * v12 + 104), v19);
        v12 = (unsigned int)(v12 + 1);
        v13 += 10;
      }
      while ( (unsigned int)v12 < *(_DWORD *)(v3 + 4) );
    }
    sub_54E3C(v3, (__int64)&v17, 1);
    v16 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x49u, (__int64)&unk_5CBD0);
        v16 = off_60148;
      }
      if ( v16 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v16->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(v16->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v16->AlignmentRequirement, 0x4Au, (__int64)&unk_5CBD0);
      }
    }
    result = v4;
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x42u, (__int64)&unk_5CBD0);
    }
    result = 3i64;
  }
  return result;
}

//----- (00000000000541A0) ----------------------------------------------------
__int64 __fastcall sub_541A0(ULONG_PTR BugCheckParameter2)
{
  unsigned int v1; // esi
  PDEVICE_OBJECT v3; // rcx
  __int64 result; // rax
  __int64 v5; // rbp
  _QWORD **v6; // r13
  int v7; // ecx
  struct _FAST_MUTEX *v8; // r15
  _QWORD *v9; // r12
  ULONG_PTR v10; // r14
  ULONG_PTR v11; // rbx
  PDEVICE_OBJECT v12; // rcx
  __int64 v13; // [rsp+20h] [rbp-98h]
  __int64 v14; // [rsp+30h] [rbp-88h] BYREF
  _BYTE v15[72]; // [rsp+38h] [rbp-80h] BYREF
  KIRQL v16; // [rsp+C0h] [rbp+8h] BYREF
  unsigned int v17; // [rsp+D0h] [rbp+18h] BYREF
  struct _FAST_MUTEX *v18; // [rsp+D8h] [rbp+20h]

  v1 = 0;
  v14 = 0i64;
  v17 = 0;
  memset(v15, 0, sizeof(v15));
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x4Bu, (__int64)&unk_5CBD0);
    v3 = off_60148;
  }
  if ( BugCheckParameter2 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_52B10(*(_QWORD *)&v3->AlignmentRequirement, 0x4Du, (__int64)&unk_5CBD0, *(_DWORD *)(BugCheckParameter2 + 4));
    }
    v5 = 0i64;
    if ( *(_DWORD *)(BugCheckParameter2 + 4) )
    {
      v6 = (_QWORD **)(BugCheckParameter2 + 80);
      do
      {
        v7 = *(_DWORD *)(BugCheckParameter2 + 24);
        v8 = (struct _FAST_MUTEX *)(80 * v5 + BugCheckParameter2 + 104);
        v18 = v8;
        sub_52EE0(v7, v8, &v16);
        v9 = *v6;
        v10 = 80 * v5 + BugCheckParameter2 + 80;
        if ( *v6 != (_QWORD *)v10 )
        {
          do
          {
            v11 = (ULONG_PTR)v9;
            v9 = (_QWORD *)*v9;
            if ( *(_BYTE *)(v11 + 44) )
            {
              if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
                && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
              {
                LODWORD(v13) = *(_DWORD *)(v11 + 40);
                sub_11230(
                  *(_QWORD *)&off_60148->AlignmentRequirement,
                  0x4Eu,
                  (__int64)&unk_5CBD0,
                  *(_QWORD *)(v11 + 16),
                  v13);
              }
            }
            else
            {
              if ( sub_571E0((_BYTE *)BugCheckParameter2, &v17) )
              {
                v1 = v17;
              }
              else
              {
                v1 = sub_56F18(BugCheckParameter2, v11, 1);
                v17 = v1;
              }
              if ( *(_DWORD *)(v11 + 40) )
              {
                *(_BYTE *)(v11 + 44) = 1;
              }
              else
              {
                v1 = sub_54AB0(BugCheckParameter2, v5, (__int64 *)v11, 0);
                v17 = v1;
                if ( !v1 )
                  sub_54CBC(BugCheckParameter2, (__int64)&v14, v11);
              }
            }
          }
          while ( v9 != (_QWORD *)v10 );
          v8 = v18;
        }
        sub_52FA4(*(_DWORD *)(BugCheckParameter2 + 24), v8, v16);
        v5 = (unsigned int)(v5 + 1);
        v6 += 10;
      }
      while ( (unsigned int)v5 < *(_DWORD *)(BugCheckParameter2 + 4) );
    }
    sub_54E3C(BugCheckParameter2, (__int64)&v14, 1);
    v12 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x4Fu, (__int64)&unk_5CBD0);
        v12 = off_60148;
      }
      if ( v12 != (PDEVICE_OBJECT)&off_60148
        && (BYTE4(v12->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(v12->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v12->AlignmentRequirement, 0x50u, (__int64)&unk_5CBD0);
      }
    }
    result = v1;
  }
  else
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v3->AlignmentRequirement, 0x4Cu, (__int64)&unk_5CBD0);
    }
    result = 3i64;
  }
  return result;
}
// 54333: variable 'v13' is possibly undefined

//----- (0000000000054480) ----------------------------------------------------
__int64 __fastcall sub_54480(__int64 a1, int a2)
{
  PDEVICE_OBJECT v4; // rcx
  unsigned int v6; // ebp
  _QWORD **v7; // r12
  __int64 v8; // rbx
  struct _FAST_MUTEX *v9; // r14
  _QWORD *v10; // rsi
  __int64 v11; // r13
  __int64 v12; // rbx
  __int64 v13; // r9
  PDEVICE_OBJECT v14; // rcx
  PDEVICE_OBJECT v15; // rcx
  __int64 v16; // [rsp+60h] [rbp-88h] BYREF
  _BYTE v17[72]; // [rsp+68h] [rbp-80h] BYREF
  KIRQL v18; // [rsp+F0h] [rbp+8h] BYREF
  unsigned int v19; // [rsp+108h] [rbp+20h] BYREF

  v19 = 0;
  v16 = 0i64;
  memset(v17, 0, sizeof(v17));
  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x51u, (__int64)&unk_5CBD0);
    v4 = off_60148;
  }
  if ( !a1 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x52u, (__int64)&unk_5CBD0);
    }
    return 3i64;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_52B10(*(_QWORD *)&v4->AlignmentRequirement, 0x53u, (__int64)&unk_5CBD0, *(_DWORD *)(a1 + 4));
  }
  if ( !sub_5732C((_BYTE *)a1, &v19) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x54u, (__int64)&unk_5CBD0);
    }
    return 11i64;
  }
  v6 = 0;
  if ( *(_DWORD *)(a1 + 4) )
  {
    v7 = (_QWORD **)(a1 + 80);
    while ( 1 )
    {
      v8 = 80i64 * v6;
      v9 = (struct _FAST_MUTEX *)(v8 + a1 + 104);
      sub_52EE0(*(_DWORD *)(a1 + 24), v9, &v18);
      v10 = *v7;
      v11 = v8 + a1 + 80;
      if ( *v7 != (_QWORD *)v11 )
        break;
LABEL_42:
      sub_52FA4(*(_DWORD *)(a1 + 24), v9, v18);
      ++v6;
      v7 += 10;
      if ( v6 >= *(_DWORD *)(a1 + 4) )
        goto LABEL_43;
    }
    while ( 1 )
    {
      v12 = (__int64)v10;
      v10 = (_QWORD *)*v10;
      if ( *(_BYTE *)(v12 + 45) )
      {
        v13 = *(_QWORD *)(v12 + 48);
        if ( MEMORY[0xFFFFF78000000014] > v13 + (unsigned int)(10000 * a2) )
        {
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
          {
            sub_23244(
              *(_QWORD *)&off_60148->AlignmentRequirement,
              0x55u,
              (__int64)&unk_5CBD0,
              *(_QWORD *)(v12 + 16),
              v13,
              (unsigned int)(10000 * a2),
              MEMORY[0xFFFFF78000000014]);
          }
          v19 = sub_54AB0(a1, v6, (__int64 *)v12, 1);
          if ( !v19 )
          {
            --*(_QWORD *)(a1 + 32);
            sub_54CBC(a1, (__int64)&v16, v12);
            goto LABEL_36;
          }
          v14 = off_60148;
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
          {
            if ( SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
              && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
            {
              sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x56u, (__int64)&unk_5CBD0, *(_QWORD *)(a1 + 32));
LABEL_36:
              v14 = off_60148;
            }
            if ( v14 != (PDEVICE_OBJECT)&off_60148
              && SBYTE4(v14->DeviceQueue.DeviceListHead.Flink) < 0
              && BYTE1(v14->DeviceQueue.DeviceListHead.Flink) >= 4u )
            {
              sub_2F80C(*(_QWORD *)&v14->AlignmentRequirement, 0x57u, (__int64)&unk_5CBD0, *(_QWORD *)(a1 + 32));
            }
            goto LABEL_41;
          }
        }
      }
LABEL_41:
      if ( v10 == (_QWORD *)v11 )
        goto LABEL_42;
    }
  }
LABEL_43:
  sub_54E3C(a1, (__int64)&v16, 1);
  v15 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x58u, (__int64)&unk_5CBD0);
      v15 = off_60148;
    }
    if ( v15 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v15->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v15->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&v15->AlignmentRequirement, 0x59u, (__int64)&unk_5CBD0);
    }
  }
  return v19;
}

//----- (000000000005482C) ----------------------------------------------------
unsigned __int64 __fastcall sub_5482C(__int64 a1, unsigned __int64 a2, _DWORD *a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int64 result; // rax

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x5Au, (__int64)&unk_5CBD0);
    v6 = off_60148;
  }
  *a3 = 0;
  if ( a1 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x5Cu, (__int64)&unk_5CBD0);
    }
    result = a2 % *(unsigned int *)(a1 + 4);
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v6->AlignmentRequirement, 0x5Bu, (__int64)&unk_5CBD0);
    }
    *a3 = 3;
    result = 0xFFFFFFFFi64;
  }
  return result;
}

//----- (0000000000054928) ----------------------------------------------------
_DWORD *__fastcall sub_54928(__int64 a1, __int64 a2, _DWORD *a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  _DWORD *v9; // rax
  _DWORD *v10; // rdi
  __int64 v11; // r11

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x5Du, (__int64)&unk_5CBD0);
    v6 = off_60148;
  }
  *a3 = 0;
  if ( !a1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v7 = 94;
LABEL_10:
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_5CBD0);
LABEL_11:
    *a3 = 3;
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v7 = 95;
    goto LABEL_10;
  }
  v9 = sub_3FA7C(*(_QWORD *)(a1 + 72));
  v10 = v9;
  if ( !v9 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x60u, (__int64)&unk_5CBD0);
    }
    *a3 = 2;
    return 0i64;
  }
  memset(v9, 0, 0x38ui64);
  v11 = *(_QWORD *)(a1 + 16);
  *((_QWORD *)v10 + 4) = a2;
  *((_QWORD *)v10 + 3) = v11;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x61u, (__int64)&unk_5CBD0);
  }
  return v10;
}

//----- (0000000000054AB0) ----------------------------------------------------
__int64 __fastcall sub_54AB0(__int64 a1, unsigned int a2, __int64 *a3, char a4)
{
  __int64 v6; // rbp
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  __int64 result; // rax
  _QWORD *v11; // rax
  __int64 v12; // rcx
  signed __int32 v13; // eax
  PDEVICE_OBJECT v14; // rcx
  __int64 v15; // [rsp+20h] [rbp-28h]
  unsigned int v16; // [rsp+50h] [rbp+8h] BYREF

  v16 = 0;
  v6 = a2;
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x62u, (__int64)&unk_5CBD0);
    v8 = off_60148;
  }
  if ( !a1 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v8->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v9 = 99;
LABEL_10:
    sub_11008(*(_QWORD *)&v8->AlignmentRequirement, v9, (__int64)&unk_5CBD0);
    return 3i64;
  }
  if ( !a3 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v8->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v9 = 100;
    goto LABEL_10;
  }
  if ( v8 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v8->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11230(*(_QWORD *)&v8->AlignmentRequirement, 0x65u, (__int64)&unk_5CBD0, a3[2], *((_DWORD *)a3 + 10));
  }
  if ( a4 || !sub_5732C((_BYTE *)a1, &v16) )
  {
    v11 = (_QWORD *)a3[1];
    v12 = *a3;
    *v11 = *a3;
    *(_QWORD *)(v12 + 8) = v11;
    --*(_DWORD *)(a1 + 80 * v6 + 96);
    v13 = _InterlockedDecrement((volatile signed __int32 *)(a1 + 8));
    v14 = off_60148;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        LODWORD(v15) = *(_DWORD *)(a1 + 80 * v6 + 96);
        sub_25CAC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x67u, (__int64)&unk_5CBD0, a3[2], v15, v13);
        v14 = off_60148;
      }
      if ( v14 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(v14->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(v14->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v14->AlignmentRequirement, 0x68u, (__int64)&unk_5CBD0);
      }
    }
    result = v16;
  }
  else
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x66u, (__int64)&unk_5CBD0);
    }
    result = 12i64;
  }
  return result;
}
// 54C62: variable 'v15' is possibly undefined

//----- (0000000000054CBC) ----------------------------------------------------
__int64 __fastcall sub_54CBC(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  __int64 *v7; // rax
  __int64 result; // rax
  int v9; // [rsp+20h] [rbp-18h]

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x69u, (__int64)&unk_5CBD0);
    v6 = off_60148;
  }
  if ( a1 && a2 && a3 )
  {
    if ( !*(_DWORD *)(a2 + 16) )
    {
      sub_53038(a1, a2, 0);
      v6 = off_60148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v9 = *(_DWORD *)(a3 + 40);
      sub_11230(*(_QWORD *)&v6->AlignmentRequirement, 0x6Bu, (__int64)&unk_5CBD0, *(_QWORD *)(a3 + 16), v9);
    }
    v7 = *(__int64 **)(a2 + 8);
    *(_QWORD *)a3 = a2;
    *(_QWORD *)(a3 + 8) = v7;
    *v7 = a3;
    ++*(_DWORD *)(a2 + 16);
    *(_QWORD *)(a2 + 8) = a3;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Cu, (__int64)&unk_5CBD0);
    }
    result = 0i64;
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_385D4(*(_QWORD *)&v6->AlignmentRequirement, 0x6Au, (__int64)&unk_5CBD0, a1, a2, a3);
    }
    result = 3i64;
  }
  return result;
}

//----- (0000000000054E3C) ----------------------------------------------------
__int64 __fastcall sub_54E3C(__int64 a1, __int64 a2, char a3)
{
  unsigned int v6; // edi
  PDEVICE_OBJECT v7; // rcx
  __int64 *v8; // r12
  __int64 *v9; // rsi
  __int64 *v10; // rax
  __int64 v11; // rcx
  __int64 v12; // rcx
  void (__fastcall *v13)(__int64); // rax

  v6 = 0;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Du, (__int64)&unk_5CBD0);
    v7 = off_60148;
  }
  if ( a1 && a2 )
  {
    if ( !*(_DWORD *)(a2 + 16) )
    {
      v6 = 4;
      goto LABEL_30;
    }
    v8 = *(__int64 **)a2;
    if ( *(_QWORD *)a2 == a2 )
    {
LABEL_30:
      sub_53164(a1, a2, 0);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x72u, (__int64)&unk_5CBD0);
      }
      return v6;
    }
    while ( 1 )
    {
      v9 = v8;
      v8 = (__int64 *)*v8;
      v10 = (__int64 *)v9[1];
      v11 = *v9;
      *v10 = *v9;
      *(_QWORD *)(v11 + 8) = v10;
      --*(_DWORD *)(a2 + 16);
      if ( !a3 )
        goto LABEL_24;
      v12 = v9[4];
      if ( v12 )
      {
        v13 = *(void (__fastcall **)(__int64))(a1 + 56);
        if ( v13 )
        {
          v13(v12);
LABEL_24:
          if ( off_60148 != (PDEVICE_OBJECT)&off_60148
            && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
            && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x71u, (__int64)&unk_5CBD0, v9[2]);
          }
          sub_3FAE4(*(_QWORD *)(a1 + 72), (__int64)v9);
          goto LABEL_29;
        }
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x70u, (__int64)&unk_5CBD0);
        }
        v6 = 5;
      }
      else
      {
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x6Fu, (__int64)&unk_5CBD0);
        }
        v6 = 6;
      }
LABEL_29:
      if ( *(_QWORD *)a2 == a2 )
        goto LABEL_30;
    }
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v7->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_1D3B0(*(_QWORD *)&v7->AlignmentRequirement, 0x6Eu, (__int64)&unk_5CBD0, a1, a2);
  }
  return 3i64;
}

//----- (0000000000055088) ----------------------------------------------------
__int64 __fastcall sub_55088(__int64 a1, _DWORD *a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  unsigned __int32 v6; // ebx

  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x73u, (__int64)&unk_5CBD0);
    v4 = off_60148;
  }
  *a2 = 0;
  if ( a1 )
  {
    v6 = _InterlockedExchangeAdd((volatile signed __int32 *)(a1 + 8), 0);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x75u, (__int64)&unk_5CBD0);
    }
    result = v6;
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0x74u, (__int64)&unk_5CBD0);
    }
    *a2 = 3;
    result = 0i64;
  }
  return result;
}

//----- (0000000000055180) ----------------------------------------------------
__int64 __fastcall sub_55180(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4)
{
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  __int64 result; // rax
  ULONG_PTR v11; // rax
  PDEVICE_OBJECT v12; // rcx
  unsigned int v13; // ebx
  __int64 v14; // [rsp+60h] [rbp+8h] BYREF

  LODWORD(v14) = 0;
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x86u, (__int64)&unk_5CBD0);
    v8 = off_60148;
  }
  if ( a4 )
  {
    *a4 = 0i64;
    v8 = off_60148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v8->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v9 = 135;
LABEL_12:
    sub_11008(*(_QWORD *)&v8->AlignmentRequirement, v9, (__int64)&unk_5CBD0);
    return 3i64;
  }
  if ( !a3 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v8->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v9 = 136;
    goto LABEL_12;
  }
  if ( _InterlockedCompareExchange((volatile signed __int32 *)(BugCheckParameter2 + 28), 0, 0) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x89u, (__int64)&unk_5CBD0);
    }
    result = 9i64;
  }
  else
  {
    v11 = sub_55D94(BugCheckParameter2, a2, a3, a4, (__int64)&v14);
    if ( v11 )
    {
      if ( v11 == a3 )
      {
        v13 = v14;
        v12 = off_60148;
      }
      else
      {
        if ( a4 )
          sub_56A10(BugCheckParameter2, (ULONG_PTR)*a4);
        v12 = off_60148;
        if ( off_60148 != (PDEVICE_OBJECT)&off_60148
          && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
          && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x8Bu, (__int64)&unk_5CBD0, a2);
          v12 = off_60148;
        }
        v13 = 7;
      }
      if ( v12 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(v12->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(v12->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v12->AlignmentRequirement, 0x8Cu, (__int64)&unk_5CBD0);
      }
      result = v13;
    }
    else
    {
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0x8Au, (__int64)&unk_5CBD0, v14);
      }
      result = (unsigned int)v14;
    }
  }
  return result;
}

//----- (00000000000553BC) ----------------------------------------------------
__int64 __fastcall sub_553BC(__int64 a1, unsigned __int64 a2, __int64 a3, _DWORD *a4)
{
  ULONG_PTR v4; // rbx
  __int64 v5; // rbp
  PDEVICE_OBJECT v8; // rcx
  __int64 v10; // r14
  struct _FAST_MUTEX *v11; // r13
  _QWORD *v12; // rax
  __int64 v13; // rsi
  int v14; // eax
  __int64 v15; // [rsp+20h] [rbp-78h] BYREF
  _BYTE v16[72]; // [rsp+28h] [rbp-70h] BYREF
  __int64 v17; // [rsp+A0h] [rbp+8h] BYREF

  v17 = a1;
  v4 = qword_64DB8;
  v5 = 0i64;
  v15 = 0i64;
  memset(v16, 0, sizeof(v16));
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x93u, (__int64)&unk_5CBD0);
    v8 = off_60148;
  }
  *a4 = 0;
  if ( !v4 )
  {
    if ( v8 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v8->AlignmentRequirement, 0x94u, (__int64)&unk_5CBD0);
    }
    *a4 = 3;
    return 0i64;
  }
  if ( sub_571E0((_BYTE *)v4, a4) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && (BYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x95u, (__int64)&unk_5CBD0);
    }
    *a4 = 10;
    return 0i64;
  }
  v10 = (unsigned int)sub_5482C(v4, a2, a4);
  v11 = (struct _FAST_MUTEX *)(v4 + 80 * v10 + 104);
  sub_52EE0(*(_DWORD *)(v4 + 24), v11, (KIRQL *)&v17);
  v12 = sub_55BD4(v4, v10, a2, a4);
  v13 = (__int64)v12;
  if ( v12 )
  {
    if ( *a4 == 8 )
    {
      sub_52FA4(*(_DWORD *)(v4 + 24), v11, v17);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0x96u, (__int64)&unk_5CBD0, a2, v15);
      }
      return 0i64;
    }
    sub_56F18(v4, (ULONG_PTR)v12, 0);
    v5 = *(_QWORD *)(v13 + 32);
    if ( *(_DWORD *)(v13 + 40) )
    {
      *(_BYTE *)(v13 + 44) = 1;
    }
    else
    {
      v14 = sub_54AB0(v4, v10, (__int64 *)v13, 0);
      *a4 = v14;
      if ( !v14 )
        sub_54CBC(v4, (__int64)&v15, v13);
    }
  }
  sub_52FA4(*(_DWORD *)(v4 + 24), v11, v17);
  sub_54E3C(v4, (__int64)&v15, 1);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x97u, (__int64)&unk_5CBD0);
  }
  return v5;
}

//----- (0000000000055648) ----------------------------------------------------
__int64 __fastcall sub_55648(__int64 a1, ULONG_PTR a2)
{
  ULONG_PTR v2; // rsi
  PDEVICE_OBJECT v4; // rcx
  struct _FAST_MUTEX *v5; // rdi
  __int64 v6; // rbx
  __int64 result; // rax
  int v8; // [rsp+40h] [rbp+8h] BYREF
  int v9; // [rsp+44h] [rbp+Ch]

  v9 = HIDWORD(a1);
  v8 = 0;
  v2 = qword_613E8;
  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x98u, (__int64)&unk_5CBD0);
    v4 = off_60148;
  }
  if ( v2 && a2 )
  {
    v5 = (struct _FAST_MUTEX *)(v2 + 80i64 * (unsigned int)sub_5482C(v2, *(_QWORD *)(a2 + 16), &v8) + 104);
    sub_52EE0(*(_DWORD *)(v2 + 24), v5, (KIRQL *)&v8);
    sub_58254(v2, a2);
    v6 = *(_QWORD *)(a2 + 32);
    sub_52FA4(*(_DWORD *)(v2 + 24), v5, v8);
    result = v6;
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_1D3B0(*(_QWORD *)&v4->AlignmentRequirement, 0x99u, (__int64)&unk_5CBD0, v2, a2);
    }
    result = 0i64;
  }
  return result;
}

//----- (000000000005575C) ----------------------------------------------------
__int64 __fastcall sub_5575C(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, __int64 a3, _DWORD *a4)
{
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  __int64 v10; // r13
  struct _FAST_MUTEX *v11; // r12
  __int64 v12; // rbp
  int v13; // eax
  __int64 v14; // [rsp+20h] [rbp-68h] BYREF
  _BYTE v15[72]; // [rsp+28h] [rbp-60h] BYREF
  KIRQL v16; // [rsp+90h] [rbp+8h] BYREF

  v14 = 0i64;
  memset(v15, 0, sizeof(v15));
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x9Au, (__int64)&unk_5CBD0);
    v7 = off_60148;
  }
  *a4 = 0;
  if ( !BugCheckParameter2 )
  {
    if ( v7 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v7->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v8 = 155;
LABEL_10:
    sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_5CBD0);
LABEL_11:
    *a4 = 3;
    return 0i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v7 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v7->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v8 = 156;
    goto LABEL_10;
  }
  if ( sub_571E0((_BYTE *)BugCheckParameter2, a4) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x9Du, (__int64)&unk_5CBD0);
    }
    *a4 = 10;
    return 0i64;
  }
  v10 = (unsigned int)sub_5482C(BugCheckParameter2, *(_QWORD *)(BugCheckParameter1 + 16), a4);
  v11 = (struct _FAST_MUTEX *)(BugCheckParameter2 + 80 * v10 + 104);
  sub_52EE0(*(_DWORD *)(BugCheckParameter2 + 24), v11, &v16);
  if ( *(_BYTE *)(BugCheckParameter1 + 44) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_2F80C(
        *(_QWORD *)&off_60148->AlignmentRequirement,
        0x9Eu,
        (__int64)&unk_5CBD0,
        *(_QWORD *)(BugCheckParameter1 + 16),
        v14);
    }
    sub_52FA4(*(_DWORD *)(BugCheckParameter2 + 24), v11, v16);
    *a4 = 8;
    return 0i64;
  }
  sub_56F18(BugCheckParameter2, BugCheckParameter1, 0);
  v12 = *(_QWORD *)(BugCheckParameter1 + 32);
  if ( *(_DWORD *)(BugCheckParameter1 + 40) )
  {
    *(_BYTE *)(BugCheckParameter1 + 44) = 1;
  }
  else
  {
    v13 = sub_54AB0(BugCheckParameter2, v10, (__int64 *)BugCheckParameter1, 0);
    *a4 = v13;
    if ( !v13 )
      sub_54CBC(BugCheckParameter2, (__int64)&v14, BugCheckParameter1);
  }
  sub_52FA4(*(_DWORD *)(BugCheckParameter2 + 24), v11, v16);
  sub_54E3C(BugCheckParameter2, (__int64)&v14, 1);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x9Fu, (__int64)&unk_5CBD0);
  }
  return v12;
}

//----- (00000000000559E0) ----------------------------------------------------
__int64 __fastcall sub_559E0(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, _QWORD *a3, _DWORD *a4)
{
  __int64 v8; // r12
  PDEVICE_OBJECT v9; // rcx
  unsigned int v11; // ebx
  struct _FAST_MUTEX *v12; // r13
  _QWORD *v13; // rax
  _QWORD *v14; // rbx
  KIRQL v15; // [rsp+50h] [rbp+8h] BYREF

  v8 = 0i64;
  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xACu, (__int64)&unk_5CBD0);
    v9 = off_60148;
  }
  *a4 = 4;
  if ( a3 )
  {
    *a3 = 0i64;
    v9 = off_60148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v9->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v9->AlignmentRequirement, 0xADu, (__int64)&unk_5CBD0);
    }
    *a4 = 3;
    return 0i64;
  }
  v11 = sub_5482C(BugCheckParameter2, a2, a4);
  v12 = (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v11 + 104);
  sub_52EE0(*(_DWORD *)(BugCheckParameter2 + 24), v12, &v15);
  v13 = sub_55BD4(BugCheckParameter2, v11, a2, a4);
  v14 = v13;
  if ( v13 )
  {
    if ( *a4 == 8 )
    {
      sub_52FA4(*(_DWORD *)(BugCheckParameter2 + 24), v12, v15);
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0xAEu, (__int64)&unk_5CBD0, a2);
      }
      return 0i64;
    }
    v8 = v13[4];
    if ( a3 )
    {
      sub_56DD4(BugCheckParameter2, (ULONG_PTR)v13, 0);
      *a3 = v14;
    }
  }
  sub_52FA4(*(_DWORD *)(BugCheckParameter2 + 24), v12, v15);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xAFu, (__int64)&unk_5CBD0);
  }
  return v8;
}

//----- (0000000000055BD4) ----------------------------------------------------
_QWORD *__fastcall sub_55BD4(__int64 a1, unsigned int a2, __int64 a3, _DWORD *a4)
{
  __int64 v6; // r12
  _QWORD *v8; // rsi
  PDEVICE_OBJECT v9; // rcx
  _QWORD *result; // rax
  _QWORD *v11; // rdx
  _QWORD *v12; // rbx

  v6 = a2;
  v8 = 0i64;
  v9 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xB0u, (__int64)&unk_5CBD0);
    v9 = off_60148;
  }
  *a4 = 4;
  if ( a1 )
  {
    v11 = (_QWORD *)(a1 + 16 * (5 * v6 + 5));
    if ( (_QWORD *)*v11 != v11 )
    {
      v12 = (_QWORD *)*v11;
      while ( v12 != v11 )
      {
        v8 = v12;
        if ( v12[2] == a3 )
        {
          if ( v9 != (PDEVICE_OBJECT)&off_60148
            && SBYTE4(v9->DeviceQueue.DeviceListHead.Flink) < 0
            && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 4u )
          {
            sub_11148(*(_QWORD *)&v9->AlignmentRequirement, 0xB2u, (__int64)&unk_5CBD0, v6);
            v9 = off_60148;
          }
          if ( *((_BYTE *)v12 + 44) )
          {
            if ( v9 != (PDEVICE_OBJECT)&off_60148
              && SBYTE4(v9->DeviceQueue.DeviceListHead.Flink) < 0
              && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 4u )
            {
              sub_2F80C(*(_QWORD *)&v9->AlignmentRequirement, 0xB3u, (__int64)&unk_5CBD0, v12[2]);
              v9 = off_60148;
            }
            *a4 = 8;
          }
          else
          {
            *a4 = 0;
          }
          break;
        }
        v12 = (_QWORD *)*v12;
        v8 = 0i64;
      }
    }
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v9->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&v9->AlignmentRequirement, 0xB4u, (__int64)&unk_5CBD0);
    }
    result = v8;
  }
  else
  {
    if ( v9 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v9->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v9->AlignmentRequirement, 0xB1u, (__int64)&unk_5CBD0);
    }
    *a4 = 3;
    result = 0i64;
  }
  return result;
}

//----- (0000000000055D94) ----------------------------------------------------
ULONG_PTR __fastcall sub_55D94(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4, __int64 a5)
{
  ULONG_PTR v9; // r12
  unsigned int v10; // er14
  PDEVICE_OBJECT v11; // rcx
  _DWORD *v12; // rbp
  int v14; // ebx
  unsigned int v15; // edi
  __int64 v16; // r14
  ULONG_PTR *v17; // rax
  ULONG_PTR *v18; // rdi
  ULONG_PTR *v19; // rax
  ULONG_PTR v20; // rcx
  ULONG_PTR **v21; // rax
  ULONG_PTR v22; // [rsp+20h] [rbp-58h]
  int v23[4]; // [rsp+40h] [rbp-38h] BYREF
  int v24; // [rsp+80h] [rbp+8h]

  v9 = 0i64;
  v23[0] = 0;
  v10 = 0;
  v11 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xB5u, (__int64)&unk_5CBD0);
    v11 = off_60148;
  }
  v12 = (_DWORD *)a5;
  if ( !a5 )
  {
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v11->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v11->AlignmentRequirement, 0xB6u, (__int64)&unk_5CBD0);
    }
    return 0i64;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v11->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v11->AlignmentRequirement, 0xB7u, (__int64)&unk_5CBD0);
    }
    *v12 = 3;
    return 0i64;
  }
  if ( !a3 )
  {
    if ( v11 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v11->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v11->AlignmentRequirement, 0xB8u, (__int64)&unk_5CBD0);
    }
    v14 = 3;
    goto LABEL_37;
  }
  if ( _InterlockedCompareExchange((volatile signed __int32 *)(BugCheckParameter2 + 28), 0, 0) )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xB9u, (__int64)&unk_5CBD0);
    }
    *v12 = 9;
    return 0i64;
  }
  v15 = sub_5482C(BugCheckParameter2, a2, v23);
  v24 = v15;
  v16 = 10i64 * v15;
  sub_52EE0(
    *(_DWORD *)(BugCheckParameter2 + 24),
    (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v15 + 104),
    (KIRQL *)&a5);
  if ( sub_57094((_BYTE *)BugCheckParameter2, v23)
    || (v17 = sub_55BD4(BugCheckParameter2, v15, a2, v23), (v18 = v17) == 0i64) )
  {
    v19 = (ULONG_PTR *)sub_54928(BugCheckParameter2, a3, v23);
    v18 = v19;
    if ( !v19 )
    {
      v14 = 2;
      if ( off_60148 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xBCu, (__int64)&unk_5CBD0);
      }
      goto LABEL_36;
    }
    v19[2] = a2;
    if ( !sub_571E0((_BYTE *)BugCheckParameter2, v23) )
      sub_56DD4(BugCheckParameter2, (ULONG_PTR)v18, 1);
    v20 = BugCheckParameter2 + 8 * v16 + 80;
    v21 = *(ULONG_PTR ***)(BugCheckParameter2 + 8 * v16 + 88);
    *v18 = v20;
    v18[1] = (ULONG_PTR)v21;
    *v21 = v18;
    *(_QWORD *)(v20 + 8) = v18;
    ++*(_DWORD *)(BugCheckParameter2 + 8 * v16 + 96);
    _InterlockedIncrement((volatile signed __int32 *)(BugCheckParameter2 + 8));
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      v10 = v24;
      v22 = v18[2];
      sub_52B6C(*(_QWORD *)&off_60148->AlignmentRequirement, 189i64, (__int64)&unk_5CBD0, v24);
      v14 = v23[0];
      goto LABEL_59;
    }
    v14 = v23[0];
LABEL_58:
    v10 = v24;
LABEL_59:
    v9 = v18[4];
    if ( a4 )
    {
      sub_56DD4(BugCheckParameter2, (ULONG_PTR)v18, 1);
      *a4 = v18;
    }
    goto LABEL_37;
  }
  sub_58254(BugCheckParameter2, (ULONG_PTR)v17);
  v14 = v23[0];
  if ( v23[0] != 8 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148 && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0 )
    {
      v10 = v24;
      if ( BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v22 = v18[2];
        sub_11148(*(_QWORD *)&off_60148->AlignmentRequirement, 0xBBu, (__int64)&unk_5CBD0, v24);
      }
      goto LABEL_59;
    }
    goto LABEL_58;
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0xBAu, (__int64)&unk_5CBD0, a2);
  }
LABEL_36:
  v10 = v24;
LABEL_37:
  sub_52FA4(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v10 + 104), a5);
  *v12 = v14;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    LODWORD(v22) = v14;
    sub_11230(*(_QWORD *)&off_60148->AlignmentRequirement, 0xBEu, (__int64)&unk_5CBD0, v9, v22);
  }
  return v9;
}
// 56045: variable 'v22' is possibly undefined

//----- (000000000005621C) ----------------------------------------------------
__int64 __fastcall sub_5621C(ULONG_PTR BugCheckParameter2, ULONG_PTR *a2, _DWORD *a3)
{
  __int64 v6; // rdi
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  unsigned int v10; // ebp
  _QWORD **v11; // r13
  _QWORD *v12; // r11
  ULONG_PTR v13; // rbx
  KIRQL v14; // [rsp+50h] [rbp+8h] BYREF

  v6 = 0i64;
  v7 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xBFu, (__int64)&unk_5CBD0);
    v7 = off_60148;
  }
  *a3 = 0;
  if ( !BugCheckParameter2 )
  {
    if ( v7 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v7->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v8 = 192;
LABEL_10:
    sub_11008(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_5CBD0);
LABEL_11:
    *a3 = 3;
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v7 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v7->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v8 = 193;
    goto LABEL_10;
  }
  *a2 = 0i64;
  v10 = 0;
  if ( *(_DWORD *)(BugCheckParameter2 + 4) )
  {
    v11 = (_QWORD **)(BugCheckParameter2 + 80);
LABEL_19:
    sub_52EE0(
      *(_DWORD *)(BugCheckParameter2 + 24),
      (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v10 + 104),
      &v14);
    v12 = *v11;
    do
    {
      if ( v12 == (_QWORD *)(BugCheckParameter2 + 80i64 * v10 + 80) )
      {
        sub_52FA4(
          *(_DWORD *)(BugCheckParameter2 + 24),
          (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v10++ + 104),
          v14);
        v11 += 10;
        if ( v10 >= *(_DWORD *)(BugCheckParameter2 + 4) )
          goto LABEL_25;
        goto LABEL_19;
      }
      v13 = (ULONG_PTR)v12;
      v12 = (_QWORD *)*v12;
    }
    while ( *(_BYTE *)(v13 + 44) );
    *a2 = v13;
    sub_56DD4(BugCheckParameter2, v13, 1);
    v6 = *(_QWORD *)(v13 + 32);
    sub_52FA4(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v10 + 104), v14);
LABEL_25:
    v7 = off_60148;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v7->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v7->AlignmentRequirement, 0xC2u, (__int64)&unk_5CBD0);
  }
  return v6;
}

//----- (00000000000563E8) ----------------------------------------------------
__int64 __fastcall sub_563E8(ULONG_PTR BugCheckParameter2, ULONG_PTR *a2, char a3, _DWORD *a4)
{
  ULONG_PTR v4; // r14
  __int64 v5; // rdi
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  __int64 v11; // r12
  ULONG_PTR v12; // rsi
  struct _FAST_MUTEX *v13; // r15
  _QWORD *v14; // r13
  int v15; // eax
  int v16; // eax
  ULONG_PTR v17; // rbp
  ULONG_PTR v18; // r14
  __int64 v19; // [rsp+20h] [rbp-88h] BYREF
  _BYTE v20[72]; // [rsp+28h] [rbp-80h] BYREF
  KIRQL v21; // [rsp+B0h] [rbp+8h] BYREF
  ULONG_PTR *v22; // [rsp+B8h] [rbp+10h]
  char v23; // [rsp+C0h] [rbp+18h]

  v23 = a3;
  v22 = a2;
  v4 = *a2;
  v5 = 0i64;
  v19 = 0i64;
  memset(v20, 0, sizeof(v20));
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xC3u, (__int64)&unk_5CBD0);
    v8 = off_60148;
  }
  *a4 = 0;
  if ( !BugCheckParameter2 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v8->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v9 = 196;
LABEL_10:
    sub_11008(*(_QWORD *)&v8->AlignmentRequirement, v9, (__int64)&unk_5CBD0);
LABEL_11:
    *a4 = 3;
    return 0i64;
  }
  if ( !v4 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v8->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v9 = 197;
    goto LABEL_10;
  }
  LODWORD(v11) = sub_5482C(BugCheckParameter2, *(_QWORD *)(v4 + 16), a4);
  v12 = BugCheckParameter2 + 16 * (5i64 * (unsigned int)v11 + 5);
  v13 = (struct _FAST_MUTEX *)(v12 + 24);
  sub_52EE0(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v12 + 24), &v21);
  v14 = *(_QWORD **)v4;
  v15 = sub_56F18(BugCheckParameter2, v4, 1);
  *a4 = v15;
  if ( !v15 && !*(_DWORD *)(v4 + 40) )
  {
    v16 = sub_54AB0(BugCheckParameter2, v11, (__int64 *)v4, 0);
    *a4 = v16;
    if ( !v16 )
      sub_54CBC(BugCheckParameter2, (__int64)&v19, v4);
  }
  if ( v14 != (_QWORD *)v12 )
    goto LABEL_24;
  sub_52FA4(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v12 + 24), v21);
  v11 = (unsigned int)(v11 + 1);
  if ( (unsigned int)v11 < *(_DWORD *)(BugCheckParameter2 + 4) )
  {
    v12 = BugCheckParameter2 + 16 * (5 * v11 + 5);
    v13 = (struct _FAST_MUTEX *)(v12 + 24);
    sub_52EE0(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v12 + 24), &v21);
    v14 = *(_QWORD **)v12;
LABEL_24:
    v17 = BugCheckParameter2 + 16 * (5i64 * (int)v11 + 5);
    do
    {
      while ( v14 == (_QWORD *)v12 )
      {
        sub_52FA4(*(_DWORD *)(BugCheckParameter2 + 24), v13, v21);
        LODWORD(v11) = v11 + 1;
        v17 += 80i64;
        if ( (unsigned int)v11 >= *(_DWORD *)(BugCheckParameter2 + 4) )
          goto LABEL_30;
        v13 = (struct _FAST_MUTEX *)(v17 + 24);
        v12 = v17;
        sub_52EE0(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v17 + 24), &v21);
        v14 = *(_QWORD **)v17;
      }
      v18 = (ULONG_PTR)v14;
      v14 = (_QWORD *)*v14;
    }
    while ( *(_BYTE *)(v18 + 44) );
    *v22 = v18;
    sub_56DD4(BugCheckParameter2, v18, 1);
    v5 = *(_QWORD *)(v18 + 32);
    sub_52FA4(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v12 + 24), v21);
  }
LABEL_30:
  sub_54E3C(BugCheckParameter2, (__int64)&v19, v23);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xC6u, (__int64)&unk_5CBD0);
  }
  return v5;
}

//----- (00000000000566A8) ----------------------------------------------------
__int64 __fastcall sub_566A8(__int64 a1, ULONG_PTR a2, __int64 a3, _DWORD *a4)
{
  ULONG_PTR v4; // rbp
  __int64 v5; // rdi
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  struct _FAST_MUTEX *v11; // r12
  __int64 v12; // [rsp+50h] [rbp+8h] BYREF

  v12 = a1;
  v4 = qword_613E8;
  v5 = 0i64;
  *a4 = 0;
  v8 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xC7u, (__int64)&unk_5CBD0);
    v8 = off_60148;
  }
  if ( !v4 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v8->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v9 = 200;
LABEL_10:
    sub_11008(*(_QWORD *)&v8->AlignmentRequirement, v9, (__int64)&unk_5CBD0);
LABEL_11:
    *a4 = 3;
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v8->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v9 = 201;
    goto LABEL_10;
  }
  v11 = (struct _FAST_MUTEX *)(v4 + 80i64 * (unsigned int)sub_5482C(v4, *(_QWORD *)(a2 + 16), a4) + 104);
  sub_52EE0(*(_DWORD *)(v4 + 24), v11, (KIRQL *)&v12);
  if ( *(_BYTE *)(a2 + 44) )
  {
    *a4 = 8;
  }
  else
  {
    sub_56DD4(v4, a2, 0);
    v5 = *(_QWORD *)(a2 + 32);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0xCAu, (__int64)&unk_5CBD0, *(_QWORD *)(a2 + 16));
    }
  }
  sub_52FA4(*(_DWORD *)(v4 + 24), v11, v12);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xCBu, (__int64)&unk_5CBD0);
  }
  return v5;
}

//----- (0000000000056864) ----------------------------------------------------
__int64 __fastcall sub_56864(__int64 a1, ULONG_PTR a2)
{
  ULONG_PTR v2; // rsi
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  unsigned int v6; // ebx
  struct _FAST_MUTEX *v7; // rbp
  unsigned int v8; // ebx
  __int64 v9; // [rsp+20h] [rbp-68h] BYREF
  _BYTE v10[72]; // [rsp+28h] [rbp-60h] BYREF
  __int64 v11; // [rsp+90h] [rbp+8h] BYREF
  unsigned int v12; // [rsp+98h] [rbp+10h] BYREF

  v11 = a1;
  v12 = 0;
  v2 = qword_613E8;
  v9 = 0i64;
  memset(v10, 0, sizeof(v10));
  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xCCu, (__int64)&unk_5CBD0);
    v4 = off_60148;
  }
  if ( a2 )
  {
    v6 = sub_5482C(v2, *(_QWORD *)(a2 + 16), &v12);
    v7 = (struct _FAST_MUTEX *)(v2 + 80i64 * v6 + 104);
    sub_52EE0(*(_DWORD *)(v2 + 24), v7, (KIRQL *)&v11);
    sub_56F18(v2, a2, 1);
    if ( *(_DWORD *)(a2 + 40) )
    {
      v8 = v12;
    }
    else
    {
      v8 = sub_54AB0(v2, v6, (__int64 *)a2, 0);
      if ( !v8 )
        sub_54CBC(v2, (__int64)&v9, a2);
    }
    sub_52FA4(*(_DWORD *)(v2 + 24), v7, v11);
    sub_54E3C(v2, (__int64)&v9, 1);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xCEu, (__int64)&unk_5CBD0);
    }
    result = v8;
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0xCDu, (__int64)&unk_5CBD0);
    }
    result = 3i64;
  }
  return result;
}

//----- (0000000000056A10) ----------------------------------------------------
__int64 __fastcall sub_56A10(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  unsigned int v6; // ebx
  struct _FAST_MUTEX *v7; // rbp
  unsigned int v8; // ebx
  __int64 v9; // [rsp+20h] [rbp-68h] BYREF
  _BYTE v10[72]; // [rsp+28h] [rbp-60h] BYREF
  KIRQL v11; // [rsp+90h] [rbp+8h] BYREF
  unsigned int v12; // [rsp+98h] [rbp+10h] BYREF

  v12 = 0;
  v9 = 0i64;
  memset(v10, 0, sizeof(v10));
  v4 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xCFu, (__int64)&unk_5CBD0);
    v4 = off_60148;
  }
  if ( BugCheckParameter1 )
  {
    v6 = sub_5482C(BugCheckParameter2, *(_QWORD *)(BugCheckParameter1 + 16), &v12);
    v7 = (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v6 + 104);
    sub_52EE0(*(_DWORD *)(BugCheckParameter2 + 24), v7, &v11);
    sub_56F18(BugCheckParameter2, BugCheckParameter1, 0);
    if ( *(_DWORD *)(BugCheckParameter1 + 40) )
    {
      v8 = v12;
    }
    else
    {
      v8 = sub_54AB0(BugCheckParameter2, v6, (__int64 *)BugCheckParameter1, 0);
      if ( !v8 )
        sub_54CBC(BugCheckParameter2, (__int64)&v9, BugCheckParameter1);
    }
    sub_52FA4(*(_DWORD *)(BugCheckParameter2 + 24), v7, v11);
    sub_54E3C(BugCheckParameter2, (__int64)&v9, 1);
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xD1u, (__int64)&unk_5CBD0);
    }
    result = v8;
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v4->AlignmentRequirement, 0xD0u, (__int64)&unk_5CBD0);
    }
    result = 3i64;
  }
  return result;
}

//----- (0000000000056BB4) ----------------------------------------------------
__int64 __fastcall sub_56BB4(__int64 a1, unsigned __int64 a2)
{
  __int64 v2; // rbx
  unsigned int v4; // ebp
  __int64 *v5; // rax
  unsigned int v6; // edi
  __int64 v7; // rsi
  __int64 v9; // [rsp+20h] [rbp-68h] BYREF
  _BYTE v10[72]; // [rsp+28h] [rbp-60h] BYREF
  __int64 v11; // [rsp+90h] [rbp+8h] BYREF
  unsigned int v12; // [rsp+A0h] [rbp+18h] BYREF

  v11 = a1;
  v12 = 0;
  v2 = qword_613E8;
  v9 = 0i64;
  memset(v10, 0, sizeof(v10));
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xD2u, (__int64)&unk_5CBD0);
  }
  v4 = sub_5482C(v2, a2, &v12);
  sub_52EE0(*(_DWORD *)(v2 + 24), (struct _FAST_MUTEX *)(v2 + 80i64 * v4 + 104), (KIRQL *)&v11);
  v5 = sub_55BD4(v2, v4, a2, &v12);
  v6 = v12;
  v7 = (__int64)v5;
  if ( v12 )
  {
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_112FC(*(_QWORD *)&off_60148->AlignmentRequirement, 0xD4u, (__int64)&unk_5CBD0, v12);
    }
  }
  else if ( v5 )
  {
    v6 = sub_54AB0(v2, v4, v5, 1);
    if ( !v6 )
      sub_54CBC(v2, (__int64)&v9, v7);
  }
  else if ( off_60148 != (PDEVICE_OBJECT)&off_60148
         && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
         && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xD3u, (__int64)&unk_5CBD0);
  }
  sub_52FA4(*(_DWORD *)(v2 + 24), (struct _FAST_MUTEX *)(v2 + 80i64 * v4 + 104), v11);
  sub_54E3C(v2, (__int64)&v9, 1);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xD5u, (__int64)&unk_5CBD0);
  }
  return v6;
}

//----- (0000000000056DD4) ----------------------------------------------------
__int64 __fastcall sub_56DD4(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xD6u, (__int64)&unk_5CBD0);
    v6 = off_60148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 215;
LABEL_10:
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_5CBD0);
    return 3i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 216;
    goto LABEL_10;
  }
  if ( !a3 )
  {
    sub_58254(BugCheckParameter2, BugCheckParameter1);
    v6 = off_60148;
  }
  if ( !*(_BYTE *)(BugCheckParameter1 + 45) )
  {
    ++*(_DWORD *)(BugCheckParameter1 + 40);
    v6 = off_60148;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11148(*(_QWORD *)&v6->AlignmentRequirement, 0xD9u, (__int64)&unk_5CBD0, *(_DWORD *)(BugCheckParameter1 + 40));
  }
  return 0i64;
}

//----- (0000000000056F18) ----------------------------------------------------
__int64 __fastcall sub_56F18(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  int v9; // eax
  __int64 v10; // rax
  int v11; // [rsp+40h] [rbp+8h] BYREF

  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_2F80C(
      *(_QWORD *)&off_60148->AlignmentRequirement,
      0xDAu,
      (__int64)&unk_5CBD0,
      *(_QWORD *)(BugCheckParameter1 + 16));
    v6 = off_60148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 219;
LABEL_10:
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_5CBD0);
    return 3i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 220;
    goto LABEL_10;
  }
  if ( !a3 )
    sub_58254(BugCheckParameter2, BugCheckParameter1);
  v9 = *(_DWORD *)(BugCheckParameter1 + 40);
  if ( v9 )
    *(_DWORD *)(BugCheckParameter1 + 40) = v9 - 1;
  v11 = 0;
  if ( sub_5732C((_BYTE *)BugCheckParameter2, &v11)
    && !*(_DWORD *)(BugCheckParameter1 + 40)
    && !*(_BYTE *)(BugCheckParameter1 + 45) )
  {
    v10 = MEMORY[0xFFFFF78000000014];
    *(_BYTE *)(BugCheckParameter1 + 45) = 1;
    *(_QWORD *)(BugCheckParameter1 + 48) = v10;
    ++*(_QWORD *)(BugCheckParameter2 + 32);
  }
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11148(
      *(_QWORD *)&off_60148->AlignmentRequirement,
      0xDDu,
      (__int64)&unk_5CBD0,
      *(_DWORD *)(BugCheckParameter1 + 40));
  }
  return 0i64;
}

//----- (0000000000057094) ----------------------------------------------------
char __fastcall sub_57094(_BYTE *a1, _DWORD *a2)
{
  char v4; // bl
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v7; // dx

  v4 = 0;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xDEu, (__int64)&unk_5CBD0);
    v5 = off_60148;
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 1) != 0 )
    {
      v4 = 1;
      if ( v5 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          v7 = 224;
LABEL_20:
          sub_11008(*(_QWORD *)&v5->AlignmentRequirement, v7, (__int64)&unk_5CBD0);
          v5 = off_60148;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else if ( v5 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v7 = 225;
        goto LABEL_20;
      }
LABEL_21:
      if ( v5 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v5->AlignmentRequirement, 0xE2u, (__int64)&unk_5CBD0);
      }
      return v4;
    }
    return v4;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v5->AlignmentRequirement, 0xDFu, (__int64)&unk_5CBD0);
  }
  *a2 = 3;
  return 0;
}

//----- (00000000000571E0) ----------------------------------------------------
char __fastcall sub_571E0(_BYTE *a1, _DWORD *a2)
{
  char v4; // bl
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v7; // dx

  v4 = 0;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xE3u, (__int64)&unk_5CBD0);
    v5 = off_60148;
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 2) != 0 )
    {
      v4 = 1;
      if ( v5 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          v7 = 229;
LABEL_20:
          sub_11008(*(_QWORD *)&v5->AlignmentRequirement, v7, (__int64)&unk_5CBD0);
          v5 = off_60148;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else if ( v5 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v7 = 230;
        goto LABEL_20;
      }
LABEL_21:
      if ( v5 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v5->AlignmentRequirement, 0xE7u, (__int64)&unk_5CBD0);
      }
      return v4;
    }
    return v4;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v5->AlignmentRequirement, 0xE4u, (__int64)&unk_5CBD0);
  }
  *a2 = 3;
  return 0;
}

//----- (000000000005732C) ----------------------------------------------------
char __fastcall sub_5732C(_BYTE *a1, _DWORD *a2)
{
  char v4; // bl
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v7; // dx

  v4 = 0;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xE8u, (__int64)&unk_5CBD0);
    v5 = off_60148;
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 4) != 0 )
    {
      v4 = 1;
      if ( v5 != (PDEVICE_OBJECT)&off_60148 )
      {
        if ( SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          v7 = 234;
LABEL_20:
          sub_11008(*(_QWORD *)&v5->AlignmentRequirement, v7, (__int64)&unk_5CBD0);
          v5 = off_60148;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else if ( v5 != (PDEVICE_OBJECT)&off_60148 )
    {
      if ( SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v7 = 235;
        goto LABEL_20;
      }
LABEL_21:
      if ( v5 != (PDEVICE_OBJECT)&off_60148
        && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11008(*(_QWORD *)&v5->AlignmentRequirement, 0xECu, (__int64)&unk_5CBD0);
      }
      return v4;
    }
    return v4;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11008(*(_QWORD *)&v5->AlignmentRequirement, 0xE9u, (__int64)&unk_5CBD0);
  }
  *a2 = 3;
  return 0;
}

//----- (0000000000057478) ----------------------------------------------------
__int64 __fastcall sub_57478(__int64 a1)
{
  ULONG_PTR v1; // rdi
  unsigned int v2; // ebp
  PDEVICE_OBJECT v3; // rcx
  __int64 v5; // r12
  _QWORD **v6; // r14
  int v7; // ecx
  _QWORD *v8; // r13
  __int64 v9; // r15
  PDEVICE_OBJECT v10; // rcx
  ULONG_PTR v11; // rbx
  __int64 v12; // rax
  __int64 v13; // rax
  __int64 v14; // rsi
  __int64 v15; // [rsp+20h] [rbp-98h]
  __int64 v16; // [rsp+30h] [rbp-88h] BYREF
  _BYTE v17[72]; // [rsp+38h] [rbp-80h] BYREF
  __int64 v18; // [rsp+C0h] [rbp+8h] BYREF
  unsigned int v19; // [rsp+D0h] [rbp+18h] BYREF
  struct _FAST_MUTEX *v20; // [rsp+D8h] [rbp+20h]

  v18 = a1;
  v1 = qword_64DB8;
  v2 = 0;
  v16 = 0i64;
  v19 = 0;
  memset(v17, 0, sizeof(v17));
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xEDu, (__int64)&unk_5CBD0);
    v3 = off_60148;
  }
  if ( !v1 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v3->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v3->AlignmentRequirement, 0xEEu, (__int64)&unk_5CBD0);
    }
    return 3i64;
  }
  if ( !*(_QWORD *)(v1 + 56) )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v3->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v3->AlignmentRequirement, 0xEFu, (__int64)&unk_5CBD0);
    }
    return 5i64;
  }
  v5 = 0i64;
  if ( *(_DWORD *)(v1 + 4) )
  {
    v6 = (_QWORD **)(v1 + 80);
    while ( 1 )
    {
      v7 = *(_DWORD *)(v1 + 24);
      v20 = (struct _FAST_MUTEX *)(v1 + 80 * v5 + 104);
      sub_52EE0(v7, v20, (KIRQL *)&v18);
      v8 = *v6;
      v9 = v1 + 80 * v5 + 80;
      if ( *v6 != (_QWORD *)v9 )
        break;
LABEL_46:
      sub_52FA4(*(_DWORD *)(v1 + 24), v20, v18);
      v5 = (unsigned int)(v5 + 1);
      v6 += 10;
      if ( (unsigned int)v5 >= *(_DWORD *)(v1 + 4) )
        goto LABEL_47;
    }
    v10 = off_60148;
    while ( 1 )
    {
      v11 = (ULONG_PTR)v8;
      v8 = (_QWORD *)*v8;
      if ( *(_BYTE *)(v11 + 44) )
      {
        if ( v10 == (PDEVICE_OBJECT)&off_60148
          || SBYTE4(v10->DeviceQueue.DeviceListHead.Flink) >= 0
          || BYTE1(v10->DeviceQueue.DeviceListHead.Flink) < 4u )
        {
          goto LABEL_45;
        }
        LODWORD(v15) = *(_DWORD *)(v11 + 40);
        sub_11230(*(_QWORD *)&v10->AlignmentRequirement, 0xF0u, (__int64)&unk_5CBD0, *(_QWORD *)(v11 + 16), v15);
      }
      else
      {
        v12 = *(_QWORD *)(v11 + 24);
        if ( v12 )
        {
          v13 = v12 - 1;
          *(_QWORD *)(v11 + 24) = v13;
          if ( v13 )
          {
            v10 = off_60148;
            if ( off_60148 == (PDEVICE_OBJECT)&off_60148
              || SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) >= 0
              || BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) < 4u )
            {
              goto LABEL_45;
            }
            sub_1D3B0(
              *(_QWORD *)&off_60148->AlignmentRequirement,
              0xF4u,
              (__int64)&unk_5CBD0,
              *(_QWORD *)(v11 + 16),
              v13);
          }
          else
          {
            *(_BYTE *)(v11 + 44) = 1;
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
              && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
            {
              LODWORD(v15) = *(_DWORD *)(v11 + 40);
              sub_11230(
                *(_QWORD *)&off_60148->AlignmentRequirement,
                0xF1u,
                (__int64)&unk_5CBD0,
                *(_QWORD *)(v11 + 16),
                v15);
            }
            if ( !sub_571E0((_BYTE *)v1, &v19) )
              sub_56F18(v1, v11, 1);
            if ( !*(_DWORD *)(v11 + 40) )
            {
              v14 = *(_QWORD *)(v11 + 16);
              if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
                && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
              {
                sub_2F80C(
                  *(_QWORD *)&off_60148->AlignmentRequirement,
                  0xF2u,
                  (__int64)&unk_5CBD0,
                  *(_QWORD *)(v11 + 16));
              }
              v2 = sub_54AB0(v1, v5, (__int64 *)v11, 0);
              v19 = v2;
              if ( !v2 )
                sub_54CBC(v1, (__int64)&v16, v11);
              v10 = off_60148;
              if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
                && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
              {
                LODWORD(v15) = v2;
                sub_11230(*(_QWORD *)&off_60148->AlignmentRequirement, 0xF3u, (__int64)&unk_5CBD0, v14, v15);
                v10 = off_60148;
              }
              goto LABEL_45;
            }
            v2 = v19;
          }
        }
        else
        {
          if ( v10 == (PDEVICE_OBJECT)&off_60148
            || SBYTE4(v10->DeviceQueue.DeviceListHead.Flink) >= 0
            || BYTE1(v10->DeviceQueue.DeviceListHead.Flink) < 4u )
          {
            goto LABEL_45;
          }
          sub_2F80C(*(_QWORD *)&v10->AlignmentRequirement, 0xF5u, (__int64)&unk_5CBD0, *(_QWORD *)(v11 + 16));
        }
      }
      v10 = off_60148;
LABEL_45:
      if ( v8 == (_QWORD *)v9 )
        goto LABEL_46;
    }
  }
LABEL_47:
  sub_54E3C(v1, (__int64)&v16, 1);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xF6u, (__int64)&unk_5CBD0);
  }
  return v2;
}
// 57613: variable 'v15' is possibly undefined

//----- (00000000000578A8) ----------------------------------------------------
__int64 __fastcall sub_578A8(__int64 a1)
{
  ULONG_PTR v1; // rdi
  unsigned int v2; // ebp
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  __int64 v6; // r12
  _QWORD **v7; // r14
  int v8; // ecx
  _QWORD *v9; // r13
  __int64 v10; // r15
  PDEVICE_OBJECT v11; // rcx
  ULONG_PTR v12; // rbx
  __int64 v13; // rax
  __int64 v14; // rax
  __int64 v15; // rax
  __int64 v16; // rsi
  __int64 v17; // [rsp+20h] [rbp-B8h]
  __int64 v18; // [rsp+30h] [rbp-A8h] BYREF
  _QWORD **v19; // [rsp+38h] [rbp-A0h]
  struct _FAST_MUTEX *v20; // [rsp+40h] [rbp-98h]
  __int64 v21; // [rsp+50h] [rbp-88h] BYREF
  _BYTE v22[72]; // [rsp+58h] [rbp-80h] BYREF
  __int64 v23; // [rsp+E0h] [rbp+8h] BYREF
  KIRQL v24; // [rsp+F0h] [rbp+18h] BYREF
  unsigned int v25; // [rsp+F8h] [rbp+20h] BYREF

  v23 = a1;
  v1 = qword_64DC0;
  v2 = 0;
  v18 = 0i64;
  v21 = 0i64;
  LOBYTE(v23) = 1;
  v25 = 0;
  memset(v22, 0, sizeof(v22));
  v3 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0xF7u, (__int64)&unk_5CBD0);
    v3 = off_60148;
  }
  if ( !v1 )
  {
    if ( v3 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v3->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v3->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v4 = 248;
LABEL_10:
    sub_11008(*(_QWORD *)&v3->AlignmentRequirement, v4, (__int64)&unk_5CBD0);
    return 3i64;
  }
  if ( !sub_31058 )
  {
    if ( v3 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v3->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v3->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v4 = 249;
    goto LABEL_10;
  }
  v6 = 0i64;
  if ( !*(_DWORD *)(v1 + 4) )
    goto LABEL_67;
  v7 = (_QWORD **)(v1 + 80);
  v19 = (_QWORD **)(v1 + 80);
  do
  {
    v8 = *(_DWORD *)(v1 + 24);
    v20 = (struct _FAST_MUTEX *)(v1 + 80 * v6 + 104);
    sub_52EE0(v8, v20, &v24);
    v9 = *v7;
    v10 = v1 + 80 * v6 + 80;
    if ( *v7 == (_QWORD *)v10 )
      goto LABEL_55;
    v11 = off_60148;
    do
    {
      v12 = (ULONG_PTR)v9;
      v9 = (_QWORD *)*v9;
      if ( *(_BYTE *)(v12 + 44) )
      {
        if ( v11 != (PDEVICE_OBJECT)&off_60148
          && SBYTE4(v11->DeviceQueue.DeviceListHead.Flink) < 0
          && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          LODWORD(v17) = *(_DWORD *)(v12 + 40);
          sub_11230(*(_QWORD *)&v11->AlignmentRequirement, 0xFAu, (__int64)&unk_5CBD0, *(_QWORD *)(v12 + 16), v17);
LABEL_62:
          v11 = off_60148;
          continue;
        }
      }
      else
      {
        v13 = *(_QWORD *)(v12 + 24);
        if ( v13 )
        {
          v14 = v13 - 1;
          *(_QWORD *)(v12 + 24) = v14;
          if ( v14 )
          {
            v11 = off_60148;
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
              && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
            {
              sub_1D3B0(
                *(_QWORD *)&off_60148->AlignmentRequirement,
                0xFFu,
                (__int64)&unk_5CBD0,
                *(_QWORD *)(v12 + 16),
                v14);
              goto LABEL_62;
            }
          }
          else
          {
            sub_31058(*(int **)(v12 + 32), &v23, &v18);
            if ( !(_BYTE)v23 )
            {
              v15 = v18;
              if ( !v18 )
                v15 = 1i64;
              v18 = v15;
              if ( off_60148 != (PDEVICE_OBJECT)&off_60148
                && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
                && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
              {
                sub_1D3B0(
                  *(_QWORD *)&off_60148->AlignmentRequirement,
                  0xFBu,
                  (__int64)&unk_5CBD0,
                  *(_QWORD *)(v12 + 16),
                  v15);
                v15 = v18;
              }
              *(_QWORD *)(v12 + 24) = v15;
              goto LABEL_62;
            }
            *(_BYTE *)(v12 + 44) = 1;
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
              && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
            {
              LODWORD(v17) = *(_DWORD *)(v12 + 40);
              sub_11230(
                *(_QWORD *)&off_60148->AlignmentRequirement,
                0xFCu,
                (__int64)&unk_5CBD0,
                *(_QWORD *)(v12 + 16),
                v17);
            }
            if ( !sub_571E0((_BYTE *)v1, &v25) )
              sub_56F18(v1, v12, 1);
            if ( *(_DWORD *)(v12 + 40) )
            {
              v2 = v25;
              goto LABEL_62;
            }
            v16 = *(_QWORD *)(v12 + 16);
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
              && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
            {
              sub_2F80C(*(_QWORD *)&off_60148->AlignmentRequirement, 0xFDu, (__int64)&unk_5CBD0, *(_QWORD *)(v12 + 16));
            }
            v2 = sub_54AB0(v1, v6, (__int64 *)v12, 0);
            v25 = v2;
            if ( !v2 )
              sub_54CBC(v1, (__int64)&v21, v12);
            v11 = off_60148;
            if ( off_60148 != (PDEVICE_OBJECT)&off_60148
              && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
              && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
            {
              LODWORD(v17) = v2;
              sub_11230(*(_QWORD *)&off_60148->AlignmentRequirement, 0xFEu, (__int64)&unk_5CBD0, v16, v17);
              v11 = off_60148;
            }
          }
        }
        else if ( v11 != (PDEVICE_OBJECT)&off_60148
               && SBYTE4(v11->DeviceQueue.DeviceListHead.Flink) < 0
               && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_2F80C(*(_QWORD *)&v11->AlignmentRequirement, 0x100u, (__int64)&unk_5CBD0, *(_QWORD *)(v12 + 16));
          goto LABEL_62;
        }
      }
    }
    while ( v9 != (_QWORD *)v10 );
    v7 = v19;
LABEL_55:
    sub_52FA4(*(_DWORD *)(v1 + 24), v20, v24);
    v7 += 10;
    v6 = (unsigned int)(v6 + 1);
    v19 = v7;
  }
  while ( (unsigned int)v6 < *(_DWORD *)(v1 + 4) );
LABEL_67:
  sub_54E3C(v1, (__int64)&v21, 1);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x101u, (__int64)&unk_5CBD0);
  }
  return v2;
}
// 57A43: variable 'v17' is possibly undefined

//----- (0000000000057D60) ----------------------------------------------------
__int64 __fastcall sub_57D60(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  struct _FAST_MUTEX *v9; // rbp
  __int64 v10; // rax
  KIRQL v11; // [rsp+60h] [rbp+8h] BYREF
  unsigned int v12; // [rsp+68h] [rbp+10h] BYREF

  v12 = 0;
  v6 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x102u, (__int64)&unk_5CBD0);
    v6 = off_60148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 259;
LABEL_10:
    sub_11008(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_5CBD0);
    return 3i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_60148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 260;
    goto LABEL_10;
  }
  v9 = (struct _FAST_MUTEX *)(BugCheckParameter2
                            + 80i64
                            * (unsigned int)sub_5482C(BugCheckParameter2, *(_QWORD *)(BugCheckParameter1 + 16), &v12)
                            + 104);
  sub_52EE0(*(_DWORD *)(BugCheckParameter2 + 24), v9, &v11);
  sub_58254(BugCheckParameter2, BugCheckParameter1);
  if ( a3 )
  {
    *(_QWORD *)(BugCheckParameter1 + 24) = a3;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_1D3B0(
        *(_QWORD *)&off_60148->AlignmentRequirement,
        0x105u,
        (__int64)&unk_5CBD0,
        *(_QWORD *)(BugCheckParameter1 + 16),
        a3);
    }
  }
  else
  {
    v10 = *(_QWORD *)(BugCheckParameter2 + 16);
    *(_QWORD *)(BugCheckParameter1 + 24) = v10;
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_1D3B0(
        *(_QWORD *)&off_60148->AlignmentRequirement,
        0x106u,
        (__int64)&unk_5CBD0,
        *(_QWORD *)(BugCheckParameter1 + 16),
        v10);
    }
  }
  sub_52FA4(*(_DWORD *)(BugCheckParameter2 + 24), v9, v11);
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x107u, (__int64)&unk_5CBD0);
  }
  return v12;
}

//----- (0000000000057F30) ----------------------------------------------------
__int64 __fastcall sub_57F30(int a1)
{
  __int64 result; // rax
  int v3; // ebx
  int v4; // ebx
  int v5; // ebx
  int v6; // ebx
  int v7; // ebx
  int v8; // ebx
  int v9; // ebx

  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x108u, (__int64)&unk_5CBD0);
  }
  if ( !a1 )
    return 0i64;
  result = 1i64;
  v3 = a1 - 1;
  if ( v3 )
  {
    v4 = v3 - 1;
    if ( v4 )
    {
      v5 = v4 - 1;
      if ( v5 )
      {
        v6 = v5 - 1;
        if ( v6 )
        {
          v7 = v6 - 1;
          if ( v7 )
          {
            v8 = v7 - 1;
            if ( !v8 || (v9 = v8 - 1) == 0 || v9 == 1 )
              result = 19i64;
          }
          else
          {
            result = 6i64;
          }
        }
        else
        {
          result = 5i64;
        }
      }
      else
      {
        result = 4i64;
      }
    }
    else
    {
      result = 3i64;
    }
  }
  return result;
}

//----- (0000000000057FD0) ----------------------------------------------------
__int64 __fastcall sub_57FD0(unsigned int a1)
{
  PDEVICE_OBJECT v2; // rcx
  unsigned int v3; // ebx
  unsigned int *v4; // rax
  unsigned int v5; // edx

  v2 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x10Au, (__int64)&unk_5CBD0);
    v2 = off_60148;
  }
  v3 = 0;
  v4 = dword_5CBE0;
  v5 = 0;
  while ( *v4 < a1 )
  {
    ++v5;
    ++v4;
    if ( v5 >= 0x1D )
    {
      if ( v2 == (PDEVICE_OBJECT)&off_60148 )
        return v3;
      if ( SBYTE4(v2->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11008(*(_QWORD *)&v2->AlignmentRequirement, 0x10Bu, (__int64)&unk_5CBD0);
LABEL_16:
        v2 = off_60148;
        goto LABEL_17;
      }
      goto LABEL_17;
    }
  }
  v3 = dword_5CBE0[v5];
  if ( v2 == (PDEVICE_OBJECT)&off_60148 )
    return v3;
  if ( SBYTE4(v2->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_112FC(*(_QWORD *)&v2->AlignmentRequirement, 0x10Cu, (__int64)&unk_5CBD0, v3);
    goto LABEL_16;
  }
LABEL_17:
  if ( v2 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(v2->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&v2->AlignmentRequirement, 0x10Du, (__int64)&unk_5CBD0);
  }
  return v3;
}

//----- (0000000000058100) ----------------------------------------------------
__int64 __fastcall sub_58100(__int64 a1, __int64 a2, char a3)
{
  _DWORD *v3; // rbx
  PDEVICE_OBJECT v5; // rcx
  __int64 result; // rax
  __int64 v7; // rcx
  const char *v8; // rax

  v3 = (_DWORD *)qword_613E8;
  v5 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148
    && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x134u, (__int64)&unk_5CBD0);
    v5 = off_60148;
  }
  if ( v3 )
  {
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      v7 = *(_QWORD *)&v5->AlignmentRequirement;
      v8 = "FALSE";
      if ( a3 )
        v8 = "TRUE";
      sub_11908(v7, 0x136u, (__int64)&unk_5CBD0, "DEBUG", v8);
    }
    if ( a3 )
    {
      *v3 |= 4u;
    }
    else
    {
      sub_54480((__int64)v3, 0);
      *v3 &= 0xFFFFFFFB;
    }
    if ( off_60148 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(off_60148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_60148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11008(*(_QWORD *)&off_60148->AlignmentRequirement, 0x138u, (__int64)&unk_5CBD0);
    }
    result = 0i64;
  }
  else
  {
    if ( v5 != (PDEVICE_OBJECT)&off_60148
      && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11008(*(_QWORD *)&v5->AlignmentRequirement, 0x135u, (__int64)&unk_5CBD0);
    }
    result = 3i64;
  }
  return result;
}

//----- (0000000000058254) ----------------------------------------------------
char __fastcall sub_58254(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1)
{
  char result; // al
  int v5; // [rsp+50h] [rbp+18h] BYREF

  v5 = 0;
  result = sub_5732C((_BYTE *)BugCheckParameter2, &v5);
  if ( result )
  {
    if ( *(_BYTE *)(BugCheckParameter1 + 45) )
      KeBugCheckEx(0xDEFECAu, BugCheckParameter1, BugCheckParameter2, 0i64, 0i64);
  }
  return result;
}

//----- (00000000000582AC) ----------------------------------------------------
char __fastcall sub_582AC(PFAST_MUTEX FastMutex)
{
  if ( !FastMutex )
    return 0;
  if ( LOBYTE(FastMutex[1].Contention) )
  {
    sub_40598(FastMutex);
    LOBYTE(FastMutex[1].Contention) = 0;
    sub_40664(FastMutex);
    sub_40B60(*(PVOID *)&FastMutex[1].Count, 0xFFFFFFFF);
  }
  return 1;
}

//----- (000000000005830C) ----------------------------------------------------
char __fastcall sub_5830C(PFAST_MUTEX FastMutex)
{
  char v1; // di
  struct _KEVENT *v4; // rcx

  v1 = 0;
  if ( !FastMutex )
    return 0;
  sub_40598(FastMutex);
  if ( LOBYTE(FastMutex[1].Contention) )
  {
    v4 = *(struct _KEVENT **)&FastMutex[1].Count;
    ++LODWORD(FastMutex[1].Owner);
    sub_403EC(v4);
    v1 = 1;
  }
  sub_40664(FastMutex);
  return v1;
}

//----- (0000000000058374) ----------------------------------------------------
char __fastcall sub_58374(PFAST_MUTEX FastMutex)
{
  if ( !FastMutex || !*(_QWORD *)&FastMutex[1].Count || !LODWORD(FastMutex[1].Owner) )
    return 0;
  sub_40598(FastMutex);
  if ( LODWORD(FastMutex[1].Owner)-- == 1 )
    sub_40384(*(PRKEVENT *)&FastMutex[1].Count);
  sub_40664(FastMutex);
  return 1;
}

//----- (00000000000583D8) ----------------------------------------------------
__int64 __fastcall sub_583D8(_QWORD *a1, _QWORD *a2)
{
  char *v4; // rbx
  NTSTATUS v6; // edi
  IRP *v7; // rax
  struct _IO_STATUS_BLOCK IoStatusBlock; // [rsp+50h] [rbp-58h] BYREF
  _UNICODE_STRING DestinationString; // [rsp+60h] [rbp-48h] BYREF
  struct _KEVENT Event; // [rsp+70h] [rbp-38h] BYREF

  IoStatusBlock.Pointer = 0i64;
  Event.Header.Type = 0;
  IoStatusBlock.Information = 0i64;
  *(_OWORD *)((char *)&Event.Header.Lock + 1) = 0ui64;
  *(_DWORD *)((char *)&Event.Header.WaitListHead.Blink + 1) = 0;
  *(_WORD *)((char *)&Event.Header.WaitListHead.Blink + 5) = 0;
  HIBYTE(Event.Header.WaitListHead.Blink) = 0;
  v4 = (char *)sub_3F66C(2, 0x18u, 0x41434E50u);
  if ( !v4 )
    return 1793i64;
  *(_QWORD *)v4 = 0i64;
  *((_QWORD *)v4 + 1) = 0i64;
  *((_QWORD *)v4 + 2) = 0i64;
  KeInitializeEvent(&Event, SynchronizationEvent, 0);
  RtlInitUnicodeString(&DestinationString, L"\\Device\\NANO\\KNC");
  v6 = IoGetDeviceObjectPointer(&DestinationString, 0x10000000u, (PFILE_OBJECT *)v4, (PDEVICE_OBJECT *)v4 + 1);
  if ( v6
    || (v7 = IoBuildDeviceIoControlRequest(
               0x8BC82004,
               *((PDEVICE_OBJECT *)v4 + 1),
               0i64,
               0,
               v4 + 16,
               8u,
               0,
               &Event,
               &IoStatusBlock),
        (v6 = IofCallDriver(*((PDEVICE_OBJECT *)v4 + 1), v7)) != 0) )
  {
    if ( *(_QWORD *)v4 )
      ObfDereferenceObject(*(PVOID *)v4);
    sub_3F6F0(v4, 0x41434E50u);
    v4 = 0i64;
  }
  else
  {
    *a2 = *((_QWORD *)v4 + 2);
  }
  KeClearEvent(&Event);
  *a1 = v4;
  return v6 != 0 ? 0xE8700002 : 0;
}

//----- (000000000005855C) ----------------------------------------------------
void __fastcall sub_5855C(PVOID P)
{
  PVOID *v1; // rdi

  if ( P )
  {
    v1 = (PVOID *)*((_QWORD *)P + 6);
    *(_BYTE *)P = 0;
    if ( v1 )
    {
      if ( *v1 )
        ObfDereferenceObject(*v1);
      sub_3F6F0(v1, 0x41434E50u);
    }
    sub_3F6F0(P, 0x41434E50u);
  }
}

//----- (00000000000585CC) ----------------------------------------------------
__int64 __fastcall sub_585CC(__int64 a1, __int64 a2)
{
  if ( !a1 )
    return 1799i64;
  if ( a2 )
    return (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, char, _QWORD))(*(_QWORD *)(a1 + 24) + 16i64))(
             **(_QWORD **)(a1 + 24),
             a2,
             0i64,
             0i64,
             1,
             0i64);
  return 1796i64;
}

//----- (0000000000058610) ----------------------------------------------------
__int64 __fastcall sub_58610(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, void *Src)
{
  size_t v5; // rbx
  unsigned int v6; // er12
  PVOID v10; // rax
  void *v11; // r13
  unsigned int v12; // ebx

  v5 = a4;
  v6 = a3;
  if ( !a1 )
    return 1799i64;
  if ( !a2 )
    return 1796i64;
  if ( !a4 || !Src )
    return (unsigned int)(*(__int64 (__fastcall **)(_QWORD, __int64, __int64, _QWORD, _QWORD))(*(_QWORD *)(a1 + 24)
                                                                                             + 24i64))(
                           **(_QWORD **)(a1 + 24),
                           a2,
                           a3,
                           0i64,
                           0i64);
  v10 = sub_3F66C(2, a4, 0x41434E50u);
  v11 = v10;
  if ( !v10 )
    return 1793;
  memmove(v10, Src, v5);
  v12 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, void *, _DWORD))(*(_QWORD *)(a1 + 24) + 24i64))(
          **(_QWORD **)(a1 + 24),
          a2,
          v6,
          (unsigned int)v5,
          v11,
          0);
  sub_3F6F0(v11, 0x41434E50u);
  return v12;
}

//----- (0000000000058778) ----------------------------------------------------
__int64 __fastcall sub_58778(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4)
{
  __int64 result; // rax

  if ( !a1 || !a2 || !a3 )
    goto LABEL_6;
  result = sub_59564(a1, a2, a3, a4);
  if ( (int)result >= 0 )
    return result;
  *a1 = 0;
  if ( (_DWORD)result == -2 )
LABEL_6:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
  return 0xFFFFFFFFi64;
}
// 5A178: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000587C8) ----------------------------------------------------
__int64 sub_587C8(char *a1, unsigned __int64 a2, CHAR *a3, ...)
{
  va_list va; // [rsp+48h] [rbp+20h] BYREF

  va_start(va, a3);
  return sub_58778(a1, a2, a3, (__int64)va);
}

//----- (00000000000587EC) ----------------------------------------------------
__int64 __fastcall sub_587EC(char *a1, unsigned __int64 a2, unsigned __int64 a3, CHAR *a4, __int64 a5)
{
  __int64 result; // rax

  if ( !a4 )
    goto LABEL_12;
  if ( a3 )
  {
    if ( !a1 )
    {
LABEL_12:
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return 0xFFFFFFFFi64;
    }
  }
  else if ( !a1 )
  {
    if ( !a2 )
      return 0i64;
    goto LABEL_12;
  }
  if ( !a2 )
    goto LABEL_12;
  if ( a2 > a3 )
  {
    result = sub_59564(a1, a3 + 1, a4, a5);
    if ( (_DWORD)result == -2 )
      return 0xFFFFFFFFi64;
    goto LABEL_10;
  }
  result = sub_59564(a1, a2, a4, a5);
  if ( (_DWORD)result != -2 )
  {
LABEL_10:
    if ( (int)result >= 0 )
      return result;
    goto LABEL_11;
  }
  if ( a3 == -1i64 )
    return 0xFFFFFFFFi64;
LABEL_11:
  *a1 = 0;
  if ( (_DWORD)result == -2 )
    goto LABEL_12;
  return 0xFFFFFFFFi64;
}
// 5A178: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000058888) ----------------------------------------------------
__int64 sub_58888(char *a1, unsigned __int64 a2, unsigned __int64 a3, CHAR *a4, ...)
{
  va_list va; // [rsp+60h] [rbp+28h] BYREF

  va_start(va, a4);
  return sub_587EC(a1, a2, a3, a4, (__int64)va);
}

//----- (00000000000588AC) ----------------------------------------------------
__int64 __fastcall sub_588AC(void *a1, size_t a2, const void *a3, size_t a4)
{
  unsigned int v8; // ebx

  if ( !a4 )
    return 0i64;
  if ( !a1 )
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 22i64;
  }
  if ( a3 && a2 >= a4 )
  {
    memmove(a1, a3, a4);
    return 0i64;
  }
  memset(a1, 0, a2);
  if ( a3 )
  {
    if ( a2 >= a4 )
      return 22i64;
    v8 = 34;
  }
  else
  {
    v8 = 22;
  }
  nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
  return v8;
}
// 5A178: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000058950) ----------------------------------------------------
__int64 __fastcall sub_58950(_WORD *a1, __int64 a2, __int16 *a3, __int64 a4)
{
  __int16 *v4; // r11
  unsigned int v6; // ebx
  _WORD *v7; // r10
  __int64 v8; // r8
  __int16 v9; // ax
  __int16 v10; // ax

  v4 = a3;
  if ( a4 )
  {
    if ( !a1 )
    {
LABEL_25:
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return 22i64;
    }
  }
  else if ( !a1 )
  {
    if ( !a2 )
      return 0i64;
    goto LABEL_25;
  }
  if ( !a2 )
    goto LABEL_25;
  if ( !a4 )
  {
    *a1 = 0;
    return 0i64;
  }
  if ( a3 )
  {
    v7 = a1;
    v8 = a2;
    if ( a4 == -1 )
    {
      do
      {
        v9 = *v4++;
        *v7++ = v9;
        if ( !v9 )
          break;
        --v8;
      }
      while ( v8 );
    }
    else
    {
      do
      {
        v10 = *v4++;
        *v7++ = v10;
        if ( !v10 )
          break;
        if ( !--v8 )
          break;
        --a4;
      }
      while ( a4 );
      if ( !a4 )
        *v7 = 0;
    }
    if ( v8 )
      return 0i64;
    if ( a4 == -1 )
    {
      a1[a2 - 1] = 0;
      return 80i64;
    }
    v6 = 34;
  }
  else
  {
    v6 = 22;
  }
  *a1 = 0;
  nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
  return v6;
}
// 5A178: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000058A58) ----------------------------------------------------
__int64 __fastcall sub_58A58(char *a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int16 *a4, int *a5)
{
  __int64 result; // rax

  if ( !a4 )
    goto LABEL_12;
  if ( a3 )
  {
    if ( !a1 )
    {
LABEL_12:
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return 0xFFFFFFFFi64;
    }
  }
  else if ( !a1 )
  {
    if ( !a2 )
      return 0i64;
    goto LABEL_12;
  }
  if ( !a2 )
    goto LABEL_12;
  if ( a2 > a3 )
  {
    result = sub_59FC8(a1, a3 + 1, a4, a5);
    if ( (_DWORD)result == -2 )
      return 0xFFFFFFFFi64;
    goto LABEL_10;
  }
  result = sub_59FC8(a1, a2, a4, a5);
  if ( (_DWORD)result != -2 )
  {
LABEL_10:
    if ( (int)result >= 0 )
      return result;
    goto LABEL_11;
  }
  if ( a3 == -1i64 )
    return 0xFFFFFFFFi64;
LABEL_11:
  *(_WORD *)a1 = 0;
  if ( (_DWORD)result == -2 )
    goto LABEL_12;
  return 0xFFFFFFFFi64;
}
// 5A178: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000058B00) ----------------------------------------------------
__int64 sub_58B00(char *a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int16 *a4, ...)
{
  va_list va; // [rsp+60h] [rbp+28h] BYREF

  va_start(va, a4);
  return sub_58A58(a1, a2, a3, a4, (int *)va);
}

//----- (0000000000058BCC) ----------------------------------------------------
__int64 __fastcall sub_58BCC(_BYTE *a1, int a2, __int64 a3, _DWORD *a4)
{
  int v6; // ebx
  _BYTE *v7; // rbp
  __int64 result; // rax

  v6 = a2;
  v7 = a1;
  if ( (*(_BYTE *)(a3 + 24) & 0x40) == 0 || *(_QWORD *)(a3 + 16) )
  {
    if ( a2 > 0 )
    {
      do
      {
        LOBYTE(a1) = *v7;
        --v6;
        result = write_char(a1, a3, a4);
        ++v7;
      }
      while ( *a4 != -1 && v6 > 0 );
    }
  }
  else
  {
    *a4 += a2;
  }
  return result;
}
// 58C0D: variable 'a1' is possibly undefined
// 58B24: using guessed type __int64 __fastcall write_char(_QWORD, _QWORD, _QWORD);

//----- (0000000000058C94) ----------------------------------------------------
__int64 __fastcall sub_58C94(__int64 a1, CHAR *a2, __int64 a3)
{
  int *v3; // r9
  __int64 v5; // r13
  int v6; // esi
  int v7; // er11
  int v8; // edx
  int v9; // er10
  int v10; // er8
  CHAR v12; // di
  int v13; // er14
  int v14; // er12
  CHAR *v15; // rbx
  int v16; // ecx
  __int64 v17; // rcx
  int v18; // eax
  char *i; // rcx
  __int64 v20; // r9
  int v21; // er8
  int v22; // eax
  _BYTE *j; // rcx
  __int64 v24; // rdi
  __int64 v25; // r9
  unsigned int v26; // er15
  char v27; // r13
  CHAR *v28; // rbx
  unsigned __int64 v29; // rdx
  CHAR v30; // al
  int v31; // esp
  int v32; // eax
  __int64 v33; // rdi
  unsigned int v34; // er13
  __int64 v35; // rcx
  WCHAR *v36; // rbp
  int v37; // er12
  int v38; // edi
  __int64 v39; // rcx
  int v40; // eax
  CHAR v41; // al
  __int64 v42; // rcx
  int v43; // [rsp+30h] [rbp-298h]
  unsigned int v44; // [rsp+34h] [rbp-294h] BYREF
  char v45[4]; // [rsp+38h] [rbp-290h] BYREF
  int v46; // [rsp+3Ch] [rbp-28Ch]
  int v47; // [rsp+40h] [rbp-288h]
  int v48; // [rsp+44h] [rbp-284h]
  WCHAR UnicodeString; // [rsp+48h] [rbp-280h] BYREF
  int v50; // [rsp+50h] [rbp-278h]
  int *v51; // [rsp+58h] [rbp-270h]
  __int64 v52; // [rsp+60h] [rbp-268h]
  int v53; // [rsp+68h] [rbp-260h]
  int v54; // [rsp+6Ch] [rbp-25Ch]
  ULONG BytesInMultiByteString; // [rsp+70h] [rbp-258h] BYREF
  ULONG v56; // [rsp+74h] [rbp-254h] BYREF
  CHAR *v57; // [rsp+78h] [rbp-250h]
  CHAR MultiByteString[512]; // [rsp+80h] [rbp-248h] BYREF
  CHAR v59[4]; // [rsp+280h] [rbp-48h] BYREF
  __int16 v60; // [rsp+284h] [rbp-44h]

  v3 = (int *)a3;
  v51 = (int *)a3;
  v5 = a1;
  v52 = a1;
  v53 = 0;
  v6 = 0;
  v7 = 0;
  v47 = 0;
  v8 = 0;
  v43 = 0;
  v9 = 0;
  v46 = 0;
  v10 = 0;
  v48 = 0;
  v50 = 0;
  if ( !a1 || !a2 )
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  v12 = *a2;
  v44 = 0;
  v13 = 0;
  v14 = 0;
  if ( !v12 )
    return v44;
  v15 = v57;
  while ( 1 )
  {
    v57 = ++a2;
    if ( (v44 & 0x80000000) != 0 )
      break;
    if ( (unsigned __int8)(v12 - 32) > 0x58u )
      v16 = 0;
    else
      v16 = byte_5C280[v12 - 32] & 0xF;
    v14 = byte_5C280[9 * v16 + v14] >> 4;
    v54 = v14;
    switch ( v14 )
    {
      case 8:
        goto LABEL_192;
      case 0:
        v42 = 0i64;
        goto LABEL_187;
      case 1:
        v8 = -1;
        v10 = 0;
        v48 = 0;
        v7 = 0;
        v47 = 0;
        v9 = 0;
        v46 = 0;
        v6 = 0;
        v43 = -1;
        v50 = 0;
        break;
      case 2:
        switch ( v12 )
        {
          case ' ':
            v6 |= 2u;
            break;
          case '#':
            v6 |= 0x80u;
            break;
          case '+':
            v6 |= 1u;
            break;
          case '-':
            v6 |= 4u;
            break;
          case '0':
            v6 |= 8u;
            break;
        }
        break;
      case 3:
        if ( v12 == 42 )
        {
          v7 = *v3;
          v51 = v3 + 2;
          v47 = v7;
          if ( v7 >= 0 )
            break;
          v6 |= 4u;
          v7 = -v7;
        }
        else
        {
          v7 = v12 + 10 * v7 - 48;
        }
        v47 = v7;
        break;
      case 4:
        v8 = 0;
LABEL_169:
        v43 = v8;
        break;
      case 5:
        if ( v12 == 42 )
        {
          v8 = *v3;
          v51 = v3 + 2;
          v43 = v8;
          if ( v8 >= 0 )
            break;
          v8 = -1;
        }
        else
        {
          v8 = v12 + 10 * v8 - 48;
        }
        goto LABEL_169;
      case 6:
        switch ( v12 )
        {
          case 'I':
            v41 = *a2;
            v6 |= 0x8000u;
            if ( *a2 == 54 && a2[1] == 52 )
            {
              a2 += 2;
              v6 |= 0x8000u;
              goto LABEL_190;
            }
            if ( v41 == 51 && a2[1] == 50 )
            {
              a2 += 2;
              v6 &= 0xFFFF7FFF;
              goto LABEL_190;
            }
            if ( v41 != 100 && v41 != 105 && v41 != 111 && v41 != 117 && v41 != 120 && v41 != 88 )
            {
              v42 = 0i64;
              v14 = 0;
LABEL_187:
              v50 = 0;
              LOBYTE(v42) = v12;
              write_char(v42, v5, &v44);
              goto LABEL_188;
            }
            break;
          case 'h':
            v6 |= 0x20u;
            break;
          case 'l':
            if ( *a2 == 108 )
            {
              ++a2;
              v6 |= 0x1000u;
            }
            else
            {
              v6 |= 0x10u;
            }
            break;
          case 'w':
            v6 |= 0x800u;
            break;
        }
        break;
      case 7:
        if ( v12 > 105 )
        {
          switch ( v12 )
          {
            case 'n':
              goto LABEL_192;
            case 'o':
              v21 = 8;
              if ( (v6 & 0x80u) != 0 )
                v6 |= 0x200u;
              goto LABEL_83;
            case 'p':
              v43 = 16;
              v6 |= 0x8000u;
              goto LABEL_78;
          }
          if ( v12 != 115 )
          {
            v17 = (unsigned int)(v12 - 117);
            if ( v12 == 117 )
              goto LABEL_57;
            if ( v12 != 120 )
              goto LABEL_27;
            v22 = 39;
            goto LABEL_79;
          }
        }
        else
        {
          if ( v12 == 105 )
            goto LABEL_56;
          v17 = (unsigned int)(v12 - 67);
          if ( v12 == 67 )
          {
            if ( (v6 & 0x830) == 0 )
              v6 |= 0x800u;
            goto LABEL_50;
          }
          if ( v12 != 83 )
          {
            if ( v12 != 88 )
            {
              if ( v12 == 90 )
              {
                v17 = *(_QWORD *)v3;
                v51 = v3 + 2;
                if ( v17 && (v15 = *(CHAR **)(v17 + 8)) != 0i64 )
                {
                  if ( *(_WORD *)(v17 + 2) < *(_WORD *)v17 )
                    goto LABEL_192;
                  v13 = *(unsigned __int16 *)v17;
                  if ( _bittest(&v6, 0xBu) )
                  {
                    if ( (v13 & 1) != 0 || ((unsigned __int8)v15 & 1) != 0 )
                      goto LABEL_192;
                    v13 = *(unsigned __int16 *)v17 >> 1;
                    v50 = 1;
                  }
                  else
                  {
                    v50 = 0;
                  }
                }
                else
                {
                  v15 = SrcCh;
                  v17 = strlen(SrcCh) + 1;
                  v13 = v17 - 1;
                }
                goto LABEL_27;
              }
              v17 = (unsigned int)(v12 - 99);
              if ( v12 != 99 )
              {
                if ( v12 != 100 )
                  goto LABEL_27;
LABEL_56:
                v6 |= 0x40u;
LABEL_57:
                v21 = 10;
LABEL_83:
                if ( _bittest(&v6, 0xFu) || _bittest(&v6, 0xCu) )
                {
                  v24 = *(_QWORD *)v3;
                  v25 = (__int64)(v3 + 2);
                }
                else
                {
                  v25 = (__int64)(v3 + 2);
                  if ( (v6 & 0x20) != 0 )
                  {
                    v51 = (int *)v25;
                    if ( (v6 & 0x40) != 0 )
                      v24 = *(__int16 *)(v25 - 8);
                    else
                      v24 = *(unsigned __int16 *)(v25 - 8);
LABEL_94:
                    if ( (v6 & 0x40) != 0 && v24 < 0 )
                    {
                      v24 = -v24;
                      v6 |= 0x100u;
                    }
                    if ( !_bittest(&v6, 0xFu) && !_bittest(&v6, 0xCu) )
                      v24 = (unsigned int)v24;
                    v26 = v43;
                    if ( v43 >= 0 )
                    {
                      v6 &= 0xFFFFFFF7;
                      if ( v43 > 512 )
                        v26 = 512;
                    }
                    else
                    {
                      v26 = 1;
                    }
                    v27 = v53;
                    v28 = &MultiByteString[511];
                    v9 &= -(v24 != 0);
                    v46 = v9;
                    while ( 1 )
                    {
                      v17 = v26--;
                      if ( (int)v17 <= 0 && !v24 )
                        break;
                      v29 = v24 % (unsigned __int64)v21;
                      v24 /= (unsigned __int64)v21;
                      v30 = v29 + 48;
                      if ( (int)v29 + 48 > 57 )
                        v30 += v27;
                      *v28-- = v30;
                    }
                    v5 = v52;
                    v43 = v26;
                    v32 = v31 + 639 - (_DWORD)v28;
                    v15 = v28 + 1;
                    v13 = v32;
                    if ( _bittest(&v6, 9u) && (!v32 || *v15 != 48) )
                    {
                      --v15;
                      v13 = v32 + 1;
                      *v15 = 48;
                    }
                    v10 = v48;
LABEL_27:
                    if ( !v10 )
                    {
                      if ( (v6 & 0x40) != 0 )
                      {
                        if ( _bittest(&v6, 8u) )
                        {
                          v45[0] = 45;
                          goto LABEL_119;
                        }
                        if ( (v6 & 1) != 0 )
                        {
                          v45[0] = 43;
                          goto LABEL_119;
                        }
                        if ( (v6 & 2) != 0 )
                        {
                          v45[0] = 32;
LABEL_119:
                          v9 = 1;
                          v46 = 1;
                        }
                      }
                      v33 = v52;
                      v34 = v7 - v13 - v9;
                      if ( (v6 & 0xC) == 0 )
                      {
                        LOBYTE(v17) = 32;
                        write_multi_char(v17, v34, v52, &v44);
                        v9 = v46;
                      }
                      sub_58BCC(v45, v9, v33, &v44);
                      if ( (v6 & 8) != 0 && (v6 & 4) == 0 )
                      {
                        LOBYTE(v35) = 48;
                        write_multi_char(v35, v34, v33, &v44);
                      }
                      if ( v50 && v13 > 0 )
                      {
                        v36 = (WCHAR *)v15;
                        v37 = v13;
                        while ( 1 )
                        {
                          --v37;
                          UnicodeString = *v36;
                          v38 = -1;
                          if ( RtlUnicodeToMultiByteN(v59, 6u, &v56, &UnicodeString, 2u) >= 0 )
                          {
                            v38 = v56;
                            v40 = 0;
                          }
                          else
                          {
                            *(_DWORD *)v59 = 0;
                            v60 = 0;
                            v40 = 42;
                          }
                          ++v36;
                          if ( v40 || !v38 )
                            break;
                          sub_58BCC(v59, v38, v52, &v44);
                          if ( !v37 )
                            goto LABEL_136;
                        }
                        v44 = -1;
LABEL_136:
                        a2 = v57;
                        v14 = v54;
                        v33 = v52;
                      }
                      else
                      {
                        sub_58BCC(v15, v13, v33, &v44);
                      }
                      if ( (v44 & 0x80000000) == 0 && (v6 & 4) != 0 )
                      {
                        LOBYTE(v39) = 32;
                        write_multi_char(v39, v34, v33, &v44);
                      }
                      v5 = v52;
LABEL_188:
                      v10 = v48;
                      v7 = v47;
                      v9 = v46;
                    }
                    v8 = v43;
                    break;
                  }
                  if ( (v6 & 0x40) != 0 )
                    v24 = *(int *)(v25 - 8);
                  else
                    v24 = *(unsigned int *)(v25 - 8);
                }
                v51 = (int *)v25;
                goto LABEL_94;
              }
LABEL_50:
              v20 = (__int64)(v3 + 2);
              v51 = (int *)v20;
              if ( (v6 & 0x810) != 0 )
              {
                UnicodeString = *(_WORD *)(v20 - 8);
                v13 = -1;
                if ( RtlUnicodeToMultiByteN(MultiByteString, 0x200u, &BytesInMultiByteString, &UnicodeString, 2u) >= 0 )
                {
                  v13 = BytesInMultiByteString;
                  v9 = v46;
                  v7 = v47;
                  v10 = v48;
                }
                else
                {
                  memset(MultiByteString, 0, sizeof(MultiByteString));
                  v9 = v46;
                  v7 = v47;
                  v10 = 1;
                  v48 = 1;
                }
              }
              else
              {
                v13 = 1;
                MultiByteString[0] = *(_BYTE *)(v20 - 8);
              }
              v15 = MultiByteString;
              goto LABEL_27;
            }
LABEL_78:
            v22 = 7;
LABEL_79:
            v53 = v22;
            v21 = 16;
            if ( (v6 & 0x80u) != 0 )
            {
              v45[0] = 48;
              v9 = 2;
              v45[1] = v22 + 81;
            }
            goto LABEL_83;
          }
          if ( (v6 & 0x830) == 0 )
            v6 |= 0x800u;
        }
        v15 = *(CHAR **)v3;
        v18 = v8;
        if ( v8 == -1 )
          v18 = 0x7FFFFFFF;
        v51 = v3 + 2;
        if ( (v6 & 0x810) != 0 )
        {
          v50 = 1;
          if ( !v15 )
            v15 = (CHAR *)off_60118;
          for ( i = v15; v18; i += 2 )
          {
            --v18;
            if ( !*(_WORD *)i )
              break;
          }
          v17 = (i - v15) >> 1;
        }
        else
        {
          if ( !v15 )
            v15 = SrcCh;
          for ( j = v15; v18; ++j )
          {
            --v18;
            if ( !*j )
              break;
          }
          v17 = (unsigned int)((_DWORD)j - (_DWORD)v15);
        }
        v13 = v17;
        goto LABEL_27;
      default:
        break;
    }
LABEL_190:
    v12 = *a2;
    if ( !*a2 )
      break;
    v3 = v51;
  }
  if ( v14 && v14 != 7 )
  {
LABEL_192:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  return v44;
}
// 59175: variable 'v31' is possibly undefined
// 591F7: variable 'v17' is possibly undefined
// 5922F: variable 'v35' is possibly undefined
// 5931A: variable 'v39' is possibly undefined
// 58B24: using guessed type __int64 __fastcall write_char(_QWORD, _QWORD, _QWORD);
// 58B74: using guessed type __int64 __fastcall write_multi_char(_QWORD, _QWORD, _QWORD, _QWORD);
// 5A178: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 60118: using guessed type wchar_t *off_60118;

//----- (0000000000059564) ----------------------------------------------------
__int64 __fastcall sub_59564(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4)
{
  __int64 result; // rax
  unsigned int v7; // edi
  FILE File; // [rsp+30h] [rbp-38h] BYREF

  if ( a2 == -1i64 )
  {
    File._cnt = 0x7FFFFFFF;
  }
  else
  {
    if ( a2 > 0x7FFFFFFF )
    {
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return 0xFFFFFFFFi64;
    }
    File._cnt = a2;
  }
  File._base = a1;
  File._ptr = a1;
  File._flag = 66;
  result = sub_58C94((__int64)&File, a3, a4);
  v7 = result;
  a1[a2 - 1] = 0;
  if ( (int)result >= 0 )
  {
    if ( --File._cnt < 0 )
    {
      if ( flsbuf(0, &File) == -1 )
        return 4294967294i64;
    }
    else
    {
      *File._ptr = 0;
    }
    return v7;
  }
  if ( File._cnt < 0 )
    return 4294967294i64;
  if ( a1 )
  {
    if ( a2 )
      *a1 = 0;
  }
  return result;
}
// 5A178: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000059634) ----------------------------------------------------
_WORD *__fastcall sub_59634(__int16 a1, __int64 a2, _DWORD *a3)
{
  _WORD *result; // rax
  __int16 v4; // r9
  bool v5; // sf

  result = (_WORD *)*(unsigned int *)(a2 + 24);
  v4 = a1;
  if ( (((unsigned __int8)result & 0x40) == 0 || *(_QWORD *)(a2 + 16))
    && ((v5 = *(_DWORD *)(a2 + 8) - 2 < 0, *(_DWORD *)(a2 + 8) -= 2, v5) ? (result = (_WORD *)((unsigned int)result | 0x20),
                                                                            v4 = -1,
                                                                            *(_DWORD *)(a2 + 24) = (_DWORD)result) : (result = *(_WORD **)a2, **(_WORD **)a2 = a1, *(_QWORD *)a2 += 2i64),
        v4 == -1 && (*(_BYTE *)(a2 + 24) & 0x20) != 0) )
  {
    *a3 = -1;
  }
  else
  {
    ++*a3;
  }
  return result;
}

//----- (0000000000059684) ----------------------------------------------------
_WORD *__fastcall sub_59684(__int16 *a1, int a2, __int64 a3, _DWORD *a4)
{
  _WORD *result; // rax
  int v8; // er10

  if ( (*(_BYTE *)(a3 + 24) & 0x40) == 0 || *(_QWORD *)(a3 + 16) )
  {
    if ( a2 > 0 )
    {
      do
        result = sub_59634(*a1++, a3, a4);
      while ( *a4 != -1 && v8 > 0 );
    }
  }
  else
  {
    *a4 += a2;
  }
  return result;
}
// 596BD: variable 'a4' is possibly undefined
// 596CF: variable 'v8' is possibly undefined

//----- (00000000000596E4) ----------------------------------------------------
__int64 __fastcall sub_596E4(__int64 a1, unsigned __int16 *a2, int *a3)
{
  __int64 v4; // r12
  int v5; // esi
  int v6; // er11
  int v7; // er9
  int v8; // er10
  unsigned __int16 v10; // di
  int v11; // ebp
  int v12; // er13
  int v13; // er8
  wchar_t *v14; // rbx
  int v15; // ecx
  int v16; // er8
  __int64 v17; // rcx
  unsigned __int16 v18; // ax
  int v19; // ecx
  _BYTE *v20; // rax
  wchar_t v21; // ax
  int v22; // eax
  int v23; // eax
  _WORD *j; // rax
  __int64 v25; // rdi
  char v26; // r12
  char *v27; // rbx
  int v28; // ecx
  unsigned __int64 v29; // rdx
  char v30; // al
  int v31; // esp
  int v32; // eax
  unsigned __int8 v33; // cf
  __int16 v34; // ax
  int v35; // er12
  int v36; // edi
  __int64 v37; // rdx
  __int16 v38; // r10
  __int64 v39; // rdi
  int v40; // edi
  __int64 v41; // rdx
  const char *v42; // rbp
  int v43; // edi
  int v44; // er11
  int v45; // er10
  __int64 v46; // rdx
  __int64 v47; // r11
  bool i; // zf
  int v49; // [rsp+30h] [rbp-498h] BYREF
  int v50; // [rsp+34h] [rbp-494h]
  int v51; // [rsp+38h] [rbp-490h]
  int v52; // [rsp+3Ch] [rbp-48Ch]
  int v53; // [rsp+40h] [rbp-488h]
  __int16 v54[2]; // [rsp+44h] [rbp-484h] BYREF
  int v55; // [rsp+48h] [rbp-480h]
  char SrcCh[4]; // [rsp+4Ch] [rbp-47Ch] BYREF
  __int64 v57; // [rsp+50h] [rbp-478h]
  wchar_t v58; // [rsp+58h] [rbp-470h] BYREF
  wchar_t *v59; // [rsp+60h] [rbp-468h]
  int v60; // [rsp+68h] [rbp-460h]
  int v61; // [rsp+6Ch] [rbp-45Ch]
  int v62; // [rsp+70h] [rbp-458h]
  wchar_t DstCh[255]; // [rsp+80h] [rbp-448h] BYREF
  char v64; // [rsp+27Fh] [rbp-249h] BYREF

  v4 = a1;
  v57 = a1;
  v61 = 0;
  v5 = 0;
  v6 = 0;
  v52 = 0;
  v7 = 0;
  v51 = 0;
  v8 = 0;
  v50 = 0;
  v60 = 0;
  v53 = 0;
  if ( !a1 || !a2 )
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  v10 = *a2;
  v11 = 0;
  v49 = 0;
  v12 = 0;
  v13 = 0;
  if ( !v10 )
    return (unsigned int)v11;
  v14 = v59;
  do
  {
    v59 = ++a2;
    if ( v11 < 0 )
      break;
    if ( (unsigned __int16)(v10 - 32) > 0x58u )
      v15 = 0;
    else
      v15 = byte_5C280[v10 - 32] & 0xF;
    v13 = byte_5C280[9 * v15 + v13] >> 4;
    v55 = v13;
    switch ( v13 )
    {
      case 8:
        goto LABEL_197;
      case 0:
        goto LABEL_169;
      case 1:
        v7 = -1;
        v51 = -1;
        v60 = 0;
        v6 = 0;
        v52 = 0;
        v8 = 0;
        v50 = 0;
        v5 = 0;
        v53 = 0;
        break;
      case 2:
        switch ( v10 )
        {
          case ' ':
            v5 |= 2u;
            break;
          case '#':
            v5 |= 0x80u;
            break;
          case '+':
            v5 |= 1u;
            break;
          case '-':
            v5 |= 4u;
            break;
          case '0':
            v5 |= 8u;
            break;
        }
        break;
      case 3:
        if ( v10 != 42 )
        {
          v6 = v10 + 10 * v6 - 48;
          goto LABEL_185;
        }
        v6 = *a3;
        a3 += 2;
        v52 = v6;
        if ( v6 < 0 )
        {
          v5 |= 4u;
          v6 = -v6;
LABEL_185:
          v52 = v6;
          break;
        }
        break;
      case 4:
        v7 = 0;
        v51 = 0;
        break;
      case 5:
        if ( v10 == 42 )
        {
          v7 = *a3;
          a3 += 2;
          v51 = v7;
          if ( v7 < 0 )
          {
            v7 = -1;
            v51 = -1;
          }
        }
        else
        {
          v7 = v10 + 10 * v7 - 48;
          v51 = v7;
        }
        break;
      case 6:
        if ( v10 != 73 )
        {
          switch ( v10 )
          {
            case 'h':
              v5 |= 0x20u;
              break;
            case 'l':
              if ( *a2 == 108 )
              {
                ++a2;
                v5 |= 0x1000u;
              }
              else
              {
                v5 |= 0x10u;
              }
              break;
            case 'w':
              v5 |= 0x800u;
              break;
          }
          break;
        }
        v5 |= 0x8000u;
        if ( *a2 == 54 && a2[1] == 52 )
        {
          a2 += 2;
          v5 |= 0x8000u;
        }
        else
        {
          if ( *a2 != 51 || a2[1] != 50 )
          {
            if ( *a2 == 100 || *a2 == 105 || *a2 == 111 || *a2 == 117 || *a2 == 120 || *a2 == 88 )
              break;
            v55 = 0;
LABEL_169:
            v53 = 1;
            sub_59634(v10, v4, &v49);
            v11 = v49;
LABEL_170:
            v7 = v51;
            a2 = v59;
LABEL_171:
            v13 = v55;
            break;
          }
          a2 += 2;
          v5 &= 0xFFFF7FFF;
        }
        break;
      case 7:
        if ( v10 > 0x69u )
        {
          switch ( v10 )
          {
            case 'n':
              goto LABEL_197;
            case 'o':
              v16 = 8;
              if ( (v5 & 0x80u) != 0 )
                v5 |= 0x200u;
              goto LABEL_76;
            case 'p':
              v7 = 16;
              v5 |= 0x8000u;
              goto LABEL_71;
          }
          if ( v10 != 115 )
          {
            if ( v10 != 117 )
            {
              if ( v10 != 120 )
                goto LABEL_107;
              v23 = 39;
              goto LABEL_72;
            }
LABEL_28:
            v16 = 10;
LABEL_76:
            if ( _bittest(&v5, 0xFu) || _bittest(&v5, 0xCu) )
            {
              v25 = *(_QWORD *)a3;
              a3 += 2;
            }
            else
            {
              a3 += 2;
              if ( (v5 & 0x20) != 0 )
              {
                if ( (v5 & 0x40) != 0 )
                  v25 = *((__int16 *)a3 - 4);
                else
                  v25 = *((unsigned __int16 *)a3 - 4);
              }
              else if ( (v5 & 0x40) != 0 )
              {
                v25 = *(a3 - 2);
              }
              else
              {
                v25 = (unsigned int)*(a3 - 2);
              }
            }
            if ( (v5 & 0x40) != 0 && v25 < 0 )
            {
              v25 = -v25;
              v5 |= 0x100u;
            }
            if ( !_bittest(&v5, 0xFu) && !_bittest(&v5, 0xCu) )
              v25 = (unsigned int)v25;
            if ( v7 >= 0 )
            {
              v5 &= 0xFFFFFFF7;
              if ( v7 > 512 )
                v7 = 512;
            }
            else
            {
              v7 = 1;
            }
            v26 = v61;
            v27 = &v64;
            v50 = v25 != 0 ? v8 : 0;
            while ( 1 )
            {
              v28 = v7--;
              if ( v28 <= 0 && !v25 )
                break;
              v29 = v25 % (unsigned __int64)v16;
              v25 /= (unsigned __int64)v16;
              v30 = v29 + 48;
              if ( (int)v29 + 48 > 57 )
                v30 += v26;
              *v27-- = v30;
            }
            v8 = v50;
            v4 = v57;
            v32 = v31 + 639 - (_DWORD)v27;
            v14 = (wchar_t *)(v27 + 1);
            v33 = _bittest(&v5, 9u);
            v12 = v32;
            v51 = v7;
            if ( v33 && (!v32 || *(_BYTE *)v14 != 48) )
            {
              v14 = (wchar_t *)((char *)v14 - 1);
              v12 = v32 + 1;
              *(_BYTE *)v14 = 48;
            }
            a2 = v59;
            goto LABEL_107;
          }
        }
        else
        {
          if ( v10 == 105 )
            goto LABEL_27;
          if ( v10 == 67 )
          {
            if ( (v5 & 0x830) == 0 )
              v5 |= 0x20u;
            goto LABEL_51;
          }
          if ( v10 != 83 )
          {
            if ( v10 != 88 )
            {
              if ( v10 == 90 )
              {
                v17 = *(_QWORD *)a3;
                a3 += 2;
                if ( v17 && (v14 = *(wchar_t **)(v17 + 8)) != 0i64 )
                {
                  v18 = *(_WORD *)v17;
                  if ( *(_WORD *)(v17 + 2) < *(_WORD *)v17 )
                    goto LABEL_197;
                  if ( _bittest(&v5, 0xBu) )
                  {
                    if ( (v18 & 1) != 0 || ((unsigned __int8)v14 & 1) != 0 )
                      goto LABEL_197;
                    v12 = v18 >> 1;
                    v53 = 1;
                  }
                  else
                  {
                    v53 = 0;
                    v12 = v18;
                  }
                }
                else
                {
                  v14 = (wchar_t *)::SrcCh;
                  v12 = strlen(::SrcCh);
                }
                goto LABEL_107;
              }
              if ( v10 != 99 )
              {
                if ( v10 == 100 )
                {
LABEL_27:
                  v5 |= 0x40u;
                  goto LABEL_28;
                }
LABEL_107:
                if ( v60 )
                  goto LABEL_171;
                if ( (v5 & 0x40) != 0 )
                {
                  if ( _bittest(&v5, 8u) )
                  {
                    v34 = 45;
                    goto LABEL_115;
                  }
                  if ( (v5 & 1) != 0 )
                  {
                    v34 = 43;
                    goto LABEL_115;
                  }
                  if ( (v5 & 2) != 0 )
                  {
                    v34 = 32;
LABEL_115:
                    v8 = 1;
                    v54[0] = v34;
                    v50 = 1;
                  }
                }
                v35 = v6 - v12 - v8;
                v62 = v35;
                if ( (v5 & 0xC) == 0 )
                {
                  v36 = v6 - v12 - v8;
                  if ( v35 > 0 )
                  {
                    v37 = v57;
                    v38 = 32;
                    do
                    {
                      --v36;
                      sub_59634(v38, v37, &v49);
                    }
                    while ( v49 != -1 && v36 > 0 );
                    v8 = v50;
                  }
                }
                v39 = v57;
                sub_59684(v54, v8, v57, &v49);
                if ( (v5 & 8) != 0 && (v5 & 4) == 0 )
                {
                  v40 = v35;
                  if ( v35 <= 0 )
                  {
                    v39 = v57;
                  }
                  else
                  {
                    v41 = v57;
                    do
                    {
                      --v40;
                      sub_59634(48, v41, &v49);
                    }
                    while ( v49 != -1 && v40 > 0 );
                    v35 = v62;
                    v39 = v41;
                  }
                }
                if ( v53 || v12 <= 0 )
                {
                  sub_59684((__int16 *)v14, v12, v39, &v49);
                  v45 = 0;
LABEL_140:
                  v11 = v49;
                }
                else
                {
                  v42 = (const char *)v14;
                  v43 = v12;
                  while ( 1 )
                  {
                    --v43;
                    v44 = mbtowc(&v58, v42, dword_60120);
                    if ( v44 == 2 )
                      --v43;
                    v45 = 0;
                    if ( v44 <= 0 )
                      break;
                    sub_59634(v58, v57, &v49);
                    v42 += v47;
                    if ( v43 <= v45 )
                    {
                      v39 = v46;
                      goto LABEL_140;
                    }
                  }
                  v39 = v57;
                  v11 = -1;
                  v49 = -1;
                }
                if ( v11 >= v45 )
                {
                  for ( i = (v5 & 4) == 0; !i && v35 > v45; i = v49 == -1 )
                  {
                    --v35;
                    sub_59634(32, v39, &v49);
                    v11 = v49;
                  }
                }
                v8 = v50;
                v6 = v52;
                v4 = v57;
                goto LABEL_170;
              }
LABEL_51:
              v21 = *(_WORD *)a3;
              a3 += 2;
              v58 = v21;
              v53 = 1;
              if ( (v5 & 0x20) != 0 )
              {
                SrcCh[0] = v21;
                SrcCh[1] = 0;
                v22 = mbtowc(DstCh, SrcCh, dword_60120);
                a2 = v59;
                v7 = v51;
                v8 = v50;
                v6 = v52;
                if ( v22 < 0 )
                  v60 = 1;
              }
              else
              {
                DstCh[0] = v21;
              }
              v14 = DstCh;
              v12 = 1;
              goto LABEL_107;
            }
LABEL_71:
            v23 = 7;
LABEL_72:
            v61 = v23;
            v16 = 16;
            if ( (v5 & 0x80u) != 0 )
            {
              v8 = 2;
              v54[0] = 48;
              v54[1] = v23 + 81;
            }
            goto LABEL_76;
          }
          if ( (v5 & 0x830) == 0 )
            v5 |= 0x20u;
        }
        v14 = *(wchar_t **)a3;
        v19 = v7;
        if ( v7 == -1 )
          v19 = 0x7FFFFFFF;
        a3 += 2;
        v12 = 0;
        if ( (v5 & 0x20) != 0 )
        {
          if ( !v14 )
            v14 = (wchar_t *)::SrcCh;
          v20 = v14;
          if ( v19 > 0 )
          {
            do
            {
              if ( !*v20 )
                break;
              ++v12;
              ++v20;
            }
            while ( v12 < v19 );
          }
        }
        else
        {
          v53 = 1;
          if ( !v14 )
            v14 = off_60118;
          for ( j = v14; v19; ++j )
          {
            --v19;
            if ( !*j )
              break;
          }
          v12 = j - v14;
        }
        goto LABEL_107;
    }
    v10 = *a2;
  }
  while ( *a2 );
  if ( v13 && v13 != 7 )
  {
LABEL_197:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  return (unsigned int)v11;
}
// 59B45: variable 'v8' is possibly undefined
// 59B83: variable 'v31' is possibly undefined
// 59C04: variable 'v6' is possibly undefined
// 59C30: variable 'v38' is possibly undefined
// 59C30: variable 'v37' is possibly undefined
// 59C88: variable 'v41' is possibly undefined
// 59CF5: variable 'v47' is possibly undefined
// 59CFB: variable 'v45' is possibly undefined
// 59CFD: variable 'v46' is possibly undefined
// 5A178: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 60118: using guessed type wchar_t *off_60118;
// 60120: using guessed type int dword_60120;

//----- (0000000000059FC8) ----------------------------------------------------
__int64 __fastcall sub_59FC8(char *a1, unsigned __int64 a2, unsigned __int16 *a3, int *a4)
{
  __int64 result; // rax
  unsigned int v7; // ebp
  char *v8; // rax
  FILE File; // [rsp+30h] [rbp-38h] BYREF

  if ( a2 == -1i64 )
  {
    File._cnt = 0x7FFFFFFF;
  }
  else
  {
    if ( a2 > 0x3FFFFFFF )
    {
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return 0xFFFFFFFFi64;
    }
    File._cnt = 2 * a2;
  }
  File._base = a1;
  File._ptr = a1;
  File._flag = 66;
  result = sub_596E4((__int64)&File, a3, a4);
  v7 = result;
  *(_WORD *)&a1[2 * a2 - 2] = 0;
  if ( (int)result >= 0 )
  {
    if ( --File._cnt < 0 )
    {
      if ( flsbuf(0, &File) == -1 )
        return 4294967294i64;
      v8 = File._ptr;
    }
    else
    {
      *File._ptr = 0;
      v8 = ++File._ptr;
    }
    if ( --File._cnt < 0 )
    {
      if ( flsbuf(0, &File) == -1 )
        return 4294967294i64;
    }
    else
    {
      *v8 = 0;
    }
    return v7;
  }
  if ( File._cnt < 0 )
    return 4294967294i64;
  if ( a1 )
  {
    if ( a2 )
      *(_WORD *)a1 = 0;
  }
  return result;
}
// 5A178: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005A678) ----------------------------------------------------
__int64 __fastcall sub_5A678(_WORD *a1, __int64 a2, __int16 *a3)
{
  _WORD *v3; // r9
  unsigned int v4; // ebx
  __int16 v5; // ax
  __int64 result; // rax

  v3 = a1;
  if ( a1 && a2 )
  {
    if ( !a3 )
    {
      v4 = 22;
LABEL_9:
      *v3 = 0;
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return v4;
    }
    do
    {
      v5 = *a3++;
      *a1++ = v5;
      if ( !v5 )
        break;
      --a2;
    }
    while ( a2 );
    if ( !a2 )
    {
      v4 = 34;
      goto LABEL_9;
    }
    result = 0i64;
  }
  else
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    result = 22i64;
  }
  return result;
}
// 5A178: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005A704) ----------------------------------------------------
__int64 __fastcall sub_5A704(char *a1, unsigned __int64 a2, unsigned __int16 *a3, int *a4)
{
  __int64 result; // rax

  if ( !a1 || !a2 || !a3 )
    goto LABEL_6;
  result = sub_59FC8(a1, a2, a3, a4);
  if ( (int)result >= 0 )
    return result;
  *(_WORD *)a1 = 0;
  if ( (_DWORD)result == -2 )
LABEL_6:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
  return 0xFFFFFFFFi64;
}
// 5A178: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005A75C) ----------------------------------------------------
__int64 sub_5A75C(char *a1, unsigned __int64 a2, unsigned __int16 *a3, ...)
{
  va_list va; // [rsp+48h] [rbp+20h] BYREF

  va_start(va, a3);
  return sub_5A704(a1, a2, a3, (int *)va);
}

//----- (0000000000068008) ----------------------------------------------------
__int64 __fastcall sub_68008(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6)
{
  unsigned int *v6; // r13
  unsigned int v7; // er10
  __int64 v10; // rbp
  unsigned int v11; // ebx
  __int64 v12; // rax
  unsigned int v13; // ecx
  unsigned int v14; // eax
  const void **v15; // r14
  unsigned int v16; // er12
  unsigned int v17; // esi
  _WORD *v18; // rcx
  __m128i *v19; // rdi
  __int64 v20; // rcx
  __m128i v21; // xmm0
  __int64 v22; // rbx
  bool v23; // zf
  __int64 v25; // [rsp+30h] [rbp-38h]
  char v26; // [rsp+70h] [rbp+8h] BYREF

  v6 = a6;
  v7 = 0;
  *a6 = 0;
  if ( a1 <= 3u )
    return (unsigned int)-1073741808;
  if ( a1 <= 5u )
  {
    v22 = a5;
    if ( a5 )
    {
      if ( a3 < 0x30 )
        return (unsigned int)-1073741811;
      do
      {
        if ( RtlCompareMemory(*(const void **)(v22 + 8), a4 + 6, 0x10ui64) == 16 )
          break;
        v22 = *(_QWORD *)(v22 + 16);
      }
      while ( v22 );
      if ( v22 )
      {
        v7 = 0;
        if ( a1 == 5 )
        {
          *(_DWORD *)(v22 + 44) = 0;
          *(_QWORD *)(v22 + 24) = 0i64;
          *(_BYTE *)(v22 + 41) = 0;
        }
        else
        {
          v23 = dword_61258 == 2;
          v25 = *((_QWORD *)a4 + 1);
          *(_QWORD *)(v22 + 24) = v25;
          if ( v23 )
          {
            if ( !(unsigned int)qword_61230(3i64, &v26, 4i64, &a6, a4) )
              *(_BYTE *)(v22 + 41) = v26;
            v7 = qword_61230(2i64, v22 + 44, 4i64, &a6, a4);
          }
          else
          {
            *(_DWORD *)(v22 + 44) = HIDWORD(v25);
            *(_BYTE *)(v22 + 41) = BYTE2(v25);
          }
        }
        return v7;
      }
    }
    return (unsigned int)-1073741163;
  }
  if ( a1 <= 7u )
    return v7;
  if ( a1 != 8 )
    return (unsigned int)-1073741808;
  v10 = a5;
  v11 = 0;
  v12 = a5;
  if ( dword_61258 == 1 )
  {
    v13 = a4[4];
    if ( v13 > 1 )
    {
      v14 = 32 * v13 + 24;
      if ( v14 <= a3 )
      {
        *(__m128i *)&a4[8 * v13 - 2] = _mm_loadu_si128((const __m128i *)*(_QWORD *)(a5 + 8));
        a4[8 * a4[4] + 2] = 528384;
        *(_DWORD *)(v10 + 44) = 0;
        *(_BYTE *)(v10 + 41) = 0;
        return v7;
      }
      v7 = -1073741789;
      if ( a3 >= 4 )
      {
        *a4 = v14;
LABEL_10:
        *v6 = 4;
        return v7;
      }
      return v7;
    }
  }
  v15 = *(const void ***)(a5 + 32);
  do
  {
    v12 = *(_QWORD *)(v12 + 16);
    ++v11;
  }
  while ( v12 );
  if ( v11 > 0x3F )
    return (unsigned int)-1073741811;
  if ( v15 )
  {
    v16 = 32 * v11 + 24;
    v17 = *(unsigned __int16 *)v15 + v16 + 2;
  }
  else
  {
    v16 = 0;
    v17 = 32 * v11 + 24;
  }
  if ( v17 > a3 )
  {
    v7 = -1073741789;
    if ( a3 < 4 )
      return v7;
    *a4 = v17;
    goto LABEL_10;
  }
  memset(a4, 0, a3);
  *a4 = v17;
  a4[2] = v16;
  a4[4] = v11;
  if ( v15 )
  {
    v18 = (_WORD *)((char *)a4 + v16);
    *v18 = *(_WORD *)v15;
    memmove(v18 + 1, v15[1], *(unsigned __int16 *)v15);
  }
  if ( v11 )
  {
    v19 = (__m128i *)(a4 + 10);
    v20 = v11;
    do
    {
      v21 = _mm_loadu_si128((const __m128i *)*(_QWORD *)(v10 + 8));
      v19->m128i_i32[0] = 528384;
      v19 += 2;
      v19[-3] = v21;
      *(_DWORD *)(v10 + 44) = 0;
      --v20;
      *(_BYTE *)(v10 + 41) = 0;
      v10 = *(_QWORD *)(v10 + 16);
    }
    while ( v20 );
  }
  v7 = 0;
  *v6 = v17;
  return v7;
}
// 61230: using guessed type __int64 (__fastcall *qword_61230)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 61258: using guessed type int dword_61258;

//----- (00000000000682B4) ----------------------------------------------------
void __fastcall sub_682B4(struct _DEVICE_OBJECT *a1)
{
  PDEVICE_OBJECT v1; // rbx
  ULONG v2; // edx

  v1 = off_60148;
  if ( off_60148 != (PDEVICE_OBJECT)&off_60148 )
  {
    if ( dword_61258 == 4 )
    {
      while ( v1 )
      {
        if ( v1->Vpb )
          qword_61240();
        v1 = v1->NextDevice;
      }
    }
    else
    {
      v2 = 2;
      if ( dword_61258 == 2 )
      {
        v2 = -2147483646;
        a1 = off_60148;
      }
      IoWMIRegistrationControl(a1, v2);
    }
    off_60148 = (PDEVICE_OBJECT)&off_60148;
  }
}
// 61240: using guessed type __int64 (*qword_61240)(void);
// 61258: using guessed type int dword_61258;

// nfuncs=637 queued=619 decompiled=619 lumina nreq=0 worse=0 better=0
// ALL OK, 619 function(s) have been successfully decompiled
