/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall sub_11008(__int64 a1, unsigned __int16 a2, __int64 a3);
__int64 __fastcall sub_1102C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_11068(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_110E0(__int64 a1, __int64 a2, __int64 a3, __int16 a4, __int64 a5);
__int64 __fastcall sub_11234(__int64 a1, char a2, __int64 *a3, __int64 a4);
NTSTATUS __stdcall DriverEntry(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath);
void __fastcall sub_11734(PDEVICE_OBJECT DeviceObject);
__int64 sub_11974();
__int64 __fastcall sub_11AA4(__int64 a1, IRP *a2);
__int64 sub_11ACC();
__int64 __fastcall sub_11EC0(__int64 a1, IRP *a2);
__int64 __fastcall sub_11F6C(__int64 a1, IRP *a2);
void sub_1220C();
__int64 sub_12318();
__int64 sub_1245C();
char __fastcall sub_1264C(int a1, _DWORD *a2, _DWORD *a3, _DWORD *a4);
__int64 __fastcall sub_12754(__int64 a1);
void __fastcall sub_12838(const signed __int32 *a1);
__int64 sub_12954(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_12990(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_129E8();
__int64 sub_12B94();
__int64 sub_12D38();
__int64 sub_12F3C();
__int64 __fastcall sub_13054(__int64 a1, _QWORD *a2);
__int64 sub_134A8();
__int64 __fastcall sub_13620(char a1);
__int64 __fastcall sub_13814(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 sub_13878(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_138C0(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_1392C(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_1399C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_139F0(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_13A50(__int64 a1, __int64 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_13AD0(__int64 a1);
int __fastcall sub_13C54(unsigned __int64 ***a1);
__int64 __fastcall sub_13F3C(__int64 a1, __int64 a2);
__int64 __fastcall sub_141E4(__int64 a1, __int64 a2);
__int64 __fastcall sub_143F8(__int64 a1, __int64 a2);
__int64 __fastcall sub_1465C(__int64 a1);
__int64 __fastcall sub_14A10(_QWORD *a1);
__int64 __fastcall sub_14AFC(__int64 a1);
__int64 __fastcall sub_14D40(__int64 a1, __int64 a2);
__int64 __fastcall sub_1516C(__int64 a1, char *a2, _DWORD *a3);
__int64 __fastcall sub_15394(_QWORD *a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_155B4(__int64 a1, __int64 a2, int a3);
__int64 __fastcall sub_157B4(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_159C8(__int64 a1, __int64 a2, char a3);
__int64 __fastcall sub_15BB8(__int64 a1, int a2, __int64 a3, __int64 a4, int a5, char a6);
__int64 __fastcall sub_15E54(__int64 a1);
__int64 __fastcall sub_1602C(__int64 a1);
__int64 __fastcall sub_1620C(__int64 a1, __int64 a2);
__int64 sub_16420();
__int64 sub_165C8();
__int64 __fastcall sub_166B8(__int64 a1);
__int64 __fastcall sub_167B0(unsigned __int64 a1, unsigned __int64 a2, ULONG_PTR **a3, _DWORD *a4);
__int64 __fastcall sub_16A10(unsigned __int64 a1, _QWORD *a2, _DWORD *a3);
__int64 __fastcall sub_16B70(unsigned __int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_16CB8(ULONG_PTR BugCheckParameter1); // idb
__int64 __fastcall sub_16D60(unsigned __int8 *a1, unsigned int a2);
char __fastcall sub_16D98(_BYTE *a1);
__int64 __fastcall sub_16E6C(__int64 a1, unsigned int a2, char **a3, char **a4, unsigned int *a5);
__int64 __fastcall sub_17518(__int64 a1);
__int64 __fastcall sub_175DC(unsigned __int8 *a1, _BYTE *a2, __int64 a3, __int64 a4);
char __fastcall sub_17B9C(char a1, __int64 a2);
__int64 __fastcall sub_17E40(unsigned int a1, unsigned __int8 *a2, __int64 a3);
__int64 __fastcall sub_18160(unsigned __int8 *a1, __int64 *a2);
__int64 __fastcall sub_18484(__int64 a1, unsigned int *a2);
__int64 __fastcall sub_184EC(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_18A4C(_BYTE *a1, _DWORD *a2);
__int64 __fastcall sub_18C18(_QWORD *a1, _DWORD *a2);
__int64 __fastcall sub_18E18(__int64 a1, _QWORD *a2);
__int64 __fastcall sub_18F90(_WORD *a1, _QWORD *a2);
char __fastcall sub_192C0(__int64 a1);
unsigned __int64 __fastcall sub_19388(_QWORD *a1, unsigned __int64 a2, unsigned __int64 a3);
__int64 sub_19590(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_195E4(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5);
__int64 __fastcall sub_19670(__int64 a1, __int64 a2, __int64 a3, const char *a4);
__int64 sub_19704();
__int64 sub_198C0();
__int64 __fastcall sub_199B0(_QWORD *a1);
_QWORD *__fastcall sub_19AA8(__int64 a1, ULONG_PTR **a2, _DWORD *a3);
__int64 __fastcall sub_19D54(unsigned __int64 a1, _QWORD *a2, _DWORD *a3);
__int64 __fastcall sub_19EB4(unsigned __int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_19FC8(ULONG_PTR BugCheckParameter1); // idb
unsigned __int64 __fastcall sub_1A070(_QWORD *a1, unsigned int a2);
__int64 __fastcall sub_1A140(ULONG_PTR a1);
__int64 __fastcall sub_1A230(__int64 a1);
__int64 sub_1A404();
__int64 __fastcall sub_1A478(__int64 a1, unsigned __int16 a2);
PVOID __fastcall sub_1A4F8(int a1, unsigned int a2, ULONG a3);
void __fastcall sub_1A57C(PVOID P, ULONG Tag);
PVOID __fastcall sub_1A5F0(int a1, void *a2, unsigned int a3, unsigned int a4, ULONG Tag);
char *__fastcall sub_1A778(__int64 a1, unsigned int a2, ULONG a3);
void __fastcall sub_1A930(PVOID P);
_DWORD *__fastcall sub_1AA50(__int64 a1);
void __fastcall sub_1AAB8(__int64 a1, __int64 a2);
__int64 __fastcall sub_1ABE4(PERESOURCE Resource); // idb
__int64 __fastcall sub_1ACB8(PERESOURCE Resource); // idb
BOOLEAN __fastcall sub_1AD8C(PERESOURCE Resource);
BOOLEAN __fastcall sub_1AE64(PERESOURCE Resource);
void __fastcall sub_1AF3C(PERESOURCE Resource);
bool __fastcall sub_1B008(struct _KEVENT **a1, char a2);
void __fastcall sub_1B080(PVOID P);
int __fastcall sub_1B0E8(PRKEVENT Event);
int __fastcall sub_1B150(PRKEVENT Event);
void __fastcall sub_1B21C(__int64 a1);
void __fastcall sub_1B2FC(PFAST_MUTEX FastMutex);
void __fastcall sub_1B3C8(PFAST_MUTEX FastMutex);
__int64 __fastcall sub_1B494(PVOID P); // idb
_QWORD *__fastcall sub_1B508(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_1B67C(PVOID Object); // idb
__int64 __fastcall sub_1B6E8(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_1B778(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_1B814(__int64 a1, __int64 a2, __int64 a3, int a4);
PVOID __fastcall sub_1B8A4(int a1, unsigned int a2, ULONG a3);
void __fastcall sub_1B9C0(PVOID P, ULONG Tag);
_DWORD *__fastcall sub_1BAB8(__int64 a1);
__int64 __fastcall sub_1BBBC(_QWORD *a1);
void __fastcall sub_1BC40(PKSPIN_LOCK SpinLock, KIRQL *a2);
void __fastcall sub_1BCF8(PKSPIN_LOCK SpinLock, KIRQL a2);
bool __fastcall sub_1BD9C(struct _KEVENT **a1, char a2);
void __fastcall sub_1BE84(PVOID P);
int __fastcall sub_1BF1C(PRKEVENT Event);
void __fastcall HandleInformation(PVOID StartContext);
unsigned __int8 __fastcall sub_1C048(PVOID *Object, __int64 a2, __int64 a3);
__int64 __fastcall sub_1C1B8(PVOID Object); // idb
__int64 __fastcall sub_1C24C(void ***a1);
__int64 __fastcall sub_1C558(unsigned int a1, char a2);
__int64 __fastcall sub_1C80C(PVOID P); // idb
void __fastcall sub_1CB68(__int64 a1, char a2);
void __fastcall sub_1CC2C(__int64 a1, unsigned int a2);
__int64 __fastcall sub_1CD38(PVOID Object); // idb
__int64 __fastcall sub_1CDE0(ULONG Count, PVOID Object[]); // idb
void __fastcall DeferredRoutine(_KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2);
bool __fastcall sub_1CF20(__int64 a1);
char __fastcall sub_1CF84(PFAST_MUTEX FastMutex);
char __fastcall sub_1CFE4(PFAST_MUTEX FastMutex);
char __fastcall sub_1D044(PFAST_MUTEX FastMutex);
char __fastcall sub_1D0AC(PFAST_MUTEX FastMutex);
__int64 __fastcall sub_1D110(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_1D158(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, __int64 a5, int a6);
__int64 __fastcall sub_1D1B8(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6, int a7);
__int64 __fastcall sub_1D228(__int64 a1, __int64 a2, __int64 a3, int a4, int a5);
__int64 __fastcall sub_1D280(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_1D2D4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_1D330(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 sub_1D3A0(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_1D3EC(__int64 a1, __int64 a2, _QWORD *a3);
__int64 sub_1D8E0();
__int64 (**sub_1DC28())(void);
void sub_1DD54();
__int64 __fastcall sub_1DF10(unsigned int a1);
__int64 __fastcall sub_1E17C(__int64 a1);
__int64 sub_1E734();
__int64 __fastcall sub_1EE00(unsigned int a1, int a2, unsigned int a3, _DWORD *a4);
__int64 __fastcall sub_1F3F8(__int64 a1, unsigned int a2, __int64 a3);
__int64 __fastcall sub_1F7BC(int a1);
__int64 __fastcall sub_1F918(int a1);
__int64 __fastcall sub_1FA40(__int64 a1, __int64 a2, __int64 a3, const wchar_t *a4);
__int64 sub_1FAF0(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_1FB44(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_1FBB0(__int16 *a1, int a2, unsigned int *a3);
__int64 __fastcall sub_1FD84(char a1);
__int64 sub_1FE20();
__int64 __fastcall sub_1FFE0(unsigned int a1, __int64 a2);
__int64 sub_20130();
__int64 sub_203A0();
__int64 __fastcall sub_20628(int a1);
__int64 sub_209EC();
__int64 sub_21150();
__int64 __fastcall sub_214B0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_21708(unsigned int *a1);
__int64 __fastcall sub_21864(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_21950(__int64 a1, int a2, unsigned int a3, void *a4);
__int64 __fastcall sub_21B4C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_21DC0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_220D8(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_222B8(__int64 a1, __int64 a2, __int64 a3);
__int64 sub_2245C();
__int64 __fastcall sub_22554(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_22604(__int64 a1, __m128i *a2);
__int64 sub_226B8(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_2271C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_22778(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_227E8(int a1, _QWORD *a2);
__int64 __fastcall sub_229CC(int a1, __int64 a2);
__int64 __fastcall sub_22B2C(int a1, struct _FAST_MUTEX *a2, KIRQL *a3);
__int64 __fastcall sub_22C3C(int a1, struct _FAST_MUTEX *a2, KIRQL a3);
__int64 __fastcall sub_22D18(__int64 a1, __int64 a2, char a3);
__int64 __fastcall sub_22E44(__int64 a1, __int64 a2, char a3);
_DWORD *__fastcall sub_22F68(__int64 a1, __int64 a2, __int64 a3, ULONG a4, __int64 a5, __int64 a6, __int64 a7, __int64 a8, __int64 a9, __int64 a10, _DWORD *a11);
__int64 __fastcall sub_231F8(ULONG_PTR BugCheckParameter2); // idb
__int64 __fastcall sub_23684(__int64 a1);
unsigned __int64 __fastcall sub_2396C(__int64 a1, unsigned __int64 a2, _DWORD *a3);
_DWORD *__fastcall sub_23A68(__int64 a1, __int64 a2, _DWORD *a3);
__int64 __fastcall sub_23BF0(__int64 a1, unsigned int a2, __int64 *a3);
__int64 __fastcall sub_23DEC(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_23F6C(__int64 a1, __int64 a2);
__int64 __fastcall sub_2419C(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_24294(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4);
__int64 __fastcall sub_244C8(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, _DWORD *a4);
__int64 __fastcall sub_2474C(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, _QWORD *a3, _DWORD *a4);
_QWORD *__fastcall sub_24938(__int64 a1, unsigned int a2, __int64 a3, _DWORD *a4);
ULONG_PTR __fastcall sub_24AF8(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4, __int64 a5);
__int64 __fastcall sub_24F80(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1); // idb
__int64 __fastcall sub_25124(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3);
__int64 __fastcall sub_25268(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3);
char __fastcall sub_253E4(_BYTE *a1, _DWORD *a2);
char __fastcall sub_25530(_BYTE *a1, _DWORD *a2);
char __fastcall sub_2567C(_BYTE *a1, _DWORD *a2);
__int64 __fastcall sub_257C8(__int64 a1);
__int64 __fastcall sub_25BF8(__int64 a1, ULONG_PTR a2, __int64 a3);
__int64 sub_25DD0();
char __fastcall sub_25EF4(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1);
__int64 __fastcall sub_25F4C(_QWORD *a1, _QWORD *a2);
void __fastcall sub_260D0(PVOID P);
__int64 __fastcall sub_26140(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, void *Src);
__int64 __fastcall sub_262A8(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4);
__int64 sub_262F8(char *a1, unsigned __int64 a2, CHAR *a3, ...);
__int64 __fastcall sub_2631C(void *a1, size_t a2, const void *a3, size_t a4);
__int64 __fastcall sub_263C0(_BYTE *a1, __int64 a2, char *a3);
// __int64 __fastcall write_char(_QWORD, _QWORD, _QWORD); weak
// __int64 __fastcall write_multi_char(_QWORD, _QWORD, _QWORD, _QWORD); weak
__int64 __fastcall sub_264F0(_BYTE *a1, int a2, __int64 a3, _DWORD *a4);
__int64 __fastcall sub_26560(__int64 a1, CHAR *a2, __int64 a3);
__int64 __fastcall sub_26E30(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4);
// int __cdecl flsbuf(int Ch, FILE *File);
// NTSTATUS __stdcall RtlStringCopyWorkerA(NTSTRSAFE_PSTR pszDest, size_t cchDest, size_t *pcchNewDestLength, STRSAFE_PCNZCH pszSrc, size_t cchToCopy);
// __int64 __fastcall unknown_libname_2(_QWORD, _QWORD, _QWORD); weak
// NTSTATUS __stdcall RtlStringValidateDestAndLengthA(NTSTRSAFE_PCSTR pszDest, size_t cchDest, size_t *pcchDestLength, const size_t cchMax);
__int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // weak
// void *__cdecl memmove(void *Dst, const void *Src, size_t MaxCount);
// void *__cdecl memset(void *Dst, int Val, size_t Size);
// NTSTATUS __stdcall RtlUnicodeToMultiByteN(PCHAR MultiByteString, ULONG MaxBytesInMultiByteString, PULONG BytesInMultiByteString, PCWCH UnicodeString, ULONG BytesInUnicodeString);
__int64 __fastcall sub_274EC(_WORD *a1, __int64 a2, __int16 *a3);
// PVOID __stdcall ExAllocatePoolWithTag(POOL_TYPE PoolType, SIZE_T NumberOfBytes, ULONG Tag);
// NTSTATUS __stdcall IoWMIRegistrationControl(PDEVICE_OBJECT DeviceObject, ULONG Action);
// PIRP __stdcall IoBuildDeviceIoControlRequest(ULONG IoControlCode, PDEVICE_OBJECT DeviceObject, PVOID InputBuffer, ULONG InputBufferLength, PVOID OutputBuffer, ULONG OutputBufferLength, BOOLEAN InternalDeviceIoControl, PKEVENT Event, PIO_STATUS_BLOCK IoStatusBlock);
// void __stdcall ExFreePoolWithTag(PVOID P, ULONG Tag);
// NTSTATUS __stdcall IoWMIWriteEvent(PVOID WnodeEventItem);
// void __stdcall RtlInitUnicodeString(PUNICODE_STRING DestinationString, PCWSTR SourceString);
// void __stdcall IoDeleteDevice(PDEVICE_OBJECT DeviceObject);
// PVOID __stdcall MmGetSystemRoutineAddress(PUNICODE_STRING SystemRoutineName);
// NTSTATUS __stdcall IoGetDeviceObjectPointer(PUNICODE_STRING ObjectName, ACCESS_MASK DesiredAccess, PFILE_OBJECT *FileObject, PDEVICE_OBJECT *DeviceObject);
// void __stdcall IofCompleteRequest(PIRP Irp, CCHAR PriorityBoost);
// SIZE_T __stdcall RtlCompareMemory(const void *Source1, const void *Source2, SIZE_T Length);
// LONG_PTR __stdcall ObfDereferenceObject(PVOID Object);
// NTSTATUS __stdcall IoCreateDevice(PDRIVER_OBJECT DriverObject, ULONG DeviceExtensionSize, PUNICODE_STRING DeviceName, ULONG DeviceType, ULONG DeviceCharacteristics, BOOLEAN Exclusive, PDEVICE_OBJECT *DeviceObject);
// NTSTATUS __stdcall IofCallDriver(PDEVICE_OBJECT DeviceObject, PIRP Irp);
// void __stdcall __noreturn KeBugCheckEx(ULONG BugCheckCode, ULONG_PTR BugCheckParameter1, ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter3, ULONG_PTR BugCheckParameter4);
// BOOLEAN __stdcall ExAcquireResourceExclusiveLite(PERESOURCE Resource, BOOLEAN Wait);
// void __stdcall KeClearEvent(PRKEVENT Event);
// LONG __stdcall KeResetEvent(PRKEVENT Event);
// void __stdcall ExReleaseFastMutex(PFAST_MUTEX FastMutex);
// void KeLeaveCriticalRegion(void);
// void __stdcall ExInitializeNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside, PALLOCATE_FUNCTION Allocate, PFREE_FUNCTION Free, ULONG Flags, SIZE_T Size, ULONG Tag, USHORT Depth);
// void __stdcall ExAcquireFastMutex(PFAST_MUTEX FastMutex);
// LONG __stdcall KeSetEvent(PRKEVENT Event, KPRIORITY Increment, BOOLEAN Wait);
// PSLIST_ENTRY __stdcall ExpInterlockedPushEntrySList(PSLIST_HEADER ListHead, PSLIST_ENTRY ListEntry);
// void __stdcall KeInitializeEvent(PRKEVENT Event, EVENT_TYPE Type, BOOLEAN State);
// void __stdcall KeReleaseSpinLock(PKSPIN_LOCK SpinLock, KIRQL NewIrql);
// PSLIST_ENTRY __stdcall ExpInterlockedPopEntrySList(PSLIST_HEADER ListHead);
// void __stdcall KeReleaseSpinLockFromDpcLevel(PKSPIN_LOCK SpinLock);
// void KeEnterCriticalRegion(void);
// void __stdcall ExDeletePagedLookasideList(PPAGED_LOOKASIDE_LIST Lookaside);
// NTSTATUS __stdcall PsCreateSystemThread(PHANDLE ThreadHandle, ULONG DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, HANDLE ProcessHandle, PCLIENT_ID ClientId, PKSTART_ROUTINE StartRoutine, PVOID StartContext);
// NTSTATUS __stdcall PsTerminateSystemThread(NTSTATUS ExitStatus);
// BOOLEAN __stdcall ExAcquireResourceSharedLite(PERESOURCE Resource, BOOLEAN Wait);
// void __stdcall ExReleaseResourceLite(PERESOURCE Resource);
// NTSTATUS __stdcall ZwClose(HANDLE Handle);
// USHORT __stdcall ExQueryDepthSList(PSLIST_HEADER SListHead);
// NTSTATUS __stdcall ObReferenceObjectByHandle(HANDLE Handle, ACCESS_MASK DesiredAccess, POBJECT_TYPE ObjectType, KPROCESSOR_MODE AccessMode, PVOID *Object, POBJECT_HANDLE_INFORMATION HandleInformation);
// NTSTATUS __stdcall KeWaitForSingleObject(PVOID Object, KWAIT_REASON WaitReason, KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Timeout);
// NTSTATUS __stdcall ExDeleteResourceLite(PERESOURCE Resource);
// void __stdcall ExInitializePagedLookasideList(PPAGED_LOOKASIDE_LIST Lookaside, PALLOCATE_FUNCTION Allocate, PFREE_FUNCTION Free, ULONG Flags, SIZE_T Size, ULONG Tag, USHORT Depth);
// NTSTATUS __stdcall ExInitializeResourceLite(PERESOURCE Resource);
// NTSTATUS __stdcall KeWaitForMultipleObjects(ULONG Count, PVOID Object[], WAIT_TYPE WaitType, KWAIT_REASON WaitReason, KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Timeout, PKWAIT_BLOCK WaitBlockArray);
// void __stdcall KeAcquireSpinLockAtDpcLevel(PKSPIN_LOCK SpinLock);
// void __stdcall ExDeleteNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside);
// KIRQL __stdcall KeAcquireSpinLockRaiseToDpc(PKSPIN_LOCK SpinLock);
// void __stdcall KeInitializeDpc(PRKDPC Dpc, PKDEFERRED_ROUTINE DeferredRoutine, PVOID DeferredContext);
// void __stdcall KeInitializeTimer(PKTIMER Timer);
// BOOLEAN __stdcall KeSetTimer(PKTIMER Timer, LARGE_INTEGER DueTime, PKDPC Dpc);
// BOOLEAN __stdcall KeCancelTimer(PKTIMER);
// NTSTATUS __stdcall KeDelayExecutionThread(KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Interval);
__int64 __fastcall sub_2E008(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6);

//-------------------------------------------------------------------------
// Data declarations

unsigned __int8 byte_281F0[352] =
{
  6u,
  128u,
  128u,
  134u,
  128u,
  129u,
  128u,
  0u,
  0u,
  16u,
  3u,
  134u,
  128u,
  134u,
  130u,
  128u,
  20u,
  5u,
  5u,
  69u,
  69u,
  69u,
  133u,
  133u,
  133u,
  5u,
  0u,
  0u,
  48u,
  48u,
  128u,
  80u,
  128u,
  128u,
  0u,
  8u,
  0u,
  32u,
  32u,
  48u,
  80u,
  87u,
  128u,
  0u,
  7u,
  0u,
  55u,
  48u,
  48u,
  80u,
  80u,
  136u,
  0u,
  0u,
  0u,
  32u,
  40u,
  128u,
  136u,
  128u,
  128u,
  0u,
  0u,
  0u,
  96u,
  96u,
  96u,
  104u,
  104u,
  96u,
  0u,
  0u,
  7u,
  120u,
  112u,
  112u,
  119u,
  112u,
  112u,
  8u,
  8u,
  0u,
  0u,
  8u,
  0u,
  8u,
  0u,
  7u,
  8u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u
}; // idb
_UNKNOWN unk_28AC0; // weak
_UNKNOWN unk_28AD0; // weak
_UNKNOWN unk_28AE0; // weak
_UNKNOWN unk_28AF0; // weak
_UNKNOWN unk_28B00; // weak
_DWORD dword_28B10[30] =
{
  1,
  11,
  23,
  53,
  97,
  193,
  389,
  769,
  1543,
  3079,
  6151,
  12289,
  24593,
  49157,
  98317,
  196613,
  393241,
  786433,
  1572869,
  3145739,
  6291469,
  12582917,
  25165843,
  50331653,
  100663319,
  201326611,
  402653189,
  805306457,
  1610612741,
  0
}; // idb
_UNKNOWN unk_28B88; // weak
_UNKNOWN unk_28B98; // weak
_UNKNOWN unk_28BA8; // weak
_UNKNOWN unk_28BC8; // weak
_UNKNOWN unk_28BD8; // weak
_UNKNOWN unk_28BE8; // weak
_UNKNOWN unk_28BF8; // weak
_UNKNOWN unk_28C08; // weak
_UNKNOWN unk_28C18; // weak
_UNKNOWN unk_28C28; // weak
_UNKNOWN unk_28C38; // weak
_UNKNOWN unk_28C48; // weak
_UNKNOWN unk_28C58; // weak
_UNKNOWN unk_28C68; // weak
char *off_2A110 = "(null)"; // weak
wchar_t *off_2A118 = L"(null)"; // weak
void *off_2A148 = &off_2A148; // weak
char aUnknownModule[15] = "Unknown module"; // weak
__int64 (__fastcall *qword_2A1B0)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_2A1C0)(_QWORD) = NULL; // weak
__int64 (__fastcall *qword_2A1C8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_2A1D0)(_QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
int dword_2A1D8 = 0; // weak
int dword_2A1E0 = 0; // weak
__int64 (__fastcall *qword_2A1E4)(_QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_2A1EC)(_QWORD) = NULL; // weak
__int64 qword_2A1F4 = 0i64; // weak
__int64 qword_2A1FC = ; // weak
char byte_2A204; // weak
char byte_2A205; // weak
int dword_2A208; // weak
int dword_2A20C; // weak
PVOID Event; // idb
PVOID qword_2A218; // idb
struct _FAST_MUTEX FastMutex; // idb
PVOID qword_2A258; // idb
int dword_2A264; // weak
PVOID qword_2A270; // idb
PVOID Object; // idb
PVOID qword_2A280; // idb
PVOID qword_2A288; // idb
PVOID P; // idb
PVOID qword_2C890; // idb
PVOID qword_2C8A0; // idb
_WORD word_2C8B0[520]; // idb
int dword_2CCC0; // weak
PVOID qword_2CCC8; // idb
__int64 qword_2CCD0; // weak
PVOID qword_2CCD8; // idb
PVOID qword_2CCE0; // idb
int dword_2CCE8; // weak
int dword_2CCEC; // weak
char byte_2CCF0; // weak
char byte_2CCF1; // weak
char byte_2CCF2; // weak
char byte_2CCF3; // weak
char byte_2CCF4; // weak
__int64 (__fastcall *qword_2CCF8)(_QWORD); // weak
__int64 qword_2CD00; // weak
__int64 qword_2CD08; // weak
__int64 qword_2CD10; // weak
__int64 qword_2CD18; // weak
ULONG_PTR qword_2CD20; // idb
ULONG_PTR qword_2CD28; // idb
char byte_2CD9C; // weak
char byte_2CDFC; // weak
__int64 qword_2CE00; // weak
__int64 qword_2CE08; // weak
struct _KDPC Dpc; // idb
struct _KTIMER Timer; // idb
int dword_2CEA0; // weak
int dword_2CEA4; // weak
__int64 qword_2CEC0; // weak
__int64 qword_2CEC8; // weak
__int64 qword_2CED0; // weak
__int64 qword_2CEE0; // weak
char byte_2CEE8; // weak
char byte_2CEE9; // weak
__int16 word_2CEEA; // weak
int dword_2CEEC; // weak
__int64 qword_2CF00; // weak
__int64 qword_2CF08; // weak
__int64 qword_2CF10; // weak
__int64 qword_2CF20; // weak
char byte_2CF28; // weak
char byte_2CF29; // weak
__int16 word_2CF2A; // weak
int dword_2CF2C; // weak
__int64 qword_2CF40; // weak
__int64 qword_2CF48; // weak
__int64 qword_2CF50; // weak
__int64 qword_2CF60; // weak
char byte_2CF68; // weak
char byte_2CF69; // weak
__int16 word_2CF6A; // weak
int dword_2CF6C; // weak
__int64 qword_2CF80; // weak
__int64 qword_2CF88; // weak
__int64 qword_2CF90; // weak
__int64 qword_2CFA0; // weak
char byte_2CFA8; // weak
char byte_2CFA9; // weak
__int16 word_2CFAA; // weak
int dword_2CFAC; // weak


//----- (0000000000011008) ----------------------------------------------------
__int64 __fastcall sub_11008(__int64 a1, unsigned __int16 a2, __int64 a3)
{
  return qword_2A1B8(a1, 43i64, a3, a2, 0i64);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001102C) ----------------------------------------------------
__int64 __fastcall sub_1102C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+68h] [rbp+20h] BYREF

  v5 = a4;
  return qword_2A1B8(a1, 43i64, a3, a2, &v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011068) ----------------------------------------------------
__int64 __fastcall sub_11068(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_2A1B8(a1, 43i64, a3, a2, v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000110E0) ----------------------------------------------------
__int64 __fastcall sub_110E0(__int64 a1, __int64 a2, __int64 a3, __int16 a4, __int64 a5)
{
  char *v7; // rsi
  __int64 *v8; // rax
  __int64 v9; // r8
  SIZE_T v10; // rbx
  unsigned __int64 v11; // rcx
  int *v12; // rdx
  __int64 v13; // r9
  char *v15; // rax
  __int64 v16; // rbp
  const void **i; // rdi
  size_t v18; // rbx
  unsigned int v19; // ebx
  __int64 WnodeEventItem[7]; // [rsp+30h] [rbp-D8h] BYREF
  int v21; // [rsp+68h] [rbp-A0h] BYREF
  char *v22; // [rsp+70h] [rbp-98h]
  int v23; // [rsp+78h] [rbp-90h]
  __int16 v24; // [rsp+128h] [rbp+20h] BYREF

  v24 = a4;
  v7 = 0i64;
  memset(WnodeEventItem, 0, 0x30ui64);
  WnodeEventItem[1] = a1;
  WnodeEventItem[6] = (__int64)&v24;
  v8 = &a5;
  WnodeEventItem[3] = a3;
  HIDWORD(WnodeEventItem[5]) = 1703936;
  BYTE4(WnodeEventItem[0]) = -1;
  v21 = 2;
  v9 = a5;
  v10 = 0i64;
  v11 = 0i64;
  if ( a5 )
  {
    v12 = &v21;
    do
    {
      v13 = v8[1];
      ++v11;
      v12 += 4;
      v10 += v13;
      if ( v11 <= 7 )
      {
        *((_QWORD *)v12 - 1) = v9;
        *v12 = v13;
      }
      v8 += 2;
      v9 = *v8;
    }
    while ( *v8 );
  }
  if ( v10 > 0x2000 )
    return 3221225473i64;
  if ( v11 <= 7 )
  {
    LOWORD(WnodeEventItem[0]) = 16 * (v11 + 4);
  }
  else
  {
    v15 = (char *)ExAllocatePoolWithTag(NonPagedPool, v10, 0x45435453u);
    v7 = v15;
    if ( !v15 )
      return 3221225495i64;
    v22 = v15;
    v23 = v10;
    v16 = 0i64;
    for ( i = (const void **)&a5; *i; i += 2 )
    {
      v18 = (size_t)i[1];
      memmove(&v7[v16], *i, v18);
      v16 += v18;
    }
    LOWORD(WnodeEventItem[0]) = 80;
  }
  v19 = IoWMIWriteEvent(WnodeEventItem);
  if ( v7 )
    ExFreePoolWithTag(v7, 0);
  return v19;
}

//----- (0000000000011234) ----------------------------------------------------
__int64 __fastcall sub_11234(__int64 a1, char a2, __int64 *a3, __int64 a4)
{
  __int64 result; // rax

  result = 0i64;
  if ( a2 == 1 || !a2 )
  {
    if ( a2 )
    {
      *(_DWORD *)(a4 + 44) = *((_DWORD *)a3 + 1);
      *(_BYTE *)(a4 + 41) = *((_BYTE *)a3 + 2);
      result = *a3;
    }
    else
    {
      *(_BYTE *)(a4 + 41) = 0;
      *(_DWORD *)(a4 + 44) = 0;
    }
    *(_QWORD *)(a4 + 24) = result;
  }
  return result;
}

//----- (000000000001126C) ----------------------------------------------------
NTSTATUS __stdcall DriverEntry(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath)
{
  int v3; // eax
  void **v4; // rcx
  __int64 *v5; // rbx
  __int64 v6; // rcx
  ULONG v7; // edx
  struct _DEVICE_OBJECT *v8; // rcx
  NTSTATUS v9; // ebx
  int v11; // eax
  struct _UNICODE_STRING SystemRoutineName; // [rsp+40h] [rbp-38h] BYREF
  struct _UNICODE_STRING DestinationString; // [rsp+50h] [rbp-28h] BYREF
  unsigned int v14; // [rsp+90h] [rbp+18h] BYREF
  PDEVICE_OBJECT DeviceObject; // [rsp+98h] [rbp+20h] BYREF

  qword_2CEC8 = (__int64)&unk_28AC0;
  qword_2CED0 = (__int64)&qword_2CF00;
  qword_2CF08 = (__int64)&unk_28AD0;
  qword_2CEC0 = 0i64;
  qword_2CF10 = (__int64)&qword_2CF40;
  qword_2CEE0 = 0i64;
  qword_2CF48 = (__int64)&unk_28AE0;
  byte_2CEE8 = 1;
  qword_2CF50 = (__int64)&qword_2CF80;
  byte_2CEE9 = 0;
  word_2CEEA = 0;
  dword_2CEEC = 0;
  qword_2CF00 = 0i64;
  qword_2CF88 = (__int64)&unk_28AF0;
  qword_2CF20 = 0i64;
  byte_2CF28 = 1;
  byte_2CF29 = 0;
  word_2CF2A = 0;
  dword_2CF2C = 0;
  qword_2CF40 = 0i64;
  qword_2CF60 = 0i64;
  byte_2CF68 = 1;
  byte_2CF69 = 0;
  word_2CF6A = 0;
  dword_2CF6C = 0;
  qword_2CF80 = 0i64;
  qword_2CF90 = 0i64;
  qword_2CFA0 = 0i64;
  byte_2CFA8 = 1;
  byte_2CFA9 = 0;
  word_2CFAA = 0;
  dword_2CFAC = 0;
  v14 = 0;
  RtlInitUnicodeString(&SystemRoutineName, L"PsGetVersion");
  qword_2A1D0 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
  RtlInitUnicodeString(&SystemRoutineName, L"WmiTraceMessage");
  qword_2A1B8 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
  if ( !qword_2A1B8 )
  {
    qword_2A1B8 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))sub_110E0;
    v3 = 1;
LABEL_3:
    dword_2A1D8 = v3;
    goto LABEL_10;
  }
  RtlInitUnicodeString(&SystemRoutineName, L"WmiQueryTraceInformation");
  qword_2A1B0 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
  v3 = 2;
  dword_2A1D8 = 2;
  if ( qword_2A1D0 )
  {
    qword_2A1D0(&v14, 0i64, 0i64, 0i64);
    v3 = dword_2A1D8;
  }
  if ( v14 >= 6 )
  {
    RtlInitUnicodeString(&SystemRoutineName, L"EtwRegisterClassicProvider");
    qword_2A1C8 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
    if ( qword_2A1C8 )
    {
      RtlInitUnicodeString(&SystemRoutineName, L"EtwUnregister");
      qword_2A1C0 = (__int64 (__fastcall *)(_QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
      v3 = 4;
      goto LABEL_3;
    }
    v3 = dword_2A1D8;
  }
LABEL_10:
  v4 = (void **)off_2A148;
  v5 = &qword_2CEC0;
  qword_2CEE0 = 0i64;
  if ( off_2A148 != &qword_2CEC0 )
  {
    off_2A148 = &qword_2CEC0;
    if ( v3 == 4 )
    {
      do
      {
        v6 = v5[1];
        v5[7] = 0i64;
        qword_2A1C8(v6, 0i64, sub_11234, v5, v5 + 7);
        v5 = (__int64 *)v5[2];
      }
      while ( v5 );
    }
    else
    {
      if ( v3 == 2 )
      {
        v7 = -2147418111;
        v8 = (struct _DEVICE_OBJECT *)&qword_2CEC0;
        qword_2CEC0 = (__int64)sub_2E008;
      }
      else
      {
        qword_2CEC0 = 0i64;
        v7 = 1;
        v8 = (struct _DEVICE_OBJECT *)DriverObject;
      }
      IoWMIRegistrationControl(v8, v7);
    }
    v4 = (void **)off_2A148;
  }
  if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 236) & 1) != 0 && *((_BYTE *)v4 + 233) >= 5u )
    sub_11008((__int64)v4[27], 0xAu, (__int64)&unk_28C68);
  if ( !sub_1CF20((__int64)&FastMutex) )
  {
    v9 = -1073741670;
LABEL_25:
    sub_11734((PDEVICE_OBJECT)DriverObject);
    return v9;
  }
  DriverObject->DriverUnload = (PDRIVER_UNLOAD)sub_11734;
  RtlInitUnicodeString(&DestinationString, L"\\Device\\NNS_Parser5");
  v9 = IoCreateDevice(DriverObject, 0, &DestinationString, 0x22u, 0, 0, &DeviceObject);
  if ( v9 )
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 1) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
      sub_11068(*((_QWORD *)off_2A148 + 27), 0xCu, (__int64)&unk_28C68, (const char *)L"\\Device\\NNS_Parser5");
  }
  else
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 1) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
      sub_11008(*((_QWORD *)off_2A148 + 27), 0xBu, (__int64)&unk_28C68);
    DriverObject->MajorFunction[0] = (PDRIVER_DISPATCH)sub_11AA4;
    DriverObject->MajorFunction[2] = (PDRIVER_DISPATCH)sub_11AA4;
    DriverObject->MajorFunction[14] = (PDRIVER_DISPATCH)sub_11EC0;
    DriverObject->MajorFunction[15] = (PDRIVER_DISPATCH)sub_11F6C;
  }
  if ( v9 < 0 )
    goto LABEL_25;
  v11 = sub_129E8();
  if ( v11 )
    v9 = (unsigned __int16)v11 | 0xE0020000;
  if ( v9 < 0 )
    goto LABEL_25;
  if ( (unsigned __int8)sub_1DF10(0x2023001u) == 1 )
    sub_11ACC();
  qword_2CE00 = 5000000i64;
  KeInitializeDpc(&Dpc, (PKDEFERRED_ROUTINE)DeferredRoutine, sub_1220C);
  KeInitializeTimer(&Timer);
  qword_2CE08 = -50000000i64;
  KeSetTimer(&Timer, (LARGE_INTEGER)-50000000i64, &Dpc);
  return v9;
}
// 2A148: using guessed type void *off_2A148;
// 2A1B0: using guessed type __int64 (__fastcall *qword_2A1B0)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 2A1C0: using guessed type __int64 (__fastcall *qword_2A1C0)(_QWORD);
// 2A1C8: using guessed type __int64 (__fastcall *qword_2A1C8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 2A1D0: using guessed type __int64 (__fastcall *qword_2A1D0)(_QWORD, _QWORD, _QWORD, _QWORD);
// 2A1D8: using guessed type int dword_2A1D8;
// 2CE00: using guessed type __int64 qword_2CE00;
// 2CE08: using guessed type __int64 qword_2CE08;
// 2CEC0: using guessed type __int64 qword_2CEC0;
// 2CEC8: using guessed type __int64 qword_2CEC8;
// 2CED0: using guessed type __int64 qword_2CED0;
// 2CEE0: using guessed type __int64 qword_2CEE0;
// 2CEE8: using guessed type char byte_2CEE8;
// 2CEE9: using guessed type char byte_2CEE9;
// 2CEEA: using guessed type __int16 word_2CEEA;
// 2CEEC: using guessed type int dword_2CEEC;
// 2CF00: using guessed type __int64 qword_2CF00;
// 2CF08: using guessed type __int64 qword_2CF08;
// 2CF10: using guessed type __int64 qword_2CF10;
// 2CF20: using guessed type __int64 qword_2CF20;
// 2CF28: using guessed type char byte_2CF28;
// 2CF29: using guessed type char byte_2CF29;
// 2CF2A: using guessed type __int16 word_2CF2A;
// 2CF2C: using guessed type int dword_2CF2C;
// 2CF40: using guessed type __int64 qword_2CF40;
// 2CF48: using guessed type __int64 qword_2CF48;
// 2CF50: using guessed type __int64 qword_2CF50;
// 2CF60: using guessed type __int64 qword_2CF60;
// 2CF68: using guessed type char byte_2CF68;
// 2CF69: using guessed type char byte_2CF69;
// 2CF6A: using guessed type __int16 word_2CF6A;
// 2CF6C: using guessed type int dword_2CF6C;
// 2CF80: using guessed type __int64 qword_2CF80;
// 2CF88: using guessed type __int64 qword_2CF88;
// 2CF90: using guessed type __int64 qword_2CF90;
// 2CFA0: using guessed type __int64 qword_2CFA0;
// 2CFA8: using guessed type char byte_2CFA8;
// 2CFA9: using guessed type char byte_2CFA9;
// 2CFAA: using guessed type __int16 word_2CFAA;
// 2CFAC: using guessed type int dword_2CFAC;

//----- (0000000000011734) ----------------------------------------------------
void __fastcall sub_11734(PDEVICE_OBJECT DeviceObject)
{
  struct _DEVICE_OBJECT *v2; // rcx
  void **v3; // rbx
  ULONG v4; // edx
  struct _DEVICE_OBJECT *v5; // rcx
  void *v6; // rcx

  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 1) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xDu, (__int64)&unk_28C68);
  v2 = (struct _DEVICE_OBJECT *)DeviceObject->DriverObject;
  if ( v2 )
  {
    IoDeleteDevice(v2);
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 1) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
      sub_11008(*((_QWORD *)off_2A148 + 27), 0xEu, (__int64)&unk_28C68);
  }
  sub_11974();
  KeCancelTimer(&Timer);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 1) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xCu, (__int64)&unk_28C48);
  if ( byte_2A205 )
  {
    if ( qword_2A218 )
    {
      sub_1DF10(0x2023003u);
      sub_1B494(qword_2A218);
    }
    if ( qword_2A270 )
    {
      sub_1DF10(0x2023006u);
      sub_1B494(qword_2A270);
    }
    sub_1DC28();
  }
  sub_20130();
  if ( byte_2A205 )
  {
    sub_165C8();
    sub_198C0();
    byte_2CD9C = 0;
    byte_2CDFC = 0;
    sub_1DD54();
    byte_2A205 = 0;
  }
  v3 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 1) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xDu, (__int64)&unk_28C48);
    v3 = (void **)off_2A148;
  }
  dword_2A264 = 0;
  if ( qword_2A258 )
  {
    sub_1B080(qword_2A258);
    v3 = (void **)off_2A148;
  }
  if ( v3 != &off_2A148 )
  {
    if ( dword_2A1D8 == 4 )
    {
      while ( v3 )
      {
        v6 = v3[7];
        if ( v6 )
          qword_2A1C0(v6);
        v3 = (void **)v3[2];
      }
    }
    else
    {
      v4 = 2;
      if ( dword_2A1D8 == 2 )
      {
        v4 = -2147483646;
        v5 = (struct _DEVICE_OBJECT *)v3;
      }
      else
      {
        v5 = DeviceObject;
      }
      IoWMIRegistrationControl(v5, v4);
    }
    off_2A148 = &off_2A148;
  }
}
// 2A148: using guessed type void *off_2A148;
// 2A1C0: using guessed type __int64 (__fastcall *qword_2A1C0)(_QWORD);
// 2A1D8: using guessed type int dword_2A1D8;
// 2A205: using guessed type char byte_2A205;
// 2A264: using guessed type int dword_2A264;
// 2CD9C: using guessed type char byte_2CD9C;
// 2CDFC: using guessed type char byte_2CDFC;

//----- (0000000000011974) ----------------------------------------------------
__int64 sub_11974()
{
  __int64 result; // rax

  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
    && *((_BYTE *)off_2A148 + 169) >= 4u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xFu, (__int64)&unk_28C68);
  }
  sub_12D38();
  if ( byte_2A204 )
  {
    if ( qword_2A1EC && sub_1D044(&FastMutex) )
    {
      qword_2A1EC(5i64);
      sub_1D0AC(&FastMutex);
    }
    sub_1CFE4(&FastMutex);
    memset(&dword_2A1E0, 0, 0x25ui64);
    byte_2A204 = 0;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
      && *((_BYTE *)off_2A148 + 169) >= 4u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x11u, (__int64)&unk_28C68);
    }
    result = 0i64;
  }
  else
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
      && *((_BYTE *)off_2A148 + 169) >= 2u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x10u, (__int64)&unk_28C68);
    }
    result = 16i64;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;
// 2A1E0: using guessed type int dword_2A1E0;
// 2A1EC: using guessed type __int64 (__fastcall *qword_2A1EC)(_QWORD);
// 2A204: using guessed type char byte_2A204;

//----- (0000000000011AA4) ----------------------------------------------------
__int64 __fastcall sub_11AA4(__int64 a1, IRP *a2)
{
  a2->IoStatus.Status = 0;
  a2->IoStatus.Information = 0i64;
  IofCompleteRequest(a2, 0);
  return 0i64;
}

//----- (0000000000011ACC) ----------------------------------------------------
__int64 sub_11ACC()
{
  void **v0; // rcx
  unsigned int v1; // edi
  unsigned __int16 v2; // dx
  int v3; // eax
  unsigned int v4; // ebx
  IRP *v6; // rax
  NTSTATUS v7; // ebx
  void **v8; // rcx
  struct _UNICODE_STRING DestinationString; // [rsp+50h] [rbp-38h] BYREF
  struct _IO_STATUS_BLOCK IoStatusBlock; // [rsp+60h] [rbp-28h] BYREF
  PDEVICE_OBJECT DeviceObject; // [rsp+90h] [rbp+8h] BYREF
  PFILE_OBJECT FileObject; // [rsp+98h] [rbp+10h] BYREF

  v0 = (void **)off_2A148;
  v1 = 5;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x12u, (__int64)&unk_28C68);
    v0 = (void **)off_2A148;
  }
  if ( byte_2A204 )
  {
    if ( v0 == &off_2A148 || !_bittest((const signed __int32 *)v0 + 43, 9u) || *((_BYTE *)v0 + 169) < 2u )
      return 0i64;
    v2 = 19;
LABEL_68:
    sub_11008((__int64)v0[19], v2, (__int64)&unk_28C68);
    return 0i64;
  }
  v3 = sub_12B94();
  v4 = v3;
  if ( v3 )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
      && *((_BYTE *)off_2A148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 19), 0x14u, (__int64)&unk_28C68, v3);
    }
    return v4;
  }
  RtlInitUnicodeString(&DestinationString, L"\\Device\\NNS_Streamer");
  if ( IoGetDeviceObjectPointer(&DestinationString, 0, &FileObject, &DeviceObject) < 0 )
  {
    v0 = (void **)off_2A148;
    if ( off_2A148 == &off_2A148
      || !_bittest((const signed __int32 *)off_2A148 + 43, 9u)
      || *((_BYTE *)off_2A148 + 169) < 5u )
    {
      return 0i64;
    }
    v2 = 21;
    goto LABEL_68;
  }
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x16u, (__int64)&unk_28C68);
  }
  qword_2A1F4 = (__int64)sub_13054;
  qword_2A1FC = (__int64)sub_134A8;
  dword_2A1E0 = 5;
  v6 = IoBuildDeviceIoControlRequest(
         0x223E80u,
         DeviceObject,
         &dword_2A1E0,
         0x25u,
         &dword_2A1E0,
         0x25u,
         1u,
         0i64,
         &IoStatusBlock);
  if ( v6 )
  {
    v7 = IofCallDriver(DeviceObject, v6);
    if ( v7 < 0 )
    {
      if ( off_2A148 != &off_2A148
        && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
        && *((_BYTE *)off_2A148 + 169) >= 2u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 19), 0x18u, (__int64)&unk_28C68);
      }
      if ( _bittest(&v7, 0x1Du) )
        return (unsigned __int16)v7;
      if ( (v7 & 0xC0000000) == 0 )
        return 0;
      if ( v7 != -1073741811 )
      {
        switch ( v7 )
        {
          case -1073741801:
            return 3;
          case -1073741776:
            return 4;
          case -1073741670:
            return 3;
        }
        if ( v7 <= -1073741586 )
          return 1;
        if ( v7 > -1073741574 )
        {
          if ( v7 == -1073741275 )
            return v1;
          return 1;
        }
      }
      return 4;
    }
    sub_1CF84(&FastMutex);
    if ( sub_1D044(&FastMutex) )
    {
      if ( qword_2A1F4 && qword_2A1FC )
      {
        sub_1B0E8((PRKEVENT)Event);
        sub_1D0AC(&FastMutex);
      }
    }
    else
    {
      v8 = (void **)off_2A148;
      if ( off_2A148 == &off_2A148 )
      {
LABEL_64:
        ObfDereferenceObject(FileObject);
        byte_2A204 = 1;
        v0 = (void **)off_2A148;
        if ( off_2A148 == &off_2A148
          || !_bittest((const signed __int32 *)off_2A148 + 43, 9u)
          || *((_BYTE *)off_2A148 + 169) < 5u )
        {
          return 0i64;
        }
        v2 = 27;
        goto LABEL_68;
      }
      if ( !_bittest((const signed __int32 *)off_2A148 + 43, 9u) || *((_BYTE *)off_2A148 + 169) < 2u )
      {
LABEL_60:
        if ( v8 != &off_2A148 && _bittest((const signed __int32 *)v8 + 43, 9u) && *((_BYTE *)v8 + 169) >= 5u )
          sub_13878((__int64)v8[19], 0x1Au, (__int64)&unk_28C68, qword_2A1F4, qword_2A1FC);
        goto LABEL_64;
      }
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x19u, (__int64)&unk_28C68);
    }
    v8 = (void **)off_2A148;
    goto LABEL_60;
  }
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
    && *((_BYTE *)off_2A148 + 169) >= 2u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x17u, (__int64)&unk_28C68);
  }
  return 7i64;
}
// 2A148: using guessed type void *off_2A148;
// 2A1E0: using guessed type int dword_2A1E0;
// 2A1F4: using guessed type __int64 qword_2A1F4;
// 2A1FC: using guessed type __int64 qword_2A1FC;
// 2A204: using guessed type char byte_2A204;

//----- (0000000000011EC0) ----------------------------------------------------
__int64 __fastcall sub_11EC0(__int64 a1, IRP *a2)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 2) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Cu, (__int64)&unk_28C68);
  a2->IoStatus.Status = 0;
  a2->IoStatus.Information = 0i64;
  IofCompleteRequest(a2, 0);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 2) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_1102C(*((_QWORD *)off_2A148 + 27), 0x1Du, (__int64)&unk_28C68, 0);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000011F6C) ----------------------------------------------------
__int64 __fastcall sub_11F6C(__int64 a1, IRP *a2)
{
  unsigned int v3; // esi
  void **v4; // rcx
  int v5; // er9
  unsigned int v6; // ebx

  v3 = 0;
  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 2) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Eu, (__int64)&unk_28C68);
    v4 = (void **)off_2A148;
  }
  v5 = a2->Tail.Overlay.CurrentStackLocation->Parameters.Read.ByteOffset.LowPart;
  if ( v5 == 2244224 )
  {
    if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 236) & 2) != 0 && *((_BYTE *)v4 + 233) >= 5u )
      sub_11008((__int64)v4[27], 0x1Fu, (__int64)&unk_28C68);
    if ( (unsigned __int8)sub_1DF10(0x2023001u) )
    {
      v3 = 37;
      memmove(&dword_2A1E0, a2->AssociatedIrp.MasterIrp, 0x25ui64);
      dword_2A1E0 = 5;
      qword_2A1F4 = (__int64)sub_13054;
      qword_2A1FC = (__int64)sub_134A8;
      memmove(a2->AssociatedIrp.MasterIrp, &dword_2A1E0, 0x25ui64);
      sub_1CF84(&FastMutex);
      byte_2A204 = 1;
      if ( sub_1D044(&FastMutex) )
      {
        if ( qword_2A1F4 && qword_2A1FC )
        {
          if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 2) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
            sub_11008(*((_QWORD *)off_2A148 + 27), 0x21u, (__int64)&unk_28C68);
          sub_1B0E8((PRKEVENT)Event);
          sub_1D0AC(&FastMutex);
        }
      }
      else if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 2) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 27), 0x22u, (__int64)&unk_28C68);
      }
      v6 = 0;
    }
    else
    {
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 2) != 0 && *((_BYTE *)off_2A148 + 233) >= 3u )
        sub_11008(*((_QWORD *)off_2A148 + 27), 0x20u, (__int64)&unk_28C68);
      v6 = -1073740976;
    }
  }
  else
  {
    if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 236) & 2) != 0 && *((_BYTE *)v4 + 233) >= 3u )
      sub_1102C((__int64)v4[27], 0x23u, (__int64)&unk_28C68, v5);
    v6 = -1073741811;
  }
  a2->IoStatus.Information = v3;
  a2->IoStatus.Status = v6;
  IofCompleteRequest(a2, 0);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 2) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_1102C(*((_QWORD *)off_2A148 + 27), 0x24u, (__int64)&unk_28C68, v6);
  return v6;
}
// 2A148: using guessed type void *off_2A148;
// 2A1E0: using guessed type int dword_2A1E0;
// 2A1F4: using guessed type __int64 qword_2A1F4;
// 2A1FC: using guessed type __int64 qword_2A1FC;
// 2A204: using guessed type char byte_2A204;

//----- (000000000001220C) ----------------------------------------------------
void sub_1220C()
{
  unsigned int v0; // ebx
  unsigned int v1; // eax
  _QWORD *v2; // rbx

  v0 = dword_2CEA0;
  v1 = ++dword_2A208;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 0xEu)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_1D110(*((_QWORD *)off_2A148 + 19), 0x25u, (__int64)&unk_28C68, v1);
    v1 = dword_2A208;
  }
  if ( v1 >= v0 )
  {
    v2 = sub_1B508((__int64)qword_2A270, 4, (__int64)sub_12318);
    if ( v2 )
    {
      if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
        sub_1A478(*((_QWORD *)off_2A148 + 11), 0x30u);
      sub_1CC2C((__int64)v2, 0);
    }
    dword_2A208 = 0;
  }
}
// 2A148: using guessed type void *off_2A148;
// 2A208: using guessed type int dword_2A208;
// 2CEA0: using guessed type int dword_2CEA0;

//----- (0000000000012318) ----------------------------------------------------
__int64 sub_12318()
{
  void **v0; // rcx
  __int64 result; // rax
  void **v2; // rcx

  v0 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( *((char *)off_2A148 + 236) < 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x26u, (__int64)&unk_28C68);
      v0 = (void **)off_2A148;
    }
    if ( v0 != &off_2A148 && _bittest((const signed __int32 *)v0 + 59, 0xBu) && *((_BYTE *)v0 + 233) >= 5u )
      sub_11008((__int64)v0[27], 0x2Au, (__int64)&unk_28BE8);
  }
  result = sub_257C8(qword_2CD20);
  if ( !(_DWORD)result )
    goto LABEL_14;
  v2 = (void **)off_2A148;
  if ( off_2A148 == &off_2A148 )
    return result;
  if ( _bittest((const signed __int32 *)off_2A148 + 59, 0xBu) && *((_BYTE *)off_2A148 + 233) >= 2u )
  {
    result = sub_1102C(*((_QWORD *)off_2A148 + 27), 0x2Bu, (__int64)&unk_28BE8, result);
LABEL_14:
    v2 = (void **)off_2A148;
  }
  if ( v2 != &off_2A148 )
  {
    if ( _bittest((const signed __int32 *)v2 + 59, 0xBu) && *((_BYTE *)v2 + 233) >= 5u )
    {
      result = sub_11008((__int64)v2[27], 0x2Cu, (__int64)&unk_28BE8);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 && *((char *)v2 + 236) < 0 && *((_BYTE *)v2 + 233) >= 5u )
      result = sub_11008((__int64)v2[27], 0x27u, (__int64)&unk_28C68);
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001245C) ----------------------------------------------------
__int64 sub_1245C()
{
  int v0; // eax
  unsigned int v1; // ebx
  __int64 v3[4]; // [rsp+20h] [rbp-C8h] BYREF
  int v4; // [rsp+40h] [rbp-A8h] BYREF
  char Dst[18]; // [rsp+44h] [rbp-A4h] BYREF
  char v6[110]; // [rsp+56h] [rbp-92h] BYREF
  int v7; // [rsp+C4h] [rbp-24h]
  char v8; // [rsp+C8h] [rbp-20h]

  v4 = 33697792;
  memmove(Dst, L"NNSHttps", 0x12ui64);
  memset(v6, 0, sizeof(v6));
  v3[3] = 0i64;
  v3[0] = (__int64)sub_1264C;
  v7 = 1937000526;
  v3[1] = (__int64)sub_12754;
  v8 = 15;
  v3[2] = (__int64)sub_12838;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 1) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xAu, (__int64)&unk_28C58);
  v0 = sub_1D3EC((__int64)&v4, 60i64, v3);
  v1 = v0;
  if ( v0 )
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 1) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
      sub_1102C(*((_QWORD *)off_2A148 + 27), 0xBu, (__int64)&unk_28C58, v0);
  }
  else
  {
    sub_1FD84(0);
    v1 = sub_1FE20();
    if ( v1 )
    {
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 1) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
        sub_11008(*((_QWORD *)off_2A148 + 27), 0xCu, (__int64)&unk_28C58);
      sub_20130();
    }
    else
    {
      v1 = sub_1D8E0();
      if ( !v1 )
      {
        sub_1FD84(1);
        goto LABEL_11;
      }
    }
  }
  sub_1DD54();
LABEL_11:
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 1) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xDu, (__int64)&unk_28C58);
  return v1;
}
// 275F0: using guessed type wchar_t aNnshttps[9];
// 2A148: using guessed type void *off_2A148;

//----- (000000000001264C) ----------------------------------------------------
char __fastcall sub_1264C(int a1, _DWORD *a2, _DWORD *a3, _DWORD *a4)
{
  char v4; // r10

  v4 = 1;
  switch ( a1 )
  {
    case 33697793:
      *a2 = 0;
      goto LABEL_3;
    case 33697794:
      *a2 = 4;
      goto LABEL_5;
    case 33697795:
      *a2 = 8;
      goto LABEL_3;
    case 33697796:
      *a2 = 12;
      goto LABEL_3;
    case 33697797:
      *a2 = 16;
LABEL_5:
      *a3 = 2;
      *a4 = 6;
      return v4;
    case 33697798:
      *a2 = 20;
      goto LABEL_3;
    case 33697799:
      *a2 = 24;
      goto LABEL_3;
    case 33697800:
      *a2 = 28;
      goto LABEL_3;
    case 33697801:
      *a2 = 32;
      goto LABEL_3;
    case 33697802:
      *a2 = 36;
      goto LABEL_3;
    case 33697803:
      *a2 = 40;
      goto LABEL_3;
    case 33697804:
      *a2 = 44;
      goto LABEL_3;
    case 33697805:
      *a2 = 48;
      goto LABEL_3;
    case 33697806:
      *a2 = 52;
      goto LABEL_3;
    case 33697807:
      *a2 = 56;
LABEL_3:
      *a3 = 4;
      *a4 = 0;
      break;
    default:
      v4 = 0;
      break;
  }
  return v4;
}

//----- (0000000000012754) ----------------------------------------------------
__int64 __fastcall sub_12754(__int64 a1)
{
  __int64 result; // rax

  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xEu, (__int64)&unk_28C58);
  }
  *(_WORD *)(a1 + 4) = 5;
  *(_DWORD *)(a1 + 12) = 2;
  *(_DWORD *)(a1 + 28) = 1073741825;
  *(_DWORD *)(a1 + 44) = 180;
  *(_DWORD *)(a1 + 8) = 10;
  *(_DWORD *)(a1 + 20) = 10;
  result = 128i64;
  *(_DWORD *)a1 = 1;
  *(_WORD *)(a1 + 16) = 1;
  *(_DWORD *)(a1 + 24) = 1;
  *(_DWORD *)(a1 + 48) = 128;
  *(_DWORD *)(a1 + 52) = 128;
  *(_DWORD *)(a1 + 32) = 1;
  *(_DWORD *)(a1 + 36) = 1;
  *(_DWORD *)(a1 + 40) = 1;
  *(_DWORD *)(a1 + 56) = 1;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    result = sub_11008(*((_QWORD *)off_2A148 + 19), 0xFu, (__int64)&unk_28C58);
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000012838) ----------------------------------------------------
void __fastcall sub_12838(const signed __int32 *a1)
{
  void **v2; // rcx
  int v3; // eax

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_12954(*((_QWORD *)off_2A148 + 19), 0x10u, (__int64)&unk_28C58, a1);
    v2 = (void **)off_2A148;
  }
  if ( (*(_BYTE *)a1 & 1) != 0 )
  {
    if ( (unsigned __int8)sub_1DF10(0x2023001u) == 1 )
      sub_11ACC();
    else
      sub_11974();
    v2 = (void **)off_2A148;
  }
  if ( (*(_BYTE *)a1 & 8) != 0 )
  {
    _InterlockedExchange(&dword_2CEA0, sub_1DF10(0x2023004u));
    v2 = (void **)off_2A148;
  }
  if ( (*(_BYTE *)a1 & 0x40) != 0 || *(char *)a1 < 0 || _bittest(a1, 0xCu) || _bittest(a1, 0xDu) )
  {
    sub_13620(1);
    v2 = (void **)off_2A148;
  }
  if ( _bittest(a1, 0xEu) )
  {
    v3 = sub_1DF10(0x202300Fu);
    v2 = (void **)off_2A148;
    dword_2CEA4 = v3;
  }
  if ( v2 != &off_2A148 && _bittest((const signed __int32 *)v2 + 43, 8u) && *((_BYTE *)v2 + 169) >= 5u )
    sub_11008((__int64)v2[19], 0x11u, (__int64)&unk_28C58);
}
// 2A148: using guessed type void *off_2A148;
// 2CEA0: using guessed type int dword_2CEA0;
// 2CEA4: using guessed type int dword_2CEA4;

//----- (0000000000012954) ----------------------------------------------------
__int64 sub_12954(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+68h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_2A1B8(a1, 43i64, a3, a2, (__int64 *)va);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000012990) ----------------------------------------------------
__int64 sub_12990(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_2A1B8(a1, 43i64, &unk_28C48, 33i64, (__int64 *)va);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000129E8) ----------------------------------------------------
__int64 sub_129E8()
{
  unsigned int v0; // ebx
  unsigned int v1; // edi
  unsigned int v2; // esi

  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 1) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xAu, (__int64)&unk_28C48);
  v0 = sub_1245C();
  if ( !v0 )
  {
    byte_2A205 = 1;
    sub_16420();
    sub_19704();
    v1 = sub_1DF10(0x2023002u);
    if ( v1 )
    {
      if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
        sub_1A478(*((_QWORD *)off_2A148 + 11), 0x2Cu);
      qword_2A218 = (PVOID)sub_1C558(v1, 1);
      if ( !qword_2A218 )
        goto LABEL_18;
      v2 = sub_1DF10(0x2023005u);
      if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
        sub_1A478(*((_QWORD *)off_2A148 + 11), 0x2Bu);
      qword_2A270 = (PVOID)sub_1C558(v2, 0);
      if ( qword_2A270 )
        dword_2A20C = v1;
      else
LABEL_18:
        v0 = 3;
    }
    else
    {
      v0 = 6;
    }
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 1) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xBu, (__int64)&unk_28C48);
  return v0;
}
// 2A148: using guessed type void *off_2A148;
// 2A205: using guessed type char byte_2A205;
// 2A20C: using guessed type int dword_2A20C;

//----- (0000000000012B94) ----------------------------------------------------
__int64 sub_12B94()
{
  unsigned int v0; // ebx
  void **v1; // rcx

  v0 = 0;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xEu, (__int64)&unk_28C48);
  }
  sub_12D38();
  if ( sub_1B008((struct _KEVENT **)&Event, 0) )
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 0x10) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x27u);
    if ( sub_1C048(&Object, (__int64)sub_12F3C, 0i64) == 1 )
    {
      v1 = (void **)off_2A148;
    }
    else
    {
      v1 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148
        && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
        && *((_BYTE *)off_2A148 + 169) >= 2u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 19), 0x10u, (__int64)&unk_28C48);
        v1 = (void **)off_2A148;
      }
      v0 = 1;
    }
  }
  else
  {
    v1 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
      && *((_BYTE *)off_2A148 + 169) >= 2u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 19), 0xFu, (__int64)&unk_28C48);
      v1 = (void **)off_2A148;
    }
    v0 = 6;
  }
  if ( v1 != &off_2A148 && _bittest((const signed __int32 *)v1 + 43, 9u) && *((_BYTE *)v1 + 169) >= 5u )
    sub_11008((__int64)v1[19], 0x11u, (__int64)&unk_28C48);
  return v0;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000012D38) ----------------------------------------------------
__int64 sub_12D38()
{
  void **v0; // rcx
  PVOID v1; // rax
  PVOID v2; // rbx

  v0 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x12u, (__int64)&unk_28C48);
    v0 = (void **)off_2A148;
  }
  if ( Event )
  {
    if ( v0 != &off_2A148 && _bittest((const signed __int32 *)v0 + 43, 9u) && *((_BYTE *)v0 + 169) >= 5u )
      sub_11008((__int64)v0[19], 0x13u, (__int64)&unk_28C48);
    sub_1B0E8((PRKEVENT)Event);
    v0 = (void **)off_2A148;
  }
  v1 = Object;
  if ( Object )
  {
    if ( v0 != &off_2A148 && _bittest((const signed __int32 *)v0 + 43, 9u) && *((_BYTE *)v0 + 169) >= 5u )
    {
      sub_11008((__int64)v0[19], 0x14u, (__int64)&unk_28C48);
      v1 = Object;
    }
    sub_1B67C(v1);
    v2 = Object;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 0x10) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x28u);
    sub_1C1B8(v2);
    Object = 0i64;
    v0 = (void **)off_2A148;
  }
  if ( Event )
  {
    if ( v0 != &off_2A148 && _bittest((const signed __int32 *)v0 + 43, 9u) && *((_BYTE *)v0 + 169) >= 5u )
      sub_11008((__int64)v0[19], 0x15u, (__int64)&unk_28C48);
    sub_1B080(Event);
    Event = 0i64;
    v0 = (void **)off_2A148;
  }
  if ( v0 != &off_2A148 && _bittest((const signed __int32 *)v0 + 43, 9u) && *((_BYTE *)v0 + 169) >= 5u )
    sub_11008((__int64)v0[19], 0x16u, (__int64)&unk_28C48);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000012F3C) ----------------------------------------------------
__int64 sub_12F3C()
{
  void **v0; // rcx
  __int64 result; // rax

  v0 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( _bittest((const signed __int32 *)off_2A148 + 43, 9u) && *((_BYTE *)off_2A148 + 169) >= 5u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x17u, (__int64)&unk_28C48);
      v0 = (void **)off_2A148;
    }
    if ( v0 != &off_2A148 && _bittest((const signed __int32 *)v0 + 43, 9u) && *((_BYTE *)v0 + 169) >= 4u )
      sub_11008((__int64)v0[19], 0x18u, (__int64)&unk_28C48);
  }
  sub_1B67C(Event);
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
    && *((_BYTE *)off_2A148 + 169) >= 4u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x19u, (__int64)&unk_28C48);
  }
  result = sub_13620(0);
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    result = sub_11008(*((_QWORD *)off_2A148 + 19), 0x1Au, (__int64)&unk_28C48);
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000013054) ----------------------------------------------------
__int64 __fastcall sub_13054(__int64 a1, _QWORD *a2)
{
  unsigned int v4; // esi
  void **v5; // rcx
  __int64 v7; // rdx
  __int64 v8; // r8
  __int64 v9; // rax
  unsigned int v10; // eax
  void **v11; // rcx
  __int64 v12; // [rsp+20h] [rbp-48h]
  _QWORD *v13; // [rsp+30h] [rbp-38h] BYREF
  PVOID P; // [rsp+38h] [rbp-30h] BYREF
  __int64 v15; // [rsp+40h] [rbp-28h]

  v4 = 0;
  v5 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Bu, (__int64)&unk_28C48);
    v5 = (void **)off_2A148;
  }
  if ( !a2 )
  {
    if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 0x20) != 0 && *((_BYTE *)v5 + 233) >= 2u )
      sub_11008((__int64)v5[27], 0x1Cu, (__int64)&unk_28C48);
    return 4i64;
  }
  switch ( *(_DWORD *)a1 )
  {
    case 1:
      v13 = 0i64;
      P = 0i64;
      v15 = 0i64;
      if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 0x20) != 0 && *((_BYTE *)v5 + 233) >= 4u )
        sub_12954((__int64)v5[27], 0x1Du, (__int64)&unk_28C48, a2);
      HIDWORD(v12) = 0;
      if ( !sub_1B008((struct _KEVENT **)&P, 0) )
      {
        v5 = (void **)off_2A148;
        if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
        {
          sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Eu, (__int64)&unk_28C48);
          v5 = (void **)off_2A148;
        }
        v4 = 3;
        goto LABEL_77;
      }
      v9 = *(_QWORD *)(a1 + 12);
      v13 = a2;
      v15 = v9;
      if ( !*((_DWORD *)a2 + 6) && !*((_BYTE *)a2 + 32) )
        goto LABEL_75;
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
        sub_12954(*((_QWORD *)off_2A148 + 27), 0x1Fu, (__int64)&unk_28C48, &v13, 0i64, 0);
      v10 = sub_13AD0((__int64)&v13);
      v4 = v10;
      if ( v10 )
      {
        v11 = (void **)off_2A148;
        if ( off_2A148 == &off_2A148 )
        {
LABEL_75:
          sub_1B080(P);
          break;
        }
        if ( (*((_BYTE *)off_2A148 + 236) & 0x20) == 0 || *((_BYTE *)off_2A148 + 233) < 4u )
        {
LABEL_71:
          if ( v11 != &off_2A148 && (*((_BYTE *)v11 + 236) & 0x20) != 0 && *((_BYTE *)v11 + 233) >= 4u )
            sub_12954((__int64)v11[27], 0x22u, (__int64)&unk_28C48, &v13);
          goto LABEL_75;
        }
        LODWORD(v12) = v10;
        sub_12990(*((_QWORD *)off_2A148 + 27), 33i64, (__int64)&unk_28C48, &v13, v12);
      }
      else
      {
        if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
          sub_12954(*((_QWORD *)off_2A148 + 27), 0x20u, (__int64)&unk_28C48, &v13);
        sub_1B67C(P);
      }
      v11 = (void **)off_2A148;
      goto LABEL_71;
    case 2:
      if ( v5 != &off_2A148 )
      {
        if ( (*((_BYTE *)v5 + 236) & 0x20) != 0 && *((_BYTE *)v5 + 233) >= 4u )
        {
          sub_12954((__int64)v5[27], 0x23u, (__int64)&unk_28C48, a2);
          v5 = (void **)off_2A148;
        }
        if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 0x20) != 0 && *((_BYTE *)v5 + 233) >= 4u )
          sub_1102C((__int64)v5[27], 0x24u, (__int64)&unk_28C48, *((_DWORD *)a2 + 2));
      }
      sub_1602C(*a2);
      if ( *((_DWORD *)a2 + 2) == 2 )
      {
        if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
          sub_12954(*((_QWORD *)off_2A148 + 27), 0x25u, (__int64)&unk_28C48, *a2);
        v4 = sub_16B70(*a2, v7, v8);
      }
      break;
    case 0xA:
      if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 0x20) != 0 && *((_BYTE *)v5 + 233) >= 4u )
        sub_12954((__int64)v5[27], 0x26u, (__int64)&unk_28C48, a2);
      sub_14AFC((__int64)a2);
      break;
    case 0xB:
      if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 0x20) != 0 && *((_BYTE *)v5 + 233) >= 4u )
        sub_12954((__int64)v5[27], 0x27u, (__int64)&unk_28C48, a2);
      sub_14A10(a2);
      break;
    default:
      if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 0x20) != 0 && *((_BYTE *)v5 + 233) >= 4u )
      {
        sub_11008((__int64)v5[27], 0x28u, (__int64)&unk_28C48);
        v5 = (void **)off_2A148;
      }
      v4 = 4;
      goto LABEL_77;
  }
  v5 = (void **)off_2A148;
LABEL_77:
  if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 0x20) != 0 && *((_BYTE *)v5 + 233) >= 5u )
    sub_11008((__int64)v5[27], 0x29u, (__int64)&unk_28C48);
  return v4;
}
// 13272: variable 'v7' is possibly undefined
// 13272: variable 'v8' is possibly undefined
// 13405: variable 'v12' is possibly undefined
// 2A148: using guessed type void *off_2A148;

//----- (00000000000134A8) ----------------------------------------------------
__int64 sub_134A8()
{
  int v0; // eax
  unsigned int v1; // ebx

  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x2Au, (__int64)&unk_28C48);
  }
  sub_1CFE4(&FastMutex);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x11u, (__int64)&unk_28C18);
  v0 = sub_23684(qword_2CD28);
  if ( v0 )
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
      sub_1102C(*((_QWORD *)off_2A148 + 27), 0x12u, (__int64)&unk_28C18, v0);
  }
  else if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x13u, (__int64)&unk_28C18);
  }
  memset(&dword_2A1E0, 0, 0x25ui64);
  byte_2A204 = 0;
  v1 = sub_12B94();
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x2Bu, (__int64)&unk_28C48);
  }
  return v1;
}
// 2A148: using guessed type void *off_2A148;
// 2A1E0: using guessed type int dword_2A1E0;
// 2A204: using guessed type char byte_2A204;

//----- (0000000000013620) ----------------------------------------------------
__int64 __fastcall sub_13620(char a1)
{
  unsigned int v1; // ebx
  int v3; // eax
  int v5[2]; // [rsp+20h] [rbp-38h] BYREF
  int v6; // [rsp+28h] [rbp-30h]
  int v7; // [rsp+30h] [rbp-28h] BYREF
  char Dst[17]; // [rsp+34h] [rbp-24h] BYREF

  v1 = 0;
  v5[0] = 0;
  v7 = 0;
  v5[1] = 0;
  v6 = 0;
  memset(Dst, 0, sizeof(Dst));
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x2Cu, (__int64)&unk_28C48);
  }
  v7 = 5;
  *(_DWORD *)&Dst[1] = 1;
  v3 = sub_1DF10(0x2023008u);
  Dst[0] = a1;
  *(_DWORD *)&Dst[5] = v3;
  *(_DWORD *)&Dst[9] = sub_1DF10(0x202300Du);
  v5[0] = 20;
  v6 = 21;
  *(_DWORD *)&Dst[13] = sub_1DF10(0x202300Eu);
  if ( sub_1D044(&FastMutex) )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
      && *((_BYTE *)off_2A148 + 169) >= 4u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x2Du, (__int64)&unk_28C48);
    }
    if ( (unsigned int)qword_2A1E4(5i64, v5, &v7) )
    {
      if ( off_2A148 != &off_2A148
        && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
        && *((_BYTE *)off_2A148 + 169) >= 2u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 19), 0x2Eu, (__int64)&unk_28C48);
      }
      v1 = 11;
    }
    else if ( off_2A148 != &off_2A148
           && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
           && *((_BYTE *)off_2A148 + 169) >= 4u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x2Fu, (__int64)&unk_28C48);
    }
    sub_1D0AC(&FastMutex);
  }
  else if ( off_2A148 != &off_2A148
         && _bittest((const signed __int32 *)off_2A148 + 43, 9u)
         && *((_BYTE *)off_2A148 + 169) >= 2u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x30u, (__int64)&unk_28C48);
  }
  return v1;
}
// 2A148: using guessed type void *off_2A148;
// 2A1E4: using guessed type __int64 (__fastcall *qword_2A1E4)(_QWORD, _QWORD, _QWORD);

//----- (0000000000013814) ----------------------------------------------------
__int64 __fastcall sub_13814(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_2A1B8(a1, 43i64, &unk_28C38, 60i64, &v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000013878) ----------------------------------------------------
__int64 sub_13878(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_2A1B8(a1, 43i64, a3, a2, (__int64 *)va);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000138C0) ----------------------------------------------------
__int64 sub_138C0(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_2A1B8(a1, 43i64, &unk_28C38, 53i64, (__int64 *)va);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001392C) ----------------------------------------------------
__int64 sub_1392C(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_2A1B8(a1, 43i64, &unk_28C38, 56i64, (__int64 *)va);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001399C) ----------------------------------------------------
__int64 __fastcall sub_1399C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_2A1B8(a1, 43i64, a3, a2, &v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000139F0) ----------------------------------------------------
__int64 __fastcall sub_139F0(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_2A1B8(a1, 43i64, a3, a2, v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000013A50) ----------------------------------------------------
__int64 __fastcall sub_13A50(__int64 a1, __int64 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_2A1B8(a1, 43i64, &unk_28C38, 45i64, v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000013AD0) ----------------------------------------------------
__int64 __fastcall sub_13AD0(__int64 a1)
{
  unsigned int v2; // ebx
  _QWORD *v3; // rax
  __int64 v4; // rdi
  void **v5; // rcx
  unsigned int v6; // esi

  v2 = 0;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xAu, (__int64)&unk_28C38);
  v3 = sub_1B508((__int64)qword_2A218, 8, (__int64)sub_13C54);
  v4 = (__int64)v3;
  if ( v3 )
  {
    *v3 = a1;
    v6 = (**(_DWORD **)a1 + *(_DWORD *)(*(_QWORD *)a1 + 8i64)) % (unsigned int)dword_2A20C;
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x31u);
    sub_1CC2C(v4, v6 + 1);
    v5 = (void **)off_2A148;
  }
  else
  {
    v5 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0xBu, (__int64)&unk_28C38);
      v5 = (void **)off_2A148;
    }
    v2 = 3;
  }
  if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 4) != 0 && *((_BYTE *)v5 + 233) >= 5u )
    sub_1102C((__int64)v5[27], 0xCu, (__int64)&unk_28C38, v2);
  return v2;
}
// 2A148: using guessed type void *off_2A148;
// 2A20C: using guessed type int dword_2A20C;

//----- (0000000000013C54) ----------------------------------------------------
int __fastcall sub_13C54(unsigned __int64 ***a1)
{
  void **v2; // rcx
  unsigned __int64 **v3; // rbx
  __int64 v4; // rdi
  void **v5; // r10
  __int64 v6; // rax
  int result; // eax
  int v8; // [rsp+30h] [rbp-28h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+38h] [rbp-20h] BYREF

  v8 = 0;
  BugCheckParameter1 = 0i64;
  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xDu, (__int64)&unk_28C38);
    v2 = (void **)off_2A148;
  }
  v3 = *a1;
  if ( !*v3 )
  {
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 236) & 4) != 0 && *((_BYTE *)v2 + 233) >= 2u )
      sub_11008((__int64)v2[27], 0x14u, (__int64)&unk_28C38);
    result = sub_1B0E8((PRKEVENT)v3[1]);
    goto LABEL_41;
  }
  v4 = sub_16A10(**v3, &BugCheckParameter1, &v8);
  if ( v4 )
  {
    v5 = (void **)off_2A148;
    if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 236) & 4) == 0 || *((_BYTE *)off_2A148 + 233) < 4u )
      goto LABEL_23;
    sub_13878(*((_QWORD *)off_2A148 + 27), 0xFu, (__int64)&unk_28C38, **v3, (*v3)[1]);
LABEL_22:
    v5 = (void **)off_2A148;
LABEL_23:
    if ( *(_DWORD *)(v4 + 32) == *((_DWORD *)*v3 + 7) )
    {
      if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 4) != 0 && *((_BYTE *)v5 + 233) >= 5u )
        sub_11008((__int64)v5[27], 0x12u, (__int64)&unk_28C38);
      sub_13F3C((__int64)v3, v4);
    }
    else
    {
      if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 4) != 0 && *((_BYTE *)v5 + 233) >= 5u )
        sub_11008((__int64)v5[27], 0x13u, (__int64)&unk_28C38);
      sub_141E4((__int64)v3, v4);
    }
    result = sub_1B0E8((PRKEVENT)v3[1]);
    if ( BugCheckParameter1 )
      result = sub_16CB8(BugCheckParameter1);
LABEL_41:
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
      result = sub_11008(*((_QWORD *)off_2A148 + 27), 0x15u, (__int64)&unk_28C38);
    return result;
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
    sub_13878(*((_QWORD *)off_2A148 + 27), 0x10u, (__int64)&unk_28C38, **v3, (*v3)[1]);
  v6 = sub_167B0(**v3, (*v3)[1], (ULONG_PTR **)&BugCheckParameter1, &v8);
  v4 = v6;
  if ( v6 )
  {
    *(_DWORD *)(v6 + 32) = *((_DWORD *)*v3 + 7);
    goto LABEL_22;
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
    sub_1102C(*((_QWORD *)off_2A148 + 27), 0x11u, (__int64)&unk_28C38, v8);
  return sub_1B0E8((PRKEVENT)v3[1]);
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000013F3C) ----------------------------------------------------
__int64 __fastcall sub_13F3C(__int64 a1, __int64 a2)
{
  unsigned int v2; // er12
  void **v5; // rcx
  unsigned int v7; // edi
  __int64 v8; // rsi
  unsigned __int16 v9; // dx
  unsigned int v10; // [rsp+68h] [rbp+10h] BYREF
  char *v11; // [rsp+70h] [rbp+18h] BYREF

  v2 = 0;
  v11 = 0i64;
  v10 = 0;
  v5 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x16u, (__int64)&unk_28C38);
    v5 = (void **)off_2A148;
  }
  if ( *(_BYTE *)(a2 + 74) )
  {
    if ( !sub_16D98(*(_BYTE **)(*(_QWORD *)a1 + 16i64)) )
    {
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
        sub_11008(*((_QWORD *)off_2A148 + 27), 0x17u, (__int64)&unk_28C38);
      *(_BYTE *)(a2 + 44) = 1;
    }
    *(_BYTE *)(a2 + 74) = 0;
    v5 = (void **)off_2A148;
  }
  if ( *(_BYTE *)(a2 + 44) )
  {
    if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 4) != 0 && *((_BYTE *)v5 + 233) >= 5u )
      sub_12954((__int64)v5[27], 0x18u, (__int64)&unk_28C38, *(_QWORD *)(a2 + 16));
    return 0i64;
  }
  v7 = *(_DWORD *)(*(_QWORD *)a1 + 24i64);
  v8 = *(_QWORD *)(*(_QWORD *)a1 + 16i64);
  if ( v7 )
  {
    do
    {
      if ( *(_BYTE *)(a2 + 1106) )
        break;
      sub_16E6C(v8, v7, (char **)(a2 + 56), &v11, &v10);
      if ( v11 )
      {
        v2 = sub_17E40(1u, (unsigned __int8 *)v11, a2 + 76);
        sub_17518(a2 + 56);
        if ( v2 )
          break;
      }
      v8 += v10;
      v7 -= v10;
    }
    while ( v7 );
    v5 = (void **)off_2A148;
  }
  if ( *(_DWORD *)(a2 + 1197) == 2 )
  {
    *(_BYTE *)(a2 + 44) = 1;
    v5 = (void **)off_2A148;
    if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 236) & 4) == 0 || *((_BYTE *)off_2A148 + 233) < 5u )
      goto LABEL_36;
    v9 = 25;
  }
  else
  {
    if ( !*(_BYTE *)(a2 + 1106) )
      goto LABEL_36;
    *(_BYTE *)(a2 + 44) = 1;
    v5 = (void **)off_2A148;
    if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 236) & 4) == 0 || *((_BYTE *)off_2A148 + 233) < 5u )
      goto LABEL_36;
    v9 = 26;
  }
  sub_12954((__int64)v5[27], v9, (__int64)&unk_28C38, *(_QWORD *)(a2 + 16));
  v5 = (void **)off_2A148;
LABEL_36:
  if ( *(_BYTE *)(a2 + 44) )
  {
    if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 4) != 0 && *((_BYTE *)v5 + 233) >= 5u )
      sub_12954((__int64)v5[27], 0x1Bu, (__int64)&unk_28C38, *(_QWORD *)(a2 + 16));
    sub_143F8(a1, a2);
    v5 = (void **)off_2A148;
  }
  if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 4) != 0 && *((_BYTE *)v5 + 233) >= 5u )
    sub_1102C((__int64)v5[27], 0x1Cu, (__int64)&unk_28C38, v2);
  return v2;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000141E4) ----------------------------------------------------
__int64 __fastcall sub_141E4(__int64 a1, __int64 a2)
{
  unsigned int v2; // er12
  void **v5; // rcx
  __int64 result; // rax
  unsigned int v7; // edi
  __int64 v8; // rsi
  void **v9; // rcx
  unsigned int v10; // [rsp+68h] [rbp+10h] BYREF
  char *v11; // [rsp+70h] [rbp+18h] BYREF

  v2 = 0;
  v11 = 0i64;
  v10 = 0;
  v5 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Du, (__int64)&unk_28C38);
    v5 = (void **)off_2A148;
  }
  if ( *(_BYTE *)(a2 + 44) )
  {
    if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 4) != 0 && *((_BYTE *)v5 + 233) >= 5u )
      sub_12954((__int64)v5[27], 0x1Eu, (__int64)&unk_28C38, *(_QWORD *)(a2 + 16));
    result = 0i64;
  }
  else
  {
    v7 = *(_DWORD *)(*(_QWORD *)a1 + 24i64);
    v8 = *(_QWORD *)(*(_QWORD *)a1 + 16i64);
    if ( v7 )
    {
      do
      {
        if ( *(_BYTE *)(a2 + 1105) )
          break;
        if ( *(_BYTE *)(a2 + 1106) )
          break;
        sub_16E6C(v8, v7, (char **)(a2 + 56), &v11, &v10);
        if ( v11 )
        {
          v2 = sub_17E40(2u, (unsigned __int8 *)v11, a2 + 76);
          sub_17518(a2 + 56);
          if ( v2 )
            break;
        }
        v8 += v10;
        v7 -= v10;
      }
      while ( v7 );
      v5 = (void **)off_2A148;
    }
    if ( *(_BYTE *)(a2 + 1106) || *(_BYTE *)(a2 + 1105) )
    {
      *(_BYTE *)(a2 + 44) = 1;
      v9 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148 )
      {
        if ( (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
        {
          sub_12954(*((_QWORD *)off_2A148 + 27), 0x1Fu, (__int64)&unk_28C38, *(_QWORD *)(a2 + 16));
          v9 = (void **)off_2A148;
        }
        if ( v9 != &off_2A148 && (*((_BYTE *)v9 + 236) & 4) != 0 && *((_BYTE *)v9 + 233) >= 5u )
          sub_12954((__int64)v9[27], 0x20u, (__int64)&unk_28C38, *(_QWORD *)(a2 + 16));
      }
      sub_143F8(a1, a2);
      v5 = (void **)off_2A148;
    }
    if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 4) != 0 && *((_BYTE *)v5 + 233) >= 5u )
      sub_11008((__int64)v5[27], 0x21u, (__int64)&unk_28C38);
    result = v2;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000143F8) ----------------------------------------------------
__int64 __fastcall sub_143F8(__int64 a1, __int64 a2)
{
  unsigned int v2; // edi
  int v5; // eax
  unsigned __int64 v6; // rcx
  __int64 v7; // rax
  __int64 v8; // rbp
  unsigned int v10; // [rsp+58h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+60h] [rbp+18h] BYREF

  v2 = 0;
  BugCheckParameter1 = 0i64;
  v10 = 0;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x22u, (__int64)&unk_28C38);
  if ( (unsigned int)sub_1DF10(0x202300Bu) )
  {
    sub_1465C(a2 + 76);
    v5 = *(_DWORD *)(a2 + 1197);
    if ( v5 != 2 && v5 != 3 )
    {
      v6 = *(_QWORD *)(a2 + 1181);
      if ( v6 )
      {
        v7 = sub_19D54(v6, &BugCheckParameter1, &v10);
        v2 = v10;
        v8 = v7;
        if ( v10 )
        {
          if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
            sub_11008(*((_QWORD *)off_2A148 + 27), 0x24u, (__int64)&unk_28C38);
        }
        else
        {
          *(_DWORD *)(a2 + 1197) = 5;
          sub_2631C((void *)(a2 + 76), 0x400ui64, (const void *)(v7 + 8), *(unsigned int *)(v7 + 1032));
          *(_DWORD *)(a2 + 1100) = *(_DWORD *)(v8 + 1032);
          if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
            sub_139F0(*((_QWORD *)off_2A148 + 27), 0x23u, (__int64)&unk_28C38, (const char *)(a2 + 76));
          v2 = sub_19FC8(BugCheckParameter1);
        }
      }
    }
  }
  if ( !*(_DWORD *)(a2 + 1100) )
  {
    v2 = sub_1516C(a1, (char *)(a2 + 76), (_DWORD *)(a2 + 1100));
    if ( v2 )
    {
      *(_DWORD *)(a2 + 1197) = 0;
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
        sub_11008(*((_QWORD *)off_2A148 + 27), 0x26u, (__int64)&unk_28C38);
    }
    else
    {
      *(_DWORD *)(a2 + 1197) = 4;
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
        sub_139F0(*((_QWORD *)off_2A148 + 27), 0x25u, (__int64)&unk_28C38, (const char *)(a2 + 76));
    }
  }
  sub_14D40(a1, a2);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_1102C(*((_QWORD *)off_2A148 + 27), 0x27u, (__int64)&unk_28C38, v2);
  return v2;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001465C) ----------------------------------------------------
__int64 __fastcall sub_1465C(__int64 a1)
{
  unsigned int v1; // esi
  void **v3; // rax
  int v4; // eax
  unsigned __int64 v5; // rax
  unsigned __int64 v6; // rbx
  __int64 v7; // rdx
  __int64 v8; // r8
  void **v10; // rcx
  unsigned __int16 v11; // dx
  __int64 v12; // rdx
  __int64 v13; // r8
  unsigned __int64 v14; // rcx
  int v15; // eax
  unsigned int v16; // [rsp+60h] [rbp+8h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+68h] [rbp+10h] BYREF

  v1 = 0;
  BugCheckParameter1 = 0i64;
  v16 = 0;
  v3 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x28u, (__int64)&unk_28C38);
      v3 = (void **)off_2A148;
    }
    if ( v3 != &off_2A148 && (*((_BYTE *)v3 + 236) & 4) != 0 && *((_BYTE *)v3 + 233) >= 4u )
    {
      v4 = sub_1A404();
      sub_1102C(*((_QWORD *)off_2A148 + 27), 0x29u, (__int64)&unk_28C38, v4);
    }
  }
  v5 = sub_1A070(0i64, 0);
  v6 = *(_QWORD *)(a1 + 1097);
  if ( *(_QWORD *)(a1 + 1105) != v5 )
  {
    if ( v6 == sub_1A070(0i64, 0) )
    {
      sub_19AA8(a1, (ULONG_PTR **)&BugCheckParameter1, &v16);
      v1 = v16;
      if ( !v16 )
      {
        if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
          sub_13A50(*((_QWORD *)off_2A148 + 27), v16 + 45, (__int64)&unk_28C38, (const char *)a1);
        v1 = sub_19FC8(BugCheckParameter1);
        goto LABEL_53;
      }
      v10 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148 )
      {
        if ( (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
        {
          sub_139F0(*((_QWORD *)off_2A148 + 27), 0x2Eu, (__int64)&unk_28C38, (const char *)a1);
LABEL_53:
          v10 = (void **)off_2A148;
          goto LABEL_54;
        }
        goto LABEL_54;
      }
    }
    else
    {
      v14 = *(_QWORD *)(a1 + 1105);
      if ( v6 == v14 )
      {
        sub_19D54(v14, &BugCheckParameter1, &v16);
        v1 = v16;
        if ( !v16 )
        {
          sub_1A140(BugCheckParameter1);
          if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
            sub_12954(*((_QWORD *)off_2A148 + 27), v1 + 47, (__int64)&unk_28C38, *(_QWORD *)(a1 + 1105));
          sub_19FC8(BugCheckParameter1);
        }
        goto LABEL_53;
      }
      if ( (unsigned int)sub_19EB4(v6, v12, v13) )
      {
        v10 = (void **)off_2A148;
        if ( off_2A148 != &off_2A148 )
        {
          if ( (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
          {
            v11 = 49;
            goto LABEL_52;
          }
          goto LABEL_54;
        }
      }
      else
      {
        v10 = (void **)off_2A148;
        if ( off_2A148 != &off_2A148 )
        {
          if ( (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
          {
            v11 = 48;
            goto LABEL_52;
          }
          goto LABEL_54;
        }
      }
    }
    return v1;
  }
  if ( v6 != sub_1A070(0i64, 0) )
  {
    if ( (unsigned int)sub_19EB4(v6, v7, v8) )
    {
      v10 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148 )
      {
        if ( (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 3u )
        {
          v11 = 44;
          goto LABEL_52;
        }
LABEL_54:
        if ( v10 != &off_2A148 )
        {
          if ( (*((_BYTE *)v10 + 236) & 4) != 0 && *((_BYTE *)v10 + 233) >= 4u )
          {
            v15 = sub_1A404();
            sub_1102C(*((_QWORD *)off_2A148 + 27), 0x32u, (__int64)&unk_28C38, v15);
            v10 = (void **)off_2A148;
          }
          if ( v10 != &off_2A148 && (*((_BYTE *)v10 + 236) & 4) != 0 && *((_BYTE *)v10 + 233) >= 5u )
            sub_1102C((__int64)v10[27], 0x33u, (__int64)&unk_28C38, v1);
        }
        return v1;
      }
    }
    else
    {
      v10 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148 )
      {
        if ( (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
        {
          v11 = 43;
LABEL_52:
          sub_12954((__int64)v10[27], v11, (__int64)&unk_28C38, *(_QWORD *)(a1 + 1097));
          goto LABEL_53;
        }
        goto LABEL_54;
      }
    }
    return v1;
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x2Au, (__int64)&unk_28C38);
  return 0i64;
}
// 14768: variable 'v7' is possibly undefined
// 14768: variable 'v8' is possibly undefined
// 1490C: variable 'v12' is possibly undefined
// 1490C: variable 'v13' is possibly undefined
// 2A148: using guessed type void *off_2A148;

//----- (0000000000014A10) ----------------------------------------------------
__int64 __fastcall sub_14A10(_QWORD *a1)
{
  void **v2; // rcx

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x34u, (__int64)&unk_28C38);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 )
    {
      if ( (*((_BYTE *)v2 + 236) & 4) != 0 && *((_BYTE *)v2 + 233) >= 4u )
      {
        sub_138C0(
          (__int64)v2[27],
          53i64,
          (__int64)&unk_28C38,
          *(_QWORD *)((char *)a1 + 28),
          *a1,
          a1[1],
          *(_QWORD *)((char *)a1 + 20));
        v2 = (void **)off_2A148;
      }
      if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 236) & 4) != 0 && *((_BYTE *)v2 + 233) >= 5u )
        sub_11008((__int64)v2[27], 0x36u, (__int64)&unk_28C38);
    }
  }
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000014AFC) ----------------------------------------------------
__int64 __fastcall sub_14AFC(__int64 a1)
{
  void **v2; // rcx
  unsigned int v4; // edi
  void **v5; // rcx
  int v6; // [rsp+30h] [rbp-28h]
  unsigned int v7; // [rsp+60h] [rbp+8h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+68h] [rbp+10h] BYREF

  v7 = 0;
  BugCheckParameter1 = 0i64;
  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x37u, (__int64)&unk_28C38);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 236) & 4) != 0 && *((_BYTE *)v2 + 233) >= 4u )
    {
      v6 = *(_DWORD *)(a1 + 28);
      sub_1392C(
        (__int64)v2[27],
        56i64,
        (__int64)&unk_28C38,
        *(_QWORD *)a1,
        *(_QWORD *)(a1 + 8),
        *(_QWORD *)(a1 + 16),
        v6);
    }
  }
  if ( sub_16A10(*(_QWORD *)(a1 + 8), &BugCheckParameter1, &v7) )
  {
    if ( BugCheckParameter1 )
      sub_16CB8(BugCheckParameter1);
    if ( *(_DWORD *)(a1 + 28) == 1 || *(_DWORD *)(a1 + 28) == 2 || *(_DWORD *)(a1 + 28) == 3 )
    {
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
        sub_11008(*((_QWORD *)off_2A148 + 27), 0x3Au, (__int64)&unk_28C38);
      sub_15E54(*(_QWORD *)a1);
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
        sub_12954(*((_QWORD *)off_2A148 + 27), 0x3Bu, (__int64)&unk_28C38, *(_QWORD *)(a1 + 8));
      v4 = sub_1620C(*(_QWORD *)(a1 + 8), *(_QWORD *)(a1 + 16));
      if ( v4 )
      {
        v5 = (void **)off_2A148;
        if ( off_2A148 == &off_2A148 )
          return v4;
        if ( (*((_BYTE *)off_2A148 + 236) & 4) == 0 || *((_BYTE *)off_2A148 + 233) < 2u )
        {
LABEL_35:
          if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 4) != 0 && *((_BYTE *)v5 + 233) >= 5u )
            sub_11008((__int64)v5[27], 0x3Du, (__int64)&unk_28C38);
          return v4;
        }
        sub_13814(*((_QWORD *)off_2A148 + 27), 60i64, (__int64)&unk_28C38, v4);
      }
    }
    else
    {
      sub_15E54(*(_QWORD *)a1);
      v4 = v7;
    }
    v5 = (void **)off_2A148;
    goto LABEL_35;
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 3u )
    sub_1102C(*((_QWORD *)off_2A148 + 27), 0x39u, (__int64)&unk_28C38, v7);
  return v7;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000014D40) ----------------------------------------------------
__int64 __fastcall sub_14D40(__int64 a1, __int64 a2)
{
  void **v4; // rcx
  __int64 v6; // rbx
  __int64 v7; // r9
  char v8; // r8
  int v9; // eax
  unsigned int v10; // edi
  size_t pcchDestLength; // [rsp+30h] [rbp-48h] BYREF
  __int64 v12; // [rsp+38h] [rbp-40h] BYREF

  pcchDestLength = 0i64;
  v12 = 0i64;
  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x3Eu, (__int64)&unk_28C38);
    v4 = (void **)off_2A148;
  }
  if ( !*(_DWORD *)(a2 + 1100) )
  {
    if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 236) & 4) != 0 && *((_BYTE *)v4 + 233) >= 2u )
      sub_11008((__int64)v4[27], 0x3Fu, (__int64)&unk_28C38);
    return 4i64;
  }
  sub_15394(&pcchDestLength, 0i64, **(_QWORD **)a1, *(_QWORD *)(*(_QWORD *)a1 + 8i64));
  v6 = pcchDestLength;
  sub_155B4(pcchDestLength, *(_QWORD *)(*(_QWORD *)a1 + 16i64), *(_DWORD *)(*(_QWORD *)a1 + 24i64));
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x40u, (__int64)&unk_28C38);
  if ( (int)unknown_libname_2(a2 + 1216, 10i64, 0x7FFFFFFFi64) >= 0 )
    RtlStringCopyWorkerA((NTSTRSAFE_PSTR)(a2 + 1216), 0xAui64, 0i64, "https://", 0x7FFFFFFEui64);
  if ( RtlStringValidateDestAndLengthA((NTSTRSAFE_PCSTR)(a2 + 1216), 0x3FFui64, &pcchDestLength, 0x7FFFFFFFui64) >= 0 )
    RtlStringCopyWorkerA(
      (NTSTRSAFE_PSTR)(pcchDestLength + a2 + 1216),
      1023 - pcchDestLength,
      0i64,
      (STRSAFE_PCNZCH)(a2 + 76),
      0x7FFFFFFFui64);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
    sub_139F0(*((_QWORD *)off_2A148 + 27), 0x41u, (__int64)&unk_28C38, (const char *)(a2 + 1216));
  *(_DWORD *)(a2 + 1212) = strlen((const char *)(a2 + 1216));
  sub_15BB8(v6, 2, 0i64, 1i64, 4, 0);
  v7 = 2i64;
  if ( *(_DWORD *)(a2 + 1197) != 4 )
    v7 = 1i64;
  sub_15BB8(v6, 4, 0i64, v7, 4, 0);
  sub_15BB8(v6, 5, 0i64, a2 + 1216, *(_DWORD *)(a2 + 1212), dword_2CEA4);
  sub_15BB8(v6, 3, 0i64, a2 + 76, *(_DWORD *)(a2 + 1100), dword_2CEA4);
  *(_DWORD *)(a2 + 1193) = 1;
  *(_DWORD *)(a2 + 1189) = 6;
  *(_BYTE *)(a2 + 1201) = 0;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
    sub_1399C(*((_QWORD *)off_2A148 + 27), 0x42u, (__int64)&unk_28C38, *(_DWORD *)(a2 + 1197));
  sub_15BB8(v6, 7, 0i64, a2 + 1189, 20, dword_2CEA4);
  if ( *(_BYTE *)(a2 + 1106) )
  {
    if ( !*(_QWORD *)(a1 + 16) )
      goto LABEL_43;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 3u )
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x43u, (__int64)&unk_28C38);
    v8 = 1;
  }
  else
  {
    if ( !*(_QWORD *)(a1 + 16) )
      goto LABEL_43;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x44u, (__int64)&unk_28C38);
    v8 = 0;
  }
  sub_159C8(v6, *(_QWORD *)(a1 + 16), v8);
LABEL_43:
  v9 = sub_157B4(**(_QWORD **)a1, *(_QWORD *)(*(_QWORD *)a1 + 8i64), v6, (__int64)&v12);
  v10 = v9;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_1102C(*((_QWORD *)off_2A148 + 27), 0x45u, (__int64)&unk_28C38, v9);
  return v10;
}
// 26F70: using guessed type __int64 __fastcall unknown_libname_2(_QWORD, _QWORD, _QWORD);
// 2A148: using guessed type void *off_2A148;
// 2CEA4: using guessed type int dword_2CEA4;

//----- (000000000001516C) ----------------------------------------------------
__int64 __fastcall sub_1516C(__int64 a1, char *a2, _DWORD *a3)
{
  unsigned int v3; // esi
  __int64 v7; // rcx
  __int64 v8; // rax
  __m128i v10; // [rsp+60h] [rbp-28h] BYREF

  v3 = 0;
  v10.m128i_i8[0] = 0;
  *(__int64 *)((char *)v10.m128i_i64 + 1) = 0i64;
  *(__int32 *)((char *)&v10.m128i_i32[2] + 1) = 0;
  *(__int16 *)((char *)&v10.m128i_i16[6] + 1) = 0;
  v10.m128i_i8[15] = 0;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x46u, (__int64)&unk_28C38);
  v7 = *(_QWORD *)(a1 + 16);
  if ( v7 )
  {
    v8 = *(_QWORD *)(v7 + 40);
    if ( v8 )
    {
      sub_22554(v8, &v10);
      sub_262F8(a2, 0x400ui64, "%d.%d.%d.%d", v10.m128i_u8[0], v10.m128i_u8[1], v10.m128i_u8[2], v10.m128i_u8[3]);
    }
    else
    {
      sub_22604(*(_QWORD *)(v7 + 48), &v10);
      sub_262F8(
        a2,
        0x400ui64,
        "%04X:%04X:%04X:%04X:%04X:%04X:%04X:%04X",
        v10.m128i_u8[1] | (unsigned int)(unsigned __int16)(v10.m128i_u8[0] << 8),
        v10.m128i_u8[3] | (unsigned __int16)(v10.m128i_u8[2] << 8),
        v10.m128i_u8[5] | (unsigned __int16)(v10.m128i_u8[4] << 8),
        v10.m128i_u8[7] | (unsigned __int16)(v10.m128i_u8[6] << 8),
        v10.m128i_u8[9] | (unsigned __int16)(v10.m128i_u8[8] << 8),
        v10.m128i_u8[11] | (unsigned __int16)(v10.m128i_u8[10] << 8),
        v10.m128i_u8[13] | (unsigned __int16)(v10.m128i_u8[12] << 8),
        v10.m128i_u8[15] | (unsigned __int16)(v10.m128i_u8[14] << 8));
    }
    *a3 = strlen(a2);
  }
  else
  {
    *a3 = 0;
    v3 = 5;
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 4) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_1102C(*((_QWORD *)off_2A148 + 27), 0x47u, (__int64)&unk_28C38, v3);
  return v3;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000015394) ----------------------------------------------------
__int64 __fastcall sub_15394(_QWORD *a1, __int64 a2, __int64 a3, __int64 a4)
{
  unsigned int v5; // ebx
  void **v6; // rcx
  int v8[2]; // [rsp+20h] [rbp-58h] BYREF
  int v9; // [rsp+28h] [rbp-50h]
  __int64 v10; // [rsp+30h] [rbp-48h] BYREF
  __int64 v11; // [rsp+38h] [rbp-40h]
  _BYTE v12[20]; // [rsp+40h] [rbp-38h]
  __int64 v13; // [rsp+90h] [rbp+18h]
  __int64 v14; // [rsp+98h] [rbp+20h]

  v14 = a4;
  v13 = a3;
  v8[0] = 0;
  v10 = 0i64;
  v11 = 0i64;
  *(_OWORD *)v12 = 0ui64;
  v8[1] = 0;
  v9 = 0;
  *(_DWORD *)&v12[16] = 0;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xAu, (__int64)&unk_28C28);
    a4 = v14;
    a3 = v13;
  }
  v11 = 0i64;
  *a1 = 0i64;
  v8[0] = 1;
  v9 = 36;
  *(_QWORD *)&v12[4] = a3;
  *(_QWORD *)&v12[12] = a4;
  *(_DWORD *)v12 = 5;
  if ( sub_1D044(&FastMutex) )
  {
    v5 = 11;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
      sub_11008(*((_QWORD *)off_2A148 + 27), 0xBu, (__int64)&unk_28C28);
    if ( (unsigned int)qword_2A1E4(5i64, v8, &v10) )
    {
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
        sub_11008(*((_QWORD *)off_2A148 + 27), 0xCu, (__int64)&unk_28C28);
    }
    else
    {
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
        sub_11008(*((_QWORD *)off_2A148 + 27), 0xDu, (__int64)&unk_28C28);
      v5 = 0;
      *a1 = v10;
    }
    sub_1D0AC(&FastMutex);
    v6 = (void **)off_2A148;
  }
  else
  {
    v6 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0xEu, (__int64)&unk_28C28);
      v6 = (void **)off_2A148;
    }
    v5 = 9;
  }
  if ( v6 != &off_2A148 && (*((_BYTE *)v6 + 236) & 0x20) != 0 && *((_BYTE *)v6 + 233) >= 5u )
    sub_11008((__int64)v6[27], 0xFu, (__int64)&unk_28C28);
  return v5;
}
// 2A148: using guessed type void *off_2A148;
// 2A1E4: using guessed type __int64 (__fastcall *qword_2A1E4)(_QWORD, _QWORD, _QWORD);

//----- (00000000000155B4) ----------------------------------------------------
__int64 __fastcall sub_155B4(__int64 a1, __int64 a2, int a3)
{
  unsigned int v3; // ebx
  void **v7; // rcx
  int v9[2]; // [rsp+20h] [rbp-48h] BYREF
  int v10; // [rsp+28h] [rbp-40h]
  __int64 v11; // [rsp+30h] [rbp-38h] BYREF
  __int64 v12; // [rsp+38h] [rbp-30h]
  int v13; // [rsp+40h] [rbp-28h]

  v3 = 0;
  v12 = 0i64;
  v11 = 0i64;
  v13 = 0;
  v9[0] = 0;
  v9[1] = 0;
  v10 = 0;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x10u, (__int64)&unk_28C28);
  v13 = a3;
  v11 = a1;
  v12 = a2;
  v9[0] = 2;
  v10 = 20;
  if ( sub_1D044(&FastMutex) )
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x11u, (__int64)&unk_28C28);
    if ( (unsigned int)qword_2A1E4(5i64, v9, &v11) )
    {
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
        sub_11008(*((_QWORD *)off_2A148 + 27), 0x12u, (__int64)&unk_28C28);
    }
    else if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 27), 0x13u, (__int64)&unk_28C28, v13);
    }
    sub_1D0AC(&FastMutex);
    v7 = (void **)off_2A148;
  }
  else
  {
    v7 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x14u, (__int64)&unk_28C28);
      v7 = (void **)off_2A148;
    }
    v3 = 9;
  }
  if ( v7 != &off_2A148 && (*((_BYTE *)v7 + 236) & 0x20) != 0 && *((_BYTE *)v7 + 233) >= 5u )
    sub_11008((__int64)v7[27], 0x15u, (__int64)&unk_28C28);
  return v3;
}
// 2A148: using guessed type void *off_2A148;
// 2A1E4: using guessed type __int64 (__fastcall *qword_2A1E4)(_QWORD, _QWORD, _QWORD);

//----- (00000000000157B4) ----------------------------------------------------
__int64 __fastcall sub_157B4(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  unsigned int v4; // esi
  __int64 v6; // rdi
  __int64 v7; // rbx
  _QWORD *v9; // rcx
  unsigned __int16 v10; // dx
  void **v11; // rcx
  int v13[2]; // [rsp+20h] [rbp-58h] BYREF
  int v14; // [rsp+28h] [rbp-50h]
  __int64 Dst[4]; // [rsp+30h] [rbp-48h] BYREF
  __int64 v16; // [rsp+80h] [rbp+8h]
  __int64 v17; // [rsp+88h] [rbp+10h]

  v17 = a2;
  v16 = a1;
  v4 = 0;
  v6 = a1;
  v13[0] = 0;
  v7 = a2;
  v13[1] = 0;
  v14 = 0;
  LODWORD(Dst[0]) = 0;
  memset((char *)Dst + 4, 0, 0x1Cui64);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x16u, (__int64)&unk_28C28);
    v7 = v17;
    v6 = v16;
  }
  Dst[1] = v7;
  Dst[0] = v6;
  Dst[2] = a3;
  Dst[3] = a4;
  v13[0] = 9;
  v14 = 32;
  if ( sub_1D044(&FastMutex) )
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x17u, (__int64)&unk_28C28);
    if ( (unsigned int)qword_2A1E4(5i64, v13, Dst) )
    {
      v9 = off_2A148;
      if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 236) & 0x20) == 0 || *((_BYTE *)off_2A148 + 233) < 2u )
        goto LABEL_20;
      v10 = 24;
    }
    else
    {
      v9 = off_2A148;
      if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 236) & 0x20) == 0 || *((_BYTE *)off_2A148 + 233) < 4u )
        goto LABEL_20;
      v10 = 25;
    }
    sub_11008(v9[27], v10, (__int64)&unk_28C28);
LABEL_20:
    sub_1D0AC(&FastMutex);
    v11 = (void **)off_2A148;
    goto LABEL_26;
  }
  v11 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Au, (__int64)&unk_28C28);
    v11 = (void **)off_2A148;
  }
  v4 = 9;
LABEL_26:
  if ( v11 != &off_2A148 && (*((_BYTE *)v11 + 236) & 0x20) != 0 && *((_BYTE *)v11 + 233) >= 5u )
    sub_11008((__int64)v11[27], 0x1Bu, (__int64)&unk_28C28);
  return v4;
}
// 2A148: using guessed type void *off_2A148;
// 2A1E4: using guessed type __int64 (__fastcall *qword_2A1E4)(_QWORD, _QWORD, _QWORD);

//----- (00000000000159C8) ----------------------------------------------------
__int64 __fastcall sub_159C8(__int64 a1, __int64 a2, char a3)
{
  unsigned int v3; // ebx
  _QWORD *v7; // rcx
  unsigned __int16 v8; // dx
  void **v9; // rcx
  int v11[2]; // [rsp+20h] [rbp-48h] BYREF
  int v12; // [rsp+28h] [rbp-40h]
  __int64 v13; // [rsp+30h] [rbp-38h] BYREF
  __int64 v14; // [rsp+38h] [rbp-30h]
  char v15; // [rsp+40h] [rbp-28h]

  v3 = 0;
  v14 = 0i64;
  v13 = 0i64;
  v15 = 0;
  v11[0] = 0;
  v11[1] = 0;
  v12 = 0;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Cu, (__int64)&unk_28C28);
  v13 = a1;
  v14 = a2;
  v15 = a3;
  v11[0] = 7;
  v12 = 17;
  if ( sub_1D044(&FastMutex) )
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Du, (__int64)&unk_28C28);
    if ( (unsigned int)qword_2A1E4(5i64, v11, &v13) )
    {
      v7 = off_2A148;
      if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 236) & 0x20) == 0 || *((_BYTE *)off_2A148 + 233) < 2u )
        goto LABEL_20;
      v8 = 30;
    }
    else
    {
      v7 = off_2A148;
      if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 236) & 0x20) == 0 || *((_BYTE *)off_2A148 + 233) < 4u )
        goto LABEL_20;
      v8 = 31;
    }
    sub_11008(v7[27], v8, (__int64)&unk_28C28);
LABEL_20:
    sub_1D0AC(&FastMutex);
    v9 = (void **)off_2A148;
    goto LABEL_26;
  }
  v9 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x20u, (__int64)&unk_28C28);
    v9 = (void **)off_2A148;
  }
  v3 = 9;
LABEL_26:
  if ( v9 != &off_2A148 && (*((_BYTE *)v9 + 236) & 0x20) != 0 && *((_BYTE *)v9 + 233) >= 5u )
    sub_11008((__int64)v9[27], 0x21u, (__int64)&unk_28C28);
  return v3;
}
// 2A148: using guessed type void *off_2A148;
// 2A1E4: using guessed type __int64 (__fastcall *qword_2A1E4)(_QWORD, _QWORD, _QWORD);

//----- (0000000000015BB8) ----------------------------------------------------
__int64 __fastcall sub_15BB8(__int64 a1, int a2, __int64 a3, __int64 a4, int a5, char a6)
{
  unsigned int v6; // ebx
  void **v10; // rcx
  void **v11; // rcx
  __int64 v13; // [rsp+20h] [rbp-58h] BYREF
  __int64 v14; // [rsp+28h] [rbp-50h]
  __int64 v15; // [rsp+30h] [rbp-48h] BYREF
  _BYTE v16[24]; // [rsp+38h] [rbp-40h]
  char v17; // [rsp+50h] [rbp-28h]

  v6 = 0;
  *(_OWORD *)v16 = 0ui64;
  *(_QWORD *)&v16[16] = 0i64;
  v15 = 0i64;
  v13 = 0i64;
  LODWORD(v14) = 0;
  v17 = 0;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x22u, (__int64)&unk_28C28);
  v15 = a1;
  *(_DWORD *)&v16[20] = a5;
  *(_DWORD *)v16 = a2;
  *(_QWORD *)&v16[4] = 0i64;
  *(_QWORD *)&v16[12] = a4;
  LODWORD(v13) = 6;
  v17 = a6;
  LODWORD(v14) = 33;
  if ( sub_1D044(&FastMutex) )
  {
    v10 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 )
    {
      if ( (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 27), 0x23u, (__int64)&unk_28C28);
        v10 = (void **)off_2A148;
      }
      if ( v10 != &off_2A148 )
      {
        if ( (*((_BYTE *)v10 + 236) & 0x20) != 0 && *((_BYTE *)v10 + 233) >= 4u )
        {
          sub_12954((__int64)v10[27], 0x24u, (__int64)&unk_28C28, v15, v13, v14);
          v10 = (void **)off_2A148;
        }
        if ( v10 != &off_2A148 && (*((_BYTE *)v10 + 236) & 0x20) != 0 && *((_BYTE *)v10 + 233) >= 4u )
          sub_1102C((__int64)v10[27], 0x25u, (__int64)&unk_28C28, *(int *)v16);
      }
    }
    if ( (unsigned int)qword_2A1E4(5i64, &v13, &v15) )
    {
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
        sub_11008(*((_QWORD *)off_2A148 + 27), 0x26u, (__int64)&unk_28C28);
      v6 = 11;
    }
    else if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x27u, (__int64)&unk_28C28);
    }
    sub_1D0AC(&FastMutex);
    v11 = (void **)off_2A148;
  }
  else
  {
    v11 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x28u, (__int64)&unk_28C28);
      v11 = (void **)off_2A148;
    }
    v6 = 9;
  }
  if ( v11 != &off_2A148 && (*((_BYTE *)v11 + 236) & 0x20) != 0 && *((_BYTE *)v11 + 233) >= 5u )
    sub_11008((__int64)v11[27], 0x29u, (__int64)&unk_28C28);
  return v6;
}
// 2A148: using guessed type void *off_2A148;
// 2A1E4: using guessed type __int64 (__fastcall *qword_2A1E4)(_QWORD, _QWORD, _QWORD);

//----- (0000000000015E54) ----------------------------------------------------
__int64 __fastcall sub_15E54(__int64 a1)
{
  unsigned int v1; // ebx
  _QWORD *v3; // rcx
  unsigned __int16 v4; // dx
  void **v5; // rcx
  __int64 v7; // [rsp+20h] [rbp-18h] BYREF
  __int64 v8; // [rsp+28h] [rbp-10h]
  __int64 v9; // [rsp+40h] [rbp+8h] BYREF

  v1 = 0;
  v7 = 0i64;
  v9 = 0i64;
  LODWORD(v8) = 0;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_12954(*((_QWORD *)off_2A148 + 27), 0x36u, (__int64)&unk_28C28, a1, v7, v8);
  v9 = a1;
  LODWORD(v7) = 11;
  LODWORD(v8) = 8;
  if ( sub_1D044(&FastMutex) )
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
      sub_12954(*((_QWORD *)off_2A148 + 27), 0x37u, (__int64)&unk_28C28, a1, v7, v8);
    if ( (unsigned int)qword_2A1E4(5i64, &v7, &v9) )
    {
      v3 = off_2A148;
      if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 236) & 0x20) == 0 || *((_BYTE *)off_2A148 + 233) < 2u )
        goto LABEL_20;
      v4 = 56;
    }
    else
    {
      v3 = off_2A148;
      if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 236) & 0x20) == 0 || *((_BYTE *)off_2A148 + 233) < 4u )
        goto LABEL_20;
      v4 = 57;
    }
    sub_11008(v3[27], v4, (__int64)&unk_28C28);
LABEL_20:
    sub_1D0AC(&FastMutex);
    v5 = (void **)off_2A148;
    goto LABEL_26;
  }
  v5 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x3Au, (__int64)&unk_28C28);
    v5 = (void **)off_2A148;
  }
  v1 = 9;
LABEL_26:
  if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 0x20) != 0 && *((_BYTE *)v5 + 233) >= 5u )
    sub_11008((__int64)v5[27], 0x3Bu, (__int64)&unk_28C28);
  return v1;
}
// 2A148: using guessed type void *off_2A148;
// 2A1E4: using guessed type __int64 (__fastcall *qword_2A1E4)(_QWORD, _QWORD, _QWORD);

//----- (000000000001602C) ----------------------------------------------------
__int64 __fastcall sub_1602C(__int64 a1)
{
  unsigned int v1; // ebx
  _QWORD *v2; // rcx
  unsigned __int16 v3; // dx
  void **v4; // rcx
  __int64 v6; // [rsp+20h] [rbp-28h] BYREF
  __int64 v7; // [rsp+28h] [rbp-20h]
  __int64 v8; // [rsp+30h] [rbp-18h] BYREF
  __int64 v9; // [rsp+38h] [rbp-10h]
  __int64 v10; // [rsp+50h] [rbp+8h]

  v10 = a1;
  v1 = 0;
  v6 = 0i64;
  v8 = 0i64;
  LODWORD(v7) = 0;
  v9 = 0i64;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_12954(*((_QWORD *)off_2A148 + 27), 0x3Cu, (__int64)&unk_28C28, a1, v6, v7, v8, v9);
    a1 = v10;
  }
  v8 = a1;
  LODWORD(v6) = 12;
  LODWORD(v7) = 16;
  if ( sub_1D044(&FastMutex) )
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
      sub_12954(*((_QWORD *)off_2A148 + 27), 0x3Du, (__int64)&unk_28C28, v10, v6, v7, v8);
    if ( (unsigned int)qword_2A1E4(4i64, &v6, &v8) )
    {
      v2 = off_2A148;
      if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 236) & 0x20) == 0 || *((_BYTE *)off_2A148 + 233) < 2u )
        goto LABEL_20;
      v3 = 62;
    }
    else
    {
      v2 = off_2A148;
      if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 236) & 0x20) == 0 || *((_BYTE *)off_2A148 + 233) < 4u )
        goto LABEL_20;
      v3 = 63;
    }
    sub_11008(v2[27], v3, (__int64)&unk_28C28);
LABEL_20:
    sub_1D0AC(&FastMutex);
    v4 = (void **)off_2A148;
    goto LABEL_26;
  }
  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x40u, (__int64)&unk_28C28);
    v4 = (void **)off_2A148;
  }
  v1 = 9;
LABEL_26:
  if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 236) & 0x20) != 0 && *((_BYTE *)v4 + 233) >= 5u )
    sub_11008((__int64)v4[27], 0x41u, (__int64)&unk_28C28);
  return v1;
}
// 2A148: using guessed type void *off_2A148;
// 2A1E4: using guessed type __int64 (__fastcall *qword_2A1E4)(_QWORD, _QWORD, _QWORD);

//----- (000000000001620C) ----------------------------------------------------
__int64 __fastcall sub_1620C(__int64 a1, __int64 a2)
{
  unsigned int v2; // ebx
  _QWORD *v3; // rcx
  unsigned __int16 v4; // dx
  void **v5; // rcx
  int v7[2]; // [rsp+30h] [rbp-28h] BYREF
  int v8; // [rsp+38h] [rbp-20h]
  __int64 v9; // [rsp+40h] [rbp-18h] BYREF
  __int64 v10; // [rsp+48h] [rbp-10h]
  __int64 v11; // [rsp+60h] [rbp+8h]
  __int64 v12; // [rsp+68h] [rbp+10h]

  v12 = a2;
  v11 = a1;
  v2 = 0;
  v7[0] = 0;
  v9 = 0i64;
  v7[1] = 0;
  v8 = 0;
  v10 = 0i64;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x48u, (__int64)&unk_28C28);
    a2 = v12;
    a1 = v11;
  }
  v9 = a1;
  v10 = a2;
  v7[0] = 15;
  v8 = 16;
  if ( sub_1D044(&FastMutex) )
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
      sub_13878(*((_QWORD *)off_2A148 + 27), 0x49u, (__int64)&unk_28C28, v9, v10);
    if ( (unsigned int)qword_2A1E4(5i64, v7, &v9) )
    {
      v3 = off_2A148;
      if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 236) & 0x20) == 0 || *((_BYTE *)off_2A148 + 233) < 2u )
        goto LABEL_20;
      v4 = 74;
    }
    else
    {
      v3 = off_2A148;
      if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 236) & 0x20) == 0 || *((_BYTE *)off_2A148 + 233) < 4u )
        goto LABEL_20;
      v4 = 75;
    }
    sub_13878(v3[27], v4, (__int64)&unk_28C28, v9, v10);
LABEL_20:
    sub_1D0AC(&FastMutex);
    v5 = (void **)off_2A148;
    goto LABEL_26;
  }
  v5 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x20) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
  {
    sub_13878(*((_QWORD *)off_2A148 + 27), 0x4Cu, (__int64)&unk_28C28, v9, v10);
    v5 = (void **)off_2A148;
  }
  v2 = 9;
LABEL_26:
  if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 0x20) != 0 && *((_BYTE *)v5 + 233) >= 5u )
    sub_11008((__int64)v5[27], 0x4Du, (__int64)&unk_28C28);
  return v2;
}
// 2A148: using guessed type void *off_2A148;
// 2A1E4: using guessed type __int64 (__fastcall *qword_2A1E4)(_QWORD, _QWORD, _QWORD);

//----- (0000000000016420) ----------------------------------------------------
__int64 sub_16420()
{
  __int64 v0; // rcx
  __int64 result; // rax
  __int64 v2; // [rsp+28h] [rbp-40h]
  int v3; // [rsp+70h] [rbp+8h] BYREF

  v3 = 0;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xAu, (__int64)&unk_28C18);
  qword_2A280 = sub_1A778(1i64, 0xAC0u, 0x73657348u);
  if ( qword_2A280 )
  {
    LOBYTE(v0) = 3;
    LODWORD(v2) = 2;
    qword_2CD28 = (ULONG_PTR)sub_22F68(v0, 0i64, 1i64, 0x73657348u, 0i64, v2, 0i64, 0i64, (__int64)sub_166B8, 0i64, &v3);
    if ( v3 )
    {
      sub_1A930(qword_2A280);
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
        sub_1102C(*((_QWORD *)off_2A148 + 27), 0xCu, (__int64)&unk_28C18, v3);
      result = 1i64;
    }
    else
    {
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
        sub_11008(*((_QWORD *)off_2A148 + 27), 0xDu, (__int64)&unk_28C18);
      result = 0i64;
    }
  }
  else
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
      sub_11008(*((_QWORD *)off_2A148 + 27), 0xBu, (__int64)&unk_28C18);
    result = 3i64;
  }
  return result;
}
// 16518: variable 'v0' is possibly undefined
// 16518: variable 'v2' is possibly undefined
// 2A148: using guessed type void *off_2A148;

//----- (00000000000165C8) ----------------------------------------------------
__int64 sub_165C8()
{
  int v0; // eax
  __int64 result; // rax

  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xEu, (__int64)&unk_28C18);
  v0 = sub_231F8(qword_2CD28);
  if ( v0 )
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
      sub_1102C(*((_QWORD *)off_2A148 + 27), 0xFu, (__int64)&unk_28C18, v0);
    result = 1i64;
  }
  else
  {
    sub_1A930(qword_2A280);
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x10u, (__int64)&unk_28C18);
    result = 0i64;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000166B8) ----------------------------------------------------
__int64 __fastcall sub_166B8(__int64 a1)
{
  void **v2; // rcx

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x17u, (__int64)&unk_28C18);
    v2 = (void **)off_2A148;
  }
  if ( a1 )
  {
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 236) & 0x40) != 0 && *((_BYTE *)v2 + 233) >= 5u )
      sub_12954((__int64)v2[27], 0x18u, (__int64)&unk_28C18, *(_QWORD *)(a1 + 16));
    sub_17518(a1 + 56);
    sub_1AAB8((__int64)qword_2A280, a1);
    v2 = (void **)off_2A148;
  }
  if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 236) & 0x40) != 0 && *((_BYTE *)v2 + 233) >= 5u )
    sub_11008((__int64)v2[27], 0x19u, (__int64)&unk_28C18);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000167B0) ----------------------------------------------------
__int64 __fastcall sub_167B0(unsigned __int64 a1, unsigned __int64 a2, ULONG_PTR **a3, _DWORD *a4)
{
  void **v6; // rcx
  _DWORD *v7; // rax
  __int64 v8; // rbx
  void **v9; // rcx
  unsigned __int64 v11; // r11
  unsigned __int64 v12; // rcx
  unsigned __int8 v13; // al
  int v14; // eax

  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Au, (__int64)&unk_28C18);
    v6 = (void **)off_2A148;
  }
  *a4 = 0;
  if ( v6 != &off_2A148 && (*((_BYTE *)v6 + 236) & 0x40) != 0 && *((_BYTE *)v6 + 233) >= 5u )
    sub_11008((__int64)v6[27], 0x14u, (__int64)&unk_28C18);
  v7 = sub_1AA50((__int64)qword_2A280);
  v8 = (__int64)v7;
  if ( !v7 )
  {
    v9 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 )
    {
      if ( (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 27), 0x15u, (__int64)&unk_28C18);
        v9 = (void **)off_2A148;
      }
      if ( v9 != &off_2A148 && (*((_BYTE *)v9 + 236) & 0x40) != 0 && *((_BYTE *)v9 + 233) >= 2u )
        sub_12954((__int64)v9[27], 0x1Bu, (__int64)&unk_28C18, a1);
    }
    *a4 = 3;
    return 0i64;
  }
  memset(v7, 0, 0xAC0ui64);
  v11 = a2;
  if ( a1 )
    v11 = a1;
  *(_QWORD *)(v8 + 16) = v11;
  v12 = a1;
  if ( a2 )
    v12 = a2;
  *(_QWORD *)(v8 + 24) = v12;
  v13 = sub_1DF10(0x2023007u);
  *(_BYTE *)(v8 + 74) = 1;
  *(_DWORD *)(v8 + 40) = v13;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x16u, (__int64)&unk_28C18);
  v14 = sub_24294(qword_2CD28, a1, v8, a3);
  if ( v14 )
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
      sub_1D3A0(*((_QWORD *)off_2A148 + 27), 0x1Cu, (__int64)&unk_28C18, a1, v14);
    sub_166B8(v8);
    *a4 = 13;
    return 0i64;
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Du, (__int64)&unk_28C18);
  return v8;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000016A10) ----------------------------------------------------
__int64 __fastcall sub_16A10(unsigned __int64 a1, _QWORD *a2, _DWORD *a3)
{
  __int64 v5; // rbx
  void **v6; // rcx
  unsigned __int64 v8; // [rsp+30h] [rbp+8h]
  int v9; // [rsp+40h] [rbp+18h] BYREF

  v8 = a1;
  v9 = 0;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Eu, (__int64)&unk_28C18);
    a1 = v8;
  }
  *a3 = 0;
  v5 = sub_2474C(qword_2CD28, a1, a2, &v9);
  if ( v9 )
  {
    v6 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_12954(*((_QWORD *)off_2A148 + 27), 0x20u, (__int64)&unk_28C18, v8);
      v6 = (void **)off_2A148;
    }
    *a3 = 5;
    v5 = 0i64;
  }
  else
  {
    v6 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_12954(*((_QWORD *)off_2A148 + 27), 0x1Fu, (__int64)&unk_28C18, v8);
      v6 = (void **)off_2A148;
    }
    *a3 = 0;
  }
  if ( v6 != &off_2A148 && (*((_BYTE *)v6 + 236) & 0x40) != 0 && *((_BYTE *)v6 + 233) >= 5u )
    sub_11008((__int64)v6[27], 0x21u, (__int64)&unk_28C18);
  return v5;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000016B70) ----------------------------------------------------
__int64 __fastcall sub_16B70(unsigned __int64 a1, __int64 a2, __int64 a3)
{
  unsigned int v3; // ebx
  void **v4; // rcx
  unsigned __int64 v6; // [rsp+40h] [rbp+8h]
  int v7; // [rsp+48h] [rbp+10h] BYREF

  v6 = a1;
  v3 = 0;
  v7 = 0;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x22u, (__int64)&unk_28C18);
    a1 = v6;
  }
  LOBYTE(a3) = 1;
  sub_244C8(qword_2CD28, a1, a3, &v7);
  if ( v7 )
  {
    v4 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 2u )
    {
      sub_1D3A0(*((_QWORD *)off_2A148 + 27), 0x23u, (__int64)&unk_28C18, v6, v7);
      v4 = (void **)off_2A148;
    }
    v3 = 1;
  }
  else
  {
    v4 = (void **)off_2A148;
    if ( off_2A148 == &off_2A148 )
      return v3;
    if ( (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_12954(*((_QWORD *)off_2A148 + 27), 0x24u, (__int64)&unk_28C18, v6);
      v4 = (void **)off_2A148;
    }
  }
  if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 236) & 0x40) != 0 && *((_BYTE *)v4 + 233) >= 5u )
    sub_11008((__int64)v4[27], 0x25u, (__int64)&unk_28C18);
  return v3;
}
// 16BD7: variable 'a3' is possibly undefined
// 2A148: using guessed type void *off_2A148;

//----- (0000000000016CB8) ----------------------------------------------------
__int64 __fastcall sub_16CB8(ULONG_PTR BugCheckParameter1)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x26u, (__int64)&unk_28C18);
  sub_24F80(qword_2CD28, BugCheckParameter1);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x27u, (__int64)&unk_28C18);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000016D60) ----------------------------------------------------
__int64 __fastcall sub_16D60(unsigned __int8 *a1, unsigned int a2)
{
  __int64 result; // rax
  unsigned int i; // er9
  int v6; // edx
  char v7; // cl

  result = 0i64;
  for ( i = 0; i < a2; result = (unsigned int)((v6 << (8 * v7 - 8)) + result) )
  {
    v6 = *a1++;
    v7 = a2 - i++;
  }
  return result;
}

//----- (0000000000016D98) ----------------------------------------------------
char __fastcall sub_16D98(_BYTE *a1)
{
  void **v2; // rcx
  char result; // al

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xAu, (__int64)&unk_28C08);
    v2 = (void **)off_2A148;
  }
  if ( *a1 == 22 )
  {
    if ( v2 != &off_2A148 && _bittest((const signed __int32 *)v2 + 59, 8u) && *((_BYTE *)v2 + 233) >= 5u )
      sub_11008((__int64)v2[27], 0xCu, (__int64)&unk_28C08);
    result = 1;
  }
  else
  {
    if ( v2 != &off_2A148 && _bittest((const signed __int32 *)v2 + 59, 8u) && *((_BYTE *)v2 + 233) >= 4u )
      sub_1102C((__int64)v2[27], 0xBu, (__int64)&unk_28C08, (unsigned __int8)*a1);
    result = 0;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000016E6C) ----------------------------------------------------
__int64 __fastcall sub_16E6C(__int64 a1, unsigned int a2, char **a3, char **a4, unsigned int *a5)
{
  size_t v7; // rdi
  void **v9; // rcx
  int v10; // eax
  char *v11; // rax
  _QWORD *v12; // rcx
  unsigned __int16 v13; // dx
  int v14; // er9
  PVOID v15; // rax
  void *v16; // rcx
  _QWORD *v17; // rcx
  unsigned __int16 v18; // dx
  size_t v20; // rax
  void **v21; // rcx
  unsigned __int16 v22; // dx
  unsigned int v23; // er11
  char *v24; // rax
  char *v25; // r14
  unsigned int v26; // ebp
  unsigned int v27; // er12
  int v28; // er9
  char *v29; // rax
  __int64 v30; // rcx
  unsigned int v31; // eax

  v7 = a2;
  v9 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x10u, (__int64)&unk_28C08);
    v9 = (void **)off_2A148;
  }
  v10 = *((_DWORD *)a3 + 2);
  *a4 = 0i64;
  if ( !v10 )
  {
    if ( (unsigned int)v7 < 5 )
    {
      if ( v9 != &off_2A148 && _bittest((const signed __int32 *)v9 + 59, 8u) && *((_BYTE *)v9 + 233) >= 4u )
        sub_11008((__int64)v9[27], 0x11u, (__int64)&unk_28C08);
      v11 = (char *)sub_1A4F8(2, 5u, 0x63737348u);
      *a3 = v11;
      sub_2631C(v11, 5ui64, (const void *)a1, v7);
      *((_DWORD *)a3 + 2) = v7;
      *a5 = v7;
      *a4 = 0i64;
      v12 = off_2A148;
      if ( off_2A148 == &off_2A148
        || !_bittest((const signed __int32 *)off_2A148 + 59, 8u)
        || *((_BYTE *)off_2A148 + 233) < 4u )
      {
        return 0i64;
      }
      v13 = 18;
      goto LABEL_15;
    }
    *((_BYTE *)a3 + 16) = 1;
    v14 = ((unsigned __int8)HIBYTE(*(_WORD *)(a1 + 3)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 3) << 8))
        + 5;
    *((_DWORD *)a3 + 3) = v14;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
      && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_1D110(*((_QWORD *)off_2A148 + 27), 0x13u, (__int64)&unk_28C08, v14);
    }
    v15 = sub_1A4F8(2, *((_DWORD *)a3 + 3), 0x63737348u);
    v16 = v15;
    if ( !v15 )
    {
      v17 = off_2A148;
      if ( off_2A148 == &off_2A148
        || !_bittest((const signed __int32 *)off_2A148 + 59, 8u)
        || *((_BYTE *)off_2A148 + 233) < 2u )
      {
        return 3i64;
      }
      v18 = 20;
LABEL_25:
      sub_11008(v17[27], v18, (__int64)&unk_28C08);
      return 3i64;
    }
    *a3 = (char *)v15;
    v20 = *((unsigned int *)a3 + 3);
    if ( (unsigned int)v7 >= (unsigned int)v20 )
    {
      if ( (_DWORD)v7 == (_DWORD)v20 )
      {
        sub_2631C(v16, v20, (const void *)a1, v7);
        *((_DWORD *)a3 + 2) = v7;
        *a5 = v7;
        *a4 = *a3;
        v21 = (void **)off_2A148;
        if ( off_2A148 == &off_2A148 )
          return 0i64;
        if ( _bittest((const signed __int32 *)off_2A148 + 59, 8u) && *((_BYTE *)off_2A148 + 233) >= 5u )
        {
          v22 = 22;
          goto LABEL_32;
        }
      }
      else
      {
        sub_2631C(v16, v20, (const void *)a1, v20);
        v23 = *((_DWORD *)a3 + 3);
        *a5 = v23;
        v24 = *a3;
        *((_DWORD *)a3 + 2) = v23;
        *a4 = v24;
        v21 = (void **)off_2A148;
        if ( off_2A148 == &off_2A148 )
          return 0i64;
        if ( _bittest((const signed __int32 *)off_2A148 + 59, 8u) && *((_BYTE *)off_2A148 + 233) >= 5u )
        {
          v22 = 23;
          goto LABEL_32;
        }
      }
    }
    else
    {
      sub_2631C(v16, v20, (const void *)a1, v7);
      *((_DWORD *)a3 + 2) = v7;
      *a5 = v7;
      *a4 = 0i64;
      v21 = (void **)off_2A148;
      if ( off_2A148 == &off_2A148 )
        return 0i64;
      if ( _bittest((const signed __int32 *)off_2A148 + 59, 8u) && *((_BYTE *)off_2A148 + 233) >= 5u )
      {
        v22 = 21;
LABEL_32:
        sub_11008((__int64)v21[27], v22, (__int64)&unk_28C08);
LABEL_86:
        v21 = (void **)off_2A148;
        goto LABEL_87;
      }
    }
LABEL_87:
    if ( v21 != &off_2A148 && _bittest((const signed __int32 *)v21 + 59, 8u) && *((_BYTE *)v21 + 233) >= 5u )
      sub_11008((__int64)v21[27], 0x20u, (__int64)&unk_28C08);
    return 0i64;
  }
  if ( v9 != &off_2A148 && _bittest((const signed __int32 *)v9 + 59, 8u) && *((_BYTE *)v9 + 233) >= 4u )
  {
    sub_1399C((__int64)v9[27], 0x18u, (__int64)&unk_28C08, *((_DWORD *)a3 + 3));
    v9 = (void **)off_2A148;
  }
  v25 = *a3;
  v26 = v7;
  if ( !*((_BYTE *)a3 + 16) )
  {
    v27 = 5 - *((_DWORD *)a3 + 2);
    if ( v9 != &off_2A148 && _bittest((const signed __int32 *)v9 + 59, 8u) && *((_BYTE *)v9 + 233) >= 4u )
    {
      sub_1102C((__int64)v9[27], 0x19u, (__int64)&unk_28C08, v27);
      v9 = (void **)off_2A148;
    }
    if ( (unsigned int)v7 < v27 )
    {
      if ( v9 != &off_2A148 && _bittest((const signed __int32 *)v9 + 59, 8u) && *((_BYTE *)v9 + 233) >= 4u )
        sub_11008((__int64)v9[27], 0x1Au, (__int64)&unk_28C08);
      sub_2631C(&v25[*((unsigned int *)a3 + 2)], v27, (const void *)a1, v7);
      *((_DWORD *)a3 + 2) += v7;
      *a4 = 0i64;
      *a5 = v7;
      v12 = off_2A148;
      if ( off_2A148 == &off_2A148
        || !_bittest((const signed __int32 *)off_2A148 + 59, 8u)
        || *((_BYTE *)off_2A148 + 233) < 4u )
      {
        return 0i64;
      }
      v13 = 27;
LABEL_15:
      sub_1102C(v12[27], v13, (__int64)&unk_28C08, v7);
      return 0i64;
    }
    sub_2631C(&v25[*((unsigned int *)a3 + 2)], 5ui64, (const void *)a1, v27);
    *((_BYTE *)a3 + 16) = 1;
    v28 = ((unsigned __int8)HIBYTE(*(_WORD *)(v25 + 3)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(v25 + 3) << 8))
        + 5;
    *((_DWORD *)a3 + 3) = v28;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
      && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_1D110(*((_QWORD *)off_2A148 + 27), 0x1Cu, (__int64)&unk_28C08, v28);
    }
    *((_DWORD *)a3 + 2) += v27;
    v29 = (char *)sub_1A5F0(2, v25, *((_DWORD *)a3 + 2), *((_DWORD *)a3 + 3), 0x63737348u);
    v25 = v29;
    if ( !v29 )
    {
      v17 = off_2A148;
      if ( off_2A148 == &off_2A148
        || !_bittest((const signed __int32 *)off_2A148 + 59, 8u)
        || *((_BYTE *)off_2A148 + 233) < 2u )
      {
        return 3i64;
      }
      v18 = 29;
      goto LABEL_25;
    }
    *a3 = v29;
    v9 = (void **)off_2A148;
    v26 = v7 - v27;
    a1 += v27;
  }
  if ( *a3 )
  {
    v30 = *((unsigned int *)a3 + 2);
    v31 = *((_DWORD *)a3 + 3);
    if ( (unsigned int)v30 + v26 >= v31 )
    {
      if ( (_DWORD)v30 + v26 == v31 )
      {
        sub_2631C(&v25[v30], v31 - (unsigned int)v30, (const void *)a1, v26);
        *a5 = v26;
      }
      else
      {
        sub_2631C(&v25[v30], v31 - (unsigned int)v30, (const void *)a1, v31 - (unsigned int)v30);
        *a5 = *((_DWORD *)a3 + 3) - *((_DWORD *)a3 + 2);
      }
      *a4 = *a3;
    }
    else
    {
      sub_2631C(&v25[v30], v31 - (unsigned int)v30, (const void *)a1, v26);
      *a4 = 0i64;
      *((_DWORD *)a3 + 2) += v26;
      *a5 = v26;
    }
    v21 = (void **)off_2A148;
    if ( off_2A148 == &off_2A148 )
      return 0i64;
    if ( _bittest((const signed __int32 *)off_2A148 + 59, 8u) && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_1399C(*((_QWORD *)off_2A148 + 27), 0x1Fu, (__int64)&unk_28C08, *((_DWORD *)a3 + 3));
      goto LABEL_86;
    }
    goto LABEL_87;
  }
  if ( v9 != &off_2A148 && _bittest((const signed __int32 *)v9 + 59, 8u) && *((_BYTE *)v9 + 233) >= 2u )
    sub_11008((__int64)v9[27], 0x1Eu, (__int64)&unk_28C08);
  return 6i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000017518) ----------------------------------------------------
__int64 __fastcall sub_17518(__int64 a1)
{
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x21u, (__int64)&unk_28C08);
  }
  if ( *(_QWORD *)a1 && *(_DWORD *)(a1 + 8) )
    sub_1A57C(*(PVOID *)a1, 0x63737348u);
  *(_QWORD *)a1 = 0i64;
  *(_QWORD *)(a1 + 8) = 0i64;
  *(_BYTE *)(a1 + 16) = 0;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x22u, (__int64)&unk_28C08);
  }
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000175DC) ----------------------------------------------------
__int64 __fastcall sub_175DC(unsigned __int8 *a1, _BYTE *a2, __int64 a3, __int64 a4)
{
  unsigned int v7; // er12
  void **v8; // rbx
  char v9; // cl
  void **v10; // rcx
  unsigned __int16 v11; // dx
  unsigned __int8 *v12; // r8
  unsigned __int64 v13; // rax
  unsigned __int8 *v14; // r8
  unsigned __int64 v15; // rax
  __int64 Dst[6]; // [rsp+20h] [rbp-58h] BYREF

  v7 = 0;
  v8 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( _bittest((const signed __int32 *)off_2A148 + 59, 8u) && *((_BYTE *)off_2A148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x23u, (__int64)&unk_28C08);
      v8 = (void **)off_2A148;
    }
    if ( v8 != &off_2A148 && _bittest((const signed __int32 *)v8 + 59, 8u) && *((_BYTE *)v8 + 233) >= 5u )
    {
      sub_11008((__int64)v8[27], 0x4Au, (__int64)&unk_28C08);
      v8 = (void **)off_2A148;
    }
  }
  memset(Dst, 0, sizeof(Dst));
  if ( v8 != &off_2A148 && _bittest((const signed __int32 *)v8 + 59, 8u) && *((_BYTE *)v8 + 233) >= 4u )
  {
    sub_1102C((__int64)v8[27], 0x4Bu, (__int64)&unk_28C08, (unsigned __int8)*a2);
    v8 = (void **)off_2A148;
  }
  if ( *a2 == 22 )
  {
    sub_18160(a1, Dst);
    goto LABEL_19;
  }
  if ( v8 == &off_2A148 )
    goto LABEL_24;
  if ( _bittest((const signed __int32 *)v8 + 59, 8u) && *((_BYTE *)v8 + 233) >= 4u )
  {
    sub_11008((__int64)v8[27], 0x4Cu, (__int64)&unk_28C08);
LABEL_19:
    v8 = (void **)off_2A148;
  }
  if ( v8 != &off_2A148 && _bittest((const signed __int32 *)v8 + 59, 8u) && *((_BYTE *)v8 + 233) >= 5u )
    sub_11008((__int64)v8[27], 0x4Du, (__int64)&unk_28C08);
LABEL_24:
  v9 = *(_BYTE *)Dst[0];
  *(_BYTE *)(a4 + 1028) = *(_BYTE *)Dst[0];
  if ( !sub_17B9C(v9, (__int64)Dst) )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
      && *((_BYTE *)off_2A148 + 233) >= 3u )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 27), 0x25u, (__int64)&unk_28C08, *(unsigned __int8 *)(a4 + 1028));
    }
LABEL_29:
    *(_BYTE *)(a4 + 1030) = 1;
LABEL_93:
    v10 = (void **)off_2A148;
    goto LABEL_94;
  }
  if ( *(_BYTE *)(a4 + 1028) == 1 )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
      && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x26u, (__int64)&unk_28C08);
    }
    v14 = (unsigned __int8 *)Dst[2];
    if ( *(_BYTE *)Dst[2] )
    {
      *(_BYTE *)(a4 + 1031) = *(_BYTE *)Dst[2];
      sub_2631C((void *)(a4 + 1032), 0x20ui64, v14 + 1, *v14);
    }
    v15 = sub_1A070((_QWORD *)(a4 + 1032), *(unsigned __int8 *)(a4 + 1031));
    *(_QWORD *)(a4 + 1097) = v15;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
      && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_12954(*((_QWORD *)off_2A148 + 27), 0x27u, (__int64)&unk_28C08, v15);
    }
    if ( !sub_192C0((__int64)a2) )
      goto LABEL_93;
    if ( (unsigned int)sub_1DF10(0x2023009u) )
    {
      v7 = sub_18C18(Dst, (_DWORD *)a4);
      if ( !v7 )
        goto LABEL_93;
      v10 = (void **)off_2A148;
      if ( off_2A148 == &off_2A148 )
        return v7;
      if ( !_bittest((const signed __int32 *)off_2A148 + 59, 8u) || *((_BYTE *)off_2A148 + 233) < 4u )
        goto LABEL_94;
      v11 = 40;
    }
    else
    {
      v10 = (void **)off_2A148;
      if ( off_2A148 == &off_2A148 )
        return v7;
      if ( !_bittest((const signed __int32 *)off_2A148 + 59, 8u) || *((_BYTE *)off_2A148 + 233) < 4u )
        goto LABEL_94;
      v11 = 41;
    }
    goto LABEL_92;
  }
  if ( *(_BYTE *)(a4 + 1028) != 2 )
  {
    if ( *(_BYTE *)(a4 + 1028) != 11 )
    {
      if ( *(_BYTE *)(a4 + 1028) != 14 )
        goto LABEL_93;
      if ( off_2A148 != &off_2A148
        && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
        && *((_BYTE *)off_2A148 + 233) >= 4u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 27), 0x30u, (__int64)&unk_28C08);
      }
      *(_BYTE *)(a4 + 1029) = 1;
      v10 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148 )
      {
        if ( _bittest((const signed __int32 *)off_2A148 + 59, 8u) && *((_BYTE *)off_2A148 + 233) >= 4u )
        {
          v11 = 49;
          goto LABEL_92;
        }
LABEL_94:
        if ( v10 != &off_2A148 && _bittest((const signed __int32 *)v10 + 59, 8u) && *((_BYTE *)v10 + 233) >= 5u )
          sub_11008((__int64)v10[27], 0x32u, (__int64)&unk_28C08);
        return v7;
      }
      return v7;
    }
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
      && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x2Cu, (__int64)&unk_28C08);
    }
    if ( (unsigned int)sub_1DF10(0x202300Au) )
    {
      if ( *(_DWORD *)(a4 + 1121) != 2 )
      {
        v7 = sub_184EC((__int64)Dst, (_DWORD *)a4);
        if ( v7 != 6 )
          goto LABEL_93;
        if ( off_2A148 != &off_2A148
          && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
          && *((_BYTE *)off_2A148 + 233) >= 2u )
        {
          sub_11008(*((_QWORD *)off_2A148 + 27), 0x2Du, (__int64)&unk_28C08);
        }
        goto LABEL_29;
      }
      v10 = (void **)off_2A148;
      if ( off_2A148 == &off_2A148 )
        return v7;
      if ( !_bittest((const signed __int32 *)off_2A148 + 59, 8u) || *((_BYTE *)off_2A148 + 233) < 4u )
        goto LABEL_94;
      v11 = 46;
    }
    else
    {
      v10 = (void **)off_2A148;
      if ( off_2A148 == &off_2A148 )
        return v7;
      if ( !_bittest((const signed __int32 *)off_2A148 + 59, 8u) || *((_BYTE *)off_2A148 + 233) < 4u )
        goto LABEL_94;
      v11 = 47;
    }
LABEL_92:
    sub_11008((__int64)v10[27], v11, (__int64)&unk_28C08);
    goto LABEL_93;
  }
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
    && *((_BYTE *)off_2A148 + 233) >= 4u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x2Au, (__int64)&unk_28C08);
  }
  v12 = (unsigned __int8 *)Dst[2];
  if ( *(_BYTE *)Dst[2] )
  {
    *(_BYTE *)(a4 + 1064) = *(_BYTE *)Dst[2];
    sub_2631C((void *)(a4 + 1065), 0x20ui64, v12 + 1, *v12);
  }
  v13 = sub_1A070((_QWORD *)(a4 + 1065), *(unsigned __int8 *)(a4 + 1064));
  *(_QWORD *)(a4 + 1105) = v13;
  v10 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( _bittest((const signed __int32 *)off_2A148 + 59, 8u) && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_12954(*((_QWORD *)off_2A148 + 27), 0x2Bu, (__int64)&unk_28C08, v13);
      goto LABEL_93;
    }
    goto LABEL_94;
  }
  return v7;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000017B9C) ----------------------------------------------------
char __fastcall sub_17B9C(char a1, __int64 a2)
{
  char v4; // bl
  void **v5; // r10
  unsigned __int16 v6; // dx
  int v7; // esi
  unsigned __int8 *v8; // rdx
  unsigned int i; // er8
  int v10; // eax
  char v11; // cl
  _WORD *v12; // rax
  int v13; // edi

  v4 = 1;
  v5 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x33u, (__int64)&unk_28C08);
    v5 = (void **)off_2A148;
  }
  switch ( a1 )
  {
    case 1:
      if ( v5 != &off_2A148 && _bittest((const signed __int32 *)v5 + 59, 8u) && *((_BYTE *)v5 + 233) >= 4u )
      {
        sub_11008((__int64)v5[27], 0x34u, (__int64)&unk_28C08);
        v5 = (void **)off_2A148;
      }
      v7 = 0;
      v8 = (unsigned __int8 *)(*(_QWORD *)a2 + 1i64);
      for ( i = 0; i < 3; ++i )
      {
        v10 = *v8++;
        v11 = 2 - i;
        v7 += v10 << (8 * v11);
      }
      v12 = *(_WORD **)(a2 + 40);
      v13 = **(unsigned __int8 **)(a2 + 32)
          + ((unsigned __int8)HIBYTE(**(_WORD **)(a2 + 24)) | (unsigned __int16)((unsigned __int8)**(_WORD **)(a2 + 24) << 8))
          + **(unsigned __int8 **)(a2 + 16)
          + 38;
      if ( v12 )
        v13 += ((unsigned __int8)HIBYTE(*v12) | (unsigned __int16)((unsigned __int8)*v12 << 8)) + 2;
      if ( v5 != &off_2A148 && _bittest((const signed __int32 *)v5 + 59, 8u) && *((_BYTE *)v5 + 233) >= 2u )
      {
        sub_1D110((__int64)v5[27], 0x35u, (__int64)&unk_28C08, v7);
        v5 = (void **)off_2A148;
      }
      if ( v7 != v13 )
      {
        if ( v5 != &off_2A148 && _bittest((const signed __int32 *)v5 + 59, 8u) && *((_BYTE *)v5 + 233) >= 2u )
        {
          sub_11008((__int64)v5[27], 0x36u, (__int64)&unk_28C08);
          v5 = (void **)off_2A148;
        }
        v4 = 0;
      }
      break;
    case 2:
      if ( v5 == &off_2A148 )
        return v4;
      if ( !_bittest((const signed __int32 *)v5 + 59, 8u) || *((_BYTE *)v5 + 233) < 4u )
        break;
      v6 = 55;
      goto LABEL_21;
    case 11:
      if ( v5 == &off_2A148 )
        return v4;
      if ( !_bittest((const signed __int32 *)v5 + 59, 8u) || *((_BYTE *)v5 + 233) < 4u )
        break;
      v6 = 56;
      goto LABEL_21;
    case 14:
      if ( v5 == &off_2A148 )
        return v4;
      if ( _bittest((const signed __int32 *)v5 + 59, 8u) && *((_BYTE *)v5 + 233) >= 4u )
      {
        v6 = 57;
LABEL_21:
        sub_11008((__int64)v5[27], v6, (__int64)&unk_28C08);
        v5 = (void **)off_2A148;
        break;
      }
      break;
  }
  if ( v5 != &off_2A148 && _bittest((const signed __int32 *)v5 + 59, 8u) && *((_BYTE *)v5 + 233) >= 5u )
    sub_11008((__int64)v5[27], 0x3Au, (__int64)&unk_28C08);
  return v4;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000017E40) ----------------------------------------------------
__int64 __fastcall sub_17E40(unsigned int a1, unsigned __int8 *a2, __int64 a3)
{
  unsigned int v3; // edi
  unsigned int v6; // er15
  void **v7; // rcx
  unsigned int v8; // ebx
  void **v10; // r10
  unsigned __int8 *v11; // r14
  unsigned int v12; // er12
  unsigned __int8 *v13; // r8
  int v14; // er9
  unsigned int i; // edx
  int v16; // eax
  char v17; // cl
  unsigned int v18; // ebp

  v3 = 0;
  v6 = 0;
  v7 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x42u, (__int64)&unk_28C08);
    v7 = (void **)off_2A148;
  }
  if ( !a2 )
  {
    if ( v7 != &off_2A148 && _bittest((const signed __int32 *)v7 + 59, 8u) && *((_BYTE *)v7 + 233) >= 2u )
      sub_11008((__int64)v7[27], 0x43u, (__int64)&unk_28C08);
    v8 = 4;
LABEL_17:
    *(_BYTE *)(a3 + 1030) = 1;
    return v8;
  }
  if ( !sub_16D98(a2) )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
      && *((_BYTE *)off_2A148 + 233) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 27), 0x44u, (__int64)&unk_28C08, *a2);
    }
    v8 = 17;
    goto LABEL_17;
  }
  v10 = (void **)off_2A148;
  v11 = a2 + 5;
  v12 = (unsigned __int8)HIBYTE(*(_WORD *)(a2 + 3)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a2 + 3) << 8);
  if ( a2 != (unsigned __int8 *)-5i64 )
  {
    while ( !*(_BYTE *)(a3 + 1030) )
    {
      v13 = v11 + 1;
      v14 = 0;
      for ( i = 0; i < 3; ++i )
      {
        v16 = *v13++;
        v17 = 2 - i;
        v14 += v16 << (8 * v17);
      }
      v18 = v14 + 4;
      if ( v10 != &off_2A148 && _bittest((const signed __int32 *)v10 + 59, 8u) && *((_BYTE *)v10 + 233) >= 4u )
      {
        sub_1D110((__int64)v10[27], 0x45u, (__int64)&unk_28C08, v14);
        v10 = (void **)off_2A148;
      }
      if ( v18 > v12 - v6 )
      {
        if ( v10 != &off_2A148 && _bittest((const signed __int32 *)v10 + 59, 8u) && *((_BYTE *)v10 + 233) >= 3u )
          sub_11008((__int64)v10[27], 0x46u, (__int64)&unk_28C08);
        *(_BYTE *)(a3 + 1030) = 1;
        v10 = (void **)off_2A148;
        v3 = 19;
        break;
      }
      sub_175DC(v11, a2, a1, a3);
      v6 += v18;
      if ( v6 >= v12 )
      {
        v10 = (void **)off_2A148;
        if ( off_2A148 == &off_2A148 )
          return v3;
        if ( _bittest((const signed __int32 *)off_2A148 + 59, 8u) && *((_BYTE *)off_2A148 + 233) >= 4u )
        {
          sub_11008(*((_QWORD *)off_2A148 + 27), 0x47u, (__int64)&unk_28C08);
          v10 = (void **)off_2A148;
        }
        break;
      }
      v10 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148
        && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
        && *((_BYTE *)off_2A148 + 233) >= 4u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 27), 0x48u, (__int64)&unk_28C08);
        v10 = (void **)off_2A148;
      }
      v11 += v18;
      if ( !v11 )
        break;
    }
  }
  if ( v10 != &off_2A148 && _bittest((const signed __int32 *)v10 + 59, 8u) && *((_BYTE *)v10 + 233) >= 5u )
    sub_11008((__int64)v10[27], 0x49u, (__int64)&unk_28C08);
  return v3;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000018160) ----------------------------------------------------
__int64 __fastcall sub_18160(unsigned __int8 *a1, __int64 *a2)
{
  void **v4; // r10
  __int64 v5; // rax
  __int64 v6; // rax
  __int64 v7; // rdx
  unsigned __int16 v8; // cx
  __int64 v9; // r8
  int v10; // edi
  unsigned __int8 *v11; // rax
  __int64 v12; // r11
  unsigned __int8 *v13; // rdx
  __int16 v14; // r9
  unsigned __int8 *v15; // r8
  unsigned __int8 *v16; // rsi
  unsigned int v17; // edx
  int v18; // eax
  char v19; // cl
  unsigned int v20; // edi

  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x4Eu, (__int64)&unk_28C08);
    v4 = (void **)off_2A148;
  }
  *a2 = (__int64)a1;
  if ( v4 != &off_2A148 && _bittest((const signed __int32 *)v4 + 59, 9u) && *((_BYTE *)v4 + 233) >= 4u )
  {
    sub_1102C((__int64)v4[27], 0x4Fu, (__int64)&unk_28C08, *a1);
    v4 = (void **)off_2A148;
  }
  switch ( *(_BYTE *)*a2 )
  {
    case 1:
      if ( v4 != &off_2A148 && _bittest((const signed __int32 *)v4 + 59, 9u) && *((_BYTE *)v4 + 233) >= 4u )
      {
        sub_11008((__int64)v4[27], 0x50u, (__int64)&unk_28C08);
        v4 = (void **)off_2A148;
      }
      v9 = *a2;
      v10 = 0;
      v11 = (unsigned __int8 *)(*a2 + 4);
      a2[1] = (__int64)v11;
      v11 += 34;
      v12 = *v11;
      a2[2] = (__int64)v11;
      v13 = &v11[v12 + 1];
      a2[3] = (__int64)v13;
      v14 = *(_WORD *)v13;
      v15 = (unsigned __int8 *)(v9 + 1);
      v16 = &v13[((unsigned __int8)HIBYTE(*(_WORD *)v13) | (unsigned __int64)(unsigned __int16)((unsigned __int8)*(_WORD *)v13 << 8))
               + 2];
      v17 = 0;
      a2[4] = (__int64)v16;
      do
      {
        v18 = *v15++;
        v19 = 2 - v17++;
        v10 += v18 << (8 * v19);
      }
      while ( v17 < 3 );
      v20 = v10 - (HIBYTE(v14) | (unsigned __int16)((unsigned __int8)v14 << 8)) - v12 - *v16 - 38;
      if ( v4 != &off_2A148 && _bittest((const signed __int32 *)v4 + 59, 9u) && *((_BYTE *)v4 + 233) >= 4u )
      {
        sub_1102C((__int64)v4[27], 0x51u, (__int64)&unk_28C08, v20);
        v4 = (void **)off_2A148;
      }
      if ( v20 <= 2 )
        a2[5] = 0i64;
      else
        a2[5] = *(unsigned __int8 *)a2[4] + a2[4] + 1;
      break;
    case 2:
      if ( v4 != &off_2A148 && _bittest((const signed __int32 *)v4 + 59, 9u) && *((_BYTE *)v4 + 233) >= 4u )
      {
        sub_11008((__int64)v4[27], 0x52u, (__int64)&unk_28C08);
        v4 = (void **)off_2A148;
      }
      v6 = *a2 + 4;
      a2[1] = v6;
      a2[2] = v6 + 34;
      v7 = *(unsigned __int8 *)(v6 + 34);
      v8 = _byteswap_ushort(*(_WORD *)(v7 + v6 + 34 + 1));
      *((_BYTE *)a2 + 26) = *(_BYTE *)(v7 + v6 + 34 + 3);
      *((_WORD *)a2 + 12) = v8;
      break;
    case 0xB:
      if ( v4 != &off_2A148 && _bittest((const signed __int32 *)v4 + 59, 9u) && *((_BYTE *)v4 + 233) >= 4u )
      {
        sub_11008((__int64)v4[27], 0x53u, (__int64)&unk_28C08);
        v4 = (void **)off_2A148;
      }
      v5 = *a2;
      a2[1] = *a2;
      a2[2] = v5 + 10;
      break;
    default:
      if ( v4 == &off_2A148 )
        return 0i64;
      if ( _bittest((const signed __int32 *)v4 + 59, 8u) && *((_BYTE *)v4 + 233) >= 4u )
      {
        sub_11008((__int64)v4[27], 0x54u, (__int64)&unk_28C08);
        v4 = (void **)off_2A148;
      }
      break;
  }
  if ( v4 != &off_2A148 && _bittest((const signed __int32 *)v4 + 59, 8u) && *((_BYTE *)v4 + 233) >= 5u )
    sub_11008((__int64)v4[27], 0x55u, (__int64)&unk_28C08);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000018484) ----------------------------------------------------
__int64 __fastcall sub_18484(__int64 a1, unsigned int *a2)
{
  __int64 result; // rax
  unsigned __int8 v4; // al
  unsigned int v5; // edi
  unsigned __int8 Dst; // [rsp+30h] [rbp+8h] BYREF
  __int16 v7; // [rsp+31h] [rbp+9h]
  char v8; // [rsp+33h] [rbp+Bh]

  LOBYTE(result) = *(_BYTE *)(a1 + 1);
  if ( (result & 0x80u) == 0i64 )
  {
    *a2 = 0;
    result = (unsigned __int8)result;
  }
  else
  {
    v4 = result & 0x7F;
    Dst = 0;
    v5 = v4;
    v7 = 0;
    v8 = 0;
    if ( v4 )
      memmove(&Dst, (const void *)(a1 + 2), v4);
    result = sub_16D60(&Dst, v5);
    *a2 = v5;
  }
  return result;
}

//----- (00000000000184EC) ----------------------------------------------------
__int64 __fastcall sub_184EC(__int64 a1, _DWORD *a2)
{
  unsigned int v3; // edi
  __int64 v4; // rbx
  __int64 v5; // r11
  __int64 v6; // r11
  __int64 v8; // rbx
  unsigned __int8 *v9; // rbx
  void **v10; // rsi
  unsigned __int8 *v11; // rbx
  _BYTE *v12; // rbx
  __int64 v13; // rbx
  unsigned int v14; // eax
  __int64 v15; // rbx
  unsigned int v16; // eax
  __int64 v17; // rbx
  int v18; // er13
  unsigned __int8 *v19; // rbx
  unsigned int v20; // er14
  unsigned int v21; // eax
  unsigned int v22; // [rsp+60h] [rbp+8h] BYREF

  v3 = 0;
  v4 = *(_QWORD *)(a1 + 16);
  v5 = *(_QWORD *)(a1 + 8);
  v22 = 0;
  if ( !(unsigned int)sub_16D60((unsigned __int8 *)(v5 + 4), 3u) )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 0xAu)
      && *((_BYTE *)off_2A148 + 233) >= 3u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x56u, (__int64)&unk_28C08);
    }
    return 0i64;
  }
  sub_16D60((unsigned __int8 *)(v6 + 7), 3u);
  if ( (unsigned int)sub_18484(v4, &v22) == -1 )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 0xAu)
      && *((_BYTE *)off_2A148 + 233) >= 3u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x57u, (__int64)&unk_28C08);
    }
    return 6i64;
  }
  v8 = v22 + v4 + 2;
  if ( (unsigned int)sub_18484(v8, &v22) == -1 )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 0xAu)
      && *((_BYTE *)off_2A148 + 233) >= 3u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x58u, (__int64)&unk_28C08);
    }
    return 6i64;
  }
  v9 = (unsigned __int8 *)(v8 + v22 + 2);
  if ( *v9 == 0xA0 )
  {
    v9 += 5;
    v10 = (void **)off_2A148;
  }
  else
  {
    v10 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 0xAu)
      && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 27), 0x59u, (__int64)&unk_28C08, *v9);
      v10 = (void **)off_2A148;
    }
  }
  v11 = &v9[v9[1] + 2 + v9[v9[1] + 3]];
  if ( *v11 != 5 )
    return 5i64;
  v12 = v11 + 1;
  if ( *v12 )
    return 5i64;
  v13 = (__int64)(v12 + 1);
  v14 = sub_18484(v13, &v22);
  if ( v14 == -1 )
  {
    if ( v10 != &off_2A148 && _bittest((const signed __int32 *)v10 + 59, 0xAu) && *((_BYTE *)v10 + 233) >= 3u )
      sub_11008((__int64)v10[27], 0x5Au, (__int64)&unk_28C08);
    return 6i64;
  }
  v15 = v13 + v22 + v14 + 2;
  v16 = sub_18484(v15, &v22);
  if ( v16 == -1 )
  {
    if ( v10 != &off_2A148 && _bittest((const signed __int32 *)v10 + 59, 0xAu) && *((_BYTE *)v10 + 233) >= 3u )
      sub_11008((__int64)v10[27], 0x5Bu, (__int64)&unk_28C08);
    return 6i64;
  }
  v17 = v15 + v16 + 2;
  v18 = sub_18484(v17, &v22);
  v19 = (unsigned __int8 *)(v17 + v22 + 2);
  while ( 1 )
  {
    while ( 1 )
    {
      if ( !v18 )
        return v3;
      v20 = sub_18484((__int64)v19, &v22);
      if ( v20 == -1 )
      {
        if ( v10 != &off_2A148 && _bittest((const signed __int32 *)v10 + 59, 0xAu) && *((_BYTE *)v10 + 233) >= 3u )
          sub_11008((__int64)v10[27], 0x5Du, (__int64)&unk_28C08);
        return 6;
      }
      if ( *v19 != 49 )
        break;
      v19 += v22 + 2;
      v18 -= 2;
      while ( v20 )
      {
        if ( *v19 == 48 )
        {
          v3 = sub_18A4C(v19, a2);
          if ( !v3 )
          {
            if ( off_2A148 != &off_2A148
              && _bittest((const signed __int32 *)off_2A148 + 59, 0xAu)
              && *((_BYTE *)off_2A148 + 233) >= 4u )
            {
              sub_11008(*((_QWORD *)off_2A148 + 27), 0x5Eu, (__int64)&unk_28C08);
            }
            return v3;
          }
          v19 += v20;
          v18 -= v20;
          v20 = 0;
          v10 = (void **)off_2A148;
        }
        else
        {
          v19 += 2;
          v18 -= 2;
          v20 -= 2;
        }
      }
    }
    if ( *v19 == 48 )
      break;
    if ( v10 != &off_2A148 && _bittest((const signed __int32 *)v10 + 59, 0xAu) && *((_BYTE *)v10 + 233) >= 4u )
    {
      sub_1102C((__int64)v10[27], 0x61u, (__int64)&unk_28C08, *v19);
      v10 = (void **)off_2A148;
    }
  }
  v21 = sub_18A4C(v19 + 2, a2);
  v3 = v21;
  if ( !v21 || v21 != 5 )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 0xAu)
      && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x5Fu, (__int64)&unk_28C08);
    }
    return v3;
  }
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xAu)
    && *((_BYTE *)off_2A148 + 233) >= 4u )
  {
    sub_1102C(*((_QWORD *)off_2A148 + 27), 0x60u, (__int64)&unk_28C08, 5);
  }
  return 5i64;
}
// 1856E: variable 'v6' is possibly undefined
// 2A148: using guessed type void *off_2A148;

//----- (0000000000018A4C) ----------------------------------------------------
__int64 __fastcall sub_18A4C(_BYTE *a1, _DWORD *a2)
{
  _BYTE *v2; // rdi
  _BYTE *v5; // rbx
  unsigned int v6; // ebp
  void **v7; // rcx
  char v8; // al
  size_t v9; // r8

  v2 = a1 + 2;
  v5 = a1 + 4;
  v6 = 5;
  v7 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xAu)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x63u, (__int64)&unk_28C08);
    v7 = (void **)off_2A148;
  }
  if ( (char)a1[1] < 0 )
  {
    v2 = v5;
    v5 += 2;
  }
  if ( (*a1 == 48 || *a1 == 49) && *v2 == 6 && *v5 == 85 && v5[1] == 4 && v5[2] == 3 )
  {
    if ( v7 != &off_2A148 && _bittest((const signed __int32 *)v7 + 59, 0xAu) && *((_BYTE *)v7 + 233) >= 5u )
    {
      sub_11008((__int64)v7[27], 0x64u, (__int64)&unk_28C08);
      v7 = (void **)off_2A148;
    }
    v8 = a1[7];
    if ( v8 == 20 || v8 == 19 || v8 == 12 || v8 == 30 || v8 == 22 || v8 == 28 )
    {
      v9 = (unsigned __int8)a1[8];
      a2[256] = v9;
      memmove(a2, a1 + 9, v9);
      v6 = 0;
      *((_BYTE *)a2 + (unsigned int)a2[256]) = 0;
      *(_DWORD *)((char *)a2 + 1121) = 3;
      v7 = (void **)off_2A148;
      if ( off_2A148 == &off_2A148 )
        return v6;
      if ( _bittest((const signed __int32 *)off_2A148 + 59, 0xAu) && *((_BYTE *)off_2A148 + 233) >= 5u )
      {
        sub_139F0(*((_QWORD *)off_2A148 + 27), 0x65u, (__int64)&unk_28C08, (const char *)a2);
        v7 = (void **)off_2A148;
      }
    }
  }
  if ( v7 != &off_2A148 && _bittest((const signed __int32 *)v7 + 59, 0xAu) && *((_BYTE *)v7 + 233) >= 5u )
    sub_11008((__int64)v7[27], 0x66u, (__int64)&unk_28C08);
  return v6;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000018C18) ----------------------------------------------------
__int64 __fastcall sub_18C18(_QWORD *a1, _DWORD *a2)
{
  unsigned int v4; // edi
  void **v5; // rcx
  unsigned __int16 v6; // dx
  __int64 v7; // rbx
  __int16 v8; // cx
  __int64 v9; // rcx
  _WORD *v11; // [rsp+40h] [rbp+8h] BYREF
  __int64 v12; // [rsp+50h] [rbp+18h] BYREF

  v11 = 0i64;
  v12 = 0i64;
  v4 = 5;
  v5 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 9u)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xAu, (__int64)&unk_28BF8);
    v5 = (void **)off_2A148;
  }
  if ( *a1 )
  {
    if ( a1[1] )
    {
      v4 = sub_18E18((__int64)a1, &v11);
      if ( !v4 )
      {
        v4 = sub_18F90(v11, &v12);
        if ( !v4 )
        {
          v7 = v12;
          v8 = (unsigned __int8)*(_WORD *)(v12 + 1);
          LOWORD(v11) = *(_WORD *)(v12 + 1);
          sub_2631C(a2, 0x400ui64, (const void *)(v12 + 3), BYTE1(v11) | (unsigned __int64)(unsigned __int16)(v8 << 8));
          LOWORD(v11) = *(_WORD *)(v7 + 1);
          v9 = BYTE1(v11) | (unsigned int)(unsigned __int16)((unsigned __int8)v11 << 8);
          a2[256] = BYTE1(v11) | (unsigned __int16)((unsigned __int8)v11 << 8);
          *((_BYTE *)a2 + v9) = 0;
          *(_DWORD *)((char *)a2 + 1121) = 2;
          v5 = (void **)off_2A148;
          if ( off_2A148 == &off_2A148 )
            return v4;
          if ( !_bittest((const signed __int32 *)off_2A148 + 59, 9u) || *((_BYTE *)off_2A148 + 233) < 4u )
            goto LABEL_23;
          sub_139F0(*((_QWORD *)off_2A148 + 27), 0xDu, (__int64)&unk_28BF8, (const char *)a2);
        }
      }
      goto LABEL_22;
    }
    if ( v5 == &off_2A148 )
      return v4;
    if ( !_bittest((const signed __int32 *)v5 + 59, 9u) || *((_BYTE *)v5 + 233) < 4u )
      goto LABEL_23;
    v6 = 12;
LABEL_10:
    sub_11008((__int64)v5[27], v6, (__int64)&unk_28BF8);
LABEL_22:
    v5 = (void **)off_2A148;
    goto LABEL_23;
  }
  if ( v5 == &off_2A148 )
    return v4;
  if ( _bittest((const signed __int32 *)v5 + 59, 9u) && *((_BYTE *)v5 + 233) >= 4u )
  {
    v6 = 11;
    goto LABEL_10;
  }
LABEL_23:
  if ( v5 != &off_2A148 && _bittest((const signed __int32 *)v5 + 59, 9u) && *((_BYTE *)v5 + 233) >= 5u )
    sub_1102C((__int64)v5[27], 0xEu, (__int64)&unk_28BF8, v4);
  return v4;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000018E18) ----------------------------------------------------
__int64 __fastcall sub_18E18(__int64 a1, _QWORD *a2)
{
  void **v4; // r10
  _WORD *v5; // rdi
  unsigned int v6; // ebx

  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 9u)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xFu, (__int64)&unk_28BF8);
    v4 = (void **)off_2A148;
  }
  v5 = *(_WORD **)(a1 + 40);
  v6 = 0;
  *a2 = 0i64;
  if ( v5 )
  {
    if ( v4 != &off_2A148 && _bittest((const signed __int32 *)v4 + 59, 9u) && *((_BYTE *)v4 + 233) >= 4u )
    {
      sub_1102C(
        (__int64)v4[27],
        0x11u,
        (__int64)&unk_28BF8,
        (unsigned __int8)HIBYTE(*v5) | (unsigned __int16)((unsigned __int8)*v5 << 8));
      v4 = (void **)off_2A148;
    }
    if ( (unsigned __int8)HIBYTE(*v5) | (unsigned __int16)((unsigned __int8)*v5 << 8) )
    {
      *a2 = v5;
      goto LABEL_18;
    }
    *a2 = 0i64;
  }
  else if ( v4 != &off_2A148 && _bittest((const signed __int32 *)v4 + 59, 9u) && *((_BYTE *)v4 + 233) >= 4u )
  {
    sub_11008((__int64)v4[27], 0x10u, (__int64)&unk_28BF8);
    v4 = (void **)off_2A148;
  }
  v6 = 5;
LABEL_18:
  if ( v4 != &off_2A148 && _bittest((const signed __int32 *)v4 + 59, 9u) && *((_BYTE *)v4 + 233) >= 5u )
    sub_1102C((__int64)v4[27], 0x12u, (__int64)&unk_28BF8, v6);
  return v6;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000018F90) ----------------------------------------------------
__int64 __fastcall sub_18F90(_WORD *a1, _QWORD *a2)
{
  __int64 v4; // r13
  unsigned int v5; // er14
  void **v6; // r10
  unsigned int v7; // ebx
  unsigned int v8; // esi
  _BYTE *v9; // rdi

  v4 = 0i64;
  v5 = 0;
  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 9u)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x16u, (__int64)&unk_28BF8);
    v6 = (void **)off_2A148;
  }
  *a2 = 0i64;
  if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 59, 9u) && *((_BYTE *)v6 + 233) >= 4u )
  {
    sub_1102C(
      (__int64)v6[27],
      0x17u,
      (__int64)&unk_28BF8,
      (unsigned __int8)HIBYTE(*a1) | (unsigned __int16)((unsigned __int8)*a1 << 8));
    v6 = (void **)off_2A148;
  }
  v7 = 5;
  v8 = 0;
  if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 59, 9u) && *((_BYTE *)v6 + 233) >= 5u )
  {
    sub_11008((__int64)v6[27], 0x13u, (__int64)&unk_28BF8);
    v6 = (void **)off_2A148;
  }
  while ( *(_WORD *)((char *)a1 + v8 + 2) )
  {
    v8 += ((unsigned __int8)HIBYTE(*(_WORD *)((char *)a1 + v8 + 4)) | (unsigned __int16)((unsigned __int8)*(_WORD *)((char *)a1 + v8 + 4) << 8))
        + 4;
    if ( v8 >= ((unsigned __int8)HIBYTE(*a1) | (unsigned int)(unsigned __int16)((unsigned __int8)*a1 << 8)) )
      goto LABEL_21;
  }
  if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 59, 9u) && *((_BYTE *)v6 + 233) >= 4u )
  {
    sub_11008((__int64)v6[27], 0x14u, (__int64)&unk_28BF8);
    v6 = (void **)off_2A148;
  }
  v4 = (__int64)a1 + v8 + 2;
  v7 = 0;
LABEL_21:
  if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 59, 9u) && *((_BYTE *)v6 + 233) >= 5u )
  {
    sub_1102C((__int64)v6[27], 0x15u, (__int64)&unk_28BF8, v7);
    v6 = (void **)off_2A148;
  }
  if ( v7 )
  {
LABEL_39:
    if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 59, 9u) && *((_BYTE *)v6 + 233) >= 5u )
      sub_1102C((__int64)v6[27], 0x1Au, (__int64)&unk_28BF8, v7);
  }
  else
  {
    v7 = 5;
    do
    {
      v9 = (_BYTE *)(v5 + v4 + 6);
      if ( !*v9 )
      {
        if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 59, 9u) && *((_BYTE *)v6 + 233) >= 4u )
        {
          sub_11008((__int64)v6[27], 0x18u, (__int64)&unk_28BF8);
          v6 = (void **)off_2A148;
        }
        *a2 = v9;
        v7 = 0;
        goto LABEL_39;
      }
      v5 += ((unsigned __int8)HIBYTE(*(_WORD *)(v5 + v4 + 7)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(v5 + v4 + 7) << 8))
          + 3;
    }
    while ( v5 < ((unsigned __int8)HIBYTE(*(_WORD *)(v4 + 4)) | (unsigned int)(unsigned __int16)((unsigned __int8)*(_WORD *)(v4 + 4) << 8)) );
    if ( *a2 )
      goto LABEL_39;
    if ( v6 != &off_2A148 )
    {
      if ( _bittest((const signed __int32 *)v6 + 59, 9u) && *((_BYTE *)v6 + 233) >= 3u )
      {
        sub_11008((__int64)v6[27], 0x19u, (__int64)&unk_28BF8);
        v6 = (void **)off_2A148;
      }
      goto LABEL_39;
    }
  }
  return v7;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000192C0) ----------------------------------------------------
char __fastcall sub_192C0(__int64 a1)
{
  char v2; // di
  void **v3; // rcx

  v2 = 0;
  v3 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 8u)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Bu, (__int64)&unk_28BF8);
    v3 = (void **)off_2A148;
  }
  if ( *(_BYTE *)(a1 + 1) == 3 && (*(_BYTE *)(a1 + 2) == 1 || *(_BYTE *)(a1 + 2) == 2 || *(_BYTE *)(a1 + 2) == 3) )
    v2 = 1;
  if ( v3 != &off_2A148 && _bittest((const signed __int32 *)v3 + 59, 8u) && *((_BYTE *)v3 + 233) >= 5u )
    sub_11008((__int64)v3[27], 0x1Cu, (__int64)&unk_28BF8);
  return v2;
}
// 1932B: conditional instruction was optimized away because of 'al.1==3'
// 19335: conditional instruction was optimized away because of 'al.1==3'
// 2A148: using guessed type void *off_2A148;

//----- (0000000000019388) ----------------------------------------------------
unsigned __int64 __fastcall sub_19388(_QWORD *a1, unsigned __int64 a2, unsigned __int64 a3)
{
  unsigned __int64 v3; // r11
  unsigned __int64 v5; // r9
  unsigned __int64 v6; // r10
  unsigned __int64 v7; // rdi
  unsigned __int64 v8; // rdx
  unsigned __int64 v9; // rdi
  unsigned __int64 v10; // r8
  unsigned __int64 v11; // rcx
  unsigned __int64 v12; // r10
  unsigned __int64 v13; // r8
  unsigned __int64 v14; // rdi
  unsigned __int64 v15; // r10
  unsigned __int64 v16; // r8
  unsigned __int64 v17; // rdi
  unsigned __int64 v18; // r10
  unsigned __int64 v19; // r8
  unsigned __int64 v20; // rdi
  unsigned __int64 v21; // r9
  unsigned __int64 v22; // rdx
  unsigned __int64 v23; // r10
  unsigned __int64 v24; // r8
  unsigned __int64 v25; // rdx
  unsigned __int64 v26; // r10
  unsigned __int64 v27; // r8
  unsigned __int64 v28; // rdx
  unsigned __int64 v29; // r10
  unsigned __int64 v30; // r8
  unsigned __int64 v31; // rdx
  unsigned __int64 v32; // r10

  v3 = a2;
  v5 = a2;
  v6 = a3;
  v7 = 0x9E3779B97F4A7C13ui64;
  if ( a2 >= 3 )
  {
    v8 = a2 / 3;
    v5 = v3 % 3;
    do
    {
      v9 = a1[2] + v7;
      v10 = a1[1] + a3;
      v11 = *a1 - v9;
      a1 += 3;
      v12 = (v9 >> 43) ^ (v11 - v10 + v6);
      v13 = (v12 << 9) ^ (v10 - v9 - v12);
      v14 = (v13 >> 8) ^ (v9 - v13 - v12);
      v15 = (v14 >> 38) ^ (v12 - v14 - v13);
      v16 = (v15 << 23) ^ (v13 - v14 - v15);
      v17 = (v16 >> 5) ^ (v14 - v16 - v15);
      v18 = (v17 >> 35) ^ (v15 - v17 - v16);
      v19 = (v18 << 49) ^ (v16 - v17 - v18);
      v20 = (v19 >> 11) ^ (v17 - v19 - v18);
      v6 = (v20 >> 12) ^ (v18 - v20 - v19);
      a3 = (v6 << 18) ^ (v19 - v20 - v6);
      v7 = (a3 >> 22) ^ (v20 - a3 - v6);
      --v8;
    }
    while ( v8 );
  }
  v21 = v5 - 1;
  v22 = v7 + 8 * v3;
  if ( !v21 )
    goto LABEL_7;
  if ( v21 == 1 )
  {
    a3 += a1[1];
LABEL_7:
    v6 += *a1;
  }
  v23 = (v22 >> 43) ^ (v6 - v22 - a3);
  v24 = (v23 << 9) ^ (a3 - v22 - v23);
  v25 = (v24 >> 8) ^ (v22 - v24 - v23);
  v26 = (v25 >> 38) ^ (v23 - v25 - v24);
  v27 = (v26 << 23) ^ (v24 - v25 - v26);
  v28 = (v27 >> 5) ^ (v25 - v27 - v26);
  v29 = (v28 >> 35) ^ (v26 - v28 - v27);
  v30 = (v29 << 49) ^ (v27 - v28 - v29);
  v31 = (v30 >> 11) ^ (v28 - v30 - v29);
  v32 = (v31 >> 12) ^ (v29 - v31 - v30);
  return (((v32 << 18) ^ (v30 - v31 - v32)) >> 22) ^ (v31 - ((v32 << 18) ^ (v30 - v31 - v32)) - v32);
}

//----- (0000000000019590) ----------------------------------------------------
__int64 sub_19590(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_2A1B8(a1, 43i64, &unk_28BE8, a2, (__int64 *)va);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000195E4) ----------------------------------------------------
__int64 __fastcall sub_195E4(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5)
{
  int v7; // [rsp+78h] [rbp+20h] BYREF

  v7 = a4;
  if ( a5 )
    strlen(a5);
  return qword_2A1B8(a1, 43i64, &unk_28BE8, 53i64, &v7);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000019670) ----------------------------------------------------
__int64 __fastcall sub_19670(__int64 a1, __int64 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_2A1B8(a1, 43i64, &unk_28BE8, 28i64, v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000019704) ----------------------------------------------------
__int64 sub_19704()
{
  __int64 result; // rax
  unsigned int v1; // eax
  __int64 v2; // rcx
  __int64 v3; // [rsp+28h] [rbp-40h]
  int v4; // [rsp+70h] [rbp+8h] BYREF

  v4 = 0;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xAu, (__int64)&unk_28BE8);
  }
  qword_2A288 = sub_1A778(1i64, 0x410u, 0x61637348u);
  if ( qword_2A288 )
  {
    v1 = sub_1DF10(0x202300Cu);
    LOBYTE(v2) = 3;
    LODWORD(v3) = 2;
    qword_2CD20 = (ULONG_PTR)sub_22F68(
                               v2,
                               0i64,
                               1i64,
                               0x61637348u,
                               v1,
                               v3,
                               0i64,
                               0i64,
                               (__int64)sub_199B0,
                               (__int64)sub_1A230,
                               &v4);
    if ( v4 )
    {
      sub_1A930(qword_2A288);
      if ( off_2A148 != &off_2A148
        && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
        && *((_BYTE *)off_2A148 + 233) >= 2u )
      {
        sub_1102C(*((_QWORD *)off_2A148 + 27), 0xCu, (__int64)&unk_28BE8, v4);
      }
      result = 1i64;
    }
    else
    {
      if ( off_2A148 != &off_2A148
        && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
        && *((_BYTE *)off_2A148 + 233) >= 5u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 27), 0xDu, (__int64)&unk_28BE8);
      }
      result = 0i64;
    }
  }
  else
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
      && *((_BYTE *)off_2A148 + 233) >= 2u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0xBu, (__int64)&unk_28BE8);
    }
    result = 3i64;
  }
  return result;
}
// 19810: variable 'v2' is possibly undefined
// 19810: variable 'v3' is possibly undefined
// 2A148: using guessed type void *off_2A148;

//----- (00000000000198C0) ----------------------------------------------------
__int64 sub_198C0()
{
  int v0; // eax
  __int64 result; // rax

  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0xEu, (__int64)&unk_28BE8);
  }
  v0 = sub_231F8(qword_2CD20);
  if ( v0 )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
      && *((_BYTE *)off_2A148 + 233) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 27), 0xFu, (__int64)&unk_28BE8, v0);
    }
    result = 1i64;
  }
  else
  {
    sub_1A930(qword_2A288);
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
      && *((_BYTE *)off_2A148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 27), 0x10u, (__int64)&unk_28BE8);
    }
    result = 0i64;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000199B0) ----------------------------------------------------
__int64 __fastcall sub_199B0(_QWORD *a1)
{
  void **v2; // rcx

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x17u, (__int64)&unk_28BE8);
    v2 = (void **)off_2A148;
  }
  if ( a1 )
  {
    if ( v2 != &off_2A148 && _bittest((const signed __int32 *)v2 + 59, 0xBu) && *((_BYTE *)v2 + 233) >= 4u )
      sub_12954((__int64)v2[27], 0x18u, (__int64)&unk_28BE8, *a1);
    sub_1A230((__int64)a1);
    sub_1AAB8((__int64)qword_2A288, (__int64)a1);
    v2 = (void **)off_2A148;
  }
  if ( v2 != &off_2A148 && _bittest((const signed __int32 *)v2 + 59, 0xBu) && *((_BYTE *)v2 + 233) >= 5u )
    sub_11008((__int64)v2[27], 0x19u, (__int64)&unk_28BE8);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000019AA8) ----------------------------------------------------
_QWORD *__fastcall sub_19AA8(__int64 a1, ULONG_PTR **a2, _DWORD *a3)
{
  void **v6; // rcx
  _DWORD *v7; // rax
  _QWORD *v8; // rbx
  void **v9; // rcx

  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Au, (__int64)&unk_28BE8);
    v6 = (void **)off_2A148;
  }
  *a3 = 0;
  if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 59, 0xBu) && *((_BYTE *)v6 + 233) >= 5u )
    sub_11008((__int64)v6[27], 0x14u, (__int64)&unk_28BE8);
  v7 = sub_1AA50((__int64)qword_2A288);
  v8 = v7;
  if ( !v7 )
  {
    v9 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 )
    {
      if ( _bittest((const signed __int32 *)off_2A148 + 59, 0xBu) && *((_BYTE *)off_2A148 + 233) >= 2u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 27), 0x15u, (__int64)&unk_28BE8);
        v9 = (void **)off_2A148;
      }
      if ( v9 != &off_2A148 && _bittest((const signed __int32 *)v9 + 59, 0xBu) && *((_BYTE *)v9 + 233) >= 2u )
        sub_11068((__int64)v9[27], 0x1Bu, (__int64)&unk_28BE8, (const char *)a1);
    }
    *a3 = 3;
    return 0i64;
  }
  memset(v7, 0, 0x410ui64);
  *v8 = *(_QWORD *)(a1 + 1105);
  *((_DWORD *)v8 + 258) = *(_DWORD *)(a1 + 1024);
  sub_263C0((_BYTE *)v8 + 8, 1024i64, (char *)a1);
  *((_DWORD *)v8 + 259) = *(_DWORD *)(a1 + 1121);
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x16u, (__int64)&unk_28BE8);
  }
  if ( (unsigned int)sub_24294(qword_2CD20, *v8, (__int64)v8, a2) )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
      && *((_BYTE *)off_2A148 + 233) >= 2u )
    {
      sub_19670(*((_QWORD *)off_2A148 + 27), 28i64, (__int64)&unk_28BE8, (const char *)a1);
    }
    sub_199B0(v8);
    *a3 = 13;
    return 0i64;
  }
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 4u )
  {
    sub_12954(*((_QWORD *)off_2A148 + 27), 0x1Du, (__int64)&unk_28BE8, *v8);
  }
  sub_1A230((__int64)v8);
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Eu, (__int64)&unk_28BE8);
  }
  return v8;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000019D54) ----------------------------------------------------
__int64 __fastcall sub_19D54(unsigned __int64 a1, _QWORD *a2, _DWORD *a3)
{
  ULONG_PTR v6; // rcx
  __int64 v7; // rbx
  void **v8; // rcx
  int v10; // [rsp+40h] [rbp+18h] BYREF

  v10 = 0;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x1Fu, (__int64)&unk_28BE8);
  }
  v6 = qword_2CD20;
  *a3 = 0;
  v7 = sub_2474C(v6, a1, a2, &v10);
  if ( v10 )
  {
    v8 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
      && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_12954(*((_QWORD *)off_2A148 + 27), 0x21u, (__int64)&unk_28BE8, a1);
      v8 = (void **)off_2A148;
    }
    *a3 = 5;
    v7 = 0i64;
  }
  else
  {
    v8 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
      && *((_BYTE *)off_2A148 + 233) >= 4u )
    {
      sub_12954(*((_QWORD *)off_2A148 + 27), 0x20u, (__int64)&unk_28BE8, a1);
      v8 = (void **)off_2A148;
    }
    *a3 = 0;
  }
  if ( v8 != &off_2A148 && _bittest((const signed __int32 *)v8 + 59, 0xBu) && *((_BYTE *)v8 + 233) >= 5u )
    sub_11008((__int64)v8[27], 0x22u, (__int64)&unk_28BE8);
  return v7;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000019EB4) ----------------------------------------------------
__int64 __fastcall sub_19EB4(unsigned __int64 a1, __int64 a2, __int64 a3)
{
  unsigned int v3; // ebx
  void **v5; // rcx
  int v7; // [rsp+48h] [rbp+10h] BYREF

  v3 = 0;
  v7 = 0;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x23u, (__int64)&unk_28BE8);
  }
  LOBYTE(a3) = 1;
  sub_244C8(qword_2CD20, a1, a3, &v7);
  if ( v7 )
  {
    v5 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
      && *((_BYTE *)off_2A148 + 233) >= 2u )
    {
      sub_19590(*((_QWORD *)off_2A148 + 27), 0x24u, (__int64)&unk_28BE8, a1, v7);
      v5 = (void **)off_2A148;
    }
    v3 = 1;
  }
  else
  {
    v5 = (void **)off_2A148;
  }
  if ( v5 != &off_2A148 && _bittest((const signed __int32 *)v5 + 59, 0xBu) && *((_BYTE *)v5 + 233) >= 5u )
    sub_11008((__int64)v5[27], 0x25u, (__int64)&unk_28BE8);
  return v3;
}
// 19F1A: variable 'a3' is possibly undefined
// 2A148: using guessed type void *off_2A148;

//----- (0000000000019FC8) ----------------------------------------------------
__int64 __fastcall sub_19FC8(ULONG_PTR BugCheckParameter1)
{
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x26u, (__int64)&unk_28BE8);
  }
  sub_24F80(qword_2CD20, BugCheckParameter1);
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x27u, (__int64)&unk_28BE8);
  }
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001A070) ----------------------------------------------------
unsigned __int64 __fastcall sub_1A070(_QWORD *a1, unsigned int a2)
{
  unsigned __int64 v2; // rsi
  unsigned __int64 v4; // rdi
  void **v5; // rbx

  v2 = a2;
  v4 = 0i64;
  v5 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 236) & 0x40) != 0 && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x28u, (__int64)&unk_28BE8);
    v5 = (void **)off_2A148;
  }
  if ( (_DWORD)v2 )
    v4 = sub_19388(a1, v2 >> 3, v2);
  if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 236) & 0x40) != 0 && *((_BYTE *)v5 + 233) >= 5u )
    sub_11008((__int64)v5[27], 0x29u, (__int64)&unk_28BE8);
  return v4;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001A140) ----------------------------------------------------
__int64 __fastcall sub_1A140(ULONG_PTR a1)
{
  unsigned int v2; // eax
  int v3; // eax
  void **v4; // rcx

  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 27), 0x2Du, (__int64)&unk_28BE8);
  }
  v2 = sub_1DF10(0x202300Cu);
  v3 = sub_25BF8(qword_2CD20, a1, v2);
  if ( !v3 )
    goto LABEL_10;
  v4 = (void **)off_2A148;
  if ( off_2A148 == &off_2A148 )
    return 0i64;
  if ( _bittest((const signed __int32 *)off_2A148 + 59, 0xBu) && *((_BYTE *)off_2A148 + 233) >= 2u )
  {
    sub_1102C(*((_QWORD *)off_2A148 + 27), 0x2Eu, (__int64)&unk_28BE8, v3);
LABEL_10:
    v4 = (void **)off_2A148;
  }
  if ( v4 != &off_2A148 && _bittest((const signed __int32 *)v4 + 59, 0xBu) && *((_BYTE *)v4 + 233) >= 5u )
    sub_11008((__int64)v4[27], 0x2Fu, (__int64)&unk_28BE8);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001A230) ----------------------------------------------------
__int64 __fastcall sub_1A230(__int64 a1)
{
  void **v2; // rcx
  __int64 result; // rax

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 5u )
  {
    result = sub_11008(*((_QWORD *)off_2A148 + 27), 0x30u, (__int64)&unk_28BE8);
    v2 = (void **)off_2A148;
  }
  if ( !a1 )
  {
    if ( v2 == &off_2A148 )
      return result;
    if ( !_bittest((const signed __int32 *)v2 + 59, 0xBu) || *((_BYTE *)v2 + 233) < 2u )
      goto LABEL_27;
    result = sub_11008((__int64)v2[27], 0x31u, (__int64)&unk_28BE8);
    goto LABEL_26;
  }
  if ( v2 != &off_2A148 )
  {
    if ( _bittest((const signed __int32 *)v2 + 59, 0xBu) && *((_BYTE *)v2 + 233) >= 4u )
    {
      result = sub_11008((__int64)v2[27], 0x32u, (__int64)&unk_28BE8);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 )
    {
      if ( _bittest((const signed __int32 *)v2 + 59, 0xBu) && *((_BYTE *)v2 + 233) >= 4u )
      {
        result = sub_11008((__int64)v2[27], 0x33u, (__int64)&unk_28BE8);
        v2 = (void **)off_2A148;
      }
      if ( v2 != &off_2A148 )
      {
        if ( _bittest((const signed __int32 *)v2 + 59, 0xBu) && *((_BYTE *)v2 + 233) >= 4u )
        {
          result = sub_19590((__int64)v2[27], 0x34u, (__int64)&unk_28BE8, *(_QWORD *)a1, *(_DWORD *)(a1 + 1036));
          v2 = (void **)off_2A148;
        }
        if ( v2 != &off_2A148 )
        {
          if ( !_bittest((const signed __int32 *)v2 + 59, 0xBu) || *((_BYTE *)v2 + 233) < 4u )
          {
LABEL_27:
            if ( v2 != &off_2A148 && _bittest((const signed __int32 *)v2 + 59, 0xBu) && *((_BYTE *)v2 + 233) >= 5u )
              result = sub_11008((__int64)v2[27], 0x36u, (__int64)&unk_28BE8);
            return result;
          }
          result = sub_195E4(
                     (__int64)v2[27],
                     53i64,
                     (__int64)&unk_28BE8,
                     *(_DWORD *)(a1 + 1032),
                     (const char *)(a1 + 8));
LABEL_26:
          v2 = (void **)off_2A148;
          goto LABEL_27;
        }
      }
    }
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001A404) ----------------------------------------------------
__int64 sub_1A404()
{
  unsigned int v0; // ebx
  int v2; // [rsp+38h] [rbp+10h] BYREF

  v2 = 0;
  v0 = sub_2419C(qword_2CD20, &v2);
  if ( v2
    && off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 59, 0xBu)
    && *((_BYTE *)off_2A148 + 233) >= 2u )
  {
    sub_1102C(*((_QWORD *)off_2A148 + 27), 0x37u, (__int64)&unk_28BE8, v2);
  }
  return v0;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001A478) ----------------------------------------------------
__int64 __fastcall sub_1A478(__int64 a1, unsigned __int16 a2)
{
  strlen(aUnknownModule);
  return qword_2A1B8(a1, 43i64, &unk_28BD8, a2, aUnknownModule);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001A4F8) ----------------------------------------------------
PVOID __fastcall sub_1A4F8(int a1, unsigned int a2, ULONG a3)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 4) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1A478(*((_QWORD *)off_2A148 + 11), 0xAu);
  return sub_1B8A4(a1, a2, a3);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001A57C) ----------------------------------------------------
void __fastcall sub_1A57C(PVOID P, ULONG Tag)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 4) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1A478(*((_QWORD *)off_2A148 + 11), 0xBu);
  sub_1B9C0(P, Tag);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001A5F0) ----------------------------------------------------
PVOID __fastcall sub_1A5F0(int a1, void *a2, unsigned int a3, unsigned int a4, ULONG Tag)
{
  size_t v6; // r12
  void **v9; // rcx
  PVOID v10; // rax
  PVOID v11; // rbx

  v6 = a3;
  v9 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 4) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0xCu);
      v9 = (void **)off_2A148;
    }
    if ( v9 != &off_2A148 )
    {
      if ( (*((_BYTE *)v9 + 108) & 2) != 0 && *((_BYTE *)v9 + 105) >= 4u )
      {
        sub_11008((__int64)v9[11], 0x10u, (__int64)&unk_28BC8);
        v9 = (void **)off_2A148;
      }
      if ( v9 != &off_2A148 && (*((_BYTE *)v9 + 108) & 4) != 0 && *((_BYTE *)v9 + 105) >= 6u )
        sub_1B778((__int64)v9[11], 17i64, (__int64)&unk_28BC8, (int)a2);
    }
  }
  v10 = sub_1B8A4(a1, a4, Tag);
  v11 = v10;
  if ( v10 && a2 )
  {
    memmove(v10, a2, v6);
    sub_1B9C0(a2, Tag);
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_2A148 + 11), 0x12u, (__int64)&unk_28BC8, (int)v11);
  return v11;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001A778) ----------------------------------------------------
char *__fastcall sub_1A778(__int64 a1, unsigned int a2, ULONG a3)
{
  __int64 v4; // rdi
  void **v5; // rcx
  char *v6; // rbx
  char *v7; // rax

  v4 = a2;
  v5 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 4) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
  {
    sub_1A478(*((_QWORD *)off_2A148 + 11), 0xDu);
    v5 = (void **)off_2A148;
  }
  v6 = 0i64;
  if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 108) & 2) != 0 && *((_BYTE *)v5 + 105) >= 4u )
  {
    sub_11008((__int64)v5[11], 0x13u, (__int64)&unk_28BC8);
    v5 = (void **)off_2A148;
  }
  if ( (_DWORD)v4 )
  {
    v7 = (char *)sub_1B8A4(2, 0xC0u, a3);
    v6 = v7;
    if ( v7 )
    {
      memset(v7, 0, 0xC0ui64);
      *((_DWORD *)v6 + 1) = v4;
      *(_DWORD *)v6 = 1;
      *((_DWORD *)v6 + 2) = a3;
      if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 108) & 4) == 0 || *((_BYTE *)off_2A148 + 105) < 5u )
        goto LABEL_17;
      sub_11008(*((_QWORD *)off_2A148 + 11), 0x14u, (__int64)&unk_28BC8);
      if ( *(_DWORD *)v6 == 2 )
        ExInitializeNPagedLookasideList((PNPAGED_LOOKASIDE_LIST)(v6 + 64), 0i64, 0i64, 0, v4 + 7, a3, 0);
      if ( *(_DWORD *)v6 == 1 )
LABEL_17:
        ExInitializePagedLookasideList((PPAGED_LOOKASIDE_LIST)(v6 + 64), 0i64, 0i64, 0, v4 + 7, a3, 0);
    }
    v5 = (void **)off_2A148;
  }
  if ( v5 != &off_2A148 && (*((_BYTE *)v5 + 108) & 2) != 0 && *((_BYTE *)v5 + 105) >= 4u )
    sub_1102C((__int64)v5[11], 0x15u, (__int64)&unk_28BC8, (int)v6);
  return v6;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001A930) ----------------------------------------------------
void __fastcall sub_1A930(PVOID P)
{
  void **v2; // rcx

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 4) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0xEu);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 )
    {
      if ( (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      {
        sub_11008((__int64)v2[11], 0x16u, (__int64)&unk_28BC8);
        v2 = (void **)off_2A148;
      }
      if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 108) & 4) != 0 && *((_BYTE *)v2 + 105) >= 5u )
        sub_11008((__int64)v2[11], 0x17u, (__int64)&unk_28BC8);
    }
  }
  if ( *(_DWORD *)P == 2 )
  {
    ExDeleteNPagedLookasideList((PNPAGED_LOOKASIDE_LIST)((char *)P + 64));
  }
  else if ( *(_DWORD *)P == 1 )
  {
    ExDeletePagedLookasideList((PPAGED_LOOKASIDE_LIST)((char *)P + 64));
  }
  sub_1B9C0(P, *((_DWORD *)P + 2));
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x18u, (__int64)&unk_28BC8);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001AA50) ----------------------------------------------------
_DWORD *__fastcall sub_1AA50(__int64 a1)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 4) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1A478(*((_QWORD *)off_2A148 + 11), 0xFu);
  return sub_1BAB8(a1);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001AAB8) ----------------------------------------------------
void __fastcall sub_1AAB8(__int64 a1, __int64 a2)
{
  void **v4; // rcx
  struct _SLIST_ENTRY *v5; // rdi

  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 4) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x10u);
      v4 = (void **)off_2A148;
    }
    if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 108) & 2) != 0 && *((_BYTE *)v4 + 105) >= 4u )
    {
      sub_11008((__int64)v4[11], 0x1Bu, (__int64)&unk_28BC8);
      v4 = (void **)off_2A148;
    }
  }
  v5 = (struct _SLIST_ENTRY *)(a2 - 4);
  if ( LODWORD(v5->Next) )
  {
    if ( LODWORD(v5->Next) == 1 )
    {
      sub_1B9C0(v5, *(_DWORD *)(a1 + 8));
LABEL_18:
      v4 = (void **)off_2A148;
      goto LABEL_19;
    }
  }
  else if ( *(_DWORD *)a1 == 2 || *(_DWORD *)a1 == 1 )
  {
    ++*(_DWORD *)(a1 + 92);
    if ( ExQueryDepthSList((PSLIST_HEADER)(a1 + 64)) < *(_WORD *)(a1 + 80) )
    {
      ExpInterlockedPushEntrySList((PSLIST_HEADER)(a1 + 64), v5);
    }
    else
    {
      ++*(_DWORD *)(a1 + 96);
      (*(void (__fastcall **)(struct _SLIST_ENTRY *))(a1 + 120))(v5);
    }
    goto LABEL_18;
  }
LABEL_19:
  if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 108) & 2) != 0 && *((_BYTE *)v4 + 105) >= 4u )
    sub_11008((__int64)v4[11], 0x1Cu, (__int64)&unk_28BC8);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001ABE4) ----------------------------------------------------
__int64 __fastcall sub_1ABE4(PERESOURCE Resource)
{
  void **v2; // rcx
  int v3; // eax
  unsigned int v4; // ebx

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x12u);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x1Fu, (__int64)&unk_28BC8);
  }
  v3 = ExInitializeResourceLite(Resource);
  v4 = v3;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_2A148 + 11), 0x20u, (__int64)&unk_28BC8, v3);
  return v4;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001ACB8) ----------------------------------------------------
__int64 __fastcall sub_1ACB8(PERESOURCE Resource)
{
  void **v2; // rcx
  int v3; // eax
  unsigned int v4; // ebx

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x13u);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x21u, (__int64)&unk_28BC8);
  }
  v3 = ExDeleteResourceLite(Resource);
  v4 = v3;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_2A148 + 11), 0x22u, (__int64)&unk_28BC8, v3);
  return v4;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001AD8C) ----------------------------------------------------
BOOLEAN __fastcall sub_1AD8C(PERESOURCE Resource)
{
  void **v2; // rcx
  BOOLEAN v3; // al
  BOOLEAN v4; // bl

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x15u);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x25u, (__int64)&unk_28BC8);
  }
  v3 = ExAcquireResourceExclusiveLite(Resource, 1u);
  v4 = v3;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_2A148 + 11), 0x26u, (__int64)&unk_28BC8, v3);
  return v4;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001AE64) ----------------------------------------------------
BOOLEAN __fastcall sub_1AE64(PERESOURCE Resource)
{
  void **v2; // rcx
  BOOLEAN v3; // al
  BOOLEAN v4; // bl

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x16u);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x27u, (__int64)&unk_28BC8);
  }
  v3 = ExAcquireResourceSharedLite(Resource, 1u);
  v4 = v3;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_2A148 + 11), 0x28u, (__int64)&unk_28BC8, v3);
  return v4;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001AF3C) ----------------------------------------------------
void __fastcall sub_1AF3C(PERESOURCE Resource)
{
  void **v2; // rcx

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x18u);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x2Bu, (__int64)&unk_28BC8);
  }
  ExReleaseResourceLite(Resource);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x2Cu, (__int64)&unk_28BC8);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001B008) ----------------------------------------------------
bool __fastcall sub_1B008(struct _KEVENT **a1, char a2)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1A478(*((_QWORD *)off_2A148 + 11), 0x1Du);
  return sub_1BD9C(a1, a2);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001B080) ----------------------------------------------------
void __fastcall sub_1B080(PVOID P)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1A478(*((_QWORD *)off_2A148 + 11), 0x1Eu);
  sub_1BE84(P);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001B0E8) ----------------------------------------------------
int __fastcall sub_1B0E8(PRKEVENT Event)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1A478(*((_QWORD *)off_2A148 + 11), 0x1Fu);
  return sub_1BF1C(Event);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001B150) ----------------------------------------------------
int __fastcall sub_1B150(PRKEVENT Event)
{
  void **v2; // rcx
  int result; // eax

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x20u);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x3Bu, (__int64)&unk_28BC8);
  }
  result = KeResetEvent(Event);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    result = sub_11008(*((_QWORD *)off_2A148 + 11), 0x3Cu, (__int64)&unk_28BC8);
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001B21C) ----------------------------------------------------
void __fastcall sub_1B21C(__int64 a1)
{
  void **v2; // rcx

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x21u);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x3Du, (__int64)&unk_28BC8);
  }
  *(_QWORD *)(a1 + 8) = 0i64;
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)a1 = 1;
  KeInitializeEvent((PRKEVENT)(a1 + 24), SynchronizationEvent, 0);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x3Eu, (__int64)&unk_28BC8);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001B2FC) ----------------------------------------------------
void __fastcall sub_1B2FC(PFAST_MUTEX FastMutex)
{
  void **v2; // rcx

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x22u);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x3Fu, (__int64)&unk_28BC8);
  }
  ExAcquireFastMutex(FastMutex);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x40u, (__int64)&unk_28BC8);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001B3C8) ----------------------------------------------------
void __fastcall sub_1B3C8(PFAST_MUTEX FastMutex)
{
  void **v2; // rcx

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x24u);
      v2 = (void **)off_2A148;
    }
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x43u, (__int64)&unk_28BC8);
  }
  ExReleaseFastMutex(FastMutex);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x44u, (__int64)&unk_28BC8);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001B494) ----------------------------------------------------
__int64 __fastcall sub_1B494(PVOID P)
{
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1A478(*((_QWORD *)off_2A148 + 11), 0x2Du);
  return sub_1C80C(P);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001B508) ----------------------------------------------------
_QWORD *__fastcall sub_1B508(__int64 a1, int a2, __int64 a3)
{
  void **v6; // rcx
  _QWORD *v7; // rbx
  _QWORD *v8; // rdi
  unsigned int v9; // ebp

  v6 = (void **)off_2A148;
  v7 = 0i64;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
  {
    sub_1A478(*((_QWORD *)off_2A148 + 11), 0x2Eu);
    v6 = (void **)off_2A148;
  }
  v8 = 0i64;
  v9 = a2 + 40;
  if ( v6 != &off_2A148 && (*((_BYTE *)v6 + 108) & 2) != 0 && *((_BYTE *)v6 + 105) >= 4u )
  {
    sub_11008((__int64)v6[11], 0x68u, (__int64)&unk_28BC8);
    v6 = (void **)off_2A148;
  }
  if ( a1 && a3 && a2 )
  {
    v8 = sub_1B8A4(2, v9, 0x6E635749u);
LABEL_17:
    if ( v8 )
    {
      memset(v8, 0, v9);
      v8[4] = 0i64;
      v7 = v8 + 5;
      v8[1] = v8;
      *v8 = v8;
      v8[3] = a3;
      v8[2] = a1;
    }
    v6 = (void **)off_2A148;
    goto LABEL_20;
  }
  if ( v6 == &off_2A148 )
    return v7;
  if ( *((char *)v6 + 108) < 0 && *((_BYTE *)v6 + 105) >= 3u )
  {
    sub_11008((__int64)v6[11], 0x69u, (__int64)&unk_28BC8);
    goto LABEL_17;
  }
LABEL_20:
  if ( v6 != &off_2A148 && (*((_BYTE *)v6 + 108) & 2) != 0 && *((_BYTE *)v6 + 105) >= 4u )
    sub_1102C((__int64)v6[11], 0x6Au, (__int64)&unk_28BC8, (int)v7);
  return v7;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001B67C) ----------------------------------------------------
__int64 __fastcall sub_1B67C(PVOID Object)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1A478(*((_QWORD *)off_2A148 + 11), 0x32u);
  return sub_1CD38(Object);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001B6E8) ----------------------------------------------------
__int64 __fastcall sub_1B6E8(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+B8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_2A1B8(a1, 43i64, &unk_28BC8, 14i64, &v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001B778) ----------------------------------------------------
__int64 __fastcall sub_1B778(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+C8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_2A1B8(a1, 43i64, &unk_28BC8, 17i64, &v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001B814) ----------------------------------------------------
__int64 __fastcall sub_1B814(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+B8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_2A1B8(a1, 43i64, &unk_28BC8, 11i64, &v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001B8A4) ----------------------------------------------------
PVOID __fastcall sub_1B8A4(int a1, unsigned int a2, ULONG a3)
{
  SIZE_T v4; // rdi
  void **v6; // rcx
  PVOID v7; // rax
  PVOID v8; // rbx

  v4 = a2;
  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 11), 0xAu, (__int64)&unk_28BC8);
      v6 = (void **)off_2A148;
    }
    if ( v6 != &off_2A148 && (*((_BYTE *)v6 + 108) & 4) != 0 && *((_BYTE *)v6 + 105) >= 6u )
      sub_1B814((__int64)v6[11], 11i64, (__int64)&unk_28BC8, v4);
  }
  v7 = ExAllocatePoolWithTag((POOL_TYPE)(a1 != 2), v4, a3);
  v8 = v7;
  if ( v7 )
    memset(v7, 0, v4);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_2A148 + 11), 0xCu, (__int64)&unk_28BC8, (int)v8);
  return v8;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001B9C0) ----------------------------------------------------
void __fastcall sub_1B9C0(PVOID P, ULONG Tag)
{
  void **v4; // rcx

  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 11), 0xDu, (__int64)&unk_28BC8);
      v4 = (void **)off_2A148;
    }
    if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 108) & 4) != 0 && *((_BYTE *)v4 + 105) >= 6u )
    {
      sub_1B6E8((__int64)v4[11], 14i64, (__int64)&unk_28BC8, (int)P);
      v4 = (void **)off_2A148;
    }
  }
  if ( P )
  {
    ExFreePoolWithTag(P, Tag);
    v4 = (void **)off_2A148;
  }
  if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 108) & 2) != 0 && *((_BYTE *)v4 + 105) >= 4u )
    sub_11008((__int64)v4[11], 0xFu, (__int64)&unk_28BC8);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001BAB8) ----------------------------------------------------
_DWORD *__fastcall sub_1BAB8(__int64 a1)
{
  _DWORD *v2; // rbx
  _DWORD *v3; // rax

  v2 = 0i64;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x19u, (__int64)&unk_28BC8);
  if ( (*(_DWORD *)a1 == 2 || *(_DWORD *)a1 == 1)
    && ((++*(_DWORD *)(a1 + 84), (v3 = ExpInterlockedPopEntrySList((PSLIST_HEADER)(a1 + 64))) != 0i64)
     || (++*(_DWORD *)(a1 + 88),
         (v3 = (_DWORD *)(*(__int64 (__fastcall **)(_QWORD, _QWORD, _QWORD))(a1 + 112))(
                           *(unsigned int *)(a1 + 100),
                           *(unsigned int *)(a1 + 108),
                           *(unsigned int *)(a1 + 104))) != 0i64)) )
  {
    *v3 = 0;
  }
  else
  {
    v3 = sub_1B8A4(*(_DWORD *)a1, *(_DWORD *)(a1 + 4) + 7, *(_DWORD *)(a1 + 8));
    if ( !v3 )
      goto LABEL_14;
    *v3 = 1;
  }
  v2 = v3 + 1;
  if ( v3 != (_DWORD *)-4i64 )
    memset(v3 + 1, 0, *(unsigned int *)(a1 + 4));
LABEL_14:
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_2A148 + 11), 0x1Au, (__int64)&unk_28BC8, (int)v2);
  return v2;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001BBBC) ----------------------------------------------------
__int64 __fastcall sub_1BBBC(_QWORD *a1)
{
  __int64 result; // rax

  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    result = sub_11008(*((_QWORD *)off_2A148 + 11), 0x2Fu, (__int64)&unk_28BC8);
  *a1 = 0i64;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    result = sub_11008(*((_QWORD *)off_2A148 + 11), 0x30u, (__int64)&unk_28BC8);
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001BC40) ----------------------------------------------------
void __fastcall sub_1BC40(PKSPIN_LOCK SpinLock, KIRQL *a2)
{
  unsigned __int8 v4; // si

  v4 = KeGetCurrentIrql();
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x31u, (__int64)&unk_28BC8);
  if ( v4 == 2 )
  {
    *a2 = 2;
    KeAcquireSpinLockAtDpcLevel(SpinLock);
  }
  else
  {
    *a2 = KeAcquireSpinLockRaiseToDpc(SpinLock);
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x32u, (__int64)&unk_28BC8);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001BCF8) ----------------------------------------------------
void __fastcall sub_1BCF8(PKSPIN_LOCK SpinLock, KIRQL a2)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x33u, (__int64)&unk_28BC8);
  if ( a2 == 2 )
    KeReleaseSpinLockFromDpcLevel(SpinLock);
  else
    KeReleaseSpinLock(SpinLock, a2);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x34u, (__int64)&unk_28BC8);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001BD9C) ----------------------------------------------------
bool __fastcall sub_1BD9C(struct _KEVENT **a1, char a2)
{
  struct _KEVENT *v4; // rax
  struct _KEVENT *v5; // rdi

  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x35u, (__int64)&unk_28BC8);
  *a1 = 0i64;
  v4 = (struct _KEVENT *)sub_1B8A4(2, 0x18u, 0x6E634556u);
  v5 = v4;
  if ( v4 )
  {
    KeInitializeEvent(v4, (EVENT_TYPE)(a2 == 0), 0);
    *a1 = v5;
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_2A148 + 11), 0x36u, (__int64)&unk_28BC8, v5 != 0i64);
  return v5 != 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001BE84) ----------------------------------------------------
void __fastcall sub_1BE84(PVOID P)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x37u, (__int64)&unk_28BC8);
  KeClearEvent((PRKEVENT)P);
  sub_1B9C0(P, 0x6E634556u);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x38u, (__int64)&unk_28BC8);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001BF1C) ----------------------------------------------------
int __fastcall sub_1BF1C(PRKEVENT Event)
{
  int result; // eax

  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x39u, (__int64)&unk_28BC8);
  result = KeSetEvent(Event, 0, 0);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    result = sub_11008(*((_QWORD *)off_2A148 + 11), 0x3Au, (__int64)&unk_28BC8);
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001BFAC) ----------------------------------------------------
void __fastcall HandleInformation(PVOID StartContext)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x49u, (__int64)&unk_28BC8);
  (*(void (__fastcall **)(_QWORD))StartContext)(*((_QWORD *)StartContext + 1));
  sub_1B9C0(StartContext, 0x6E635448u);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x4Au, (__int64)&unk_28BC8);
  PsTerminateSystemThread(0);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001C048) ----------------------------------------------------
unsigned __int8 __fastcall sub_1C048(PVOID *Object, __int64 a2, __int64 a3)
{
  unsigned __int8 v6; // bl
  _QWORD *v7; // rax
  _QWORD *StartContext; // rsi
  struct _OBJECT_ATTRIBUTES ObjectAttributes; // [rsp+40h] [rbp-48h] BYREF
  void *ThreadHandle; // [rsp+90h] [rbp+8h] BYREF

  v6 = 1;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x4Bu, (__int64)&unk_28BC8);
  v7 = sub_1B8A4(2, 0x10u, 0x6E635448u);
  *Object = 0i64;
  StartContext = v7;
  if ( !v7 )
    goto LABEL_10;
  memset(&ObjectAttributes.RootDirectory, 0, 0x28ui64);
  ThreadHandle = 0i64;
  ObjectAttributes.Length = 48;
  *StartContext = a2;
  StartContext[1] = a3;
  if ( !PsCreateSystemThread(
          &ThreadHandle,
          0x1F03FFu,
          &ObjectAttributes,
          0i64,
          0i64,
          (PKSTART_ROUTINE)HandleInformation,
          StartContext) )
  {
    ObReferenceObjectByHandle(ThreadHandle, 0, 0i64, 0, Object, 0i64);
    ZwClose(ThreadHandle);
  }
  if ( !*Object )
  {
    sub_1B9C0(StartContext, 0x6E635448u);
LABEL_10:
    v6 = 0;
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_2A148 + 11), 0x4Cu, (__int64)&unk_28BC8, v6);
  return v6;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001C1B8) ----------------------------------------------------
__int64 __fastcall sub_1C1B8(PVOID Object)
{
  void **v2; // rcx
  __int64 result; // rax

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
  {
    result = sub_11008(*((_QWORD *)off_2A148 + 11), 0x4Du, (__int64)&unk_28BC8);
    v2 = (void **)off_2A148;
  }
  if ( Object )
  {
    result = ObfDereferenceObject(Object);
    v2 = (void **)off_2A148;
  }
  if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
    result = sub_11008((__int64)v2[11], 0x4Eu, (__int64)&unk_28BC8);
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001C24C) ----------------------------------------------------
__int64 __fastcall sub_1C24C(void ***a1)
{
  void **v1; // r12
  __int64 v2; // rdi
  void *v4; // rax
  ULONG v5; // er14
  void *v6; // rdx
  void **v7; // r10
  unsigned int v8; // ebp
  __int64 v9; // rsi
  __int64 v10; // r13
  __int64 v11; // rsi
  _QWORD **v12; // rcx
  _QWORD *v13; // rbx
  _QWORD *v14; // rax
  char *v15; // rcx
  void (__fastcall *v16)(_QWORD *); // rax
  __int64 result; // rax
  void **v18; // rcx
  PVOID v19[2]; // [rsp+30h] [rbp-48h] BYREF
  __int64 v20; // [rsp+40h] [rbp-38h]
  KIRQL v21; // [rsp+80h] [rbp+8h] BYREF

  v1 = *a1;
  v2 = *((int *)a1 + 2);
  v4 = **a1;
  v5 = 2;
  v21 = 0;
  v19[0] = v4;
  v6 = (void *)*((_QWORD *)v1[3] + 3);
  v20 = 0i64;
  v19[1] = v6;
  v7 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x53u, (__int64)&unk_28BC8);
    v7 = (void **)off_2A148;
  }
  if ( *((_BYTE *)v1 + 12) )
  {
    v5 = 3;
    v20 = *((_QWORD *)v1[3] + 4 * (unsigned int)v2 + 3);
  }
  if ( a1[2] )
  {
    if ( v7 != &off_2A148 && *((char *)v7 + 108) < 0 && *((_BYTE *)v7 + 105) >= 5u )
      sub_1102C((__int64)v7[11], 0x54u, (__int64)&unk_28BC8, v2);
    sub_1BF1C((PRKEVENT)a1[2]);
  }
  while ( 1 )
  {
    result = sub_1CDE0(v5, v19);
    if ( !(_DWORD)result )
      break;
    v8 = 0;
    v9 = 0i64;
    if ( (_DWORD)result == 2 )
    {
      v8 = v2;
      v9 = v2;
    }
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 5u )
      sub_1102C(*((_QWORD *)off_2A148 + 11), 0x56u, (__int64)&unk_28BC8, v2);
    v10 = 32i64 * v8;
    sub_1BC40((PKSPIN_LOCK)((char *)v1[3] + v10), &v21);
    v11 = 32 * v9;
    v12 = (_QWORD **)((char *)v1[3] + v11 + 8);
    v13 = 0i64;
    if ( *v12 != v12 )
    {
      v13 = *v12;
      v14 = (_QWORD *)**v12;
      *v12 = v14;
      v14[1] = v12;
      if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 5u )
        sub_1D110(*((_QWORD *)off_2A148 + 11), 0x57u, (__int64)&unk_28BC8, v2);
      v15 = (char *)v1[3];
      if ( *(char **)&v15[v11 + 8] != &v15[v11 + 8] )
        sub_1BF1C(*(PRKEVENT *)&v15[v11 + 24]);
    }
    sub_1BCF8((PKSPIN_LOCK)((char *)v1[3] + v10), v21);
    if ( v13 )
    {
      if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 5u )
        sub_1D110(*((_QWORD *)off_2A148 + 11), 0x58u, (__int64)&unk_28BC8, v2);
      v16 = (void (__fastcall *)(_QWORD *))v13[3];
      if ( v16 )
        v16(v13 + 5);
      sub_1CB68((__int64)(v13 + 5), 0);
      if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 5u )
        sub_1D110(*((_QWORD *)off_2A148 + 11), 0x59u, (__int64)&unk_28BC8, v2);
    }
  }
  v18 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 5u )
    {
      result = sub_1102C(*((_QWORD *)off_2A148 + 11), 0x55u, (__int64)&unk_28BC8, v2);
      v18 = (void **)off_2A148;
    }
    if ( v18 != &off_2A148 && (*((_BYTE *)v18 + 108) & 2) != 0 && *((_BYTE *)v18 + 105) >= 4u )
      result = sub_11008((__int64)v18[11], 0x5Au, (__int64)&unk_28BC8);
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001C558) ----------------------------------------------------
__int64 __fastcall sub_1C558(unsigned int a1, char a2)
{
  __int64 v3; // r12
  int v4; // esi
  __int64 v5; // r14
  PVOID v6; // rax
  __int64 v7; // rdi
  unsigned int v8; // ebx
  PVOID v9; // rax
  _QWORD *v10; // r11
  __int64 v11; // r13
  unsigned int v12; // ebp
  __int64 v13; // rbx
  _QWORD *v14; // rax
  __int64 v16; // [rsp+30h] [rbp-48h] BYREF
  unsigned int v17; // [rsp+38h] [rbp-40h]
  PVOID P; // [rsp+40h] [rbp-38h] BYREF

  v3 = a1;
  v4 = 0;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x5Bu, (__int64)&unk_28BC8);
  v5 = 32i64;
  v6 = sub_1B8A4(2, 0x20u, 0x6E635450u);
  v7 = (__int64)v6;
  if ( !v6 )
    goto LABEL_24;
  memset(v6, 0, 0x20ui64);
  sub_1BD9C((struct _KEVENT **)v7, 1);
  *(_DWORD *)(v7 + 8) = v3;
  *(_BYTE *)(v7 + 12) = a2;
  *(_QWORD *)(v7 + 16) = sub_1B8A4(2, 8 * (int)v3, 0x6E635450u);
  v8 = a2 ? 32 * (v3 + 1) : 32;
  v9 = sub_1B8A4(2, v8, 0x6E635450u);
  *(_QWORD *)(v7 + 24) = v9;
  if ( *(_QWORD *)(v7 + 16) && v9 )
  {
    v16 = v7;
    sub_1BD9C((struct _KEVENT **)&P, 0);
    memset(*(void **)(v7 + 16), 0, 8 * v3);
    memset(*(void **)(v7 + 24), 0, v8);
    sub_1BBBC(*(_QWORD **)(v7 + 24));
    sub_1BD9C((struct _KEVENT **)(*(_QWORD *)(v7 + 24) + 24i64), 0);
    v10 = (_QWORD *)(*(_QWORD *)(v7 + 24) + 8i64);
    v10[1] = v10;
    *v10 = v10;
    if ( (_DWORD)v3 )
    {
      v11 = 0i64;
      v12 = 1;
      while ( 1 )
      {
        if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 5u )
          sub_1D110(*((_QWORD *)off_2A148 + 11), 0x5Cu, (__int64)&unk_28BC8, v12);
        v17 = v12;
        if ( a2 )
        {
          v13 = 32i64 * v12;
          sub_1BBBC((_QWORD *)(v13 + *(_QWORD *)(v7 + 24)));
          sub_1BD9C((struct _KEVENT **)(v13 + *(_QWORD *)(v7 + 24) + 24), 0);
          v14 = (_QWORD *)(v5 + *(_QWORD *)(v7 + 24) + 8);
          v14[1] = v14;
          *v14 = v14;
        }
        sub_1C048((PVOID *)(*(_QWORD *)(v7 + 16) + 8i64 * (v12 - 1)), (__int64)sub_1C24C, (__int64)&v16);
        if ( !*(_QWORD *)(v11 + *(_QWORD *)(v7 + 16)) )
          break;
        sub_1CD38(P);
        ++v12;
        v5 += 32i64;
        v11 += 8i64;
        if ( v12 - 1 >= (unsigned int)v3 )
          goto LABEL_23;
      }
      v4 = -16777213;
    }
LABEL_23:
    sub_1BE84(P);
  }
  else
  {
LABEL_24:
    v4 = -16777213;
  }
  if ( v4 && v7 )
  {
    sub_1C80C((PVOID)v7);
    v7 = 0i64;
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_2A148 + 11), 0x5Du, (__int64)&unk_28BC8, v7);
  return v7;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001C80C) ----------------------------------------------------
__int64 __fastcall sub_1C80C(PVOID P)
{
  void **v2; // rcx
  unsigned int v3; // eax
  __int64 v4; // rsi
  __int64 v5; // rbp
  __int64 v6; // r12
  void **v7; // rcx
  __int64 v8; // rdx
  _QWORD **v9; // rcx
  _QWORD *v10; // rdi
  _QWORD *v11; // rax
  unsigned int v12; // esi
  __int64 v13; // rdi
  __int64 v14; // rbp
  KIRQL v16; // [rsp+50h] [rbp+8h] BYREF

  v16 = 0;
  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x5Eu, (__int64)&unk_28BC8);
    v2 = (void **)off_2A148;
  }
  if ( *((_BYTE *)P + 12) )
    v3 = *((_DWORD *)P + 2) + 1;
  else
    v3 = 1;
  if ( v3 )
  {
    v4 = 0i64;
    v5 = 0i64;
    v6 = v3;
    do
    {
      sub_1BC40((PKSPIN_LOCK)(v5 + *((_QWORD *)P + 3)), &v16);
      v7 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 5u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 11), 0x5Fu, (__int64)&unk_28BC8);
        v7 = (void **)off_2A148;
      }
      v8 = *((_QWORD *)P + 3);
      if ( *(_QWORD *)(v4 + v8 + 8) != v4 + v8 + 8 )
      {
        do
        {
          v9 = (_QWORD **)(v4 + v8 + 8);
          v10 = *v9;
          v11 = (_QWORD *)**v9;
          *v9 = v11;
          v11[1] = v9;
          if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 5u )
            sub_1102C(*((_QWORD *)off_2A148 + 11), 0x60u, (__int64)&unk_28BC8, (int)v10);
          sub_1CB68((__int64)(v10 + 5), 1);
          v8 = *((_QWORD *)P + 3);
        }
        while ( *(_QWORD *)(v4 + v8 + 8) != v4 + v8 + 8 );
        v7 = (void **)off_2A148;
      }
      if ( v7 != &off_2A148 && *((char *)v7 + 108) < 0 && *((_BYTE *)v7 + 105) >= 5u )
        sub_11008((__int64)v7[11], 0x61u, (__int64)&unk_28BC8);
      sub_1BCF8((PKSPIN_LOCK)(v5 + *((_QWORD *)P + 3)), v16);
      v5 += 32i64;
      v4 += 32i64;
      --v6;
    }
    while ( v6 );
    v2 = (void **)off_2A148;
  }
  if ( *(_QWORD *)P )
  {
    if ( v2 != &off_2A148 && *((char *)v2 + 108) < 0 && *((_BYTE *)v2 + 105) >= 5u )
      sub_11008((__int64)v2[11], 0x62u, (__int64)&unk_28BC8);
    sub_1BF1C(*(PRKEVENT *)P);
    v2 = (void **)off_2A148;
  }
  if ( v2 != &off_2A148 && *((char *)v2 + 108) < 0 && *((_BYTE *)v2 + 105) >= 5u )
  {
    sub_1102C((__int64)v2[11], 0x63u, (__int64)&unk_28BC8, *((_DWORD *)P + 2));
    v2 = (void **)off_2A148;
  }
  v12 = 0;
  if ( *((_DWORD *)P + 2) )
  {
    v13 = 0i64;
    v14 = 32i64;
    do
    {
      if ( *(_QWORD *)(v13 + *((_QWORD *)P + 2)) )
      {
        if ( v2 != &off_2A148 && *((char *)v2 + 108) < 0 && *((_BYTE *)v2 + 105) >= 5u )
          sub_1102C((__int64)v2[11], 0x64u, (__int64)&unk_28BC8, v12);
        sub_1CD38(*(PVOID *)(v13 + *((_QWORD *)P + 2)));
        if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 108) < 0 && *((_BYTE *)off_2A148 + 105) >= 5u )
          sub_1102C(*((_QWORD *)off_2A148 + 11), 0x65u, (__int64)&unk_28BC8, v12);
        sub_1C1B8(*(PVOID *)(v13 + *((_QWORD *)P + 2)));
        *(_QWORD *)(v13 + *((_QWORD *)P + 2)) = 0i64;
        if ( *((_BYTE *)P + 12) )
          sub_1BE84(*(PVOID *)(*((_QWORD *)P + 3) + v14 + 24));
        v2 = (void **)off_2A148;
      }
      ++v12;
      v14 += 32i64;
      v13 += 8i64;
    }
    while ( v12 < *((_DWORD *)P + 2) );
  }
  if ( v2 != &off_2A148 && *((char *)v2 + 108) < 0 && *((_BYTE *)v2 + 105) >= 5u )
    sub_11008((__int64)v2[11], 0x66u, (__int64)&unk_28BC8);
  sub_1BE84(*(PVOID *)(*((_QWORD *)P + 3) + 24i64));
  sub_1BE84(*(PVOID *)P);
  sub_1B9C0(*((PVOID *)P + 2), 0x6E635450u);
  sub_1B9C0(*((PVOID *)P + 3), 0x6E635450u);
  sub_1B9C0(P, 0x6E635450u);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x67u, (__int64)&unk_28BC8);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001CB68) ----------------------------------------------------
void __fastcall sub_1CB68(__int64 a1, char a2)
{
  void **v4; // rcx
  void (__fastcall *v5)(__int64); // rax

  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x6Bu, (__int64)&unk_28BC8);
    v4 = (void **)off_2A148;
  }
  if ( a1 )
  {
    if ( a2 )
    {
      v5 = *(void (__fastcall **)(__int64))(a1 - 8);
      if ( v5 )
        v5(a1);
    }
    sub_1B9C0((PVOID)(a1 - 40), 0x6E635749u);
    v4 = (void **)off_2A148;
  }
  if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 108) & 2) != 0 && *((_BYTE *)v4 + 105) >= 4u )
    sub_11008((__int64)v4[11], 0x6Cu, (__int64)&unk_28BC8);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001CC2C) ----------------------------------------------------
void __fastcall sub_1CC2C(__int64 a1, unsigned int a2)
{
  void **v4; // rcx
  __int64 *v5; // rbp
  __int64 v6; // rdi
  __int64 v7; // rbx
  __int64 v8; // r11
  __int64 v9; // rcx
  __int64 **v10; // rax
  KIRQL v11; // [rsp+40h] [rbp+8h] BYREF

  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x6Du, (__int64)&unk_28BC8);
    v4 = (void **)off_2A148;
  }
  if ( a1 )
  {
    v5 = (__int64 *)(a1 - 40);
    v11 = 0;
    v6 = *(_QWORD *)(a1 - 40 + 16);
    if ( a2 > *(_DWORD *)(v6 + 8) || !*(_BYTE *)(v6 + 12) )
      a2 = 0;
    v7 = 32i64 * a2;
    sub_1BC40((PKSPIN_LOCK)(v7 + *(_QWORD *)(v6 + 24)), &v11);
    v8 = *(_QWORD *)(v6 + 24);
    v9 = v7 + v8 + 8;
    v10 = *(__int64 ***)(v7 + v8 + 16);
    *v5 = v9;
    v5[1] = (__int64)v10;
    *v10 = v5;
    *(_QWORD *)(v9 + 8) = v5;
    sub_1BF1C(*(PRKEVENT *)(v7 + *(_QWORD *)(v6 + 24) + 24));
    sub_1BCF8((PKSPIN_LOCK)(v7 + *(_QWORD *)(v6 + 24)), v11);
    v4 = (void **)off_2A148;
  }
  if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 108) & 2) != 0 && *((_BYTE *)v4 + 105) >= 4u )
    sub_11008((__int64)v4[11], 0x6Eu, (__int64)&unk_28BC8);
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001CD38) ----------------------------------------------------
__int64 __fastcall sub_1CD38(PVOID Object)
{
  int v2; // eax
  unsigned int v3; // ebx

  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x6Fu, (__int64)&unk_28BC8);
  v2 = KeWaitForSingleObject(Object, Executive, 0, 0, 0i64);
  v3 = v2;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_2A148 + 11), 0x70u, (__int64)&unk_28BC8, v2);
  return v3;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001CDE0) ----------------------------------------------------
__int64 __fastcall sub_1CDE0(ULONG Count, PVOID Object[])
{
  struct _KWAIT_BLOCK *WaitBlockArray; // rdi
  unsigned int v6; // ebx

  WaitBlockArray = 0i64;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 11), 0x71u, (__int64)&unk_28BC8);
  if ( Count > 3 )
  {
    WaitBlockArray = (struct _KWAIT_BLOCK *)sub_1B8A4(2, 48 * Count, 0x6E635742u);
    if ( !WaitBlockArray )
      return 4278190083i64;
  }
  v6 = KeWaitForMultipleObjects(Count, Object, WaitAny, Executive, 0, 0, 0i64, WaitBlockArray);
  if ( WaitBlockArray )
    sub_1B9C0(WaitBlockArray, 0x6E635742u);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 2) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_2A148 + 11), 0x72u, (__int64)&unk_28BC8, v6);
  return v6;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001CEEC) ----------------------------------------------------
void __fastcall DeferredRoutine(_KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)
{
  if ( DeferredContext )
    ((void (__fastcall *)(_KDPC *, PVOID, PVOID, PVOID))DeferredContext)(
      Dpc,
      DeferredContext,
      SystemArgument1,
      SystemArgument2);
  KeSetTimer(&Timer, (LARGE_INTEGER)qword_2CE08, &::Dpc);
}
// 2CE08: using guessed type __int64 qword_2CE08;

//----- (000000000001CF20) ----------------------------------------------------
bool __fastcall sub_1CF20(__int64 a1)
{
  bool v3; // bl

  if ( !a1 )
    return 0;
  v3 = sub_1B008((struct _KEVENT **)(a1 + 56), 1);
  sub_1B21C(a1);
  *(_DWORD *)(a1 + 64) = 0;
  *(_DWORD *)(a1 + 68) = 0;
  *(_BYTE *)(a1 + 72) = 0;
  return v3;
}

//----- (000000000001CF84) ----------------------------------------------------
char __fastcall sub_1CF84(PFAST_MUTEX FastMutex)
{
  char result; // al

  result = 0;
  if ( FastMutex && !LODWORD(FastMutex[1].Owner) && !LOBYTE(FastMutex[1].Contention) && !HIDWORD(FastMutex[1].Owner) )
  {
    sub_1B2FC(FastMutex);
    sub_1B0E8(*(PRKEVENT *)&FastMutex[1].Count);
    LOBYTE(FastMutex[1].Contention) = 1;
    sub_1B3C8(FastMutex);
    result = 1;
  }
  return result;
}

//----- (000000000001CFE4) ----------------------------------------------------
char __fastcall sub_1CFE4(PFAST_MUTEX FastMutex)
{
  if ( !FastMutex )
    return 0;
  if ( LOBYTE(FastMutex[1].Contention) )
  {
    sub_1B2FC(FastMutex);
    LOBYTE(FastMutex[1].Contention) = 0;
    sub_1B3C8(FastMutex);
    sub_1B67C(*(PVOID *)&FastMutex[1].Count);
  }
  return 1;
}

//----- (000000000001D044) ----------------------------------------------------
char __fastcall sub_1D044(PFAST_MUTEX FastMutex)
{
  char v1; // di
  struct _KEVENT *v4; // rcx

  v1 = 0;
  if ( !FastMutex )
    return 0;
  sub_1B2FC(FastMutex);
  if ( LOBYTE(FastMutex[1].Contention) )
  {
    v4 = *(struct _KEVENT **)&FastMutex[1].Count;
    ++LODWORD(FastMutex[1].Owner);
    sub_1B150(v4);
    v1 = 1;
  }
  sub_1B3C8(FastMutex);
  return v1;
}

//----- (000000000001D0AC) ----------------------------------------------------
char __fastcall sub_1D0AC(PFAST_MUTEX FastMutex)
{
  if ( !FastMutex || !*(_QWORD *)&FastMutex[1].Count || !LODWORD(FastMutex[1].Owner) )
    return 0;
  sub_1B2FC(FastMutex);
  if ( LODWORD(FastMutex[1].Owner)-- == 1 )
    sub_1B0E8(*(PRKEVENT *)&FastMutex[1].Count);
  sub_1B3C8(FastMutex);
  return 1;
}

//----- (000000000001D110) ----------------------------------------------------
__int64 __fastcall sub_1D110(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_2A1B8(a1, 43i64, a3, a2, &v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D158) ----------------------------------------------------
__int64 __fastcall sub_1D158(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, __int64 a5, int a6)
{
  int v7; // [rsp+88h] [rbp+20h] BYREF

  v7 = a4;
  a6 = 0;
  return qword_2A1B8(a1, 43i64, &unk_28BA8, a2, &v7);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D1B8) ----------------------------------------------------
__int64 __fastcall sub_1D1B8(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6, int a7)
{
  int v8; // [rsp+98h] [rbp+20h] BYREF

  v8 = a4;
  a7 = 0;
  return qword_2A1B8(a1, 43i64, &unk_28BA8, 125i64, &v8);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D228) ----------------------------------------------------
__int64 __fastcall sub_1D228(__int64 a1, __int64 a2, __int64 a3, int a4, int a5)
{
  int v6; // [rsp+78h] [rbp+20h] BYREF

  v6 = a4;
  a5 = 0;
  return qword_2A1B8(a1, 43i64, &unk_28BA8, 108i64, &v6);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D280) ----------------------------------------------------
__int64 __fastcall sub_1D280(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_2A1B8(a1, 43i64, &unk_28B00, a2, &v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D2D4) ----------------------------------------------------
__int64 __fastcall sub_1D2D4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_2A1B8(a1, 43i64, &unk_28BA8, a2, &v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D330) ----------------------------------------------------
__int64 __fastcall sub_1D330(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_2A1B8(a1, 43i64, &unk_28BA8, 115i64, &v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D3A0) ----------------------------------------------------
__int64 sub_1D3A0(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_2A1B8(a1, 43i64, a3, a2, (__int64 *)va);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D3EC) ----------------------------------------------------
__int64 __fastcall sub_1D3EC(__int64 a1, __int64 a2, _QWORD *a3)
{
  bool v5; // r12
  void **v6; // rcx
  unsigned __int16 v7; // dx
  char *v8; // rbx
  unsigned int v9; // edi
  int v10; // er9
  unsigned int v11; // eax
  _WORD *v12; // rdx
  char *v13; // rax
  PVOID v14; // rax
  unsigned int v15; // edx
  __int64 v16; // r8
  _QWORD *v17; // rax
  char *v18; // rcx
  unsigned int *v19; // rbx
  unsigned int v20; // eax
  void *v21; // rcx
  void *v22; // rcx

  v5 = 0;
  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xAu, (__int64)&unk_28BA8);
    v6 = (void **)off_2A148;
  }
  if ( !a1 )
  {
    if ( v6 == &off_2A148 || !_bittest((const signed __int32 *)v6 + 43, 8u) || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_12;
    v7 = 11;
    goto LABEL_10;
  }
  v10 = *(_DWORD *)a1;
  if ( (*(_DWORD *)a1 & 0xFF000000) != 0x2000000 || (v10 & 0xFFFF00) == 0 || (_BYTE)v10 )
  {
    if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 43, 8u) && *((_BYTE *)v6 + 169) >= 2u )
    {
      sub_1102C((__int64)v6[19], 0xCu, (__int64)&unk_28BA8, v10);
      v6 = (void **)off_2A148;
    }
    v9 = 4;
    goto LABEL_57;
  }
  v11 = 0;
  v12 = (_WORD *)(a1 + 4);
  do
  {
    if ( !*v12 )
      break;
    ++v11;
    ++v12;
  }
  while ( v11 < 0x40 );
  if ( v11 < 0x40 )
  {
    if ( !a3 || !*a3 )
    {
      if ( v6 == &off_2A148 || !_bittest((const signed __int32 *)v6 + 43, 8u) || *((_BYTE *)v6 + 169) < 2u )
        goto LABEL_12;
      sub_12954((__int64)v6[19], 0xEu, (__int64)&unk_28BA8, a3);
      goto LABEL_11;
    }
    v13 = (char *)sub_1A4F8(2, 0x19Cu, 0x66634E4Eu);
    v8 = v13;
    P = v13;
    if ( !v13 )
    {
      v6 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148
        && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
        && *((_BYTE *)off_2A148 + 169) )
      {
        sub_1102C(*((_QWORD *)off_2A148 + 19), 0xFu, (__int64)&unk_28BA8, 60);
        v6 = (void **)off_2A148;
        v8 = (char *)P;
      }
      v9 = 3;
      goto LABEL_64;
    }
    memset(v13, 0, 0x19Cui64);
    v5 = sub_1CF20((__int64)(v8 + 128));
    if ( !v5 )
    {
      v6 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148
        && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
        && *((_BYTE *)off_2A148 + 169) )
      {
        sub_11008(*((_QWORD *)off_2A148 + 19), 0x10u, (__int64)&unk_28BA8);
        v6 = (void **)off_2A148;
      }
      v9 = 9;
LABEL_58:
      v8 = (char *)P;
LABEL_59:
      if ( v5 && v8 != (char *)-128i64 )
      {
        v21 = (void *)*((_QWORD *)v8 + 23);
        *((_DWORD *)v8 + 49) = 0;
        if ( v21 )
        {
          sub_1B080(v21);
          v8 = (char *)P;
        }
        v6 = (void **)off_2A148;
      }
      goto LABEL_64;
    }
    v14 = sub_1A4F8(1, 4 * (unsigned int)*(unsigned __int8 *)(a1 + 136), 0x66634E4Eu);
    v8 = (char *)P;
    *((_QWORD *)P + 26) = v14;
    if ( !v14 )
    {
      v6 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148
        && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
        && *((_BYTE *)off_2A148 + 169) )
      {
        sub_1102C(*((_QWORD *)off_2A148 + 19), 0x11u, (__int64)&unk_28BA8, 4 * *(unsigned __int8 *)(a1 + 136));
        v6 = (void **)off_2A148;
        v8 = (char *)P;
      }
      v9 = 3;
      goto LABEL_59;
    }
    v15 = 0;
    if ( *(_BYTE *)(a1 + 136) )
    {
      v16 = 0i64;
      do
      {
        *(_DWORD *)(v16 + *((_QWORD *)v8 + 26)) = *(_DWORD *)a1 | ++v15;
        v16 += 4i64;
      }
      while ( v15 < *(unsigned __int8 *)(a1 + 136) );
    }
    *(_DWORD *)v8 = 2;
    *((_DWORD *)v8 + 1) = 60;
    v8[8] = 0;
    *((_DWORD *)v8 + 4) = *(_DWORD *)a1;
    v8[20] = *(_BYTE *)(a1 + 136);
    *((_QWORD *)v8 + 3) = *((_QWORD *)v8 + 26);
    *((_QWORD *)v8 + 4) = sub_1E17C;
    sub_1ABE4((PERESOURCE)(v8 + 216));
    v17 = (char *)P + 56;
    v18 = (char *)P + 72;
    *((_QWORD *)P + 8) = (char *)P + 56;
    *v17 = v17;
    sub_1B21C((__int64)v18);
    v19 = (unsigned int *)P;
    memmove((char *)P + 320, a3, 0x20ui64);
    v20 = sub_1FBB0((__int16 *)(a1 + 4), *(_DWORD *)(a1 + 132), v19 + 4);
    v6 = (void **)off_2A148;
    v9 = v20;
LABEL_57:
    if ( !v9 )
      goto LABEL_68;
    goto LABEL_58;
  }
  if ( v6 == &off_2A148 || !_bittest((const signed __int32 *)v6 + 43, 8u) || *((_BYTE *)v6 + 169) < 2u )
    goto LABEL_12;
  v7 = 13;
LABEL_10:
  sub_11008((__int64)v6[19], v7, (__int64)&unk_28BA8);
LABEL_11:
  v6 = (void **)off_2A148;
LABEL_12:
  v8 = (char *)P;
  v9 = 4;
LABEL_64:
  if ( v8 )
  {
    v22 = (void *)*((_QWORD *)v8 + 26);
    if ( v22 )
    {
      sub_1A57C(v22, 0x66634E4Eu);
      v8 = (char *)P;
    }
    sub_1A57C(v8, 0x66634E4Eu);
    v6 = (void **)off_2A148;
    P = 0i64;
  }
LABEL_68:
  if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 43, 8u) && *((_BYTE *)v6 + 169) >= 5u )
    sub_1102C((__int64)v6[19], 0x12u, (__int64)&unk_28BA8, v9);
  return v9;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001D8E0) ----------------------------------------------------
__int64 sub_1D8E0()
{
  char v0; // di
  void **v1; // rcx
  PVOID v2; // rdx
  unsigned int v3; // ebx
  void *v4; // rcx
  int v5; // eax
  _QWORD *v6; // rax
  unsigned int v7; // eax
  int v8; // eax

  v0 = 0;
  v1 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x13u, (__int64)&unk_28BA8);
    v1 = (void **)off_2A148;
  }
  v2 = P;
  if ( !P )
  {
    if ( v1 != &off_2A148 && _bittest((const signed __int32 *)v1 + 43, 8u) && *((_BYTE *)v1 + 169) >= 2u )
    {
      sub_11008((__int64)v1[19], 0x14u, (__int64)&unk_28BA8);
      v1 = (void **)off_2A148;
    }
    v3 = 16;
    goto LABEL_59;
  }
  if ( *((_QWORD *)P + 5) )
  {
    if ( v1 != &off_2A148 && _bittest((const signed __int32 *)v1 + 43, 8u) && *((_BYTE *)v1 + 169) >= 2u )
    {
      sub_11008((__int64)v1[19], 0x15u, (__int64)&unk_28BA8);
      v1 = (void **)off_2A148;
    }
    v3 = 6;
    goto LABEL_59;
  }
  v4 = (void *)*((_QWORD *)P + 26);
  if ( v4 )
  {
    sub_1A57C(v4, 0x66634E4Eu);
    v2 = P;
    *((_QWORD *)P + 26) = 0i64;
  }
  v5 = sub_1FFE0(6u, (__int64)v2 + 40);
  v3 = v5;
  if ( v5 )
  {
    v1 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
      && *((_BYTE *)off_2A148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 19), 0x16u, (__int64)&unk_28BA8, v5);
      v1 = (void **)off_2A148;
    }
    goto LABEL_55;
  }
  v6 = (_QWORD *)*((_QWORD *)P + 5);
  if ( !v6 || !*v6 || !v6[1] || !v6[2] || !v6[3] || !v6[4] || !v6[5] || !v6[6] || !v6[7] || !v6[8] || !v6[9] || !v6[10] )
  {
    v3 = 2;
    goto LABEL_58;
  }
  v7 = ((__int64 (__fastcall *)(_QWORD, char *))*v6)(*((unsigned int *)P + 4), (char *)P + 48);
  if ( v7 < 0x700 )
  {
    v0 = sub_1CF84((PFAST_MUTEX)((char *)P + 128));
    if ( !v0 )
    {
      v1 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148
        && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
        && *((_BYTE *)off_2A148 + 169) >= 2u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 19), 0x18u, (__int64)&unk_28BA8);
        v1 = (void **)off_2A148;
      }
      v3 = 9;
LABEL_56:
      if ( !v0 )
        goto LABEL_59;
      sub_1CFE4((PFAST_MUTEX)((char *)P + 128));
LABEL_58:
      v1 = (void **)off_2A148;
      goto LABEL_59;
    }
    v8 = sub_1E734();
    v3 = v8;
    if ( !v8 )
      goto LABEL_58;
    v1 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
      && *((_BYTE *)off_2A148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 19), 0x19u, (__int64)&unk_28BA8, v8);
      v1 = (void **)off_2A148;
    }
    v3 = 0;
LABEL_55:
    if ( !v3 )
      goto LABEL_59;
    goto LABEL_56;
  }
  v1 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 2u )
  {
    sub_1102C(*((_QWORD *)off_2A148 + 19), 0x17u, (__int64)&unk_28BA8, v7);
    v1 = (void **)off_2A148;
  }
  v3 = 8;
LABEL_59:
  if ( v1 != &off_2A148 && _bittest((const signed __int32 *)v1 + 43, 8u) && *((_BYTE *)v1 + 169) >= 5u )
    sub_1102C((__int64)v1[19], 0x1Au, (__int64)&unk_28BA8, v3);
  return v3;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001DC28) ----------------------------------------------------
__int64 (**sub_1DC28())(void)
{
  void **v0; // rcx
  __int64 (**result)(void); // rax
  unsigned __int16 v2; // dx

  v0 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x1Bu, (__int64)&unk_28BA8);
    v0 = (void **)off_2A148;
  }
  result = (__int64 (**)(void))P;
  if ( P )
  {
    sub_1CFE4((PFAST_MUTEX)((char *)P + 128));
    result = (__int64 (**)(void))*((_QWORD *)P + 5);
    if ( result && *((_QWORD *)P + 6) )
    {
      result = (__int64 (**)(void))result[1]();
      *((_QWORD *)P + 6) = 0i64;
    }
    v0 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
      && *((_BYTE *)off_2A148 + 169) >= 5u )
    {
      v2 = 30;
      return (__int64 (**)(void))sub_11008((__int64)v0[19], v2, (__int64)&unk_28BA8);
    }
  }
  else if ( v0 != &off_2A148 )
  {
    if ( _bittest((const signed __int32 *)v0 + 43, 8u) && *((_BYTE *)v0 + 169) >= 2u )
    {
      result = (__int64 (**)(void))sub_11008((__int64)v0[19], (unsigned __int16)P + 28, (__int64)&unk_28BA8);
      v0 = (void **)off_2A148;
    }
    if ( v0 != &off_2A148 && _bittest((const signed __int32 *)v0 + 43, 8u) && *((_BYTE *)v0 + 169) >= 5u )
    {
      v2 = 29;
      return (__int64 (**)(void))sub_11008((__int64)v0[19], v2, (__int64)&unk_28BA8);
    }
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001DD54) ----------------------------------------------------
void sub_1DD54()
{
  void **v0; // rcx
  unsigned __int16 v1; // dx
  char *v2; // rcx
  PVOID *v3; // rax
  _QWORD *v4; // rcx
  _QWORD *v5; // rax
  _QWORD **v6; // rdx

  v0 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x1Fu, (__int64)&unk_28BA8);
    v0 = (void **)off_2A148;
  }
  if ( P )
  {
    sub_20130();
    v2 = (char *)P;
    v3 = (PVOID *)((char *)P + 128);
    if ( P != (PVOID)-128i64 )
    {
      *((_DWORD *)P + 49) = 0;
      if ( v3[7] )
      {
        sub_1B080(v3[7]);
        v2 = (char *)P;
      }
    }
    if ( !*((_QWORD *)v2 + 26) )
      goto LABEL_21;
    v4 = (_QWORD *)*((_QWORD *)v2 + 26);
    while ( 1 )
    {
      sub_1A57C(v4, 0x66634E4Eu);
      v2 = (char *)P;
LABEL_21:
      v6 = (_QWORD **)(v2 + 56);
      if ( *v6 == v6 )
        break;
      v5 = (_QWORD *)**v6;
      v4 = *v6 - 5;
      *v6 = v5;
      v5[1] = v6;
    }
    sub_1ACB8((PERESOURCE)(v2 + 216));
    sub_1A57C(P, 0x66634E4Eu);
    P = 0i64;
    v0 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
      && *((_BYTE *)off_2A148 + 169) >= 5u )
    {
      v1 = 34;
      goto LABEL_26;
    }
  }
  else if ( v0 != &off_2A148 )
  {
    if ( _bittest((const signed __int32 *)v0 + 43, 8u) && *((_BYTE *)v0 + 169) >= 2u )
    {
      sub_11008((__int64)v0[19], 0x20u, (__int64)&unk_28BA8);
      v0 = (void **)off_2A148;
    }
    if ( v0 != &off_2A148 && _bittest((const signed __int32 *)v0 + 43, 8u) && *((_BYTE *)v0 + 169) >= 5u )
    {
      v1 = 33;
LABEL_26:
      sub_11008((__int64)v0[19], v1, (__int64)&unk_28BA8);
      return;
    }
  }
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001DF10) ----------------------------------------------------
__int64 __fastcall sub_1DF10(unsigned int a1)
{
  void **v2; // r10
  unsigned __int16 v3; // dx
  unsigned __int8 (__fastcall *v5)(_QWORD, unsigned int *, size_t *, char *); // r11
  __int64 v6; // rcx
  unsigned __int16 v7; // dx
  char *v8; // rbx
  char v9[40]; // [rsp+30h] [rbp-28h] BYREF
  unsigned int Dst; // [rsp+68h] [rbp+10h] BYREF
  size_t MaxCount; // [rsp+70h] [rbp+18h] BYREF
  unsigned int v12; // [rsp+78h] [rbp+20h] BYREF

  Dst = 0;
  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_1102C(*((_QWORD *)off_2A148 + 19), 0x2Cu, (__int64)&unk_28BA8, a1);
    v2 = (void **)off_2A148;
  }
  if ( !P )
  {
    if ( v2 == &off_2A148 || !_bittest((const signed __int32 *)v2 + 43, 8u) || *((_BYTE *)v2 + 169) < 2u )
      return 0i64;
    v3 = (_WORD)P + 45;
    goto LABEL_10;
  }
  v5 = (unsigned __int8 (__fastcall *)(_QWORD, unsigned int *, size_t *, char *))*((_QWORD *)P + 40);
  if ( !v5 )
  {
    if ( v2 == &off_2A148 || !_bittest((const signed __int32 *)v2 + 43, 8u) || *((_BYTE *)v2 + 169) < 2u )
      return 0i64;
    v3 = 46;
LABEL_10:
    sub_11008((__int64)v2[19], v3, (__int64)&unk_28BA8);
    return 0i64;
  }
  if ( (unsigned __int8)(a1 - 1) >= (unsigned int)*((unsigned __int8 *)P + 20) )
  {
    if ( v2 == &off_2A148 || !_bittest((const signed __int32 *)v2 + 43, 8u) || *((_BYTE *)v2 + 169) < 2u )
      return 0i64;
    v6 = (__int64)v2[19];
    v7 = 47;
    goto LABEL_22;
  }
  if ( !v5(a1, &v12, &MaxCount, v9) )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
      && *((_BYTE *)off_2A148 + 169) >= 2u )
    {
      sub_1D110(*((_QWORD *)off_2A148 + 19), 0x30u, (__int64)&unk_28BA8, a1);
    }
    return 0i64;
  }
  if ( (unsigned int)MaxCount > 4 )
  {
    if ( off_2A148 == &off_2A148
      || !_bittest((const signed __int32 *)off_2A148 + 43, 8u)
      || *((_BYTE *)off_2A148 + 169) < 2u )
    {
      return 0i64;
    }
    v6 = *((_QWORD *)off_2A148 + 19);
    v7 = 49;
LABEL_22:
    sub_1D2D4(v6, v7, (__int64)&unk_28BA8, a1);
    return 0i64;
  }
  KeEnterCriticalRegion();
  sub_1AE64((PERESOURCE)((char *)P + 216));
  v8 = (char *)P;
  memmove(&Dst, (char *)P + v12 + 352, (unsigned int)MaxCount);
  sub_1AF3C((PERESOURCE)(v8 + 216));
  KeLeaveCriticalRegion();
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_1102C(*((_QWORD *)off_2A148 + 19), 0x32u, (__int64)&unk_28BA8, Dst);
  }
  return Dst;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001E17C) ----------------------------------------------------
__int64 __fastcall sub_1E17C(__int64 a1)
{
  char *v1; // r8
  unsigned int v2; // ebx
  __int64 (__fastcall **v4)(_QWORD, _QWORD); // r13
  __int64 v5; // r14
  int v6; // ebp
  void **v7; // rcx
  _DWORD *v8; // rdi
  unsigned __int16 v10; // dx
  unsigned __int16 v11; // dx
  int v12; // edx
  int *v13; // rdi
  int *v14; // rbp
  int v15; // edi
  int *v16; // rbp
  int v17; // edi

  v1 = (char *)P;
  v2 = 0;
  v4 = (__int64 (__fastcall **)(_QWORD, _QWORD))*((_QWORD *)P + 5);
  v5 = *((_QWORD *)P + 6);
  v6 = 0;
  v7 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x5Bu, (__int64)&unk_28BA8);
    v1 = (char *)P;
    v7 = (void **)off_2A148;
  }
  if ( !a1 )
    goto LABEL_6;
  v8 = *(_DWORD **)(a1 + 56);
  if ( !v8 )
    goto LABEL_6;
  switch ( *v8 )
  {
    case 0:
      v16 = v8 + 1;
      if ( v7 != &off_2A148 && _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 4u )
      {
        sub_11008((__int64)v7[19], 0x5Cu, (__int64)&unk_28BA8);
        v1 = (char *)P;
        v7 = (void **)off_2A148;
      }
      if ( v8 != (_DWORD *)-4i64 )
      {
        if ( !sub_1D044((PFAST_MUTEX)(v1 + 128)) )
          goto LABEL_26;
        v2 = sub_1F7BC(*v16);
        if ( v2 )
          goto LABEL_65;
        v17 = v4[9](v5, (unsigned int)*v16);
        if ( off_2A148 != &off_2A148
          && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
          && *((_BYTE *)off_2A148 + 169) >= 4u )
        {
          sub_1D110(*((_QWORD *)off_2A148 + 19), v2 + 93, (__int64)&unk_28BA8, *v16);
        }
        sub_1D0AC((PFAST_MUTEX)((char *)P + 128));
        if ( !v17 )
          goto LABEL_26;
        v2 = 8;
        v7 = (void **)off_2A148;
        if ( off_2A148 != &off_2A148 )
        {
          if ( _bittest((const signed __int32 *)off_2A148 + 43, 8u) && *((_BYTE *)off_2A148 + 169) >= 2u )
          {
            v10 = 94;
            goto LABEL_91;
          }
          goto LABEL_93;
        }
        goto LABEL_53;
      }
LABEL_6:
      v2 = 2;
      goto LABEL_93;
    case 1:
      v14 = v8 + 1;
      if ( v7 != &off_2A148 && _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 4u )
      {
        sub_11008((__int64)v7[19], 0x5Fu, (__int64)&unk_28BA8);
        v1 = (char *)P;
        v7 = (void **)off_2A148;
      }
      if ( v8 != (_DWORD *)-4i64 )
      {
        if ( !sub_1D044((PFAST_MUTEX)(v1 + 128)) )
          goto LABEL_26;
        v2 = sub_1F918(*v14);
        if ( v2 )
        {
LABEL_65:
          sub_1D0AC((PFAST_MUTEX)((char *)P + 128));
LABEL_92:
          v7 = (void **)off_2A148;
          goto LABEL_93;
        }
        v15 = v4[10](v5, (unsigned int)*v14);
        if ( off_2A148 != &off_2A148
          && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
          && *((_BYTE *)off_2A148 + 169) >= 4u )
        {
          sub_1D110(*((_QWORD *)off_2A148 + 19), 0x60u, (__int64)&unk_28BA8, *v14);
        }
        sub_1D0AC((PFAST_MUTEX)((char *)P + 128));
        if ( !v15 )
          goto LABEL_26;
        v2 = 8;
        v7 = (void **)off_2A148;
        if ( off_2A148 != &off_2A148 )
        {
          if ( _bittest((const signed __int32 *)off_2A148 + 43, 8u) && *((_BYTE *)off_2A148 + 169) >= 2u )
          {
            v10 = 97;
            goto LABEL_91;
          }
LABEL_93:
          if ( v7 != &off_2A148 && _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 2u )
            sub_11008((__int64)v7[19], 0x68u, (__int64)&unk_28BA8);
          if ( v2 )
            goto LABEL_53;
          goto LABEL_98;
        }
LABEL_53:
        v12 = v2;
        goto LABEL_27;
      }
      goto LABEL_6;
    case 2:
      if ( sub_1D044((PFAST_MUTEX)(v1 + 128)) )
      {
        v2 = sub_1EE00(v8[1], v8[2], v8[3], v8 + 4);
        sub_1D0AC((PFAST_MUTEX)((char *)P + 128));
      }
      goto LABEL_53;
    case 3:
      if ( sub_1D044((PFAST_MUTEX)(v1 + 128)) )
      {
        v2 = sub_1F3F8((unsigned int)v8[1], v8[2], a1);
        sub_1D0AC((PFAST_MUTEX)((char *)P + 128));
      }
      goto LABEL_28;
    case 4:
      v13 = v8 + 1;
      if ( v7 != &off_2A148 && _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 4u )
      {
        sub_11008((__int64)v7[19], 0x62u, (__int64)&unk_28BA8);
        v1 = (char *)P;
      }
      if ( sub_1D044((PFAST_MUTEX)(v1 + 128)) )
      {
        if ( v13 )
        {
          v6 = v4[8](v5, (unsigned int)*v13);
          if ( off_2A148 != &off_2A148
            && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
            && *((_BYTE *)off_2A148 + 169) >= 4u )
          {
            sub_1D110(*((_QWORD *)off_2A148 + 19), 0x63u, (__int64)&unk_28BA8, *v13);
          }
        }
        sub_1D0AC((PFAST_MUTEX)((char *)P + 128));
        if ( !v13 || v6 )
        {
          v2 = 8;
          if ( off_2A148 != &off_2A148
            && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
            && *((_BYTE *)off_2A148 + 169) >= 2u )
          {
            sub_11008(*((_QWORD *)off_2A148 + 19), 0x64u, (__int64)&unk_28BA8);
          }
        }
      }
      goto LABEL_53;
    case 5:
      if ( v7 == &off_2A148 || !_bittest((const signed __int32 *)v7 + 43, 8u) || *((_BYTE *)v7 + 169) < 4u )
        goto LABEL_26;
      v11 = 101;
      goto LABEL_25;
  }
  if ( *v8 != 6 )
  {
    if ( *((_QWORD *)v1 + 43) )
      return (*((__int64 (__fastcall **)(__int64, _QWORD, char *, void *))v1 + 43))(
               a1,
               (unsigned int)(*v8 - 5),
               v1,
               &unk_28BA8);
    if ( v7 == &off_2A148 )
    {
LABEL_98:
      v2 = 17;
      goto LABEL_53;
    }
    if ( _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 3u )
    {
      v10 = 103;
LABEL_91:
      sub_11008((__int64)v7[19], v10, (__int64)&unk_28BA8);
      goto LABEL_92;
    }
    goto LABEL_93;
  }
  if ( v7 != &off_2A148 && _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 4u )
  {
    v11 = 102;
LABEL_25:
    sub_11008((__int64)v7[19], v11, (__int64)&unk_28BA8);
  }
LABEL_26:
  v12 = 0;
LABEL_27:
  sub_21950(a1, v12, 0, 0i64);
LABEL_28:
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_1102C(*((_QWORD *)off_2A148 + 19), 0x69u, (__int64)&unk_28BA8, v2);
  }
  return v2;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000001E734) ----------------------------------------------------
__int64 sub_1E734()
{
  __int64 v0; // rsi
  __int64 v1; // r15
  unsigned int v2; // er13
  int v3; // eax
  void *v4; // rbp
  void **v5; // r14
  unsigned int v6; // er12
  void (__fastcall *v7)(char *); // rax
  int v8; // eax
  void **v9; // r10
  _DWORD *v10; // r11
  unsigned int i; // er9
  void (__fastcall *v12)(int *); // rax
  PVOID v13; // r11
  int v14; // esi
  unsigned int v15; // eax
  unsigned int v16; // esi
  PVOID v17; // rax
  char *v18; // rbx
  int v19; // eax
  int v20; // ebx
  unsigned int v21; // eax
  unsigned int v22; // ebx
  int v23; // eax
  char *v24; // rsi
  size_t v25; // r8
  void (__fastcall *v26)(int *); // rax
  __int64 v28; // [rsp+20h] [rbp-A8h]
  __int64 v29; // [rsp+28h] [rbp-A0h]
  __int64 v30; // [rsp+30h] [rbp-98h]
  int v31; // [rsp+38h] [rbp-90h]
  char v32[8]; // [rsp+40h] [rbp-88h] BYREF
  void *Src; // [rsp+48h] [rbp-80h] BYREF
  __int64 v34; // [rsp+50h] [rbp-78h]
  int v35[28]; // [rsp+58h] [rbp-70h] BYREF
  _BYTE v36[28]; // [rsp+5Ch] [rbp-6Ch] BYREF
  char v37; // [rsp+D0h] [rbp+8h] BYREF
  size_t MaxCount; // [rsp+D8h] [rbp+10h] BYREF
  unsigned int v39; // [rsp+E0h] [rbp+18h] BYREF
  size_t v40; // [rsp+E8h] [rbp+20h] BYREF

  v0 = *((_QWORD *)P + 6);
  v1 = *((_QWORD *)P + 5);
  v34 = v0;
  v2 = 0;
  v37 = 0;
  v35[0] = 0;
  memset(v36, 0, sizeof(v36));
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x6Au, (__int64)&unk_28BA8);
  }
  v3 = (*(__int64 (__fastcall **)(__int64, _QWORD, char *))(v1 + 40))(v0, 0i64, &v37);
  if ( !v3 )
  {
    v13 = P;
    v20 = *((_DWORD *)P + 4);
    v21 = v20 | *((char *)P + 20);
    v22 = v20 | 1;
    if ( v22 > v21 )
    {
LABEL_73:
      v9 = (void **)off_2A148;
      goto LABEL_74;
    }
    while ( 1 )
    {
      Src = 0i64;
      LODWORD(MaxCount) = 0;
      if ( (*((unsigned __int8 (__fastcall **)(_QWORD, unsigned int *, size_t *, char *, _DWORD))v13 + 40))(
             v22,
             &v39,
             &v40,
             v32,
             v28) )
      {
        v23 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, void **, size_t *))(v1 + 16))(
                v0,
                0i64,
                v22,
                &Src,
                &MaxCount);
        if ( v23 || !Src )
        {
          v9 = (void **)off_2A148;
          if ( off_2A148 != &off_2A148
            && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
            && *((_BYTE *)off_2A148 + 169) >= 2u )
          {
            LODWORD(v28) = v22;
            sub_1D110(*((_QWORD *)off_2A148 + 19), 0x70u, (__int64)&unk_28BA8, v23);
            v9 = (void **)off_2A148;
          }
          v2 = 8;
          goto LABEL_66;
        }
        if ( off_2A148 != &off_2A148
          && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
          && *((_BYTE *)off_2A148 + 169) >= 4u )
        {
          sub_1102C(*((_QWORD *)off_2A148 + 19), 0x71u, (__int64)&unk_28BA8, v22);
        }
        KeEnterCriticalRegion();
        LODWORD(v28) = 0;
        sub_1AD8C((PERESOURCE)((char *)P + 216));
        v24 = (char *)P;
        v25 = (unsigned int)MaxCount;
        if ( (unsigned int)MaxCount >= (unsigned int)v40 )
          v25 = (unsigned int)v40;
        memmove((char *)P + v39 + 352, Src, v25);
        sub_1AF3C((PERESOURCE)(v24 + 216));
        KeLeaveCriticalRegion();
        v0 = v34;
        (*(void (__fastcall **)(__int64, void *))(v1 + 32))(v34, Src);
        v35[(unsigned __int8)(v22 - 1) >> 5] |= 1 << ((v22 - 1) & 0x1F);
      }
      v9 = (void **)off_2A148;
LABEL_66:
      v13 = P;
      if ( ++v22 > (*((_DWORD *)P + 4) | (unsigned int)*((char *)P + 20)) )
        goto LABEL_74;
    }
  }
  v4 = 0i64;
  v5 = 0i64;
  v6 = 0;
  if ( v3 == 1879048199 || v3 == 1879048193 )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
      && *((_BYTE *)off_2A148 + 169) >= 3u )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 19), 0x6Bu, (__int64)&unk_28BA8, 0);
    }
  }
  else if ( off_2A148 != &off_2A148
         && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
         && *((_BYTE *)off_2A148 + 169) >= 3u )
  {
    sub_1D228(*((_QWORD *)off_2A148 + 19), 108i64, (__int64)&unk_28BA8, v3, 0);
  }
  v7 = (void (__fastcall *)(char *))*((_QWORD *)P + 41);
  if ( v7 )
    v7((char *)P + 352);
  v8 = (*(__int64 (__fastcall **)(__int64, _QWORD))(v1 + 64))(v0, 0i64);
  if ( v8 )
  {
    v9 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
      && *((_BYTE *)off_2A148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 19), 0x6Du, (__int64)&unk_28BA8, v8);
      v9 = (void **)off_2A148;
    }
    v10 = P;
    for ( i = *((_DWORD *)P + 4) | 1; i <= (v10[4] | (unsigned int)*((char *)v10 + 20)); ++i )
      v35[(unsigned __int8)(i - 1) >> 5] |= 1 << ((i - 1) & 0x1F);
    v12 = (void (__fastcall *)(int *))*((_QWORD *)v10 + 42);
    if ( v12 )
    {
      v12(v35);
      v9 = (void **)off_2A148;
    }
    v2 = 8;
    goto LABEL_76;
  }
  v9 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 4u )
  {
    sub_1102C(*((_QWORD *)off_2A148 + 19), 0x6Eu, (__int64)&unk_28BA8, 0);
    v9 = (void **)off_2A148;
  }
  v13 = P;
  v14 = *((_DWORD *)P + 4);
  v15 = v14 | *((char *)P + 20);
  v16 = v14 | 1;
  if ( v16 > v15 )
    goto LABEL_74;
  do
  {
    if ( !(*((unsigned __int8 (__fastcall **)(_QWORD, unsigned int *, size_t *, size_t *, __int64, __int64))v13 + 40))(
            v16,
            &v39,
            &MaxCount,
            &v40,
            v28,
            v29) )
      goto LABEL_44;
    if ( (unsigned int)MaxCount > v6 )
    {
      if ( (unsigned int)MaxCount > 8 )
      {
        if ( v4 )
        {
          v31 = 0;
          v30 = 0i64;
          v29 = 0i64;
          v17 = sub_1A5F0(1, v4, v6, MaxCount, 0x706D744Eu);
        }
        else
        {
          LODWORD(v29) = 0;
          v28 = 0i64;
          v17 = sub_1A4F8(1, MaxCount, 0x706D744Eu);
        }
        v4 = v17;
        v5 = (void **)v17;
        v6 = v17 != 0i64 ? MaxCount : 0;
      }
      else
      {
        v5 = &Src;
        v6 = 8;
      }
    }
    v35[(unsigned __int8)(v16 - 1) >> 5] |= 1 << ((v16 - 1) & 0x1F);
    if ( !v5 )
    {
      v2 = 3;
LABEL_44:
      v9 = (void **)off_2A148;
      goto LABEL_45;
    }
    KeEnterCriticalRegion();
    sub_1AE64((PERESOURCE)((char *)P + 216));
    v18 = (char *)P;
    memmove(v5, (char *)P + v39 + 352, (unsigned int)MaxCount);
    sub_1AF3C((PERESOURCE)(v18 + 216));
    KeLeaveCriticalRegion();
    LODWORD(v29) = MaxCount;
    v19 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, void **, __int64, __int64, int))(v1 + 24))(
            v34,
            0i64,
            0i64,
            v16,
            v5,
            v29,
            v30,
            v31);
    if ( !v19 )
      goto LABEL_44;
    v9 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
      && *((_BYTE *)off_2A148 + 169) >= 4u )
    {
      LODWORD(v28) = v16;
      sub_1D110(*((_QWORD *)off_2A148 + 19), 0x6Fu, (__int64)&unk_28BA8, v19);
      v9 = (void **)off_2A148;
    }
    v2 = 8;
LABEL_45:
    v13 = P;
    ++v16;
  }
  while ( v16 <= (*((_DWORD *)P + 4) | (unsigned int)*((char *)P + 20)) );
  if ( v4 )
  {
    sub_1A57C(v4, 0x706D744Eu);
    v13 = P;
    goto LABEL_73;
  }
LABEL_74:
  v26 = (void (__fastcall *)(int *))*((_QWORD *)v13 + 42);
  if ( v26 )
  {
    v26(v35);
    v9 = (void **)off_2A148;
  }
LABEL_76:
  if ( v9 != &off_2A148 && _bittest((const signed __int32 *)v9 + 43, 8u) && *((_BYTE *)v9 + 169) >= 5u )
    sub_1102C((__int64)v9[19], 0x72u, (__int64)&unk_28BA8, v2);
  return v2;
}
// 1E9BA: variable 'v28' is possibly undefined
// 1E9BA: variable 'v29' is possibly undefined
// 1EB37: variable 'v30' is possibly undefined
// 1EB37: variable 'v31' is possibly undefined
// 2A148: using guessed type void *off_2A148;
// 1E734: using guessed type int var_70[28];

//----- (000000000001EE00) ----------------------------------------------------
__int64 __fastcall sub_1EE00(unsigned int a1, int a2, unsigned int a3, _DWORD *a4)
{
  _QWORD *v4; // rsi
  __int64 v6; // rax
  __int64 v7; // r15
  _QWORD *v9; // r14
  unsigned int v10; // ebx
  void **v13; // rcx
  _QWORD *i; // rax
  char *v16; // rsi
  size_t v17; // r8
  char *v18; // rcx
  _QWORD *v19; // rax
  void (__fastcall *v20)(int *); // rdx
  int v21; // eax
  _QWORD *v22; // rcx
  unsigned __int16 v23; // dx
  __int64 v24; // r9
  _QWORD *v25; // rcx
  unsigned __int16 v26; // dx
  unsigned __int64 v27; // r11
  __int64 v28; // rcx
  int v29; // eax
  int v30; // [rsp+20h] [rbp-78h]
  __int64 v31; // [rsp+20h] [rbp-78h]
  __int64 v32; // [rsp+20h] [rbp-78h]
  __int64 v33; // [rsp+20h] [rbp-78h]
  unsigned int v34; // [rsp+28h] [rbp-70h]
  __int64 v35; // [rsp+28h] [rbp-70h]
  _DWORD *v36; // [rsp+30h] [rbp-68h]
  unsigned int v37; // [rsp+40h] [rbp-58h] BYREF
  int v38; // [rsp+44h] [rbp-54h] BYREF
  __int64 v39; // [rsp+48h] [rbp-50h]
  int v40[8]; // [rsp+50h] [rbp-48h] BYREF
  _BYTE v41[28]; // [rsp+54h] [rbp-44h] BYREF
  size_t MaxCount; // [rsp+A0h] [rbp+8h] BYREF

  v4 = P;
  v6 = *((_QWORD *)P + 6);
  v7 = *((_QWORD *)P + 5);
  v9 = 0i64;
  v10 = 0;
  v37 = 0;
  LODWORD(MaxCount) = 0;
  v40[0] = 0;
  v39 = v6;
  memset(v41, 0, sizeof(v41));
  v13 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( _bittest((const signed __int32 *)off_2A148 + 43, 8u) && *((_BYTE *)off_2A148 + 169) >= 4u )
    {
      v36 = a4;
      v34 = a3;
      v30 = a2;
      sub_1D330(*((_QWORD *)off_2A148 + 19), 115i64, (__int64)&unk_28BA8, a1);
      v4 = P;
      v13 = (void **)off_2A148;
    }
    if ( v13 != &off_2A148 && _bittest((const signed __int32 *)v13 + 43, 8u) && *((_BYTE *)v13 + 169) >= 4u )
    {
      sub_11008((__int64)v13[19], 0x74u, (__int64)&unk_28BA8);
      v4 = P;
      v13 = (void **)off_2A148;
    }
  }
  if ( a1 )
  {
    for ( i = (_QWORD *)v4[7]; i != v4 + 7; i = (_QWORD *)*i )
    {
      v9 = i - 5;
      if ( *((_DWORD *)i - 10) == a1 )
        goto LABEL_15;
    }
    v9 = 0i64;
LABEL_15:
    if ( !v9 )
    {
      if ( v13 != &off_2A148 && _bittest((const signed __int32 *)v13 + 43, 8u) && *((_BYTE *)v13 + 169) >= 2u )
        sub_1102C((__int64)v13[19], 0x75u, (__int64)&unk_28BA8, a1);
      return 4i64;
    }
  }
  if ( !((unsigned __int8 (__fastcall *)(_QWORD, unsigned int *, size_t *, int *, int, unsigned int))v4[40])(
          a3,
          &v37,
          &MaxCount,
          &v38,
          v30,
          v34) )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
      && *((_BYTE *)off_2A148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 19), 0x76u, (__int64)&unk_28BA8, a3);
    }
    return 4i64;
  }
  if ( a1 )
  {
    v16 = (char *)v9 + v37 + 56;
    sub_1B2FC((PFAST_MUTEX)((char *)P + 72));
  }
  else
  {
    v16 = (char *)P + v37 + 352;
    KeEnterCriticalRegion();
    sub_1AD8C((PERESOURCE)((char *)P + 216));
  }
  if ( v38 < 0 )
    goto LABEL_34;
  if ( v38 <= 1 )
    goto LABEL_77;
  if ( v38 == 2 )
  {
    if ( a4 )
    {
      v24 = (unsigned int)*a4;
      if ( 2 * v24 <= (unsigned __int64)(unsigned int)MaxCount )
      {
        memmove(v16, a4 + 1, 2 * v24);
        v27 = 2i64 * (unsigned int)*a4;
        if ( v27 >= (unsigned int)MaxCount )
          goto LABEL_44;
        v17 = (unsigned int)MaxCount - v27;
        v18 = &v16[v27];
        goto LABEL_43;
      }
      v22 = off_2A148;
      if ( off_2A148 == &off_2A148
        || !_bittest((const signed __int32 *)off_2A148 + 43, 8u)
        || *((_BYTE *)off_2A148 + 169) < 2u )
      {
LABEL_64:
        v10 = 6;
        goto LABEL_44;
      }
      v23 = 121;
LABEL_58:
      LODWORD(v31) = a3;
      sub_1D158(v22[19], v23, (__int64)&unk_28BA8, v24, v31, 0);
      goto LABEL_64;
    }
    v25 = off_2A148;
    if ( off_2A148 == &off_2A148
      || !_bittest((const signed __int32 *)off_2A148 + 43, 8u)
      || *((_BYTE *)off_2A148 + 169) < 2u )
    {
      goto LABEL_64;
    }
    v26 = 122;
LABEL_63:
    sub_11008(v25[19], v26, (__int64)&unk_28BA8);
    goto LABEL_64;
  }
  if ( v38 > 4 )
  {
    if ( v38 > 7 )
    {
LABEL_34:
      if ( off_2A148 != &off_2A148
        && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
        && *((_BYTE *)off_2A148 + 169) >= 2u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 19), 0x7Bu, (__int64)&unk_28BA8);
      }
      v10 = 4;
      goto LABEL_44;
    }
LABEL_77:
    memmove(v16, a4, (unsigned int)MaxCount);
    goto LABEL_44;
  }
  if ( !a4 )
  {
    v25 = off_2A148;
    if ( off_2A148 == &off_2A148
      || !_bittest((const signed __int32 *)off_2A148 + 43, 8u)
      || *((_BYTE *)off_2A148 + 169) < 2u )
    {
      goto LABEL_64;
    }
    v26 = 120;
    goto LABEL_63;
  }
  if ( *a4 > (unsigned int)MaxCount )
  {
    v22 = off_2A148;
    if ( off_2A148 == &off_2A148
      || !_bittest((const signed __int32 *)off_2A148 + 43, 8u)
      || *((_BYTE *)off_2A148 + 169) < 2u )
    {
      goto LABEL_64;
    }
    v23 = 119;
    LODWORD(v24) = *a4;
    goto LABEL_58;
  }
  memmove(v16, a4 + 1, (unsigned int)*a4);
  if ( *a4 < (unsigned int)MaxCount )
  {
    v17 = (unsigned int)(MaxCount - *a4);
    v18 = &v16[*a4];
LABEL_43:
    memset(v18, 0, v17);
  }
LABEL_44:
  if ( a1 )
  {
    if ( !v10 )
    {
      v28 = v39;
      *((_DWORD *)v9 + (((a3 - 1) >> 5) & 7) + 1) |= 1 << ((a3 - 1) & 0x1F);
      v29 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, char *, _DWORD))(v7 + 24))(
              v28,
              a1,
              0i64,
              a3,
              v16,
              MaxCount);
      if ( v29 )
      {
        if ( off_2A148 != &off_2A148
          && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
          && *((_BYTE *)off_2A148 + 169) >= 2u )
        {
          LODWORD(v35) = a3;
          LODWORD(v33) = a1;
          sub_1D1B8(*((_QWORD *)off_2A148 + 19), 125i64, (__int64)&unk_28BA8, v29, v33, v35, 0);
        }
        v10 = 8;
      }
    }
    sub_1B3C8((PFAST_MUTEX)((char *)P + 72));
  }
  else
  {
    sub_1AF3C((PERESOURCE)((char *)P + 216));
    KeLeaveCriticalRegion();
    if ( !v10 )
    {
      v19 = P;
      v40[((a3 - 1) >> 5) & 7] |= 1 << ((a3 - 1) & 0x1F);
      v20 = (void (__fastcall *)(int *))v19[42];
      if ( v20 )
        v20(v40);
      v21 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, char *, _DWORD, _DWORD *))(v7 + 24))(
              v39,
              0i64,
              0i64,
              a3,
              v16,
              MaxCount,
              v36);
      if ( v21 )
      {
        if ( off_2A148 != &off_2A148
          && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
          && *((_BYTE *)off_2A148 + 169) >= 2u )
        {
          LODWORD(v32) = a3;
          sub_1D158(*((_QWORD *)off_2A148 + 19), 0x7Cu, (__int64)&unk_28BA8, v21, v32, 0);
        }
        v10 = 8;
      }
    }
  }
  return v10;
}
// 1F050: conditional instruction was optimized away because of 'eax.4>=3'
// 1EF82: variable 'v30' is possibly undefined
// 1EF82: variable 'v34' is possibly undefined
// 1F171: variable 'v36' is possibly undefined
// 1F1BB: variable 'v32' is possibly undefined
// 1F20E: variable 'v31' is possibly undefined
// 1F3AF: variable 'v33' is possibly undefined
// 1F3AF: variable 'v35' is possibly undefined
// 2A148: using guessed type void *off_2A148;
// 1EE00: using guessed type int var_48[8];

//----- (000000000001F3F8) ----------------------------------------------------
__int64 __fastcall sub_1F3F8(__int64 a1, unsigned int a2, __int64 a3)
{
  unsigned int v5; // ebx
  void **v6; // rcx
  void **v7; // rcx
  int v8; // edx
  char *v9; // rbp
  unsigned int v10; // er8
  __int64 *v11; // r9
  unsigned int v12; // er12
  _DWORD *v13; // rsi
  unsigned __int16 v14; // dx
  int v15; // eax
  __int64 Dst; // [rsp+30h] [rbp-38h] BYREF
  unsigned int v18; // [rsp+38h] [rbp-30h] BYREF
  int v19; // [rsp+3Ch] [rbp-2Ch] BYREF
  size_t MaxCount; // [rsp+88h] [rbp+20h] BYREF

  v5 = 0;
  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( _bittest((const signed __int32 *)off_2A148 + 43, 8u) && *((_BYTE *)off_2A148 + 169) >= 5u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x7Eu, (__int64)&unk_28BA8);
      v6 = (void **)off_2A148;
    }
    if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 43, 8u) && *((_BYTE *)v6 + 169) >= 4u )
      sub_1102C((__int64)v6[19], 0x7Fu, (__int64)&unk_28BA8, a2);
  }
  if ( !(*((unsigned __int8 (__fastcall **)(_QWORD, unsigned int *, size_t *, int *))P + 40))(a2, &v18, &MaxCount, &v19) )
  {
    v7 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 )
    {
      if ( _bittest((const signed __int32 *)off_2A148 + 43, 8u) && *((_BYTE *)off_2A148 + 169) >= 2u )
      {
        sub_1102C(*((_QWORD *)off_2A148 + 19), 0x80u, (__int64)&unk_28BA8, a2);
LABEL_46:
        v7 = (void **)off_2A148;
      }
LABEL_47:
      if ( v7 != &off_2A148 && _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 2u )
        sub_11008((__int64)v7[19], 0x85u, (__int64)&unk_28BA8);
    }
LABEL_51:
    v8 = 17;
LABEL_52:
    v11 = 0i64;
    v5 = v8;
    v10 = 0;
    goto LABEL_53;
  }
  if ( !(_DWORD)MaxCount )
  {
    if ( off_2A148 != &off_2A148
      && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
      && *((_BYTE *)off_2A148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 19), 0x81u, (__int64)&unk_28BA8, a2);
    }
    v8 = 12;
    goto LABEL_52;
  }
  v9 = (char *)P + v18 + 352;
  if ( v19 < 0 )
  {
LABEL_41:
    v7 = (void **)off_2A148;
    if ( off_2A148 == &off_2A148 )
      goto LABEL_51;
    if ( !_bittest((const signed __int32 *)off_2A148 + 43, 8u) || *((_BYTE *)off_2A148 + 169) < 2u )
      goto LABEL_47;
    v14 = 132;
    goto LABEL_45;
  }
  if ( v19 <= 1 )
  {
LABEL_40:
    LODWORD(Dst) = 0;
    memmove(&Dst, (char *)P + v18 + 352, (unsigned int)MaxCount);
    v8 = 0;
    v10 = 4;
    v11 = &Dst;
    goto LABEL_53;
  }
  if ( v19 == 2 )
  {
    v12 = MaxCount + 4;
    v13 = sub_1A4F8(1, (int)MaxCount + 4, 0x66634E4Eu);
    if ( !v13 )
    {
      v7 = (void **)off_2A148;
      if ( off_2A148 == &off_2A148 )
        goto LABEL_51;
      if ( !_bittest((const signed __int32 *)off_2A148 + 43, 8u) || *((_BYTE *)off_2A148 + 169) < 2u )
        goto LABEL_47;
      v14 = 131;
      goto LABEL_45;
    }
    v15 = (unsigned int)MaxCount >> 1;
  }
  else
  {
    if ( v19 > 4 )
    {
      if ( v19 > 6 )
      {
        if ( v19 == 7 )
        {
          Dst = 0i64;
          memmove(&Dst, (char *)P + v18 + 352, (unsigned int)MaxCount);
          v8 = 0;
          v10 = 8;
          v11 = &Dst;
LABEL_53:
          sub_21950(a3, v8, v10, v11);
          goto LABEL_54;
        }
        goto LABEL_41;
      }
      goto LABEL_40;
    }
    v12 = MaxCount + 4;
    v13 = sub_1A4F8(1, (int)MaxCount + 4, 0x66634E4Eu);
    if ( !v13 )
    {
      v7 = (void **)off_2A148;
      if ( off_2A148 == &off_2A148 )
        goto LABEL_51;
      if ( !_bittest((const signed __int32 *)off_2A148 + 43, 8u) || *((_BYTE *)off_2A148 + 169) < 2u )
        goto LABEL_47;
      v14 = 130;
LABEL_45:
      sub_11008((__int64)v7[19], v14, (__int64)&unk_28BA8);
      goto LABEL_46;
    }
    v15 = MaxCount;
  }
  *v13 = v15;
  memmove(v13 + 1, v9, (unsigned int)MaxCount);
  sub_21950(a3, 0, v12, v13);
  sub_1A57C(v13, 0x66634E4Eu);
LABEL_54:
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_1102C(*((_QWORD *)off_2A148 + 19), 0x86u, (__int64)&unk_28BA8, v5);
  }
  return v5;
}
// 1F57C: conditional instruction was optimized away because of 'eax.4>=3'
// 2A148: using guessed type void *off_2A148;

//----- (000000000001F7BC) ----------------------------------------------------
__int64 __fastcall sub_1F7BC(int a1)
{
  unsigned int v1; // edi
  char *v4; // r10
  char *i; // rax
  char *v6; // rax
  _DWORD *v7; // rax
  _QWORD *v8; // rsi
  char *v9; // rbx
  _QWORD *v10; // rdx
  __int64 v11; // rcx

  v1 = 0;
  if ( !a1 )
    return 6i64;
  sub_1B2FC((PFAST_MUTEX)((char *)P + 72));
  v4 = (char *)P;
  for ( i = (char *)*((_QWORD *)P + 7); i != (char *)P + 56; i = (char *)*((_QWORD *)v6 + 5) )
  {
    v6 = i - 40;
    if ( *(_DWORD *)v6 == a1 )
      goto LABEL_8;
  }
  v6 = 0i64;
LABEL_8:
  if ( v6 )
  {
    v1 = 6;
  }
  else
  {
    v7 = sub_1A4F8(1, *((_DWORD *)P + 1) + 56, 0x66634E4Eu);
    v8 = v7;
    if ( v7 )
    {
      *v7 = a1;
      memset(v7 + 1, 0, 0x20ui64);
      KeEnterCriticalRegion();
      sub_1AE64((PERESOURCE)((char *)P + 216));
      v9 = (char *)P;
      memmove(v8 + 7, (char *)P + 352, *((unsigned int *)P + 1));
      sub_1AF3C((PERESOURCE)(v9 + 216));
      KeLeaveCriticalRegion();
      v4 = (char *)P;
      v10 = (char *)P + 56;
      v11 = *((_QWORD *)P + 7);
      v8[6] = (char *)P + 56;
      v8[5] = v11;
      *(_QWORD *)(v11 + 8) = v8 + 5;
      *v10 = v8 + 5;
    }
    else
    {
      v4 = (char *)P;
      v1 = 3;
    }
  }
  sub_1B3C8((PFAST_MUTEX)(v4 + 72));
  return v1;
}

//----- (000000000001F918) ----------------------------------------------------
__int64 __fastcall sub_1F918(int a1)
{
  __int64 result; // rax
  char *v3; // r11
  _QWORD *i; // rax
  char *v5; // rdi
  __int64 v6; // rcx
  _QWORD *v7; // rax
  char *v8; // rbx
  void (__fastcall *v9)(char *); // rax

  if ( !a1 )
    return 6i64;
  sub_1B2FC((PFAST_MUTEX)((char *)P + 72));
  v3 = (char *)P;
  for ( i = (_QWORD *)*((_QWORD *)P + 7); i != (_QWORD *)((char *)P + 56); i = (_QWORD *)*i )
  {
    v5 = (char *)(i - 5);
    if ( *((_DWORD *)i - 10) == a1 )
      goto LABEL_8;
  }
  v5 = 0i64;
LABEL_8:
  if ( v5 )
  {
    v6 = *((_QWORD *)v5 + 5);
    v7 = (_QWORD *)*((_QWORD *)v5 + 6);
    *v7 = v6;
    *(_QWORD *)(v6 + 8) = v7;
    sub_1B3C8((PFAST_MUTEX)(v3 + 72));
    KeEnterCriticalRegion();
    sub_1AD8C((PERESOURCE)((char *)P + 216));
    v8 = (char *)P;
    memmove((char *)P + 352, v5 + 56, *((unsigned int *)P + 1));
    sub_1AF3C((PERESOURCE)(v8 + 216));
    KeLeaveCriticalRegion();
    v9 = (void (__fastcall *)(char *))*((_QWORD *)P + 42);
    if ( v9 )
      v9(v5 + 4);
    sub_1A57C(v5, 0x66634E4Eu);
    result = 0i64;
  }
  else
  {
    sub_1B3C8((PFAST_MUTEX)((char *)P + 72));
    result = 5i64;
  }
  return result;
}

//----- (000000000001FA40) ----------------------------------------------------
__int64 __fastcall sub_1FA40(__int64 a1, __int64 a2, __int64 a3, const wchar_t *a4)
{
  __int64 v5; // rcx
  const wchar_t *v6; // rdi
  bool v7; // zf

  if ( a4 && *a4 )
  {
    v5 = -1i64;
    v6 = a4;
    do
    {
      if ( !v5 )
        break;
      v7 = *v6++ == 0;
      --v5;
    }
    while ( !v7 );
  }
  if ( a4 )
  {
    if ( !*a4 )
      a4 = L"<NULL>";
  }
  else
  {
    a4 = L"NULL";
  }
  return qword_2A1B8(a1, 43i64, &unk_28B98, 71i64, a4);
}
// 28C80: using guessed type wchar_t aNull_0[7];
// 28C90: using guessed type wchar_t aNull_1[5];
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001FAF0) ----------------------------------------------------
__int64 sub_1FAF0(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_2A1B8(a1, 43i64, a3, a2, (__int64 *)va);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001FB44) ----------------------------------------------------
__int64 sub_1FB44(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_2A1B8(a1, 43i64, &unk_28B98, 134i64, (__int64 *)va);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001FBB0) ----------------------------------------------------
__int64 __fastcall sub_1FBB0(__int16 *a1, int a2, unsigned int *a3)
{
  void **v6; // rbx
  __int64 v7; // rcx
  unsigned __int16 v8; // dx

  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xAu, (__int64)&unk_28B98);
    v6 = (void **)off_2A148;
  }
  if ( !byte_2CCF2 )
  {
    memset(&qword_2C890, 0, 0x470ui64);
    if ( a3 )
    {
      if ( !(unsigned int)sub_21708(a3) )
      {
        dword_2CCE8 = 0;
        dword_2CCEC = 0;
        byte_2CCF3 = 0;
        byte_2CCF0 = 0;
        byte_2CCF1 = 0;
        sub_274EC(word_2C8B0, 520i64, a1);
        dword_2CCC0 = a2;
        byte_2CCF2 = 1;
        sub_1FD84(1);
        if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
          sub_1102C(*((_QWORD *)off_2A148 + 19), 0xEu, (__int64)&unk_28B98, 0);
        return 0i64;
      }
      if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 172) & 1) == 0 || *((_BYTE *)off_2A148 + 169) < 2u )
        return 264i64;
      v7 = *((_QWORD *)off_2A148 + 19);
      v8 = 13;
    }
    else
    {
      if ( v6 == &off_2A148 || (*((_BYTE *)v6 + 172) & 1) == 0 || *((_BYTE *)v6 + 169) < 2u )
        return 264i64;
      v7 = (__int64)v6[19];
      v8 = 12;
    }
    sub_11008(v7, v8, (__int64)&unk_28B98);
    return 264i64;
  }
  if ( v6 != &off_2A148 && (*((_BYTE *)v6 + 172) & 1) != 0 && *((_BYTE *)v6 + 169) >= 2u )
    sub_11008((__int64)v6[19], 0xBu, (__int64)&unk_28B98);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;
// 2CCC0: using guessed type int dword_2CCC0;
// 2CCE8: using guessed type int dword_2CCE8;
// 2CCEC: using guessed type int dword_2CCEC;
// 2CCF0: using guessed type char byte_2CCF0;
// 2CCF1: using guessed type char byte_2CCF1;
// 2CCF2: using guessed type char byte_2CCF2;
// 2CCF3: using guessed type char byte_2CCF3;

//----- (000000000001FD84) ----------------------------------------------------
__int64 __fastcall sub_1FD84(char a1)
{
  void **v2; // rcx

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xFu, (__int64)&unk_28B98);
    v2 = (void **)off_2A148;
  }
  byte_2CCF4 = a1;
  if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 172) & 1) != 0 && *((_BYTE *)v2 + 169) >= 5u )
    sub_1102C((__int64)v2[19], 0x10u, (__int64)&unk_28B98, 0);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;
// 2CCF4: using guessed type char byte_2CCF4;

//----- (000000000001FE20) ----------------------------------------------------
__int64 sub_1FE20()
{
  void **v0; // rcx
  _QWORD *v2; // rcx
  unsigned __int16 v3; // dx

  v0 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x1Bu, (__int64)&unk_28B98);
    v0 = (void **)off_2A148;
  }
  if ( !byte_2CCF2 )
  {
    if ( v0 != &off_2A148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 2u )
      sub_11008((__int64)v0[19], 0x1Cu, (__int64)&unk_28B98);
    return 258i64;
  }
  if ( !dword_2CCE8 && !dword_2CCEC && v0 != &off_2A148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 2u )
    sub_11008((__int64)v0[19], 0x1Du, (__int64)&unk_28B98);
  if ( (unsigned int)sub_203A0() )
  {
    v2 = off_2A148;
    if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 172) & 1) == 0 || *((_BYTE *)off_2A148 + 169) < 2u )
      return 257i64;
    v3 = 30;
LABEL_22:
    sub_11008(v2[19], v3, (__int64)&unk_28B98);
    return 257i64;
  }
  if ( (unsigned int)sub_209EC() )
  {
    v2 = off_2A148;
    if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 172) & 1) == 0 || *((_BYTE *)off_2A148 + 169) < 2u )
      return 257i64;
    v3 = 31;
    goto LABEL_22;
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x20u, (__int64)&unk_28B98);
  sub_2245C();
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_1102C(*((_QWORD *)off_2A148 + 19), 0x21u, (__int64)&unk_28B98, 0);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;
// 2CCE8: using guessed type int dword_2CCE8;
// 2CCEC: using guessed type int dword_2CCEC;
// 2CCF2: using guessed type char byte_2CCF2;

//----- (000000000001FFE0) ----------------------------------------------------
__int64 __fastcall sub_1FFE0(unsigned int a1, __int64 a2)
{
  void **v4; // rcx
  __int64 result; // rax
  int v6; // eax

  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x35u, (__int64)&unk_28B98);
    v4 = (void **)off_2A148;
  }
  if ( byte_2CCF3 )
  {
    if ( qword_2CCC8 && a2 )
    {
      v6 = (*(__int64 (__fastcall **)(_QWORD, _QWORD, __int64))(*((_QWORD *)qword_2CCC8 + 1) + 8i64))(
             **((_QWORD **)qword_2CCC8 + 1),
             a1,
             a2);
      v4 = (void **)off_2A148;
    }
    else
    {
      v6 = 1796;
    }
    if ( v6 )
    {
      if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) >= 2u )
        sub_1102C((__int64)v4[19], 0x37u, (__int64)&unk_28B98, v6);
      result = 257i64;
    }
    else
    {
      if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) >= 5u )
        sub_1102C((__int64)v4[19], 0x38u, (__int64)&unk_28B98, 0);
      result = 0i64;
    }
  }
  else
  {
    if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) >= 2u )
      sub_11008((__int64)v4[19], 0x36u, (__int64)&unk_28B98);
    result = 260i64;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;
// 2CCF3: using guessed type char byte_2CCF3;

//----- (0000000000020130) ----------------------------------------------------
__int64 sub_20130()
{
  void **v0; // rcx
  int v2; // eax
  unsigned int v3; // edi
  void **v4; // rbx
  PVOID *v5; // rcx
  PVOID *v6; // rcx

  v0 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x39u, (__int64)&unk_28B98);
    v0 = (void **)off_2A148;
  }
  if ( byte_2CCF2 )
  {
    v2 = sub_21150();
    v3 = v2;
    if ( v2 )
    {
      v4 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
      {
        sub_1102C(*((_QWORD *)off_2A148 + 19), 0x3Bu, (__int64)&unk_28B98, v2);
        v4 = (void **)off_2A148;
      }
      if ( v3 != 260 )
        return v3;
    }
    else
    {
      v4 = (void **)off_2A148;
    }
    if ( dword_2CCE8 )
    {
      v5 = (PVOID *)qword_2C890;
      if ( qword_2C890 != &qword_2C890 )
      {
        do
        {
          qword_2C890 = *v5;
          *((_QWORD *)qword_2C890 + 1) = &qword_2C890;
          sub_1A57C(v5, 0x74785072u);
          v5 = (PVOID *)qword_2C890;
        }
        while ( qword_2C890 != &qword_2C890 );
        v4 = (void **)off_2A148;
      }
    }
    if ( dword_2CCEC )
    {
      v6 = (PVOID *)qword_2C8A0;
      if ( qword_2C8A0 != &qword_2C8A0 )
      {
        do
        {
          qword_2C8A0 = *v6;
          *((_QWORD *)qword_2C8A0 + 1) = &qword_2C8A0;
          sub_1A57C(v6, 0x746D436Eu);
          v6 = (PVOID *)qword_2C8A0;
        }
        while ( qword_2C8A0 != &qword_2C8A0 );
        v4 = (void **)off_2A148;
      }
    }
    if ( qword_2CCD8 && byte_2CCF0 == 1 )
    {
      sub_1A57C(qword_2CCD8, 0x74785072u);
      qword_2CCD8 = 0i64;
      v4 = (void **)off_2A148;
    }
    if ( qword_2CCE0 && byte_2CCF1 == 1 )
    {
      sub_1A57C(qword_2CCE0, 0x746D436Eu);
      v4 = (void **)off_2A148;
    }
    memset(&qword_2C890, 0, 0x470ui64);
    if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) >= 5u )
      sub_1102C((__int64)v4[19], 0x3Cu, (__int64)&unk_28B98, v3);
    return v3;
  }
  if ( v0 != &off_2A148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 2u )
    sub_11008((__int64)v0[19], 0x3Au, (__int64)&unk_28B98);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;
// 2CCE8: using guessed type int dword_2CCE8;
// 2CCEC: using guessed type int dword_2CCEC;
// 2CCF0: using guessed type char byte_2CCF0;
// 2CCF1: using guessed type char byte_2CCF1;
// 2CCF2: using guessed type char byte_2CCF2;

//----- (00000000000203A0) ----------------------------------------------------
__int64 sub_203A0()
{
  void **v0; // rcx
  PVOID v1; // rax
  PVOID v3; // rax

  v0 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x3Du, (__int64)&unk_28B98);
    v0 = (void **)off_2A148;
  }
  if ( dword_2CCE8 )
  {
    v1 = sub_1A4F8(2, 0x1340u, 0x74785072u);
    qword_2CCD8 = v1;
    if ( !v1 )
      return 3i64;
    memset(v1, 0, 0x1340ui64);
    if ( (unsigned int)sub_20628(0) )
    {
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
        sub_11008(*((_QWORD *)off_2A148 + 19), 0x3Eu, (__int64)&unk_28B98);
      sub_1A57C(qword_2CCD8, 0x74785072u);
      qword_2CCD8 = 0i64;
      return 1i64;
    }
    v0 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x3Fu, (__int64)&unk_28B98);
      v0 = (void **)off_2A148;
    }
    byte_2CCF0 = 1;
  }
  if ( dword_2CCEC )
  {
    v3 = sub_1A4F8(2, 0x9A0u, 0x746D436Eu);
    qword_2CCE0 = v3;
    if ( v3 )
    {
      memset(v3, 0, 0x9A0ui64);
      if ( (unsigned int)sub_20628(1) )
      {
        if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
          sub_11008(*((_QWORD *)off_2A148 + 19), 0x40u, (__int64)&unk_28B98);
        sub_1A57C(qword_2CCE0, 0x746D436Eu);
        qword_2CCE0 = 0i64;
        return 1i64;
      }
      v0 = (void **)off_2A148;
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 19), 0x41u, (__int64)&unk_28B98);
        v0 = (void **)off_2A148;
      }
      byte_2CCF1 = 1;
      goto LABEL_33;
    }
    return 3i64;
  }
LABEL_33:
  if ( v0 != &off_2A148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 5u )
    sub_1102C((__int64)v0[19], 0x42u, (__int64)&unk_28B98, 0);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;
// 2CCE8: using guessed type int dword_2CCE8;
// 2CCEC: using guessed type int dword_2CCEC;
// 2CCF0: using guessed type char byte_2CCF0;
// 2CCF1: using guessed type char byte_2CCF1;

//----- (0000000000020628) ----------------------------------------------------
__int64 __fastcall sub_20628(int a1)
{
  unsigned int v2; // edi
  void **v3; // rcx
  PVOID *j; // rbx
  int v5; // edx
  unsigned int v6; // er9
  unsigned __int64 v7; // r8
  PVOID *i; // rbx
  unsigned int v9; // er9
  __int64 v10; // r8
  __int64 (__fastcall *v11)(__int64, __int64, __int64); // rcx
  int v12; // eax

  v2 = 0;
  v3 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x43u, (__int64)&unk_28B98);
    v3 = (void **)off_2A148;
  }
  if ( a1 )
  {
    for ( i = (PVOID *)qword_2C8A0; i != &qword_2C8A0; i = (PVOID *)*i )
    {
      v9 = *((_DWORD *)i + 4) - 40000;
      if ( v9 >= 0x4D )
      {
        if ( v3 != &off_2A148 && (*((_BYTE *)v3 + 172) & 1) != 0 && *((_BYTE *)v3 + 169) >= 2u )
        {
          sub_1102C((__int64)v3[19], 0x45u, (__int64)&unk_28B98, v9);
          v3 = (void **)off_2A148;
        }
        v2 = 1;
      }
      else
      {
        v10 = 32i64 * v9;
        *(_DWORD *)((char *)qword_2CCE0 + v10) = *((_DWORD *)i + 4);
        *(_DWORD *)((char *)qword_2CCE0 + v10 + 4) = -1;
        *(_DWORD *)((char *)qword_2CCE0 + v10 + 8) = *((_DWORD *)i + 6);
        *(_DWORD *)((char *)qword_2CCE0 + v10 + 12) = *((_DWORD *)i + 7);
        *(_QWORD *)((char *)qword_2CCE0 + v10 + 24) = i + 3;
        if ( *((_DWORD *)i + 4) == 40005 )
        {
          v11 = sub_220D8;
        }
        else
        {
          v12 = *((_DWORD *)i + 4);
          if ( v12 == 40015
            || v12 == 40016
            || v12 == 40017
            || v12 == 40018
            || v12 == 40019
            || v12 == 40020
            || v12 == 40021
            || v12 == 40023
            || v12 == 40022
            || v12 == 40039
            || v12 == 40044
            || v12 == 40024
            || v12 == 40036
            || v12 == 40012
            || v12 == 40037
            || v12 == 40014
            || v12 == 40041
            || v12 == 40042
            || v12 == 40013
            || v12 == 40038
            || v12 == 40025 )
          {
            v11 = sub_222B8;
          }
          else if ( v12 == 40011
                 || v12 == 40053
                 || v12 == 40050
                 || v12 == 40051
                 || v12 == 40052
                 || v12 == 40045
                 || v12 == 40003 )
          {
            v11 = sub_21DC0;
          }
          else
          {
            v11 = sub_21B4C;
          }
        }
        *(_QWORD *)((char *)qword_2CCE0 + v10 + 16) = v11;
        v3 = (void **)off_2A148;
      }
    }
  }
  else
  {
    for ( j = (PVOID *)qword_2C890; j != &qword_2C890; j = (PVOID *)*j )
    {
      v5 = *((_DWORD *)j + 4);
      v6 = v5 - 40000;
      if ( (unsigned int)(v5 - 40000) >= 0x4D )
      {
        if ( v3 != &off_2A148 && (*((_BYTE *)v3 + 172) & 1) != 0 && *((_BYTE *)v3 + 169) >= 2u )
        {
          sub_1102C((__int64)v3[19], 0x44u, (__int64)&unk_28B98, v6);
          v3 = (void **)off_2A148;
        }
        v2 = 1;
      }
      else
      {
        v7 = (unsigned __int64)v6 << 6;
        *(_DWORD *)((char *)qword_2CCD8 + v7) = v5;
        *(_DWORD *)((char *)qword_2CCD8 + v7 + 4) = *((_DWORD *)j + 6);
        *(_DWORD *)((char *)qword_2CCD8 + v7 + 8) = -1;
        *(_QWORD *)((char *)qword_2CCD8 + v7 + 16) = 0i64;
        *(_DWORD *)((char *)qword_2CCD8 + v7 + 24) = *((_DWORD *)j + 7);
        *(_QWORD *)((char *)qword_2CCD8 + v7 + 32) = (unsigned __int64)sub_214B0 & -(__int64)(j[4] != 0i64);
        *(_QWORD *)((char *)qword_2CCD8 + v7 + 40) = j + 3;
        *(_DWORD *)((char *)qword_2CCD8 + v7 + 48) = 0;
        *(_QWORD *)((char *)qword_2CCD8 + v7 + 56) = 0i64;
        v3 = (void **)off_2A148;
      }
    }
  }
  if ( v3 != &off_2A148 && (*((_BYTE *)v3 + 172) & 1) != 0 && *((_BYTE *)v3 + 169) >= 5u )
    sub_1102C((__int64)v3[19], 0x46u, (__int64)&unk_28B98, v2);
  return v2;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000209EC) ----------------------------------------------------
__int64 sub_209EC()
{
  void **v0; // rcx
  _QWORD *v1; // rax
  _QWORD *v2; // rbx
  int v3; // edi
  void **v4; // rcx
  unsigned __int16 v5; // dx
  int v6; // er9
  unsigned int v7; // esi
  __int64 v8; // rdi
  _QWORD *v9; // rbp
  int v10; // er12
  int v11; // eax
  __int64 v12; // rax
  int v13; // eax
  __int64 v14; // r9
  __int64 v15; // r8
  __int64 v16; // rcx
  void **v18; // r10
  unsigned int v19; // ebx
  __int64 v20; // rdi
  int v21; // er9
  __int64 v22; // rax
  unsigned int v23; // ebx
  __int64 v24; // rdi
  __int64 v25; // rax
  __int64 v26; // rax
  unsigned __int16 v27; // dx
  __int64 (__fastcall **v28)(_QWORD *, _QWORD, _WORD *); // [rsp+60h] [rbp+8h] BYREF

  v0 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_1FA40(*((_QWORD *)off_2A148 + 19), 71i64, (__int64)&unk_28B98, word_2C8B0);
    v0 = (void **)off_2A148;
  }
  if ( byte_2CCF0 || byte_2CCF1 )
    goto LABEL_11;
  if ( v0 != &off_2A148 )
  {
    if ( (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 2u )
    {
      sub_11008((__int64)v0[19], 0x48u, (__int64)&unk_28B98);
      v0 = (void **)off_2A148;
    }
LABEL_11:
    if ( v0 != &off_2A148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 4u )
      sub_12954((__int64)v0[19], 0x49u, (__int64)&unk_28B98, &qword_2CCC8);
  }
  qword_2CCC8 = 0i64;
  v1 = sub_1A4F8(2, 0x38u, 0x41434E50u);
  v2 = v1;
  if ( !v1 )
  {
    v3 = 1793;
LABEL_25:
    v4 = (void **)off_2A148;
    if ( off_2A148 == &off_2A148 || (*((_BYTE *)off_2A148 + 172) & 1) == 0 || !*((_BYTE *)off_2A148 + 169) )
      return 260i64;
    v5 = 74;
    v6 = v3;
LABEL_53:
    v16 = (__int64)v4[19];
    goto LABEL_54;
  }
  memset(v1, 0, 0x38ui64);
  v3 = sub_25F4C(v2 + 6, v2 + 1);
  if ( v3
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531842i64,
               v2 + 2)) != 0
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531845i64,
               v2 + 5)) != 0
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531843i64,
               v2 + 4)) != 0
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531844i64,
               v2 + 3)) != 0 )
  {
    sub_260D0(v2);
    v2 = qword_2CCC8;
  }
  else
  {
    *(_BYTE *)v2 = 1;
    qword_2CCC8 = v2;
  }
  if ( v3 )
    goto LABEL_25;
  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
  {
    sub_12954(*((_QWORD *)off_2A148 + 19), 0x4Bu, (__int64)&unk_28B98, &qword_2CCC8, 0i64, 0);
    v4 = (void **)off_2A148;
    v2 = qword_2CCC8;
  }
  v7 = dword_2CCC0;
  v8 = 0i64;
  v9 = v2;
  v10 = 1796;
  if ( v2 )
  {
    v11 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(v2[1] + 8i64))(*(_QWORD *)v2[1], 1i64, &v28);
    v4 = (void **)off_2A148;
    v2 = qword_2CCC8;
    if ( !v11 )
    {
      v12 = (*v28)(v9, v7, word_2C8B0);
      v4 = (void **)off_2A148;
      v2 = qword_2CCC8;
      v8 = v12;
    }
  }
  qword_2CCD0 = v8;
  if ( !v8 )
  {
    if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) )
      sub_11008((__int64)v4[19], 0x4Cu, (__int64)&unk_28B98);
    return 260i64;
  }
  if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) >= 4u )
  {
    sub_1FAF0((__int64)v4[19], 0x4Du, (__int64)&unk_28B98, v2, v8, &qword_2CD00);
    v4 = (void **)off_2A148;
    v8 = qword_2CCD0;
    v2 = qword_2CCC8;
  }
  v13 = 1796;
  if ( !v8 || (v14 = *(_QWORD *)(v8 + 1112)) == 0 )
  {
LABEL_49:
    if ( v4 == &off_2A148 || (*((_BYTE *)v4 + 172) & 1) == 0 || !*((_BYTE *)v4 + 169) )
      return 260i64;
    v5 = 78;
    v6 = v13;
    goto LABEL_53;
  }
  v13 = (*(__int64 (__fastcall **)(_QWORD *, __int64, __int64 *))(v14 + 112))(v2, v8, &qword_2CD00);
  if ( v13 )
  {
    v4 = (void **)off_2A148;
    goto LABEL_49;
  }
  v18 = (void **)off_2A148;
  if ( !dword_2CCE8 )
  {
LABEL_71:
    if ( dword_2CCEC )
    {
      v23 = 0;
      v24 = 0i64;
      do
      {
        if ( v18 != &off_2A148 && (*((_BYTE *)v18 + 172) & 1) != 0 && *((_BYTE *)v18 + 169) >= 4u )
        {
          sub_1FAF0(
            (__int64)v18[19],
            0x52u,
            (__int64)&unk_28B98,
            qword_2CCC8,
            qword_2CCD0,
            (char *)qword_2CCE0 + 32 * v23);
          v18 = (void **)off_2A148;
        }
        if ( *(_DWORD *)((char *)qword_2CCE0 + v24) )
        {
          v21 = 1796;
          if ( !qword_2CCD0 )
            goto LABEL_105;
          v25 = *(_QWORD *)(qword_2CCD0 + 1112);
          if ( !v25 )
            goto LABEL_105;
          v21 = (*(__int64 (__fastcall **)(__int64, char *, __int64, __int64))(v25 + 40))(
                  qword_2CCD0,
                  (char *)qword_2CCE0 + 32 * v23,
                  v15,
                  1796i64);
          if ( v21 )
          {
            v18 = (void **)off_2A148;
LABEL_105:
            if ( v18 != &off_2A148 && (*((_BYTE *)v18 + 172) & 1) != 0 && *((_BYTE *)v18 + 169) )
            {
              v27 = 83;
LABEL_103:
              sub_1D110((__int64)v18[19], v27, (__int64)&unk_28B98, v21);
            }
            return 260i64;
          }
          v18 = (void **)off_2A148;
          if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) )
          {
            sub_1102C(*((_QWORD *)off_2A148 + 19), 0x54u, (__int64)&unk_28B98, v23);
            v18 = (void **)off_2A148;
          }
        }
        ++v23;
        v24 += 32i64;
      }
      while ( v23 < 0x4D );
    }
    if ( v18 != &off_2A148 && (*((_BYTE *)v18 + 172) & 1) != 0 && *((_BYTE *)v18 + 169) >= 4u )
    {
      sub_13878((__int64)v18[19], 0x55u, (__int64)&unk_28B98, qword_2CCC8, qword_2CCD0);
      v18 = (void **)off_2A148;
    }
    if ( qword_2CCD0 )
    {
      v26 = *(_QWORD *)(qword_2CCD0 + 1112);
      if ( v26 )
      {
        v10 = (*(__int64 (__fastcall **)(PVOID))(v26 + 8))(qword_2CCC8);
        if ( !v10 )
        {
          byte_2CCF3 = 1;
          if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
            sub_1102C(*((_QWORD *)off_2A148 + 19), 0x57u, (__int64)&unk_28B98, 0);
          return 0i64;
        }
        v18 = (void **)off_2A148;
      }
    }
    if ( v18 == &off_2A148 || (*((_BYTE *)v18 + 172) & 1) == 0 || !*((_BYTE *)v18 + 169) )
      return 260i64;
    v16 = (__int64)v18[19];
    v5 = 86;
    v6 = v10;
LABEL_54:
    sub_1102C(v16, v5, (__int64)&unk_28B98, v6);
    return 260i64;
  }
  v19 = 0;
  v20 = 0i64;
  while ( 1 )
  {
    if ( v18 != &off_2A148 && (*((_BYTE *)v18 + 172) & 1) != 0 && *((_BYTE *)v18 + 169) >= 4u )
    {
      sub_1FAF0(
        (__int64)v18[19],
        0x4Fu,
        (__int64)&unk_28B98,
        qword_2CCC8,
        qword_2CCD0,
        (char *)qword_2CCD8 + 64 * (unsigned __int64)v19);
      v18 = (void **)off_2A148;
    }
    if ( !*(_DWORD *)((char *)qword_2CCD8 + v20) )
      goto LABEL_70;
    v21 = 1796;
    if ( !qword_2CCD0 )
      goto LABEL_99;
    v22 = *(_QWORD *)(qword_2CCD0 + 1112);
    if ( !v22 )
      goto LABEL_99;
    v21 = (*(__int64 (__fastcall **)(__int64, char *, __int64, __int64))(v22 + 64))(
            qword_2CCD0,
            (char *)qword_2CCD8 + 64 * (unsigned __int64)v19,
            v15,
            1796i64);
    if ( v21 )
      break;
    v18 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 19), 0x51u, (__int64)&unk_28B98, v19);
      v18 = (void **)off_2A148;
    }
LABEL_70:
    ++v19;
    v20 += 64i64;
    if ( v19 >= 0x4D )
      goto LABEL_71;
  }
  v18 = (void **)off_2A148;
LABEL_99:
  if ( v18 != &off_2A148 && (*((_BYTE *)v18 + 172) & 1) != 0 && *((_BYTE *)v18 + 169) )
  {
    v27 = 80;
    goto LABEL_103;
  }
  return 260i64;
}
// 20E69: variable 'v15' is possibly undefined
// 2A148: using guessed type void *off_2A148;
// 2CCC0: using guessed type int dword_2CCC0;
// 2CCD0: using guessed type __int64 qword_2CCD0;
// 2CCE8: using guessed type int dword_2CCE8;
// 2CCEC: using guessed type int dword_2CCEC;
// 2CCF0: using guessed type char byte_2CCF0;
// 2CCF1: using guessed type char byte_2CCF1;
// 2CCF3: using guessed type char byte_2CCF3;
// 2CD00: using guessed type __int64 qword_2CD00;

//----- (0000000000021150) ----------------------------------------------------
__int64 sub_21150()
{
  void **v0; // rcx
  unsigned int v2; // ebx
  __int64 v3; // rdx
  unsigned int v4; // eax
  PVOID v5; // rdi
  __int64 v6; // rax
  int v7; // esi
  int v8; // eax
  int v9; // er11
  char v10; // al
  __int64 v11; // rax
  __int64 v12; // r8
  int v13; // eax
  __int64 v14; // rdx
  __int64 v15; // [rsp+20h] [rbp-28h]
  __int64 v16; // [rsp+50h] [rbp+8h] BYREF

  v0 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x58u, (__int64)&unk_28B98);
    v0 = (void **)off_2A148;
  }
  if ( !byte_2CCF3 )
  {
    if ( v0 != &off_2A148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 2u )
      sub_11008((__int64)v0[19], 0x59u, (__int64)&unk_28B98);
    return 260i64;
  }
  if ( v0 != &off_2A148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 4u )
  {
    sub_12954((__int64)v0[19], 0x5Au, (__int64)&unk_28B98, qword_2CCD0);
    v0 = (void **)off_2A148;
  }
  v2 = 0;
  if ( qword_2CCD0 )
  {
    v3 = *(_QWORD *)(qword_2CCD0 + 1112);
    if ( v3 )
    {
      v4 = (*(__int64 (__fastcall **)(__int64))(v3 + 88))(qword_2CCD0);
      v0 = (void **)off_2A148;
      v2 = v4;
    }
  }
  if ( v0 != &off_2A148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 4u )
  {
    sub_1D3A0((__int64)v0[19], 0x5Bu, (__int64)&unk_28B98, qword_2CCC8, v2);
    v0 = (void **)off_2A148;
  }
  v5 = qword_2CCC8;
  v6 = 0i64;
  v7 = 1796;
  v16 = 0i64;
  if ( qword_2CCC8 )
  {
    v8 = (*(__int64 (__fastcall **)(_QWORD, __int64, __int64 *))(*((_QWORD *)qword_2CCC8 + 1) + 8i64))(
           **((_QWORD **)qword_2CCC8 + 1),
           1i64,
           &v16);
    v0 = (void **)off_2A148;
    v9 = v8;
    v6 = v16;
  }
  else
  {
    v9 = 1796;
  }
  if ( !v9 )
  {
    v10 = (*(__int64 (__fastcall **)(PVOID, _QWORD))(v6 + 80))(v5, v2);
    v0 = (void **)off_2A148;
    if ( v10 )
    {
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
      {
        LODWORD(v15) = v2;
        sub_1D3A0(*((_QWORD *)off_2A148 + 19), 0x5Du, (__int64)&unk_28B98, qword_2CCC8, v15);
        v0 = (void **)off_2A148;
      }
      v11 = qword_2CCD0;
      if ( qword_2CCD0 )
      {
        v12 = *(_QWORD *)(qword_2CCD0 + 1112);
        if ( v12 )
        {
          v13 = (*(__int64 (__fastcall **)(PVOID, __int64))(v12 + 16))(qword_2CCC8, qword_2CCD0);
          v0 = (void **)off_2A148;
          v7 = v13;
          v11 = qword_2CCD0;
        }
      }
      if ( v7 )
      {
        if ( v0 != &off_2A148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 2u )
          sub_1102C((__int64)v0[19], 0x5Eu, (__int64)&unk_28B98, v7 != 0);
        return 257i64;
      }
      if ( v0 != &off_2A148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 4u )
      {
        sub_11008((__int64)v0[19], 0x5Fu, (__int64)&unk_28B98);
        v0 = (void **)off_2A148;
        v11 = qword_2CCD0;
      }
      if ( !v11 )
        goto LABEL_52;
      v14 = *(_QWORD *)(v11 + 1112);
      if ( !v14 )
        goto LABEL_52;
      (*(void (__fastcall **)(__int64))(v14 + 32))(v11);
      goto LABEL_51;
    }
  }
  if ( v0 != &off_2A148 )
  {
    if ( (*((_BYTE *)v0 + 172) & 1) == 0 || *((_BYTE *)v0 + 169) < 2u )
    {
LABEL_52:
      if ( v0 != &off_2A148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 4u )
        sub_12954((__int64)v0[19], 0x60u, (__int64)&unk_28B98, qword_2CCC8);
      goto LABEL_56;
    }
    sub_11008((__int64)v0[19], 0x5Cu, (__int64)&unk_28B98);
LABEL_51:
    v0 = (void **)off_2A148;
    goto LABEL_52;
  }
LABEL_56:
  sub_260D0(qword_2CCC8);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_1102C(*((_QWORD *)off_2A148 + 19), 0x61u, (__int64)&unk_28B98, 0);
  return 0i64;
}
// 21318: variable 'v15' is possibly undefined
// 2A148: using guessed type void *off_2A148;
// 2CCD0: using guessed type __int64 qword_2CCD0;
// 2CCF3: using guessed type char byte_2CCF3;

//----- (00000000000214B0) ----------------------------------------------------
__int64 __fastcall sub_214B0(__int64 a1, __int64 a2, __int64 a3)
{
  unsigned int v3; // esi
  void **v7; // rcx
  void (__fastcall *v9)(_QWORD, _QWORD, _QWORD, int *); // rdi
  unsigned __int16 v10; // dx
  char v11[40]; // [rsp+40h] [rbp-28h] BYREF
  int v12; // [rsp+80h] [rbp+18h] BYREF
  char v13; // [rsp+88h] [rbp+20h] BYREF

  v3 = 0;
  v12 = 0;
  v7 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 0xAu)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_1FAF0(*((_QWORD *)off_2A148 + 19), 0x84u, (__int64)&unk_28B98, a1, a2, a3);
    v7 = (void **)off_2A148;
  }
  if ( a3 )
  {
    if ( a2 )
    {
      v9 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, int *))(a2 + 8);
      if ( v9 )
      {
        if ( v7 != &off_2A148 && _bittest((const signed __int32 *)v7 + 43, 0xAu) && *((_BYTE *)v7 + 169) >= 4u )
        {
          sub_1FB44((__int64)v7[19], 134i64, (__int64)&unk_28B98, qword_2CCC8, a3, &v13, &v12);
          v7 = (void **)off_2A148;
        }
        if ( qword_2CCC8 )
        {
          (*(void (__fastcall **)(_QWORD, __int64, char *, int *, char *, _QWORD))(*((_QWORD *)qword_2CCC8 + 5) + 32i64))(
            **((_QWORD **)qword_2CCC8 + 5),
            a3,
            &v13,
            &v12,
            v11,
            0i64);
        }
        else
        {
          v3 = 1799;
          if ( v7 != &off_2A148 && _bittest((const signed __int32 *)v7 + 43, 0xAu) && *((_BYTE *)v7 + 169) >= 2u )
            sub_1102C((__int64)v7[19], 0x87u, (__int64)&unk_28B98, 1799);
        }
        v9(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), &v12);
        if ( qword_2CCC8 )
          (*(void (__fastcall **)(_QWORD, __int64))(*((_QWORD *)qword_2CCC8 + 5) + 24i64))(
            **((_QWORD **)qword_2CCC8 + 5),
            a3);
        goto LABEL_34;
      }
      if ( v7 != &off_2A148 )
      {
        if ( _bittest((const signed __int32 *)v7 + 43, 0xAu) && *((_BYTE *)v7 + 169) >= 2u )
        {
          v10 = 136;
LABEL_33:
          sub_11008((__int64)v7[19], v10, (__int64)&unk_28B98);
LABEL_34:
          v7 = (void **)off_2A148;
          goto LABEL_35;
        }
        goto LABEL_35;
      }
    }
    else if ( v7 != &off_2A148 )
    {
      if ( _bittest((const signed __int32 *)v7 + 43, 0xAu) && *((_BYTE *)v7 + 169) >= 2u )
      {
        v10 = 137;
        goto LABEL_33;
      }
LABEL_35:
      if ( v7 != &off_2A148 && _bittest((const signed __int32 *)v7 + 43, 0xAu) && *((_BYTE *)v7 + 169) >= 5u )
        sub_1102C((__int64)v7[19], 0x8Au, (__int64)&unk_28B98, v3);
      return v3;
    }
    return v3;
  }
  if ( v7 != &off_2A148 && _bittest((const signed __int32 *)v7 + 43, 0xAu) && *((_BYTE *)v7 + 169) >= 2u )
    sub_11008((__int64)v7[19], 0x85u, (__int64)&unk_28B98);
  return 3899654172i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000021708) ----------------------------------------------------
__int64 __fastcall sub_21708(unsigned int *a1)
{
  void **v2; // rcx
  __int64 result; // rax

  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x8Bu, (__int64)&unk_28B98);
    v2 = (void **)off_2A148;
  }
  qword_2CD00 = 0i64;
  qword_2CD08 = 0i64;
  qword_2CD10 = 0i64;
  qword_2CD00 = *a1;
  HIDWORD(qword_2CD00) = *((unsigned __int8 *)a1 + 4);
  qword_2CD08 = *((_QWORD *)a1 + 1);
  if ( *((_QWORD *)a1 + 2) )
  {
    qword_2CD10 = (__int64)sub_21864;
    qword_2CCF8 = (__int64 (__fastcall *)(_QWORD))*((_QWORD *)a1 + 2);
    if ( v2 != &off_2A148 )
    {
      if ( (*((_BYTE *)v2 + 172) & 1) != 0 && *((_BYTE *)v2 + 169) >= 4u )
      {
        sub_11008((__int64)v2[19], 0x8Cu, (__int64)&unk_28B98);
        v2 = (void **)off_2A148;
      }
      if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 172) & 1) != 0 && *((_BYTE *)v2 + 169) >= 5u )
        sub_1102C((__int64)v2[19], 0x8Eu, (__int64)&unk_28B98, 0);
    }
    result = 0i64;
  }
  else
  {
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 172) & 1) != 0 && *((_BYTE *)v2 + 169) >= 2u )
      sub_11008((__int64)v2[19], 0x8Du, (__int64)&unk_28B98);
    result = 264i64;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;
// 2CCF8: using guessed type __int64 (__fastcall *qword_2CCF8)(_QWORD);
// 2CD00: using guessed type __int64 qword_2CD00;
// 2CD08: using guessed type __int64 qword_2CD08;
// 2CD10: using guessed type __int64 qword_2CD10;

//----- (0000000000021864) ----------------------------------------------------
__int64 __fastcall sub_21864(__int64 a1, __int64 a2, __int64 a3)
{
  void **v4; // rcx

  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( _bittest((const signed __int32 *)off_2A148 + 43, 8u) && *((_BYTE *)off_2A148 + 169) >= 5u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x8Fu, (__int64)&unk_28B98);
      v4 = (void **)off_2A148;
    }
    if ( v4 != &off_2A148 && _bittest((const signed __int32 *)v4 + 43, 8u) && *((_BYTE *)v4 + 169) >= 4u )
    {
      sub_12954((__int64)v4[19], 0x90u, (__int64)&unk_28B98, a3);
      v4 = (void **)off_2A148;
    }
  }
  if ( qword_2CCF8 )
  {
    qword_2CCF8(a3);
    v4 = (void **)off_2A148;
  }
  if ( v4 != &off_2A148 && _bittest((const signed __int32 *)v4 + 43, 8u) && *((_BYTE *)v4 + 169) >= 5u )
    sub_1102C((__int64)v4[19], 0x91u, (__int64)&unk_28B98, 0);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;
// 2CCF8: using guessed type __int64 (__fastcall *qword_2CCF8)(_QWORD);

//----- (0000000000021950) ----------------------------------------------------
__int64 __fastcall sub_21950(__int64 a1, int a2, unsigned int a3, void *a4)
{
  unsigned int v8; // ebx
  void **v9; // rcx
  _DWORD *v11; // rdi
  __int64 v12; // r8
  int v13; // eax

  v8 = 6;
  v9 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 8u)
    && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_1D110(*((_QWORD *)off_2A148 + 19), 0x92u, (__int64)&unk_28B98, a2);
    v9 = (void **)off_2A148;
  }
  if ( !byte_2CCF3 )
  {
    if ( v9 != &off_2A148 && _bittest((const signed __int32 *)v9 + 43, 8u) && *((_BYTE *)v9 + 169) >= 2u )
      sub_11008((__int64)v9[19], 0x93u, (__int64)&unk_28B98);
    return 260i64;
  }
  v11 = *(_DWORD **)(a1 + 56);
  if ( v11 )
  {
    if ( a2 && v9 != &off_2A148 && _bittest((const signed __int32 *)v9 + 43, 8u) && *((_BYTE *)v9 + 169) >= 3u )
    {
      sub_1102C((__int64)v9[19], 0x94u, (__int64)&unk_28B98, a2);
      v9 = (void **)off_2A148;
    }
    v12 = a2 != 0 ? 0x80000000 : 0;
    if ( *v11 == 3 || *v11 == 8 )
    {
      v13 = sub_26140((__int64)qword_2CCC8, a1, v12, a3, a4);
    }
    else
    {
      if ( !qword_2CCC8 )
      {
        v13 = 1799;
        goto LABEL_24;
      }
      v13 = (*(__int64 (__fastcall **)(_QWORD, __int64, __int64, _QWORD, _QWORD))(*((_QWORD *)qword_2CCC8 + 3) + 24i64))(
              **((_QWORD **)qword_2CCC8 + 3),
              a1,
              v12,
              0i64,
              0i64);
    }
    v9 = (void **)off_2A148;
LABEL_24:
    if ( v13 )
    {
      if ( v9 != &off_2A148 && _bittest((const signed __int32 *)v9 + 43, 8u) && *((_BYTE *)v9 + 169) >= 2u )
      {
        sub_1102C((__int64)v9[19], 0x95u, (__int64)&unk_28B98, v13);
        v9 = (void **)off_2A148;
      }
      v8 = 273;
    }
    else
    {
      v8 = 0;
    }
  }
  if ( v9 != &off_2A148 && _bittest((const signed __int32 *)v9 + 43, 8u) && *((_BYTE *)v9 + 169) >= 5u )
    sub_1102C((__int64)v9[19], 0x96u, (__int64)&unk_28B98, v8);
  return v8;
}
// 2A148: using guessed type void *off_2A148;
// 2CCF3: using guessed type char byte_2CCF3;

//----- (0000000000021B4C) ----------------------------------------------------
__int64 __fastcall sub_21B4C(__int64 a1, __int64 a2, __int64 a3)
{
  void **v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, _QWORD, __int64, unsigned int *); // rax
  unsigned int v8; // ebx
  unsigned int v9; // eax
  unsigned __int16 v11; // dx
  unsigned int v12; // [rsp+58h] [rbp+20h] BYREF

  v12 = 3;
  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( _bittest((const signed __int32 *)off_2A148 + 43, 0xAu) && *((_BYTE *)off_2A148 + 169) >= 5u )
    {
      sub_1FAF0(*((_QWORD *)off_2A148 + 19), 0x97u, (__int64)&unk_28B98, a1, a2, a3);
      v6 = (void **)off_2A148;
    }
    if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 4u )
    {
      sub_1102C((__int64)v6[19], 0x98u, (__int64)&unk_28B98, *(_DWORD *)a3);
      v6 = (void **)off_2A148;
    }
  }
  if ( !byte_2CCF4 )
  {
    if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 3u )
      sub_11008((__int64)v6[19], 0x99u, (__int64)&unk_28B98);
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 != &off_2A148 )
    {
      if ( !_bittest((const signed __int32 *)v6 + 43, 0xAu) || *((_BYTE *)v6 + 169) < 2u )
        goto LABEL_37;
      v11 = 157;
LABEL_36:
      sub_11008((__int64)v6[19], v11, (__int64)&unk_28B98);
      v6 = (void **)off_2A148;
      goto LABEL_37;
    }
    return 0i64;
  }
  v7 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, __int64, unsigned int *))(a2 + 8);
  if ( !v7 )
  {
    if ( v6 != &off_2A148 )
    {
      if ( !_bittest((const signed __int32 *)v6 + 43, 0xAu) || *((_BYTE *)v6 + 169) < 2u )
        goto LABEL_37;
      v11 = 156;
      goto LABEL_36;
    }
    return 0i64;
  }
  v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), a3, &v12);
  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 0xAu)
    && *((_BYTE *)off_2A148 + 169) >= 4u )
  {
    sub_1102C(*((_QWORD *)off_2A148 + 19), 0x9Au, (__int64)&unk_28B98, v12);
    v6 = (void **)off_2A148;
  }
  if ( !qword_2CCC8 )
  {
    v8 = 1799;
    goto LABEL_23;
  }
  v9 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, _QWORD))(*((_QWORD *)qword_2CCC8 + 3) + 24i64))(
         **((_QWORD **)qword_2CCC8 + 3),
         a3,
         v12,
         0i64,
         0i64);
  v6 = (void **)off_2A148;
  v8 = v9;
  if ( !v9 )
  {
LABEL_37:
    if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 5u )
      sub_1102C((__int64)v6[19], 0x9Eu, (__int64)&unk_28B98, 0);
    return 0i64;
  }
LABEL_23:
  if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 2u )
    sub_1102C((__int64)v6[19], 0x9Bu, (__int64)&unk_28B98, v8);
  return v8;
}
// 2A148: using guessed type void *off_2A148;
// 2CCF4: using guessed type char byte_2CCF4;

//----- (0000000000021DC0) ----------------------------------------------------
__int64 __fastcall sub_21DC0(__int64 a1, __int64 a2, __int64 a3)
{
  void **v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, _QWORD, unsigned int *, PVOID *, __int64 *); // rax
  void **v8; // rcx
  int v9; // eax
  unsigned int v10; // ebx
  unsigned __int16 v12; // dx
  __int64 v13; // [rsp+20h] [rbp-28h]
  __int64 Tag; // [rsp+30h] [rbp-18h] BYREF
  PVOID P[2]; // [rsp+38h] [rbp-10h] BYREF
  unsigned int v16; // [rsp+68h] [rbp+20h] BYREF

  P[0] = 0i64;
  v16 = 0;
  LODWORD(Tag) = 0;
  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( _bittest((const signed __int32 *)off_2A148 + 43, 0xAu) && *((_BYTE *)off_2A148 + 169) >= 5u )
    {
      sub_1FAF0(*((_QWORD *)off_2A148 + 19), 0x9Fu, (__int64)&unk_28B98, a1, a2, a3, Tag);
      v6 = (void **)off_2A148;
    }
    if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 4u )
    {
      sub_1102C((__int64)v6[19], 0xA0u, (__int64)&unk_28B98, *(_DWORD *)a3);
      v6 = (void **)off_2A148;
    }
  }
  if ( !byte_2CCF4 )
  {
    if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 3u )
      sub_11008((__int64)v6[19], 0xA1u, (__int64)&unk_28B98);
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 == &off_2A148 )
      return 0i64;
    if ( !_bittest((const signed __int32 *)v6 + 43, 0xAu) || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_46;
    v12 = 167;
    goto LABEL_44;
  }
  v7 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, unsigned int *, PVOID *, __int64 *))(a2 + 16);
  if ( !v7 )
  {
    if ( v6 == &off_2A148 )
      return 0i64;
    if ( !_bittest((const signed __int32 *)v6 + 43, 0xAu) || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_46;
    v12 = 166;
LABEL_44:
    sub_11008((__int64)v6[19], v12, (__int64)&unk_28B98);
    goto LABEL_45;
  }
  v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), &v16, P, &Tag);
  v8 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( _bittest((const signed __int32 *)off_2A148 + 43, 0xAu) && *((_BYTE *)off_2A148 + 169) >= 4u )
    {
      sub_1102C(*((_QWORD *)off_2A148 + 19), 0xA2u, (__int64)&unk_28B98, 5);
      v8 = (void **)off_2A148;
    }
    if ( v8 != &off_2A148 && _bittest((const signed __int32 *)v8 + 43, 0xAu) && *((_BYTE *)v8 + 169) >= 4u )
      sub_1102C((__int64)v8[19], 0xA3u, (__int64)&unk_28B98, v16);
  }
  v9 = sub_26140((__int64)qword_2CCC8, a3, 5i64, v16, P[0]);
  v10 = v9;
  if ( !v9 )
  {
    if ( !P[0] || !v16 )
      goto LABEL_45;
    LODWORD(v13) = 0;
    sub_1A57C(P[0], Tag);
    v6 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 )
    {
      if ( _bittest((const signed __int32 *)off_2A148 + 43, 0xAu) && *((_BYTE *)off_2A148 + 169) >= 4u )
      {
        sub_12954(*((_QWORD *)off_2A148 + 19), 0xA5u, (__int64)&unk_28B98, P[0], v13);
LABEL_45:
        v6 = (void **)off_2A148;
      }
LABEL_46:
      if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 5u )
        sub_1102C((__int64)v6[19], 0xA8u, (__int64)&unk_28B98, 0);
    }
    return 0i64;
  }
  if ( off_2A148 != &off_2A148
    && _bittest((const signed __int32 *)off_2A148 + 43, 0xAu)
    && *((_BYTE *)off_2A148 + 169) >= 2u )
  {
    sub_1102C(*((_QWORD *)off_2A148 + 19), 0xA4u, (__int64)&unk_28B98, v9);
  }
  return v10;
}
// 2202F: variable 'v13' is possibly undefined
// 2A148: using guessed type void *off_2A148;
// 2CCF4: using guessed type char byte_2CCF4;

//----- (00000000000220D8) ----------------------------------------------------
__int64 __fastcall sub_220D8(__int64 a1, __int64 a2, __int64 a3)
{
  void **v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, __int64, __int64); // rax
  unsigned __int16 v8; // dx

  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    {
      sub_1FAF0(*((_QWORD *)off_2A148 + 19), 0xF7u, (__int64)&unk_28B98, a1, a2, a3);
      v6 = (void **)off_2A148;
    }
    if ( v6 != &off_2A148 && (*((_BYTE *)v6 + 172) & 1) != 0 && *((_BYTE *)v6 + 169) >= 4u )
    {
      sub_1102C((__int64)v6[19], 0xF8u, (__int64)&unk_28B98, *(_DWORD *)a3);
      v6 = (void **)off_2A148;
    }
  }
  if ( !byte_2CCF4 )
  {
    if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 3u )
      sub_11008((__int64)v6[19], 0xF9u, (__int64)&unk_28B98);
    return 0i64;
  }
  if ( a2 )
  {
    v7 = *(void (__fastcall **)(_QWORD, _QWORD, __int64, __int64))(a2 + 24);
    if ( v7 )
    {
      v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), 1024i64, a1);
      v6 = (void **)off_2A148;
      if ( off_2A148 == &off_2A148 )
        return 0i64;
      if ( (*((_BYTE *)off_2A148 + 172) & 1) == 0 || *((_BYTE *)off_2A148 + 169) < 4u )
        goto LABEL_30;
      sub_1102C(*((_QWORD *)off_2A148 + 19), 0xFAu, (__int64)&unk_28B98, 3);
      goto LABEL_29;
    }
    if ( v6 == &off_2A148 )
      return 0i64;
    if ( (*((_BYTE *)v6 + 172) & 1) == 0 || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_30;
    v8 = 251;
  }
  else
  {
    if ( v6 == &off_2A148 )
      return 0i64;
    if ( (*((_BYTE *)v6 + 172) & 1) == 0 || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_30;
    v8 = 252;
  }
  sub_11008((__int64)v6[19], v8, (__int64)&unk_28B98);
LABEL_29:
  v6 = (void **)off_2A148;
LABEL_30:
  if ( v6 != &off_2A148 && (*((_BYTE *)v6 + 172) & 1) != 0 && *((_BYTE *)v6 + 169) >= 5u )
    sub_1102C((__int64)v6[19], 0xFDu, (__int64)&unk_28B98, 0);
  return 0i64;
}
// 221DB: variable 'a1' is possibly undefined
// 2A148: using guessed type void *off_2A148;
// 2CCF4: using guessed type char byte_2CCF4;

//----- (00000000000222B8) ----------------------------------------------------
__int64 __fastcall sub_222B8(__int64 a1, __int64 a2, __int64 a3)
{
  void **v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, _QWORD, __int64); // rax
  unsigned __int16 v8; // dx

  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    {
      sub_1FAF0(*((_QWORD *)off_2A148 + 19), 0x114u, (__int64)&unk_28B98, a1, a2, a3);
      v6 = (void **)off_2A148;
    }
    if ( v6 != &off_2A148 && (*((_BYTE *)v6 + 172) & 1) != 0 && *((_BYTE *)v6 + 169) >= 4u )
    {
      sub_1102C((__int64)v6[19], 0x115u, (__int64)&unk_28B98, *(_DWORD *)a3);
      v6 = (void **)off_2A148;
    }
  }
  if ( !byte_2CCF4 )
  {
    if ( v6 != &off_2A148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 3u )
      sub_11008((__int64)v6[19], 0x116u, (__int64)&unk_28B98);
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 == &off_2A148 )
      return 0i64;
    if ( (*((_BYTE *)v6 + 172) & 1) == 0 || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_27;
    v8 = 280;
    goto LABEL_25;
  }
  v7 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, __int64))(a2 + 32);
  if ( !v7 )
  {
    if ( v6 == &off_2A148 )
      return 0i64;
    if ( (*((_BYTE *)v6 + 172) & 1) == 0 || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_27;
    v8 = 279;
LABEL_25:
    sub_11008((__int64)v6[19], v8, (__int64)&unk_28B98);
    goto LABEL_26;
  }
  v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), a1);
LABEL_26:
  v6 = (void **)off_2A148;
LABEL_27:
  if ( v6 != &off_2A148 && (*((_BYTE *)v6 + 172) & 1) != 0 && *((_BYTE *)v6 + 169) >= 5u )
    sub_1102C((__int64)v6[19], 0x119u, (__int64)&unk_28B98, 0);
  return 0i64;
}
// 223B9: variable 'a1' is possibly undefined
// 2A148: using guessed type void *off_2A148;
// 2CCF4: using guessed type char byte_2CCF4;

//----- (000000000002245C) ----------------------------------------------------
__int64 sub_2245C()
{
  unsigned int v0; // ebx
  void **v1; // rcx
  int v2; // eax

  v0 = 0;
  v1 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x11Au, (__int64)&unk_28B98);
    v1 = (void **)off_2A148;
  }
  if ( qword_2CD18 )
    goto LABEL_12;
  v2 = sub_1FFE0(9u, (__int64)&qword_2CD18);
  v0 = v2;
  if ( !v2 )
    goto LABEL_11;
  v1 = (void **)off_2A148;
  if ( off_2A148 == &off_2A148 )
    return v0;
  if ( (*((_BYTE *)off_2A148 + 172) & 1) != 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
  {
    sub_1102C(*((_QWORD *)off_2A148 + 19), 0x11Bu, (__int64)&unk_28B98, v2);
LABEL_11:
    v1 = (void **)off_2A148;
  }
LABEL_12:
  if ( v1 != &off_2A148 && (*((_BYTE *)v1 + 172) & 1) != 0 && *((_BYTE *)v1 + 169) >= 5u )
    sub_1102C((__int64)v1[19], 0x11Cu, (__int64)&unk_28B98, v0);
  return v0;
}
// 2A148: using guessed type void *off_2A148;
// 2CD18: using guessed type __int64 qword_2CD18;

//----- (0000000000022554) ----------------------------------------------------
__int64 __fastcall sub_22554(__int64 a1, _DWORD *a2)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 0x20) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_13878(*((_QWORD *)off_2A148 + 19), 0x4Bu, (__int64)&unk_28B88, a1, a2);
  *a2 = *(_DWORD *)(a1 + 12);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 0x20) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x4Cu, (__int64)&unk_28B88);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000022604) ----------------------------------------------------
__int64 __fastcall sub_22604(__int64 a1, __m128i *a2)
{
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 0x20) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_13878(*((_QWORD *)off_2A148 + 19), 0x6Eu, (__int64)&unk_28B88, a1, a2);
  *a2 = _mm_loadu_si128((const __m128i *)(a1 + 8));
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 0x20) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x6Fu, (__int64)&unk_28B88);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000226B8) ----------------------------------------------------
__int64 sub_226B8(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_2A1B8(a1, 43i64, &unk_28B00, 103i64, (__int64 *)va);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002271C) ----------------------------------------------------
__int64 __fastcall sub_2271C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_2A1B8(a1, 43i64, &unk_28B00, a2, &v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000022778) ----------------------------------------------------
__int64 __fastcall sub_22778(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_2A1B8(a1, 43i64, &unk_28B00, 189i64, &v5);
}
// 2A1B8: using guessed type __int64 (__fastcall *qword_2A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000227E8) ----------------------------------------------------
__int64 __fastcall sub_227E8(int a1, _QWORD *a2)
{
  void **v4; // rcx
  int v6; // ebx

  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xAu, (__int64)&unk_28B00);
    v4 = (void **)off_2A148;
  }
  if ( a2 )
  {
    if ( a1 )
    {
      v6 = a1 - 1;
      if ( !v6 )
      {
        if ( v4 != &off_2A148 )
        {
          if ( *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
          {
            sub_11008((__int64)v4[19], 0xDu, (__int64)&unk_28B00);
            v4 = (void **)off_2A148;
          }
          if ( v4 != &off_2A148 && (*((_BYTE *)v4 + 108) & 0x20) != 0 && *((_BYTE *)v4 + 105) >= 4u )
            sub_1A478((__int64)v4[11], 0x1Au);
        }
        sub_1BBBC(a2);
        goto LABEL_32;
      }
      if ( v6 == 1 )
      {
        if ( v4 != &off_2A148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
          sub_11008((__int64)v4[19], 0xEu, (__int64)&unk_28B00);
        sub_1B21C((__int64)a2);
        goto LABEL_32;
      }
    }
    else
    {
      if ( v4 == &off_2A148 )
        return 0i64;
      if ( *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
      {
        sub_11008((__int64)v4[19], 0xCu, (__int64)&unk_28B00);
LABEL_32:
        v4 = (void **)off_2A148;
        goto LABEL_33;
      }
    }
LABEL_33:
    if ( v4 != &off_2A148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
      sub_11008((__int64)v4[19], 0xFu, (__int64)&unk_28B00);
    return 0i64;
  }
  if ( v4 != &off_2A148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 2u )
    sub_11008((__int64)v4[19], 0xBu, (__int64)&unk_28B00);
  return 3i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000229CC) ----------------------------------------------------
__int64 __fastcall sub_229CC(int a1, __int64 a2)
{
  void **v4; // rcx
  int v6; // ebx
  unsigned __int16 v7; // dx

  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x10u, (__int64)&unk_28B00);
    v4 = (void **)off_2A148;
  }
  if ( a2 )
  {
    if ( a1 )
    {
      v6 = a1 - 1;
      if ( v6 )
      {
        if ( v6 != 1 )
          goto LABEL_27;
        if ( v4 != &off_2A148 )
        {
          if ( *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
          {
            v7 = 20;
LABEL_26:
            sub_11008((__int64)v4[19], v7, (__int64)&unk_28B00);
            v4 = (void **)off_2A148;
            goto LABEL_27;
          }
          goto LABEL_27;
        }
      }
      else if ( v4 != &off_2A148 )
      {
        if ( *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
        {
          v7 = 19;
          goto LABEL_26;
        }
LABEL_27:
        if ( v4 != &off_2A148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
          sub_11008((__int64)v4[19], 0x15u, (__int64)&unk_28B00);
        return 0i64;
      }
    }
    else if ( v4 != &off_2A148 )
    {
      if ( *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
      {
        v7 = 18;
        goto LABEL_26;
      }
      goto LABEL_27;
    }
    return 0i64;
  }
  if ( v4 != &off_2A148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 2u )
    sub_11008((__int64)v4[19], 0x11u, (__int64)&unk_28B00);
  return 3i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000022B2C) ----------------------------------------------------
__int64 __fastcall sub_22B2C(int a1, struct _FAST_MUTEX *a2, KIRQL *a3)
{
  _QWORD *v5; // rcx
  unsigned __int16 v6; // dx
  int v8; // ecx

  if ( !a2 )
  {
    v5 = off_2A148;
    if ( off_2A148 == &off_2A148 || *((char *)off_2A148 + 172) >= 0 || *((_BYTE *)off_2A148 + 169) < 2u )
      return 3i64;
    v6 = 22;
LABEL_6:
    sub_11008(v5[19], v6, (__int64)&unk_28B00);
    return 3i64;
  }
  if ( !a3 )
  {
    v5 = off_2A148;
    if ( off_2A148 == &off_2A148 || *((char *)off_2A148 + 172) >= 0 || *((_BYTE *)off_2A148 + 169) < 2u )
      return 3i64;
    v6 = 23;
    goto LABEL_6;
  }
  v8 = a1 - 1;
  if ( v8 )
  {
    if ( v8 == 1 )
      sub_1B2FC(a2);
  }
  else
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
      sub_1A478(*((_QWORD *)off_2A148 + 11), 0x1Bu);
    sub_1BC40((PKSPIN_LOCK)a2, a3);
  }
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000022C3C) ----------------------------------------------------
__int64 __fastcall sub_22C3C(int a1, struct _FAST_MUTEX *a2, KIRQL a3)
{
  __int64 result; // rax
  int v6; // ecx

  if ( a2 )
  {
    v6 = a1 - 1;
    if ( v6 )
    {
      if ( v6 == 1 )
        sub_1B3C8(a2);
    }
    else
    {
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 108) & 0x20) != 0 && *((_BYTE *)off_2A148 + 105) >= 4u )
        sub_1A478(*((_QWORD *)off_2A148 + 11), 0x1Cu);
      sub_1BCF8((PKSPIN_LOCK)a2, a3);
    }
    result = 0i64;
  }
  else
  {
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x18u, (__int64)&unk_28B00);
    result = 3i64;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000022D18) ----------------------------------------------------
__int64 __fastcall sub_22D18(__int64 a1, __int64 a2, char a3)
{
  void **v6; // rcx
  unsigned __int16 v7; // dx

  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x19u, (__int64)&unk_28B00);
    v6 = (void **)off_2A148;
  }
  if ( !a1 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 26;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_28B00);
    return 3i64;
  }
  if ( !a2 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 27;
    goto LABEL_10;
  }
  *(_DWORD *)(a2 + 16) = 0;
  *(_QWORD *)(a2 + 8) = a2;
  *(_QWORD *)a2 = a2;
  if ( a3 )
    sub_227E8(*(_DWORD *)(a1 + 24), (_QWORD *)(a2 + 24));
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x1Cu, (__int64)&unk_28B00);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000022E44) ----------------------------------------------------
__int64 __fastcall sub_22E44(__int64 a1, __int64 a2, char a3)
{
  void **v6; // rcx
  unsigned __int16 v7; // dx

  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x1Du, (__int64)&unk_28B00);
    v6 = (void **)off_2A148;
  }
  if ( !a1 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 30;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_28B00);
    return 3i64;
  }
  if ( !a2 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 31;
    goto LABEL_10;
  }
  if ( a3 )
  {
    sub_229CC(*(_DWORD *)(a1 + 24), a2 + 24);
    v6 = (void **)off_2A148;
  }
  if ( v6 != &off_2A148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 5u )
    sub_11008((__int64)v6[19], 0x20u, (__int64)&unk_28B00);
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000022F68) ----------------------------------------------------
_DWORD *__fastcall sub_22F68(__int64 a1, __int64 a2, __int64 a3, ULONG a4, __int64 a5, __int64 a6, __int64 a7, __int64 a8, __int64 a9, __int64 a10, _DWORD *a11)
{
  int v12; // eax
  int v13; // ebp
  _DWORD *v15; // rbx
  char *v16; // rax
  __int64 v17; // rdi
  void **v18; // rcx

  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x21u, (__int64)&unk_28B00);
  *a11 = 0;
  v12 = sub_25DD0();
  v13 = v12;
  if ( !v12 )
  {
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
      sub_1102C(*((_QWORD *)off_2A148 + 19), 0x23u, (__int64)&unk_28B00, 8);
    *a11 = 3;
    return 0i64;
  }
  v15 = sub_1A4F8(2, 16 * (5 * v12 + 5), a4);
  if ( !v15 )
  {
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x25u, (__int64)&unk_28B00);
LABEL_17:
    *a11 = 2;
    return 0i64;
  }
  v16 = sub_1A778(1i64, 0x38u, a4);
  *((_QWORD *)v15 + 9) = v16;
  if ( !v16 )
  {
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x26u, (__int64)&unk_28B00);
    sub_1A57C(v15, a4);
    goto LABEL_17;
  }
  *v15 = 0;
  v15[2] = 0;
  v15[6] = 2;
  v17 = 0i64;
  *((_QWORD *)v15 + 2) = a5;
  v15[3] = a4;
  for ( v15[1] = v13; (unsigned int)v17 < v15[1]; v17 = (unsigned int)(v17 + 1) )
    sub_22D18((__int64)v15, (__int64)&v15[20 * v17 + 20], 1);
  *((_QWORD *)v15 + 5) = 0i64;
  *((_QWORD *)v15 + 6) = 0i64;
  *((_QWORD *)v15 + 7) = a9;
  *((_QWORD *)v15 + 8) = a10;
  v18 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
    {
      sub_2271C(*((_QWORD *)off_2A148 + 19), 0x27u, (__int64)&unk_28B00, v15[1]);
      v18 = (void **)off_2A148;
    }
    if ( v18 != &off_2A148 && *((char *)v18 + 172) < 0 && *((_BYTE *)v18 + 169) >= 5u )
      sub_11008((__int64)v18[19], 0x28u, (__int64)&unk_28B00);
  }
  return v15;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000231F8) ----------------------------------------------------
__int64 __fastcall sub_231F8(ULONG_PTR BugCheckParameter2)
{
  void **v2; // rcx
  __int64 v4; // rsi
  _QWORD **v5; // r12
  int v6; // ecx
  struct _FAST_MUTEX *v7; // r14
  _QWORD *v8; // rbp
  ULONG_PTR v9; // r13
  void **v10; // rcx
  ULONG_PTR v11; // rbx
  int v12; // eax
  int i; // ebx
  __int64 j; // rbx
  void **v15; // rcx
  __int64 v16; // [rsp+20h] [rbp-98h]
  __int64 v17; // [rsp+30h] [rbp-88h] BYREF
  _BYTE v18[72]; // [rsp+38h] [rbp-80h] BYREF
  KIRQL v19; // [rsp+C0h] [rbp+8h] BYREF
  unsigned int v20; // [rsp+D0h] [rbp+18h] BYREF
  union _LARGE_INTEGER Interval; // [rsp+D8h] [rbp+20h] BYREF

  v20 = 0;
  v17 = 0i64;
  memset(v18, 0, sizeof(v18));
  v2 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 0x80) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x36u, (__int64)&unk_28B00);
    v2 = (void **)off_2A148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 172) & 0x80) != 0 && *((_BYTE *)v2 + 169) >= 2u )
      sub_11008((__int64)v2[19], 0x37u, (__int64)&unk_28B00);
    return 3i64;
  }
  if ( v2 != &off_2A148 && (*((_BYTE *)v2 + 172) & 0x80) != 0 && *((_BYTE *)v2 + 169) >= 4u )
    sub_2271C((__int64)v2[19], 0x38u, (__int64)&unk_28B00, *(_DWORD *)(BugCheckParameter2 + 4));
  _InterlockedAdd((volatile signed __int32 *)(BugCheckParameter2 + 28), 1u);
  v4 = 0i64;
  if ( !*(_DWORD *)(BugCheckParameter2 + 4) )
    goto LABEL_38;
  v5 = (_QWORD **)(BugCheckParameter2 + 80);
  do
  {
    v6 = *(_DWORD *)(BugCheckParameter2 + 24);
    v7 = (struct _FAST_MUTEX *)(BugCheckParameter2 + 80 * v4 + 104);
    Interval.QuadPart = (LONGLONG)v7;
    sub_22B2C(v6, v7, &v19);
    v8 = *v5;
    v9 = BugCheckParameter2 + 80 * v4 + 80;
    if ( *v5 == (_QWORD *)v9 )
      goto LABEL_37;
    v10 = (void **)off_2A148;
    do
    {
      v11 = (ULONG_PTR)v8;
      v8 = (_QWORD *)*v8;
      if ( *(_BYTE *)(v11 + 44) )
      {
        if ( v10 != &off_2A148 && *((char *)v10 + 172) < 0 && *((_BYTE *)v10 + 169) >= 4u )
        {
          LODWORD(v16) = *(_DWORD *)(v11 + 40);
          sub_1D3A0((__int64)v10[19], 0x39u, (__int64)&unk_28B00, *(_QWORD *)(v11 + 16), v16);
LABEL_34:
          v10 = (void **)off_2A148;
          continue;
        }
      }
      else
      {
        if ( !sub_25530((_BYTE *)BugCheckParameter2, &v20) )
          v20 = sub_25268(BugCheckParameter2, v11, 1);
        if ( *(_DWORD *)(v11 + 40) )
        {
          *(_BYTE *)(v11 + 44) = 1;
          goto LABEL_34;
        }
        v20 = sub_23BF0(BugCheckParameter2, v4, (__int64 *)v11);
        if ( !v20 )
        {
          sub_23DEC(BugCheckParameter2, (__int64)&v17, v11);
          goto LABEL_34;
        }
        v10 = (void **)off_2A148;
        if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 3u )
        {
          sub_11008(*((_QWORD *)off_2A148 + 19), 0x3Au, (__int64)&unk_28B00);
          goto LABEL_34;
        }
      }
    }
    while ( v8 != (_QWORD *)v9 );
    v7 = (struct _FAST_MUTEX *)Interval.QuadPart;
LABEL_37:
    sub_22C3C(*(_DWORD *)(BugCheckParameter2 + 24), v7, v19);
    v4 = (unsigned int)(v4 + 1);
    v5 += 10;
  }
  while ( (unsigned int)v4 < *(_DWORD *)(BugCheckParameter2 + 4) );
LABEL_38:
  sub_23F6C(BugCheckParameter2, (__int64)&v17);
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 0x80) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x3Bu, (__int64)&unk_28B00);
  v12 = sub_2419C(BugCheckParameter2, &v20);
  if ( v12 )
  {
    Interval.QuadPart = -5000000i64;
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 0x80) != 0 && *((_BYTE *)off_2A148 + 169) >= 3u )
      sub_1102C(*((_QWORD *)off_2A148 + 19), 0x3Cu, (__int64)&unk_28B00, v12);
    for ( i = 0; i < 10; ++i )
    {
      if ( !(unsigned int)sub_2419C(BugCheckParameter2, &v20) )
        break;
      if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 0x80) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
        sub_1102C(*((_QWORD *)off_2A148 + 19), 0x3Du, (__int64)&unk_28B00, i);
      KeDelayExecutionThread(0, 0, &Interval);
    }
  }
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 0x80) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x3Eu, (__int64)&unk_28B00);
  for ( j = 0i64; (unsigned int)j < *(_DWORD *)(BugCheckParameter2 + 4); j = (unsigned int)(j + 1) )
    sub_22E44(BugCheckParameter2, BugCheckParameter2 + 16 * (5 * j + 5), 1);
  sub_1A930(*(PVOID *)(BugCheckParameter2 + 72));
  sub_1A57C((PVOID)BugCheckParameter2, *(_DWORD *)(BugCheckParameter2 + 12));
  v15 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 )
  {
    if ( (*((_BYTE *)off_2A148 + 172) & 0x80) != 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
    {
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x3Fu, (__int64)&unk_28B00);
      v15 = (void **)off_2A148;
    }
    if ( v15 != &off_2A148 && (*((_BYTE *)v15 + 172) & 0x80) != 0 && *((_BYTE *)v15 + 169) >= 5u )
      sub_11008((__int64)v15[19], 0x40u, (__int64)&unk_28B00);
  }
  return v20;
}
// 23392: variable 'v16' is possibly undefined
// 2A148: using guessed type void *off_2A148;

//----- (0000000000023684) ----------------------------------------------------
__int64 __fastcall sub_23684(__int64 a1)
{
  ULONG_PTR v1; // rdi
  unsigned int v2; // esi
  void **v3; // rcx
  __int64 result; // rax
  __int64 v5; // rbp
  _QWORD **v6; // r13
  int v7; // ecx
  struct _FAST_MUTEX *v8; // r15
  _QWORD *v9; // r12
  __int64 v10; // r14
  ULONG_PTR v11; // rbx
  void **v12; // rcx
  __int64 v13; // [rsp+20h] [rbp-98h]
  __int64 v14; // [rsp+30h] [rbp-88h] BYREF
  _BYTE v15[72]; // [rsp+38h] [rbp-80h] BYREF
  __int64 v16; // [rsp+C0h] [rbp+8h] BYREF
  unsigned int v17; // [rsp+D0h] [rbp+18h] BYREF
  struct _FAST_MUTEX *v18; // [rsp+D8h] [rbp+20h]

  v16 = a1;
  v1 = qword_2CD28;
  v2 = 0;
  v14 = 0i64;
  v17 = 0;
  memset(v15, 0, sizeof(v15));
  v3 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 0x80) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x4Bu, (__int64)&unk_28B00);
    v3 = (void **)off_2A148;
  }
  if ( v1 )
  {
    if ( v3 != &off_2A148 && (*((_BYTE *)v3 + 172) & 0x80) != 0 && *((_BYTE *)v3 + 169) >= 4u )
      sub_2271C((__int64)v3[19], 0x4Du, (__int64)&unk_28B00, *(_DWORD *)(v1 + 4));
    v5 = 0i64;
    if ( *(_DWORD *)(v1 + 4) )
    {
      v6 = (_QWORD **)(v1 + 80);
      do
      {
        v7 = *(_DWORD *)(v1 + 24);
        v8 = (struct _FAST_MUTEX *)(80 * v5 + v1 + 104);
        v18 = v8;
        sub_22B2C(v7, v8, (KIRQL *)&v16);
        v9 = *v6;
        v10 = 80 * v5 + v1 + 80;
        if ( *v6 != (_QWORD *)v10 )
        {
          do
          {
            v11 = (ULONG_PTR)v9;
            v9 = (_QWORD *)*v9;
            if ( *(_BYTE *)(v11 + 44) )
            {
              if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
              {
                LODWORD(v13) = *(_DWORD *)(v11 + 40);
                sub_1D3A0(*((_QWORD *)off_2A148 + 19), 0x4Eu, (__int64)&unk_28B00, *(_QWORD *)(v11 + 16), v13);
              }
            }
            else
            {
              if ( sub_25530((_BYTE *)v1, &v17) )
              {
                v2 = v17;
              }
              else
              {
                v2 = sub_25268(v1, v11, 1);
                v17 = v2;
              }
              if ( *(_DWORD *)(v11 + 40) )
              {
                *(_BYTE *)(v11 + 44) = 1;
              }
              else
              {
                v2 = sub_23BF0(v1, v5, (__int64 *)v11);
                v17 = v2;
                if ( !v2 )
                  sub_23DEC(v1, (__int64)&v14, v11);
              }
            }
          }
          while ( v9 != (_QWORD *)v10 );
          v8 = v18;
        }
        sub_22C3C(*(_DWORD *)(v1 + 24), v8, v16);
        v5 = (unsigned int)(v5 + 1);
        v6 += 10;
      }
      while ( (unsigned int)v5 < *(_DWORD *)(v1 + 4) );
    }
    sub_23F6C(v1, (__int64)&v14);
    v12 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 )
    {
      if ( (*((_BYTE *)off_2A148 + 172) & 0x80) != 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
      {
        sub_11008(*((_QWORD *)off_2A148 + 19), 0x4Fu, (__int64)&unk_28B00);
        v12 = (void **)off_2A148;
      }
      if ( v12 != &off_2A148 && (*((_BYTE *)v12 + 172) & 0x80) != 0 && *((_BYTE *)v12 + 169) >= 5u )
        sub_11008((__int64)v12[19], 0x50u, (__int64)&unk_28B00);
    }
    result = v2;
  }
  else
  {
    if ( v3 != &off_2A148 && (*((_BYTE *)v3 + 172) & 0x80) != 0 && *((_BYTE *)v3 + 169) >= 2u )
      sub_11008((__int64)v3[19], 0x4Cu, (__int64)&unk_28B00);
    result = 3i64;
  }
  return result;
}
// 2381F: variable 'v13' is possibly undefined
// 2A148: using guessed type void *off_2A148;

//----- (000000000002396C) ----------------------------------------------------
unsigned __int64 __fastcall sub_2396C(__int64 a1, unsigned __int64 a2, _DWORD *a3)
{
  void **v6; // rcx
  unsigned __int64 result; // rax

  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x5Au, (__int64)&unk_28B00);
    v6 = (void **)off_2A148;
  }
  *a3 = 0;
  if ( a1 )
  {
    if ( v6 != &off_2A148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 5u )
      sub_11008((__int64)v6[19], 0x5Cu, (__int64)&unk_28B00);
    result = a2 % *(unsigned int *)(a1 + 4);
  }
  else
  {
    if ( v6 != &off_2A148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 2u )
      sub_11008((__int64)v6[19], 0x5Bu, (__int64)&unk_28B00);
    *a3 = 3;
    result = 0xFFFFFFFFi64;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000023A68) ----------------------------------------------------
_DWORD *__fastcall sub_23A68(__int64 a1, __int64 a2, _DWORD *a3)
{
  void **v6; // rcx
  unsigned __int16 v7; // dx
  _DWORD *v9; // rax
  _DWORD *v10; // rdi
  __int64 v11; // r11

  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x5Du, (__int64)&unk_28B00);
    v6 = (void **)off_2A148;
  }
  *a3 = 0;
  if ( !a1 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_11;
    v7 = 94;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_28B00);
LABEL_11:
    *a3 = 3;
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_11;
    v7 = 95;
    goto LABEL_10;
  }
  v9 = sub_1AA50(*(_QWORD *)(a1 + 72));
  v10 = v9;
  if ( !v9 )
  {
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x60u, (__int64)&unk_28B00);
    *a3 = 2;
    return 0i64;
  }
  memset(v9, 0, 0x38ui64);
  v11 = *(_QWORD *)(a1 + 16);
  *((_QWORD *)v10 + 4) = a2;
  *((_QWORD *)v10 + 3) = v11;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x61u, (__int64)&unk_28B00);
  return v10;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000023BF0) ----------------------------------------------------
__int64 __fastcall sub_23BF0(__int64 a1, unsigned int a2, __int64 *a3)
{
  __int64 v4; // rsi
  void **v6; // rcx
  unsigned __int16 v7; // dx
  __int64 result; // rax
  _QWORD *v9; // rax
  __int64 v10; // rcx
  signed __int32 v11; // eax
  void **v12; // rcx
  __int64 v13; // [rsp+20h] [rbp-28h]
  unsigned int v14; // [rsp+50h] [rbp+8h] BYREF

  v14 = 0;
  v4 = a2;
  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x62u, (__int64)&unk_28B00);
    v6 = (void **)off_2A148;
  }
  if ( !a1 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 99;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_28B00);
    return 3i64;
  }
  if ( !a3 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 100;
    goto LABEL_10;
  }
  if ( v6 != &off_2A148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 5u )
    sub_1D3A0((__int64)v6[19], 0x65u, (__int64)&unk_28B00, a3[2], *((_DWORD *)a3 + 10));
  if ( sub_2567C((_BYTE *)a1, &v14) )
  {
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x66u, (__int64)&unk_28B00);
    result = 12i64;
  }
  else
  {
    v9 = (_QWORD *)a3[1];
    v10 = *a3;
    *v9 = *a3;
    *(_QWORD *)(v10 + 8) = v9;
    --*(_DWORD *)(a1 + 80 * v4 + 96);
    v11 = _InterlockedDecrement((volatile signed __int32 *)(a1 + 8));
    v12 = (void **)off_2A148;
    if ( off_2A148 != &off_2A148 )
    {
      if ( *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
      {
        LODWORD(v13) = *(_DWORD *)(a1 + 80 * v4 + 96);
        sub_226B8(*((_QWORD *)off_2A148 + 19), 103i64, (__int64)&unk_28B00, a3[2], v13, v11);
        v12 = (void **)off_2A148;
      }
      if ( v12 != &off_2A148 && *((char *)v12 + 172) < 0 && *((_BYTE *)v12 + 169) >= 5u )
        sub_11008((__int64)v12[19], 0x68u, (__int64)&unk_28B00);
    }
    result = v14;
  }
  return result;
}
// 23D95: variable 'v13' is possibly undefined
// 2A148: using guessed type void *off_2A148;

//----- (0000000000023DEC) ----------------------------------------------------
__int64 __fastcall sub_23DEC(__int64 a1, __int64 a2, __int64 a3)
{
  void **v6; // rcx
  __int64 *v7; // rax
  __int64 result; // rax
  int v9; // [rsp+20h] [rbp-18h]

  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x69u, (__int64)&unk_28B00);
    v6 = (void **)off_2A148;
  }
  if ( a1 && a2 && a3 )
  {
    if ( !*(_DWORD *)(a2 + 16) )
    {
      sub_22D18(a1, a2, 0);
      v6 = (void **)off_2A148;
    }
    if ( v6 != &off_2A148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 5u )
    {
      v9 = *(_DWORD *)(a3 + 40);
      sub_1D3A0((__int64)v6[19], 0x6Bu, (__int64)&unk_28B00, *(_QWORD *)(a3 + 16), v9);
    }
    v7 = *(__int64 **)(a2 + 8);
    *(_QWORD *)a3 = a2;
    *(_QWORD *)(a3 + 8) = v7;
    *v7 = a3;
    ++*(_DWORD *)(a2 + 16);
    *(_QWORD *)(a2 + 8) = a3;
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x6Cu, (__int64)&unk_28B00);
    result = 0i64;
  }
  else
  {
    if ( v6 != &off_2A148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 2u )
      sub_1FAF0((__int64)v6[19], 0x6Au, (__int64)&unk_28B00, a1, a2, a3);
    result = 3i64;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000023F6C) ----------------------------------------------------
__int64 __fastcall sub_23F6C(__int64 a1, __int64 a2)
{
  unsigned int v4; // edi
  void **v5; // rcx
  __int64 *v6; // r12
  __int64 *v7; // rsi
  __int64 v8; // rcx
  __int64 *v9; // rax
  __int64 v10; // rcx
  void (__fastcall *v11)(__int64); // rax
  __int64 result; // rax

  v4 = 0;
  v5 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x6Du, (__int64)&unk_28B00);
    v5 = (void **)off_2A148;
  }
  if ( a1 && a2 )
  {
    if ( *(_DWORD *)(a2 + 16) )
    {
      v6 = *(__int64 **)a2;
      while ( *(_QWORD *)a2 != a2 )
      {
        v7 = v6;
        v6 = (__int64 *)*v6;
        v8 = *v7;
        v9 = (__int64 *)v7[1];
        *v9 = *v7;
        *(_QWORD *)(v8 + 8) = v9;
        --*(_DWORD *)(a2 + 16);
        v10 = v7[4];
        if ( v10 )
        {
          v11 = *(void (__fastcall **)(__int64))(a1 + 56);
          if ( v11 )
          {
            v11(v10);
            if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
              sub_12954(*((_QWORD *)off_2A148 + 19), 0x71u, (__int64)&unk_28B00, v7[2]);
            sub_1AAB8(*(_QWORD *)(a1 + 72), (__int64)v7);
          }
          else
          {
            if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
              sub_11008(*((_QWORD *)off_2A148 + 19), 0x70u, (__int64)&unk_28B00);
            v4 = 5;
          }
        }
        else
        {
          if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
            sub_11008(*((_QWORD *)off_2A148 + 19), 0x6Fu, (__int64)&unk_28B00);
          v4 = 6;
        }
      }
    }
    else
    {
      v4 = 4;
    }
    sub_22E44(a1, a2, 0);
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x72u, (__int64)&unk_28B00);
    result = v4;
  }
  else
  {
    if ( v5 != &off_2A148 && *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 2u )
      sub_13878((__int64)v5[19], 0x6Eu, (__int64)&unk_28B00, a1, a2);
    result = 3i64;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000002419C) ----------------------------------------------------
__int64 __fastcall sub_2419C(__int64 a1, _DWORD *a2)
{
  void **v4; // rcx
  __int64 result; // rax
  unsigned __int32 v6; // ebx

  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x73u, (__int64)&unk_28B00);
    v4 = (void **)off_2A148;
  }
  *a2 = 0;
  if ( a1 )
  {
    v6 = _InterlockedExchangeAdd((volatile signed __int32 *)(a1 + 8), 0);
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x75u, (__int64)&unk_28B00);
    result = v6;
  }
  else
  {
    if ( v4 != &off_2A148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 2u )
      sub_11008((__int64)v4[19], 0x74u, (__int64)&unk_28B00);
    *a2 = 3;
    result = 0i64;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000024294) ----------------------------------------------------
__int64 __fastcall sub_24294(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4)
{
  void **v8; // rcx
  unsigned __int16 v9; // dx
  __int64 result; // rax
  ULONG_PTR v11; // rax
  void **v12; // rcx
  unsigned int v13; // ebx
  __int64 v14; // [rsp+60h] [rbp+8h] BYREF

  LODWORD(v14) = 0;
  v8 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x86u, (__int64)&unk_28B00);
    v8 = (void **)off_2A148;
  }
  if ( a4 )
    *a4 = 0i64;
  if ( !BugCheckParameter2 )
  {
    if ( v8 == &off_2A148 || *((char *)v8 + 172) >= 0 || *((_BYTE *)v8 + 169) < 2u )
      return 3i64;
    v9 = 135;
LABEL_12:
    sub_11008((__int64)v8[19], v9, (__int64)&unk_28B00);
    return 3i64;
  }
  if ( !a3 )
  {
    if ( v8 == &off_2A148 || *((char *)v8 + 172) >= 0 || *((_BYTE *)v8 + 169) < 2u )
      return 3i64;
    v9 = 136;
    goto LABEL_12;
  }
  if ( _InterlockedCompareExchange((volatile signed __int32 *)(BugCheckParameter2 + 28), 0, 0) )
  {
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x89u, (__int64)&unk_28B00);
    result = 9i64;
  }
  else
  {
    v11 = sub_24AF8(BugCheckParameter2, a2, a3, a4, (__int64)&v14);
    if ( v11 )
    {
      if ( v11 == a3 )
      {
        v13 = v14;
        v12 = (void **)off_2A148;
      }
      else
      {
        if ( a4 )
          sub_24F80(BugCheckParameter2, (ULONG_PTR)*a4);
        v12 = (void **)off_2A148;
        if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
        {
          sub_12954(*((_QWORD *)off_2A148 + 19), 0x8Bu, (__int64)&unk_28B00, a2);
          v12 = (void **)off_2A148;
        }
        v13 = 7;
      }
      if ( v12 != &off_2A148 && *((char *)v12 + 172) < 0 && *((_BYTE *)v12 + 169) >= 5u )
        sub_11008((__int64)v12[19], 0x8Cu, (__int64)&unk_28B00);
      result = v13;
    }
    else
    {
      if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
        sub_1102C(*((_QWORD *)off_2A148 + 19), 0x8Au, (__int64)&unk_28B00, v14);
      result = (unsigned int)v14;
    }
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000244C8) ----------------------------------------------------
__int64 __fastcall sub_244C8(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, _DWORD *a4)
{
  __int64 v4; // rbp
  void **v8; // rcx
  __int64 v10; // r14
  struct _FAST_MUTEX *v11; // r13
  _QWORD *v12; // rax
  __int64 v13; // rsi
  int v14; // eax
  __int64 v15; // [rsp+20h] [rbp-78h] BYREF
  _BYTE v16[72]; // [rsp+28h] [rbp-70h] BYREF
  KIRQL v17; // [rsp+A0h] [rbp+8h] BYREF

  v4 = 0i64;
  v15 = 0i64;
  memset(v16, 0, sizeof(v16));
  v8 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 0x80) != 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x93u, (__int64)&unk_28B00);
    v8 = (void **)off_2A148;
  }
  *a4 = 0;
  if ( !BugCheckParameter2 )
  {
    if ( v8 != &off_2A148 && (*((_BYTE *)v8 + 172) & 0x80) != 0 && *((_BYTE *)v8 + 169) >= 2u )
      sub_11008((__int64)v8[19], 0x94u, (__int64)&unk_28B00);
    *a4 = 3;
    return 0i64;
  }
  if ( sub_25530((_BYTE *)BugCheckParameter2, a4) )
  {
    if ( off_2A148 != &off_2A148 && (*((_BYTE *)off_2A148 + 172) & 0x80) != 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_2A148 + 19), 0x95u, (__int64)&unk_28B00);
    *a4 = 10;
    return 0i64;
  }
  v10 = (unsigned int)sub_2396C(BugCheckParameter2, a2, a4);
  v11 = (struct _FAST_MUTEX *)(BugCheckParameter2 + 80 * v10 + 104);
  sub_22B2C(*(_DWORD *)(BugCheckParameter2 + 24), v11, &v17);
  v12 = sub_24938(BugCheckParameter2, v10, a2, a4);
  v13 = (__int64)v12;
  if ( v12 )
  {
    if ( *a4 == 8 )
    {
      sub_22C3C(*(_DWORD *)(BugCheckParameter2 + 24), v11, v17);
      if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 3u )
        sub_12954(*((_QWORD *)off_2A148 + 19), 0x96u, (__int64)&unk_28B00, a2, v15);
      return 0i64;
    }
    sub_25268(BugCheckParameter2, (ULONG_PTR)v12, 0);
    v4 = *(_QWORD *)(v13 + 32);
    if ( *(_DWORD *)(v13 + 40) )
    {
      *(_BYTE *)(v13 + 44) = 1;
    }
    else
    {
      v14 = sub_23BF0(BugCheckParameter2, v10, (__int64 *)v13);
      *a4 = v14;
      if ( !v14 )
        sub_23DEC(BugCheckParameter2, (__int64)&v15, v13);
    }
  }
  sub_22C3C(*(_DWORD *)(BugCheckParameter2 + 24), v11, v17);
  sub_23F6C(BugCheckParameter2, (__int64)&v15);
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x97u, (__int64)&unk_28B00);
  return v4;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000002474C) ----------------------------------------------------
__int64 __fastcall sub_2474C(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, _QWORD *a3, _DWORD *a4)
{
  __int64 v8; // r12
  void **v9; // rcx
  unsigned int v11; // ebx
  struct _FAST_MUTEX *v12; // r13
  _QWORD *v13; // rax
  _QWORD *v14; // rbx
  KIRQL v15; // [rsp+50h] [rbp+8h] BYREF

  v8 = 0i64;
  v9 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xACu, (__int64)&unk_28B00);
    v9 = (void **)off_2A148;
  }
  *a4 = 4;
  if ( a3 )
    *a3 = 0i64;
  if ( !BugCheckParameter2 )
  {
    if ( v9 != &off_2A148 && *((char *)v9 + 172) < 0 && *((_BYTE *)v9 + 169) >= 2u )
      sub_11008((__int64)v9[19], 0xADu, (__int64)&unk_28B00);
    *a4 = 3;
    return 0i64;
  }
  v11 = sub_2396C(BugCheckParameter2, a2, a4);
  v12 = (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v11 + 104);
  sub_22B2C(*(_DWORD *)(BugCheckParameter2 + 24), v12, &v15);
  v13 = sub_24938(BugCheckParameter2, v11, a2, a4);
  v14 = v13;
  if ( v13 )
  {
    if ( *a4 == 8 )
    {
      sub_22C3C(*(_DWORD *)(BugCheckParameter2 + 24), v12, v15);
      if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 3u )
        sub_12954(*((_QWORD *)off_2A148 + 19), 0xAEu, (__int64)&unk_28B00, a2);
      return 0i64;
    }
    v8 = v13[4];
    if ( a3 )
    {
      sub_25124(BugCheckParameter2, (ULONG_PTR)v13, 0);
      *a3 = v14;
    }
  }
  sub_22C3C(*(_DWORD *)(BugCheckParameter2 + 24), v12, v15);
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xAFu, (__int64)&unk_28B00);
  return v8;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000024938) ----------------------------------------------------
_QWORD *__fastcall sub_24938(__int64 a1, unsigned int a2, __int64 a3, _DWORD *a4)
{
  __int64 v6; // r12
  _QWORD *v8; // rsi
  void **v9; // rcx
  _QWORD *result; // rax
  _QWORD *v11; // rdx
  _QWORD *v12; // rbx

  v6 = a2;
  v8 = 0i64;
  v9 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xB0u, (__int64)&unk_28B00);
    v9 = (void **)off_2A148;
  }
  *a4 = 4;
  if ( a1 )
  {
    v11 = (_QWORD *)(a1 + 16 * (5 * v6 + 5));
    if ( (_QWORD *)*v11 != v11 )
    {
      v12 = (_QWORD *)*v11;
      while ( v12 != v11 )
      {
        v8 = v12;
        if ( v12[2] == a3 )
        {
          if ( v9 != &off_2A148 && *((char *)v9 + 172) < 0 && *((_BYTE *)v9 + 169) >= 4u )
          {
            sub_1D280((__int64)v9[19], 0xB2u, (__int64)&unk_28B00, v6);
            v9 = (void **)off_2A148;
          }
          if ( *((_BYTE *)v12 + 44) )
          {
            if ( v9 != &off_2A148 && *((char *)v9 + 172) < 0 && *((_BYTE *)v9 + 169) >= 4u )
            {
              sub_12954((__int64)v9[19], 0xB3u, (__int64)&unk_28B00, v12[2]);
              v9 = (void **)off_2A148;
            }
            *a4 = 8;
          }
          else
          {
            *a4 = 0;
          }
          break;
        }
        v12 = (_QWORD *)*v12;
        v8 = 0i64;
      }
    }
    if ( v9 != &off_2A148 && *((char *)v9 + 172) < 0 && *((_BYTE *)v9 + 169) >= 5u )
      sub_11008((__int64)v9[19], 0xB4u, (__int64)&unk_28B00);
    result = v8;
  }
  else
  {
    if ( v9 != &off_2A148 && *((char *)v9 + 172) < 0 && *((_BYTE *)v9 + 169) >= 2u )
      sub_11008((__int64)v9[19], 0xB1u, (__int64)&unk_28B00);
    *a4 = 3;
    result = 0i64;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000024AF8) ----------------------------------------------------
ULONG_PTR __fastcall sub_24AF8(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4, __int64 a5)
{
  ULONG_PTR v9; // r12
  unsigned int v10; // er14
  void **v11; // rcx
  _DWORD *v12; // rbp
  int v14; // ebx
  unsigned int v15; // edi
  __int64 v16; // r14
  ULONG_PTR *v17; // rax
  ULONG_PTR *v18; // rdi
  ULONG_PTR *v19; // rax
  ULONG_PTR v20; // rcx
  ULONG_PTR **v21; // rax
  ULONG_PTR v22; // [rsp+20h] [rbp-58h]
  int v23[4]; // [rsp+40h] [rbp-38h] BYREF
  int v24; // [rsp+80h] [rbp+8h]

  v9 = 0i64;
  v23[0] = 0;
  v10 = 0;
  v11 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xB5u, (__int64)&unk_28B00);
    v11 = (void **)off_2A148;
  }
  v12 = (_DWORD *)a5;
  if ( !a5 )
  {
    if ( v11 != &off_2A148 && *((char *)v11 + 172) < 0 && *((_BYTE *)v11 + 169) >= 2u )
      sub_11008((__int64)v11[19], 0xB6u, (__int64)&unk_28B00);
    return 0i64;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v11 != &off_2A148 && *((char *)v11 + 172) < 0 && *((_BYTE *)v11 + 169) >= 2u )
      sub_11008((__int64)v11[19], 0xB7u, (__int64)&unk_28B00);
    *v12 = 3;
    return 0i64;
  }
  if ( !a3 )
  {
    if ( v11 != &off_2A148 && *((char *)v11 + 172) < 0 && *((_BYTE *)v11 + 169) >= 2u )
      sub_11008((__int64)v11[19], 0xB8u, (__int64)&unk_28B00);
    v14 = 3;
    goto LABEL_37;
  }
  if ( _InterlockedCompareExchange((volatile signed __int32 *)(BugCheckParameter2 + 28), 0, 0) )
  {
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_2A148 + 19), 0xB9u, (__int64)&unk_28B00);
    *v12 = 9;
    return 0i64;
  }
  v15 = sub_2396C(BugCheckParameter2, a2, v23);
  v24 = v15;
  v16 = 10i64 * v15;
  sub_22B2C(
    *(_DWORD *)(BugCheckParameter2 + 24),
    (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v15 + 104),
    (KIRQL *)&a5);
  if ( sub_253E4((_BYTE *)BugCheckParameter2, v23)
    || (v17 = sub_24938(BugCheckParameter2, v15, a2, v23), (v18 = v17) == 0i64) )
  {
    v19 = (ULONG_PTR *)sub_23A68(BugCheckParameter2, a3, v23);
    v18 = v19;
    if ( !v19 )
    {
      v14 = 2;
      if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 2u )
        sub_11008(*((_QWORD *)off_2A148 + 19), 0xBCu, (__int64)&unk_28B00);
      goto LABEL_36;
    }
    v19[2] = a2;
    if ( !sub_25530((_BYTE *)BugCheckParameter2, v23) )
      sub_25124(BugCheckParameter2, (ULONG_PTR)v18, 1);
    v20 = BugCheckParameter2 + 8 * v16 + 80;
    v21 = *(ULONG_PTR ***)(BugCheckParameter2 + 8 * v16 + 88);
    *v18 = v20;
    v18[1] = (ULONG_PTR)v21;
    *v21 = v18;
    *(_QWORD *)(v20 + 8) = v18;
    ++*(_DWORD *)(BugCheckParameter2 + 8 * v16 + 96);
    _InterlockedIncrement((volatile signed __int32 *)(BugCheckParameter2 + 8));
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
    {
      v10 = v24;
      v22 = v18[2];
      sub_22778(*((_QWORD *)off_2A148 + 19), 189i64, (__int64)&unk_28B00, v24);
      v14 = v23[0];
      goto LABEL_59;
    }
    v14 = v23[0];
LABEL_58:
    v10 = v24;
LABEL_59:
    v9 = v18[4];
    if ( a4 )
    {
      sub_25124(BugCheckParameter2, (ULONG_PTR)v18, 1);
      *a4 = v18;
    }
    goto LABEL_37;
  }
  sub_25EF4(BugCheckParameter2, (ULONG_PTR)v17);
  v14 = v23[0];
  if ( v23[0] != 8 )
  {
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 )
    {
      v10 = v24;
      if ( *((_BYTE *)off_2A148 + 169) >= 4u )
      {
        v22 = v18[2];
        sub_1D280(*((_QWORD *)off_2A148 + 19), 0xBBu, (__int64)&unk_28B00, v24);
      }
      goto LABEL_59;
    }
    goto LABEL_58;
  }
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 3u )
    sub_12954(*((_QWORD *)off_2A148 + 19), 0xBAu, (__int64)&unk_28B00, a2);
LABEL_36:
  v10 = v24;
LABEL_37:
  sub_22C3C(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v10 + 104), a5);
  *v12 = v14;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    LODWORD(v22) = v14;
    sub_1D3A0(*((_QWORD *)off_2A148 + 19), 0xBEu, (__int64)&unk_28B00, v9, v22);
  }
  return v9;
}
// 24DA9: variable 'v22' is possibly undefined
// 2A148: using guessed type void *off_2A148;

//----- (0000000000024F80) ----------------------------------------------------
__int64 __fastcall sub_24F80(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1)
{
  void **v4; // rcx
  __int64 result; // rax
  unsigned int v6; // ebx
  struct _FAST_MUTEX *v7; // rbp
  unsigned int v8; // ebx
  __int64 v9; // [rsp+20h] [rbp-68h] BYREF
  _BYTE v10[72]; // [rsp+28h] [rbp-60h] BYREF
  KIRQL v11; // [rsp+90h] [rbp+8h] BYREF
  unsigned int v12; // [rsp+98h] [rbp+10h] BYREF

  v12 = 0;
  v9 = 0i64;
  memset(v10, 0, sizeof(v10));
  v4 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xCFu, (__int64)&unk_28B00);
    v4 = (void **)off_2A148;
  }
  if ( BugCheckParameter1 )
  {
    v6 = sub_2396C(BugCheckParameter2, *(_QWORD *)(BugCheckParameter1 + 16), &v12);
    v7 = (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v6 + 104);
    sub_22B2C(*(_DWORD *)(BugCheckParameter2 + 24), v7, &v11);
    sub_25268(BugCheckParameter2, BugCheckParameter1, 0);
    if ( *(_DWORD *)(BugCheckParameter1 + 40) )
    {
      v8 = v12;
    }
    else
    {
      v8 = sub_23BF0(BugCheckParameter2, v6, (__int64 *)BugCheckParameter1);
      if ( !v8 )
        sub_23DEC(BugCheckParameter2, (__int64)&v9, BugCheckParameter1);
    }
    sub_22C3C(*(_DWORD *)(BugCheckParameter2 + 24), v7, v11);
    sub_23F6C(BugCheckParameter2, (__int64)&v9);
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
      sub_11008(*((_QWORD *)off_2A148 + 19), 0xD1u, (__int64)&unk_28B00);
    result = v8;
  }
  else
  {
    if ( v4 != &off_2A148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 2u )
      sub_11008((__int64)v4[19], 0xD0u, (__int64)&unk_28B00);
    result = 3i64;
  }
  return result;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000025124) ----------------------------------------------------
__int64 __fastcall sub_25124(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3)
{
  void **v6; // rcx
  unsigned __int16 v7; // dx

  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xD6u, (__int64)&unk_28B00);
    v6 = (void **)off_2A148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 215;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_28B00);
    return 3i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 216;
    goto LABEL_10;
  }
  if ( !a3 )
  {
    sub_25EF4(BugCheckParameter2, BugCheckParameter1);
    v6 = (void **)off_2A148;
  }
  if ( !*(_BYTE *)(BugCheckParameter1 + 45) )
  {
    ++*(_DWORD *)(BugCheckParameter1 + 40);
    v6 = (void **)off_2A148;
  }
  if ( v6 != &off_2A148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 5u )
    sub_1D280((__int64)v6[19], 0xD9u, (__int64)&unk_28B00, *(_DWORD *)(BugCheckParameter1 + 40));
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000025268) ----------------------------------------------------
__int64 __fastcall sub_25268(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3)
{
  void **v6; // rcx
  unsigned __int16 v7; // dx
  int v9; // eax
  __int64 v10; // rax
  int v11; // [rsp+40h] [rbp+8h] BYREF

  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_12954(*((_QWORD *)off_2A148 + 19), 0xDAu, (__int64)&unk_28B00, *(_QWORD *)(BugCheckParameter1 + 16));
    v6 = (void **)off_2A148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 219;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_28B00);
    return 3i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 220;
    goto LABEL_10;
  }
  if ( !a3 )
    sub_25EF4(BugCheckParameter2, BugCheckParameter1);
  v9 = *(_DWORD *)(BugCheckParameter1 + 40);
  if ( v9 )
    *(_DWORD *)(BugCheckParameter1 + 40) = v9 - 1;
  v11 = 0;
  if ( sub_2567C((_BYTE *)BugCheckParameter2, &v11)
    && !*(_DWORD *)(BugCheckParameter1 + 40)
    && !*(_BYTE *)(BugCheckParameter1 + 45) )
  {
    v10 = MEMORY[0xFFFFF78000000014];
    *(_BYTE *)(BugCheckParameter1 + 45) = 1;
    *(_QWORD *)(BugCheckParameter1 + 48) = v10;
    ++*(_QWORD *)(BugCheckParameter2 + 32);
  }
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_1D280(*((_QWORD *)off_2A148 + 19), 0xDDu, (__int64)&unk_28B00, *(_DWORD *)(BugCheckParameter1 + 40));
  return 0i64;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000253E4) ----------------------------------------------------
char __fastcall sub_253E4(_BYTE *a1, _DWORD *a2)
{
  char v4; // bl
  void **v5; // rcx
  unsigned __int16 v7; // dx

  v4 = 0;
  v5 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xDEu, (__int64)&unk_28B00);
    v5 = (void **)off_2A148;
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 1) != 0 )
    {
      v4 = 1;
      if ( v5 != &off_2A148 )
      {
        if ( *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 4u )
        {
          v7 = 224;
LABEL_20:
          sub_11008((__int64)v5[19], v7, (__int64)&unk_28B00);
          v5 = (void **)off_2A148;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else if ( v5 != &off_2A148 )
    {
      if ( *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 4u )
      {
        v7 = 225;
        goto LABEL_20;
      }
LABEL_21:
      if ( v5 != &off_2A148 && *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 5u )
        sub_11008((__int64)v5[19], 0xE2u, (__int64)&unk_28B00);
      return v4;
    }
    return v4;
  }
  if ( v5 != &off_2A148 && *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 2u )
    sub_11008((__int64)v5[19], 0xDFu, (__int64)&unk_28B00);
  *a2 = 3;
  return 0;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000025530) ----------------------------------------------------
char __fastcall sub_25530(_BYTE *a1, _DWORD *a2)
{
  char v4; // bl
  void **v5; // rcx
  unsigned __int16 v7; // dx

  v4 = 0;
  v5 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xE3u, (__int64)&unk_28B00);
    v5 = (void **)off_2A148;
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 2) != 0 )
    {
      v4 = 1;
      if ( v5 != &off_2A148 )
      {
        if ( *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 4u )
        {
          v7 = 229;
LABEL_20:
          sub_11008((__int64)v5[19], v7, (__int64)&unk_28B00);
          v5 = (void **)off_2A148;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else if ( v5 != &off_2A148 )
    {
      if ( *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 4u )
      {
        v7 = 230;
        goto LABEL_20;
      }
LABEL_21:
      if ( v5 != &off_2A148 && *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 5u )
        sub_11008((__int64)v5[19], 0xE7u, (__int64)&unk_28B00);
      return v4;
    }
    return v4;
  }
  if ( v5 != &off_2A148 && *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 2u )
    sub_11008((__int64)v5[19], 0xE4u, (__int64)&unk_28B00);
  *a2 = 3;
  return 0;
}
// 2A148: using guessed type void *off_2A148;

//----- (000000000002567C) ----------------------------------------------------
char __fastcall sub_2567C(_BYTE *a1, _DWORD *a2)
{
  char v4; // bl
  void **v5; // rcx
  unsigned __int16 v7; // dx

  v4 = 0;
  v5 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xE8u, (__int64)&unk_28B00);
    v5 = (void **)off_2A148;
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 4) != 0 )
    {
      v4 = 1;
      if ( v5 != &off_2A148 )
      {
        if ( *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 4u )
        {
          v7 = 234;
LABEL_20:
          sub_11008((__int64)v5[19], v7, (__int64)&unk_28B00);
          v5 = (void **)off_2A148;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else if ( v5 != &off_2A148 )
    {
      if ( *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 4u )
      {
        v7 = 235;
        goto LABEL_20;
      }
LABEL_21:
      if ( v5 != &off_2A148 && *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 5u )
        sub_11008((__int64)v5[19], 0xECu, (__int64)&unk_28B00);
      return v4;
    }
    return v4;
  }
  if ( v5 != &off_2A148 && *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 2u )
    sub_11008((__int64)v5[19], 0xE9u, (__int64)&unk_28B00);
  *a2 = 3;
  return 0;
}
// 2A148: using guessed type void *off_2A148;

//----- (00000000000257C8) ----------------------------------------------------
__int64 __fastcall sub_257C8(__int64 a1)
{
  ULONG_PTR v1; // rdi
  unsigned int v2; // ebp
  void **v3; // rcx
  __int64 v5; // r12
  _QWORD **v6; // r14
  int v7; // ecx
  _QWORD *v8; // r13
  __int64 v9; // r15
  void **v10; // rcx
  ULONG_PTR v11; // rbx
  __int64 v12; // rax
  __int64 v13; // rax
  __int64 v14; // rsi
  __int64 v15; // [rsp+20h] [rbp-98h]
  __int64 v16; // [rsp+30h] [rbp-88h] BYREF
  _BYTE v17[72]; // [rsp+38h] [rbp-80h] BYREF
  __int64 v18; // [rsp+C0h] [rbp+8h] BYREF
  unsigned int v19; // [rsp+D0h] [rbp+18h] BYREF
  struct _FAST_MUTEX *v20; // [rsp+D8h] [rbp+20h]

  v18 = a1;
  v1 = qword_2CD20;
  v2 = 0;
  v16 = 0i64;
  v19 = 0;
  memset(v17, 0, sizeof(v17));
  v3 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xEDu, (__int64)&unk_28B00);
    v3 = (void **)off_2A148;
  }
  if ( !v1 )
  {
    if ( v3 != &off_2A148 && *((char *)v3 + 172) < 0 && *((_BYTE *)v3 + 169) >= 2u )
      sub_11008((__int64)v3[19], 0xEEu, (__int64)&unk_28B00);
    return 3i64;
  }
  if ( !*(_QWORD *)(v1 + 56) )
  {
    if ( v3 != &off_2A148 && *((char *)v3 + 172) < 0 && *((_BYTE *)v3 + 169) >= 2u )
      sub_11008((__int64)v3[19], 0xEFu, (__int64)&unk_28B00);
    return 5i64;
  }
  v5 = 0i64;
  if ( *(_DWORD *)(v1 + 4) )
  {
    v6 = (_QWORD **)(v1 + 80);
    while ( 1 )
    {
      v7 = *(_DWORD *)(v1 + 24);
      v20 = (struct _FAST_MUTEX *)(v1 + 80 * v5 + 104);
      sub_22B2C(v7, v20, (KIRQL *)&v18);
      v8 = *v6;
      v9 = v1 + 80 * v5 + 80;
      if ( *v6 != (_QWORD *)v9 )
        break;
LABEL_46:
      sub_22C3C(*(_DWORD *)(v1 + 24), v20, v18);
      v5 = (unsigned int)(v5 + 1);
      v6 += 10;
      if ( (unsigned int)v5 >= *(_DWORD *)(v1 + 4) )
        goto LABEL_47;
    }
    v10 = (void **)off_2A148;
    while ( 1 )
    {
      v11 = (ULONG_PTR)v8;
      v8 = (_QWORD *)*v8;
      if ( *(_BYTE *)(v11 + 44) )
      {
        if ( v10 == &off_2A148 || *((char *)v10 + 172) >= 0 || *((_BYTE *)v10 + 169) < 4u )
          goto LABEL_45;
        LODWORD(v15) = *(_DWORD *)(v11 + 40);
        sub_1D3A0((__int64)v10[19], 0xF0u, (__int64)&unk_28B00, *(_QWORD *)(v11 + 16), v15);
      }
      else
      {
        v12 = *(_QWORD *)(v11 + 24);
        if ( v12 )
        {
          v13 = v12 - 1;
          *(_QWORD *)(v11 + 24) = v13;
          if ( v13 )
          {
            v10 = (void **)off_2A148;
            if ( off_2A148 == &off_2A148 || *((char *)off_2A148 + 172) >= 0 || *((_BYTE *)off_2A148 + 169) < 4u )
              goto LABEL_45;
            sub_13878(*((_QWORD *)off_2A148 + 19), 0xF4u, (__int64)&unk_28B00, *(_QWORD *)(v11 + 16), v13);
          }
          else
          {
            *(_BYTE *)(v11 + 44) = 1;
            if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
            {
              LODWORD(v15) = *(_DWORD *)(v11 + 40);
              sub_1D3A0(*((_QWORD *)off_2A148 + 19), 0xF1u, (__int64)&unk_28B00, *(_QWORD *)(v11 + 16), v15);
            }
            if ( !sub_25530((_BYTE *)v1, &v19) )
              sub_25268(v1, v11, 1);
            if ( !*(_DWORD *)(v11 + 40) )
            {
              v14 = *(_QWORD *)(v11 + 16);
              if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
                sub_12954(*((_QWORD *)off_2A148 + 19), 0xF2u, (__int64)&unk_28B00, *(_QWORD *)(v11 + 16));
              v2 = sub_23BF0(v1, v5, (__int64 *)v11);
              v19 = v2;
              if ( !v2 )
                sub_23DEC(v1, (__int64)&v16, v11);
              v10 = (void **)off_2A148;
              if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
              {
                LODWORD(v15) = v2;
                sub_1D3A0(*((_QWORD *)off_2A148 + 19), 0xF3u, (__int64)&unk_28B00, v14, v15);
                v10 = (void **)off_2A148;
              }
              goto LABEL_45;
            }
            v2 = v19;
          }
        }
        else
        {
          if ( v10 == &off_2A148 || *((char *)v10 + 172) >= 0 || *((_BYTE *)v10 + 169) < 4u )
            goto LABEL_45;
          sub_12954((__int64)v10[19], 0xF5u, (__int64)&unk_28B00, *(_QWORD *)(v11 + 16));
        }
      }
      v10 = (void **)off_2A148;
LABEL_45:
      if ( v8 == (_QWORD *)v9 )
        goto LABEL_46;
    }
  }
LABEL_47:
  sub_23F6C(v1, (__int64)&v16);
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 19), 0xF6u, (__int64)&unk_28B00);
  return v2;
}
// 25963: variable 'v15' is possibly undefined
// 2A148: using guessed type void *off_2A148;

//----- (0000000000025BF8) ----------------------------------------------------
__int64 __fastcall sub_25BF8(__int64 a1, ULONG_PTR a2, __int64 a3)
{
  ULONG_PTR v3; // rdi
  void **v6; // rcx
  unsigned __int16 v7; // dx
  struct _FAST_MUTEX *v9; // rbp
  __int64 v10; // rax
  __int64 v11; // [rsp+60h] [rbp+8h] BYREF
  unsigned int v12; // [rsp+68h] [rbp+10h] BYREF

  v11 = a1;
  v12 = 0;
  v3 = qword_2CD20;
  v6 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x102u, (__int64)&unk_28B00);
    v6 = (void **)off_2A148;
  }
  if ( !v3 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 259;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_28B00);
    return 3i64;
  }
  if ( !a2 )
  {
    if ( v6 == &off_2A148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 260;
    goto LABEL_10;
  }
  v9 = (struct _FAST_MUTEX *)(v3 + 80i64 * (unsigned int)sub_2396C(v3, *(_QWORD *)(a2 + 16), &v12) + 104);
  sub_22B2C(*(_DWORD *)(v3 + 24), v9, (KIRQL *)&v11);
  sub_25EF4(v3, a2);
  if ( a3 )
  {
    *(_QWORD *)(a2 + 24) = a3;
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
      sub_13878(*((_QWORD *)off_2A148 + 19), 0x105u, (__int64)&unk_28B00, *(_QWORD *)(a2 + 16), a3);
  }
  else
  {
    v10 = *(_QWORD *)(v3 + 16);
    *(_QWORD *)(a2 + 24) = v10;
    if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 4u )
      sub_13878(*((_QWORD *)off_2A148 + 19), 0x106u, (__int64)&unk_28B00, *(_QWORD *)(a2 + 16), v10);
  }
  sub_22C3C(*(_DWORD *)(v3 + 24), v9, v11);
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x107u, (__int64)&unk_28B00);
  return v12;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000025DD0) ----------------------------------------------------
__int64 sub_25DD0()
{
  void **v0; // rcx
  unsigned int v1; // ebx
  _DWORD *v2; // rax
  unsigned int v3; // edx

  v0 = (void **)off_2A148;
  if ( off_2A148 != &off_2A148 && *((char *)off_2A148 + 172) < 0 && *((_BYTE *)off_2A148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_2A148 + 19), 0x10Au, (__int64)&unk_28B00);
    v0 = (void **)off_2A148;
  }
  v1 = 0;
  v2 = dword_28B10;
  v3 = 0;
  while ( *v2 < 8u )
  {
    ++v3;
    ++v2;
    if ( v3 >= 0x1D )
    {
      if ( v0 == &off_2A148 )
        return v1;
      if ( *((char *)v0 + 172) < 0 && *((_BYTE *)v0 + 169) >= 2u )
      {
        sub_11008((__int64)v0[19], 0x10Bu, (__int64)&unk_28B00);
LABEL_16:
        v0 = (void **)off_2A148;
        goto LABEL_17;
      }
      goto LABEL_17;
    }
  }
  v1 = dword_28B10[v3];
  if ( v0 == &off_2A148 )
    return v1;
  if ( *((char *)v0 + 172) < 0 && *((_BYTE *)v0 + 169) >= 4u )
  {
    sub_1102C((__int64)v0[19], 0x10Cu, (__int64)&unk_28B00, v1);
    goto LABEL_16;
  }
LABEL_17:
  if ( v0 != &off_2A148 && *((char *)v0 + 172) < 0 && *((_BYTE *)v0 + 169) >= 5u )
    sub_11008((__int64)v0[19], 0x10Du, (__int64)&unk_28B00);
  return v1;
}
// 2A148: using guessed type void *off_2A148;

//----- (0000000000025EF4) ----------------------------------------------------
char __fastcall sub_25EF4(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1)
{
  char result; // al
  int v5; // [rsp+50h] [rbp+18h] BYREF

  v5 = 0;
  result = sub_2567C((_BYTE *)BugCheckParameter2, &v5);
  if ( result )
  {
    if ( *(_BYTE *)(BugCheckParameter1 + 45) )
      KeBugCheckEx(0xDEFECAu, BugCheckParameter1, BugCheckParameter2, 0i64, 0i64);
  }
  return result;
}

//----- (0000000000025F4C) ----------------------------------------------------
__int64 __fastcall sub_25F4C(_QWORD *a1, _QWORD *a2)
{
  char *v4; // rbx
  NTSTATUS v6; // edi
  IRP *v7; // rax
  struct _IO_STATUS_BLOCK IoStatusBlock; // [rsp+50h] [rbp-58h] BYREF
  _UNICODE_STRING DestinationString; // [rsp+60h] [rbp-48h] BYREF
  struct _KEVENT Event; // [rsp+70h] [rbp-38h] BYREF

  IoStatusBlock.Pointer = 0i64;
  Event.Header.Type = 0;
  IoStatusBlock.Information = 0i64;
  *(_OWORD *)((char *)&Event.Header.Lock + 1) = 0ui64;
  *(_DWORD *)((char *)&Event.Header.WaitListHead.Blink + 1) = 0;
  *(_WORD *)((char *)&Event.Header.WaitListHead.Blink + 5) = 0;
  HIBYTE(Event.Header.WaitListHead.Blink) = 0;
  v4 = (char *)sub_1A4F8(2, 0x18u, 0x41434E50u);
  if ( !v4 )
    return 1793i64;
  *(_QWORD *)v4 = 0i64;
  *((_QWORD *)v4 + 1) = 0i64;
  *((_QWORD *)v4 + 2) = 0i64;
  KeInitializeEvent(&Event, SynchronizationEvent, 0);
  RtlInitUnicodeString(&DestinationString, L"\\Device\\NANO\\KNC");
  v6 = IoGetDeviceObjectPointer(&DestinationString, 0x10000000u, (PFILE_OBJECT *)v4, (PDEVICE_OBJECT *)v4 + 1);
  if ( v6
    || (v7 = IoBuildDeviceIoControlRequest(
               0x8BC82004,
               *((PDEVICE_OBJECT *)v4 + 1),
               0i64,
               0,
               v4 + 16,
               8u,
               0,
               &Event,
               &IoStatusBlock),
        (v6 = IofCallDriver(*((PDEVICE_OBJECT *)v4 + 1), v7)) != 0) )
  {
    if ( *(_QWORD *)v4 )
      ObfDereferenceObject(*(PVOID *)v4);
    sub_1A57C(v4, 0x41434E50u);
    v4 = 0i64;
  }
  else
  {
    *a2 = *((_QWORD *)v4 + 2);
  }
  KeClearEvent(&Event);
  *a1 = v4;
  return v6 != 0 ? 0xE8700002 : 0;
}

//----- (00000000000260D0) ----------------------------------------------------
void __fastcall sub_260D0(PVOID P)
{
  PVOID *v1; // rdi

  if ( P )
  {
    v1 = (PVOID *)*((_QWORD *)P + 6);
    *(_BYTE *)P = 0;
    if ( v1 )
    {
      if ( *v1 )
        ObfDereferenceObject(*v1);
      sub_1A57C(v1, 0x41434E50u);
    }
    sub_1A57C(P, 0x41434E50u);
  }
}

//----- (0000000000026140) ----------------------------------------------------
__int64 __fastcall sub_26140(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, void *Src)
{
  size_t v5; // rbx
  unsigned int v6; // er12
  PVOID v10; // rax
  void *v11; // r13
  unsigned int v12; // ebx

  v5 = a4;
  v6 = a3;
  if ( !a1 )
    return 1799i64;
  if ( !a2 )
    return 1796i64;
  if ( !a4 || !Src )
    return (unsigned int)(*(__int64 (__fastcall **)(_QWORD, __int64, __int64, _QWORD, _QWORD))(*(_QWORD *)(a1 + 24)
                                                                                             + 24i64))(
                           **(_QWORD **)(a1 + 24),
                           a2,
                           a3,
                           0i64,
                           0i64);
  v10 = sub_1A4F8(2, a4, 0x41434E50u);
  v11 = v10;
  if ( !v10 )
    return 1793;
  memmove(v10, Src, v5);
  v12 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, void *, _DWORD))(*(_QWORD *)(a1 + 24) + 24i64))(
          **(_QWORD **)(a1 + 24),
          a2,
          v6,
          (unsigned int)v5,
          v11,
          0);
  sub_1A57C(v11, 0x41434E50u);
  return v12;
}

//----- (00000000000262A8) ----------------------------------------------------
__int64 __fastcall sub_262A8(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4)
{
  __int64 result; // rax

  if ( !a1 || !a2 || !a3 )
    goto LABEL_6;
  result = sub_26E30(a1, a2, a3, a4);
  if ( (int)result >= 0 )
    return result;
  *a1 = 0;
  if ( (_DWORD)result == -2 )
LABEL_6:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
  return 0xFFFFFFFFi64;
}
// 26FF4: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000262F8) ----------------------------------------------------
__int64 sub_262F8(char *a1, unsigned __int64 a2, CHAR *a3, ...)
{
  va_list va; // [rsp+48h] [rbp+20h] BYREF

  va_start(va, a3);
  return sub_262A8(a1, a2, a3, (__int64)va);
}

//----- (000000000002631C) ----------------------------------------------------
__int64 __fastcall sub_2631C(void *a1, size_t a2, const void *a3, size_t a4)
{
  unsigned int v8; // ebx

  if ( !a4 )
    return 0i64;
  if ( !a1 )
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 22i64;
  }
  if ( a3 && a2 >= a4 )
  {
    memmove(a1, a3, a4);
    return 0i64;
  }
  memset(a1, 0, a2);
  if ( a3 )
  {
    if ( a2 >= a4 )
      return 22i64;
    v8 = 34;
  }
  else
  {
    v8 = 22;
  }
  nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
  return v8;
}
// 26FF4: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000263C0) ----------------------------------------------------
__int64 __fastcall sub_263C0(_BYTE *a1, __int64 a2, char *a3)
{
  _BYTE *v3; // r9
  unsigned int v4; // ebx
  char v5; // al
  __int64 result; // rax

  v3 = a1;
  if ( a1 && a2 )
  {
    if ( !a3 )
    {
      v4 = 22;
LABEL_9:
      *v3 = 0;
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return v4;
    }
    do
    {
      v5 = *a3++;
      *a1++ = v5;
      if ( !v5 )
        break;
      --a2;
    }
    while ( a2 );
    if ( !a2 )
    {
      v4 = 34;
      goto LABEL_9;
    }
    result = 0i64;
  }
  else
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    result = 22i64;
  }
  return result;
}
// 26FF4: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000264F0) ----------------------------------------------------
__int64 __fastcall sub_264F0(_BYTE *a1, int a2, __int64 a3, _DWORD *a4)
{
  int v6; // ebx
  _BYTE *v7; // rbp
  __int64 result; // rax

  v6 = a2;
  v7 = a1;
  if ( (*(_BYTE *)(a3 + 24) & 0x40) == 0 || *(_QWORD *)(a3 + 16) )
  {
    if ( a2 > 0 )
    {
      do
      {
        LOBYTE(a1) = *v7;
        --v6;
        result = write_char(a1, a3, a4);
        ++v7;
      }
      while ( *a4 != -1 && v6 > 0 );
    }
  }
  else
  {
    *a4 += a2;
  }
  return result;
}
// 26531: variable 'a1' is possibly undefined
// 26448: using guessed type __int64 __fastcall write_char(_QWORD, _QWORD, _QWORD);

//----- (0000000000026560) ----------------------------------------------------
__int64 __fastcall sub_26560(__int64 a1, CHAR *a2, __int64 a3)
{
  int *v3; // r9
  __int64 v5; // r13
  int v6; // esi
  int v7; // er11
  int v8; // edx
  int v9; // er10
  int v10; // er8
  CHAR v12; // di
  int v13; // er14
  int v14; // er12
  CHAR *v15; // rbx
  int v16; // ecx
  __int64 v17; // rcx
  int v18; // eax
  char *i; // rcx
  __int64 v20; // r9
  int v21; // er8
  int v22; // eax
  _BYTE *j; // rcx
  __int64 v24; // rdi
  __int64 v25; // r9
  unsigned int v26; // er15
  char v27; // r13
  CHAR *v28; // rbx
  unsigned __int64 v29; // rdx
  CHAR v30; // al
  int v31; // esp
  int v32; // eax
  __int64 v33; // rdi
  unsigned int v34; // er13
  __int64 v35; // rcx
  WCHAR *v36; // rbp
  int v37; // er12
  int v38; // edi
  __int64 v39; // rcx
  int v40; // eax
  CHAR v41; // al
  __int64 v42; // rcx
  int v43; // [rsp+30h] [rbp-298h]
  unsigned int v44; // [rsp+34h] [rbp-294h] BYREF
  char v45[4]; // [rsp+38h] [rbp-290h] BYREF
  int v46; // [rsp+3Ch] [rbp-28Ch]
  int v47; // [rsp+40h] [rbp-288h]
  int v48; // [rsp+44h] [rbp-284h]
  WCHAR UnicodeString; // [rsp+48h] [rbp-280h] BYREF
  int v50; // [rsp+50h] [rbp-278h]
  int *v51; // [rsp+58h] [rbp-270h]
  __int64 v52; // [rsp+60h] [rbp-268h]
  int v53; // [rsp+68h] [rbp-260h]
  int v54; // [rsp+6Ch] [rbp-25Ch]
  ULONG BytesInMultiByteString; // [rsp+70h] [rbp-258h] BYREF
  ULONG v56; // [rsp+74h] [rbp-254h] BYREF
  CHAR *v57; // [rsp+78h] [rbp-250h]
  CHAR MultiByteString[512]; // [rsp+80h] [rbp-248h] BYREF
  CHAR v59[4]; // [rsp+280h] [rbp-48h] BYREF
  __int16 v60; // [rsp+284h] [rbp-44h]

  v3 = (int *)a3;
  v51 = (int *)a3;
  v5 = a1;
  v52 = a1;
  v53 = 0;
  v6 = 0;
  v7 = 0;
  v47 = 0;
  v8 = 0;
  v43 = 0;
  v9 = 0;
  v46 = 0;
  v10 = 0;
  v48 = 0;
  v50 = 0;
  if ( !a1 || !a2 )
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  v12 = *a2;
  v44 = 0;
  v13 = 0;
  v14 = 0;
  if ( !v12 )
    return v44;
  v15 = v57;
  while ( 1 )
  {
    v57 = ++a2;
    if ( (v44 & 0x80000000) != 0 )
      break;
    if ( (unsigned __int8)(v12 - 32) > 0x58u )
      v16 = 0;
    else
      v16 = byte_281F0[v12 - 32] & 0xF;
    v14 = byte_281F0[9 * v16 + v14] >> 4;
    v54 = v14;
    switch ( v14 )
    {
      case 8:
        goto LABEL_192;
      case 0:
        v42 = 0i64;
        goto LABEL_187;
      case 1:
        v8 = -1;
        v10 = 0;
        v48 = 0;
        v7 = 0;
        v47 = 0;
        v9 = 0;
        v46 = 0;
        v6 = 0;
        v43 = -1;
        v50 = 0;
        break;
      case 2:
        switch ( v12 )
        {
          case ' ':
            v6 |= 2u;
            break;
          case '#':
            v6 |= 0x80u;
            break;
          case '+':
            v6 |= 1u;
            break;
          case '-':
            v6 |= 4u;
            break;
          case '0':
            v6 |= 8u;
            break;
        }
        break;
      case 3:
        if ( v12 == 42 )
        {
          v7 = *v3;
          v51 = v3 + 2;
          v47 = v7;
          if ( v7 >= 0 )
            break;
          v6 |= 4u;
          v7 = -v7;
        }
        else
        {
          v7 = v12 + 10 * v7 - 48;
        }
        v47 = v7;
        break;
      case 4:
        v8 = 0;
LABEL_169:
        v43 = v8;
        break;
      case 5:
        if ( v12 == 42 )
        {
          v8 = *v3;
          v51 = v3 + 2;
          v43 = v8;
          if ( v8 >= 0 )
            break;
          v8 = -1;
        }
        else
        {
          v8 = v12 + 10 * v8 - 48;
        }
        goto LABEL_169;
      case 6:
        switch ( v12 )
        {
          case 'I':
            v41 = *a2;
            v6 |= 0x8000u;
            if ( *a2 == 54 && a2[1] == 52 )
            {
              a2 += 2;
              v6 |= 0x8000u;
              goto LABEL_190;
            }
            if ( v41 == 51 && a2[1] == 50 )
            {
              a2 += 2;
              v6 &= 0xFFFF7FFF;
              goto LABEL_190;
            }
            if ( v41 != 100 && v41 != 105 && v41 != 111 && v41 != 117 && v41 != 120 && v41 != 88 )
            {
              v42 = 0i64;
              v14 = 0;
LABEL_187:
              v50 = 0;
              LOBYTE(v42) = v12;
              write_char(v42, v5, &v44);
              goto LABEL_188;
            }
            break;
          case 'h':
            v6 |= 0x20u;
            break;
          case 'l':
            if ( *a2 == 108 )
            {
              ++a2;
              v6 |= 0x1000u;
            }
            else
            {
              v6 |= 0x10u;
            }
            break;
          case 'w':
            v6 |= 0x800u;
            break;
        }
        break;
      case 7:
        if ( v12 > 105 )
        {
          switch ( v12 )
          {
            case 'n':
              goto LABEL_192;
            case 'o':
              v21 = 8;
              if ( (v6 & 0x80u) != 0 )
                v6 |= 0x200u;
              goto LABEL_83;
            case 'p':
              v43 = 16;
              v6 |= 0x8000u;
              goto LABEL_78;
          }
          if ( v12 != 115 )
          {
            v17 = (unsigned int)(v12 - 117);
            if ( v12 == 117 )
              goto LABEL_57;
            if ( v12 != 120 )
              goto LABEL_27;
            v22 = 39;
            goto LABEL_79;
          }
        }
        else
        {
          if ( v12 == 105 )
            goto LABEL_56;
          v17 = (unsigned int)(v12 - 67);
          if ( v12 == 67 )
          {
            if ( (v6 & 0x830) == 0 )
              v6 |= 0x800u;
            goto LABEL_50;
          }
          if ( v12 != 83 )
          {
            if ( v12 != 88 )
            {
              if ( v12 == 90 )
              {
                v17 = *(_QWORD *)v3;
                v51 = v3 + 2;
                if ( v17 && (v15 = *(CHAR **)(v17 + 8)) != 0i64 )
                {
                  if ( *(_WORD *)(v17 + 2) < *(_WORD *)v17 )
                    goto LABEL_192;
                  v13 = *(unsigned __int16 *)v17;
                  if ( _bittest(&v6, 0xBu) )
                  {
                    if ( (v13 & 1) != 0 || ((unsigned __int8)v15 & 1) != 0 )
                      goto LABEL_192;
                    v13 = *(unsigned __int16 *)v17 >> 1;
                    v50 = 1;
                  }
                  else
                  {
                    v50 = 0;
                  }
                }
                else
                {
                  v15 = off_2A110;
                  v17 = strlen(off_2A110) + 1;
                  v13 = v17 - 1;
                }
                goto LABEL_27;
              }
              v17 = (unsigned int)(v12 - 99);
              if ( v12 != 99 )
              {
                if ( v12 != 100 )
                  goto LABEL_27;
LABEL_56:
                v6 |= 0x40u;
LABEL_57:
                v21 = 10;
LABEL_83:
                if ( _bittest(&v6, 0xFu) || _bittest(&v6, 0xCu) )
                {
                  v24 = *(_QWORD *)v3;
                  v25 = (__int64)(v3 + 2);
                }
                else
                {
                  v25 = (__int64)(v3 + 2);
                  if ( (v6 & 0x20) != 0 )
                  {
                    v51 = (int *)v25;
                    if ( (v6 & 0x40) != 0 )
                      v24 = *(__int16 *)(v25 - 8);
                    else
                      v24 = *(unsigned __int16 *)(v25 - 8);
LABEL_94:
                    if ( (v6 & 0x40) != 0 && v24 < 0 )
                    {
                      v24 = -v24;
                      v6 |= 0x100u;
                    }
                    if ( !_bittest(&v6, 0xFu) && !_bittest(&v6, 0xCu) )
                      v24 = (unsigned int)v24;
                    v26 = v43;
                    if ( v43 >= 0 )
                    {
                      v6 &= 0xFFFFFFF7;
                      if ( v43 > 512 )
                        v26 = 512;
                    }
                    else
                    {
                      v26 = 1;
                    }
                    v27 = v53;
                    v28 = &MultiByteString[511];
                    v9 &= -(v24 != 0);
                    v46 = v9;
                    while ( 1 )
                    {
                      v17 = v26--;
                      if ( (int)v17 <= 0 && !v24 )
                        break;
                      v29 = v24 % (unsigned __int64)v21;
                      v24 /= (unsigned __int64)v21;
                      v30 = v29 + 48;
                      if ( (int)v29 + 48 > 57 )
                        v30 += v27;
                      *v28-- = v30;
                    }
                    v5 = v52;
                    v43 = v26;
                    v32 = v31 + 639 - (_DWORD)v28;
                    v15 = v28 + 1;
                    v13 = v32;
                    if ( _bittest(&v6, 9u) && (!v32 || *v15 != 48) )
                    {
                      --v15;
                      v13 = v32 + 1;
                      *v15 = 48;
                    }
                    v10 = v48;
LABEL_27:
                    if ( !v10 )
                    {
                      if ( (v6 & 0x40) != 0 )
                      {
                        if ( _bittest(&v6, 8u) )
                        {
                          v45[0] = 45;
                          goto LABEL_119;
                        }
                        if ( (v6 & 1) != 0 )
                        {
                          v45[0] = 43;
                          goto LABEL_119;
                        }
                        if ( (v6 & 2) != 0 )
                        {
                          v45[0] = 32;
LABEL_119:
                          v9 = 1;
                          v46 = 1;
                        }
                      }
                      v33 = v52;
                      v34 = v7 - v13 - v9;
                      if ( (v6 & 0xC) == 0 )
                      {
                        LOBYTE(v17) = 32;
                        write_multi_char(v17, v34, v52, &v44);
                        v9 = v46;
                      }
                      sub_264F0(v45, v9, v33, &v44);
                      if ( (v6 & 8) != 0 && (v6 & 4) == 0 )
                      {
                        LOBYTE(v35) = 48;
                        write_multi_char(v35, v34, v33, &v44);
                      }
                      if ( v50 && v13 > 0 )
                      {
                        v36 = (WCHAR *)v15;
                        v37 = v13;
                        while ( 1 )
                        {
                          --v37;
                          UnicodeString = *v36;
                          v38 = -1;
                          if ( RtlUnicodeToMultiByteN(v59, 6u, &v56, &UnicodeString, 2u) >= 0 )
                          {
                            v38 = v56;
                            v40 = 0;
                          }
                          else
                          {
                            *(_DWORD *)v59 = 0;
                            v60 = 0;
                            v40 = 42;
                          }
                          ++v36;
                          if ( v40 || !v38 )
                            break;
                          sub_264F0(v59, v38, v52, &v44);
                          if ( !v37 )
                            goto LABEL_136;
                        }
                        v44 = -1;
LABEL_136:
                        a2 = v57;
                        v14 = v54;
                        v33 = v52;
                      }
                      else
                      {
                        sub_264F0(v15, v13, v33, &v44);
                      }
                      if ( (v44 & 0x80000000) == 0 && (v6 & 4) != 0 )
                      {
                        LOBYTE(v39) = 32;
                        write_multi_char(v39, v34, v33, &v44);
                      }
                      v5 = v52;
LABEL_188:
                      v10 = v48;
                      v7 = v47;
                      v9 = v46;
                    }
                    v8 = v43;
                    break;
                  }
                  if ( (v6 & 0x40) != 0 )
                    v24 = *(int *)(v25 - 8);
                  else
                    v24 = *(unsigned int *)(v25 - 8);
                }
                v51 = (int *)v25;
                goto LABEL_94;
              }
LABEL_50:
              v20 = (__int64)(v3 + 2);
              v51 = (int *)v20;
              if ( (v6 & 0x810) != 0 )
              {
                UnicodeString = *(_WORD *)(v20 - 8);
                v13 = -1;
                if ( RtlUnicodeToMultiByteN(MultiByteString, 0x200u, &BytesInMultiByteString, &UnicodeString, 2u) >= 0 )
                {
                  v13 = BytesInMultiByteString;
                  v9 = v46;
                  v7 = v47;
                  v10 = v48;
                }
                else
                {
                  memset(MultiByteString, 0, sizeof(MultiByteString));
                  v9 = v46;
                  v7 = v47;
                  v10 = 1;
                  v48 = 1;
                }
              }
              else
              {
                v13 = 1;
                MultiByteString[0] = *(_BYTE *)(v20 - 8);
              }
              v15 = MultiByteString;
              goto LABEL_27;
            }
LABEL_78:
            v22 = 7;
LABEL_79:
            v53 = v22;
            v21 = 16;
            if ( (v6 & 0x80u) != 0 )
            {
              v45[0] = 48;
              v9 = 2;
              v45[1] = v22 + 81;
            }
            goto LABEL_83;
          }
          if ( (v6 & 0x830) == 0 )
            v6 |= 0x800u;
        }
        v15 = *(CHAR **)v3;
        v18 = v8;
        if ( v8 == -1 )
          v18 = 0x7FFFFFFF;
        v51 = v3 + 2;
        if ( (v6 & 0x810) != 0 )
        {
          v50 = 1;
          if ( !v15 )
            v15 = (CHAR *)off_2A118;
          for ( i = v15; v18; i += 2 )
          {
            --v18;
            if ( !*(_WORD *)i )
              break;
          }
          v17 = (i - v15) >> 1;
        }
        else
        {
          if ( !v15 )
            v15 = off_2A110;
          for ( j = v15; v18; ++j )
          {
            --v18;
            if ( !*j )
              break;
          }
          v17 = (unsigned int)((_DWORD)j - (_DWORD)v15);
        }
        v13 = v17;
        goto LABEL_27;
      default:
        break;
    }
LABEL_190:
    v12 = *a2;
    if ( !*a2 )
      break;
    v3 = v51;
  }
  if ( v14 && v14 != 7 )
  {
LABEL_192:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  return v44;
}
// 26A41: variable 'v31' is possibly undefined
// 26AC3: variable 'v17' is possibly undefined
// 26AFB: variable 'v35' is possibly undefined
// 26BE6: variable 'v39' is possibly undefined
// 26448: using guessed type __int64 __fastcall write_char(_QWORD, _QWORD, _QWORD);
// 26498: using guessed type __int64 __fastcall write_multi_char(_QWORD, _QWORD, _QWORD, _QWORD);
// 26FF4: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 2A110: using guessed type char *off_2A110;
// 2A118: using guessed type wchar_t *off_2A118;

//----- (0000000000026E30) ----------------------------------------------------
__int64 __fastcall sub_26E30(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4)
{
  __int64 result; // rax
  unsigned int v7; // edi
  FILE File; // [rsp+30h] [rbp-38h] BYREF

  if ( a2 == -1i64 )
  {
    File._cnt = 0x7FFFFFFF;
  }
  else
  {
    if ( a2 > 0x7FFFFFFF )
    {
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return 0xFFFFFFFFi64;
    }
    File._cnt = a2;
  }
  File._base = a1;
  File._ptr = a1;
  File._flag = 66;
  result = sub_26560((__int64)&File, a3, a4);
  v7 = result;
  a1[a2 - 1] = 0;
  if ( (int)result >= 0 )
  {
    if ( --File._cnt < 0 )
    {
      if ( flsbuf(0, &File) == -1 )
        return 4294967294i64;
    }
    else
    {
      *File._ptr = 0;
    }
    return v7;
  }
  if ( File._cnt < 0 )
    return 4294967294i64;
  if ( a1 )
  {
    if ( a2 )
      *a1 = 0;
  }
  return result;
}
// 26FF4: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000274EC) ----------------------------------------------------
__int64 __fastcall sub_274EC(_WORD *a1, __int64 a2, __int16 *a3)
{
  _WORD *v3; // r9
  unsigned int v4; // ebx
  __int16 v5; // ax
  __int64 result; // rax

  v3 = a1;
  if ( a1 && a2 )
  {
    if ( !a3 )
    {
      v4 = 22;
LABEL_9:
      *v3 = 0;
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return v4;
    }
    do
    {
      v5 = *a3++;
      *a1++ = v5;
      if ( !v5 )
        break;
      --a2;
    }
    while ( a2 );
    if ( !a2 )
    {
      v4 = 34;
      goto LABEL_9;
    }
    result = 0i64;
  }
  else
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    result = 22i64;
  }
  return result;
}
// 26FF4: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002E008) ----------------------------------------------------
__int64 __fastcall sub_2E008(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6)
{
  unsigned int *v6; // r13
  unsigned int v7; // er10
  __int64 v10; // rbp
  unsigned int v11; // ebx
  __int64 v12; // rax
  unsigned int v13; // ecx
  unsigned int v14; // eax
  const void **v15; // r14
  unsigned int v16; // er12
  unsigned int v17; // esi
  _WORD *v18; // rcx
  __m128i *v19; // rdi
  __int64 v20; // rcx
  __m128i v21; // xmm0
  __int64 v22; // rbx
  bool v23; // zf
  __int64 v25; // [rsp+30h] [rbp-38h]
  char v26; // [rsp+70h] [rbp+8h] BYREF

  v6 = a6;
  v7 = 0;
  *a6 = 0;
  if ( a1 <= 3u )
    return (unsigned int)-1073741808;
  if ( a1 <= 5u )
  {
    v22 = a5;
    if ( a5 )
    {
      if ( a3 < 0x30 )
        return (unsigned int)-1073741811;
      do
      {
        if ( RtlCompareMemory(*(const void **)(v22 + 8), a4 + 6, 0x10ui64) == 16 )
          break;
        v22 = *(_QWORD *)(v22 + 16);
      }
      while ( v22 );
      if ( v22 )
      {
        v7 = 0;
        if ( a1 == 5 )
        {
          *(_DWORD *)(v22 + 44) = 0;
          *(_QWORD *)(v22 + 24) = 0i64;
          *(_BYTE *)(v22 + 41) = 0;
        }
        else
        {
          v23 = dword_2A1D8 == 2;
          v25 = *((_QWORD *)a4 + 1);
          *(_QWORD *)(v22 + 24) = v25;
          if ( v23 )
          {
            if ( !(unsigned int)qword_2A1B0(3i64, &v26, 4i64, &a6, a4) )
              *(_BYTE *)(v22 + 41) = v26;
            v7 = qword_2A1B0(2i64, v22 + 44, 4i64, &a6, a4);
          }
          else
          {
            *(_DWORD *)(v22 + 44) = HIDWORD(v25);
            *(_BYTE *)(v22 + 41) = BYTE2(v25);
          }
        }
        return v7;
      }
    }
    return (unsigned int)-1073741163;
  }
  if ( a1 <= 7u )
    return v7;
  if ( a1 != 8 )
    return (unsigned int)-1073741808;
  v10 = a5;
  v11 = 0;
  v12 = a5;
  if ( dword_2A1D8 == 1 )
  {
    v13 = a4[4];
    if ( v13 > 1 )
    {
      v14 = 32 * v13 + 24;
      if ( v14 <= a3 )
      {
        *(__m128i *)&a4[8 * v13 - 2] = _mm_loadu_si128((const __m128i *)*(_QWORD *)(a5 + 8));
        a4[8 * a4[4] + 2] = 528384;
        *(_DWORD *)(v10 + 44) = 0;
        *(_BYTE *)(v10 + 41) = 0;
        return v7;
      }
      v7 = -1073741789;
      if ( a3 >= 4 )
      {
        *a4 = v14;
LABEL_10:
        *v6 = 4;
        return v7;
      }
      return v7;
    }
  }
  v15 = *(const void ***)(a5 + 32);
  do
  {
    v12 = *(_QWORD *)(v12 + 16);
    ++v11;
  }
  while ( v12 );
  if ( v11 > 0x3F )
    return (unsigned int)-1073741811;
  if ( v15 )
  {
    v16 = 32 * v11 + 24;
    v17 = *(unsigned __int16 *)v15 + v16 + 2;
  }
  else
  {
    v16 = 0;
    v17 = 32 * v11 + 24;
  }
  if ( v17 > a3 )
  {
    v7 = -1073741789;
    if ( a3 < 4 )
      return v7;
    *a4 = v17;
    goto LABEL_10;
  }
  memset(a4, 0, a3);
  *a4 = v17;
  a4[2] = v16;
  a4[4] = v11;
  if ( v15 )
  {
    v18 = (_WORD *)((char *)a4 + v16);
    *v18 = *(_WORD *)v15;
    memmove(v18 + 1, v15[1], *(unsigned __int16 *)v15);
  }
  if ( v11 )
  {
    v19 = (__m128i *)(a4 + 10);
    v20 = v11;
    do
    {
      v21 = _mm_loadu_si128((const __m128i *)*(_QWORD *)(v10 + 8));
      v19->m128i_i32[0] = 528384;
      v19 += 2;
      v19[-3] = v21;
      *(_DWORD *)(v10 + 44) = 0;
      --v20;
      *(_BYTE *)(v10 + 41) = 0;
      v10 = *(_QWORD *)(v10 + 16);
    }
    while ( v20 );
  }
  v7 = 0;
  *v6 = v17;
  return v7;
}
// 2A1B0: using guessed type __int64 (__fastcall *qword_2A1B0)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 2A1D8: using guessed type int dword_2A1D8;

// nfuncs=245 queued=227 decompiled=227 lumina nreq=0 worse=0 better=0
// ALL OK, 227 function(s) have been successfully decompiled
