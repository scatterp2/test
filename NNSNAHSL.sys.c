/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall sub_140001000(_BYTE *a1, unsigned int a2, __int16 a3);
void sub_14000103C();
__int64 __fastcall sub_1400010D0(_DEVICE_OBJECT *a1, IRP *a2);
__int64 __fastcall sub_140001200(__int64 a1, IRP *a2);
__int64 sub_14000121C();
__int64 __fastcall sub_1400013B0(__int64 a1, IRP *a2);
__int64 __fastcall sub_140001558(__int64 a1, unsigned __int16 a2, __int64 a3);
__int64 __fastcall sub_140001580(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_1400015BC(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
const void **__fastcall sub_140001604(void *Buf1, unsigned int a2);
void __fastcall sub_140001690(__int64 a1, _NET_BUFFER_LIST *a2, NDIS_PORT_NUMBER a3, ULONG a4);
__int64 __fastcall sub_140001A40(__int64 a1, _NET_BUFFER_LIST *a2, ULONG a3);
__int64 __fastcall sub_140001E70(__int64 a1, _NET_BUFFER_LIST *a2, ULONG a3);
void __fastcall sub_1400022B0(__int64 a1, _NET_BUFFER_LIST *a2, NDIS_PORT_NUMBER a3, ULONG a4, ULONG a5);
__int64 __fastcall sub_1400026E0(NDIS_HANDLE NdisFilterHandle, __int64 a2, __int64 a3);
void __fastcall sub_140003050(__int64 a1, void *a2);
void __fastcall sub_140003140(__int64 a1, void *a2);
void __fastcall sub_1400031E0(PVOID VirtualAddress);
void __fastcall sub_1400034B0(__int64 a1, __int64 a2);
__int64 __fastcall sub_140003590(__int64 a1, __int64 a2);
__int64 __fastcall sub_1400036A0(__int64 a1, __int64 a2);
void __fastcall sub_140003910(__int64 a1, __int64 a2, int a3);
__int64 __fastcall sub_140003AA0(__int64 a1, __int64 a2);
void __fastcall sub_140003CFC(__int64 a1, int a2, int a3, PNET_BUFFER_LIST *a4, ULONG *a5, bool *a6);
void __fastcall sub_140004220(__int64 a1, char a2, _NET_BUFFER_LIST *a3, _BYTE *a4);
__int64 __fastcall sub_140004590(unsigned __int64 a1, unsigned __int64 a2);
__int64 __fastcall sub_140004670(__int64 a1, __int64 a2);
void __fastcall sub_140004A00(__int64 a1, int a2, int a3, _NET_BUFFER_LIST *a4, unsigned int *a5, bool *a6);
void __fastcall sub_140004E78(__int64 a1, char a2, __int64 a3, _NET_BUFFER_LIST *a4, bool *a5);
__int64 sub_140005170();
void __fastcall sub_1400051F0(__int64 a1, __int64 a2);
void sub_1400053E0();
bool __fastcall sub_140005548(__int64 a1, char a2);
void __fastcall sub_1400055B8(PVOID P);
char __fastcall sub_140005648(const UNICODE_STRING *a1, void **a2, void **a3);
__int64 __fastcall sub_140005B80(__int64 a1);
__int64 __fastcall sub_140005D00(__int64 a1);
char __fastcall sub_140005DCC(_QWORD *a1, __int64 a2, int a3, _DWORD *a4);
const char *__fastcall sub_140006410(int a1);
void __fastcall sub_140006468(_QWORD *a1);
void __fastcall sub_1400069CC(PNET_BUFFER_LIST NetBufferList);
const char *__fastcall sub_140006A94(__int64 a1);
__int64 __fastcall sub_140006B08(unsigned int a1, int a2);
__int64 __fastcall sub_140006BCC(int a1);
const char *__fastcall sub_140006C90(int a1);
__int64 __fastcall sub_140006CC0(_NET_BUFFER_LIST *a1);
void __fastcall sub_140006D28(PSLIST_ENTRY ListEntry);
PSLIST_ENTRY __fastcall sub_140006D80(__int64 a1, int a2, int a3, char a4, int a5);
void __fastcall sub_140006E48(PSLIST_ENTRY ListEntry, int a2, int a3);
void __fastcall sub_140006EBC(PNET_BUFFER_LIST NetBufferList);
__int64 __fastcall sub_140007040(__int64 a1, _NET_BUFFER_LIST *a2, int a3);
void __fastcall sub_140007544(PNET_BUFFER_LIST SrcNetBufferList, PNET_BUFFER_LIST DestNetBufferList, int a3);
void **__fastcall sub_1400076B8(__int64 a1);
void __fastcall sub_140007AB8(__int64 a1, int a2, int a3);
void __fastcall sub_1400097CC(PNET_BUFFER_LIST NetBufferList);
_NET_BUFFER_LIST *__fastcall sub_140009874(__int64 a1, _NET_BUFFER_LIST *a2, int a3);
void __fastcall sub_140009A24(__int64 a1, int a2, const char *a3);
__int64 __fastcall sub_140009CA8(unsigned __int8 *a1);
const char *__fastcall sub_14000B140(int a1);
const char *__fastcall sub_14000B25C(int a1);
const char *__fastcall sub_14000B310(int a1);
const char *__fastcall sub_14000B42C(int a1);
__int64 __fastcall sub_14000B520(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_14000B5AC(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, __int64 a5);
__int64 __fastcall sub_14000B64C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_14000B6A4(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4);
__int64 __fastcall sub_14000B710(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4, char a5, __int64 a6);
__int64 sub_14000B808(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_14000B844(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, const wchar_t *a5);
__int64 __fastcall sub_14000B8D0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_14000B924(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_14000B988(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, char a5, __int64 a6);
__int64 sub_14000BA60(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14000BAA8(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14000BAF4(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14000BB98(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14000BBFC(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14000BCB4(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14000BD0C(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14000BDF0(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14000BE48(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14000BE9C(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14000BEFC(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_14000BFC8(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_14000C02C(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_14000C0FC(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, char a5, __int64 a6);
__int64 __fastcall sub_14000C1D8(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_14000C250(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_14000C30C(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, __int64 a5);
__int64 __fastcall sub_14000C3CC(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, __int64 a5);
void __fastcall sub_14000C490(__int64 a1, unsigned __int8 a2, __int64 *a3, __int64 a4);
__int64 __fastcall sub_14000C4C0(__int64 a1, NDIS_REQUEST_TYPE a2, NDIS_OID a3, void *a4, UINT a5, UINT a6, unsigned int a7, UINT *a8);
PVOID *__fastcall sub_14000C668(int a1);
void __fastcall sub_14000C74C(__int64 a1, struct _NDIS_EVENT *a2, LONG a3);
__int64 __fastcall sub_14000C7E8(unsigned __int8 *a1);
__int64 __fastcall sub_14000C940(unsigned __int8 *a1);
__int64 sub_14000CA98();
char __fastcall sub_14000CFD0(__int64 a1, __int64 a2);
__int64 __fastcall sub_14000D0D8(int a1, void *a2, void *a3, unsigned int a4, ULONG Type, void *Src, ULONG MaxCount, void *a8, unsigned int DstSize, const wchar_t *SourceString);
char __fastcall sub_14000D438(DWORD a1, DWORD a2, int a3);
const char *__fastcall sub_14000D6B8(int a1);
__int64 __fastcall sub_14000D71C(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4, __int64 a5);
__int64 __fastcall sub_14000D7E0(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4);
__int64 __fastcall sub_14000D864(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, char a5, char a6, char a7, __int64 a8);
__int64 __fastcall sub_14000D920(unsigned int a1, int a2);
__int64 __fastcall sub_14000D9E0(__int64 a1, __int64 a2, int a3);
__int64 __fastcall sub_14000DB6C(int a1, __int64 a2, unsigned int a3, _NET_BUFFER_LIST *a4);
__int64 __fastcall sub_14000DF94(int a1, __int64 a2, unsigned int a3, _NET_BUFFER_LIST *a4);
__int16 __fastcall sub_14000E3C8(__int16 a1);
__int64 __fastcall sub_14000E3D8(PNET_BUFFER NetBuffer, __int64 a2, _DWORD *a3, unsigned int a4, __int64 a5);
__int64 __fastcall sub_14000E5D8(void *a1);
void __fastcall sub_14000E670(PVOID P);
__int64 __fastcall sub_14000E704(PCWSTR SourceString, void **a2);
__int64 __fastcall sub_14000E8E8(HANDLE KeyHandle, PCWSTR SourceString, void **a3, unsigned int *a4, __int64 a5);
__int64 __fastcall sub_14000EC38(HANDLE KeyHandle, PCWSTR SourceString, PVOID Data, ULONG DataSize, ULONG Type); // idb
__int64 __fastcall sub_14000EE20(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, __int64 a5);
__int64 __fastcall sub_14000EEC4(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4);
__int64 __fastcall sub_14000EF48(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4, __int64 a5);
__int64 sub_14000F02C(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14000F090();
__int64 __fastcall sub_14000F1A0(int a1, __int64 a2);
__int64 __fastcall sub_14000F310(unsigned int a1, __int64 a2);
__int64 sub_14000F3B0();
__int64 sub_14000F468();
__int64 sub_14000F510();
void __fastcall sub_14000F7F8(__int64 a1);
__int64 __fastcall sub_14000F990(__int64 a1);
__int64 __fastcall sub_14000FA20(_NET_BUFFER_LIST *a1);
void sub_14000FAAC();
__int64 __fastcall sub_14000FB40(unsigned int a1, __int64 a2, int a3, int a4, _NET_BUFFER_LIST *a5);
__int64 __fastcall sub_14000FD30(__int64 a1);
__int64 __fastcall sub_14000FE1C(unsigned int a1, __int64 a2, __int64 a3, unsigned int a4, __int64 a5);
__int64 sub_14000FEE4();
void sub_14000FF78();
__int64 __fastcall sub_140010020(int a1, _QWORD *a2, int a3);
void sub_140010180();
__int64 __fastcall sub_140010268(unsigned int a1, __int64 a2, int a3);
__int64 __fastcall sub_140010338(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_140010390(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
// NDIS_STATUS __stdcall NdisRegisterDeviceEx(NDIS_HANDLE NdisHandle, PNDIS_DEVICE_OBJECT_ATTRIBUTES DeviceObjectAttributes, PDEVICE_OBJECT *pDeviceObject, PNDIS_HANDLE NdisDeviceHandle);
// void __stdcall NdisDeregisterDeviceEx(NDIS_HANDLE NdisDeviceHandle);
// PVOID __stdcall NdisGetDeviceReservedExtension(PDEVICE_OBJECT DeviceObject);
// NDIS_STATUS __stdcall NdisFRestartFilter(NDIS_HANDLE NdisFilterHandle);
// void __stdcall NdisCloseConfiguration(NDIS_HANDLE ConfigurationHandle);
// void __stdcall NdisFreeMemory(PVOID VirtualAddress, UINT Length, UINT MemoryFlags);
// void __stdcall NdisInitializeEvent(PNDIS_EVENT Event);
// void __stdcall NdisSetEvent(PNDIS_EVENT Event);
// BOOLEAN __stdcall NdisWaitEvent(PNDIS_EVENT Event, UINT MsToWait);
// UINT NdisGetVersion(void);
// NDIS_STATUS __stdcall NdisOpenConfigurationEx(PNDIS_CONFIGURATION_OBJECT ConfigObject, PNDIS_HANDLE ConfigurationHandle);
// PVOID __stdcall NdisAllocateMemoryWithTagPriority(NDIS_HANDLE NdisHandle, UINT Length, ULONG Tag, EX_POOL_PRIORITY Priority);
// NDIS_STATUS __stdcall NdisAllocateCloneOidRequest(NDIS_HANDLE SourceHandle, PNDIS_OID_REQUEST OidRequest, UINT PoolTag, PNDIS_OID_REQUEST *ClonedOidRequest);
// void __stdcall NdisFreeCloneOidRequest(NDIS_HANDLE SourceHandle, PNDIS_OID_REQUEST Request);
// NDIS_HANDLE __stdcall NdisAllocateNetBufferPool(NDIS_HANDLE NdisHandle, PNET_BUFFER_POOL_PARAMETERS Parameters);
// void __stdcall NdisFreeNetBufferPool(NDIS_HANDLE PoolHandle);
// PNET_BUFFER __stdcall NdisAllocateNetBuffer(NDIS_HANDLE PoolHandle, PMDL MdlChain, ULONG DataOffset, SIZE_T DataLength);
// void __stdcall NdisFreeNetBuffer(PNET_BUFFER NetBuffer);
// NDIS_HANDLE __stdcall NdisAllocateNetBufferListPool(NDIS_HANDLE NdisHandle, PNET_BUFFER_LIST_POOL_PARAMETERS Parameters);
// void __stdcall NdisFreeNetBufferListPool(NDIS_HANDLE PoolHandle);
// void __stdcall NdisFreeNetBufferList(PNET_BUFFER_LIST NetBufferList);
// PNET_BUFFER_LIST __stdcall NdisAllocateCloneNetBufferList(PNET_BUFFER_LIST OriginalNetBufferList, NDIS_HANDLE NetBufferListPoolHandle, NDIS_HANDLE NetBufferPoolHandle, ULONG AllocateCloneFlags);
// void __stdcall NdisFreeCloneNetBufferList(PNET_BUFFER_LIST CloneNetBufferList, ULONG FreeCloneFlags);
// PNET_BUFFER_LIST __stdcall NdisAllocateNetBufferAndNetBufferList(NDIS_HANDLE PoolHandle, USHORT ContextSize, USHORT ContextBackFill, PMDL MdlChain, ULONG DataOffset, SIZE_T DataLength);
// PVOID __stdcall NdisGetDataBuffer(PNET_BUFFER NetBuffer, ULONG BytesNeeded, PVOID Storage, UINT AlignMultiple, UINT AlignOffset);
// NDIS_STATUS __stdcall NdisCopyFromNetBufferToNetBuffer(PNET_BUFFER Destination, ULONG DestinationOffset, ULONG BytesToCopy, PNET_BUFFER Source, ULONG SourceOffset, PULONG BytesCopied);
// void __stdcall NdisCopySendNetBufferListInfo(PNET_BUFFER_LIST DestNetBufferList, PNET_BUFFER_LIST SrcNetBufferList);
// void __stdcall NdisCopyReceiveNetBufferListInfo(PNET_BUFFER_LIST DestNetBufferList, PNET_BUFFER_LIST SrcNetBufferList);
// PMDL __stdcall NdisAllocateMdl(NDIS_HANDLE NdisHandle, PVOID VirtualAddress, UINT Length);
// void __stdcall NdisFreeMdl(PMDL Mdl);
// NDIS_STATUS __stdcall NdisFRegisterFilterDriver(PDRIVER_OBJECT DriverObject, NDIS_HANDLE FilterDriverContext, PNDIS_FILTER_DRIVER_CHARACTERISTICS FilterDriverCharacteristics, PNDIS_HANDLE NdisFilterDriverHandle);
// void __stdcall NdisFDeregisterFilterDriver(NDIS_HANDLE NdisFilterDriverHandle);
// NDIS_STATUS __stdcall NdisFSetAttributes(NDIS_HANDLE NdisFilterHandle, NDIS_HANDLE FilterModuleContext, PNDIS_FILTER_ATTRIBUTES FilterAttributes);
// void __stdcall NdisFSendNetBufferLists(NDIS_HANDLE NdisFilterHandle, PNET_BUFFER_LIST NetBufferList, NDIS_PORT_NUMBER PortNumber, ULONG SendFlags);
// void __stdcall NdisFReturnNetBufferLists(NDIS_HANDLE NdisFilterHandle, PNET_BUFFER_LIST NetBufferLists, ULONG ReturnFlags);
// void __stdcall NdisFSendNetBufferListsComplete(NDIS_HANDLE NdisFilterHandle, PNET_BUFFER_LIST NetBufferList, ULONG SendCompleteFlags);
// void __stdcall NdisFIndicateReceiveNetBufferLists(NDIS_HANDLE NdisFilterHandle, PNET_BUFFER_LIST NetBufferLists, NDIS_PORT_NUMBER PortNumber, ULONG NumberOfNetBufferLists, ULONG ReceiveFlags);
// NDIS_STATUS __stdcall NdisFOidRequest(NDIS_HANDLE NdisFilterHandle, PNDIS_OID_REQUEST OidRequest);
// void __stdcall NdisFOidRequestComplete(NDIS_HANDLE NdisFilterHandle, PNDIS_OID_REQUEST OidRequest, NDIS_STATUS Status);
// void __stdcall NdisFIndicateStatus(NDIS_HANDLE NdisFilterHandle, PNDIS_STATUS_INDICATION StatusIndication);
// void __stdcall NdisFDevicePnPEventNotify(NDIS_HANDLE NdisFilterHandle, PNET_DEVICE_PNP_EVENT NetDevicePnPEvent);
// NDIS_STATUS __stdcall NdisFNetPnPEvent(NDIS_HANDLE NdisFilterHandle, PNET_PNP_EVENT_NOTIFICATION NetPnPEventNotification);
// void __stdcall NdisFCancelSendNetBufferLists(NDIS_HANDLE NdisFilterHandle, PVOID CancelId);
// void __stdcall NdisFCancelOidRequest(NDIS_HANDLE NdisFilterHandle, PVOID RequestId);
__int64 __fastcall sub_1400105B0(__int64 a1, __int64 a2);
// int __cdecl memcmp(const void *Buf1, const void *Buf2, size_t Size);
// errno_t __cdecl memcpy_s(void *, rsize_t DstSize, const void *Src, rsize_t MaxCount);
// void *__cdecl memmove(void *Dst, const void *Src, size_t MaxCount);
// void *__cdecl memset(void *Dst, int Val, size_t Size);
// void __stdcall RtlInitUnicodeString(PUNICODE_STRING DestinationString, PCWSTR SourceString);
// KIRQL __stdcall KeAcquireSpinLockRaiseToDpc(PKSPIN_LOCK SpinLock);
// void __stdcall KeReleaseSpinLock(PKSPIN_LOCK SpinLock, KIRQL NewIrql);
// void __stdcall IofCompleteRequest(PIRP Irp, CCHAR PriorityBoost);
// PVOID __stdcall MmGetSystemRoutineAddress(PUNICODE_STRING SystemRoutineName);
// BOOLEAN __stdcall RtlEqualUnicodeString(PCUNICODE_STRING String1, PCUNICODE_STRING String2, BOOLEAN CaseInSensitive);
// NTSTATUS __stdcall RtlGetVersion(PRTL_OSVERSIONINFOW lpVersionInformation);
// SIZE_T __stdcall RtlCompareMemory(const void *Source1, const void *Source2, SIZE_T Length);
// void __stdcall KeInitializeSpinLock(PKSPIN_LOCK SpinLock);
// void __stdcall KeAcquireSpinLockAtDpcLevel(PKSPIN_LOCK SpinLock);
// void __stdcall KeReleaseSpinLockFromDpcLevel(PKSPIN_LOCK SpinLock);
// void __stdcall KeAcquireInStackQueuedSpinLock(PKSPIN_LOCK SpinLock, PKLOCK_QUEUE_HANDLE LockHandle);
// void __stdcall KeReleaseInStackQueuedSpinLock(PKLOCK_QUEUE_HANDLE LockHandle);
// PVOID __stdcall ExAllocatePoolWithTag(POOL_TYPE PoolType, SIZE_T NumberOfBytes, ULONG Tag);
// void __stdcall ExFreePoolWithTag(PVOID P, ULONG Tag);
// USHORT __stdcall ExQueryDepthSList(PSLIST_HEADER SListHead);
// PSLIST_ENTRY __stdcall ExpInterlockedPopEntrySList(PSLIST_HEADER ListHead);
// PSLIST_ENTRY __stdcall ExpInterlockedPushEntrySList(PSLIST_HEADER ListHead, PSLIST_ENTRY ListEntry);
// void __stdcall ExInitializeNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside, PALLOCATE_FUNCTION Allocate, PFREE_FUNCTION Free, ULONG Flags, SIZE_T Size, ULONG Tag, USHORT Depth);
// void __stdcall ExDeleteNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside);
// PVOID __stdcall MmMapLockedPagesSpecifyCache(PMDL MemoryDescriptorList, KPROCESSOR_MODE AccessMode, MEMORY_CACHING_TYPE CacheType, PVOID RequestedAddress, ULONG BugCheckOnFailure, ULONG Priority);
// NTSTATUS __stdcall IoWMIRegistrationControl(PDEVICE_OBJECT DeviceObject, ULONG Action);
// NTSTATUS __stdcall ZwClose(HANDLE Handle);
// NTSTATUS __stdcall ZwOpenKey(PHANDLE KeyHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes);
// NTSTATUS __stdcall ZwEnumerateKey(HANDLE KeyHandle, ULONG Index, KEY_INFORMATION_CLASS KeyInformationClass, PVOID KeyInformation, ULONG Length, PULONG ResultLength);
// NTSTATUS __stdcall ZwQueryValueKey(HANDLE KeyHandle, PUNICODE_STRING ValueName, KEY_VALUE_INFORMATION_CLASS KeyValueInformationClass, PVOID KeyValueInformation, ULONG Length, PULONG ResultLength);
// NTSTATUS __stdcall ZwCreateKey(PHANDLE KeyHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, ULONG TitleIndex, PUNICODE_STRING Class, ULONG CreateOptions, PULONG Disposition);
// NTSTATUS __stdcall ZwSetValueKey(HANDLE KeyHandle, PUNICODE_STRING ValueName, ULONG TitleIndex, ULONG Type, PVOID Data, ULONG DataSize);
// PIRP __stdcall IoBuildDeviceIoControlRequest(ULONG IoControlCode, PDEVICE_OBJECT DeviceObject, PVOID InputBuffer, ULONG InputBufferLength, PVOID OutputBuffer, ULONG OutputBufferLength, BOOLEAN InternalDeviceIoControl, PKEVENT Event, PIO_STATUS_BLOCK IoStatusBlock);
// NTSTATUS __stdcall IofCallDriver(PDEVICE_OBJECT DeviceObject, PIRP Irp);
// NTSTATUS __stdcall IoGetDeviceObjectPointer(PUNICODE_STRING ObjectName, ACCESS_MASK DesiredAccess, PFILE_OBJECT *FileObject, PDEVICE_OBJECT *DeviceObject);
// LONG_PTR __stdcall ObfDereferenceObject(PVOID Object);
void sub_140016000();
void sub_140016070();
__int64 (*sub_1400160F8())(void);
__int64 __fastcall sub_140016200(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6);
__int64 __fastcall sub_140017000(PDRIVER_OBJECT DriverObject); // idb
NTSTATUS __stdcall DriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath);
// void __cdecl _security_init_cookie();

//-------------------------------------------------------------------------
// Data declarations

__int64 qword_140011020[2] = { -3689348814755312817i64, -3689348814741910324i64 }; // weak
__int64 qword_1400113B0[2] = { -3689348818170650281i64, -3689348814741910324i64 }; // weak
__int64 qword_1400113D0[2] = { -3689348818169992892i64, -3689348814741910324i64 }; // weak
__int64 qword_140011400[2] = { -3689348818170710975i64, -3689348814741910324i64 }; // weak
__int64 qword_140011430[2] = { -3689348818171367358i64, -3689348814741910324i64 }; // weak
__int64 qword_1400114B0[2] = { -3689348814755311543i64, -3689348814741910324i64 }; // weak
__int64 qword_140011520[2] = { -3689348818172882108i64, -3689348814741910324i64 }; // weak
__int64 qword_140011570[2] = { -3689348818173536427i64, -3689348814741910324i64 }; // weak
_UNKNOWN unk_140012310; // weak
_UNKNOWN unk_140012320; // weak
_UNKNOWN unk_140012330; // weak
_UNKNOWN unk_140012340; // weak
_UNKNOWN unk_140012350; // weak
_UNKNOWN unk_140012360; // weak
_UNKNOWN unk_140012370; // weak
_UNKNOWN unk_140012380; // weak
_UNKNOWN unk_140012390; // weak
_DWORD dword_140013000[256] =
{
  0,
  1996959894,
  -301047508,
  -1727442502,
  124634137,
  1886057615,
  -379345611,
  -1637575261,
  249268274,
  2044508324,
  -522852066,
  -1747789432,
  162941995,
  2125561021,
  -407360249,
  -1866523247,
  498536548,
  1789927666,
  -205950648,
  -2067906082,
  450548861,
  1843258603,
  -187386543,
  -2083289657,
  325883990,
  1684777152,
  -43845254,
  -1973040660,
  335633487,
  1661365465,
  -99664541,
  -1928851979,
  997073096,
  1281953886,
  -715111964,
  -1570279054,
  1006888145,
  1258607687,
  -770865667,
  -1526024853,
  901097722,
  1119000684,
  -608450090,
  -1396901568,
  853044451,
  1172266101,
  -589951537,
  -1412350631,
  651767980,
  1373503546,
  -925412992,
  -1076862698,
  565507253,
  1454621731,
  -809855591,
  -1195530993,
  671266974,
  1594198024,
  -972236366,
  -1324619484,
  795835527,
  1483230225,
  -1050600021,
  -1234817731,
  1994146192,
  31158534,
  -1731059524,
  -271249366,
  1907459465,
  112637215,
  -1614814043,
  -390540237,
  2013776290,
  251722036,
  -1777751922,
  -519137256,
  2137656763,
  141376813,
  -1855689577,
  -429695999,
  1802195444,
  476864866,
  -2056965928,
  -228458418,
  1812370925,
  453092731,
  -2113342271,
  -183516073,
  1706088902,
  314042704,
  -1950435094,
  -54949764,
  1658658271,
  366619977,
  -1932296973,
  -69972891,
  1303535960,
  984961486,
  -1547960204,
  -725929758,
  1256170817,
  1037604311,
  -1529756563,
  -740887301,
  1131014506,
  879679996,
  -1385723834,
  -631195440,
  1141124467,
  855842277,
  -1442165665,
  -586318647,
  1342533948,
  654459306,
  -1106571248,
  -921952122,
  1466479909,
  544179635,
  -1184443383,
  -832445281,
  1591671054,
  702138776,
  -1328506846,
  -942167884,
  1504918807,
  783551873,
  -1212326853,
  -1061524307,
  -306674912,
  -1698712650,
  62317068,
  1957810842,
  -355121351,
  -1647151185,
  81470997,
  1943803523,
  -480048366,
  -1805370492,
  225274430,
  2053790376,
  -468791541,
  -1828061283,
  167816743,
  2097651377,
  -267414716,
  -2029476910,
  503444072,
  1762050814,
  -144550051,
  -2140837941,
  426522225,
  1852507879,
  -19653770,
  -1982649376,
  282753626,
  1742555852,
  -105259153,
  -1900089351,
  397917763,
  1622183637,
  -690576408,
  -1580100738,
  953729732,
  1340076626,
  -776247311,
  -1497606297,
  1068828381,
  1219638859,
  -670225446,
  -1358292148,
  906185462,
  1090812512,
  -547295293,
  -1469587627,
  829329135,
  1181335161,
  -882789492,
  -1134132454,
  628085408,
  1382605366,
  -871598187,
  -1156888829,
  570562233,
  1426400815,
  -977650754,
  -1296233688,
  733239954,
  1555261956,
  -1026031705,
  -1244606671,
  752459403,
  1541320221,
  -1687895376,
  -328994266,
  1969922972,
  40735498,
  -1677130071,
  -351390145,
  1913087877,
  83908371,
  -1782625662,
  -491226604,
  2075208622,
  213261112,
  -1831694693,
  -438977011,
  2094854071,
  198958881,
  -2032938284,
  -237706686,
  1759359992,
  534414190,
  -2118248755,
  -155638181,
  1873836001,
  414664567,
  -2012718362,
  -15766928,
  1711684554,
  285281116,
  -1889165569,
  -127750551,
  1634467795,
  376229701,
  -1609899400,
  -686959890,
  1308918612,
  956543938,
  -1486412191,
  -799009033,
  1231636301,
  1047427035,
  -1362007478,
  -640263460,
  1088359270,
  936918000,
  -1447252397,
  -558129467,
  1202900863,
  817233897,
  -1111625188,
  -893730166,
  1404277552,
  615818150,
  -1160759803,
  -841546093,
  1423857449,
  601450431,
  -1285129682,
  -1000256840,
  1567103746,
  711928724,
  -1274298825,
  -1022587231,
  1510334235,
  755167117
}; // idb
PDEVICE_OBJECT off_140013400 = &off_140013400; // idb
__int64 (__fastcall *qword_140013480)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (*qword_140013490)(void) = NULL; // weak
__int64 (__fastcall *qword_140013498)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_1400134A0)(_QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
int dword_1400134A8 = 0; // weak
POOL_TYPE Flags = NonPagedPool; // idb
int dword_1400134B0 = 0; // weak
NDIS_HANDLE NdisDeviceHandle = NULL; // idb
PDEVICE_OBJECT DeviceObject = NULL; // idb
struct _NPAGED_LOOKASIDE_LIST Lookaside =
{
  {
    { { { 0ui64, 0ui64 } } },
    0u,
    0u,
    0u,
    { 0u },
    0u,
    { 0u },
    NonPagedPool,
    0u,
    0u,
    { NULL },
    { NULL },
    { NULL, NULL },
    0u,
    { 0u },
    { 0u, 0u }
  }
}; // idb
int dword_140013580 = 0; // weak
int dword_140013584 = 0; // weak
int dword_140013588 = 0; // weak
int dword_14001358C = 0; // weak
int dword_140013590 = 0; // weak
_UNKNOWN unk_140013594; // weak
int dword_140013598 = 0; // weak
int dword_14001359C = 0; // weak
_UNKNOWN unk_1400135A0; // weak
_UNKNOWN unk_140013D84; // weak
KSPIN_LOCK qword_140014580; // idb
KIRQL byte_140014588; // idb
int dword_140014590; // weak
int dword_140014594; // weak
__int128 xmmword_1400145A0; // weak
__int128 xmmword_1400145B0; // weak
__int128 xmmword_1400145C0; // weak
__int64 (__fastcall *xmmword_1400145D0)(_QWORD, _QWORD); // weak
__int64 (__fastcall *xmmword_1400145E0)(_QWORD); // weak
__int64 (*xmmword_1400145F0)(void); // weak
_UNKNOWN unk_140014600; // weak
__int64 qword_140014608; // weak
__int64 qword_140014610; // weak
__int64 qword_140014618; // weak
__int64 qword_140014620; // weak
__int64 qword_140014628; // weak
__int64 qword_140014630; // weak
__int64 qword_140014638; // weak
__int64 qword_140014640; // weak
__int64 qword_140014648; // weak
__int64 qword_140014650; // weak
__int64 qword_140014658; // weak
__int64 qword_140014660; // weak
_UNKNOWN unk_140014668; // weak
_UNKNOWN unk_140014670; // weak
_UNKNOWN unk_140014678; // weak
_UNKNOWN unk_140014680; // weak
__int64 qword_140014688; // weak
__int64 qword_140014690; // weak
_DEVICE_OBJECT stru_1400146A0; // idb


//----- (0000000140001000) ----------------------------------------------------
__int64 __fastcall sub_140001000(_BYTE *a1, unsigned int a2, __int16 a3)
{
  while ( a3 )
  {
    --a3;
    a2 = (a2 >> 8) ^ dword_140013000[(unsigned __int8)(a2 ^ *a1++)];
  }
  return a2;
}

//----- (000000014000103C) ----------------------------------------------------
void sub_14000103C()
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xCu, (__int64)&unk_140012320);
  }
  if ( NdisDeviceHandle )
    NdisDeregisterDeviceEx(NdisDeviceHandle);
  NdisDeviceHandle = 0i64;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xDu, (__int64)&unk_140012320);
  }
}

//----- (00000001400010D0) ----------------------------------------------------
__int64 __fastcall sub_1400010D0(_DEVICE_OBJECT *a1, IRP *a2)
{
  _IO_STACK_LOCATION *v2; // rsi
  unsigned int v3; // ebx
  unsigned int v5; // ebp
  ULONG v7; // er14
  _IRP *v8; // rsi
  KIRQL v9; // al
  const void **v10; // rbx
  int v11; // eax
  const void **v12; // rax

  v2 = a2->Tail.Overlay.CurrentStackLocation;
  v3 = 0;
  v5 = 0;
  if ( !v2->FileObject )
    return 3221225473i64;
  NdisGetDeviceReservedExtension(a1);
  a2->IoStatus.Information = 0i64;
  if ( v2->Parameters.Read.ByteOffset.LowPart == 1507332 )
  {
    v12 = sub_140001604(a2->AssociatedIrp.MasterIrp, v2->Parameters.Create.Options);
    if ( v12 )
      NdisFRestartFilter((NDIS_HANDLE)v12[2]);
  }
  else if ( v2->Parameters.Read.ByteOffset.LowPart == 1507336 )
  {
    v7 = v2->Parameters.Read.Length;
    v8 = a2->AssociatedIrp.MasterIrp;
    v9 = KeAcquireSpinLockRaiseToDpc((PKSPIN_LOCK)&stru_1400146A0.Queue);
    v10 = (const void **)stru_1400146A0.DeviceExtension;
    LOBYTE(stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink) = v9;
    while ( v10 != (const void **)&stru_1400146A0.DeviceExtension )
    {
      v11 = *((unsigned __int16 *)v10 + 12);
      v5 += v11 + 2;
      if ( v5 <= v7 )
      {
        v8->Type = v11;
        memmove(&v8->Size, v10[4], *((unsigned __int16 *)v10 + 12));
        v8 = (_IRP *)((char *)v8 + *((unsigned __int16 *)v10 + 12) + 2);
      }
      v10 = (const void **)*v10;
    }
    KeReleaseSpinLock((PKSPIN_LOCK)&stru_1400146A0.Queue, (KIRQL)stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink);
    v3 = v7 < v5 ? 0xC0000023 : 0;
  }
  a2->IoStatus.Information = v5;
  a2->IoStatus.Status = v3;
  IofCompleteRequest(a2, 0);
  return v3;
}

//----- (0000000140001200) ----------------------------------------------------
__int64 __fastcall sub_140001200(__int64 a1, IRP *a2)
{
  a2->IoStatus.Status = 0;
  IofCompleteRequest(a2, 0);
  return 0i64;
}

//----- (000000014000121C) ----------------------------------------------------
__int64 sub_14000121C()
{
  unsigned int v0; // ebx
  _QWORD *v1; // rax
  struct _NDIS_DEVICE_OBJECT_ATTRIBUTES DeviceObjectAttributes; // [rsp+20h] [rbp-E0h] BYREF
  struct _UNICODE_STRING DestinationString; // [rsp+58h] [rbp-A8h] BYREF
  struct _UNICODE_STRING v5; // [rsp+68h] [rbp-98h] BYREF
  __int64 Dst[28]; // [rsp+80h] [rbp-80h] BYREF

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xAu, (__int64)&unk_140012320);
  }
  memset(Dst, 0, sizeof(Dst));
  Dst[0] = (__int64)sub_140001200;
  Dst[18] = (__int64)sub_140001200;
  Dst[2] = (__int64)sub_140001200;
  Dst[14] = (__int64)sub_1400010D0;
  Dst[15] = (__int64)sub_1400013B0;
  RtlInitUnicodeString(&DestinationString, L"\\Device\\NNSNAHS");
  RtlInitUnicodeString(&v5, L"\\DosDevices\\NNSNAHS");
  *((_DWORD *)&DeviceObjectAttributes.Header + 1) = 0;
  HIDWORD(DeviceObjectAttributes.DeviceClassGuid) = 0;
  DeviceObjectAttributes.DeviceName = &DestinationString;
  DeviceObjectAttributes.Header = (NDIS_OBJECT_HEADER)3670405;
  DeviceObjectAttributes.SymbolicName = &v5;
  DeviceObjectAttributes.ExtensionSize = 16;
  DeviceObjectAttributes.MajorFunctions = (PDRIVER_DISPATCH *)Dst;
  *(_OWORD *)(&DeviceObjectAttributes.ExtensionSize + 1) = 0i64;
  v0 = NdisRegisterDeviceEx(
         stru_1400146A0.Queue.Wcb.DeviceRoutine,
         &DeviceObjectAttributes,
         &DeviceObject,
         &NdisDeviceHandle);
  if ( !v0 )
  {
    v1 = NdisGetDeviceReservedExtension(DeviceObject);
    *(_DWORD *)v1 = 1179927634;
    v1[1] = stru_1400146A0.Queue.Wcb.DeviceRoutine;
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001580((__int64)off_140013400->AttachedDevice, 0xBu, (__int64)&unk_140012320, v0);
  }
  return v0;
}

//----- (00000001400013B0) ----------------------------------------------------
__int64 __fastcall sub_1400013B0(__int64 a1, IRP *a2)
{
  unsigned int v3; // ebx
  _IO_STACK_LOCATION *v4; // rdx
  __int64 v5; // rdi
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  _IRP *v8; // rcx

  v3 = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 8u)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xEu, (__int64)&unk_140012320);
  }
  v4 = a2->Tail.Overlay.CurrentStackLocation;
  v5 = 0i64;
  if ( v4->MajorFunction != 14 )
  {
    if ( v4->MajorFunction != 15 )
      goto LABEL_30;
    if ( v4->Parameters.Read.ByteOffset.LowPart != 2240224 )
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 8u)
        && BYTE1(off_140013400->Timer) >= 3u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x12u, (__int64)&unk_140012320);
      }
      v3 = -1073741811;
      goto LABEL_30;
    }
    v5 = 96i64;
    if ( v4->Parameters.Create.Options == 96 )
    {
      v8 = a2->AssociatedIrp.MasterIrp;
      if ( *(_DWORD *)&v8->Type == 12 )
      {
        sub_14000F7F8((__int64)v8);
        goto LABEL_30;
      }
      v6 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 8u)
        || BYTE1(off_140013400->Timer) < 3u )
      {
        goto LABEL_19;
      }
      v7 = 17;
    }
    else
    {
      v6 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 8u)
        || BYTE1(off_140013400->Timer) < 3u )
      {
        goto LABEL_19;
      }
      v7 = 16;
    }
    sub_1400015BC((__int64)v6->AttachedDevice, v7, (__int64)&unk_140012320, 96);
LABEL_19:
    v3 = -1073741811;
    v5 = 0i64;
    goto LABEL_30;
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 8u)
    && BYTE1(off_140013400->Timer) >= 3u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xFu, (__int64)&unk_140012320);
  }
LABEL_30:
  a2->IoStatus.Information = v5;
  a2->IoStatus.Status = v3;
  IofCompleteRequest(a2, 0);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 8u)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x13u, (__int64)&unk_140012320);
  }
  return v3;
}

//----- (0000000140001558) ----------------------------------------------------
__int64 __fastcall sub_140001558(__int64 a1, unsigned __int16 a2, __int64 a3)
{
  return qword_140013488(a1, 43i64, a3, a2, 0i64);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140001580) ----------------------------------------------------
__int64 __fastcall sub_140001580(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+68h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140013488(a1, 43i64, a3, a2, &v5);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001400015BC) ----------------------------------------------------
__int64 __fastcall sub_1400015BC(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140013488(a1, 43i64, a3, a2, &v5);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140001604) ----------------------------------------------------
const void **__fastcall sub_140001604(void *Buf1, unsigned int a2)
{
  KIRQL v4; // al
  const void **v5; // rbx

  v4 = KeAcquireSpinLockRaiseToDpc((PKSPIN_LOCK)&stru_1400146A0.Queue);
  v5 = (const void **)stru_1400146A0.DeviceExtension;
  LOBYTE(stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink) = v4;
  while ( v5 != (const void **)&stru_1400146A0.DeviceExtension )
  {
    if ( a2 >= *((unsigned __int16 *)v5 + 12) && !memcmp(Buf1, v5[4], *((unsigned __int16 *)v5 + 12)) )
      goto LABEL_7;
    v5 = (const void **)*v5;
  }
  v5 = 0i64;
LABEL_7:
  KeReleaseSpinLock((PKSPIN_LOCK)&stru_1400146A0.Queue, (KIRQL)stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink);
  return v5;
}

//----- (0000000140001690) ----------------------------------------------------
void __fastcall sub_140001690(__int64 a1, _NET_BUFFER_LIST *a2, NDIS_PORT_NUMBER a3, ULONG a4)
{
  KSPIN_LOCK *v8; // rcx
  unsigned __int8 v9; // r14
  KSPIN_LOCK *v10; // rcx
  _NET_BUFFER_LIST *i; // rax
  unsigned int v12; // er8
  SLIST_HEADER *v13; // rax
  unsigned __int64 v14; // rdi
  KSPIN_LOCK *v15; // rcx
  SLIST_HEADER *v16; // rax
  int v17; // ecx
  KSPIN_LOCK *v18; // rcx
  __int64 v19; // [rsp+20h] [rbp-38h]
  unsigned int v20; // [rsp+60h] [rbp+8h] BYREF
  char v21; // [rsp+78h] [rbp+20h] BYREF

  v21 = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x40) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000BAF4((__int64)off_140013400->AttachedDevice, 0x7Cu, (__int64)&unk_140012330, a2, *(_QWORD *)(a1 + 48), a3);
  }
  v8 = (KSPIN_LOCK *)(a1 + 104);
  v9 = a4 & 1;
  if ( (a4 & 1) != 0 )
    KeAcquireSpinLockAtDpcLevel(v8);
  else
    *(_BYTE *)(a1 + 112) = KeAcquireSpinLockRaiseToDpc(v8);
  v10 = (KSPIN_LOCK *)(a1 + 104);
  if ( *(_DWORD *)(a1 + 120) != 4 )
  {
    if ( v9 )
      KeReleaseSpinLockFromDpcLevel(v10);
    else
      KeReleaseSpinLock(v10, *(_BYTE *)(a1 + 112));
    for ( i = a2; i; i = (_NET_BUFFER_LIST *)i->Link.Alignment )
      i->Status = -1071448022;
    NdisFSendNetBufferListsComplete(*(NDIS_HANDLE *)(a1 + 16), a2, v9);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x40) != 0
      && BYTE1(off_140013400->Timer) >= 3u )
    {
      sub_140001580((__int64)off_140013400->AttachedDevice, 0x7Du, (__int64)&unk_140012330, *(_DWORD *)(a1 + 120));
    }
    return;
  }
  if ( v9 )
    KeReleaseSpinLockFromDpcLevel(v10);
  else
    KeReleaseSpinLock(v10, *(_BYTE *)(a1 + 112));
  v12 = 0;
  if ( a2 )
  {
    v13 = (SLIST_HEADER *)a2;
    do
    {
      v13 = (SLIST_HEADER *)v13->Alignment;
      ++v12;
    }
    while ( v13 );
  }
  v20 = v12;
  v14 = v12;
  _InterlockedExchangeAdd64(&qword_140014628, v12);
  _InterlockedExchangeAdd64((volatile signed __int64 *)(a1 + 144), v12);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x1000000) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    LODWORD(v19) = v12;
    sub_14000BCB4(
      (__int64)off_140013400->AttachedDevice,
      0x7Eu,
      (__int64)&unk_140012330,
      *(_QWORD *)(a1 + 16),
      v19,
      *(_QWORD *)(a1 + 144));
  }
  if ( !(unsigned int)sub_14000F090() )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x40) != 0
      && BYTE1(off_140013400->Timer) >= 3u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x80u, (__int64)&unk_140012330);
    }
    goto LABEL_41;
  }
  if ( (unsigned int)(dword_140013584 - 2) <= 1 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x40) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x7Fu, (__int64)&unk_140012330);
    }
    v21 = 1;
  }
  else if ( dword_140013588 )
  {
    sub_140004A00(a1, a4, a3, a2, &v20, (bool *)&v21);
  }
  else
  {
    sub_140004E78(a1, a4 & 1, a4, a2, (bool *)&v21);
  }
  sub_140010180();
  if ( v21 )
  {
    if ( dword_140013588 == 1 )
      _InterlockedExchangeAdd64(&qword_140014640, v14);
LABEL_41:
    if ( *(_BYTE *)(a1 + 237) )
    {
      v15 = (KSPIN_LOCK *)(a1 + 104);
      if ( v9 )
        KeAcquireSpinLockAtDpcLevel(v15);
      else
        *(_BYTE *)(a1 + 112) = KeAcquireSpinLockRaiseToDpc(v15);
      v16 = (SLIST_HEADER *)a2;
      if ( a2 )
      {
        v17 = *(_DWORD *)(a1 + 128);
        do
        {
          *(_DWORD *)(a1 + 128) = ++v17;
          v16 = (SLIST_HEADER *)v16->Alignment;
        }
        while ( v16 );
      }
      v18 = (KSPIN_LOCK *)(a1 + 104);
      if ( v9 )
        KeReleaseSpinLockFromDpcLevel(v18);
      else
        KeReleaseSpinLock(v18, *(_BYTE *)(a1 + 112));
    }
    NdisFSendNetBufferLists(*(NDIS_HANDLE *)(a1 + 16), a2, a3, a4);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( (HIDWORD(off_140013400->Timer) & 1) != 0 && BYTE1(off_140013400->Timer) >= 4u )
        sub_140001580((__int64)off_140013400->AttachedDevice, 0x81u, (__int64)&unk_140012330, a2->Status);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x40) != 0
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x82u, (__int64)&unk_140012330);
      }
    }
    return;
  }
  if ( !dword_140013588 )
    _InterlockedExchangeAdd64((volatile signed __int64 *)(a1 + 144), -(__int64)v14);
}
// 140001840: variable 'v19' is possibly undefined
// 140013584: using guessed type int dword_140013584;
// 140013588: using guessed type int dword_140013588;
// 140014628: using guessed type __int64 qword_140014628;
// 140014640: using guessed type __int64 qword_140014640;

//----- (0000000140001A40) ----------------------------------------------------
__int64 __fastcall sub_140001A40(__int64 a1, _NET_BUFFER_LIST *a2, ULONG a3)
{
  _NET_BUFFER_LIST *v3; // r14
  SLIST_HEADER *v5; // r15
  char v6; // r12
  _NET_BUFFER_LIST *v7; // rbx
  PNET_BUFFER_LIST_CONTEXT v8; // rbp
  char *v9; // rsi
  _NET_BUFFER_LIST *v10; // rbp
  const char *v11; // r9
  const char *v12; // r9
  __int64 result; // rax
  PDEVICE_OBJECT v14; // rcx
  unsigned __int16 v15; // dx
  KSPIN_LOCK *v16; // rcx
  KSPIN_LOCK *v17; // rcx
  char v18; // [rsp+90h] [rbp+8h]

  v3 = a2;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000B808((__int64)off_140013400->AttachedDevice, 0xBCu, (__int64)&unk_140012330, a2);
  }
  v5 = 0i64;
  v6 = 0;
  v7 = v3;
  do
  {
    v18 = 0;
    if ( v7->Context
      && (v8 = v7->Context, sub_14000E3C8(32) == v8->Size)
      && (v9 = (char *)v8 + v8->Offset, v9[20] == 78)
      && v9[21] == 65
      && v9[22] == 72
      && v9[23] == 83
      && v9[24] == 76
      && !v9[25] )
    {
      v10 = (_NET_BUFFER_LIST *)v7->Link.Alignment;
      v18 = 1;
      if ( v7 == v3 )
        v3 = (_NET_BUFFER_LIST *)v7->Link.Alignment;
      else
        v5->Alignment = (ULONGLONG)v10;
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
      {
        if ( (HIDWORD(off_140013400->Timer) & 8) != 0 && BYTE1(off_140013400->Timer) >= 4u )
          sub_14000BA60(
            (__int64)off_140013400->AttachedDevice,
            0xBDu,
            (__int64)&unk_140012330,
            v7,
            *(_QWORD *)(a1 + 136));
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 8) != 0
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          v11 = "ERROR";
          if ( !v7->Status )
            v11 = (const char *)qword_140011020;
          sub_14000C02C((__int64)off_140013400->AttachedDevice, 0xBEu, (__int64)&unk_140012330, v11);
        }
      }
      if ( *((_DWORD *)v9 + 10) )
        sub_140006EBC(v7);
      else
        sub_1400069CC(v7);
      v7 = v10;
    }
    else
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
      {
        if ( (HIDWORD(off_140013400->Timer) & 1) != 0 && BYTE1(off_140013400->Timer) >= 4u )
          sub_14000B808((__int64)off_140013400->AttachedDevice, 0xBFu, (__int64)&unk_140012330, v7);
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 0x10) != 0
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          v12 = "ERROR";
          if ( !v7->Status )
            v12 = (const char *)qword_140011020;
          sub_14000C02C((__int64)off_140013400->AttachedDevice, 0xC0u, (__int64)&unk_140012330, v12);
        }
      }
      v5 = (SLIST_HEADER *)v7;
      v6 = 1;
      v7 = (_NET_BUFFER_LIST *)v7->Link.Alignment;
    }
    _InterlockedDecrement64((volatile signed __int64 *)(a1 + 136));
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x1000000) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_14000BA60(
        (__int64)off_140013400->AttachedDevice,
        0xC1u,
        (__int64)&unk_140012330,
        *(_QWORD *)(a1 + 16),
        *(_QWORD *)(a1 + 136));
    }
    result = (__int64)&unk_140014668;
    if ( !v18 )
      result = (__int64)&unk_140014678;
    _InterlockedIncrement64((volatile signed __int64 *)result);
  }
  while ( v7 );
  if ( v6 )
  {
    NdisFReturnNetBufferLists(*(NDIS_HANDLE *)(a1 + 16), v3, a3);
    if ( *(_BYTE *)(a1 + 236) )
    {
      v16 = (KSPIN_LOCK *)(a1 + 104);
      if ( (a3 & 1) != 0 )
        KeAcquireSpinLockAtDpcLevel(v16);
      else
        *(_BYTE *)(a1 + 112) = KeAcquireSpinLockRaiseToDpc(v16);
      *(_DWORD *)(a1 + 132) = *(_DWORD *)(a1 + 132);
      v17 = (KSPIN_LOCK *)(a1 + 104);
      if ( (a3 & 1) != 0 )
        KeReleaseSpinLockFromDpcLevel(v17);
      else
        KeReleaseSpinLock(v17, *(_BYTE *)(a1 + 112));
    }
    v14 = off_140013400;
    result = (__int64)&off_140013400;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      result = HIDWORD(off_140013400->Timer);
      if ( (result & 1) != 0 && BYTE1(off_140013400->Timer) >= 5u )
      {
        v15 = 195;
        return sub_140001558((__int64)v14->AttachedDevice, v15, (__int64)&unk_140012330);
      }
    }
  }
  else
  {
    v14 = off_140013400;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      result = HIDWORD(off_140013400->Timer);
      if ( (result & 1) != 0 && BYTE1(off_140013400->Timer) >= 5u )
      {
        v15 = 194;
        return sub_140001558((__int64)v14->AttachedDevice, v15, (__int64)&unk_140012330);
      }
    }
  }
  return result;
}
// 140001DBA: conditional instruction was optimized away because of 'rbx.8==0'
// 140011020: using guessed type __int64 qword_140011020[2];

//----- (0000000140001E70) ----------------------------------------------------
__int64 __fastcall sub_140001E70(__int64 a1, _NET_BUFFER_LIST *a2, ULONG a3)
{
  _NET_BUFFER_LIST *v3; // rbp
  char v5; // r13
  SLIST_HEADER *v6; // r15
  _NET_BUFFER_LIST *v7; // rbx
  PNET_BUFFER_LIST_CONTEXT v8; // r14
  char *v9; // rsi
  _NET_BUFFER_LIST *v10; // r14
  const char *v11; // r9
  const char *v12; // r9
  __int64 result; // rax
  int v14; // er15
  PDEVICE_OBJECT v15; // rcx
  unsigned __int16 v16; // dx
  SLIST_HEADER *v17; // rax
  ULONG v18; // er14
  KSPIN_LOCK *v19; // rcx
  KSPIN_LOCK *v20; // rcx
  char v21; // [rsp+90h] [rbp+8h]

  v3 = a2;
  v5 = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000B808((__int64)off_140013400->AttachedDevice, 0x94u, (__int64)&unk_140012330, a2);
  }
  v6 = 0i64;
  v7 = v3;
  do
  {
    v21 = 0;
    if ( v7->Context
      && (v8 = v7->Context, sub_14000E3C8(32) == v8->Size)
      && (v9 = (char *)v8 + v8->Offset, v9[20] == 78)
      && v9[21] == 65
      && v9[22] == 72
      && v9[23] == 83
      && v9[24] == 76
      && !v9[25] )
    {
      v10 = (_NET_BUFFER_LIST *)v7->Link.Alignment;
      v21 = 1;
      if ( v7 == v3 )
        v3 = (_NET_BUFFER_LIST *)v7->Link.Alignment;
      else
        v6->Alignment = (ULONGLONG)v10;
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
      {
        if ( (HIDWORD(off_140013400->Timer) & 0x10) != 0 && BYTE1(off_140013400->Timer) >= 4u )
          sub_14000BA60(
            (__int64)off_140013400->AttachedDevice,
            0x96u,
            (__int64)&unk_140012330,
            v7,
            *(_QWORD *)(a1 + 144));
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 0x10) != 0
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          v11 = "ERROR";
          if ( !v7->Status )
            v11 = (const char *)qword_140011020;
          sub_14000C02C((__int64)off_140013400->AttachedDevice, 0x97u, (__int64)&unk_140012330, v11);
        }
      }
      if ( *((_DWORD *)v9 + 10) )
        sub_140006EBC(v7);
      else
        sub_1400069CC(v7);
      v7 = v10;
    }
    else
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
      {
        if ( (HIDWORD(off_140013400->Timer) & 1) != 0 && BYTE1(off_140013400->Timer) >= 4u )
          sub_14000B808((__int64)off_140013400->AttachedDevice, 0x98u, (__int64)&unk_140012330, v7);
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 0x10) != 0
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          v12 = "ERROR";
          if ( !v7->Status )
            v12 = (const char *)qword_140011020;
          sub_14000C02C((__int64)off_140013400->AttachedDevice, 0x99u, (__int64)&unk_140012330, v12);
        }
      }
      v6 = (SLIST_HEADER *)v7;
      v5 = 1;
      v7 = (_NET_BUFFER_LIST *)v7->Link.Alignment;
    }
    _InterlockedDecrement64((volatile signed __int64 *)(a1 + 144));
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x1000000) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_14000BA60(
        (__int64)off_140013400->AttachedDevice,
        0x9Au,
        (__int64)&unk_140012330,
        *(_QWORD *)(a1 + 16),
        *(_QWORD *)(a1 + 144));
    }
    result = (__int64)&unk_140014670;
    if ( !v21 )
      result = (__int64)&unk_140014680;
    _InterlockedIncrement64((volatile signed __int64 *)result);
  }
  while ( v7 );
  v14 = 0;
  if ( v5 )
  {
    if ( *(_BYTE *)(a1 + 237) )
    {
      v17 = (SLIST_HEADER *)v3;
      if ( v3 )
      {
        do
        {
          v17 = (SLIST_HEADER *)v17->Alignment;
          ++v14;
        }
        while ( v17 );
      }
      v18 = a3;
      v19 = (KSPIN_LOCK *)(a1 + 104);
      if ( (a3 & 1) != 0 )
        KeAcquireSpinLockAtDpcLevel(v19);
      else
        *(_BYTE *)(a1 + 112) = KeAcquireSpinLockRaiseToDpc(v19);
      *(_DWORD *)(a1 + 128) -= v14;
      v20 = (KSPIN_LOCK *)(a1 + 104);
      if ( (a3 & 1) != 0 )
        KeReleaseSpinLockFromDpcLevel(v20);
      else
        KeReleaseSpinLock(v20, *(_BYTE *)(a1 + 112));
    }
    else
    {
      v18 = a3;
    }
    NdisFSendNetBufferListsComplete(*(NDIS_HANDLE *)(a1 + 16), v3, v18);
    v15 = off_140013400;
    result = (__int64)&off_140013400;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      result = HIDWORD(off_140013400->Timer);
      if ( (result & 1) != 0 && BYTE1(off_140013400->Timer) >= 5u )
      {
        v16 = 156;
        return sub_140001558((__int64)v15->AttachedDevice, v16, (__int64)&unk_140012330);
      }
    }
  }
  else
  {
    v15 = off_140013400;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      result = HIDWORD(off_140013400->Timer);
      if ( (result & 1) != 0 && BYTE1(off_140013400->Timer) >= 5u )
      {
        v16 = 155;
        return sub_140001558((__int64)v15->AttachedDevice, v16, (__int64)&unk_140012330);
      }
    }
  }
  return result;
}
// 140011020: using guessed type __int64 qword_140011020[2];

//----- (00000001400022B0) ----------------------------------------------------
void __fastcall sub_1400022B0(__int64 a1, _NET_BUFFER_LIST *a2, NDIS_PORT_NUMBER a3, ULONG a4, ULONG a5)
{
  unsigned int v5; // er15
  _NET_BUFFER_LIST *v6; // rsi
  ULONG v8; // er12
  KSPIN_LOCK *v9; // rcx
  char v10; // r13
  KSPIN_LOCK *v11; // rcx
  ULONG v12; // er14
  ULONG v13; // esi
  NDIS_PORT_NUMBER v14; // er14
  KSPIN_LOCK *v15; // rcx
  KSPIN_LOCK *v16; // rcx
  NDIS_PORT_NUMBER v17; // er8
  PNET_BUFFER_LIST v18; // r14
  KSPIN_LOCK *v19; // rcx
  KSPIN_LOCK *v20; // rcx
  __int64 ReceiveFlags; // [rsp+20h] [rbp-28h]
  char v22; // [rsp+90h] [rbp+48h] BYREF
  PNET_BUFFER_LIST NetBufferLists; // [rsp+98h] [rbp+50h] BYREF
  NDIS_PORT_NUMBER PortNumber; // [rsp+A0h] [rbp+58h]
  ULONG NumberOfNetBufferLists; // [rsp+A8h] [rbp+60h] BYREF

  NumberOfNetBufferLists = a4;
  PortNumber = a3;
  NetBufferLists = a2;
  v5 = a4;
  v22 = 0;
  v6 = a2;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x20) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000BBFC(
      (__int64)off_140013400->AttachedDevice,
      0x9Du,
      (__int64)&unk_140012330,
      a2,
      a4,
      *(_QWORD *)(a1 + 48),
      a3);
  }
  v8 = a5;
  v9 = (KSPIN_LOCK *)(a1 + 104);
  v10 = a5 & 1;
  if ( (a5 & 1) != 0 )
    KeAcquireSpinLockAtDpcLevel(v9);
  else
    *(_BYTE *)(a1 + 112) = KeAcquireSpinLockRaiseToDpc(v9);
  v11 = (KSPIN_LOCK *)(a1 + 104);
  if ( *(_DWORD *)(a1 + 120) != 4 )
  {
    if ( v10 )
      KeReleaseSpinLockFromDpcLevel(v11);
    else
      KeReleaseSpinLock(v11, *(_BYTE *)(a1 + 112));
    if ( (v8 & 2) == 0 )
    {
      NdisFReturnNetBufferLists(*(NDIS_HANDLE *)(a1 + 16), v6, v8 & 1);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x20) != 0
        && BYTE1(off_140013400->Timer) >= 3u )
      {
        sub_140001580((__int64)off_140013400->AttachedDevice, 0x9Eu, (__int64)&unk_140012330, *(_DWORD *)(a1 + 120));
      }
    }
    return;
  }
  if ( v10 )
    KeReleaseSpinLockFromDpcLevel(v11);
  else
    KeReleaseSpinLock(v11, *(_BYTE *)(a1 + 112));
  v12 = 0;
  while ( v6 )
  {
    v6 = (_NET_BUFFER_LIST *)v6->Link.Alignment;
    ++v12;
  }
  if ( v12 != v5 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x20) != 0
      && BYTE1(off_140013400->Timer) >= 3u )
    {
      sub_1400015BC((__int64)off_140013400->AttachedDevice, 0x9Fu, (__int64)&unk_140012330, v5);
    }
    v5 = v12;
    NumberOfNetBufferLists = v12;
  }
  _InterlockedExchangeAdd64(&qword_140014620, v5);
  _InterlockedExchangeAdd64((volatile signed __int64 *)(a1 + 136), v5);
  v13 = NumberOfNetBufferLists;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x1000000) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    LODWORD(ReceiveFlags) = NumberOfNetBufferLists;
    sub_14000BCB4(
      (__int64)off_140013400->AttachedDevice,
      0xA0u,
      (__int64)&unk_140012330,
      *(_QWORD *)(a1 + 16),
      ReceiveFlags,
      *(_QWORD *)(a1 + 136));
  }
  if ( !(unsigned int)sub_14000F090() )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x20) != 0
      && BYTE1(off_140013400->Timer) >= 3u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0xA2u, (__int64)&unk_140012330);
    }
    v14 = PortNumber;
    goto LABEL_54;
  }
  if ( ((dword_140013584 - 1) & 0xFFFFFFFD) != 0 )
  {
    if ( dword_140013588 )
    {
      v14 = PortNumber;
      sub_140003CFC(a1, v8, PortNumber, &NetBufferLists, &NumberOfNetBufferLists, (bool *)&v22);
      v13 = NumberOfNetBufferLists;
      goto LABEL_44;
    }
    sub_140004220(a1, v8, NetBufferLists, &v22);
  }
  else
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x20) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0xA1u, (__int64)&unk_140012330);
    }
    v22 = 1;
  }
  v14 = PortNumber;
LABEL_44:
  sub_140010180();
  if ( v22 )
  {
    if ( dword_140013588 == 1 )
    {
      _InterlockedExchangeAdd64(&qword_140014638, v13);
      v13 = NumberOfNetBufferLists;
    }
LABEL_54:
    if ( *(_BYTE *)(a1 + 236) )
    {
      v15 = (KSPIN_LOCK *)(a1 + 104);
      if ( v10 )
        KeAcquireSpinLockAtDpcLevel(v15);
      else
        *(_BYTE *)(a1 + 112) = KeAcquireSpinLockRaiseToDpc(v15);
      *(_DWORD *)(a1 + 132) += v13;
      v16 = (KSPIN_LOCK *)(a1 + 104);
      if ( v10 )
        KeReleaseSpinLockFromDpcLevel(v16);
      else
        KeReleaseSpinLock(v16, *(_BYTE *)(a1 + 112));
    }
    v17 = v14;
    v18 = NetBufferLists;
    NdisFIndicateReceiveNetBufferLists(*(NDIS_HANDLE *)(a1 + 16), NetBufferLists, v17, v13, v8);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x20) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001580((__int64)off_140013400->AttachedDevice, 0xA3u, (__int64)&unk_140012330, v18->Status);
    }
    if ( (v8 & 2) != 0 && *(_BYTE *)(a1 + 236) )
    {
      v19 = (KSPIN_LOCK *)(a1 + 104);
      if ( v10 )
        KeAcquireSpinLockAtDpcLevel(v19);
      else
        *(_BYTE *)(a1 + 112) = KeAcquireSpinLockRaiseToDpc(v19);
      *(_DWORD *)(a1 + 132) -= v13;
      v20 = (KSPIN_LOCK *)(a1 + 104);
      if ( v10 )
        KeReleaseSpinLockFromDpcLevel(v20);
      else
        KeReleaseSpinLock(v20, *(_BYTE *)(a1 + 112));
    }
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x20) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001580((__int64)off_140013400->AttachedDevice, 0xA4u, (__int64)&unk_140012330, v8);
    }
    return;
  }
  if ( !dword_140013588 )
    _InterlockedExchangeAdd64((volatile signed __int64 *)(a1 + 136), -(__int64)v13);
}
// 14000249B: variable 'ReceiveFlags' is possibly undefined
// 140013584: using guessed type int dword_140013584;
// 140013588: using guessed type int dword_140013588;
// 140014620: using guessed type __int64 qword_140014620;
// 140014638: using guessed type __int64 qword_140014638;

//----- (00000001400026E0) ----------------------------------------------------
__int64 __fastcall sub_1400026E0(NDIS_HANDLE NdisFilterHandle, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // r15
  int v7; // esi
  const char *v8; // rbx
  const char *v9; // rax
  int v10; // edi
  PDEVICE_OBJECT v11; // rbx
  const char *v12; // rax
  UINT v13; // ebx
  PVOID *v14; // rax
  PVOID *v15; // rsi
  unsigned int v16; // edx
  __int64 v17; // rcx
  char *v18; // rax
  size_t v19; // r8
  char *v20; // rcx
  __int64 v21; // rcx
  char *v22; // rax
  size_t v23; // r8
  char *v24; // rcx
  unsigned int v25; // er15
  _QWORD *v26; // rax
  NDIS_HANDLE v27; // rax
  __int16 v28; // r8
  _BYTE *v29; // rcx
  int v30; // er9
  int v31; // eax
  _WORD *v32; // rbx
  __int64 v33; // r8
  wchar_t *v34; // rbx
  PDEVICE_OBJECT v35; // rcx
  unsigned __int16 v36; // dx
  PDEVICE_OBJECT v37; // rbx
  const char *v38; // rax
  struct _NDIS_FILTER_ATTRIBUTES FilterAttributes; // [rsp+50h] [rbp-19h] BYREF
  void *Src; // [rsp+58h] [rbp-11h] BYREF
  PVOID P; // [rsp+60h] [rbp-9h] BYREF
  struct _NET_BUFFER_LIST_POOL_PARAMETERS Parameters; // [rsp+68h] [rbp-1h] BYREF
  struct _NET_BUFFER_POOL_PARAMETERS v44; // [rsp+78h] [rbp+Fh] BYREF

  Src = 0i64;
  P = 0i64;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000B808((__int64)off_140013400->AttachedDevice, 0x1Du, (__int64)&unk_140012330, NdisFilterHandle);
  }
  if ( a2 != *(_QWORD *)&stru_1400146A0.Queue.Wcb.NumberOfChannels )
    goto LABEL_112;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Eu, (__int64)&unk_140012330);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 4u )
        sub_14000B844(
          (__int64)off_140013400->AttachedDevice,
          0x1Fu,
          (__int64)&unk_140012330,
          **(unsigned __int16 **)(a3 + 16),
          *(const wchar_t **)(*(_QWORD *)(a3 + 16) + 8i64));
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
      {
        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 4u )
          sub_14000B844(
            (__int64)off_140013400->AttachedDevice,
            0x20u,
            (__int64)&unk_140012330,
            **(unsigned __int16 **)(a3 + 40),
            *(const wchar_t **)(*(_QWORD *)(a3 + 40) + 8i64));
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
        {
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_14000B844(
              (__int64)off_140013400->AttachedDevice,
              0x21u,
              (__int64)&unk_140012330,
              **(unsigned __int16 **)(a3 + 32),
              *(const wchar_t **)(*(_QWORD *)(a3 + 32) + 8i64));
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
          {
            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 4u )
              sub_14000B520(
                (__int64)off_140013400->AttachedDevice,
                0x22u,
                (__int64)&unk_140012330,
                *(unsigned __int16 *)(a3 + 96));
            v6 = off_140013400;
            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
            {
              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
                && BYTE1(off_140013400->Timer) >= 4u )
              {
                v7 = *(_DWORD *)(a3 + 72);
                v8 = sub_14000B310(*(_DWORD *)(a3 + 76));
                v9 = sub_14000B140(v7);
                sub_14000C0FC((__int64)v6->AttachedDevice, 0x23u, (__int64)&unk_140012330, v9, v7, (__int64)v8);
              }
              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
                && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
                && BYTE1(off_140013400->Timer) >= 4u )
              {
                sub_14000B924(
                  (__int64)off_140013400->AttachedDevice,
                  0x24u,
                  (__int64)&unk_140012330,
                  *(_DWORD *)(a3 + 24));
              }
            }
          }
        }
      }
    }
  }
  v10 = sub_140005B80(a3);
  v11 = off_140013400;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    v12 = sub_140006410(v10);
    sub_14000BFC8((__int64)v11->AttachedDevice, 0x26u, (__int64)&unk_140012330, v12);
  }
  if ( !v10 )
  {
    v37 = off_140013400;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      v38 = sub_14000B140(*(_DWORD *)(a3 + 72));
      sub_14000BFC8((__int64)v37->AttachedDevice, 0x27u, (__int64)&unk_140012330, v38);
    }
LABEL_112:
    v25 = -1073741811;
    goto LABEL_113;
  }
  v13 = **(unsigned __int16 **)(a3 + 32) + **(unsigned __int16 **)(a3 + 16) + **(unsigned __int16 **)(a3 + 40) + 646;
  v14 = (PVOID *)NdisAllocateMemoryWithTagPriority(NdisFilterHandle, v13, 0x4E46544Du, LowPoolPriority);
  v15 = v14;
  if ( !v14 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x28u, (__int64)&unk_140012330);
    }
    v25 = -1073741670;
    goto LABEL_113;
  }
  memset(v14, 0, v13);
  *((_DWORD *)v15 + 96) = v10;
  v16 = **(unsigned __int16 **)(a3 + 16);
  v15[4] = v15 + 80;
  *((_WORD *)v15 + 13) = v16;
  *((_WORD *)v15 + 12) = v16;
  memmove(v15 + 80, *(const void **)(*(_QWORD *)(a3 + 16) + 8i64), v16);
  v17 = *((unsigned __int16 *)v15 + 12);
  v18 = (char *)v15[4];
  v19 = **(unsigned __int16 **)(a3 + 32);
  *((_WORD *)v15 + 21) = v19;
  *((_WORD *)v15 + 20) = v19;
  v20 = &v18[v17 + 2];
  v15[6] = v20;
  memmove(v20, *(const void **)(*(_QWORD *)(a3 + 32) + 8i64), v19);
  v21 = *((unsigned __int16 *)v15 + 20);
  v22 = (char *)v15[6];
  v23 = **(unsigned __int16 **)(a3 + 40);
  *((_WORD *)v15 + 29) = v23;
  *((_WORD *)v15 + 28) = v23;
  v24 = &v22[v21 + 2];
  v15[8] = v24;
  memmove(v24, *(const void **)(*(_QWORD *)(a3 + 40) + 8i64), v23);
  *((_DWORD *)v15 + 18) = *(_DWORD *)(a3 + 24);
  *((_WORD *)v15 + 118) = 257;
  v15[2] = NdisFilterHandle;
  FilterAttributes.Flags = 0;
  FilterAttributes.Header = (NDIS_OBJECT_HEADER)524685;
  v25 = NdisFSetAttributes(NdisFilterHandle, v15, &FilterAttributes);
  if ( v25 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x29u, (__int64)&unk_140012330);
    }
    NdisFreeMemory(v15, 0, 0);
    goto LABEL_113;
  }
  *((_DWORD *)v15 + 30) = 3;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000B6A4((__int64)off_140013400->AttachedDevice, 0x2Au, (__int64)&unk_140012330, (const wchar_t *)v15[6]);
  }
  LOBYTE(stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink) = KeAcquireSpinLockRaiseToDpc((PKSPIN_LOCK)&stru_1400146A0.Queue);
  v26 = stru_1400146A0.DeviceExtension;
  if ( *((_DEVICE_OBJECT **)stru_1400146A0.DeviceExtension + 1) != (_DEVICE_OBJECT *)&stru_1400146A0.DeviceExtension )
    __fastfail(3u);
  *v15 = stru_1400146A0.DeviceExtension;
  v15[1] = &stru_1400146A0.DeviceExtension;
  v26[1] = v15;
  stru_1400146A0.DeviceExtension = v15;
  KeReleaseSpinLock((PKSPIN_LOCK)&stru_1400146A0.Queue, (KIRQL)stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink);
  Parameters.DataSize = 0;
  Parameters.Header = (NDIS_OBJECT_HEADER)1048960;
  Parameters.ProtocolId = 0;
  Parameters.ContextSize = sub_14000E3C8(32);
  Parameters.fAllocateNetBuffer = 1;
  Parameters.PoolTag = 1312901196;
  v15[78] = NdisAllocateNetBufferListPool(v15[2], &Parameters);
  v44.Header = (NDIS_OBJECT_HEADER)786816;
  *(_QWORD *)&v44.PoolTag = 1312901196i64;
  v27 = NdisAllocateNetBufferPool(v15[2], &v44);
  v28 = *((_WORD *)v15 + 20);
  v29 = v15[6];
  v15[79] = v27;
  v30 = sub_140001000(v29, 0, v28);
  *((_DWORD *)v15 + 62) = v30;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 4u )
      sub_14000B5AC((__int64)off_140013400->AttachedDevice, 0x2Bu, (__int64)&unk_140012330, v30, (__int64)v15[6]);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_14000B520(
        (__int64)off_140013400->AttachedDevice,
        0x2Cu,
        (__int64)&unk_140012330,
        *(unsigned __int16 *)(a3 + 96));
    }
  }
  if ( *(_WORD *)(a3 + 96) == 6 )
  {
    *((_DWORD *)v15 + 97) = *(_DWORD *)(a3 + 98);
    *((_WORD *)v15 + 196) = *(_WORD *)(a3 + 102);
  }
  *((_DWORD *)v15 + 99) = 0;
  v31 = sub_140005D00((__int64)v15);
  *((_DWORD *)v15 + 153) = -1;
  *((_DWORD *)v15 + 100) = v31;
  *((_DWORD *)v15 + 154) = *(_DWORD *)(a3 + 24);
  sub_140005648(*(const UNICODE_STRING **)(a3 + 40), &Src, &P);
  v32 = Src;
  if ( Src )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x2Du, (__int64)&unk_140012330);
    }
    v33 = -1i64;
    do
      ++v33;
    while ( v32[v33] );
    memmove(v15 + 51, v32, 2 * v33);
    if ( sub_14000CFD0((__int64)v32, (__int64)&unk_1400135A0) )
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
        && BYTE1(off_140013400->Timer) >= 2u )
      {
        sub_14000B6A4((__int64)off_140013400->AttachedDevice, 0x2Eu, (__int64)&unk_140012330, v32);
      }
      *((_DWORD *)v15 + 153) = 1;
    }
    sub_1400055B8(v32);
  }
  v34 = (wchar_t *)P;
  if ( P )
  {
    if ( sub_14000D438(6u, 2u, 4) )
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
        && BYTE1(off_140013400->Timer) >= 2u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x30u, (__int64)&unk_140012330);
      }
      if ( sub_14000CFD0((__int64)v34, (__int64)&unk_140013D84) )
      {
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
          && BYTE1(off_140013400->Timer) >= 2u )
        {
          sub_14000B6A4((__int64)off_140013400->AttachedDevice, 0x31u, (__int64)&unk_140012330, v34);
        }
        *((_DWORD *)v15 + 153) = 1;
      }
    }
    else if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
           && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
           && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x32u, (__int64)&unk_140012330);
    }
    sub_1400055B8(v34);
  }
  if ( !(unsigned int)sub_14000F090() )
  {
    v35 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return v25;
    if ( !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) || BYTE1(off_140013400->Timer) < 3u )
      goto LABEL_113;
    v36 = 53;
    goto LABEL_92;
  }
  sub_14000FD30((__int64)(v15 + 31));
  sub_140010180();
  v35 = off_140013400;
  if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
    return v25;
  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 4u )
  {
    v36 = 52;
LABEL_92:
    sub_140001580((__int64)v35->AttachedDevice, v36, (__int64)&unk_140012330, *((_DWORD *)v15 + 62));
  }
LABEL_113:
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001580((__int64)off_140013400->AttachedDevice, 0x36u, (__int64)&unk_140012330, v25);
  }
  return v25;
}

//----- (0000000140003050) ----------------------------------------------------
void __fastcall sub_140003050(__int64 a1, void *a2)
{
  KIRQL v4; // al
  __int64 v5; // rcx
  __int64 v6; // rcx

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x800) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x6Bu, (__int64)&unk_140012330);
  }
  v4 = KeAcquireSpinLockRaiseToDpc((PKSPIN_LOCK)(a1 + 104));
  v5 = *(_QWORD *)(a1 + 240);
  *(_BYTE *)(a1 + 112) = v4;
  if ( v5 && (v6 = *(_QWORD *)(v5 + 216)) != 0 && *(void **)(v6 + 16) == a2 )
  {
    KeReleaseSpinLock((PKSPIN_LOCK)(a1 + 104), v4);
    NdisFCancelOidRequest(*(NDIS_HANDLE *)(a1 + 16), a2);
  }
  else
  {
    KeReleaseSpinLock((PKSPIN_LOCK)(a1 + 104), v4);
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x800) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x6Cu, (__int64)&unk_140012330);
  }
}

//----- (0000000140003140) ----------------------------------------------------
void __fastcall sub_140003140(__int64 a1, void *a2)
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xC9u, (__int64)&unk_140012330);
  }
  NdisFCancelSendNetBufferLists(*(NDIS_HANDLE *)(a1 + 16), a2);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xCAu, (__int64)&unk_140012330);
  }
}

//----- (00000001400031E0) ----------------------------------------------------
void __fastcall sub_1400031E0(PVOID VirtualAddress)
{
  void *v2; // rcx
  void *v3; // rcx
  void *v4; // rcx
  _QWORD *v5; // rdx
  PVOID *v6; // rax

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 5u )
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x53u, (__int64)&unk_140012330);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x54u, (__int64)&unk_140012330, VirtualAddress);
    }
  }
  *((_DWORD *)VirtualAddress + 99) = 1;
  if ( (unsigned int)sub_14000F090() )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_14000BFC8(
        (__int64)off_140013400->AttachedDevice,
        0x55u,
        (__int64)&unk_140012330,
        (const char *)VirtualAddress + 252);
    }
    sub_14000FD30((__int64)VirtualAddress + 248);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x56u, (__int64)&unk_140012330);
    }
    sub_140010180();
  }
  else if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
         && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
         && BYTE1(off_140013400->Timer) >= 4u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x57u, (__int64)&unk_140012330);
  }
  if ( *((_QWORD *)VirtualAddress + 78) )
  {
    v2 = (void *)*((_QWORD *)VirtualAddress + 78);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x58u, (__int64)&unk_140012330);
      v2 = (void *)*((_QWORD *)VirtualAddress + 78);
    }
    NdisFreeNetBufferListPool(v2);
    *((_QWORD *)VirtualAddress + 78) = 0i64;
  }
  if ( *((_QWORD *)VirtualAddress + 79) )
  {
    v3 = (void *)*((_QWORD *)VirtualAddress + 79);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x59u, (__int64)&unk_140012330);
      v3 = (void *)*((_QWORD *)VirtualAddress + 79);
    }
    NdisFreeNetBufferPool(v3);
    *((_QWORD *)VirtualAddress + 79) = 0i64;
  }
  if ( *((_QWORD *)VirtualAddress + 28) )
  {
    v4 = (void *)*((_QWORD *)VirtualAddress + 28);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x5Au, (__int64)&unk_140012330);
      v4 = (void *)*((_QWORD *)VirtualAddress + 28);
    }
    NdisFreeMemory(v4, 0, 0);
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x5Bu, (__int64)&unk_140012330);
  }
  LOBYTE(stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink) = KeAcquireSpinLockRaiseToDpc((PKSPIN_LOCK)&stru_1400146A0.Queue);
  v5 = *(_QWORD **)VirtualAddress;
  if ( *(PVOID *)(*(_QWORD *)VirtualAddress + 8i64) != VirtualAddress
    || (v6 = (PVOID *)*((_QWORD *)VirtualAddress + 1), *v6 != VirtualAddress) )
  {
    __fastfail(3u);
  }
  *v6 = v5;
  v5[1] = v6;
  KeReleaseSpinLock((PKSPIN_LOCK)&stru_1400146A0.Queue, (KIRQL)stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink);
  NdisFreeMemory(VirtualAddress, 0, 0);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x5Cu, (__int64)&unk_140012330);
  }
}

//----- (00000001400034B0) ----------------------------------------------------
void __fastcall sub_1400034B0(__int64 a1, __int64 a2)
{
  unsigned int v2; // edi

  v2 = *(_DWORD *)(a2 + 8);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x400) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000B808((__int64)off_140013400->AttachedDevice, 0x76u, (__int64)&unk_140012330, a2);
  }
  if ( v2 > 6
    && off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x400) != 0
    && BYTE1(off_140013400->Timer) >= 2u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x77u, (__int64)&unk_140012330);
  }
  NdisFDevicePnPEventNotify(*(NDIS_HANDLE *)(a1 + 16), (PNET_DEVICE_PNP_EVENT)a2);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x400) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x78u, (__int64)&unk_140012330);
  }
}

//----- (0000000140003590) ----------------------------------------------------
__int64 __fastcall sub_140003590(__int64 a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rdi
  int v5; // ebx
  const char *v6; // rax
  int v7; // eax
  unsigned int v8; // ebx

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x400) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x79u, (__int64)&unk_140012330);
  }
  if ( a2 )
  {
    v4 = off_140013400;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x400) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      v5 = *(_DWORD *)(a2 + 8);
      v6 = sub_14000B42C(v5);
      sub_14000B710(
        (__int64)v4->AttachedDevice,
        0x7Au,
        (__int64)&unk_140012330,
        *(const wchar_t **)(a1 + 48),
        v5,
        (__int64)v6);
    }
  }
  v7 = NdisFNetPnPEvent(*(NDIS_HANDLE *)(a1 + 16), (PNET_PNP_EVENT_NOTIFICATION)a2);
  v8 = v7;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x400) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001580((__int64)off_140013400->AttachedDevice, 0x7Bu, (__int64)&unk_140012330, v7);
  }
  return v8;
}

//----- (00000001400036A0) ----------------------------------------------------
__int64 __fastcall sub_1400036A0(__int64 a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rdi
  const char *v5; // rax
  unsigned int v6; // edi
  _NDIS_OID_REQUEST *v7; // rdx
  void *v8; // rcx
  int v9; // eax
  PNDIS_OID_REQUEST ClonedOidRequest; // [rsp+40h] [rbp+8h] BYREF

  ClonedOidRequest = 0i64;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xBu) && BYTE1(off_140013400->Timer) >= 5u )
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x63u, (__int64)&unk_140012330, a2);
    v4 = off_140013400;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xBu) && BYTE1(off_140013400->Timer) >= 5u )
      {
        v5 = sub_14000B25C(*(_DWORD *)(a2 + 4));
        sub_14000BFC8((__int64)v4->AttachedDevice, 0x64u, (__int64)&unk_140012330, v5);
      }
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
      {
        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xBu) && BYTE1(off_140013400->Timer) >= 5u )
          sub_140001580((__int64)off_140013400->AttachedDevice, 0x65u, (__int64)&unk_140012330, *(_DWORD *)(a2 + 8));
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
        {
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xBu) && BYTE1(off_140013400->Timer) >= 5u )
            sub_14000B808((__int64)off_140013400->AttachedDevice, 0x66u, (__int64)&unk_140012330, *(_QWORD *)(a2 + 16));
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
          {
            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xBu) && BYTE1(off_140013400->Timer) >= 5u )
              sub_140001580(
                (__int64)off_140013400->AttachedDevice,
                0x67u,
                (__int64)&unk_140012330,
                *(_DWORD *)(a2 + 12));
            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
              && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xBu)
              && BYTE1(off_140013400->Timer) >= 5u )
            {
              sub_140001580((__int64)off_140013400->AttachedDevice, 0x68u, (__int64)&unk_140012330, *(_DWORD *)(a2 + 8));
            }
          }
        }
      }
    }
  }
  v6 = NdisAllocateCloneOidRequest(*(NDIS_HANDLE *)(a1 + 16), (PNDIS_OID_REQUEST)a2, 0x646E5446u, &ClonedOidRequest);
  if ( v6 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xBu)
      && BYTE1(off_140013400->Timer) >= 3u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x69u, (__int64)&unk_140012330);
    }
    if ( *(_DWORD *)(a2 + 4) != 1 )
    {
      if ( *(_DWORD *)(a2 + 4) == 12 )
      {
        *(_DWORD *)(a2 + 64) = 0;
        *(_DWORD *)(a2 + 68) = 0;
        *(_DWORD *)(a2 + 60) = 0;
        goto LABEL_37;
      }
      if ( *(_DWORD *)(a2 + 32) == -67042804 )
        v6 = -1073741823;
    }
    *(_DWORD *)(a2 + 52) = 0;
    *(_DWORD *)(a2 + 56) = 0;
  }
  else
  {
    *(_QWORD *)ClonedOidRequest->SourceReserved = a2;
    ClonedOidRequest->RequestId = *(PVOID *)(a2 + 16);
    v7 = ClonedOidRequest;
    v8 = *(void **)(a1 + 16);
    *(_QWORD *)(a1 + 240) = ClonedOidRequest;
    v9 = NdisFOidRequest(v8, v7);
    v6 = v9;
    if ( v9 != 259 )
    {
      sub_140003910(a1, (__int64)ClonedOidRequest, v9);
      v6 = 259;
    }
  }
LABEL_37:
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xBu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001580((__int64)off_140013400->AttachedDevice, 0x6Au, (__int64)&unk_140012330, v6);
  }
  return v6;
}

//----- (0000000140003910) ----------------------------------------------------
void __fastcall sub_140003910(__int64 a1, __int64 a2, int a3)
{
  int v3; // ebp
  _NDIS_OID_REQUEST *v7; // rsi
  KIRQL v8; // al
  UINT v9; // eax

  v3 = a3;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( (HIDWORD(off_140013400->Timer) & 0x800) != 0 && BYTE1(off_140013400->Timer) >= 5u )
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x6Du, (__int64)&unk_140012330, a2);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x800) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001580((__int64)off_140013400->AttachedDevice, 0x6Eu, (__int64)&unk_140012330, v3);
    }
  }
  v7 = *(_NDIS_OID_REQUEST **)(a2 + 216);
  if ( !v7 )
  {
    sub_14000C74C(a1, (struct _NDIS_EVENT *)a2, v3);
    return;
  }
  v8 = KeAcquireSpinLockRaiseToDpc((PKSPIN_LOCK)(a1 + 104));
  *(_QWORD *)(a1 + 240) = 0i64;
  *(_BYTE *)(a1 + 112) = v8;
  KeReleaseSpinLock((PKSPIN_LOCK)(a1 + 104), v8);
  v9 = *(_DWORD *)(a2 + 52);
  if ( *(_DWORD *)(a2 + 4) != 1 )
  {
    if ( *(_DWORD *)(a2 + 4) == 12 )
    {
      v7->DATA.QUERY_INFORMATION.BytesWritten = v9;
      v7->DATA.METHOD_INFORMATION.BytesRead = *(_DWORD *)(a2 + 64);
      v7->DATA.METHOD_INFORMATION.BytesNeeded = *(_DWORD *)(a2 + 68);
      v7->DATA.METHOD_INFORMATION.BytesWritten = *(_DWORD *)(a2 + 60);
      goto LABEL_16;
    }
    v3 = -1073741823;
    if ( *(_DWORD *)(a2 + 32) != -67042804 )
      v3 = a3;
  }
  v7->DATA.QUERY_INFORMATION.BytesWritten = v9;
  v7->DATA.QUERY_INFORMATION.BytesNeeded = *(_DWORD *)(a2 + 56);
LABEL_16:
  *(_QWORD *)(a2 + 216) = 0i64;
  NdisFreeCloneOidRequest(*(NDIS_HANDLE *)(a1 + 16), (PNDIS_OID_REQUEST)a2);
  NdisFOidRequestComplete(*(NDIS_HANDLE *)(a1 + 16), v7, v3);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x800) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x6Fu, (__int64)&unk_140012330);
  }
}

//----- (0000000140003AA0) ----------------------------------------------------
__int64 __fastcall sub_140003AA0(__int64 a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rdi
  const char *v5; // rax

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x37u, (__int64)&unk_140012330);
  }
  if ( a2 )
  {
    v4 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      goto LABEL_14;
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 5u )
    {
      v5 = sub_140006A94(a2);
      sub_14000BFC8((__int64)v4->AttachedDevice, 0x38u, (__int64)&unk_140012330, v5);
    }
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000B808((__int64)off_140013400->AttachedDevice, 0x39u, (__int64)&unk_140012330, a1);
  }
LABEL_14:
  *(_BYTE *)(a1 + 112) = KeAcquireSpinLockRaiseToDpc((PKSPIN_LOCK)(a1 + 104));
  *(_DWORD *)(a1 + 120) = 2;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000B6A4((__int64)off_140013400->AttachedDevice, 0x3Au, (__int64)&unk_140012330, *(const wchar_t **)(a1 + 48));
  }
  KeReleaseSpinLock((PKSPIN_LOCK)(a1 + 104), *(_BYTE *)(a1 + 112));
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000BA60(
      (__int64)off_140013400->AttachedDevice,
      0x3Bu,
      (__int64)&unk_140012330,
      *(_QWORD *)(a1 + 136),
      *(_QWORD *)(a1 + 144));
  }
  *(_DWORD *)(a1 + 396) = 3;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    sub_14000BFC8((__int64)off_140013400->AttachedDevice, 0x3Cu, (__int64)&unk_140012330, (const char *)(a1 + 252));
  }
  sub_14000FD30(a1 + 248);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x3Du, (__int64)&unk_140012330);
  }
  *(_DWORD *)(a1 + 120) = 3;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 5u )
      sub_14000B6A4(
        (__int64)off_140013400->AttachedDevice,
        0x42u,
        (__int64)&unk_140012330,
        *(const wchar_t **)(a1 + 48));
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 5u )
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x43u, (__int64)&unk_140012330);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_140001580((__int64)off_140013400->AttachedDevice, 0x44u, (__int64)&unk_140012330, 0);
      }
    }
  }
  return 0i64;
}

//----- (0000000140003CFC) ----------------------------------------------------
void __fastcall sub_140003CFC(__int64 a1, int a2, int a3, PNET_BUFFER_LIST *a4, ULONG *a5, bool *a6)
{
  _NET_BUFFER_LIST *v7; // r15
  char v8; // si
  char v9; // al
  int v11; // er12
  _NET_BUFFER_LIST *v12; // r14
  const char *v13; // r9
  const char *v14; // r8
  PDEVICE_OBJECT v15; // rcx
  unsigned __int16 v16; // dx
  _NET_BUFFER_LIST *v17; // r9
  KSPIN_LOCK *v18; // rax
  __int64 v19; // rsi
  ULONG v20; // ebx
  ULONG v21; // er8
  int v22; // er9
  int v23; // edx
  int v24; // edx
  int v25; // ebx
  __int64 ReceiveFlags; // [rsp+20h] [rbp-58h]
  struct _KLOCK_QUEUE_HANDLE LockHandle; // [rsp+30h] [rbp-48h] BYREF
  PNET_BUFFER_LIST NetBufferLists; // [rsp+48h] [rbp-30h] BYREF
  ULONG NumberOfNetBufferLists; // [rsp+50h] [rbp-28h]
  int v30; // [rsp+54h] [rbp-24h]
  __int64 v31; // [rsp+58h] [rbp-20h]
  __int64 v32; // [rsp+60h] [rbp-18h]
  char v33; // [rsp+C0h] [rbp+48h]
  PNET_BUFFER_LIST *v36; // [rsp+D8h] [rbp+60h]

  v36 = a4;
  NumberOfNetBufferLists = 0;
  v7 = *a4;
  v8 = 0;
  v33 = 0;
  v9 = a2;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x13u) && BYTE1(off_140013400->Timer) >= 5u )
      sub_14000BAA8((__int64)off_140013400->AttachedDevice, 0xAEu, (__int64)&unk_140012330, v7, *a5);
    v9 = a2;
  }
  if ( *(_DWORD *)(a1 + 612) == 1 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x200) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0xAFu, (__int64)&unk_140012330);
    }
    goto LABEL_40;
  }
  v11 = v9 & 2;
  if ( (v9 & 2) != 0 || ((dword_14001358C - 1) & 0xFFFFFFFD) == 0 )
  {
    v8 = 1;
    v33 = 1;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x13u)
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      v13 = "TRUE";
      v14 = "FALSE";
      if ( dword_14001358C )
        v14 = "TRUE";
      if ( (v9 & 2) == 0 )
        v13 = "FALSE";
      sub_14000C3CC((__int64)off_140013400->AttachedDevice, 0xB1u, (__int64)&unk_140012330, v13, (__int64)v14);
    }
    if ( v11 )
      _InterlockedExchangeAdd64(&qword_140014630, *a5);
    if ( dword_140013590 && ((dword_14001358C - 1) & 0xFFFFFFFD) != 0 )
    {
      v15 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x13u)
        || BYTE1(off_140013400->Timer) < 5u )
      {
        goto LABEL_40;
      }
      v16 = 178;
      v17 = v7;
    }
    else
    {
      v12 = sub_140009874(a1, v7, 0);
      if ( v12 )
      {
        _InterlockedExchangeAdd64(&qword_140014610, *a5);
        goto LABEL_42;
      }
      v15 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || (HIDWORD(off_140013400->Timer) & 0x80000) == 0
        || BYTE1(off_140013400->Timer) < 2u )
      {
LABEL_40:
        *a6 = 1;
        return;
      }
      v17 = *a4;
      v16 = 179;
    }
    sub_14000B808((__int64)v15->AttachedDevice, v16, (__int64)&unk_140012330, v17);
    goto LABEL_40;
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x13u)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000B808((__int64)off_140013400->AttachedDevice, 0xB0u, (__int64)&unk_140012330, v7);
  }
  v12 = v7;
LABEL_42:
  v18 = (KSPIN_LOCK *)sub_140006D80(a1, a2, a3, v8, 0);
  v19 = (__int64)v18;
  if ( !v18 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x80000) != 0
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0xB4u, (__int64)&unk_140012330, *a4);
    }
    *a6 = 1;
    if ( v33 )
    {
      sub_1400097CC(v12);
      _InterlockedExchangeAdd64(&qword_140014610, -(__int64)*a5);
    }
    return;
  }
  v20 = *a5;
  KeAcquireInStackQueuedSpinLock(v18, &LockHandle);
  *(_DWORD *)(v19 + 24) = v20;
  KeReleaseInStackQueuedSpinLock(&LockHandle);
  if ( !v20 )
    sub_140006D28((PSLIST_ENTRY)v19);
  v21 = *a5;
  v30 = 0;
  v31 = a1 + 248;
  NetBufferLists = v12;
  NumberOfNetBufferLists = v21;
  v32 = v19;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80000) != 0
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    LODWORD(ReceiveFlags) = v21;
    sub_14000BAA8((__int64)off_140013400->AttachedDevice, 0xB5u, (__int64)&unk_140012330, v12, ReceiveFlags);
  }
  v22 = sub_140010268(0, (__int64)&NetBufferLists, 32);
  if ( v22
    && off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80000) != 0
    && BYTE1(off_140013400->Timer) >= 2u )
  {
    HIDWORD(ReceiveFlags) = HIDWORD(NetBufferLists);
    sub_14000B64C((__int64)off_140013400->AttachedDevice, 0xB6u, (__int64)&unk_140012330, v22);
  }
  _InterlockedExchangeAdd64(&qword_140014648, *a5 - NumberOfNetBufferLists);
  if ( v33 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x80000) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      LODWORD(ReceiveFlags) = NumberOfNetBufferLists;
      sub_14000BAA8(
        (__int64)off_140013400->AttachedDevice,
        0xBAu,
        (__int64)&unk_140012330,
        NetBufferLists,
        ReceiveFlags);
    }
    *a6 = 0;
    if ( !v11 )
    {
      v24 = a2 & 1 | 2;
      if ( (a2 & 0x800) == 0 )
        v24 = a2 & 1;
      v25 = v24 | 4;
      if ( (a2 & 0x8000) == 0 )
        v25 = v24;
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x80000) != 0
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_14000B808((__int64)off_140013400->AttachedDevice, 0xBBu, (__int64)&unk_140012330, *v36);
      }
      NdisFReturnNetBufferLists(*(NDIS_HANDLE *)(a1 + 16), v7, v25);
    }
    if ( NumberOfNetBufferLists )
    {
      _InterlockedExchangeAdd64(&qword_140014638, NumberOfNetBufferLists);
      NdisFIndicateReceiveNetBufferLists(
        *(NDIS_HANDLE *)(a1 + 16),
        NetBufferLists,
        0,
        NumberOfNetBufferLists,
        *(_DWORD *)(v19 + 20));
      v23 = NumberOfNetBufferLists;
LABEL_83:
      if ( v23 )
        sub_140006E48((PSLIST_ENTRY)v19, v23, 2);
      return;
    }
  }
  else
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x80000) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      LODWORD(ReceiveFlags) = NumberOfNetBufferLists;
      sub_14000BAA8(
        (__int64)off_140013400->AttachedDevice,
        0xB7u,
        (__int64)&unk_140012330,
        NetBufferLists,
        ReceiveFlags);
    }
    v23 = NumberOfNetBufferLists;
    *a6 = NumberOfNetBufferLists != 0;
    if ( v23 )
    {
      *v36 = NetBufferLists;
      *a5 = v23;
      goto LABEL_83;
    }
  }
}
// 14000403C: variable 'ReceiveFlags' is possibly undefined
// 14001358C: using guessed type int dword_14001358C;
// 140013590: using guessed type int dword_140013590;
// 140014610: using guessed type __int64 qword_140014610;
// 140014630: using guessed type __int64 qword_140014630;
// 140014638: using guessed type __int64 qword_140014638;
// 140014648: using guessed type __int64 qword_140014648;

//----- (0000000140004220) ----------------------------------------------------
void __fastcall sub_140004220(__int64 a1, char a2, _NET_BUFFER_LIST *a3, _BYTE *a4)
{
  _NET_BUFFER_LIST *v4; // r13
  _BYTE *v5; // r14
  char v6; // r15
  __int64 v7; // rbp
  char v8; // bl
  int v9; // er15
  PDEVICE_OBJECT v10; // rcx
  unsigned __int16 v11; // dx
  bool v12; // al
  _NET_BUFFER_LIST *v13; // r12
  __int64 v14; // r13
  int v15; // er15
  int v16; // er14
  SLIST_HEADER *v17; // rax
  _NET_BUFFER_LIST *v18; // rax
  _NET_BUFFER_LIST *v19; // rbp
  _NET_BUFFER *i; // r14
  int v21; // [rsp+34h] [rbp-54h] BYREF
  __int64 v22; // [rsp+38h] [rbp-50h] BYREF
  __int64 v23; // [rsp+40h] [rbp-48h]
  __int64 v24; // [rsp+90h] [rbp+8h]
  char v25; // [rsp+98h] [rbp+10h]
  _NET_BUFFER_LIST *v26; // [rsp+A0h] [rbp+18h]
  _BYTE *v27; // [rsp+A8h] [rbp+20h]

  v27 = a4;
  v26 = a3;
  v25 = a2;
  v24 = a1;
  v4 = a3;
  v5 = a4;
  v6 = a2;
  v7 = a1;
  v8 = 0;
  v22 = 0i64;
  v23 = a1 + 248;
  sub_140005DCC(a3, a1 + 248, 0, &v22);
  if ( (_DWORD)v22 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 1) != 0
      && BYTE1(off_140013400->Timer) >= 3u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0xA5u, (__int64)&unk_140012330, v4);
    }
    if ( (v6 & 2) == 0 )
    {
      v9 = v6 & 1;
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 1) != 0
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0xA6u, (__int64)&unk_140012330);
      }
      NdisFReturnNetBufferLists(*(NDIS_HANDLE *)(v7 + 16), v4, v9);
      goto LABEL_62;
    }
    v10 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
      || (HIDWORD(off_140013400->Timer) & 1) == 0
      || BYTE1(off_140013400->Timer) < 5u )
    {
      goto LABEL_62;
    }
    v11 = 167;
LABEL_56:
    sub_140001558((__int64)v10->AttachedDevice, v11, (__int64)&unk_140012330);
    goto LABEL_62;
  }
  v12 = HIDWORD(v22) != 0;
  *v5 = HIDWORD(v22) != 0;
  if ( v12 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 1) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0xADu, (__int64)&unk_140012330, v4);
    }
    v8 = 1;
  }
  else
  {
    v13 = v4;
    if ( v4 )
    {
      v14 = v23;
      v15 = 0;
      do
      {
        v16 = 0;
        sub_140009A24((__int64)v13, 0, "FILTER_RECEIVE");
        v17 = (SLIST_HEADER *)v13->FirstNetBuffer;
        ++v15;
        while ( v17 )
        {
          v17 = (SLIST_HEADER *)v17->Alignment;
          ++v16;
        }
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 0x20000) != 0
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          sub_1400015BC((__int64)off_140013400->AttachedDevice, 0xA8u, (__int64)&unk_140012330, v15);
        }
        v18 = NdisAllocateCloneNetBufferList(v13, 0i64, 0i64, 2u);
        v19 = v18;
        if ( v18 )
        {
          sub_140007544(v13, v18, 0);
          v19->ChildRefCount = v16 + 1;
        }
        else if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
               && (HIDWORD(off_140013400->Timer) & 1) != 0
               && BYTE1(off_140013400->Timer) >= 2u )
        {
          sub_140001558((__int64)off_140013400->AttachedDevice, 0xA9u, (__int64)&unk_140012330);
        }
        for ( i = v13->FirstNetBuffer; i; i = (_NET_BUFFER *)i->Link.Alignment )
        {
          if ( (unsigned int)sub_14000E3D8(i, v14, &v21, 0, (__int64)v19) )
          {
            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
              && (HIDWORD(off_140013400->Timer) & 1) != 0
              && BYTE1(off_140013400->Timer) >= 2u )
            {
              sub_14000B808((__int64)off_140013400->AttachedDevice, 0xAAu, (__int64)&unk_140012330, i);
            }
            if ( v19 )
              _InterlockedDecrement(&v19->ChildRefCount);
          }
        }
        if ( v19 )
          sub_140006CC0(v19);
        v13 = (_NET_BUFFER_LIST *)v13->Link.Alignment;
      }
      while ( v13 );
      v6 = v25;
      v4 = v26;
      v5 = v27;
      v7 = v24;
    }
    v4->Status = 0;
    if ( (v6 & 2) != 0 )
    {
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
        goto LABEL_62;
      if ( (HIDWORD(off_140013400->Timer) & 1) != 0 && BYTE1(off_140013400->Timer) >= 5u )
        sub_140001558((__int64)off_140013400->AttachedDevice, 0xABu, (__int64)&unk_140012330);
    }
    else
    {
      NdisFReturnNetBufferLists(*(NDIS_HANDLE *)(v7 + 16), v4, v6 & 1);
    }
    v10 = off_140013400;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 1) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      v11 = 172;
      goto LABEL_56;
    }
  }
LABEL_62:
  *v5 = v8;
}

//----- (0000000140004590) ----------------------------------------------------
__int64 __fastcall sub_140004590(unsigned __int64 a1, unsigned __int64 a2)
{
  __int64 result; // rax

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xFu, (__int64)&unk_140012330);
  }
  if ( __PAIR128__(a1, a2) == *(_OWORD *)&stru_1400146A0.Queue.Wcb.NumberOfChannels )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 1) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x11u, (__int64)&unk_140012330);
    }
    result = 0i64;
  }
  else
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 1) != 0
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x10u, (__int64)&unk_140012330);
    }
    result = 3221225485i64;
  }
  return result;
}

//----- (0000000140004670) ----------------------------------------------------
__int64 __fastcall sub_140004670(__int64 a1, __int64 a2)
{
  NDIS_STATUS v4; // edi
  __int64 v5; // rdi
  PVOID ConfigurationHandle; // [rsp+30h] [rbp-D0h] BYREF
  struct _NDIS_CONFIGURATION_OBJECT ConfigObject; // [rsp+38h] [rbp-C8h] BYREF
  struct _NDIS_STATUS_INDICATION StatusIndication; // [rsp+60h] [rbp-A0h] BYREF
  int v10; // [rsp+D0h] [rbp-30h] BYREF
  __int64 Dst[19]; // [rsp+D4h] [rbp-2Ch] BYREF

  ConfigurationHandle = 0i64;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 5u )
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x45u, (__int64)&unk_140012330);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x46u, (__int64)&unk_140012330, a1);
    }
  }
  ConfigObject.NdisHandle = stru_1400146A0.Queue.Wcb.DeviceRoutine;
  ConfigObject.Header = (NDIS_OBJECT_HEADER)1573289;
  ConfigObject.Flags = 0;
  v4 = NdisOpenConfigurationEx(&ConfigObject, &ConfigurationHandle);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x48u, (__int64)&unk_140012330);
  }
  if ( !v4 )
  {
    NdisCloseConfiguration(ConfigurationHandle);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x49u, (__int64)&unk_140012330);
    }
  }
  v5 = *(_QWORD *)(a2 + 16);
  if ( v5 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x4Au, (__int64)&unk_140012330);
    }
    *(_DWORD *)(v5 + 40) = 128;
  }
  memset(&StatusIndication, 0, sizeof(StatusIndication));
  StatusIndication.SourceHandle = *(NDIS_HANDLE *)(a1 + 16);
  *(_OWORD *)&StatusIndication.DestinationHandle = 0i64;
  StatusIndication.Header = (NDIS_OBJECT_HEADER)7340440;
  StatusIndication.PortNumber = 0;
  *(_QWORD *)&StatusIndication.StatusCode = 1073872902i64;
  memset(Dst, 0, sizeof(Dst));
  v10 = 10224039;
  sub_140009CA8((unsigned __int8 *)&v10);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x4Bu, (__int64)&unk_140012330);
  }
  LODWORD(Dst[0]) = 0;
  LODWORD(Dst[2]) = 0;
  HIDWORD(Dst[0]) = HIDWORD(Dst[0]) & 0xFFFFFEAA | 0x2AA;
  HIDWORD(Dst[2]) = HIDWORD(Dst[2]) & 0xFFFFFFAA | 0xAA;
  if ( dword_14001359C )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x4Cu, (__int64)&unk_140012330);
    }
    Dst[4] = 0i64;
    Dst[5] &= 0xFFFFFFF000000000ui64;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x4Du, (__int64)&unk_140012330);
    }
    HIDWORD(Dst[12]) &= 0xFFFFFFF0;
    *(__int64 *)((char *)&Dst[9] + 4) = 0i64;
    *(__int64 *)((char *)&Dst[10] + 4) = 0i64;
    *(__int64 *)((char *)&Dst[11] + 4) = 0i64;
  }
  StatusIndication.StatusBufferSize = 156;
  StatusIndication.StatusBuffer = &v10;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000B808((__int64)off_140013400->AttachedDevice, 0x4Eu, (__int64)&unk_140012330, *(_QWORD *)(a1 + 16));
  }
  NdisFIndicateStatus(*(NDIS_HANDLE *)(a1 + 16), &StatusIndication);
  *(_DWORD *)(a1 + 120) = 4;
  *(_DWORD *)(a1 + 396) = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 5u )
      sub_14000B6A4(
        (__int64)off_140013400->AttachedDevice,
        0x4Fu,
        (__int64)&unk_140012330,
        *(const wchar_t **)(a1 + 48));
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 5u )
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x51u, (__int64)&unk_140012330);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_14000BAA8((__int64)off_140013400->AttachedDevice, 0x52u, (__int64)&unk_140012330, a1, 0);
      }
    }
  }
  return 0i64;
}
// 14001359C: using guessed type int dword_14001359C;

//----- (0000000140004A00) ----------------------------------------------------
void __fastcall sub_140004A00(__int64 a1, int a2, int a3, _NET_BUFFER_LIST *a4, unsigned int *a5, bool *a6)
{
  char v7; // r12
  _NET_BUFFER_LIST *v11; // r14
  KSPIN_LOCK *v12; // rax
  __int64 v13; // rsi
  unsigned int v14; // ebx
  unsigned int v15; // er8
  int v16; // er9
  int v17; // edx
  int v18; // edx
  int v19; // ebx
  __int64 v20; // [rsp+20h] [rbp-50h]
  struct _KLOCK_QUEUE_HANDLE LockHandle; // [rsp+30h] [rbp-40h] BYREF
  PNET_BUFFER_LIST NetBufferList; // [rsp+48h] [rbp-28h] BYREF
  unsigned int v23; // [rsp+50h] [rbp-20h]
  int v24; // [rsp+54h] [rbp-1Ch]
  __int64 v25; // [rsp+58h] [rbp-18h]
  __int64 v26; // [rsp+60h] [rbp-10h]
  char v27; // [rsp+A8h] [rbp+38h]

  v27 = a2;
  v23 = 0;
  v7 = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x100000) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000BAA8((__int64)off_140013400->AttachedDevice, 0x89u, (__int64)&unk_140012330);
  }
  if ( *(_DWORD *)(a1 + 612) == 1 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x100000) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x8Au, (__int64)&unk_140012330);
    }
LABEL_25:
    *a6 = 1;
    return;
  }
  if ( (unsigned int)(dword_14001358C - 2) <= 1 )
  {
    v7 = 1;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x100000) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x8Cu, (__int64)&unk_140012330);
    }
    v11 = sub_140009874(a1, a4, 1);
    if ( !v11 )
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x100000) != 0
        && BYTE1(off_140013400->Timer) >= 2u )
      {
        sub_14000B808((__int64)off_140013400->AttachedDevice, 0x8Du, (__int64)&unk_140012330, a4);
      }
      goto LABEL_25;
    }
    _InterlockedExchangeAdd64(&qword_140014618, *a5);
  }
  else
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x100000) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x8Bu, (__int64)&unk_140012330, a4);
    }
    v11 = a4;
  }
  v12 = (KSPIN_LOCK *)sub_140006D80(a1, a2, a3, v7, 1);
  v13 = (__int64)v12;
  if ( !v12 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x100000) != 0
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x8Eu, (__int64)&unk_140012330, a4);
    }
    *a6 = 1;
    if ( v7 )
    {
      sub_1400097CC(v11);
      _InterlockedExchangeAdd64(&qword_140014618, -(__int64)*a5);
    }
    return;
  }
  v14 = *a5;
  KeAcquireInStackQueuedSpinLock(v12, &LockHandle);
  *(_DWORD *)(v13 + 24) = v14;
  KeReleaseInStackQueuedSpinLock(&LockHandle);
  if ( !v14 )
    sub_140006D28((PSLIST_ENTRY)v13);
  v15 = *a5;
  v25 = a1 + 248;
  NetBufferList = v11;
  v23 = v15;
  v24 = 1;
  v26 = v13;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x100000) != 0
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    LODWORD(v20) = v15;
    sub_14000BAA8((__int64)off_140013400->AttachedDevice, 0x8Fu, (__int64)&unk_140012330, v11, v20);
  }
  v16 = sub_140010268(0, (__int64)&NetBufferList, 32);
  if ( v16
    && off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x100000) != 0
    && BYTE1(off_140013400->Timer) >= 2u )
  {
    HIDWORD(v20) = HIDWORD(NetBufferList);
    sub_14000B64C((__int64)off_140013400->AttachedDevice, 0x90u, (__int64)&unk_140012330, v16);
  }
  _InterlockedExchangeAdd64(&qword_140014650, *a5 - v23);
  if ( !v7 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x100000) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      LODWORD(v20) = v23;
      sub_14000BAA8((__int64)off_140013400->AttachedDevice, 0x91u, (__int64)&unk_140012330, NetBufferList, v20);
    }
    v17 = v23;
    *a6 = v23 != 0;
    goto LABEL_65;
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x100000) != 0
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    LODWORD(v20) = v23;
    sub_14000BAA8((__int64)off_140013400->AttachedDevice, 0x92u, (__int64)&unk_140012330, NetBufferList, v20);
  }
  v18 = v27 & 1 | 2;
  *a6 = 0;
  if ( (v27 & 4) == 0 )
    v18 = v27 & 1;
  v19 = v18 | 4;
  if ( (v27 & 0x20) == 0 )
    v19 = v18;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x100000) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000B808((__int64)off_140013400->AttachedDevice, 0x93u, (__int64)&unk_140012330, a4);
  }
  NdisFSendNetBufferListsComplete(*(NDIS_HANDLE *)(a1 + 16), a4, v19);
  if ( v23 )
  {
    _InterlockedExchangeAdd64(&qword_140014640, v23);
    NdisFSendNetBufferLists(*(NDIS_HANDLE *)(a1 + 16), NetBufferList, 0, *(_DWORD *)(v13 + 20));
    v17 = v23;
LABEL_65:
    if ( v17 )
      sub_140006E48((PSLIST_ENTRY)v13, v17, 2);
  }
}
// 140004CB4: variable 'v20' is possibly undefined
// 14001358C: using guessed type int dword_14001358C;
// 140014618: using guessed type __int64 qword_140014618;
// 140014640: using guessed type __int64 qword_140014640;
// 140014650: using guessed type __int64 qword_140014650;

//----- (0000000140004E78) ----------------------------------------------------
void __fastcall sub_140004E78(__int64 a1, char a2, __int64 a3, _NET_BUFFER_LIST *a4, bool *a5)
{
  int v6; // ebp
  char v7; // si
  __int64 v8; // r13
  int v9; // ecx
  bool *v10; // r12
  _NET_BUFFER_LIST *v11; // r15
  __int64 v12; // r13
  int v13; // er12
  SLIST_HEADER *v14; // rax
  _NET_BUFFER_LIST *v15; // rax
  _NET_BUFFER_LIST *v16; // rsi
  _NET_BUFFER *v17; // r14
  int v18; // [rsp+34h] [rbp-54h] BYREF
  __int64 v19; // [rsp+38h] [rbp-50h] BYREF
  __int64 v20; // [rsp+40h] [rbp-48h]
  __int64 v21; // [rsp+90h] [rbp+8h]
  char v22; // [rsp+98h] [rbp+10h]

  v22 = a2;
  v21 = a1;
  v6 = 0;
  v19 = 0i64;
  v7 = a2;
  v8 = a1;
  v20 = a1 + 248;
  sub_140005DCC(a4, a1 + 248, 1, &v19);
  if ( (_DWORD)v19 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x40) != 0
      && BYTE1(off_140013400->Timer) >= 3u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x83u, (__int64)&unk_140012330, a4);
    }
    NdisFSendNetBufferListsComplete(*(NDIS_HANDLE *)(v8 + 16), a4, v7 != 0);
    *a5 = 0;
  }
  else
  {
    v9 = HIDWORD(v19);
    v10 = a5;
    *a5 = HIDWORD(v19) != 0;
    if ( v9 )
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x40) != 0
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_14000B808((__int64)off_140013400->AttachedDevice, 0x88u, (__int64)&unk_140012330, a4);
      }
      *a5 = 1;
    }
    else
    {
      v11 = a4;
      if ( a4 )
      {
        v12 = v20;
        v13 = 0;
        do
        {
          sub_140009A24((__int64)v11, 1, "FILTER_SEND");
          v14 = (SLIST_HEADER *)v11->FirstNetBuffer;
          ++v13;
          while ( v14 )
          {
            v14 = (SLIST_HEADER *)v14->Alignment;
            ++v6;
          }
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && (HIDWORD(off_140013400->Timer) & 0x20000) != 0
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            sub_1400015BC((__int64)off_140013400->AttachedDevice, 0x84u, (__int64)&unk_140012330, v13);
          }
          v15 = NdisAllocateCloneNetBufferList(v11, 0i64, 0i64, 2u);
          v16 = v15;
          if ( v15 )
          {
            sub_140007544(v11, v15, 1);
            v16->ChildRefCount = v6 + 1;
          }
          else if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
                 && (HIDWORD(off_140013400->Timer) & 0x40) != 0
                 && BYTE1(off_140013400->Timer) >= 2u )
          {
            sub_140001558((__int64)off_140013400->AttachedDevice, 0x85u, (__int64)&unk_140012330);
          }
          v17 = v11->FirstNetBuffer;
          v6 = 0;
          while ( v17 )
          {
            if ( (unsigned int)sub_14000E3D8(v17, v12, &v18, 1u, (__int64)v16) )
            {
              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
                && (HIDWORD(off_140013400->Timer) & 0x40) != 0
                && BYTE1(off_140013400->Timer) >= 2u )
              {
                sub_14000B808((__int64)off_140013400->AttachedDevice, 0x86u, (__int64)&unk_140012330, v17);
              }
              if ( v16 )
                _InterlockedDecrement(&v16->ChildRefCount);
            }
            v17 = (_NET_BUFFER *)v17->Link.Alignment;
          }
          if ( v16 )
            sub_140006CC0(v16);
          v11 = (_NET_BUFFER_LIST *)v11->Link.Alignment;
        }
        while ( v11 );
        v10 = a5;
        v8 = v21;
        v7 = v22;
      }
      a4->Status = 0;
      NdisFSendNetBufferListsComplete(*(NDIS_HANDLE *)(v8 + 16), a4, v7 != 0);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x40) != 0
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x87u, (__int64)&unk_140012330);
      }
      *v10 = 0;
    }
  }
}

//----- (0000000140005170) ----------------------------------------------------
__int64 sub_140005170()
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( (HIDWORD(off_140013400->Timer) & 1) != 0 && BYTE1(off_140013400->Timer) >= 5u )
      sub_140001558((__int64)off_140013400->AttachedDevice, 0xCBu, (__int64)&unk_140012330);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 1) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001580((__int64)off_140013400->AttachedDevice, 0xCCu, (__int64)&unk_140012330, 0);
    }
  }
  return 0i64;
}

//----- (00000001400051F0) ----------------------------------------------------
void __fastcall sub_1400051F0(__int64 a1, __int64 a2)
{
  __int64 v4; // rdi
  unsigned int v5; // eax

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001580((__int64)off_140013400->AttachedDevice, 0x70u, (__int64)&unk_140012330, *(_DWORD *)(a2 + 20));
  }
  if ( *(_DWORD *)(a2 + 20) == 1073872902 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 1) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x71u, (__int64)&unk_140012330);
    }
    v4 = *(_QWORD *)(a2 + 48);
    if ( v4 )
    {
      sub_140009CA8(*(unsigned __int8 **)(a2 + 48));
      if ( v4 != -4 )
      {
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 1) != 0
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          sub_140001558((__int64)off_140013400->AttachedDevice, 0x72u, (__int64)&unk_140012330);
        }
        v5 = *(_DWORD *)(v4 + 8) & 0xFFFFFEAA;
        *(_DWORD *)(v4 + 4) = 0;
        *(_DWORD *)(v4 + 20) = 0;
        *(_DWORD *)(v4 + 8) = v5 | 0x2AA;
        *(_DWORD *)(v4 + 24) = *(_DWORD *)(v4 + 24) & 0xFFFFFFAA | 0xAA;
      }
      if ( dword_14001359C )
      {
        if ( v4 != -36 )
        {
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && (HIDWORD(off_140013400->Timer) & 1) != 0
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            sub_140001558((__int64)off_140013400->AttachedDevice, 0x73u, (__int64)&unk_140012330);
          }
          *(_DWORD *)(v4 + 48) &= 0xFFFFFFF0;
          *(_QWORD *)(v4 + 36) = 0i64;
          *(_DWORD *)(v4 + 44) = 0;
        }
        if ( v4 != -80 )
        {
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && (HIDWORD(off_140013400->Timer) & 1) != 0
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            sub_140001558((__int64)off_140013400->AttachedDevice, 0x74u, (__int64)&unk_140012330);
          }
          *(_DWORD *)(v4 + 104) &= 0xFFFFFFF0;
          *(_QWORD *)(v4 + 80) = 0i64;
          *(_QWORD *)(v4 + 88) = 0i64;
          *(_QWORD *)(v4 + 96) = 0i64;
        }
      }
    }
  }
  NdisFIndicateStatus(*(NDIS_HANDLE *)(a1 + 16), (PNDIS_STATUS_INDICATION)a2);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x75u, (__int64)&unk_140012330);
  }
}
// 14001359C: using guessed type int dword_14001359C;

//----- (00000001400053E0) ----------------------------------------------------
void sub_1400053E0()
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x5Du, (__int64)&unk_140012330);
  }
  sub_14000F468();
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x5Eu, (__int64)&unk_140012330);
  }
  sub_14000FEE4();
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu) && BYTE1(off_140013400->Timer) >= 5u )
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x5Fu, (__int64)&unk_140012330);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x60u, (__int64)&unk_140012330);
    }
  }
  sub_14000103C();
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x61u, (__int64)&unk_140012330);
  }
  NdisFDeregisterFilterDriver(stru_1400146A0.Queue.Wcb.DeviceRoutine);
  ExDeleteNPagedLookasideList(&Lookaside);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x62u, (__int64)&unk_140012330);
  }
  sub_140016000();
}

//----- (0000000140005548) ----------------------------------------------------
bool __fastcall sub_140005548(__int64 a1, char a2)
{
  KSPIN_LOCK *v2; // rbx
  KSPIN_LOCK *v4; // rcx
  char v5; // si
  bool v6; // bp

  v2 = (KSPIN_LOCK *)(a1 + 104);
  v4 = (KSPIN_LOCK *)(a1 + 104);
  v5 = a2 & 1;
  if ( (a2 & 1) != 0 )
    KeAcquireSpinLockAtDpcLevel(v4);
  else
    *(_BYTE *)(a1 + 112) = KeAcquireSpinLockRaiseToDpc(v4);
  v6 = *(_DWORD *)(a1 + 120) == 4;
  if ( v5 )
    KeReleaseSpinLockFromDpcLevel(v2);
  else
    KeReleaseSpinLock(v2, *(_BYTE *)(a1 + 112));
  return v6;
}

//----- (00000001400055B8) ----------------------------------------------------
void __fastcall sub_1400055B8(PVOID P)
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Bu, (__int64)&unk_140012330);
  }
  if ( P )
    ExFreePoolWithTag(P, 0x4248414Eu);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Cu, (__int64)&unk_140012330);
  }
}

//----- (0000000140005648) ----------------------------------------------------
char __fastcall sub_140005648(const UNICODE_STRING *a1, void **a2, void **a3)
{
  ULONG v4; // er12
  int v5; // er9
  unsigned int *v7; // r14
  NTSTATUS v8; // er15
  PVOID v9; // rax
  char v10; // r12
  PVOID v11; // rax
  void **v12; // r15
  ULONG ResultLength; // [rsp+34h] [rbp-A5h] BYREF
  _UNICODE_STRING DestinationString; // [rsp+38h] [rbp-A1h] BYREF
  HANDLE Handle; // [rsp+48h] [rbp-91h] BYREF
  HANDLE v16; // [rsp+50h] [rbp-89h] BYREF
  void *KeyHandle; // [rsp+58h] [rbp-81h] BYREF
  struct _OBJECT_ATTRIBUTES ObjectAttributes; // [rsp+60h] [rbp-79h] BYREF
  PCUNICODE_STRING String1; // [rsp+90h] [rbp-49h]
  void **v20; // [rsp+98h] [rbp-41h]
  _UNICODE_STRING String2; // [rsp+A0h] [rbp-39h] BYREF
  char KeyInformation[12]; // [rsp+B0h] [rbp-29h] BYREF
  int v23; // [rsp+BCh] [rbp-1Dh]
  char v24; // [rsp+C0h] [rbp-19h] BYREF

  String1 = a1;
  *(_DWORD *)&DestinationString.Length = 0;
  DestinationString.Buffer = 0i64;
  KeyHandle = 0i64;
  v4 = 0;
  v20 = a3;
  RtlInitUnicodeString(
    &DestinationString,
    L"\\Registry\\Machine\\SYSTEM\\CurrentControlSet\\Control\\Class\\{4D36E972-E325-11CE-BFC1-08002bE10318}");
  ObjectAttributes.Length = 48;
  ObjectAttributes.ObjectName = &DestinationString;
  ObjectAttributes.RootDirectory = 0i64;
  ObjectAttributes.Attributes = 576;
  *(_OWORD *)&ObjectAttributes.SecurityDescriptor = 0i64;
  v5 = ZwOpenKey(&KeyHandle, 0x20019u, &ObjectAttributes);
  if ( v5 < 0 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( (HIDWORD(off_140013400->Timer) & 1) != 0 && BYTE1(off_140013400->Timer) >= 2u )
        sub_140001580((__int64)off_140013400->AttachedDevice, 0x14u, (__int64)&unk_140012330, v5);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 1) != 0
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x15u, (__int64)&unk_140012330);
      }
    }
    return 0;
  }
  v7 = (unsigned int *)ExAllocatePoolWithTag(Flags, 0x400ui64, 0x4248414Eu);
  if ( !v7 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( (HIDWORD(off_140013400->Timer) & 1) != 0 && BYTE1(off_140013400->Timer) >= 2u )
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x16u, (__int64)&unk_140012330);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 1) != 0
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x17u, (__int64)&unk_140012330);
      }
    }
    ZwClose(KeyHandle);
    return 0;
  }
  while ( 1 )
  {
    ResultLength = 0;
    v8 = ZwEnumerateKey(KeyHandle, v4, KeyBasicInformation, KeyInformation, 0x3Cu, &ResultLength);
    if ( v8 < 0 )
      goto LABEL_28;
    v16 = 0i64;
    DestinationString.Length = v23;
    DestinationString.MaximumLength = v23;
    ObjectAttributes.Length = 48;
    DestinationString.Buffer = (PWSTR)&v24;
    ObjectAttributes.RootDirectory = KeyHandle;
    ObjectAttributes.ObjectName = &DestinationString;
    ObjectAttributes.Attributes = 576;
    *(_OWORD *)&ObjectAttributes.SecurityDescriptor = 0i64;
    v8 = ZwOpenKey(&v16, 0x20019u, &ObjectAttributes);
    if ( v8 < 0 )
      goto LABEL_28;
    Handle = 0i64;
    RtlInitUnicodeString(&DestinationString, L"Linkage");
    ObjectAttributes.RootDirectory = v16;
    ObjectAttributes.Length = 48;
    ObjectAttributes.ObjectName = &DestinationString;
    ObjectAttributes.Attributes = 576;
    *(_OWORD *)&ObjectAttributes.SecurityDescriptor = 0i64;
    v8 = ZwOpenKey(&Handle, 0x20019u, &ObjectAttributes);
    if ( v8 >= 0 )
      break;
LABEL_27:
    ZwClose(v16);
LABEL_28:
    ++v4;
    if ( v8 == -2147483622 )
    {
      v10 = 0;
      goto LABEL_45;
    }
  }
  ResultLength = 0;
  RtlInitUnicodeString(&DestinationString, L"Export");
  v8 = ZwQueryValueKey(Handle, &DestinationString, KeyValueFullInformation, v7, 0x400u, &ResultLength);
  if ( v8 < 0
    || (RtlInitUnicodeString(&String2, (PCWSTR)((char *)v7 + v7[2])), !RtlEqualUnicodeString(String1, &String2, 1u)) )
  {
    ZwClose(Handle);
    goto LABEL_27;
  }
  RtlInitUnicodeString(&DestinationString, L"MatchingDeviceId");
  if ( ZwQueryValueKey(v16, &DestinationString, KeyValueFullInformation, v7, 0x400u, &ResultLength) >= 0
    && (v9 = ExAllocatePoolWithTag(Flags, v7[3] + 2i64, 0x4248414Eu), (*a2 = v9) != 0i64) )
  {
    memset(v9, 0, v7[3] + 2i64);
    memmove(*a2, (char *)v7 + v7[2], v7[3]);
    v10 = 1;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 1) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_14000B6A4((__int64)off_140013400->AttachedDevice, 0x18u, (__int64)&unk_140012330, (const wchar_t *)*a2);
    }
  }
  else
  {
    v10 = 0;
  }
  ResultLength = 0;
  RtlInitUnicodeString(&DestinationString, L"UpperBind");
  if ( ZwQueryValueKey(Handle, &DestinationString, KeyValueFullInformation, v7, 0x400u, &ResultLength) >= 0 )
  {
    v11 = ExAllocatePoolWithTag(Flags, v7[3] + 2i64, 0x4248414Eu);
    v12 = v20;
    *v20 = v11;
    if ( v11 )
    {
      memset(v11, 0, v7[3] + 2i64);
      memmove(*v12, (char *)v7 + v7[2], v7[3]);
      v10 = 1;
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 1) != 0
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_14000B6A4((__int64)off_140013400->AttachedDevice, 0x19u, (__int64)&unk_140012330, (const wchar_t *)*v12);
      }
    }
  }
  ZwClose(Handle);
  ZwClose(v16);
LABEL_45:
  ExFreePoolWithTag(v7, 0x4248414Eu);
  ZwClose(KeyHandle);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Au, (__int64)&unk_140012330);
  }
  return v10;
}

//----- (0000000140005B80) ----------------------------------------------------
__int64 __fastcall sub_140005B80(__int64 a1)
{
  int v1; // eax
  unsigned int v2; // ebx
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx

  v1 = *(_DWORD *)(a1 + 72);
  v2 = 0;
  if ( v1 && v1 != 3 )
  {
    if ( v1 == 9 )
    {
      if ( *(_DWORD *)(a1 + 76) == 8 )
      {
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 0x400) != 0
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          sub_140001558((__int64)off_140013400->AttachedDevice, 0xE8u, (__int64)&unk_140012330);
        }
        v2 = 6;
      }
    }
    else if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
           && (HIDWORD(off_140013400->Timer) & 0x400) != 0
           && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0xE9u, (__int64)&unk_140012330);
    }
    return v2;
  }
  if ( *(_DWORD *)(a1 + 76) )
  {
    v4 = off_140013400;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x400) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      v5 = 230;
      goto LABEL_23;
    }
  }
  else
  {
    v4 = off_140013400;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x400) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      v5 = 229;
LABEL_23:
      sub_140001558((__int64)v4->AttachedDevice, v5, (__int64)&unk_140012330);
      goto LABEL_24;
    }
  }
LABEL_24:
  v2 = 1;
  if ( ((*(_DWORD *)(a1 + 76) - 1) & 0xFFFFFFF7) == 0 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x400) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0xE7u, (__int64)&unk_140012330);
    }
    v2 = 2;
  }
  return v2;
}

//----- (0000000140005D00) ----------------------------------------------------
__int64 __fastcall sub_140005D00(__int64 a1)
{
  unsigned int v2; // ebx
  UINT v4; // [rsp+58h] [rbp+10h] BYREF
  unsigned int v5; // [rsp+60h] [rbp+18h] BYREF

  v4 = 0;
  v2 = -1;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x12u, (__int64)&unk_140012330);
  }
  if ( !(unsigned int)sub_14000C4C0(a1, NdisRequestQueryInformation, 0x10111u, &v5, 4u, 4u, 0, &v4) )
    v2 = v5;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001580((__int64)off_140013400->AttachedDevice, 0x13u, (__int64)&unk_140012330, v2);
  }
  return v2;
}

//----- (0000000140005DCC) ----------------------------------------------------
char __fastcall sub_140005DCC(_QWORD *a1, __int64 a2, int a3, _DWORD *a4)
{
  char v4; // r15
  int v5; // er12
  _DWORD *v6; // rdi
  __int64 v8; // r13
  _QWORD *v9; // r14
  const char *v10; // r9
  PDEVICE_OBJECT v11; // rcx
  unsigned __int16 v12; // dx
  _NET_BUFFER *v13; // rsi
  UINT v14; // eax
  unsigned int v15; // er12
  __int64 v16; // r13
  PDEVICE_OBJECT v17; // rdi
  const char *v18; // rax
  PVOID v19; // rax
  PVOID v20; // r14
  __int64 v21; // r15
  PDEVICE_OBJECT v22; // rdi
  const char *v23; // rax
  int v24; // er9
  __int64 v26; // [rsp+38h] [rbp-39h]
  __int64 v27; // [rsp+40h] [rbp-31h]
  char v28; // [rsp+58h] [rbp-19h]
  UINT v29; // [rsp+5Ch] [rbp-15h]
  int v30; // [rsp+60h] [rbp-11h]
  __int64 v31; // [rsp+68h] [rbp-9h] BYREF
  __int128 v32; // [rsp+70h] [rbp-1h] BYREF
  __int128 Src; // [rsp+80h] [rbp+Fh] BYREF
  __int64 v34; // [rsp+90h] [rbp+1Fh]
  _QWORD *v35; // [rsp+D8h] [rbp+67h]
  __int64 v36; // [rsp+E0h] [rbp+6Fh]
  int v37; // [rsp+E8h] [rbp+77h]
  _DWORD *v38; // [rsp+F0h] [rbp+7Fh]

  v38 = a4;
  v37 = a3;
  v36 = a2;
  v35 = a1;
  v4 = 0;
  v5 = 0;
  v28 = 0;
  v6 = a4;
  v34 = 0i64;
  v8 = a2;
  v9 = a1;
  v32 = 0i64;
  Src = 0i64;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x200) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xD3u, (__int64)&unk_140012330);
  }
  *v6 = 0;
  v6[1] = 0;
  if ( !v9[37] )
  {
    if ( *(_DWORD *)(v8 + 364) == 1 )
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x200) != 0
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0xD8u, (__int64)&unk_140012330);
      }
      v6[1] = 1;
LABEL_90:
      memcpy_s(v6, 8ui64, (char *)&Src + 12, 8ui64);
      if ( HIDWORD(Src)
        && off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x200) != 0
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0xE2u, (__int64)&unk_140012330);
      }
      if ( (_DWORD)v34 )
      {
        if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
          return 1;
        if ( (HIDWORD(off_140013400->Timer) & 0x200) != 0 && BYTE1(off_140013400->Timer) >= 4u )
          sub_140001558((__int64)off_140013400->AttachedDevice, 0xE3u, (__int64)&unk_140012330);
      }
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x200) != 0
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0xE4u, (__int64)&unk_140012330);
      }
      return 1;
    }
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x200) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0xD9u, (__int64)&unk_140012330);
    }
LABEL_40:
    if ( v4 )
      goto LABEL_89;
    v13 = (_NET_BUFFER *)v9[1];
    ++v5;
    v14 = 0;
    v30 = v5;
    if ( !v13 )
      goto LABEL_88;
    while ( 1 )
    {
      if ( v4 )
      {
LABEL_87:
        v9 = v35;
        v5 = v30;
LABEL_88:
        v9 = (_QWORD *)*v9;
        v35 = v9;
        if ( !v9 )
        {
LABEL_89:
          v6 = v38;
          goto LABEL_90;
        }
        goto LABEL_40;
      }
      v31 = 0i64;
      v29 = v14 + 1;
      v15 = sub_140006B08(v13->DataLength, *(_DWORD *)(v8 + 136));
      v16 = (unsigned int)sub_140006BCC(*(_DWORD *)(v8 + 136));
      v17 = off_140013400;
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x200) != 0
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        v18 = sub_140006410(*(_DWORD *)(v36 + 136));
        sub_14000B988((__int64)v17->AttachedDevice, 0xDAu, (__int64)&unk_140012330, v30, v29, (__int64)v18);
      }
      if ( (unsigned int)sub_14000F310(v15, (__int64)&v31) )
      {
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 0x200) != 0
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          sub_140001558((__int64)off_140013400->AttachedDevice, 0xE1u, (__int64)&unk_140012330);
        }
        goto LABEL_86;
      }
      v19 = NdisGetDataBuffer(v13, v13->DataLength, 0i64, 1u, 0);
      v20 = v19;
      if ( v19 )
      {
        memmove((void *)(v31 + v16), v19, v13->DataLength);
      }
      else
      {
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 0x200) != 0
          && BYTE1(off_140013400->Timer) >= 5u )
        {
          sub_140001558((__int64)off_140013400->AttachedDevice, 0xDBu, (__int64)&unk_140012330);
        }
        v20 = NdisGetDataBuffer(v13, v13->DataLength, (PVOID)(v31 + v16), 1u, 0);
        if ( !v20 )
        {
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && (HIDWORD(off_140013400->Timer) & 0x200) != 0
            && BYTE1(off_140013400->Timer) >= 2u )
          {
            sub_140001558((__int64)off_140013400->AttachedDevice, 0xDCu, (__int64)&unk_140012330);
          }
          goto LABEL_81;
        }
      }
      v21 = v31;
      *(_QWORD *)&v32 = v31;
      *(_QWORD *)&Src = v36;
      DWORD2(v32) = v15;
      DWORD2(Src) = v37;
      v22 = off_140013400;
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x200) != 0
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        v23 = sub_140006410(*(_DWORD *)(v36 + 136));
        LODWORD(v27) = v16;
        LODWORD(v26) = v15;
        sub_14000BEFC((__int64)v22->AttachedDevice, 0xDDu, (__int64)&unk_140012330, v20, v21, v23, v26, v27);
      }
      v24 = sub_140010268(1u, (__int64)&v32, 40);
      if ( v24
        && off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x200) != 0
        && BYTE1(off_140013400->Timer) >= 2u )
      {
        sub_140001580((__int64)off_140013400->AttachedDevice, 0xDEu, (__int64)&unk_140012330, v24);
      }
      if ( HIDWORD(Src) )
      {
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 0x200) != 0
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          sub_140001558((__int64)off_140013400->AttachedDevice, 0xDFu, (__int64)&unk_140012330);
        }
        v4 = 1;
        v28 = 1;
      }
      else
      {
        v4 = v28;
      }
      if ( !(_DWORD)v34 )
      {
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 0x200) != 0
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          sub_140001558((__int64)off_140013400->AttachedDevice, 0xE0u, (__int64)&unk_140012330);
        }
        v4 = 1;
        v28 = 1;
      }
LABEL_81:
      sub_14000F990(v31);
LABEL_86:
      v13 = (_NET_BUFFER *)v13->Link.Alignment;
      v8 = v36;
      v14 = v29;
      if ( !v13 )
        goto LABEL_87;
    }
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x200) != 0
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    v10 = "Outbound";
    if ( !a3 )
      v10 = "Inbound";
    sub_14000BFC8((__int64)off_140013400->AttachedDevice, 0xD4u, (__int64)&unk_140012330, v10);
  }
  if ( dword_140013580 == 3 )
  {
    v11 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
      || (HIDWORD(off_140013400->Timer) & 0x200) == 0
      || BYTE1(off_140013400->Timer) < 4u )
    {
      goto LABEL_29;
    }
    v12 = 213;
LABEL_28:
    sub_140001558((__int64)v11->AttachedDevice, v12, (__int64)&unk_140012330);
LABEL_29:
    v6[1] = 1;
    return 1;
  }
  if ( a3 )
  {
    if ( dword_140013580 == 2 )
    {
      v11 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || (HIDWORD(off_140013400->Timer) & 0x200) == 0
        || BYTE1(off_140013400->Timer) < 4u )
      {
        goto LABEL_29;
      }
      v12 = 215;
      goto LABEL_28;
    }
  }
  else if ( dword_140013580 == 1 )
  {
    v11 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
      || (HIDWORD(off_140013400->Timer) & 0x200) == 0
      || BYTE1(off_140013400->Timer) < 4u )
    {
      goto LABEL_29;
    }
    v12 = 214;
    goto LABEL_28;
  }
  return 1;
}
// 14000613E: variable 'v26' is possibly undefined
// 14000613E: variable 'v27' is possibly undefined
// 140013580: using guessed type int dword_140013580;

//----- (0000000140006410) ----------------------------------------------------
const char *__fastcall sub_140006410(int a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // ecx
  int v4; // ecx
  int v5; // ecx

  v1 = a1 - 1;
  if ( !v1 )
    return "ETHERNET";
  v2 = v1 - 1;
  if ( !v2 )
    return "WIFI";
  v3 = v2 - 1;
  if ( !v3 )
    return "FDDI";
  v4 = v3 - 1;
  if ( !v4 )
    return "POTS";
  v5 = v4 - 1;
  if ( !v5 )
    return "ISDN";
  if ( v5 == 1 )
    return "MOBILE_BROADBAND";
  return "UNKNOWN";
}

//----- (0000000140006468) ----------------------------------------------------
void __fastcall sub_140006468(_QWORD *a1)
{
  __int64 v2; // rbp
  unsigned __int64 v3; // r14
  PDEVICE_OBJECT v4; // rsi
  __int64 v5; // rbx
  const char *v6; // r8
  unsigned __int8 v7; // bp
  int v8; // er9
  int v9; // edx
  PDEVICE_OBJECT v10; // rdi
  const char *v11; // rax
  unsigned __int16 v12; // dx
  ULONG v13; // esi
  int v14; // er8
  int v15; // edx
  int v16; // esi
  _NET_BUFFER_LIST *v17; // rdx
  int v18; // edx
  ULONG v19; // esi
  const char *v20; // r9
  int v21; // er8
  int v22; // edx
  int v23; // esi
  const char *v24; // r9
  __int64 ReceiveFlags; // [rsp+20h] [rbp-48h]
  __int64 v26; // [rsp+28h] [rbp-40h]
  __int64 v27; // [rsp+30h] [rbp-38h]
  const char *v28; // [rsp+30h] [rbp-38h]

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1A6u, (__int64)&unk_140012330);
  }
  if ( !a1 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u)
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x1A7u, (__int64)&unk_140012330, 0i64);
    }
    return;
  }
  v2 = *a1;
  if ( *a1 && a1[3] )
  {
    v3 = *((unsigned int *)a1 + 2);
    v4 = off_140013400;
    v5 = a1[3];
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u) && BYTE1(off_140013400->Timer) >= 5u )
      {
        v28 = sub_140006C90(*((_DWORD *)a1 + 4));
        v6 = "Outbound";
        if ( !*((_DWORD *)a1 + 3) )
          v6 = "Inbound";
        sub_14000BD0C((__int64)v4->AttachedDevice, 0x1A9u, (__int64)&unk_140012330, v2, v3, v6, v28);
        v5 = a1[3];
      }
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u)
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        LODWORD(v27) = *(_DWORD *)(v5 + 24);
        LODWORD(v26) = *(_DWORD *)(v5 + 20);
        LODWORD(ReceiveFlags) = *(_DWORD *)(v5 + 16);
        sub_14000BB98(
          (__int64)off_140013400->AttachedDevice,
          0x1AAu,
          (__int64)&unk_140012330,
          *(_QWORD *)(v5 + 8),
          ReceiveFlags,
          v26,
          v27);
      }
    }
    v7 = KeGetCurrentIrql();
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140001580((__int64)off_140013400->AttachedDevice, 0x1ABu, (__int64)&unk_140012330, v7);
    }
    v8 = *((_DWORD *)a1 + 3);
    if ( v8 )
    {
      if ( v8 != 1 )
      {
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u)
          && BYTE1(off_140013400->Timer) >= 2u )
        {
          sub_140001580((__int64)off_140013400->AttachedDevice, 0x1B2u, (__int64)&unk_140012330, v8);
        }
        goto LABEL_84;
      }
      _InterlockedExchangeAdd64(&qword_140014660, v3);
      v9 = *((_DWORD *)a1 + 4);
      if ( v9 )
      {
        if ( v9 == 1 )
        {
          v13 = *(_DWORD *)(v5 + 20) | 1;
          if ( v7 != 2 )
            v13 = *(_DWORD *)(v5 + 20) & 0xFFFFFFFE;
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            LODWORD(v27) = *(_DWORD *)(v5 + 16);
            LODWORD(v26) = v13;
            LODWORD(ReceiveFlags) = v3;
            sub_14000BB98(
              (__int64)off_140013400->AttachedDevice,
              0x1AFu,
              (__int64)&unk_140012330,
              *a1,
              ReceiveFlags,
              v26,
              v27);
          }
          NdisFSendNetBufferLists(
            *(NDIS_HANDLE *)(*(_QWORD *)(v5 + 8) + 16i64),
            (PNET_BUFFER_LIST)*a1,
            *(_DWORD *)(v5 + 16),
            v13);
          goto LABEL_84;
        }
        v10 = off_140013400;
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u)
          && BYTE1(off_140013400->Timer) >= 2u )
        {
          v11 = sub_140006C90(v9);
          v12 = 433;
LABEL_61:
          sub_14000BFC8((__int64)v10->AttachedDevice, v12, (__int64)&unk_140012330, v11);
          goto LABEL_84;
        }
        goto LABEL_84;
      }
      v14 = *(_DWORD *)(v5 + 20);
      v15 = (v7 == 2) | 2;
      if ( (v14 & 4) == 0 )
        v15 = v7 == 2;
      v16 = v15 | 4;
      if ( (v14 & 0x20) == 0 )
        v16 = v15;
      _InterlockedExchangeAdd64(&qword_140014690, v3);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u)
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        LODWORD(v27) = *(_DWORD *)(v5 + 16);
        LODWORD(v26) = v16;
        LODWORD(ReceiveFlags) = v3;
        sub_14000BB98(
          (__int64)off_140013400->AttachedDevice,
          0x1B0u,
          (__int64)&unk_140012330,
          *a1,
          ReceiveFlags,
          v26,
          v27);
      }
      v17 = (_NET_BUFFER_LIST *)*a1;
      if ( !*(_BYTE *)(v5 + 28) )
      {
        NdisFSendNetBufferListsComplete(*(NDIS_HANDLE *)(*(_QWORD *)(v5 + 8) + 16i64), v17, v16);
        goto LABEL_84;
      }
    }
    else
    {
      _InterlockedExchangeAdd64(&qword_140014658, v3);
      v18 = *((_DWORD *)a1 + 4);
      if ( v18 )
      {
        if ( v18 == 1 )
        {
          v19 = *(_DWORD *)(v5 + 20) | 1;
          if ( v7 != 2 )
            v19 = *(_DWORD *)(v5 + 20) & 0xFFFFFFFE;
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            v20 = "ALIEN";
            if ( *(_BYTE *)(v5 + 28) )
              v20 = "OURS";
            sub_14000C250((__int64)off_140013400->AttachedDevice, 0x1ACu, (__int64)&unk_140012330, v20);
          }
          NdisFIndicateReceiveNetBufferLists(
            *(NDIS_HANDLE *)(*(_QWORD *)(v5 + 8) + 16i64),
            (PNET_BUFFER_LIST)*a1,
            *(_DWORD *)(v5 + 16),
            v3,
            v19);
          goto LABEL_84;
        }
        v10 = off_140013400;
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u)
          && BYTE1(off_140013400->Timer) >= 3u )
        {
          v11 = sub_140006C90(v18);
          v12 = 430;
          goto LABEL_61;
        }
LABEL_84:
        if ( v5 )
          sub_140006E48((PSLIST_ENTRY)v5, v3, 2);
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u)
          && BYTE1(off_140013400->Timer) >= 5u )
        {
          sub_140001558((__int64)off_140013400->AttachedDevice, 0x1B3u, (__int64)&unk_140012330);
        }
        return;
      }
      v21 = *(_DWORD *)(v5 + 20);
      v22 = (v7 == 2) | 2;
      if ( (v21 & 0x800) == 0 )
        v22 = v7 == 2;
      v23 = v22 | 4;
      if ( (v21 & 0x8000) == 0 )
        v23 = v22;
      _InterlockedExchangeAdd64(&qword_140014688, v3);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u)
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        v24 = "ALIEN";
        if ( *(_BYTE *)(v5 + 28) )
          v24 = "OURS";
        sub_14000C250((__int64)off_140013400->AttachedDevice, 0x1ADu, (__int64)&unk_140012330, v24);
      }
      v17 = (_NET_BUFFER_LIST *)*a1;
      if ( !*(_BYTE *)(v5 + 28) )
      {
        NdisFReturnNetBufferLists(*(NDIS_HANDLE *)(*(_QWORD *)(v5 + 8) + 16i64), v17, v23);
        goto LABEL_84;
      }
    }
    sub_1400097CC(v17);
    goto LABEL_84;
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x12u)
    && BYTE1(off_140013400->Timer) >= 2u )
  {
    sub_14000BA60((__int64)off_140013400->AttachedDevice, 0x1A8u, (__int64)&unk_140012330, *a1, a1[3]);
  }
}
// 1400065C2: variable 'ReceiveFlags' is possibly undefined
// 1400065C2: variable 'v26' is possibly undefined
// 1400065C2: variable 'v27' is possibly undefined
// 140014658: using guessed type __int64 qword_140014658;
// 140014660: using guessed type __int64 qword_140014660;
// 140014688: using guessed type __int64 qword_140014688;
// 140014690: using guessed type __int64 qword_140014690;

//----- (00000001400069CC) ----------------------------------------------------
void __fastcall sub_1400069CC(PNET_BUFFER_LIST NetBufferList)
{
  __int64 v2; // rbx
  PVOID v3; // rdi
  UINT v4; // ebp

  v2 = *(_QWORD *)(NetBufferList->Link.Region + 32);
  if ( (*(_BYTE *)(v2 + 10) & 5) != 0 )
    v3 = *(PVOID *)(v2 + 24);
  else
    v3 = MmMapLockedPagesSpecifyCache((PMDL)v2, 0, MmCached, 0i64, 0, dword_1400134B0 | 0x40000020u);
  v4 = *(_DWORD *)(v2 + 40);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    sub_14000B808((__int64)off_140013400->AttachedDevice, 0xC8u, (__int64)&unk_140012330, NetBufferList);
  }
  NdisFreeMdl((PMDL)v2);
  NdisFreeNetBufferList(NetBufferList);
  if ( v3 )
    NdisFreeMemory(v3, v4, 0);
}
// 1400134B0: using guessed type int dword_1400134B0;

//----- (0000000140006A94) ----------------------------------------------------
const char *__fastcall sub_140006A94(__int64 a1)
{
  switch ( *(_DWORD *)(a1 + 8) )
  {
    case 1:
      return "NDIS is pausing the stack because of an internal event";
    case 2:
      return "NDIS is pausing the stack because a network adapter is going to a low-power state";
    case 4:
      return "NDIS is pausing the stack to bind a protocol driver";
    case 8:
      return "NDIS is pausing the stack to unbind a protocol driver";
    case 0x10:
      return "NDIS is pausing the stack to attach a filter module";
    case 0x20:
      return "NDIS is pausing the stack to detach a filter module";
    case 0x40:
      return "NDIS is pausing the stack because a filter driver is restarting the stack";
    case 0x80:
      return "NDIS is pausing the stack because a miniport driver is removing a device";
  }
  return "NDIS is pausing the stack by UNKNOWN reason!!";
}

//----- (0000000140006B08) ----------------------------------------------------
__int64 __fastcall sub_140006B08(unsigned int a1, int a2)
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 2) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xEAu, (__int64)&unk_140012330);
  }
  if ( a2 == 6 )
  {
    a1 += 14;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return a1;
    if ( (HIDWORD(off_140013400->Timer) & 2) != 0 && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001580((__int64)off_140013400->AttachedDevice, 0xEBu, (__int64)&unk_140012330, a1);
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 2) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xECu, (__int64)&unk_140012330);
  }
  return a1;
}

//----- (0000000140006BCC) ----------------------------------------------------
__int64 __fastcall sub_140006BCC(int a1)
{
  unsigned int v2; // ebx

  v2 = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 2) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xEDu, (__int64)&unk_140012330);
  }
  if ( a1 == 6 )
  {
    v2 = 14;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return v2;
    if ( (HIDWORD(off_140013400->Timer) & 2) != 0 && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001580((__int64)off_140013400->AttachedDevice, 0xEEu, (__int64)&unk_140012330, 14);
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 2) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xEFu, (__int64)&unk_140012330);
  }
  return v2;
}

//----- (0000000140006C90) ----------------------------------------------------
const char *__fastcall sub_140006C90(int a1)
{
  int v1; // ecx

  if ( !a1 )
    return "DISCARD";
  v1 = a1 - 1;
  if ( !v1 )
    return "PASS";
  if ( v1 == 1 )
    return "PENDING";
  return "UNKNOWN";
}

//----- (0000000140006CC0) ----------------------------------------------------
__int64 __fastcall sub_140006CC0(_NET_BUFFER_LIST *a1)
{
  __int64 result; // rax

  if ( a1 )
  {
    result = (unsigned int)_InterlockedExchangeAdd(&a1->ChildRefCount, 0xFFFFFFFF);
    if ( (_DWORD)result == 1 )
    {
      NdisFreeCloneNetBufferList(a1, 2u);
      result = (__int64)&off_140013400;
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x20000) != 0
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        result = sub_14000B808((__int64)off_140013400->AttachedDevice, 0x191u, (__int64)&unk_140012330, a1);
      }
    }
  }
  return result;
}

//----- (0000000140006D28) ----------------------------------------------------
void __fastcall sub_140006D28(PSLIST_ENTRY ListEntry)
{
  _LOOKASIDE_LIST_EX *v2; // rdx

  if ( ListEntry )
  {
    ++Lookaside.L.TotalFrees;
    if ( ExQueryDepthSList(&Lookaside.L.ListHead) < Lookaside.L.Depth )
    {
      ExpInterlockedPushEntrySList(&Lookaside.L.ListHead, ListEntry);
    }
    else
    {
      ++Lookaside.L.FreeMisses;
      Lookaside.L.FreeEx(ListEntry, v2);
    }
  }
}
// 140006D61: variable 'v2' is possibly undefined

//----- (0000000140006D80) ----------------------------------------------------
PSLIST_ENTRY __fastcall sub_140006D80(__int64 a1, int a2, int a3, char a4, int a5)
{
  PSLIST_ENTRY v9; // rbx
  _LOOKASIDE_LIST_EX *v10; // r9

  ++Lookaside.L.TotalAllocates;
  v9 = ExpInterlockedPopEntrySList(&Lookaside.L.ListHead);
  if ( v9
    || (++Lookaside.L.AllocateMisses,
        (v9 = (PSLIST_ENTRY)Lookaside.L.AllocateEx(Lookaside.L.Type, Lookaside.L.Size, Lookaside.L.Tag, v10)) != 0i64) )
  {
    *v9 = 0i64;
    v9[1] = 0i64;
    KeInitializeSpinLock((PKSPIN_LOCK)v9);
    *((_QWORD *)&v9->Next + 1) = a1;
    HIDWORD(v9[1].Next) = a2;
    if ( a4 )
    {
      LODWORD(v9[1].Next) = 0;
      *((_BYTE *)&v9[1].Next + 12) = 1;
      if ( !a5 )
        HIDWORD(v9[1].Next) = a2 & 0xFFFFFFFD;
    }
    else
    {
      LODWORD(v9[1].Next) = a3;
      *((_BYTE *)&v9[1].Next + 12) = 0;
    }
  }
  return v9;
}
// 140006DDF: variable 'v10' is possibly undefined

//----- (0000000140006E48) ----------------------------------------------------
void __fastcall sub_140006E48(PSLIST_ENTRY ListEntry, int a2, int a3)
{
  int v6; // ebx
  int v7; // ebx
  struct _KLOCK_QUEUE_HANDLE LockHandle; // [rsp+20h] [rbp-28h] BYREF

  if ( ListEntry && (!a3 || a2) )
  {
    KeAcquireInStackQueuedSpinLock((PKSPIN_LOCK)ListEntry, &LockHandle);
    if ( a3 )
    {
      v6 = a3 - 1;
      if ( v6 )
      {
        if ( v6 == 1 )
          *((_DWORD *)&ListEntry[1].Next + 2) -= a2;
      }
      else
      {
        *((_DWORD *)&ListEntry[1].Next + 2) += a2;
      }
    }
    else
    {
      *((_DWORD *)&ListEntry[1].Next + 2) = a2;
    }
    v7 = *((_DWORD *)&ListEntry[1].Next + 2);
    KeReleaseInStackQueuedSpinLock(&LockHandle);
    if ( !v7 )
      sub_140006D28(ListEntry);
  }
}

//----- (0000000140006EBC) ----------------------------------------------------
void __fastcall sub_140006EBC(PNET_BUFFER_LIST NetBufferList)
{
  char v2; // r13
  PNET_BUFFER v3; // rbx
  PMDL v4; // rbp
  _NET_BUFFER *v5; // r12
  PVOID v6; // r15
  UINT Length; // [rsp+60h] [rbp+8h]

  v2 = 1;
  if ( NetBufferList )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x800000) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x1A4u, (__int64)&unk_140012330, NetBufferList);
    }
    v3 = NetBufferList->FirstNetBuffer;
    if ( v3 )
    {
      do
      {
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 0x800000) != 0
          && BYTE1(off_140013400->Timer) >= 5u )
        {
          sub_14000B808((__int64)off_140013400->AttachedDevice, 0x1A5u, (__int64)&unk_140012330, v3);
        }
        v4 = v3->MdlChain;
        v5 = (_NET_BUFFER *)v3->Link.Alignment;
        if ( (v4->MdlFlags & 5) != 0 )
          v6 = v4->MappedSystemVa;
        else
          v6 = MmMapLockedPagesSpecifyCache(v4, 0, MmCached, 0i64, 0, dword_1400134B0 | 0x40000020u);
        Length = v4->ByteCount;
        NdisFreeMdl(v4);
        if ( v6 )
          NdisFreeMemory(v6, Length, 0);
        if ( !v2 )
          NdisFreeNetBuffer(v3);
        v2 = 0;
        v3 = v5;
      }
      while ( v5 );
    }
    NdisFreeNetBufferList(NetBufferList);
  }
  else if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
         && (HIDWORD(off_140013400->Timer) & 0x800000) != 0
         && BYTE1(off_140013400->Timer) >= 2u )
  {
    sub_14000B808((__int64)off_140013400->AttachedDevice, 0x1A3u, (__int64)&unk_140012330, 0i64);
  }
}
// 1400134B0: using guessed type int dword_1400134B0;

//----- (0000000140007040) ----------------------------------------------------
__int64 __fastcall sub_140007040(__int64 a1, _NET_BUFFER_LIST *a2, int a3)
{
  PNET_BUFFER_LIST v3; // r14
  __int64 v4; // r13
  PNET_BUFFER_LIST v5; // r8
  _NET_BUFFER *v6; // r12
  SIZE_T DataLength; // rsi
  PVOID v8; // rax
  void *v9; // r15
  _MDL *v10; // rax
  _MDL *v11; // r13
  __int16 v12; // ax
  PNET_BUFFER_LIST v13; // rax
  PNET_BUFFER v14; // r14
  PNET_BUFFER_LIST v15; // rcx
  void *v16; // rax
  UCHAR *v17; // rdx
  PDEVICE_OBJECT v18; // rcx
  unsigned __int16 v19; // dx
  _NET_BUFFER_LIST *v20; // rcx
  PNET_BUFFER_LIST v21; // rbx
  ULONG BytesCopied; // [rsp+30h] [rbp-68h] BYREF
  PNET_BUFFER_LIST NetBufferList; // [rsp+38h] [rbp-60h]
  _QWORD *v25; // [rsp+40h] [rbp-58h]
  PNET_BUFFER_LIST v26; // [rsp+48h] [rbp-50h]
  __int64 v27; // [rsp+A0h] [rbp+8h]
  PNET_BUFFER_LIST SrcNetBufferList; // [rsp+A8h] [rbp+10h]
  char v30; // [rsp+B8h] [rbp+20h]

  SrcNetBufferList = a2;
  v27 = a1;
  v30 = 1;
  v26 = 0i64;
  v3 = a2;
  NetBufferList = 0i64;
  v4 = a1;
  v25 = 0i64;
  v5 = 0i64;
  BytesCopied = 0;
  if ( a1 && a2 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x17u)
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x199u, (__int64)&unk_140012330, a2);
      v5 = NetBufferList;
    }
    v6 = v3->FirstNetBuffer;
    if ( v6 )
    {
      while ( 1 )
      {
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x17u)
          && BYTE1(off_140013400->Timer) >= 5u )
        {
          sub_14000B808((__int64)off_140013400->AttachedDevice, 0x19Au, (__int64)&unk_140012330, v6);
        }
        DataLength = v6->DataLength;
        v8 = NdisAllocateMemoryWithTagPriority(*(NDIS_HANDLE *)(v4 + 16), v6->DataLength, 0x4E414859u, HighPoolPriority);
        v9 = v8;
        if ( !v8 )
        {
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x17u)
            && BYTE1(off_140013400->Timer) >= 2u )
          {
            sub_140001558((__int64)off_140013400->AttachedDevice, 0x19Bu, (__int64)&unk_140012330);
          }
          goto LABEL_43;
        }
        v10 = NdisAllocateMdl(*(NDIS_HANDLE *)(v4 + 16), v8, DataLength);
        v11 = v10;
        if ( !v10 )
        {
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x17u)
            && BYTE1(off_140013400->Timer) >= 2u )
          {
            sub_140001558((__int64)off_140013400->AttachedDevice, 0x19Cu, (__int64)&unk_140012330);
          }
          NdisFreeMemory(v9, DataLength, 0);
          goto LABEL_43;
        }
        if ( v6 == v3->FirstNetBuffer )
        {
          v12 = sub_14000E3C8(32);
          v13 = NdisAllocateNetBufferAndNetBufferList(*(NDIS_HANDLE *)(v27 + 624), v12, 0, v11, 0, DataLength);
          NetBufferList = v13;
          if ( !v13 )
          {
            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
              && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x17u)
              && BYTE1(off_140013400->Timer) >= 2u )
            {
              sub_140001558((__int64)off_140013400->AttachedDevice, 0x19Du, (__int64)&unk_140012330);
            }
            NdisFreeMemory(v9, DataLength, 0);
            NdisFreeMdl(v11);
            return (__int64)v26;
          }
          v14 = v13->FirstNetBuffer;
        }
        else
        {
          v14 = NdisAllocateNetBuffer(*(NDIS_HANDLE *)(v27 + 632), v10, 0, DataLength);
          if ( !v14 )
          {
            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
              && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x17u)
              && BYTE1(off_140013400->Timer) >= 2u )
            {
              sub_140001558((__int64)off_140013400->AttachedDevice, 0x19Eu, (__int64)&unk_140012330);
            }
            NdisFreeMemory(v9, DataLength, 0);
            NdisFreeMdl(v11);
            goto LABEL_43;
          }
        }
        if ( NdisCopyFromNetBufferToNetBuffer(v14, 0, DataLength, v6, 0, &BytesCopied) )
        {
          v18 = off_140013400;
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x17u)
            && BYTE1(off_140013400->Timer) >= 2u )
          {
            v19 = 415;
LABEL_40:
            sub_140001558((__int64)v18->AttachedDevice, v19, (__int64)&unk_140012330);
          }
LABEL_41:
          NdisFreeMemory(v9, DataLength, 0);
          NdisFreeMdl(v11);
          if ( !v30 )
            NdisFreeNetBuffer(v14);
LABEL_43:
          v20 = NetBufferList;
          goto LABEL_44;
        }
        if ( BytesCopied != (_DWORD)DataLength )
        {
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x17u)
            && BYTE1(off_140013400->Timer) >= 2u )
          {
            sub_1400015BC((__int64)off_140013400->AttachedDevice, 0x1A0u, (__int64)&unk_140012330, DataLength);
          }
          goto LABEL_41;
        }
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x17u)
          && BYTE1(off_140013400->Timer) >= 5u )
        {
          sub_14000B808((__int64)off_140013400->AttachedDevice, 0x1A1u, (__int64)&unk_140012330, v14);
        }
        if ( dword_140013598 )
        {
          v14->DataLength = DataLength;
          v14->DataOffset = 0;
          v14->CurrentMdlOffset = 0;
        }
        v15 = NetBufferList;
        v16 = *(void **)(v27 + 16);
        NetBufferList->Status = 0;
        v15->Link.Alignment = 0i64;
        v15->SourceHandle = v16;
        sub_140007544(SrcNetBufferList, v15, a3);
        v5 = NetBufferList;
        v17 = &NetBufferList->Context->ContextData[NetBufferList->Context->Offset];
        if ( !v17 )
        {
          v18 = off_140013400;
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x17u)
            && BYTE1(off_140013400->Timer) >= 2u )
          {
            v19 = 418;
            goto LABEL_40;
          }
          goto LABEL_41;
        }
        v4 = v27;
        *(_DWORD *)v17 = *(_DWORD *)(v27 + 248);
        *((_DWORD *)v17 + 6) = 1;
        strcpy((char *)v17 + 4, "NAHSL");
        if ( v6 != SrcNetBufferList->FirstNetBuffer )
          *v25 = v14;
        v6 = (_NET_BUFFER *)v6->Link.Alignment;
        v25 = &v14->Link.Alignment;
        v30 = 0;
        if ( !v6 )
          break;
        v3 = SrcNetBufferList;
      }
    }
    v21 = v5;
    v26 = v5;
    sub_140009A24((__int64)v5, a3, "NBL_COPY");
    v20 = 0i64;
    if ( !v21 )
    {
LABEL_44:
      if ( v20 )
        sub_140006EBC(v20);
    }
  }
  else if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
         && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x17u)
         && BYTE1(off_140013400->Timer) >= 2u )
  {
    sub_14000BA60((__int64)off_140013400->AttachedDevice, 0x198u, (__int64)&unk_140012330, a1, a2);
  }
  return (__int64)v26;
}
// 140013598: using guessed type int dword_140013598;

//----- (0000000140007544) ----------------------------------------------------
void __fastcall sub_140007544(PNET_BUFFER_LIST SrcNetBufferList, PNET_BUFFER_LIST DestNetBufferList, int a3)
{
  __int64 v6; // rcx

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    sub_14000BA60(
      (__int64)off_140013400->AttachedDevice,
      0x18Du,
      (__int64)&unk_140012330,
      SrcNetBufferList,
      DestNetBufferList);
  }
  if ( SrcNetBufferList && DestNetBufferList )
  {
    DestNetBufferList->NblFlags = SrcNetBufferList->NblFlags;
    if ( dword_140013588 )
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x18Fu, (__int64)&unk_140012330);
      }
      if ( a3 )
        NdisCopySendNetBufferListInfo(DestNetBufferList, SrcNetBufferList);
      else
        NdisCopyReceiveNetBufferListInfo(DestNetBufferList, SrcNetBufferList);
    }
    else
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x18Eu, (__int64)&unk_140012330);
      }
      v6 = 2i64;
      DestNetBufferList->NetBufferListInfo[0] = SrcNetBufferList->NetBufferListInfo[0];
      do
      {
        DestNetBufferList->NetBufferListInfo[7] = SrcNetBufferList->NetBufferListInfo[7];
        --v6;
      }
      while ( v6 );
    }
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_14000BA60(
        (__int64)off_140013400->AttachedDevice,
        0x190u,
        (__int64)&unk_140012330,
        SrcNetBufferList,
        DestNetBufferList);
    }
  }
}
// 140013588: using guessed type int dword_140013588;

//----- (00000001400076B8) ----------------------------------------------------
void **__fastcall sub_1400076B8(__int64 a1)
{
  void **result; // rax
  int v3; // er9
  void *retaddr; // [rsp+28h] [rbp+0h] BYREF

  result = &retaddr;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    result = (void **)sub_140001580(
                        (__int64)off_140013400->AttachedDevice,
                        0xFEu,
                        (__int64)&unk_140012330,
                        *(_DWORD *)(a1 + 128));
  }
  if ( !*(_DWORD *)(a1 + 128) )
    goto LABEL_46;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
      result = (void **)sub_140001580(
                          (__int64)off_140013400->AttachedDevice,
                          0xFFu,
                          (__int64)&unk_140012330,
                          *(_DWORD *)(a1 + 128) & 1);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
        result = (void **)sub_140001580(
                            (__int64)off_140013400->AttachedDevice,
                            0x100u,
                            (__int64)&unk_140012330,
                            (*(_DWORD *)(a1 + 128) >> 1) & 1);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
      {
        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
          result = (void **)sub_140001580(
                              (__int64)off_140013400->AttachedDevice,
                              0x101u,
                              (__int64)&unk_140012330,
                              (*(_DWORD *)(a1 + 128) >> 15) & 1);
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
        {
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
            result = (void **)sub_140001580(
                                (__int64)off_140013400->AttachedDevice,
                                0x102u,
                                (__int64)&unk_140012330,
                                (*(_DWORD *)(a1 + 128) >> 9) & 1);
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
          {
            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
              result = (void **)sub_140001580(
                                  (__int64)off_140013400->AttachedDevice,
                                  0x103u,
                                  (__int64)&unk_140012330,
                                  (*(_DWORD *)(a1 + 128) >> 10) & 1);
            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
            {
              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
                && BYTE1(off_140013400->Timer) >= 4u )
              {
                result = (void **)sub_140001580(
                                    (__int64)off_140013400->AttachedDevice,
                                    0x104u,
                                    (__int64)&unk_140012330,
                                    (*(_DWORD *)(a1 + 128) >> 11) & 1);
              }
              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
              {
                if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
                  && BYTE1(off_140013400->Timer) >= 4u )
                {
                  result = (void **)sub_140001580(
                                      (__int64)off_140013400->AttachedDevice,
                                      0x105u,
                                      (__int64)&unk_140012330,
                                      (*(_DWORD *)(a1 + 128) >> 12) & 1);
                }
                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                {
                  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
                    && BYTE1(off_140013400->Timer) >= 4u )
                  {
                    result = (void **)sub_140001580(
                                        (__int64)off_140013400->AttachedDevice,
                                        0x106u,
                                        (__int64)&unk_140012330,
                                        (*(_DWORD *)(a1 + 128) >> 8) & 1);
                  }
                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                  {
                    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
                      && BYTE1(off_140013400->Timer) >= 4u )
                    {
                      result = (void **)sub_140001580(
                                          (__int64)off_140013400->AttachedDevice,
                                          0x107u,
                                          (__int64)&unk_140012330,
                                          (*(_DWORD *)(a1 + 128) >> 13) & 1);
                    }
                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                    {
                      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
                        && BYTE1(off_140013400->Timer) >= 4u )
                      {
                        result = (void **)sub_140001580(
                                            (__int64)off_140013400->AttachedDevice,
                                            0x108u,
                                            (__int64)&unk_140012330,
                                            (*(_DWORD *)(a1 + 128) >> 14) & 1);
                      }
LABEL_46:
                      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
                        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
                        && BYTE1(off_140013400->Timer) >= 5u )
                      {
                        result = (void **)sub_140001580(
                                            (__int64)off_140013400->AttachedDevice,
                                            0x109u,
                                            (__int64)&unk_140012330,
                                            *(_DWORD *)(a1 + 136));
                      }
                      goto LABEL_50;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
LABEL_50:
  v3 = *(_DWORD *)(a1 + 136);
  if ( v3 && off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
      result = (void **)sub_140001580(
                          (__int64)off_140013400->AttachedDevice,
                          0x10Au,
                          (__int64)&unk_140012330,
                          v3 & 0xFFF00003);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
        result = (void **)sub_140001580(
                            (__int64)off_140013400->AttachedDevice,
                            0x10Bu,
                            (__int64)&unk_140012330,
                            *(_DWORD *)(a1 + 136) & 0xF000);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
      {
        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
          result = (void **)sub_140001580(
                              (__int64)off_140013400->AttachedDevice,
                              0x10Cu,
                              (__int64)&unk_140012330,
                              *(_DWORD *)(a1 + 136) & 0xF0000);
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          result = (void **)sub_140001580(
                              (__int64)off_140013400->AttachedDevice,
                              0x10Du,
                              (__int64)&unk_140012330,
                              *(_DWORD *)(a1 + 136) & 0xFFC);
        }
      }
    }
  }
  return result;
}

//----- (0000000140007AB8) ----------------------------------------------------
void __fastcall sub_140007AB8(__int64 a1, int a2, int a3)
{
  int v4; // er9
  PDEVICE_OBJECT v6; // rcx
  __int64 v7; // r9
  unsigned __int16 v8; // dx
  __int64 v9; // rbx
  PDEVICE_OBJECT v10; // rcx
  int v11; // ebx
  unsigned __int16 v12; // dx
  __int64 v13; // rbx
  unsigned __int16 *v14; // r15
  __int64 v15; // rbx
  PDEVICE_OBJECT v16; // rcx
  unsigned __int16 v17; // dx
  int v18; // er9
  __int64 v19; // r15
  unsigned __int8 *v20; // rbx
  __int64 v21; // rax
  __int64 v22; // rbx
  __int64 v23; // rbx
  unsigned __int16 *v24; // rbx
  __int64 v25; // rbx
  __int64 v26; // [rsp+68h] [rbp+20h]

  v4 = a2;
  if ( a2 > 12 )
  {
    if ( a2 > 19 )
    {
      switch ( a2 )
      {
        case 20:
          v25 = *(_QWORD *)(a1 + 304);
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            sub_14000B808(
              (__int64)off_140013400->AttachedDevice,
              0x177u,
              (__int64)&unk_140012330,
              *(_QWORD *)(a1 + 304));
          }
          if ( !v25 || off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x178u,
              (__int64)&unk_140012330,
              *(_DWORD *)v25 & 0xFFFFFF);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x179u,
              (__int64)&unk_140012330,
              *(unsigned __int8 *)(v25 + 3));
          v10 = off_140013400;
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
            || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            || BYTE1(off_140013400->Timer) < 4u )
          {
            return;
          }
          v4 = *(_DWORD *)(v25 + 4);
          v12 = 378;
          break;
        case 21:
          v6 = off_140013400;
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            v7 = *(_QWORD *)(a1 + 312);
            v8 = 379;
            goto LABEL_204;
          }
          return;
        case 22:
          v24 = *(unsigned __int16 **)(a1 + 320);
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            sub_14000B808(
              (__int64)off_140013400->AttachedDevice,
              0x17Cu,
              (__int64)&unk_140012330,
              *(_QWORD *)(a1 + 320));
          }
          if ( !v24 || off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580((__int64)off_140013400->AttachedDevice, 0x17Du, (__int64)&unk_140012330, *v24);
          v10 = off_140013400;
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
            || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            || BYTE1(off_140013400->Timer) < 4u )
          {
            return;
          }
          v4 = v24[1];
          v12 = 382;
          break;
        case 23:
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x17Fu,
              (__int64)&unk_140012330,
              *(_DWORD *)(a1 + 328));
          }
          v23 = *(_QWORD *)(a1 + 328);
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            sub_14000B808(
              (__int64)off_140013400->AttachedDevice,
              0x180u,
              (__int64)&unk_140012330,
              *(_QWORD *)(a1 + 328));
          }
          if ( !v23 || off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580((__int64)off_140013400->AttachedDevice, 0x181u, (__int64)&unk_140012330, *(_DWORD *)v23 & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x182u,
              (__int64)&unk_140012330,
              (*(_DWORD *)v23 >> 1) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x183u,
              (__int64)&unk_140012330,
              (unsigned __int8)(*(_DWORD *)v23 >> 2));
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x184u,
              (__int64)&unk_140012330,
              (unsigned __int8)HIBYTE(*(_WORD *)v23) >> 2);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x185u,
              (__int64)&unk_140012330,
              *(_WORD *)(v23 + 2) & 0x3FF);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x186u,
              (__int64)&unk_140012330,
              (*(_DWORD *)v23 >> 26) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x187u,
              (__int64)&unk_140012330,
              (*(_DWORD *)v23 >> 27) & 1);
          v10 = off_140013400;
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
            || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            || BYTE1(off_140013400->Timer) < 4u )
          {
            return;
          }
          v12 = 392;
          v4 = *(_DWORD *)v23 >> 28;
          break;
        case 24:
          v10 = off_140013400;
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
            || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
            || BYTE1(off_140013400->Timer) < 4u )
          {
            return;
          }
          v12 = 395;
          v4 = 24;
          break;
        default:
LABEL_455:
          v10 = off_140013400;
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
            || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
            || BYTE1(off_140013400->Timer) < 4u )
          {
            return;
          }
          v12 = 396;
          goto LABEL_538;
      }
    }
    else
    {
      switch ( a2 )
      {
        case 19:
          v22 = *(_QWORD *)(a1 + 296);
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            sub_14000B808((__int64)off_140013400->AttachedDevice, 0x16Du, (__int64)&unk_140012330, v22);
          }
          if ( !v22 || off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x16Eu,
              (__int64)&unk_140012330,
              (unsigned __int16)v22);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580((__int64)off_140013400->AttachedDevice, 0x16Fu, (__int64)&unk_140012330, WORD1(v22));
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580((__int64)off_140013400->AttachedDevice, 0x170u, (__int64)&unk_140012330, BYTE4(v22));
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x173u,
              (__int64)&unk_140012330,
              (HIDWORD(v22) >> 8) & 3);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x174u,
              (__int64)&unk_140012330,
              (HIDWORD(v22) >> 10) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x175u,
              (__int64)&unk_140012330,
              (HIDWORD(v22) >> 11) & 0xFFF);
          v10 = off_140013400;
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
            || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            || BYTE1(off_140013400->Timer) < 4u )
          {
            return;
          }
          v11 = HIDWORD(v22) >> 23;
          v12 = 374;
          goto LABEL_56;
        case 13:
          v6 = off_140013400;
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            v7 = *(_QWORD *)(a1 + 248);
            v8 = 348;
            goto LABEL_204;
          }
          return;
        case 14:
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            sub_14000B808(
              (__int64)off_140013400->AttachedDevice,
              0x15Du,
              (__int64)&unk_140012330,
              *(_QWORD *)(a1 + 256));
          }
          v21 = *(_QWORD *)(a1 + 256);
          if ( !v21 )
            return;
          v26 = *(_QWORD *)(a1 + 256);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x15Eu,
              (__int64)&unk_140012330,
              (unsigned __int16)v21);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580((__int64)off_140013400->AttachedDevice, 0x15Fu, (__int64)&unk_140012330, WORD1(v26));
          v10 = off_140013400;
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
            || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            || BYTE1(off_140013400->Timer) < 4u )
          {
            return;
          }
          v4 = WORD1(v26);
          v12 = 352;
          break;
        case 15:
          v20 = *(unsigned __int8 **)(a1 + 264);
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            sub_14000B808(
              (__int64)off_140013400->AttachedDevice,
              0x162u,
              (__int64)&unk_140012330,
              *(_QWORD *)(a1 + 264));
          }
          if ( v20 && off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
          {
            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
              sub_140001580((__int64)off_140013400->AttachedDevice, 0x163u, (__int64)&unk_140012330, *v20);
            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
            {
              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
                && BYTE1(off_140013400->Timer) >= 4u )
              {
                sub_140001580((__int64)off_140013400->AttachedDevice, 0x164u, (__int64)&unk_140012330, v20[1]);
              }
              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
              {
                if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
                  && BYTE1(off_140013400->Timer) >= 4u )
                {
                  sub_140001580(
                    (__int64)off_140013400->AttachedDevice,
                    0x165u,
                    (__int64)&unk_140012330,
                    *((unsigned __int16 *)v20 + 1));
                }
                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                {
                  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
                    && BYTE1(off_140013400->Timer) >= 4u )
                  {
                    sub_14000B808(
                      (__int64)off_140013400->AttachedDevice,
                      0x166u,
                      (__int64)&unk_140012330,
                      *((_QWORD *)v20 + 1));
                  }
                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                  {
                    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
                      && BYTE1(off_140013400->Timer) >= 4u )
                    {
                      sub_140001580(
                        (__int64)off_140013400->AttachedDevice,
                        0x167u,
                        (__int64)&unk_140012330,
                        *((_DWORD *)v20 + 4));
                    }
                    v6 = off_140013400;
                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
                      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
                      && BYTE1(off_140013400->Timer) >= 4u )
                    {
                      v7 = *((_QWORD *)v20 + 3);
                      v8 = 360;
                      goto LABEL_204;
                    }
                  }
                }
              }
            }
          }
          return;
        case 16:
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
          {
            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
              sub_14000B808(
                (__int64)off_140013400->AttachedDevice,
                0x169u,
                (__int64)&unk_140012330,
                *(_QWORD *)(a1 + 272));
            v6 = off_140013400;
            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
              && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
              && BYTE1(off_140013400->Timer) >= 4u )
            {
              v7 = *(_QWORD *)(a1 + 272);
              v8 = 362;
              goto LABEL_204;
            }
          }
          return;
        case 17:
          v10 = off_140013400;
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
            || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            || BYTE1(off_140013400->Timer) < 4u )
          {
            return;
          }
          v4 = *(_DWORD *)(a1 + 280);
          v12 = 363;
          break;
        default:
          v6 = off_140013400;
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            v7 = *(_QWORD *)(a1 + 288);
            v8 = 364;
            goto LABEL_204;
          }
          return;
      }
    }
    goto LABEL_538;
  }
  if ( a2 == 12 )
  {
    v19 = a1 + 240;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x154u, (__int64)&unk_140012330, v19);
    }
    if ( !v19 )
      return;
    if ( a3 )
    {
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
        return;
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
        sub_140001580(
          (__int64)off_140013400->AttachedDevice,
          0x158u,
          (__int64)&unk_140012330,
          (unsigned __int8)*(_DWORD *)v19);
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
        return;
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
        sub_140001580(
          (__int64)off_140013400->AttachedDevice,
          0x159u,
          (__int64)&unk_140012330,
          *(unsigned __int8 *)(v19 + 1));
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
        return;
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
        sub_140001580(
          (__int64)off_140013400->AttachedDevice,
          0x15Au,
          (__int64)&unk_140012330,
          *(unsigned __int8 *)(v19 + 2));
      v10 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
        || BYTE1(off_140013400->Timer) < 4u )
      {
        return;
      }
      v4 = *(unsigned __int8 *)(v19 + 3);
      v12 = 347;
    }
    else
    {
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
        return;
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
        sub_140001580(
          (__int64)off_140013400->AttachedDevice,
          0x155u,
          (__int64)&unk_140012330,
          (unsigned __int8)*(_DWORD *)v19);
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
        return;
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
        sub_140001580(
          (__int64)off_140013400->AttachedDevice,
          0x156u,
          (__int64)&unk_140012330,
          *(unsigned __int8 *)(v19 + 1));
      v10 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
        || BYTE1(off_140013400->Timer) < 4u )
      {
        return;
      }
      v12 = 343;
      v4 = *(_WORD *)(v19 + 2) & 1;
    }
    goto LABEL_538;
  }
  if ( a2 > 6 )
  {
    if ( a2 != 7 )
    {
      switch ( a2 )
      {
        case 8:
          v10 = off_140013400;
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
            || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            || BYTE1(off_140013400->Timer) < 4u )
          {
            return;
          }
          v4 = *(_DWORD *)(a1 + 208);
          v12 = 334;
          goto LABEL_538;
        case 9:
          v10 = off_140013400;
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
            || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            || BYTE1(off_140013400->Timer) < 4u )
          {
            return;
          }
          v4 = *(_DWORD *)(a1 + 216);
          v12 = 335;
          goto LABEL_538;
        case 10:
          v6 = off_140013400;
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            v7 = *(_QWORD *)(a1 + 224);
            v8 = 336;
            goto LABEL_204;
          }
          return;
      }
      v14 = (unsigned __int16 *)(a1 + 232);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        sub_14000B808((__int64)off_140013400->AttachedDevice, 0x151u, (__int64)&unk_140012330, v14);
      }
      if ( !v14 )
        return;
      if ( !a3 )
      {
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          sub_140001558((__int64)off_140013400->AttachedDevice, 0x152u, (__int64)&unk_140012330);
        }
        return;
      }
      v6 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
        || BYTE1(off_140013400->Timer) < 4u )
      {
        return;
      }
      v8 = 339;
      goto LABEL_203;
    }
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return;
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001580(
        (__int64)off_140013400->AttachedDevice,
        0x14Cu,
        (__int64)&unk_140012330,
        *(unsigned __int16 *)(a1 + 200));
    v10 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
      || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
      || BYTE1(off_140013400->Timer) < 4u )
    {
      return;
    }
    v4 = *(unsigned __int8 *)(a1 + 200);
    v12 = 333;
LABEL_538:
    sub_140001580((__int64)v10->AttachedDevice, v12, (__int64)&unk_140012330, v4);
    return;
  }
  switch ( a2 )
  {
    case 6:
      v6 = off_140013400;
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        v7 = *(_QWORD *)(a1 + 192);
        v8 = 331;
        goto LABEL_204;
      }
      return;
    case 0:
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        sub_14000B808((__int64)off_140013400->AttachedDevice, 0x10Eu, (__int64)&unk_140012330, *(_QWORD *)(a1 + 144));
      }
      v15 = *(_QWORD *)(a1 + 144);
      if ( v15 )
      {
        if ( a3 )
        {
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x116u,
              (__int64)&unk_140012330,
              *(_DWORD *)(a1 + 144) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x117u,
              (__int64)&unk_140012330,
              ((unsigned int)v15 >> 1) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x118u,
              (__int64)&unk_140012330,
              ((unsigned int)v15 >> 2) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x119u,
              (__int64)&unk_140012330,
              ((unsigned int)v15 >> 3) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x11Au,
              (__int64)&unk_140012330,
              ((unsigned int)v15 >> 4) & 1);
          v16 = off_140013400;
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) || BYTE1(off_140013400->Timer) < 4u )
            goto LABEL_264;
          v18 = WORD1(v15) & 0x3FF;
          v17 = 283;
        }
        else
        {
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x10Fu,
              (__int64)&unk_140012330,
              *(_DWORD *)(a1 + 144) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x110u,
              (__int64)&unk_140012330,
              ((unsigned int)v15 >> 1) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x111u,
              (__int64)&unk_140012330,
              ((unsigned int)v15 >> 2) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x112u,
              (__int64)&unk_140012330,
              ((unsigned int)v15 >> 3) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x113u,
              (__int64)&unk_140012330,
              ((unsigned int)v15 >> 4) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x114u,
              (__int64)&unk_140012330,
              ((unsigned int)v15 >> 5) & 1);
          v16 = off_140013400;
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) || BYTE1(off_140013400->Timer) < 4u )
            goto LABEL_264;
          v17 = 277;
          v18 = ((unsigned int)v15 >> 6) & 1;
        }
        sub_140001580((__int64)v16->AttachedDevice, v17, (__int64)&unk_140012330, v18);
      }
LABEL_264:
      v10 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
        || BYTE1(off_140013400->Timer) < 4u )
      {
        return;
      }
      v4 = *(_DWORD *)(a1 + 144);
      v12 = 284;
      goto LABEL_538;
    case 1:
      v14 = (unsigned __int16 *)(a1 + 152);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        sub_14000B808((__int64)off_140013400->AttachedDevice, 0x11Du, (__int64)&unk_140012330, v14);
      }
      if ( v14 )
      {
        if ( a3 )
        {
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
            && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
            && BYTE1(off_140013400->Timer) >= 4u )
          {
            sub_14000B808((__int64)off_140013400->AttachedDevice, 0x123u, (__int64)&unk_140012330, *(_QWORD *)v14);
          }
        }
        else if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
        {
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580((__int64)off_140013400->AttachedDevice, 0x11Eu, (__int64)&unk_140012330, *v14 & 1);
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
          {
            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
              sub_140001580((__int64)off_140013400->AttachedDevice, 0x11Fu, (__int64)&unk_140012330, (*v14 >> 1) & 1);
            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
            {
              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
                && BYTE1(off_140013400->Timer) >= 4u )
              {
                sub_140001580((__int64)off_140013400->AttachedDevice, 0x120u, (__int64)&unk_140012330, (*v14 >> 2) & 1);
              }
              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
              {
                if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
                  && BYTE1(off_140013400->Timer) >= 4u )
                {
                  sub_140001580((__int64)off_140013400->AttachedDevice, 0x121u, (__int64)&unk_140012330, *v14 >> 3);
                }
                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
                  && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
                  && BYTE1(off_140013400->Timer) >= 4u )
                {
                  sub_140001580((__int64)off_140013400->AttachedDevice, 0x122u, (__int64)&unk_140012330, v14[1]);
                }
              }
            }
          }
        }
      }
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        sub_14000B808((__int64)off_140013400->AttachedDevice, 0x124u, (__int64)&unk_140012330, v14);
      }
      if ( !v14 )
        return;
      if ( !a3 )
      {
        if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
          return;
        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
          sub_140001580((__int64)off_140013400->AttachedDevice, 0x125u, (__int64)&unk_140012330, *(_DWORD *)v14 & 1);
        if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
          return;
        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
          sub_140001580(
            (__int64)off_140013400->AttachedDevice,
            0x126u,
            (__int64)&unk_140012330,
            (*(_DWORD *)v14 >> 1) & 1);
        if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
          return;
        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
          sub_140001580(
            (__int64)off_140013400->AttachedDevice,
            0x127u,
            (__int64)&unk_140012330,
            (*(_DWORD *)v14 >> 2) & 1);
        if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
          return;
        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
          sub_140001580(
            (__int64)off_140013400->AttachedDevice,
            0x128u,
            (__int64)&unk_140012330,
            (*(_DWORD *)v14 >> 3) & 0x1FFF);
        v10 = off_140013400;
        if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
          || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
          || BYTE1(off_140013400->Timer) < 4u )
        {
          return;
        }
        v4 = v14[1];
        v12 = 297;
        goto LABEL_538;
      }
      v6 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
        || BYTE1(off_140013400->Timer) < 4u )
      {
        return;
      }
      v8 = 298;
LABEL_203:
      v7 = *(_QWORD *)v14;
      goto LABEL_204;
    case 2:
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        sub_14000B808((__int64)off_140013400->AttachedDevice, 0x12Bu, (__int64)&unk_140012330, *(_QWORD *)(a1 + 160));
      }
      v13 = *(_QWORD *)(a1 + 160);
      if ( v13 )
      {
        if ( a3 )
        {
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x12Du,
              (__int64)&unk_140012330,
              *(_DWORD *)(a1 + 160) & 0x3FFFFFFF);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x12Eu,
              (__int64)&unk_140012330,
              ((unsigned int)v13 >> 30) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x12Fu,
              (__int64)&unk_140012330,
              (unsigned int)v13 >> 31);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580((__int64)off_140013400->AttachedDevice, 0x130u, (__int64)&unk_140012330, v13 & 0xFFFFF);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x131u,
              (__int64)&unk_140012330,
              ((unsigned int)v13 >> 20) & 0x3FF);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x132u,
              (__int64)&unk_140012330,
              ((unsigned int)v13 >> 30) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x133u,
              (__int64)&unk_140012330,
              (unsigned int)v13 >> 31);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580((__int64)off_140013400->AttachedDevice, 0x134u, (__int64)&unk_140012330, v13 & 0x3FFFFFFF);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x135u,
              (__int64)&unk_140012330,
              ((unsigned int)v13 >> 30) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x136u,
              (__int64)&unk_140012330,
              (unsigned int)v13 >> 31);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580((__int64)off_140013400->AttachedDevice, 0x137u, (__int64)&unk_140012330, v13 & 0xFFFFF);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x138u,
              (__int64)&unk_140012330,
              ((unsigned int)v13 >> 20) & 0x3FF);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x139u,
              (__int64)&unk_140012330,
              ((unsigned int)v13 >> 30) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x13Au,
              (__int64)&unk_140012330,
              (unsigned int)v13 >> 31);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580((__int64)off_140013400->AttachedDevice, 0x13Bu, (__int64)&unk_140012330, v13 & 0x3FFFFFFF);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x13Cu,
              (__int64)&unk_140012330,
              ((unsigned int)v13 >> 30) & 1);
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001580(
              (__int64)off_140013400->AttachedDevice,
              0x13Du,
              (__int64)&unk_140012330,
              (unsigned int)v13 >> 31);
        }
        else
        {
          if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
            return;
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_140001558((__int64)off_140013400->AttachedDevice, 0x12Cu, (__int64)&unk_140012330);
        }
      }
      v10 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
        || BYTE1(off_140013400->Timer) < 4u )
      {
        return;
      }
      v4 = *(unsigned __int8 *)(a1 + 160);
      v12 = 318;
      goto LABEL_538;
  }
  if ( a2 != 3 )
  {
    if ( a2 != 4 )
    {
      if ( a2 == 5 )
      {
        v6 = off_140013400;
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          v7 = *(_QWORD *)(a1 + 184);
          v8 = 330;
LABEL_204:
          sub_14000B808((__int64)v6->AttachedDevice, v8, (__int64)&unk_140012330, v7);
          return;
        }
        return;
      }
      goto LABEL_455;
    }
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x140u, (__int64)&unk_140012330, *(_QWORD *)(a1 + 176));
    }
    v9 = *(_QWORD *)(a1 + 176);
    if ( !v9 || off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return;
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001580((__int64)off_140013400->AttachedDevice, 0x141u, (__int64)&unk_140012330, *(_DWORD *)(a1 + 176) & 7);
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return;
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001580(
        (__int64)off_140013400->AttachedDevice,
        0x142u,
        (__int64)&unk_140012330,
        ((unsigned int)v9 >> 3) & 1);
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return;
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001580((__int64)off_140013400->AttachedDevice, 0x143u, (__int64)&unk_140012330, (unsigned __int16)v9 >> 4);
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return;
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001580((__int64)off_140013400->AttachedDevice, 0x144u, (__int64)&unk_140012330, WORD1(v9));
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return;
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001580((__int64)off_140013400->AttachedDevice, 0x145u, (__int64)&unk_140012330, v9 & 7);
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return;
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001580(
        (__int64)off_140013400->AttachedDevice,
        0x146u,
        (__int64)&unk_140012330,
        ((unsigned int)v9 >> 3) & 1);
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return;
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001580((__int64)off_140013400->AttachedDevice, 0x147u, (__int64)&unk_140012330, (unsigned __int16)v9 >> 4);
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return;
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu) && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001580((__int64)off_140013400->AttachedDevice, 0x148u, (__int64)&unk_140012330, WORD1(v9) & 0xF);
    v10 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
      || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
      || BYTE1(off_140013400->Timer) < 4u )
    {
      return;
    }
    v11 = (unsigned int)v9 >> 20;
    v12 = 329;
LABEL_56:
    v4 = v11;
    goto LABEL_538;
  }
  v6 = off_140013400;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xDu)
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    v7 = *(_QWORD *)(a1 + 168);
    v8 = 319;
    goto LABEL_204;
  }
}
// 14000896F: conditional instruction was optimized away because of 'edx.4==B'
// 140008D79: conditional instruction was optimized away because of 'edx.4==12'

//----- (00000001400097CC) ----------------------------------------------------
void __fastcall sub_1400097CC(PNET_BUFFER_LIST NetBufferList)
{
  PNET_BUFFER_LIST v1; // rdi
  _NET_BUFFER_LIST *v2; // rbx

  v1 = NetBufferList;
  if ( NetBufferList )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x800000) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x197u, (__int64)&unk_140012330, NetBufferList);
    }
    do
    {
      v2 = (_NET_BUFFER_LIST *)v1->Link.Alignment;
      sub_140006EBC(v1);
      v1 = v2;
    }
    while ( v2 );
  }
  else if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
         && (HIDWORD(off_140013400->Timer) & 0x800000) != 0
         && BYTE1(off_140013400->Timer) >= 2u )
  {
    sub_14000B808((__int64)off_140013400->AttachedDevice, 0x196u, (__int64)&unk_140012330, 0i64);
  }
}

//----- (0000000140009874) ----------------------------------------------------
_NET_BUFFER_LIST *__fastcall sub_140009874(__int64 a1, _NET_BUFFER_LIST *a2, int a3)
{
  _NET_BUFFER_LIST *v3; // rbx
  _QWORD *v4; // r15
  _NET_BUFFER_LIST *v6; // rdi
  int v8; // ecx
  SLIST_HEADER *v9; // rax
  __int64 v10; // rax
  int v11; // ecx
  SLIST_HEADER *v12; // rax
  __int64 v14; // [rsp+20h] [rbp-28h]

  v3 = 0i64;
  v4 = 0i64;
  v6 = a2;
  if ( a2 && a1 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x800000) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      v8 = 0;
      v9 = (SLIST_HEADER *)a2;
      do
      {
        v9 = (SLIST_HEADER *)v9->Alignment;
        ++v8;
      }
      while ( v9 );
      sub_14000BAA8((__int64)off_140013400->AttachedDevice, 0x193u, (__int64)&unk_140012330, a2, v8);
    }
    while ( 1 )
    {
      v10 = sub_140007040(a1, v6, a3);
      if ( !v10 )
        break;
      if ( v3 )
        *v4 = v10;
      else
        v3 = (_NET_BUFFER_LIST *)v10;
      v6 = (_NET_BUFFER_LIST *)v6->Link.Alignment;
      v4 = (_QWORD *)v10;
      if ( !v6 )
      {
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 0x800000) != 0
          && BYTE1(off_140013400->Timer) >= 5u )
        {
          v11 = 0;
          v12 = (SLIST_HEADER *)v3;
          do
          {
            v12 = (SLIST_HEADER *)v12->Alignment;
            ++v11;
          }
          while ( v12 );
          LODWORD(v14) = v11;
          sub_14000BAA8((__int64)off_140013400->AttachedDevice, 0x195u, (__int64)&unk_140012330, v3, v14);
        }
        return v3;
      }
    }
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x800000) != 0
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x194u, (__int64)&unk_140012330);
    }
    sub_1400097CC(v3);
    v3 = 0i64;
  }
  else if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
         && (HIDWORD(off_140013400->Timer) & 0x800000) != 0
         && BYTE1(off_140013400->Timer) >= 2u )
  {
    sub_14000BA60((__int64)off_140013400->AttachedDevice, 0x192u, (__int64)&unk_140012330, a2, a1);
  }
  return v3;
}
// 140009958: conditional instruction was optimized away because of 'rbx.8!=0'
// 140009985: variable 'v14' is possibly undefined

//----- (0000000140009A24) ----------------------------------------------------
void __fastcall sub_140009A24(__int64 a1, int a2, const char *a3)
{
  __int64 *v6; // rax
  const char *v7; // r9

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
      sub_14000C1D8((__int64)off_140013400->AttachedDevice, 0xF0u, (__int64)&unk_140012330, a3);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
      {
        v6 = (__int64 *)"ERROR";
        v7 = "SEND";
        if ( !*(_DWORD *)(a1 + 140) )
          v6 = qword_140011020;
        if ( !a2 )
          v7 = "RECEIVE";
        sub_14000C30C((__int64)off_140013400->AttachedDevice, 0xF1u, (__int64)&unk_140012330, v7, (__int64)v6);
      }
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
      {
        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
          sub_14000BDF0(
            (__int64)off_140013400->AttachedDevice,
            0xF2u,
            (__int64)&unk_140012330,
            *(_QWORD *)(a1 + 16),
            *(_QWORD *)(a1 + 24),
            *(_DWORD *)(a1 + 132));
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
        {
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
            sub_14000BE48(
              (__int64)off_140013400->AttachedDevice,
              0xF3u,
              (__int64)&unk_140012330,
              *(_QWORD *)(a1 + 32),
              *(_QWORD *)(a1 + 112),
              *(_QWORD *)(a1 + 120));
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
          {
            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu) && BYTE1(off_140013400->Timer) >= 4u )
              sub_14000BA60(
                (__int64)off_140013400->AttachedDevice,
                0xF4u,
                (__int64)&unk_140012330,
                *(_QWORD *)(a1 + 48),
                *(_QWORD *)(a1 + 56));
            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
            {
              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
                && BYTE1(off_140013400->Timer) >= 4u )
              {
                sub_14000BE9C(
                  (__int64)off_140013400->AttachedDevice,
                  0xF5u,
                  (__int64)&unk_140012330,
                  *(_QWORD *)(a1 + 64),
                  *(_QWORD *)(a1 + 72),
                  *(_QWORD *)(a1 + 80),
                  *(_QWORD *)(a1 + 88));
              }
              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
                && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
                && BYTE1(off_140013400->Timer) >= 4u )
              {
                sub_14000BA60(
                  (__int64)off_140013400->AttachedDevice,
                  0xF6u,
                  (__int64)&unk_140012330,
                  *(_QWORD *)(a1 + 96),
                  *(_QWORD *)(a1 + 104));
              }
            }
          }
        }
      }
    }
  }
  sub_1400076B8(a1);
  sub_140007AB8(a1, 0, a2);
  sub_140007AB8(a1, 7, a2);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xCu)
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    sub_14000C1D8((__int64)off_140013400->AttachedDevice, 0xF7u, (__int64)&unk_140012330, a3);
  }
}
// 140011020: using guessed type __int64 qword_140011020[2];

//----- (0000000140009CA8) ----------------------------------------------------
__int64 __fastcall sub_140009CA8(unsigned __int8 *a1)
{
  __int64 result; // rax

  if ( a1 && off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
      result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x1B4u, (__int64)&unk_140012330);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
        result = sub_14000B8D0((__int64)off_140013400->AttachedDevice, 0x1B5u, (__int64)&unk_140012330, *a1);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
      {
        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
          result = sub_140001580(
                     (__int64)off_140013400->AttachedDevice,
                     0x1B6u,
                     (__int64)&unk_140012330,
                     *((_DWORD *)a1 + 27));
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
        {
          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
            result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x1B7u, (__int64)&unk_140012330);
          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
          {
            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
              result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x1B8u, (__int64)&unk_140012330);
            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
            {
              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                && BYTE1(off_140013400->Timer) >= 4u )
              {
                result = sub_140001580(
                           (__int64)off_140013400->AttachedDevice,
                           0x1B9u,
                           (__int64)&unk_140012330,
                           *((_DWORD *)a1 + 1));
              }
              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
              {
                if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                  && BYTE1(off_140013400->Timer) >= 4u )
                {
                  result = sub_140001580(
                             (__int64)off_140013400->AttachedDevice,
                             0x1BAu,
                             (__int64)&unk_140012330,
                             (*((_DWORD *)a1 + 2) >> 8) & 3);
                }
                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                {
                  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                    && BYTE1(off_140013400->Timer) >= 4u )
                  {
                    result = sub_140001580(
                               (__int64)off_140013400->AttachedDevice,
                               0x1BBu,
                               (__int64)&unk_140012330,
                               (*((_DWORD *)a1 + 2) >> 4) & 3);
                  }
                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                  {
                    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                      && BYTE1(off_140013400->Timer) >= 4u )
                    {
                      result = sub_140001580(
                                 (__int64)off_140013400->AttachedDevice,
                                 0x1BCu,
                                 (__int64)&unk_140012330,
                                 (*((_DWORD *)a1 + 2) >> 6) & 3);
                    }
                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                    {
                      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                        && BYTE1(off_140013400->Timer) >= 4u )
                      {
                        result = sub_140001580(
                                   (__int64)off_140013400->AttachedDevice,
                                   0x1BDu,
                                   (__int64)&unk_140012330,
                                   *((_DWORD *)a1 + 2) & 3);
                      }
                      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                      {
                        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                          && BYTE1(off_140013400->Timer) >= 4u )
                        {
                          result = sub_140001580(
                                     (__int64)off_140013400->AttachedDevice,
                                     0x1BEu,
                                     (__int64)&unk_140012330,
                                     (*((_DWORD *)a1 + 2) >> 2) & 3);
                        }
                        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                        {
                          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                            && BYTE1(off_140013400->Timer) >= 4u )
                          {
                            result = sub_140001580(
                                       (__int64)off_140013400->AttachedDevice,
                                       0x1BFu,
                                       (__int64)&unk_140012330,
                                       *((_DWORD *)a1 + 3));
                          }
                          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                          {
                            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                              && BYTE1(off_140013400->Timer) >= 4u )
                            {
                              result = sub_140001580(
                                         (__int64)off_140013400->AttachedDevice,
                                         0x1C0u,
                                         (__int64)&unk_140012330,
                                         (*((_DWORD *)a1 + 4) >> 8) & 3);
                            }
                            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                            {
                              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                                && BYTE1(off_140013400->Timer) >= 4u )
                              {
                                result = sub_140001580(
                                           (__int64)off_140013400->AttachedDevice,
                                           0x1C1u,
                                           (__int64)&unk_140012330,
                                           (*((_DWORD *)a1 + 4) >> 4) & 3);
                              }
                              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                              {
                                if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                                  && BYTE1(off_140013400->Timer) >= 4u )
                                {
                                  result = sub_140001580(
                                             (__int64)off_140013400->AttachedDevice,
                                             0x1C2u,
                                             (__int64)&unk_140012330,
                                             (*((_DWORD *)a1 + 4) >> 6) & 3);
                                }
                                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                {
                                  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                                    && BYTE1(off_140013400->Timer) >= 4u )
                                  {
                                    result = sub_140001580(
                                               (__int64)off_140013400->AttachedDevice,
                                               0x1C3u,
                                               (__int64)&unk_140012330,
                                               *((_DWORD *)a1 + 4) & 3);
                                  }
                                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                  {
                                    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                                      && BYTE1(off_140013400->Timer) >= 4u )
                                    {
                                      result = sub_140001580(
                                                 (__int64)off_140013400->AttachedDevice,
                                                 0x1C4u,
                                                 (__int64)&unk_140012330,
                                                 (*((_DWORD *)a1 + 4) >> 2) & 3);
                                    }
                                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                    {
                                      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                                        && BYTE1(off_140013400->Timer) >= 4u )
                                      {
                                        result = sub_140001558(
                                                   (__int64)off_140013400->AttachedDevice,
                                                   0x1C5u,
                                                   (__int64)&unk_140012330);
                                      }
                                      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                      {
                                        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                                          && BYTE1(off_140013400->Timer) >= 4u )
                                        {
                                          result = sub_140001580(
                                                     (__int64)off_140013400->AttachedDevice,
                                                     0x1C6u,
                                                     (__int64)&unk_140012330,
                                                     *((_DWORD *)a1 + 5));
                                        }
                                        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                        {
                                          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                                            && BYTE1(off_140013400->Timer) >= 4u )
                                          {
                                            result = sub_140001580(
                                                       (__int64)off_140013400->AttachedDevice,
                                                       0x1C7u,
                                                       (__int64)&unk_140012330,
                                                       (*((_DWORD *)a1 + 6) >> 4) & 3);
                                          }
                                          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                          {
                                            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                                              && BYTE1(off_140013400->Timer) >= 4u )
                                            {
                                              result = sub_140001580(
                                                         (__int64)off_140013400->AttachedDevice,
                                                         0x1C8u,
                                                         (__int64)&unk_140012330,
                                                         (*((_DWORD *)a1 + 6) >> 6) & 3);
                                            }
                                            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                            {
                                              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                                                && BYTE1(off_140013400->Timer) >= 4u )
                                              {
                                                result = sub_140001580(
                                                           (__int64)off_140013400->AttachedDevice,
                                                           0x1C9u,
                                                           (__int64)&unk_140012330,
                                                           *((_DWORD *)a1 + 6) & 3);
                                              }
                                              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                              {
                                                if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au)
                                                  && BYTE1(off_140013400->Timer) >= 4u )
                                                {
                                                  result = sub_140001580(
                                                             (__int64)off_140013400->AttachedDevice,
                                                             0x1CAu,
                                                             (__int64)&unk_140012330,
                                                             (*((_DWORD *)a1 + 6) >> 2) & 3);
                                                }
                                                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                {
                                                  if ( _bittest(
                                                         (const signed __int32 *)&off_140013400->Timer + 1,
                                                         0x1Au)
                                                    && BYTE1(off_140013400->Timer) >= 4u )
                                                  {
                                                    result = sub_140001580(
                                                               (__int64)off_140013400->AttachedDevice,
                                                               0x1CBu,
                                                               (__int64)&unk_140012330,
                                                               *((_DWORD *)a1 + 7));
                                                  }
                                                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                  {
                                                    if ( _bittest(
                                                           (const signed __int32 *)&off_140013400->Timer + 1,
                                                           0x1Au)
                                                      && BYTE1(off_140013400->Timer) >= 4u )
                                                    {
                                                      result = sub_140001580(
                                                                 (__int64)off_140013400->AttachedDevice,
                                                                 0x1CCu,
                                                                 (__int64)&unk_140012330,
                                                                 (*((_DWORD *)a1 + 8) >> 4) & 3);
                                                    }
                                                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                    {
                                                      if ( _bittest(
                                                             (const signed __int32 *)&off_140013400->Timer + 1,
                                                             0x1Au)
                                                        && BYTE1(off_140013400->Timer) >= 4u )
                                                      {
                                                        result = sub_140001580(
                                                                   (__int64)off_140013400->AttachedDevice,
                                                                   0x1CDu,
                                                                   (__int64)&unk_140012330,
                                                                   (*((_DWORD *)a1 + 8) >> 6) & 3);
                                                      }
                                                      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                      {
                                                        if ( _bittest(
                                                               (const signed __int32 *)&off_140013400->Timer + 1,
                                                               0x1Au)
                                                          && BYTE1(off_140013400->Timer) >= 4u )
                                                        {
                                                          result = sub_140001580(
                                                                     (__int64)off_140013400->AttachedDevice,
                                                                     0x1CEu,
                                                                     (__int64)&unk_140012330,
                                                                     *((_DWORD *)a1 + 8) & 3);
                                                        }
                                                        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                        {
                                                          if ( _bittest(
                                                                 (const signed __int32 *)&off_140013400->Timer + 1,
                                                                 0x1Au)
                                                            && BYTE1(off_140013400->Timer) >= 4u )
                                                          {
                                                            result = sub_140001580(
                                                                       (__int64)off_140013400->AttachedDevice,
                                                                       0x1CFu,
                                                                       (__int64)&unk_140012330,
                                                                       (*((_DWORD *)a1 + 8) >> 2) & 3);
                                                          }
                                                          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                          {
                                                            if ( _bittest(
                                                                   (const signed __int32 *)&off_140013400->Timer + 1,
                                                                   0x1Au)
                                                              && BYTE1(off_140013400->Timer) >= 4u )
                                                            {
                                                              result = sub_140001558(
                                                                         (__int64)off_140013400->AttachedDevice,
                                                                         0x1D0u,
                                                                         (__int64)&unk_140012330);
                                                            }
                                                            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                            {
                                                              if ( _bittest(
                                                                     (const signed __int32 *)&off_140013400->Timer + 1,
                                                                     0x1Au)
                                                                && BYTE1(off_140013400->Timer) >= 4u )
                                                              {
                                                                result = sub_140001558(
                                                                           (__int64)off_140013400->AttachedDevice,
                                                                           0x1D1u,
                                                                           (__int64)&unk_140012330);
                                                              }
                                                              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                              {
                                                                if ( _bittest(
                                                                       (const signed __int32 *)&off_140013400->Timer + 1,
                                                                       0x1Au)
                                                                  && BYTE1(off_140013400->Timer) >= 4u )
                                                                {
                                                                  result = sub_140001580(
                                                                             (__int64)off_140013400->AttachedDevice,
                                                                             0x1D2u,
                                                                             (__int64)&unk_140012330,
                                                                             *((_DWORD *)a1 + 9));
                                                                }
                                                                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                {
                                                                  if ( _bittest(
                                                                         (const signed __int32 *)&off_140013400->Timer
                                                                       + 1,
                                                                         0x1Au)
                                                                    && BYTE1(off_140013400->Timer) >= 4u )
                                                                  {
                                                                    result = sub_140001580(
                                                                               (__int64)off_140013400->AttachedDevice,
                                                                               0x1D3u,
                                                                               (__int64)&unk_140012330,
                                                                               *((_DWORD *)a1 + 10));
                                                                  }
                                                                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                  {
                                                                    if ( _bittest(
                                                                           (const signed __int32 *)&off_140013400->Timer
                                                                         + 1,
                                                                           0x1Au)
                                                                      && BYTE1(off_140013400->Timer) >= 4u )
                                                                    {
                                                                      result = sub_140001580(
                                                                                 (__int64)off_140013400->AttachedDevice,
                                                                                 0x1D4u,
                                                                                 (__int64)&unk_140012330,
                                                                                 *((_DWORD *)a1 + 11));
                                                                    }
                                                                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                    {
                                                                      if ( _bittest(
                                                                             (const signed __int32 *)&off_140013400->Timer
                                                                           + 1,
                                                                             0x1Au)
                                                                        && BYTE1(off_140013400->Timer) >= 4u )
                                                                      {
                                                                        result = sub_140001580(
                                                                                   (__int64)off_140013400->AttachedDevice,
                                                                                   0x1D5u,
                                                                                   (__int64)&unk_140012330,
                                                                                   *((_DWORD *)a1 + 12) & 3);
                                                                      }
                                                                      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                      {
                                                                        if ( _bittest(
                                                                               (const signed __int32 *)&off_140013400->Timer
                                                                             + 1,
                                                                               0x1Au)
                                                                          && BYTE1(off_140013400->Timer) >= 4u )
                                                                        {
                                                                          result = sub_140001580(
                                                                                     (__int64)off_140013400->AttachedDevice,
                                                                                     0x1D6u,
                                                                                     (__int64)&unk_140012330,
                                                                                     (*((_DWORD *)a1 + 12) >> 2) & 3);
                                                                        }
                                                                        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                        {
                                                                          if ( _bittest(
                                                                                 (const signed __int32 *)&off_140013400->Timer
                                                                               + 1,
                                                                                 0x1Au)
                                                                            && BYTE1(off_140013400->Timer) >= 4u )
                                                                          {
                                                                            result = sub_140001558(
                                                                                       (__int64)off_140013400->AttachedDevice,
                                                                                       0x1D7u,
                                                                                       (__int64)&unk_140012330);
                                                                          }
                                                                          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                          {
                                                                            if ( _bittest(
                                                                                   (const signed __int32 *)&off_140013400->Timer
                                                                                 + 1,
                                                                                   0x1Au)
                                                                              && BYTE1(off_140013400->Timer) >= 4u )
                                                                            {
                                                                              result = sub_140001558(
                                                                                         (__int64)off_140013400->AttachedDevice,
                                                                                         0x1D8u,
                                                                                         (__int64)&unk_140012330);
                                                                            }
                                                                            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                            {
                                                                              if ( _bittest(
                                                                                     (const signed __int32 *)&off_140013400->Timer
                                                                                   + 1,
                                                                                     0x1Au)
                                                                                && BYTE1(off_140013400->Timer) >= 4u )
                                                                              {
                                                                                result = sub_140001580(
                                                                                           (__int64)off_140013400->AttachedDevice,
                                                                                           0x1D9u,
                                                                                           (__int64)&unk_140012330,
                                                                                           *((_DWORD *)a1 + 20));
                                                                              }
                                                                              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                              {
                                                                                if ( _bittest(
                                                                                       (const signed __int32 *)&off_140013400->Timer
                                                                                     + 1,
                                                                                       0x1Au)
                                                                                  && BYTE1(off_140013400->Timer) >= 4u )
                                                                                {
                                                                                  result = sub_140001580(
                                                                                             (__int64)off_140013400->AttachedDevice,
                                                                                             0x1DAu,
                                                                                             (__int64)&unk_140012330,
                                                                                             *((_DWORD *)a1 + 21));
                                                                                }
                                                                                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                {
                                                                                  if ( _bittest(
                                                                                         (const signed __int32 *)&off_140013400->Timer
                                                                                       + 1,
                                                                                         0x1Au)
                                                                                    && BYTE1(off_140013400->Timer) >= 4u )
                                                                                  {
                                                                                    result = sub_140001580(
                                                                                               (__int64)off_140013400->AttachedDevice,
                                                                                               0x1DBu,
                                                                                               (__int64)&unk_140012330,
                                                                                               *((_DWORD *)a1 + 22));
                                                                                  }
                                                                                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                  {
                                                                                    if ( _bittest(
                                                                                           (const signed __int32 *)&off_140013400->Timer
                                                                                         + 1,
                                                                                           0x1Au)
                                                                                      && BYTE1(off_140013400->Timer) >= 4u )
                                                                                    {
                                                                                      result = sub_140001558(
                                                                                                 (__int64)off_140013400->AttachedDevice,
                                                                                                 0x1DCu,
                                                                                                 (__int64)&unk_140012330);
                                                                                    }
                                                                                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                    {
                                                                                      if ( _bittest(
                                                                                             (const signed __int32 *)&off_140013400->Timer
                                                                                           + 1,
                                                                                             0x1Au)
                                                                                        && BYTE1(off_140013400->Timer) >= 4u )
                                                                                      {
                                                                                        result = sub_140001580(
                                                                                                   (__int64)off_140013400->AttachedDevice,
                                                                                                   0x1DDu,
                                                                                                   (__int64)&unk_140012330,
                                                                                                   *((_DWORD *)a1 + 23));
                                                                                      }
                                                                                      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                      {
                                                                                        if ( _bittest(
                                                                                               (const signed __int32 *)&off_140013400->Timer
                                                                                             + 1,
                                                                                               0x1Au)
                                                                                          && BYTE1(off_140013400->Timer) >= 4u )
                                                                                        {
                                                                                          result = sub_140001580(
                                                                                                     (__int64)off_140013400->AttachedDevice,
                                                                                                     0x1DEu,
                                                                                                     (__int64)&unk_140012330,
                                                                                                     *((_DWORD *)a1 + 24));
                                                                                        }
                                                                                        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                        {
                                                                                          if ( _bittest(
                                                                                                 (const signed __int32 *)&off_140013400->Timer
                                                                                               + 1,
                                                                                                 0x1Au)
                                                                                            && BYTE1(off_140013400->Timer) >= 4u )
                                                                                          {
                                                                                            result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1DFu, (__int64)&unk_140012330, *((_DWORD *)a1 + 25));
                                                                                          }
                                                                                          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                          {
                                                                                            if ( _bittest(
                                                                                                   (const signed __int32 *)&off_140013400->Timer
                                                                                                 + 1,
                                                                                                   0x1Au)
                                                                                              && BYTE1(off_140013400->Timer) >= 4u )
                                                                                            {
                                                                                              result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1E0u, (__int64)&unk_140012330, *((_DWORD *)a1 + 26) & 3);
                                                                                            }
                                                                                            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                            {
                                                                                              if ( _bittest(
                                                                                                     (const signed __int32 *)&off_140013400->Timer + 1,
                                                                                                     0x1Au)
                                                                                                && BYTE1(off_140013400->Timer) >= 4u )
                                                                                              {
                                                                                                result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1E1u, (__int64)&unk_140012330, (*((_DWORD *)a1 + 26) >> 2) & 3);
                                                                                              }
                                                                                              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                              {
                                                                                                if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                  result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x1E2u, (__int64)&unk_140012330);
                                                                                                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                {
                                                                                                  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                    result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x1E3u, (__int64)&unk_140012330);
                                                                                                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                  {
                                                                                                    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                      result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1E4u, (__int64)&unk_140012330, *((_DWORD *)a1 + 13));
                                                                                                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                    {
                                                                                                      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                        result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1E5u, (__int64)&unk_140012330, *((_DWORD *)a1 + 14));
                                                                                                      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                      {
                                                                                                        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                          result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1E6u, (__int64)&unk_140012330, *((_DWORD *)a1 + 15));
                                                                                                        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                        {
                                                                                                          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                            result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1E7u, (__int64)&unk_140012330, *((_DWORD *)a1 + 16));
                                                                                                          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                          {
                                                                                                            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                              result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1E8u, (__int64)&unk_140012330, *((_DWORD *)a1 + 17));
                                                                                                            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                            {
                                                                                                              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x1E9u, (__int64)&unk_140012330);
                                                                                                              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                              {
                                                                                                                if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                  result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1EAu, (__int64)&unk_140012330, *((_DWORD *)a1 + 18) & 3);
                                                                                                                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                {
                                                                                                                  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                    result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1EBu, (__int64)&unk_140012330, (*((_DWORD *)a1 + 18) >> 2) & 3);
                                                                                                                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                  {
                                                                                                                    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                      result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1ECu, (__int64)&unk_140012330, (*((_DWORD *)a1 + 18) >> 4) & 3);
                                                                                                                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                    {
                                                                                                                      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                        result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1EDu, (__int64)&unk_140012330, (*((_DWORD *)a1 + 18) >> 6) & 3);
                                                                                                                      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                      {
                                                                                                                        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                          result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1EEu, (__int64)&unk_140012330, (*((_DWORD *)a1 + 18) >> 8) & 3);
                                                                                                                        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                        {
                                                                                                                          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                            result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1EFu, (__int64)&unk_140012330, (*((_DWORD *)a1 + 18) >> 10) & 3);
                                                                                                                          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                          {
                                                                                                                            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                              result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x1F0u, (__int64)&unk_140012330);
                                                                                                                            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                            {
                                                                                                                              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1F1u, (__int64)&unk_140012330, *((_DWORD *)a1 + 19) & 3);
                                                                                                                              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                              {
                                                                                                                                if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                  result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1F2u, (__int64)&unk_140012330, (*((_DWORD *)a1 + 19) >> 2) & 3);
                                                                                                                                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                {
                                                                                                                                  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                    result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1F3u, (__int64)&unk_140012330, (*((_DWORD *)a1 + 19) >> 4) & 3);
                                                                                                                                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                  {
                                                                                                                                    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                      result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1F4u, (__int64)&unk_140012330, (*((_DWORD *)a1 + 19) >> 6) & 3);
                                                                                                                                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                    {
                                                                                                                                      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                        result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1F5u, (__int64)&unk_140012330, (*((_DWORD *)a1 + 19) >> 8) & 3);
                                                                                                                                      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                      {
                                                                                                                                        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                          result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1F6u, (__int64)&unk_140012330, (*((_DWORD *)a1 + 19) >> 10) & 3);
                                                                                                                                        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                        {
                                                                                                                                          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                            result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1F7u, (__int64)&unk_140012330, (*((_DWORD *)a1 + 19) >> 12) & 3);
                                                                                                                                          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                          {
                                                                                                                                            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                              result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1F8u, (__int64)&unk_140012330, (unsigned __int8)HIBYTE(*((_WORD *)a1 + 38)) >> 6);
                                                                                                                                            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                            {
                                                                                                                                              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x1F9u, (__int64)&unk_140012330);
                                                                                                                                              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                              {
                                                                                                                                                if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                  result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1FAu, (__int64)&unk_140012330, *((_DWORD *)a1 + 28));
                                                                                                                                                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                {
                                                                                                                                                  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                    result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1FBu, (__int64)&unk_140012330, a1[116]);
                                                                                                                                                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                  {
                                                                                                                                                    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                      result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1FCu, (__int64)&unk_140012330, a1[117]);
                                                                                                                                                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                    {
                                                                                                                                                      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                        result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1FDu, (__int64)&unk_140012330, a1[118]);
                                                                                                                                                      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                      {
                                                                                                                                                        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                          result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1FEu, (__int64)&unk_140012330, a1[119]);
                                                                                                                                                        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                        {
                                                                                                                                                          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                            result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x1FFu, (__int64)&unk_140012330, a1[120]);
                                                                                                                                                          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                          {
                                                                                                                                                            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                              result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x200u, (__int64)&unk_140012330, a1[121]);
                                                                                                                                                            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                            {
                                                                                                                                                              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x201u, (__int64)&unk_140012330, a1[122]);
                                                                                                                                                              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                              {
                                                                                                                                                                if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                  result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x202u, (__int64)&unk_140012330, a1[123]);
                                                                                                                                                                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                {
                                                                                                                                                                  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                    result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x203u, (__int64)&unk_140012330, a1[124]);
                                                                                                                                                                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                  {
                                                                                                                                                                    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                      result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x204u, (__int64)&unk_140012330, a1[125]);
                                                                                                                                                                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                    {
                                                                                                                                                                      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                        result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x205u, (__int64)&unk_140012330, a1[126]);
                                                                                                                                                                      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                      {
                                                                                                                                                                        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                          result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x206u, (__int64)&unk_140012330, *((_DWORD *)a1 + 32));
                                                                                                                                                                        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                        {
                                                                                                                                                                          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                            result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x207u, (__int64)&unk_140012330, *((_DWORD *)a1 + 33));
                                                                                                                                                                          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                          {
                                                                                                                                                                            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                              result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x208u, (__int64)&unk_140012330, *((_DWORD *)a1 + 34));
                                                                                                                                                                            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                            {
                                                                                                                                                                              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x209u, (__int64)&unk_140012330, *((_DWORD *)a1 + 35));
                                                                                                                                                                              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                              {
                                                                                                                                                                                if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                  result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x20Au, (__int64)&unk_140012330);
                                                                                                                                                                                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                                {
                                                                                                                                                                                  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                    result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x20Bu, (__int64)&unk_140012330);
                                                                                                                                                                                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                                  {
                                                                                                                                                                                    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                      result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x20Cu, (__int64)&unk_140012330, a1[144]);
                                                                                                                                                                                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                                    {
                                                                                                                                                                                      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                        result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x20Du, (__int64)&unk_140012330);
                                                                                                                                                                                      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                                      {
                                                                                                                                                                                        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                          result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x20Eu, (__int64)&unk_140012330, a1[145]);
                                                                                                                                                                                        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                                        {
                                                                                                                                                                                          if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                            result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x20Fu, (__int64)&unk_140012330);
                                                                                                                                                                                          if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                                          {
                                                                                                                                                                                            if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                              result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x210u, (__int64)&unk_140012330, *((_DWORD *)a1 + 37) & 0xF);
                                                                                                                                                                                            if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                                            {
                                                                                                                                                                                              if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                                result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x211u, (__int64)&unk_140012330, (*((_DWORD *)a1 + 37) >> 4) & 0xF);
                                                                                                                                                                                              if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                                              {
                                                                                                                                                                                                if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                                  result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x212u, (__int64)&unk_140012330, (*((_DWORD *)a1 + 37) >> 8) & 0xF);
                                                                                                                                                                                                if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                                                {
                                                                                                                                                                                                  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                                    result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x213u, (__int64)&unk_140012330, (unsigned __int8)HIBYTE(*((_WORD *)a1 + 74)) >> 4);
                                                                                                                                                                                                  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                                                  {
                                                                                                                                                                                                    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                                      result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x214u, (__int64)&unk_140012330, *((_WORD *)a1 + 75) & 0xF);
                                                                                                                                                                                                    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
                                                                                                                                                                                                    {
                                                                                                                                                                                                      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                                        result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x215u, (__int64)&unk_140012330, *((_DWORD *)a1 + 38));
                                                                                                                                                                                                      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x1Au) && BYTE1(off_140013400->Timer) >= 4u )
                                                                                                                                                                                                        result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x216u, (__int64)&unk_140012330);
                                                                                                                                                                                                    }
                                                                                                                                                                                                  }
                                                                                                                                                                                                }
                                                                                                                                                                                              }
                                                                                                                                                                                            }
                                                                                                                                                                                          }
                                                                                                                                                                                        }
                                                                                                                                                                                      }
                                                                                                                                                                                    }
                                                                                                                                                                                  }
                                                                                                                                                                                }
                                                                                                                                                                              }
                                                                                                                                                                            }
                                                                                                                                                                          }
                                                                                                                                                                        }
                                                                                                                                                                      }
                                                                                                                                                                    }
                                                                                                                                                                  }
                                                                                                                                                                }
                                                                                                                                                              }
                                                                                                                                                            }
                                                                                                                                                          }
                                                                                                                                                        }
                                                                                                                                                      }
                                                                                                                                                    }
                                                                                                                                                  }
                                                                                                                                                }
                                                                                                                                              }
                                                                                                                                            }
                                                                                                                                          }
                                                                                                                                        }
                                                                                                                                      }
                                                                                                                                    }
                                                                                                                                  }
                                                                                                                                }
                                                                                                                              }
                                                                                                                            }
                                                                                                                          }
                                                                                                                        }
                                                                                                                      }
                                                                                                                    }
                                                                                                                  }
                                                                                                                }
                                                                                                              }
                                                                                                            }
                                                                                                          }
                                                                                                        }
                                                                                                      }
                                                                                                    }
                                                                                                  }
                                                                                                }
                                                                                              }
                                                                                            }
                                                                                          }
                                                                                        }
                                                                                      }
                                                                                    }
                                                                                  }
                                                                                }
                                                                              }
                                                                            }
                                                                          }
                                                                        }
                                                                      }
                                                                    }
                                                                  }
                                                                }
                                                              }
                                                            }
                                                          }
                                                        }
                                                      }
                                                    }
                                                  }
                                                }
                                              }
                                            }
                                          }
                                        }
                                      }
                                    }
                                  }
                                }
                              }
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  return result;
}

//----- (000000014000B140) ----------------------------------------------------
const char *__fastcall sub_14000B140(int a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // ecx
  int v5; // ecx
  int v6; // ecx
  int v7; // ecx
  int v8; // ecx
  int v9; // ecx
  int v10; // ecx
  int v11; // ecx
  int v12; // ecx
  int v13; // ecx
  int v14; // ecx
  int v15; // ecx

  if ( a1 <= 10 )
  {
    if ( a1 == 10 )
      return "Irda";
    if ( a1 > 5 )
    {
      v5 = a1 - 6;
      if ( !v5 )
        return "ArcnetRaw";
      v6 = v5 - 1;
      if ( !v6 )
        return "Arcnet878_2";
      v7 = v6 - 1;
      if ( !v7 )
        return (const char *)qword_140011400;
      if ( v7 == 1 )
        return "WirelessWan";
    }
    else
    {
      if ( a1 == 5 )
        return (const char *)qword_1400113D0;
      if ( !a1 )
        return "802_3";
      v1 = a1 - 1;
      if ( !v1 )
        return "802_5";
      v2 = v1 - 1;
      if ( !v2 )
        return "Fddi";
      v3 = v2 - 1;
      if ( !v3 )
        return (const char *)qword_1400113B0;
      if ( v3 == 1 )
        return "LocalTalk";
    }
    return "Unknown";
  }
  v8 = a1 - 11;
  if ( !v8 )
    return (const char *)qword_140011430;
  v9 = v8 - 1;
  if ( !v9 )
    return "CoWan";
  v10 = v9 - 1;
  if ( !v10 )
    return "1394";
  v11 = v10 - 1;
  if ( !v11 )
    return "InfiniBand";
  v12 = v11 - 1;
  if ( !v12 )
    return "Tunnel";
  v13 = v12 - 1;
  if ( !v13 )
    return "Native802_11";
  v14 = v13 - 1;
  if ( !v14 )
    return "Loopback";
  v15 = v14 - 1;
  if ( !v15 )
    return "WiMAX";
  if ( v15 != 1 )
    return "Unknown";
  return (const char *)qword_1400114B0;
}
// 1400113B0: using guessed type __int64 qword_1400113B0[2];
// 1400113D0: using guessed type __int64 qword_1400113D0[2];
// 140011400: using guessed type __int64 qword_140011400[2];
// 140011430: using guessed type __int64 qword_140011430[2];
// 1400114B0: using guessed type __int64 qword_1400114B0[2];

//----- (000000014000B25C) ----------------------------------------------------
const char *__fastcall sub_14000B25C(int a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // ecx
  int v4; // ecx
  int v6; // ecx
  int v7; // ecx
  int v8; // ecx
  int v9; // ecx
  int v10; // ecx

  if ( a1 <= 6 )
  {
    if ( a1 == 6 )
      return "NdisRequestTransferData";
    if ( !a1 )
      return "NdisRequestQueryInformation";
    v1 = a1 - 1;
    if ( !v1 )
      return "NdisRequestSetInformation";
    v2 = v1 - 1;
    if ( !v2 )
      return "NdisRequestQueryStatistics";
    v3 = v2 - 1;
    if ( !v3 )
      return "NdisRequestOpen";
    v4 = v3 - 1;
    if ( !v4 )
      return "NdisRequestClose";
    if ( v4 == 1 )
      return "NdisRequestSend";
    return "UNKNOWN";
  }
  v6 = a1 - 7;
  if ( !v6 )
    return "NdisRequestReset";
  v7 = v6 - 1;
  if ( !v7 )
    return "NdisRequestGeneric1";
  v8 = v7 - 1;
  if ( !v8 )
    return "NdisRequestGeneric2";
  v9 = v8 - 1;
  if ( !v9 )
    return "NdisRequestGeneric3";
  v10 = v9 - 1;
  if ( !v10 )
    return "NdisRequestGeneric4";
  if ( v10 != 1 )
    return "UNKNOWN";
  return "NdisRequestMethod";
}

//----- (000000014000B310) ----------------------------------------------------
const char *__fastcall sub_14000B310(int a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // ecx
  int v5; // ecx
  int v6; // ecx
  int v7; // ecx
  int v8; // ecx
  int v9; // ecx
  int v10; // ecx
  int v11; // ecx
  int v12; // ecx
  int v13; // ecx
  int v14; // ecx
  int v15; // ecx

  if ( a1 <= 10 )
  {
    if ( a1 == 10 )
      return "Bluetooth";
    if ( a1 > 5 )
    {
      v5 = a1 - 6;
      if ( !v5 )
        return "FibreChannel";
      v6 = v5 - 1;
      if ( !v6 )
        return "1394";
      v7 = v6 - 1;
      if ( !v7 )
        return "WirelessWan";
      if ( v7 == 1 )
        return "Native802_11";
    }
    else
    {
      if ( a1 == 5 )
        return (const char *)qword_140011520;
      if ( !a1 )
        return "Unspecified";
      v1 = a1 - 1;
      if ( !v1 )
        return "WirelessLan";
      v2 = v1 - 1;
      if ( !v2 )
        return "CableModem";
      v3 = v2 - 1;
      if ( !v3 )
        return "PhoneLine";
      if ( v3 == 1 )
        return "PowerLine";
    }
    return "Unknown";
  }
  v8 = a1 - 11;
  if ( !v8 )
    return "Infiniband";
  v9 = v8 - 1;
  if ( !v9 )
    return "WiMax";
  v10 = v9 - 1;
  if ( !v10 )
    return (const char *)qword_140011570;
  v11 = v10 - 1;
  if ( !v11 )
    return "802_3";
  v12 = v11 - 1;
  if ( !v12 )
    return "802_5";
  v13 = v12 - 1;
  if ( !v13 )
    return "Irda";
  v14 = v13 - 1;
  if ( !v14 )
    return "WiredWAN";
  v15 = v14 - 1;
  if ( !v15 )
    return "WiredCoWan";
  if ( v15 != 1 )
    return "Unknown";
  return "Other";
}
// 140011520: using guessed type __int64 qword_140011520[2];
// 140011570: using guessed type __int64 qword_140011570[2];

//----- (000000014000B42C) ----------------------------------------------------
const char *__fastcall sub_14000B42C(int a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // ecx
  int v4; // ecx
  int v5; // ecx
  int v6; // ecx
  int v7; // ecx
  int v9; // ecx
  int v10; // ecx
  int v11; // ecx
  int v12; // ecx
  int v13; // ecx
  int v14; // ecx
  int v15; // ecx

  if ( a1 <= 9 )
  {
    if ( a1 == 9 )
      return "Restart";
    if ( !a1 )
      return "SetPower";
    v1 = a1 - 1;
    if ( !v1 )
      return "QueryPower";
    v2 = v1 - 1;
    if ( !v2 )
      return "QueryRemoveDevice";
    v3 = v2 - 1;
    if ( !v3 )
      return "CancelRemoveDevice";
    v4 = v3 - 1;
    if ( !v4 )
      return "Reconfigure";
    v5 = v4 - 1;
    if ( !v5 )
      return "BindList";
    v6 = v5 - 1;
    if ( !v6 )
      return "BindsComplete";
    v7 = v6 - 1;
    if ( !v7 )
      return "PnPCapabilities";
    if ( v7 == 1 )
      return "Pause";
    return "UNKNOWN";
  }
  v9 = a1 - 10;
  if ( !v9 )
    return "PortActivation";
  v10 = v9 - 1;
  if ( !v10 )
    return "PortDeactivation";
  v11 = v10 - 1;
  if ( !v11 )
    return "IMReEnableDevice";
  v12 = v11 - 1;
  if ( !v12 )
    return "NDKEnable";
  v13 = v12 - 1;
  if ( !v13 )
    return "NDKDisable";
  v14 = v13 - 1;
  if ( !v14 )
    return "FilterPreDetach";
  v15 = v14 - 1;
  if ( !v15 )
    return "BindFailed";
  if ( v15 != 1 )
    return "UNKNOWN";
  return "SwitchActivate";
}

//----- (000000014000B520) ----------------------------------------------------
__int64 __fastcall sub_14000B520(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+C8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140013488(a1, 43i64, a3, a2, &v5);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000B5AC) ----------------------------------------------------
__int64 __fastcall sub_14000B5AC(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, __int64 a5)
{
  __int64 v5; // rax
  int v7; // [rsp+88h] [rbp+20h] BYREF

  v7 = a4;
  if ( a5 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( *(_WORD *)(a5 + 2 * v5) );
  }
  return qword_140013488(a1, 43i64, a3, a2, &v7);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000B64C) ----------------------------------------------------
__int64 __fastcall sub_14000B64C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140013488(a1, 43i64, a3, a2, &v5);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000B6A4) ----------------------------------------------------
__int64 __fastcall sub_14000B6A4(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4)
{
  unsigned int v4; // er10
  __int64 v6; // rax
  __int64 v7; // rdx
  const wchar_t *v8; // rcx

  v4 = a2;
  if ( a4 )
  {
    v6 = -1i64;
    do
      ++v6;
    while ( a4[v6] );
    v7 = 2 * v6 + 2;
  }
  else
  {
    v7 = 10i64;
  }
  v8 = L"NULL";
  if ( a4 )
    v8 = a4;
  return ((__int64 (__fastcall *)(__int64, __int64, __int64, _QWORD, const wchar_t *, __int64, _QWORD))qword_140013488)(
           a1,
           43i64,
           a3,
           v4,
           v8,
           v7,
           0i64);
}
// 140010BD0: using guessed type wchar_t aNull[5];
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000B710) ----------------------------------------------------
__int64 __fastcall sub_14000B710(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4, char a5, __int64 a6)
{
  __int64 v6; // rax
  unsigned int v7; // edi
  __int64 v8; // r10
  const wchar_t *v9; // rdx

  v6 = -1i64;
  v7 = a2;
  if ( a6 )
  {
    v8 = -1i64;
    do
      ++v8;
    while ( *(_BYTE *)(a6 + v8) );
  }
  if ( a4 )
  {
    do
      ++v6;
    while ( a4[v6] );
  }
  v9 = L"NULL";
  if ( a4 )
    v9 = a4;
  return qword_140013488(a1, 43i64, a3, v7, v9);
}
// 140010BD0: using guessed type wchar_t aNull[5];
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000B808) ----------------------------------------------------
__int64 sub_14000B808(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+68h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000B844) ----------------------------------------------------
__int64 __fastcall sub_14000B844(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, const wchar_t *a5)
{
  unsigned int v5; // er10
  __int64 v7; // rax
  __int64 v8; // rdx
  const wchar_t *v9; // rcx
  int v11; // [rsp+78h] [rbp+20h] BYREF

  v11 = a4;
  v5 = a2;
  if ( a5 )
  {
    v7 = -1i64;
    do
      ++v7;
    while ( a5[v7] );
    v8 = 2 * v7 + 2;
  }
  else
  {
    v8 = 10i64;
  }
  v9 = L"NULL";
  if ( a5 )
    v9 = a5;
  return ((__int64 (__fastcall *)(__int64, __int64, __int64, _QWORD, int *, __int64, const wchar_t *, __int64, _QWORD))qword_140013488)(
           a1,
           43i64,
           a3,
           v5,
           &v11,
           4i64,
           v9,
           v8,
           0i64);
}
// 140010BD0: using guessed type wchar_t aNull[5];
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000B8D0) ----------------------------------------------------
__int64 __fastcall sub_14000B8D0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140013488(a1, 43i64, a3, a2, &v5);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000B924) ----------------------------------------------------
__int64 __fastcall sub_14000B924(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140013488(a1, 43i64, a3, a2, &v5);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000B988) ----------------------------------------------------
__int64 __fastcall sub_14000B988(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, char a5, __int64 a6)
{
  __int64 v6; // r9
  int v8; // [rsp+B8h] [rbp+20h] BYREF

  v8 = a4;
  if ( a6 )
  {
    v6 = -1i64;
    do
      ++v6;
    while ( *(_BYTE *)(a6 + v6) );
  }
  return qword_140013488(a1, 43i64, a3, a2, &v8);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000BA60) ----------------------------------------------------
__int64 sub_14000BA60(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000BAA8) ----------------------------------------------------
__int64 sub_14000BAA8(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000BAF4) ----------------------------------------------------
__int64 sub_14000BAF4(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v3; // rax
  __int64 v5; // [rsp+88h] [rbp+20h] BYREF
  va_list va; // [rsp+88h] [rbp+20h]
  __int64 v7; // [rsp+90h] [rbp+28h]
  va_list va1; // [rsp+98h] [rbp+30h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, _QWORD);
  if ( v7 )
  {
    v3 = -1i64;
    do
      ++v3;
    while ( *(_WORD *)(v7 + 2 * v3) );
  }
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000BB98) ----------------------------------------------------
__int64 sub_14000BB98(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000BBFC) ----------------------------------------------------
__int64 sub_14000BBFC(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v3; // rax
  __int64 v5; // [rsp+98h] [rbp+20h] BYREF
  va_list va; // [rsp+98h] [rbp+20h]
  __int64 v7; // [rsp+A0h] [rbp+28h]
  __int64 v8; // [rsp+A8h] [rbp+30h]
  va_list va1; // [rsp+B0h] [rbp+38h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, _QWORD);
  v8 = va_arg(va1, _QWORD);
  if ( v8 )
  {
    v3 = -1i64;
    do
      ++v3;
    while ( *(_WORD *)(v8 + 2 * v3) );
  }
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000BCB4) ----------------------------------------------------
__int64 sub_14000BCB4(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000BD0C) ----------------------------------------------------
__int64 sub_14000BD0C(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v3; // r9
  __int64 v4; // r10
  __int64 v6; // [rsp+98h] [rbp+20h] BYREF
  va_list va; // [rsp+98h] [rbp+20h]
  __int64 v8; // [rsp+A0h] [rbp+28h]
  __int64 v9; // [rsp+A8h] [rbp+30h]
  __int64 v10; // [rsp+B0h] [rbp+38h]
  va_list va1; // [rsp+B8h] [rbp+40h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v6 = va_arg(va1, _QWORD);
  v8 = va_arg(va1, _QWORD);
  v9 = va_arg(va1, _QWORD);
  v10 = va_arg(va1, _QWORD);
  v3 = -1i64;
  if ( v10 )
  {
    v4 = -1i64;
    do
      ++v4;
    while ( *(_BYTE *)(v10 + v4) );
  }
  if ( v9 )
  {
    do
      ++v3;
    while ( *(_BYTE *)(v9 + v3) );
  }
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000BDF0) ----------------------------------------------------
__int64 sub_14000BDF0(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000BE48) ----------------------------------------------------
__int64 sub_14000BE48(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000BE9C) ----------------------------------------------------
__int64 sub_14000BE9C(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000BEFC) ----------------------------------------------------
__int64 sub_14000BEFC(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v3; // r9
  __int64 v5; // [rsp+A8h] [rbp+20h] BYREF
  va_list va; // [rsp+A8h] [rbp+20h]
  __int64 v7; // [rsp+B0h] [rbp+28h]
  __int64 v8; // [rsp+B8h] [rbp+30h]
  va_list va1; // [rsp+C0h] [rbp+38h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, _QWORD);
  v8 = va_arg(va1, _QWORD);
  if ( v8 )
  {
    v3 = -1i64;
    do
      ++v3;
    while ( *(_BYTE *)(v8 + v3) );
  }
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000BFC8) ----------------------------------------------------
__int64 __fastcall sub_14000BFC8(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  __int64 v5; // r10
  const char *v6; // rcx

  if ( a4 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( a4[v5] );
  }
  v6 = "NULL";
  if ( a4 )
    v6 = a4;
  return qword_140013488(a1, 43i64, a3, a2, v6);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000C02C) ----------------------------------------------------
__int64 __fastcall sub_14000C02C(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  __int64 v5; // r10
  const char *v6; // rcx

  if ( a4 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( a4[v5] );
  }
  v6 = "NULL";
  if ( a4 )
    v6 = a4;
  return qword_140013488(a1, 43i64, a3, a2, v6);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000C0FC) ----------------------------------------------------
__int64 __fastcall sub_14000C0FC(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, char a5, __int64 a6)
{
  __int64 v6; // r10
  unsigned int v7; // ebx
  __int64 v9; // r9
  const char *v10; // rdx

  v6 = -1i64;
  v7 = a2;
  if ( a6 )
  {
    v9 = -1i64;
    do
      ++v9;
    while ( *(_BYTE *)(a6 + v9) );
  }
  if ( a4 )
  {
    do
      ++v6;
    while ( a4[v6] );
  }
  v10 = "NULL";
  if ( a4 )
    v10 = a4;
  return qword_140013488(a1, 43i64, a3, v7, v10);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000C1D8) ----------------------------------------------------
__int64 __fastcall sub_14000C1D8(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  __int64 v5; // r10
  const char *v6; // rcx

  if ( a4 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( a4[v5] );
  }
  v6 = "NULL";
  if ( a4 )
    v6 = a4;
  return qword_140013488(a1, 43i64, a3, a2, v6);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000C250) ----------------------------------------------------
__int64 __fastcall sub_14000C250(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  __int64 v5; // r10
  const char *v6; // rcx

  if ( a4 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( a4[v5] );
  }
  v6 = "NULL";
  if ( a4 )
    v6 = a4;
  return qword_140013488(a1, 43i64, a3, a2, v6);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000C30C) ----------------------------------------------------
__int64 __fastcall sub_14000C30C(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, __int64 a5)
{
  __int64 v5; // r10
  unsigned int v6; // ebx
  __int64 v8; // r9
  const char *v9; // rdx

  v5 = -1i64;
  v6 = a2;
  if ( a5 )
  {
    v8 = -1i64;
    do
      ++v8;
    while ( *(_BYTE *)(a5 + v8) );
  }
  if ( a4 )
  {
    do
      ++v5;
    while ( a4[v5] );
  }
  v9 = "NULL";
  if ( a4 )
    v9 = a4;
  return qword_140013488(a1, 43i64, a3, v6, v9);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000C3CC) ----------------------------------------------------
__int64 __fastcall sub_14000C3CC(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, __int64 a5)
{
  __int64 v5; // r10
  unsigned int v6; // ebx
  __int64 v8; // r9
  const char *v9; // rdx

  v5 = -1i64;
  v6 = a2;
  if ( a5 )
  {
    v8 = -1i64;
    do
      ++v8;
    while ( *(_BYTE *)(a5 + v8) );
  }
  if ( a4 )
  {
    do
      ++v5;
    while ( a4[v5] );
  }
  v9 = "NULL";
  if ( a4 )
    v9 = a4;
  return qword_140013488(a1, 43i64, a3, v6, v9);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000C490) ----------------------------------------------------
void __fastcall sub_14000C490(__int64 a1, unsigned __int8 a2, __int64 *a3, __int64 a4)
{
  __int64 v4; // rax

  if ( a2 <= 1u )
  {
    v4 = 0i64;
    if ( a2 )
    {
      *(_DWORD *)(a4 + 44) = *((_DWORD *)a3 + 1);
      *(_BYTE *)(a4 + 41) = *((_BYTE *)a3 + 2);
      v4 = *a3;
    }
    else
    {
      *(_BYTE *)(a4 + 41) = 0;
      *(_DWORD *)(a4 + 44) = 0;
    }
    *(_QWORD *)(a4 + 24) = v4;
  }
}

//----- (000000014000C4C0) ----------------------------------------------------
__int64 __fastcall sub_14000C4C0(__int64 a1, NDIS_REQUEST_TYPE a2, NDIS_OID a3, void *a4, UINT a5, UINT a6, unsigned int a7, UINT *a8)
{
  void *v12; // rcx
  unsigned int v13; // edi
  UINT v14; // eax
  UINT v16; // eax
  struct _NDIS_OID_REQUEST OidRequest; // [rsp+28h] [rbp-E0h] BYREF
  struct _NDIS_EVENT Event; // [rsp+118h] [rbp+10h] BYREF
  unsigned int v19; // [rsp+130h] [rbp+28h]

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xCDu, (__int64)&unk_140012330);
  }
  memset(&OidRequest, 0, sizeof(OidRequest));
  NdisInitializeEvent(&Event);
  OidRequest.Header = (NDIS_OBJECT_HEADER)15729046;
  OidRequest.RequestType = a2;
  if ( a2 && a2 != NdisRequestSetInformation )
  {
    if ( a2 != NdisRequestMethod )
      goto LABEL_10;
    *(_QWORD *)&OidRequest.DATA.METHOD_INFORMATION.OutputBufferLength = __PAIR64__(a7, a6);
  }
  OidRequest.DATA.QUERY_INFORMATION.InformationBufferLength = a5;
  OidRequest.DATA.QUERY_INFORMATION.InformationBuffer = a4;
  OidRequest.DATA.QUERY_INFORMATION.Oid = a3;
LABEL_10:
  v12 = *(void **)(a1 + 16);
  OidRequest.RequestId = (PVOID)1381256262;
  v13 = NdisFOidRequest(v12, &OidRequest);
  if ( v13 == 259 )
  {
    NdisWaitEvent(&Event, 0);
    v13 = v19;
  }
  if ( !v13 )
  {
    if ( a2 == NdisRequestSetInformation || (v14 = *a8, a2 == NdisRequestQueryInformation) )
    {
      v14 = OidRequest.DATA.QUERY_INFORMATION.BytesWritten;
      *a8 = OidRequest.DATA.QUERY_INFORMATION.BytesWritten;
      goto LABEL_16;
    }
    if ( a2 != NdisRequestMethod )
    {
LABEL_16:
      if ( v14 > a5 )
        *a8 = a5;
      goto LABEL_18;
    }
    v16 = OidRequest.DATA.METHOD_INFORMATION.BytesWritten;
    *a8 = OidRequest.DATA.METHOD_INFORMATION.BytesWritten;
    if ( v16 > a6 )
      *a8 = a6;
  }
LABEL_18:
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001580((__int64)off_140013400->AttachedDevice, 0xCEu, (__int64)&unk_140012330, v13);
  }
  return v13;
}

//----- (000000014000C668) ----------------------------------------------------
PVOID *__fastcall sub_14000C668(int a1)
{
  KIRQL v2; // al
  PVOID *v3; // rbx

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xD1u, (__int64)&unk_140012330);
  }
  v2 = KeAcquireSpinLockRaiseToDpc((PKSPIN_LOCK)&stru_1400146A0.Queue);
  v3 = (PVOID *)stru_1400146A0.DeviceExtension;
  LOBYTE(stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink) = v2;
  while ( v3 != &stru_1400146A0.DeviceExtension )
  {
    if ( a1 == *((_DWORD *)v3 + 62) )
    {
      KeReleaseSpinLock((PKSPIN_LOCK)&stru_1400146A0.Queue, (KIRQL)stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink);
      return v3;
    }
    v3 = (PVOID *)*v3;
  }
  KeReleaseSpinLock((PKSPIN_LOCK)&stru_1400146A0.Queue, (KIRQL)stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xD2u, (__int64)&unk_140012330);
  }
  return 0i64;
}

//----- (000000014000C74C) ----------------------------------------------------
void __fastcall sub_14000C74C(__int64 a1, struct _NDIS_EVENT *a2, LONG a3)
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xCFu, (__int64)&unk_140012330);
  }
  a2[11].Event.Header.LockNV = a3;
  NdisSetEvent(a2 + 10);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 1) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xD0u, (__int64)&unk_140012330);
  }
}

//----- (000000014000C7E8) ----------------------------------------------------
__int64 __fastcall sub_14000C7E8(unsigned __int8 *a1)
{
  unsigned int v2; // esi
  KIRQL v3; // al
  PVOID *v4; // rcx

  v2 = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 2) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x11u, (__int64)&unk_140012340);
  }
  v3 = KeAcquireSpinLockRaiseToDpc((PKSPIN_LOCK)&stru_1400146A0.Queue);
  v4 = (PVOID *)stru_1400146A0.DeviceExtension;
  LOBYTE(stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink) = v3;
  while ( v4 != &stru_1400146A0.DeviceExtension )
  {
    if ( *((_DWORD *)v4 + 97) == *(_DWORD *)a1 && *((_WORD *)v4 + 196) == *((_WORD *)a1 + 2) )
    {
      v2 = *((_DWORD *)v4 + 62);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 2) != 0
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        sub_14000B520((__int64)off_140013400->AttachedDevice, 0x12u, (__int64)&unk_140012340, *a1);
      }
      break;
    }
    v4 = (PVOID *)*v4;
  }
  KeReleaseSpinLock((PKSPIN_LOCK)&stru_1400146A0.Queue, (KIRQL)stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 2) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x13u, (__int64)&unk_140012340);
  }
  return v2;
}

//----- (000000014000C940) ----------------------------------------------------
__int64 __fastcall sub_14000C940(unsigned __int8 *a1)
{
  unsigned int v2; // esi
  KIRQL v3; // al
  PVOID *v4; // rcx

  v2 = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 2) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x14u, (__int64)&unk_140012340);
  }
  v3 = KeAcquireSpinLockRaiseToDpc((PKSPIN_LOCK)&stru_1400146A0.Queue);
  v4 = (PVOID *)stru_1400146A0.DeviceExtension;
  LOBYTE(stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink) = v3;
  while ( v4 != &stru_1400146A0.DeviceExtension )
  {
    if ( *((_DWORD *)v4 + 97) == *(_DWORD *)a1 && *((_WORD *)v4 + 196) == *((_WORD *)a1 + 2) )
    {
      v2 = *((_DWORD *)v4 + 154);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 2) != 0
        && BYTE1(off_140013400->Timer) >= 4u )
      {
        sub_14000B520((__int64)off_140013400->AttachedDevice, 0x15u, (__int64)&unk_140012340, *a1);
      }
      break;
    }
    v4 = (PVOID *)*v4;
  }
  KeReleaseSpinLock((PKSPIN_LOCK)&stru_1400146A0.Queue, (KIRQL)stru_1400146A0.Queue.Wcb.DmaWaitEntry.Blink);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 2) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x16u, (__int64)&unk_140012340);
  }
  return v2;
}

//----- (000000014000CA98) ----------------------------------------------------
__int64 sub_14000CA98()
{
  int v1; // eax
  int v2; // eax
  int v3; // eax
  int v4; // eax
  int v5; // eax
  int v6; // eax
  int v7; // eax
  int v8; // eax
  int v9; // eax
  int v10; // eax
  void *v11[2]; // [rsp+50h] [rbp-10h] BYREF
  __int64 v12; // [rsp+90h] [rbp+30h] BYREF
  unsigned int v13; // [rsp+98h] [rbp+38h] BYREF
  int v14; // [rsp+A0h] [rbp+40h] BYREF
  HANDLE KeyHandle; // [rsp+A8h] [rbp+48h] BYREF

  v11[0] = 0i64;
  v13 = 0;
  KeyHandle = 0i64;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xAu, (__int64)&unk_140012350);
  }
  if ( !(unsigned int)sub_14000E704(
                        L"\\REGISTRY\\MACHINE\\SYSTEM\\CurrentControlSet\\Services\\NNSNAHSL\\Parameters\\Internal",
                        &KeyHandle) )
  {
    LODWORD(v12) = 1;
    v1 = sub_14000E8E8(KeyHandle, L"ExcMDI", v11, &v13, (__int64)&v12);
    sub_14000D0D8(
      v1,
      KeyHandle,
      v11[0],
      v13,
      v12,
      L"ms_bridge|compositebus\\ms_implat_mp|ms_implat_def_mp",
      0x6Au,
      &unk_1400135A0,
      0x7E2u,
      L"ExcMDI");
    LODWORD(v12) = 1;
    v2 = sub_14000E8E8(KeyHandle, L"ExcUB", v11, &v13, (__int64)&v12);
    sub_14000D0D8(v2, KeyHandle, v11[0], v13, v12, L"VMSP", 0x6Au, &unk_140013D84, 0x7E2u, L"ExcUB");
    v14 = 0;
    LODWORD(v12) = 4;
    v3 = sub_14000E8E8(KeyHandle, L"ApplySFD", v11, &v13, (__int64)&v12);
    sub_14000D0D8(v3, KeyHandle, v11[0], v13, v12, &v14, 4u, &dword_140013580, 4u, L"ApplySFD");
    v14 = 0;
    LODWORD(v12) = 4;
    v4 = sub_14000E8E8(KeyHandle, L"PassThruMode", v11, &v13, (__int64)&v12);
    sub_14000D0D8(v4, KeyHandle, v11[0], v13, v12, &v14, 4u, &dword_140013584, 4u, L"PassThruMode");
    LODWORD(v12) = 4;
    v14 = 1;
    v5 = sub_14000E8E8(KeyHandle, L"NBLMgmtMode", v11, &v13, (__int64)&v12);
    sub_14000D0D8(v5, KeyHandle, v11[0], v13, v12, &v14, 4u, &dword_140013588, 4u, L"NBLMgmtMode");
    LODWORD(v12) = 4;
    v14 = 3;
    v6 = sub_14000E8E8(KeyHandle, L"NBLMgmtDeepCopyMode", v11, &v13, (__int64)&v12);
    sub_14000D0D8(v6, KeyHandle, v11[0], v13, v12, &v14, 4u, &dword_14001358C, 4u, L"NBLMgmtDeepCopyMode");
    v14 = 0;
    LODWORD(v12) = 4;
    v7 = sub_14000E8E8(KeyHandle, L"NBLMgmtResFlagPthru", v11, &v13, (__int64)&v12);
    sub_14000D0D8(v7, KeyHandle, v11[0], v13, v12, &v14, 4u, &dword_140013590, 4u, L"NBLMgmtResFlagPthru");
    v14 = 0;
    LODWORD(v12) = 4;
    v8 = sub_14000E8E8(KeyHandle, L"NBLRefsCheck", v11, &v13, (__int64)&v12);
    sub_14000D0D8(v8, KeyHandle, v11[0], v13, v12, &v14, 4u, &unk_140013594, 4u, L"NBLRefsCheck");
    v14 = 0;
    LODWORD(v12) = 4;
    v9 = sub_14000E8E8(KeyHandle, L"NBLNBZeroLenOffSet", v11, &v13, (__int64)&v12);
    sub_14000D0D8(v9, KeyHandle, v11[0], v13, v12, &v14, 4u, &dword_140013598, 4u, L"NBLNBZeroLenOffSet");
    v14 = 0;
    LODWORD(v12) = 4;
    v10 = sub_14000E8E8(KeyHandle, L"AdaptOfflTcpLSendDis", v11, &v13, (__int64)&v12);
    sub_14000D0D8(v10, KeyHandle, v11[0], v13, v12, &v14, 4u, &dword_14001359C, 4u, L"AdaptOfflTcpLSendDis");
    if ( (unsigned int)sub_14000E5D8(KeyHandle) )
    {
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
        return 0i64;
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu) && BYTE1(off_140013400->Timer) >= 2u )
        sub_140001558((__int64)off_140013400->AttachedDevice, 0xCu, (__int64)&unk_140012350);
    }
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu)
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0xDu, (__int64)&unk_140012350);
    }
    return 0i64;
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu)
    && BYTE1(off_140013400->Timer) >= 2u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xBu, (__int64)&unk_140012350);
  }
  return 3221291015i64;
}
// 1400116E0: using guessed type wchar_t aMsBridgeCompos[53];
// 140011760: using guessed type wchar_t aVmsp[5];
// 140013580: using guessed type int dword_140013580;
// 140013584: using guessed type int dword_140013584;
// 140013588: using guessed type int dword_140013588;
// 14001358C: using guessed type int dword_14001358C;
// 140013590: using guessed type int dword_140013590;
// 140013598: using guessed type int dword_140013598;
// 14001359C: using guessed type int dword_14001359C;

//----- (000000014000CFD0) ----------------------------------------------------
char __fastcall sub_14000CFD0(__int64 a1, __int64 a2)
{
  char v3; // di
  __int64 v4; // rbx
  unsigned int v5; // esi
  __int16 v7; // cx
  __int16 v8; // dx
  __int16 v9; // ax

  v3 = 0;
  LODWORD(v4) = 0;
  v5 = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x8000) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x18u, (__int64)&unk_140012350);
  }
  do
  {
    v7 = *(_WORD *)(a2 + 2i64 * (unsigned int)v4);
    if ( !v7 )
      break;
    v8 = *(_WORD *)(a1 + 2i64 * v5);
    if ( v7 == v8 && v8 )
    {
      ++v5;
      v9 = *(_WORD *)(a2 + 2i64 * (unsigned int)(v4 + 2));
      if ( !v9 || v9 == 124 )
        v3 = 1;
    }
    else
    {
      do
      {
        if ( v7 == 124 )
          break;
        v4 = (unsigned int)(v4 + 1);
        v7 = *(_WORD *)(a2 + 2 * v4);
      }
      while ( v7 );
      v5 = 0;
    }
    LODWORD(v4) = v4 + 1;
  }
  while ( !v3 );
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x8000) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x19u, (__int64)&unk_140012350);
  }
  return v3;
}

//----- (000000014000D0D8) ----------------------------------------------------
__int64 __fastcall sub_14000D0D8(int a1, void *a2, void *a3, unsigned int a4, ULONG Type, void *Src, ULONG MaxCount, void *a8, unsigned int DstSize, const wchar_t *SourceString)
{
  rsize_t v10; // rbp
  unsigned int v14; // ebx

  v10 = a4;
  v14 = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xEu, (__int64)&unk_140012350);
  }
  if ( !a1 )
  {
    if ( Type == 4 )
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu)
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_14000D7E0((__int64)off_140013400->AttachedDevice, 0xFu, (__int64)&unk_140012350, SourceString);
      }
    }
    else if ( Type == 1
           && off_140013400 != (PDEVICE_OBJECT)&off_140013400
           && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu)
           && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_14000D71C((__int64)off_140013400->AttachedDevice, 0x10u, (__int64)&unk_140012350, SourceString, (__int64)a3);
    }
    memcpy_s(a8, DstSize, a3, v10);
    sub_14000E670(a3);
    goto LABEL_47;
  }
  if ( a1 == 3 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu)
      && BYTE1(off_140013400->Timer) >= 3u )
    {
      sub_14000B6A4((__int64)off_140013400->AttachedDevice, 0x11u, (__int64)&unk_140012350, SourceString);
    }
    memcpy_s(a8, DstSize, Src, MaxCount);
    if ( !(unsigned int)sub_14000EC38(a2, SourceString, Src, MaxCount, Type) )
    {
      if ( Type == 4 )
      {
        if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
          return v14;
        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu) && BYTE1(off_140013400->Timer) >= 5u )
          sub_14000D7E0((__int64)off_140013400->AttachedDevice, 0x13u, (__int64)&unk_140012350, SourceString);
      }
      else if ( Type == 1 )
      {
        if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
          return v14;
        if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu) && BYTE1(off_140013400->Timer) >= 5u )
          sub_14000D71C(
            (__int64)off_140013400->AttachedDevice,
            0x14u,
            (__int64)&unk_140012350,
            SourceString,
            (__int64)Src);
      }
      goto LABEL_47;
    }
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu)
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_14000B6A4((__int64)off_140013400->AttachedDevice, 0x12u, (__int64)&unk_140012350, SourceString);
    }
    goto LABEL_12;
  }
  if ( a1 != 4 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu)
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_14000B844((__int64)off_140013400->AttachedDevice, 0x16u, (__int64)&unk_140012350, a1, SourceString);
    }
LABEL_12:
    v14 = -1073741823;
    goto LABEL_47;
  }
  if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
    return v14;
  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu) && BYTE1(off_140013400->Timer) >= 3u )
    sub_14000B6A4((__int64)off_140013400->AttachedDevice, 0x15u, (__int64)&unk_140012350, SourceString);
LABEL_47:
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xFu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x17u, (__int64)&unk_140012350);
  }
  return v14;
}

//----- (000000014000D438) ----------------------------------------------------
char __fastcall sub_14000D438(DWORD a1, DWORD a2, int a3)
{
  char v6; // r15
  int v7; // er9
  PDEVICE_OBJECT v8; // r14
  const char *v9; // rax
  int v10; // ebx
  int v11; // ebx
  int v12; // ebx
  int v13; // ebx
  int v14; // ebx
  PDEVICE_OBJECT v15; // rcx
  unsigned __int16 v16; // dx
  struct _OSVERSIONINFOW VersionInformation; // [rsp+40h] [rbp-C0h] BYREF

  v6 = 0;
  memset(&VersionInformation.dwMajorVersion, 0, 0x110ui64);
  VersionInformation.dwOSVersionInfoSize = 276;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x10u)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Au, (__int64)&unk_140012350);
  }
  v7 = RtlGetVersion(&VersionInformation);
  if ( v7 )
  {
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return v6;
    if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x10u) && BYTE1(off_140013400->Timer) >= 2u )
      sub_140001580((__int64)off_140013400->AttachedDevice, 0x1Du, (__int64)&unk_140012350, v7);
    goto LABEL_50;
  }
  v8 = off_140013400;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x10u)
    && BYTE1(off_140013400->Timer) >= 3u )
  {
    v9 = sub_14000D6B8(a3);
    sub_14000D864(
      (__int64)v8->AttachedDevice,
      0x1Bu,
      (__int64)&unk_140012350,
      VersionInformation.dwMajorVersion,
      VersionInformation.dwMinorVersion,
      a1,
      a2,
      (__int64)v9);
  }
  v10 = a3 - 1;
  if ( !v10 )
  {
    if ( VersionInformation.dwMajorVersion != a1 || VersionInformation.dwMinorVersion != a2 )
      goto LABEL_50;
LABEL_42:
    v15 = off_140013400;
    v6 = 1;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return v6;
    if ( !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x10u) || BYTE1(off_140013400->Timer) < 4u )
      goto LABEL_50;
    v16 = 30;
    goto LABEL_20;
  }
  v11 = v10 - 1;
  if ( !v11 )
  {
    if ( VersionInformation.dwMajorVersion == a1 && VersionInformation.dwMinorVersion == a2 )
      goto LABEL_50;
    goto LABEL_42;
  }
  v12 = v11 - 1;
  if ( !v12 )
  {
    if ( VersionInformation.dwMajorVersion <= a1
      && (VersionInformation.dwMajorVersion != a1 || VersionInformation.dwMinorVersion <= a2) )
    {
      goto LABEL_50;
    }
    goto LABEL_42;
  }
  v13 = v12 - 1;
  if ( !v13 )
  {
    if ( VersionInformation.dwMajorVersion >= a1
      && (VersionInformation.dwMajorVersion != a1 || VersionInformation.dwMinorVersion >= a2) )
    {
      goto LABEL_50;
    }
    goto LABEL_42;
  }
  v14 = v13 - 1;
  if ( !v14 )
  {
    if ( VersionInformation.dwMajorVersion <= a1
      && (VersionInformation.dwMajorVersion != a1 || VersionInformation.dwMinorVersion < a2) )
    {
      goto LABEL_50;
    }
    goto LABEL_42;
  }
  if ( v14 == 1 )
  {
    if ( VersionInformation.dwMajorVersion >= a1
      && (VersionInformation.dwMajorVersion != a1 || VersionInformation.dwMinorVersion > a2) )
    {
      goto LABEL_50;
    }
    goto LABEL_42;
  }
  v15 = off_140013400;
  if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
    return v6;
  if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x10u) && BYTE1(off_140013400->Timer) >= 3u )
  {
    v16 = 28;
LABEL_20:
    sub_140001558((__int64)v15->AttachedDevice, v16, (__int64)&unk_140012350);
  }
LABEL_50:
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x10u)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Fu, (__int64)&unk_140012350);
  }
  return v6;
}

//----- (000000014000D6B8) ----------------------------------------------------
const char *__fastcall sub_14000D6B8(int a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // ecx
  int v4; // ecx
  int v5; // ecx

  if ( !a1 )
    return "E_NNS_WINVER_COMPARE_UNKNOWN";
  v1 = a1 - 1;
  if ( !v1 )
    return "E_NNS_WINVER_COMPARE_EQUAL";
  v2 = v1 - 1;
  if ( !v2 )
    return "E_NNS_WINVER_COMPARE_UNEQUAL";
  v3 = v2 - 1;
  if ( !v3 )
    return "E_NNS_WINVER_COMPARE_GREATER";
  v4 = v3 - 1;
  if ( !v4 )
    return "E_NNS_WINVER_COMPARE_LOWER";
  v5 = v4 - 1;
  if ( !v5 )
    return "E_NNS_WINVER_COMPARE_GREATER_OR_EQUAL";
  if ( v5 == 1 )
    return "E_NNS_WINVER_COMPARE_LOWER_OR_EQUAL";
  return "UNKNOWN";
}

//----- (000000014000D71C) ----------------------------------------------------
__int64 __fastcall sub_14000D71C(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4, __int64 a5)
{
  __int64 v5; // rax
  unsigned int v6; // edi
  __int64 v7; // r10
  const wchar_t *v8; // rdx

  v5 = -1i64;
  v6 = a2;
  if ( a5 )
  {
    v7 = -1i64;
    do
      ++v7;
    while ( *(_WORD *)(a5 + 2 * v7) );
  }
  if ( a4 )
  {
    do
      ++v5;
    while ( a4[v5] );
  }
  v8 = L"NULL";
  if ( a4 )
    v8 = a4;
  return qword_140013488(a1, 43i64, a3, v6, v8);
}
// 140010BD0: using guessed type wchar_t aNull[5];
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000D7E0) ----------------------------------------------------
__int64 __fastcall sub_14000D7E0(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4)
{
  __int64 v5; // rax
  const wchar_t *v6; // rcx

  if ( a4 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( a4[v5] );
  }
  v6 = L"NULL";
  if ( a4 )
    v6 = a4;
  return qword_140013488(a1, 43i64, a3, a2, v6);
}
// 140010BD0: using guessed type wchar_t aNull[5];
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000D864) ----------------------------------------------------
__int64 __fastcall sub_14000D864(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, char a5, char a6, char a7, __int64 a8)
{
  __int64 v8; // r9
  int v10; // [rsp+A8h] [rbp+20h] BYREF

  v10 = a4;
  if ( a8 )
  {
    v8 = -1i64;
    do
      ++v8;
    while ( *(_BYTE *)(a8 + v8) );
  }
  return qword_140013488(a1, 43i64, a3, a2, &v10);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000D920) ----------------------------------------------------
__int64 __fastcall sub_14000D920(unsigned int a1, int a2)
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 4) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x26u, (__int64)&unk_140012360);
  }
  if ( a2 == 6 )
  {
    a1 -= 14;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return a1;
    if ( (HIDWORD(off_140013400->Timer) & 4) != 0 && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001580((__int64)off_140013400->AttachedDevice, 0x27u, (__int64)&unk_140012360, a1);
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 4) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x28u, (__int64)&unk_140012360);
  }
  return a1;
}

//----- (000000014000D9E0) ----------------------------------------------------
__int64 __fastcall sub_14000D9E0(__int64 a1, __int64 a2, int a3)
{
  __int64 result; // rax
  int v7; // edx
  void *retaddr; // [rsp+28h] [rbp+0h] BYREF

  result = (__int64)&retaddr;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    result = HIDWORD(off_140013400->Timer);
    if ( (result & 4) != 0 && BYTE1(off_140013400->Timer) >= 5u )
      result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x29u, (__int64)&unk_140012360);
  }
  if ( a3 == 6 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      result = HIDWORD(off_140013400->Timer);
      if ( (result & 4) != 0 && BYTE1(off_140013400->Timer) >= 4u )
        result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x2Au, (__int64)&unk_140012360);
    }
    v7 = *(unsigned __int16 *)(a2 + 12);
    if ( (_WORD)v7 == 8 )
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
      {
        result = HIDWORD(off_140013400->Timer);
        if ( (result & 4) != 0 && BYTE1(off_140013400->Timer) >= 4u )
          result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x2Bu, (__int64)&unk_140012360);
      }
      *(_DWORD *)(a1 + 128) |= 0x200u;
      *(_QWORD *)(a1 + 200) = 8i64;
    }
    else
    {
      result = 56710i64;
      if ( (_WORD)v7 == 0xDD86 )
      {
        if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
          && (HIDWORD(off_140013400->Timer) & 4) != 0
          && BYTE1(off_140013400->Timer) >= 4u )
        {
          sub_140001558((__int64)off_140013400->AttachedDevice, 0x2Cu, (__int64)&unk_140012360);
        }
        result = 1024i64;
        *(_DWORD *)(a1 + 128) |= 0x400u;
        *(_QWORD *)(a1 + 200) = 1024i64;
      }
      else
      {
        if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
          return result;
        result = HIDWORD(off_140013400->Timer);
        if ( (result & 4) != 0 && BYTE1(off_140013400->Timer) >= 3u )
          result = sub_140001580((__int64)off_140013400->AttachedDevice, 0x2Du, (__int64)&unk_140012360, v7);
      }
    }
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    result = HIDWORD(off_140013400->Timer);
    if ( (result & 4) != 0 && BYTE1(off_140013400->Timer) >= 5u )
      result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x2Eu, (__int64)&unk_140012360);
  }
  return result;
}

//----- (000000014000DB6C) ----------------------------------------------------
__int64 __fastcall sub_14000DB6C(int a1, __int64 a2, unsigned int a3, _NET_BUFFER_LIST *a4)
{
  unsigned int v7; // esi
  PVOID *v8; // rax
  PVOID *v9; // rdi
  UINT v10; // eax
  SIZE_T DataLength; // r14
  PVOID v12; // rax
  void *v13; // r15
  _MDL *v14; // rbp
  unsigned int v15; // eax
  PNET_BUFFER_LIST v16; // rax
  _NET_BUFFER_LIST *v17; // rbx
  __int64 v18; // rdx
  volatile signed __int64 *v20; // rax
  PVOID v21; // rax
  PDEVICE_OBJECT v22; // rcx
  unsigned __int16 v23; // dx
  PDEVICE_OBJECT v24; // rcx
  unsigned __int16 v25; // dx

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 8) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Bu, (__int64)&unk_140012360);
  }
  v7 = 1;
  v8 = sub_14000C668(a1);
  v9 = v8;
  if ( !v8 )
  {
    v24 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
      || (HIDWORD(off_140013400->Timer) & 8) == 0
      || BYTE1(off_140013400->Timer) < 3u )
    {
      goto LABEL_54;
    }
    v25 = 36;
LABEL_53:
    sub_140001558((__int64)v24->AttachedDevice, v25, (__int64)&unk_140012360);
    goto LABEL_54;
  }
  if ( !sub_140005548((__int64)v8, 0) )
  {
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return v7;
    if ( (HIDWORD(off_140013400->Timer) & 1) != 0 && BYTE1(off_140013400->Timer) >= 3u )
      sub_140001580((__int64)off_140013400->AttachedDevice, 0x1Cu, (__int64)&unk_140012360, *((_DWORD *)v9 + 30));
    goto LABEL_55;
  }
  v10 = sub_14000D920(a3, *((_DWORD *)v9 + 96));
  DataLength = v10;
  v12 = NdisAllocateMemoryWithTagPriority(v9[2], v10, 0x4E414849u, HighPoolPriority);
  v13 = v12;
  if ( !v12 )
  {
    v24 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
      || (HIDWORD(off_140013400->Timer) & 8) == 0
      || BYTE1(off_140013400->Timer) < 2u )
    {
      goto LABEL_54;
    }
    v25 = 35;
    goto LABEL_53;
  }
  v14 = NdisAllocateMdl(v9[2], v12, DataLength);
  if ( !v14 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 8) != 0
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x22u, (__int64)&unk_140012360);
    }
    goto LABEL_44;
  }
  v15 = sub_140006BCC(*((_DWORD *)v9 + 96));
  memmove(v13, (const void *)(a2 + v15), (unsigned int)DataLength);
  v16 = NdisAllocateNetBufferAndNetBufferList(v9[78], 0x30u, 0, v14, 0, DataLength);
  v17 = v16;
  if ( !v16 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 8) != 0
      && BYTE1(off_140013400->Timer) >= 3u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Du, (__int64)&unk_140012360);
    }
    NdisFreeMdl(v14);
LABEL_44:
    NdisFreeMemory(v13, DataLength, 0);
LABEL_54:
    v7 = 0;
LABEL_55:
    v22 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
      || (HIDWORD(off_140013400->Timer) & 8) == 0
      || BYTE1(off_140013400->Timer) < 5u )
    {
      return v7;
    }
    v23 = 37;
    goto LABEL_59;
  }
  v18 = (__int64)&v16->Context->ContextData[v16->Context->Offset];
  if ( v18 )
  {
    *(_DWORD *)(v18 + 24) = 0;
    *(_DWORD *)v18 = a1;
    strcpy((char *)(v18 + 4), "NAHSL");
    _InterlockedAdd64((volatile signed __int64 *)v9 + 17, 1ui64);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x18u)
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_14000BA60((__int64)off_140013400->AttachedDevice, 0x1Fu, (__int64)&unk_140012360, v9[2], v9[17]);
    }
    if ( dword_140013588 )
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x18u)
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_14000B808((__int64)off_140013400->AttachedDevice, 0x20u, (__int64)&unk_140012360, v9[17]);
      }
      v20 = &qword_140014610;
    }
    else
    {
      v20 = (volatile signed __int64 *)&unk_140014600;
    }
    _InterlockedAdd64(v20, 1ui64);
    v21 = v9[2];
    v17->Status = 0;
    v17->SourceHandle = v21;
    sub_140007544(a4, v17, 0);
    sub_14000D9E0((__int64)v17, a2, *((_DWORD *)v9 + 96));
    sub_140009A24((__int64)v17, 0, "INJECT_INBOUND");
    NdisFIndicateReceiveNetBufferLists(v9[2], v17, 0, 1u, 0);
    v22 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
      || (HIDWORD(off_140013400->Timer) & 8) == 0
      || BYTE1(off_140013400->Timer) < 5u )
    {
      return v7;
    }
    v23 = 33;
LABEL_59:
    sub_140001558((__int64)v22->AttachedDevice, v23, (__int64)&unk_140012360);
    return v7;
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 8) != 0
    && BYTE1(off_140013400->Timer) >= 2u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Eu, (__int64)&unk_140012360);
  }
  NdisFreeMdl(v14);
  NdisFreeNetBufferList(v17);
  NdisFreeMemory(v13, DataLength, 0);
  return 0i64;
}
// 140013588: using guessed type int dword_140013588;
// 140014610: using guessed type __int64 qword_140014610;

//----- (000000014000DF94) ----------------------------------------------------
__int64 __fastcall sub_14000DF94(int a1, __int64 a2, unsigned int a3, _NET_BUFFER_LIST *a4)
{
  PVOID *v7; // rax
  PVOID *v8; // rdi
  unsigned int v9; // esi
  UINT v10; // eax
  SIZE_T DataLength; // rbp
  PVOID v12; // rax
  void *v13; // r14
  _MDL *v14; // r12
  unsigned int v15; // eax
  PNET_BUFFER_LIST v16; // rax
  _NET_BUFFER_LIST *v17; // rbx
  __int64 v18; // r15
  PVOID v20; // rax
  PDEVICE_OBJECT v21; // rcx
  unsigned __int16 v22; // dx
  __int64 v23; // [rsp+78h] [rbp+10h]

  v23 = a2;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x10) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xAu, (__int64)&unk_140012360);
  }
  v7 = sub_14000C668(a1);
  v8 = v7;
  v9 = 1;
  if ( !v7 )
  {
    v21 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
      || (HIDWORD(off_140013400->Timer) & 0x10) == 0
      || BYTE1(off_140013400->Timer) < 3u )
    {
      goto LABEL_54;
    }
    v22 = 25;
    goto LABEL_53;
  }
  if ( !sub_140005548((__int64)v7, 0) )
  {
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return v9;
    if ( (HIDWORD(off_140013400->Timer) & 1) != 0 && BYTE1(off_140013400->Timer) >= 3u )
      sub_140001580((__int64)off_140013400->AttachedDevice, 0xBu, (__int64)&unk_140012360, *((_DWORD *)v8 + 30));
LABEL_55:
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x10) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Au, (__int64)&unk_140012360);
    }
    return v9;
  }
  v10 = sub_14000D920(a3, *((_DWORD *)v8 + 96));
  DataLength = v10;
  v12 = NdisAllocateMemoryWithTagPriority(v8[2], v10, 0x4E41484Fu, HighPoolPriority);
  v13 = v12;
  if ( !v12 )
  {
    v21 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
      || (HIDWORD(off_140013400->Timer) & 0x10) == 0
      || BYTE1(off_140013400->Timer) < 2u )
    {
      goto LABEL_54;
    }
    v22 = 24;
LABEL_53:
    sub_140001558((__int64)v21->AttachedDevice, v22, (__int64)&unk_140012360);
LABEL_54:
    v9 = 0;
    goto LABEL_55;
  }
  v14 = NdisAllocateMdl(v8[2], v12, DataLength);
  if ( !v14 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x10) != 0
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x17u, (__int64)&unk_140012360);
    }
    NdisFreeMemory(v13, DataLength, 0);
    goto LABEL_54;
  }
  v15 = sub_140006BCC(*((_DWORD *)v8 + 96));
  memmove(v13, (const void *)(a2 + v15), (unsigned int)DataLength);
  v16 = NdisAllocateNetBufferAndNetBufferList(v8[78], 0x30u, 0, v14, 0, DataLength);
  v17 = v16;
  if ( !v16 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x10) != 0
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0xCu, (__int64)&unk_140012360);
    }
    NdisFreeMdl(v14);
    NdisFreeMemory(v13, DataLength, 0);
    goto LABEL_54;
  }
  v18 = (__int64)&v16->Context->ContextData[v16->Context->Offset];
  if ( v18 )
  {
    _InterlockedAdd64((volatile signed __int64 *)v8 + 18, 1ui64);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x18u)
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_14000BA60((__int64)off_140013400->AttachedDevice, 0xEu, (__int64)&unk_140012360, v8[2], v8[18]);
    }
    if ( dword_140013588 )
    {
      _InterlockedAdd64(&qword_140014618, 1ui64);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0x18u)
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_14000B808((__int64)off_140013400->AttachedDevice, 0xFu, (__int64)&unk_140012360, v8[18]);
      }
    }
    else
    {
      _InterlockedAdd64(&qword_140014608, 1ui64);
    }
    *(_DWORD *)(v18 + 24) = 0;
    *(_DWORD *)v18 = a1;
    strcpy((char *)(v18 + 4), "NAHSL");
    v20 = v8[2];
    v17->Status = 0;
    v17->SourceHandle = v20;
    sub_140007544(a4, v17, 1);
    sub_14000D9E0((__int64)v17, v23, *((_DWORD *)v8 + 96));
    sub_140009A24((__int64)v17, 1, "INJECT_OUTBOUND");
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x10) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x16u, (__int64)&unk_140012360, v17);
    }
    NdisFSendNetBufferLists(v8[2], v17, 0, 2u);
    goto LABEL_55;
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x10) != 0
    && BYTE1(off_140013400->Timer) >= 2u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xDu, (__int64)&unk_140012360);
  }
  NdisFreeMdl(v14);
  NdisFreeNetBufferList(v17);
  NdisFreeMemory(v13, DataLength, 0);
  return 0i64;
}
// 140013588: using guessed type int dword_140013588;
// 140014608: using guessed type __int64 qword_140014608;
// 140014618: using guessed type __int64 qword_140014618;

//----- (000000014000E3C8) ----------------------------------------------------
__int16 __fastcall sub_14000E3C8(__int16 a1)
{
  return (a1 & 0xFFF0) + 16;
}

//----- (000000014000E3D8) ----------------------------------------------------
__int64 __fastcall sub_14000E3D8(PNET_BUFFER NetBuffer, __int64 a2, _DWORD *a3, unsigned int a4, __int64 a5)
{
  unsigned int v5; // edi
  unsigned int v10; // er15
  int v11; // esi
  unsigned int v12; // ebx
  PVOID v13; // rax
  ULONG v14; // edx
  PDEVICE_OBJECT v15; // rcx
  unsigned __int16 v16; // dx
  __int64 v18; // [rsp+60h] [rbp+8h] BYREF

  v5 = 0;
  v18 = 0i64;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x20) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xAu, (__int64)&unk_140012370);
  }
  *a3 = 0;
  v10 = sub_140006B08(NetBuffer->DataLength, *(_DWORD *)(a2 + 136));
  if ( !(unsigned int)sub_14000F310(v10, (__int64)&v18) )
  {
    v11 = 1;
    v12 = sub_140006BCC(*(_DWORD *)(a2 + 136));
    v13 = NdisGetDataBuffer(NetBuffer, NetBuffer->DataLength, 0i64, 1u, 0);
    v14 = NetBuffer->DataLength;
    if ( v13 )
    {
      memmove((void *)(v18 + v12), v13, v14);
    }
    else if ( !NdisGetDataBuffer(NetBuffer, v14, (PVOID)(v12 + v18), 1u, 0) )
    {
      v15 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || (HIDWORD(off_140013400->Timer) & 0x20) == 0
        || BYTE1(off_140013400->Timer) < 2u )
      {
        goto LABEL_20;
      }
      v16 = 11;
      goto LABEL_19;
    }
    if ( (unsigned int)sub_14000FE1C(v10, v18, a2, a4, a5) )
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x20) != 0
        && BYTE1(off_140013400->Timer) >= 2u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0xCu, (__int64)&unk_140012370);
      }
      sub_14000F990(v18);
      goto LABEL_20;
    }
    v15 = off_140013400;
    v11 = 0;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
      || (HIDWORD(off_140013400->Timer) & 0x20) == 0
      || BYTE1(off_140013400->Timer) < 5u )
    {
LABEL_20:
      v5 = v11;
      goto LABEL_25;
    }
    v16 = 13;
LABEL_19:
    sub_140001558((__int64)v15->AttachedDevice, v16, (__int64)&unk_140012370);
    goto LABEL_20;
  }
LABEL_25:
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x20) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xEu, (__int64)&unk_140012370);
  }
  return v5;
}

//----- (000000014000E5D8) ----------------------------------------------------
__int64 __fastcall sub_14000E5D8(void *a1)
{
  __int64 result; // rax

  if ( a1 )
  {
    ZwClose(a1);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x4000) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x10u, (__int64)&unk_140012380, a1);
    }
    result = 0i64;
  }
  else
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x4000) != 0
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0xFu, (__int64)&unk_140012380, 0i64);
    }
    result = 5i64;
  }
  return result;
}

//----- (000000014000E670) ----------------------------------------------------
void __fastcall sub_14000E670(PVOID P)
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x4000) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x18u, (__int64)&unk_140012380);
  }
  if ( P )
    ExFreePoolWithTag(P, 0x7248414Eu);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x4000) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x19u, (__int64)&unk_140012380);
  }
}

//----- (000000014000E704) ----------------------------------------------------
__int64 __fastcall sub_14000E704(PCWSTR SourceString, void **a2)
{
  unsigned int v2; // ebx
  int v5; // er9
  const char *v6; // rax
  _UNICODE_STRING DestinationString; // [rsp+40h] [rbp-40h] BYREF
  struct _OBJECT_ATTRIBUTES ObjectAttributes; // [rsp+50h] [rbp-30h] BYREF
  ULONG Disposition; // [rsp+B0h] [rbp+30h] BYREF
  void *KeyHandle; // [rsp+C0h] [rbp+40h] BYREF

  v2 = 0;
  KeyHandle = 0i64;
  DestinationString = 0i64;
  Disposition = 0;
  *(_OWORD *)&ObjectAttributes.Length = 0i64;
  *(_OWORD *)&ObjectAttributes.ObjectName = 0i64;
  *(_OWORD *)&ObjectAttributes.SecurityDescriptor = 0i64;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xAu, (__int64)&unk_140012380);
  }
  if ( SourceString )
  {
    *a2 = 0i64;
    RtlInitUnicodeString(&DestinationString, SourceString);
    ObjectAttributes.Length = 48;
    ObjectAttributes.ObjectName = &DestinationString;
    ObjectAttributes.RootDirectory = 0i64;
    ObjectAttributes.Attributes = 576;
    *(_OWORD *)&ObjectAttributes.SecurityDescriptor = 0i64;
    v5 = ZwCreateKey(&KeyHandle, 0xF003Fu, &ObjectAttributes, 0, 0i64, 0, &Disposition);
    if ( v5 >= 0 )
    {
      *a2 = KeyHandle;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
        return v2;
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu) && BYTE1(off_140013400->Timer) >= 4u )
      {
        v6 = "OPENED";
        if ( Disposition == 1 )
          v6 = "CREATED";
        sub_14000EF48((__int64)off_140013400->AttachedDevice, 0xDu, (__int64)&unk_140012380, SourceString, (__int64)v6);
      }
    }
    else
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
        && BYTE1(off_140013400->Timer) >= 2u )
      {
        sub_14000B844((__int64)off_140013400->AttachedDevice, 0xCu, (__int64)&unk_140012380, v5, SourceString);
      }
      v2 = 1;
    }
  }
  else
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0xBu, (__int64)&unk_140012380, 0i64);
    }
    v2 = 5;
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xEu, (__int64)&unk_140012380);
  }
  return v2;
}

//----- (000000014000E8E8) ----------------------------------------------------
__int64 __fastcall sub_14000E8E8(HANDLE KeyHandle, PCWSTR SourceString, void **a3, unsigned int *a4, __int64 a5)
{
  unsigned int v9; // ebx
  int v10; // eax
  _DWORD *v11; // rax
  _DWORD *v12; // rdi
  int v13; // er9
  unsigned int v14; // esi
  int v15; // ecx
  PVOID v16; // rax
  _UNICODE_STRING DestinationString; // [rsp+30h] [rbp-38h] BYREF
  ULONG ResultLength; // [rsp+80h] [rbp+18h] BYREF

  ResultLength = 0;
  DestinationString = 0i64;
  v9 = 1;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x11u, (__int64)&unk_140012380);
  }
  if ( a3 )
    *a3 = 0i64;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_14000EEC4((__int64)off_140013400->AttachedDevice, 0x12u, (__int64)&unk_140012380, SourceString);
  }
  RtlInitUnicodeString(&DestinationString, SourceString);
  v10 = ZwQueryValueKey(KeyHandle, &DestinationString, KeyValueFullInformation, 0i64, 8u, &ResultLength);
  if ( v10 != -1073741789 && v10 != -2147483643 )
  {
    if ( v10 == -1073741772 )
      v9 = 3;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_14000EE20((__int64)off_140013400->AttachedDevice, 0x15u, (__int64)&unk_140012380, v10, (__int64)SourceString);
    }
    goto LABEL_38;
  }
  v11 = ExAllocatePoolWithTag(Flags, ResultLength, 0x7248414Eu);
  v12 = v11;
  if ( v11 )
  {
    v13 = ZwQueryValueKey(KeyHandle, &DestinationString, KeyValueFullInformation, v11, ResultLength, &ResultLength);
    if ( v13 )
    {
      if ( v13 == -1073741772 )
        v9 = 3;
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
        && BYTE1(off_140013400->Timer) >= 2u )
      {
        sub_14000EE20(
          (__int64)off_140013400->AttachedDevice,
          0x14u,
          (__int64)&unk_140012380,
          v13,
          (__int64)SourceString);
      }
      goto LABEL_37;
    }
    v14 = v12[3];
    if ( v14 <= 2 )
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
        && BYTE1(off_140013400->Timer) >= 3u )
      {
        sub_14000B6A4((__int64)off_140013400->AttachedDevice, 0x13u, (__int64)&unk_140012380, SourceString);
      }
      v9 = 4;
LABEL_37:
      ExFreePoolWithTag(v12, 0x7248414Eu);
      goto LABEL_38;
    }
    v15 = v12[1];
    if ( (unsigned int)(v15 - 1) <= 1 || v15 == 7 )
      v14 += 2;
    v16 = ExAllocatePoolWithTag(Flags, v14, 0x7248414Eu);
    *a3 = v16;
    if ( v16 )
    {
      memset(v16, 0, v14);
      memmove(*a3, (char *)v12 + (unsigned int)v12[2], (unsigned int)v12[3]);
      v9 = 0;
      *(_DWORD *)a5 = v12[1];
      *a4 = v14;
    }
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x16u, (__int64)&unk_140012380);
  }
  if ( v12 )
    goto LABEL_37;
LABEL_38:
  if ( v9 && *a3 )
    ExFreePoolWithTag(*a3, 0x7248414Eu);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x17u, (__int64)&unk_140012380);
  }
  return v9;
}

//----- (000000014000EC38) ----------------------------------------------------
__int64 __fastcall sub_14000EC38(HANDLE KeyHandle, PCWSTR SourceString, PVOID Data, ULONG DataSize, ULONG Type)
{
  unsigned int v9; // ebx
  int v10; // er9
  ULONG v12; // [rsp+30h] [rbp-48h]
  _UNICODE_STRING DestinationString; // [rsp+40h] [rbp-38h] BYREF

  DestinationString = 0i64;
  v9 = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Au, (__int64)&unk_140012380);
  }
  if ( KeyHandle && SourceString && Data && DataSize )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_14000EEC4((__int64)off_140013400->AttachedDevice, 0x1Cu, (__int64)&unk_140012380, SourceString);
    }
    RtlInitUnicodeString(&DestinationString, SourceString);
    v10 = ZwSetValueKey(KeyHandle, &DestinationString, 0, Type, Data, DataSize);
    if ( v10 >= 0 )
    {
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
        return v9;
      if ( _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu) && BYTE1(off_140013400->Timer) >= 4u )
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Eu, (__int64)&unk_140012380);
    }
    else
    {
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
        && BYTE1(off_140013400->Timer) >= 2u )
      {
        sub_14000EE20(
          (__int64)off_140013400->AttachedDevice,
          0x1Du,
          (__int64)&unk_140012380,
          v10,
          (__int64)SourceString);
      }
      v9 = 1;
    }
  }
  else
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      v12 = DataSize;
      sub_14000F02C(
        (__int64)off_140013400->AttachedDevice,
        0x1Bu,
        (__int64)&unk_140012380,
        KeyHandle,
        SourceString,
        Data,
        v12);
    }
    v9 = 5;
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xEu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Fu, (__int64)&unk_140012380);
  }
  return v9;
}

//----- (000000014000EE20) ----------------------------------------------------
__int64 __fastcall sub_14000EE20(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, __int64 a5)
{
  __int64 v5; // rax
  int v7; // [rsp+88h] [rbp+20h] BYREF

  v7 = a4;
  if ( a5 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( *(_WORD *)(a5 + 2 * v5) );
  }
  return qword_140013488(a1, 43i64, a3, a2, &v7);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000EEC4) ----------------------------------------------------
__int64 __fastcall sub_14000EEC4(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4)
{
  __int64 v5; // rax
  const wchar_t *v6; // rcx

  if ( a4 )
  {
    v5 = -1i64;
    do
      ++v5;
    while ( a4[v5] );
  }
  v6 = L"NULL";
  if ( a4 )
    v6 = a4;
  return qword_140013488(a1, 43i64, a3, a2, v6);
}
// 140010BD0: using guessed type wchar_t aNull[5];
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000EF48) ----------------------------------------------------
__int64 __fastcall sub_14000EF48(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4, __int64 a5)
{
  __int64 v5; // rax
  __int64 v7; // r10
  const wchar_t *v8; // rcx

  v5 = -1i64;
  if ( a5 )
  {
    v7 = -1i64;
    do
      ++v7;
    while ( *(_BYTE *)(a5 + v7) );
  }
  if ( a4 )
  {
    do
      ++v5;
    while ( a4[v5] );
  }
  v8 = L"NULL";
  if ( a4 )
    v8 = a4;
  return qword_140013488(a1, 43i64, a3, a2, v8);
}
// 140010BD0: using guessed type wchar_t aNull[5];
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000F02C) ----------------------------------------------------
__int64 sub_14000F02C(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000F090) ----------------------------------------------------
__int64 sub_14000F090()
{
  int v0; // ebx
  __int64 result; // rax

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xEu, (__int64)&unk_140012390);
  }
  byte_140014588 = KeAcquireSpinLockRaiseToDpc(&qword_140014580);
  if ( dword_140014594 )
  {
    v0 = dword_140014590++;
    KeReleaseSpinLock(&qword_140014580, byte_140014588);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001580((__int64)off_140013400->AttachedDevice, 0xFu, (__int64)&unk_140012390, v0);
    }
    result = 1i64;
  }
  else
  {
    KeReleaseSpinLock(&qword_140014580, byte_140014588);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x10u, (__int64)&unk_140012390);
    }
    result = 0i64;
  }
  return result;
}
// 140014590: using guessed type int dword_140014590;
// 140014594: using guessed type int dword_140014594;

//----- (000000014000F1A0) ----------------------------------------------------
__int64 __fastcall sub_14000F1A0(int a1, __int64 a2)
{
  unsigned int v4; // edi
  int v5; // ebx
  int v6; // ebx
  _DWORD *v7; // rbx
  int v8; // eax

  v4 = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x2Fu, (__int64)&unk_140012390);
  }
  if ( !a2 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_14000B808((__int64)off_140013400->AttachedDevice, 0x30u, (__int64)&unk_140012390, 0i64);
    }
    goto LABEL_10;
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    sub_140010338((__int64)off_140013400->AttachedDevice, 0x31u, (__int64)&unk_140012390, a1);
  }
  v5 = a1 - 3;
  if ( v5 )
  {
    v6 = v5 - 1;
    if ( v6 )
    {
      if ( v6 != 1 )
      {
LABEL_10:
        v4 = 2;
        goto LABEL_25;
      }
      v7 = *(_DWORD **)a2;
      v8 = sub_14000C940((unsigned __int8 *)(*(_QWORD *)a2 + 4i64));
    }
    else
    {
      v7 = *(_DWORD **)a2;
      v8 = sub_14000C7E8((unsigned __int8 *)(*(_QWORD *)a2 + 4i64));
    }
    *v7 = v8;
    goto LABEL_25;
  }
  if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
    return v4;
  if ( (HIDWORD(off_140013400->Timer) & 0x80u) != 0 && BYTE1(off_140013400->Timer) >= 3u )
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x32u, (__int64)&unk_140012390);
LABEL_25:
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001580((__int64)off_140013400->AttachedDevice, 0x33u, (__int64)&unk_140012390, v4);
  }
  return v4;
}

//----- (000000014000F310) ----------------------------------------------------
__int64 __fastcall sub_14000F310(unsigned int a1, __int64 a2)
{
  unsigned int v4; // ebx

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Au, (__int64)&unk_140012390);
  }
  v4 = (*((__int64 (__fastcall **)(_QWORD, __int64))&xmmword_1400145D0 + 1))(a1, a2);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Bu, (__int64)&unk_140012390);
  }
  return v4;
}
// 1400145D0: using guessed type __int128 xmmword_1400145D0;
// 1400145D8: using guessed type __int64 (__fastcall *)(_QWORD, _QWORD);

//----- (000000014000F3B0) ----------------------------------------------------
__int64 sub_14000F3B0()
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x2Au, (__int64)&unk_140012390);
  }
  sub_14000F468();
  memset(&xmmword_1400145A0, 0, 0x60ui64);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( (HIDWORD(off_140013400->Timer) & 0x80u) != 0 && BYTE1(off_140013400->Timer) >= 4u )
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x2Bu, (__int64)&unk_140012390);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x2Cu, (__int64)&unk_140012390);
    }
  }
  return 0i64;
}
// 1400145A0: using guessed type __int128 xmmword_1400145A0;

//----- (000000014000F468) ----------------------------------------------------
__int64 sub_14000F468()
{
  __int64 result; // rax

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x15u, (__int64)&unk_140012390);
  }
  byte_140014588 = KeAcquireSpinLockRaiseToDpc(&qword_140014580);
  dword_140014594 = 0;
  KeReleaseSpinLock(&qword_140014580, byte_140014588);
  do
    result = (unsigned int)dword_140014590;
  while ( dword_140014590 );
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    result = HIDWORD(off_140013400->Timer);
    if ( (result & 0x80u) != 0i64 && BYTE1(off_140013400->Timer) >= 5u )
      result = sub_140001558((__int64)off_140013400->AttachedDevice, 0x16u, (__int64)&unk_140012390);
  }
  return result;
}
// 140014590: using guessed type int dword_140014590;
// 140014594: using guessed type int dword_140014594;

//----- (000000014000F510) ----------------------------------------------------
__int64 sub_14000F510()
{
  IRP *v1; // rax
  _UNICODE_STRING DestinationString; // [rsp+60h] [rbp-28h] BYREF
  _IO_STATUS_BLOCK IoStatusBlock; // [rsp+70h] [rbp-18h] BYREF
  PDEVICE_OBJECT DeviceObject; // [rsp+90h] [rbp+8h] BYREF
  PFILE_OBJECT FileObject; // [rsp+98h] [rbp+10h] BYREF

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x34u, (__int64)&unk_140012390);
  }
  RtlInitUnicodeString(&DestinationString, L"\\Device\\NNSNAHC");
  if ( IoGetDeviceObjectPointer(&DestinationString, 0, &FileObject, &DeviceObject) < 0 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( (HIDWORD(off_140013400->Timer) & 0x80u) != 0 && BYTE1(off_140013400->Timer) >= 3u )
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x35u, (__int64)&unk_140012390);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x36u, (__int64)&unk_140012390);
      }
    }
    return 0i64;
  }
  *((_QWORD *)&xmmword_1400145A0 + 1) = sub_14000FB40;
  *(_QWORD *)&xmmword_1400145A0 = 12i64;
  *((_QWORD *)&xmmword_1400145B0 + 1) = sub_14000F3B0;
  *(_QWORD *)&xmmword_1400145B0 = sub_14000F1A0;
  *(_QWORD *)&xmmword_1400145C0 = sub_14000FA20;
  *((_QWORD *)&xmmword_1400145C0 + 1) = sub_140010020;
  *(_OWORD *)&xmmword_1400145D0 = 0i64;
  *(_OWORD *)&xmmword_1400145E0 = 0i64;
  *(_OWORD *)&xmmword_1400145F0 = 0i64;
  v1 = IoBuildDeviceIoControlRequest(
         0x222EE0u,
         DeviceObject,
         &xmmword_1400145A0,
         0x60u,
         &xmmword_1400145A0,
         0x60u,
         1u,
         0i64,
         &IoStatusBlock);
  if ( IofCallDriver(DeviceObject, v1) < 0 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
    {
      if ( (HIDWORD(off_140013400->Timer) & 0x80u) != 0 && BYTE1(off_140013400->Timer) >= 2u )
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x37u, (__int64)&unk_140012390);
      if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
        && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
        && BYTE1(off_140013400->Timer) >= 5u )
      {
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x38u, (__int64)&unk_140012390);
      }
    }
    ObfDereferenceObject(FileObject);
    return 0i64;
  }
  ObfDereferenceObject(FileObject);
  sub_14000FF78();
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( (HIDWORD(off_140013400->Timer) & 0x80u) != 0 && BYTE1(off_140013400->Timer) >= 4u )
      sub_140010390(
        (__int64)off_140013400->AttachedDevice,
        0x39u,
        (__int64)&unk_140012390,
        *((_QWORD *)&xmmword_1400145A0 + 1),
        *((_QWORD *)&xmmword_1400145B0 + 1),
        (_QWORD)xmmword_1400145B0,
        *(_OWORD *)&xmmword_1400145D0,
        *(_OWORD *)&xmmword_1400145E0,
        *(_OWORD *)&xmmword_1400145F0);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x3Au, (__int64)&unk_140012390);
    }
  }
  return 1i64;
}
// 1400145A0: using guessed type __int128 xmmword_1400145A0;
// 1400145B0: using guessed type __int128 xmmword_1400145B0;
// 1400145C0: using guessed type __int128 xmmword_1400145C0;
// 1400145D0: using guessed type __int64 (__fastcall *xmmword_1400145D0)(_QWORD, _QWORD);
// 1400145E0: using guessed type __int64 (__fastcall *xmmword_1400145E0)(_QWORD);
// 1400145F0: using guessed type __int64 (*xmmword_1400145F0)(void);

//----- (000000014000F7F8) ----------------------------------------------------
void __fastcall sub_14000F7F8(__int64 a1)
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x3Bu, (__int64)&unk_140012390);
  }
  *(_QWORD *)(a1 + 8) = sub_14000FB40;
  *(_QWORD *)(a1 + 24) = sub_14000F3B0;
  *(_QWORD *)(a1 + 16) = sub_14000F1A0;
  *(_QWORD *)(a1 + 32) = sub_14000FA20;
  *(_QWORD *)(a1 + 40) = sub_140010020;
  xmmword_1400145A0 = *(_OWORD *)a1;
  xmmword_1400145B0 = *(_OWORD *)(a1 + 16);
  xmmword_1400145C0 = *(_OWORD *)(a1 + 32);
  xmmword_1400145D0 = *(_OWORD *)(a1 + 48);
  xmmword_1400145E0 = *(_OWORD *)(a1 + 64);
  xmmword_1400145F0 = *(_OWORD *)(a1 + 80);
  sub_14000FF78();
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( (HIDWORD(off_140013400->Timer) & 0x80u) != 0 && BYTE1(off_140013400->Timer) >= 4u )
      sub_140010390(
        (__int64)off_140013400->AttachedDevice,
        0x3Cu,
        (__int64)&unk_140012390,
        *((_QWORD *)&xmmword_1400145A0 + 1),
        *((_QWORD *)&xmmword_1400145B0 + 1),
        (_QWORD)xmmword_1400145B0,
        xmmword_1400145D0,
        xmmword_1400145E0,
        xmmword_1400145F0);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x3Du, (__int64)&unk_140012390);
    }
  }
}
// 1400145A0: using guessed type __int128 xmmword_1400145A0;
// 1400145B0: using guessed type __int128 xmmword_1400145B0;
// 1400145C0: using guessed type __int128 xmmword_1400145C0;
// 1400145D0: using guessed type __int128 xmmword_1400145D0;
// 1400145E0: using guessed type __int128 xmmword_1400145E0;
// 1400145F0: using guessed type __int128 xmmword_1400145F0;

//----- (000000014000F990) ----------------------------------------------------
__int64 __fastcall sub_14000F990(__int64 a1)
{
  unsigned int v2; // ebx

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Cu, (__int64)&unk_140012390);
  }
  v2 = xmmword_1400145E0(a1);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Du, (__int64)&unk_140012390);
  }
  return v2;
}
// 1400145E0: invalid function type has been ignored
// 1400145E0: using guessed type __int64 (__fastcall *xmmword_1400145E0)(_QWORD);

//----- (000000014000FA20) ----------------------------------------------------
__int64 __fastcall sub_14000FA20(_NET_BUFFER_LIST *a1)
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x2Du, (__int64)&unk_140012390);
  }
  if ( a1 )
    sub_140006CC0(a1);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x2Eu, (__int64)&unk_140012390);
  }
  return 0i64;
}

//----- (000000014000FAAC) ----------------------------------------------------
void sub_14000FAAC()
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xAu, (__int64)&unk_140012390);
  }
  KeInitializeSpinLock(&qword_140014580);
  dword_140014590 = 0;
  dword_140014594 = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xBu, (__int64)&unk_140012390);
  }
}
// 140014590: using guessed type int dword_140014590;
// 140014594: using guessed type int dword_140014594;

//----- (000000014000FB40) ----------------------------------------------------
__int64 __fastcall sub_14000FB40(unsigned int a1, __int64 a2, int a3, int a4, _NET_BUFFER_LIST *a5)
{
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  PDEVICE_OBJECT v11; // rcx
  unsigned __int16 v12; // dx

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x22u, (__int64)&unk_140012390);
  }
  if ( !a4 )
  {
    if ( !(unsigned int)sub_14000DB6C(a3, a2, a1, a5) )
    {
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
        return 1i64;
      if ( (HIDWORD(off_140013400->Timer) & 0x80u) != 0 && BYTE1(off_140013400->Timer) >= 2u )
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x24u, (__int64)&unk_140012390);
      v9 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || (HIDWORD(off_140013400->Timer) & 0x80u) == 0
        || BYTE1(off_140013400->Timer) < 5u )
      {
        return 1i64;
      }
      v10 = 37;
      goto LABEL_39;
    }
    v11 = off_140013400;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      v12 = 35;
      goto LABEL_29;
    }
    return 0i64;
  }
  if ( a4 == 1 )
  {
    if ( !(unsigned int)sub_14000DF94(a3, a2, a1, a5) )
    {
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
        return 1i64;
      if ( (HIDWORD(off_140013400->Timer) & 0x80u) != 0 && BYTE1(off_140013400->Timer) >= 2u )
        sub_140001558((__int64)off_140013400->AttachedDevice, 0x27u, (__int64)&unk_140012390);
      v9 = off_140013400;
      if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
        || (HIDWORD(off_140013400->Timer) & 0x80u) == 0
        || BYTE1(off_140013400->Timer) < 5u )
      {
        return 1i64;
      }
      v10 = 40;
      goto LABEL_39;
    }
    v11 = off_140013400;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      v12 = 38;
LABEL_29:
      sub_140001558((__int64)v11->AttachedDevice, v12, (__int64)&unk_140012390);
      return 0i64;
    }
    return 0i64;
  }
  v9 = off_140013400;
  if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
    || (HIDWORD(off_140013400->Timer) & 0x80u) == 0
    || !BYTE1(off_140013400->Timer) )
  {
    return 1i64;
  }
  v10 = 41;
LABEL_39:
  sub_140001558((__int64)v9->AttachedDevice, v10, (__int64)&unk_140012390);
  return 1i64;
}

//----- (000000014000FD30) ----------------------------------------------------
__int64 __fastcall sub_14000FD30(__int64 a1)
{
  __int64 *v3; // [rsp+20h] [rbp-18h] BYREF
  int v4; // [rsp+28h] [rbp-10h]
  int v5; // [rsp+2Ch] [rbp-Ch]
  unsigned int v6; // [rsp+40h] [rbp+8h]
  __int64 v7; // [rsp+48h] [rbp+10h] BYREF

  v5 = 0;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x17u, (__int64)&unk_140012390);
  }
  v7 = a1;
  v3 = &v7;
  v4 = 8;
  if ( xmmword_1400145D0 )
  {
    v6 = xmmword_1400145D0(1i64, &v3);
  }
  else
  {
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400 )
      return v6;
    if ( (HIDWORD(off_140013400->Timer) & 0x80u) != 0 && BYTE1(off_140013400->Timer) >= 3u )
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x18u, (__int64)&unk_140012390);
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x19u, (__int64)&unk_140012390);
  }
  return v6;
}
// 1400145D0: invalid function type has been ignored
// 1400145D0: using guessed type __int64 (__fastcall *xmmword_1400145D0)(_QWORD, _QWORD);

//----- (000000014000FE1C) ----------------------------------------------------
__int64 __fastcall sub_14000FE1C(unsigned int a1, __int64 a2, __int64 a3, unsigned int a4, __int64 a5)
{
  unsigned int v9; // ebx

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Eu, (__int64)&unk_140012390);
  }
  v9 = ((__int64 (__fastcall *)(_QWORD, __int64, __int64, _QWORD, __int64))*(&xmmword_1400145E0 + 1))(
         a1,
         a2,
         a3,
         a4,
         a5);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x1Fu, (__int64)&unk_140012390);
  }
  return v9;
}
// 1400145E0: using guessed type __int64 (__fastcall *xmmword_1400145E0)(_QWORD);
// 1400145E8: using guessed type __int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000014000FEE4) ----------------------------------------------------
__int64 sub_14000FEE4()
{
  unsigned int v0; // ebx
  unsigned int v2; // [rsp+30h] [rbp+8h]

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x20u, (__int64)&unk_140012390);
  }
  if ( xmmword_1400145F0 )
    v0 = xmmword_1400145F0();
  else
    v0 = v2;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x21u, (__int64)&unk_140012390);
  }
  return v0;
}
// 1400145F0: invalid function type has been ignored
// 1400145F0: using guessed type __int64 (*xmmword_1400145F0)(void);

//----- (000000014000FF78) ----------------------------------------------------
void sub_14000FF78()
{
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xCu, (__int64)&unk_140012390);
  }
  byte_140014588 = KeAcquireSpinLockRaiseToDpc(&qword_140014580);
  dword_140014594 = 1;
  KeReleaseSpinLock(&qword_140014580, byte_140014588);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xDu, (__int64)&unk_140012390);
  }
}
// 140014594: using guessed type int dword_140014594;

//----- (0000000140010020) ----------------------------------------------------
__int64 __fastcall sub_140010020(int a1, _QWORD *a2, int a3)
{
  unsigned int v3; // ebx

  v3 = 0;
  if ( !a2 || !a3 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x400000) != 0
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_14000BAA8((__int64)off_140013400->AttachedDevice, 0x3Eu, (__int64)&unk_140012390, a2, a3);
    }
    return 2;
  }
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x400000) != 0
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    sub_140010338((__int64)off_140013400->AttachedDevice, 0x3Fu, (__int64)&unk_140012390, a1);
  }
  if ( a1 != 2 )
    return 2;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x400000) != 0
    && BYTE1(off_140013400->Timer) >= 4u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x40u, (__int64)&unk_140012390);
  }
  if ( a3 == 32 )
  {
    sub_140006468(a2);
  }
  else
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x400000) != 0
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_1400015BC((__int64)off_140013400->AttachedDevice, 0x41u, (__int64)&unk_140012390, 32);
    }
    v3 = 3;
  }
  return v3;
}

//----- (0000000140010180) ----------------------------------------------------
void sub_140010180()
{
  KIRQL v0; // al
  int v1; // ebx

  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0x12u, (__int64)&unk_140012390);
  }
  v0 = KeAcquireSpinLockRaiseToDpc(&qword_140014580);
  v1 = dword_140014590;
  byte_140014588 = v0;
  --dword_140014590;
  KeReleaseSpinLock(&qword_140014580, v0);
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( (HIDWORD(off_140013400->Timer) & 0x80u) != 0 && BYTE1(off_140013400->Timer) >= 5u )
      sub_140001580((__int64)off_140013400->AttachedDevice, 0x13u, (__int64)&unk_140012390, v1);
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x80u) != 0
      && BYTE1(off_140013400->Timer) >= 5u )
    {
      sub_140001558((__int64)off_140013400->AttachedDevice, 0x14u, (__int64)&unk_140012390);
    }
  }
}
// 140014590: using guessed type int dword_140014590;

//----- (0000000140010268) ----------------------------------------------------
__int64 __fastcall sub_140010268(unsigned int a1, __int64 a2, int a3)
{
  unsigned int v3; // edi
  unsigned int v6; // ebx

  v3 = a3;
  if ( a2 && a3 )
  {
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x400000) != 0
      && BYTE1(off_140013400->Timer) >= 4u )
    {
      sub_140010338((__int64)off_140013400->AttachedDevice, 0x43u, (__int64)&unk_140012390, a1);
    }
    v6 = (*((__int64 (__fastcall **)(_QWORD, __int64, _QWORD))&xmmword_1400145F0 + 1))(a1, a2, v3);
  }
  else
  {
    v6 = 2;
    if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
      && (HIDWORD(off_140013400->Timer) & 0x400000) != 0
      && BYTE1(off_140013400->Timer) >= 2u )
    {
      sub_14000BAA8((__int64)off_140013400->AttachedDevice, 0x42u, (__int64)&unk_140012390, a2, a3);
    }
  }
  return v6;
}
// 1400145F0: using guessed type __int128 xmmword_1400145F0;
// 1400145F8: using guessed type __int64 (__fastcall *)(_QWORD, _QWORD, _QWORD);

//----- (0000000140010338) ----------------------------------------------------
__int64 __fastcall sub_140010338(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_140013488(a1, 43i64, a3, a2, &v5);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000140010390) ----------------------------------------------------
__int64 sub_140010390(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+E8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_140013488(a1, 43i64, a3, a2, (__int64 *)va);
}
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000001400105B0) ----------------------------------------------------
__int64 __fastcall sub_1400105B0(__int64 a1, __int64 a2)
{
  __int64 result; // rax
  unsigned __int8 v3; // dl

  result = *(_QWORD *)(a2 + 8);
  v3 = *(_BYTE *)(*(unsigned int *)(*(_QWORD *)(a2 + 16) + 8i64) + result + 3);
  if ( (v3 & 0xF) != 0 )
    result = v3 & 0xF0;
  return result;
}

//----- (0000000140016000) ----------------------------------------------------
void sub_140016000()
{
  PDEVICE_OBJECT v0; // rbx

  v0 = off_140013400;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400 )
  {
    if ( dword_1400134A8 == 4 )
    {
      while ( v0 )
      {
        if ( v0->Vpb )
          qword_140013490();
        v0 = v0->NextDevice;
      }
    }
    else if ( dword_1400134A8 == 2 )
    {
      IoWMIRegistrationControl(off_140013400, 0x80000002);
    }
    off_140013400 = (PDEVICE_OBJECT)&off_140013400;
  }
}
// 140013490: using guessed type __int64 (*qword_140013490)(void);
// 1400134A8: using guessed type int dword_1400134A8;

//----- (0000000140016070) ----------------------------------------------------
void sub_140016070()
{
  _DEVICE_OBJECT *v0; // rbx

  v0 = &stru_1400146A0;
  if ( off_140013400 != &stru_1400146A0 )
  {
    off_140013400 = &stru_1400146A0;
    if ( dword_1400134A8 == 4 )
    {
      do
      {
        v0->Vpb = 0i64;
        qword_140013498(v0->DriverObject, 0i64, sub_14000C490, v0, &v0->Vpb);
        v0 = v0->NextDevice;
      }
      while ( v0 );
    }
    else if ( dword_1400134A8 == 2 )
    {
      *(_QWORD *)&stru_1400146A0.Type = sub_140016200;
      IoWMIRegistrationControl(&stru_1400146A0, 0x80010001);
    }
  }
}
// 140013498: invalid function type has been ignored
// 140013498: using guessed type __int64 (__fastcall *qword_140013498)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1400134A8: using guessed type int dword_1400134A8;

//----- (00000001400160F8) ----------------------------------------------------
__int64 (*sub_1400160F8())(void)
{
  __int64 (*result)(void); // rax
  _UNICODE_STRING DestinationString; // [rsp+30h] [rbp-10h] BYREF
  unsigned int v2; // [rsp+50h] [rbp+10h] BYREF

  v2 = 0;
  RtlInitUnicodeString(&DestinationString, L"PsGetVersion");
  qword_1400134A0 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&DestinationString);
  RtlInitUnicodeString(&DestinationString, L"WmiTraceMessage");
  qword_140013488 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&DestinationString);
  RtlInitUnicodeString(&DestinationString, L"WmiQueryTraceInformation");
  qword_140013480 = (__int64)MmGetSystemRoutineAddress(&DestinationString);
  result = (__int64 (*)(void))qword_1400134A0;
  dword_1400134A8 = 2;
  if ( qword_1400134A0 )
    result = (__int64 (*)(void))qword_1400134A0(&v2, 0i64, 0i64, 0i64);
  if ( v2 >= 6 )
  {
    RtlInitUnicodeString(&DestinationString, L"EtwRegisterClassicProvider");
    result = (__int64 (*)(void))MmGetSystemRoutineAddress(&DestinationString);
    qword_140013498 = (__int64)result;
    if ( result )
    {
      RtlInitUnicodeString(&DestinationString, L"EtwUnregister");
      result = (__int64 (*)(void))MmGetSystemRoutineAddress(&DestinationString);
      qword_140013490 = result;
      dword_1400134A8 = 4;
    }
  }
  return result;
}
// 140013480: using guessed type __int64 qword_140013480;
// 140013488: using guessed type __int64 (__fastcall *qword_140013488)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 140013490: using guessed type __int64 (*qword_140013490)(void);
// 140013498: using guessed type __int64 qword_140013498;
// 1400134A0: using guessed type __int64 (__fastcall *qword_1400134A0)(_QWORD, _QWORD, _QWORD, _QWORD);
// 1400134A8: using guessed type int dword_1400134A8;

//----- (0000000140016200) ----------------------------------------------------
__int64 __fastcall sub_140016200(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6)
{
  unsigned int *v6; // r13
  unsigned int v7; // ebx
  __int64 v10; // rsi
  unsigned int v11; // edi
  __int64 v12; // rax
  const void **v13; // r15
  unsigned int v14; // ebp
  unsigned int v15; // er12
  _WORD *v16; // rcx
  _DWORD *v17; // r14
  __int64 v18; // rcx
  __int128 v19; // xmm0
  __int64 v20; // rdi
  __int64 v21; // rax
  char v23; // [rsp+70h] [rbp+8h] BYREF

  v6 = a6;
  v7 = 0;
  *a6 = 0;
  if ( a1 <= 3u )
    return (unsigned int)-1073741808;
  if ( a1 <= 5u )
  {
    v20 = a5;
    if ( !a5 )
      return (unsigned int)-1073741163;
    if ( a3 < 0x30 )
      return (unsigned int)-1073741811;
    while ( RtlCompareMemory(*(const void **)(v20 + 8), a4 + 6, 0x10ui64) != 16 )
    {
      v20 = *(_QWORD *)(v20 + 16);
      if ( !v20 )
        return (unsigned int)-1073741163;
    }
    if ( a1 == 5 )
    {
      *(_DWORD *)(v20 + 44) = 0;
      *(_QWORD *)(v20 + 24) = 0i64;
      *(_BYTE *)(v20 + 41) = 0;
    }
    else
    {
      v21 = *((_QWORD *)a4 + 1);
      *(_QWORD *)(v20 + 24) = v21;
      if ( dword_1400134A8 == 2 )
      {
        if ( !(unsigned int)qword_140013480(3i64, &v23, 4i64, &a6, a4) )
          *(_BYTE *)(v20 + 41) = v23;
        v7 = qword_140013480(2i64, v20 + 44, 4i64, &a6, a4);
      }
      else
      {
        *(_DWORD *)(v20 + 44) = HIDWORD(v21);
        *(_BYTE *)(v20 + 41) = BYTE2(v21);
      }
    }
    return v7;
  }
  if ( a1 <= 7u )
    return v7;
  if ( a1 != 8 )
    return (unsigned int)-1073741808;
  v10 = a5;
  v11 = 0;
  v12 = a5;
  v13 = *(const void ***)(a5 + 32);
  do
  {
    v12 = *(_QWORD *)(v12 + 16);
    ++v11;
  }
  while ( v12 );
  if ( v11 > 0x3F )
    return (unsigned int)-1073741811;
  v14 = 32 * v11 + 24;
  if ( v13 )
  {
    v15 = 32 * v11 + 24;
    v14 += *(unsigned __int16 *)v13 + 2;
  }
  else
  {
    v15 = 0;
  }
  if ( v14 > a3 )
  {
    v7 = -1073741789;
    if ( a3 >= 4 )
    {
      *a4 = v14;
      *v6 = 4;
    }
  }
  else
  {
    memset(a4, 0, a3);
    *a4 = v14;
    a4[2] = v15;
    a4[4] = v11;
    if ( v13 )
    {
      v16 = (_WORD *)((char *)a4 + v15);
      *v16 = *(_WORD *)v13;
      memmove(v16 + 1, v13[1], *(unsigned __int16 *)v13);
    }
    if ( v11 )
    {
      v17 = a4 + 10;
      v18 = v11;
      do
      {
        v19 = *(_OWORD *)*(_QWORD *)(v10 + 8);
        *v17 = 528384;
        v17 += 8;
        *((_OWORD *)v17 - 3) = v19;
        *(_BYTE *)(v10 + 41) = 0;
        *(_DWORD *)(v10 + 44) = 0;
        v10 = *(_QWORD *)(v10 + 16);
        --v18;
      }
      while ( v18 );
    }
    *v6 = v14;
  }
  return v7;
}
// 140013480: invalid function type has been ignored
// 140013480: using guessed type __int64 (__fastcall *qword_140013480)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 1400134A8: using guessed type int dword_1400134A8;

//----- (0000000140017000) ----------------------------------------------------
__int64 __fastcall sub_140017000(PDRIVER_OBJECT DriverObject)
{
  UINT v2; // er9
  _UNICODE_STRING v3; // xmm1
  _UNICODE_STRING v4; // xmm0
  NDIS_STATUS v5; // eax
  unsigned int v6; // ebx
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  int v9; // er9
  struct _NDIS_FILTER_DRIVER_CHARACTERISTICS FilterDriverCharacteristics; // [rsp+40h] [rbp-C0h] BYREF
  _UNICODE_STRING v12; // [rsp+120h] [rbp+20h] BYREF
  _UNICODE_STRING v13; // [rsp+130h] [rbp+30h] BYREF
  _UNICODE_STRING DestinationString; // [rsp+140h] [rbp+40h] BYREF
  struct _OSVERSIONINFOW VersionInformation; // [rsp+150h] [rbp+50h] BYREF

  VersionInformation.dwOSVersionInfoSize = 276;
  if ( RtlGetVersion(&VersionInformation) >= 0
    && (VersionInformation.dwMajorVersion > 6
     || VersionInformation.dwMajorVersion == 6 && VersionInformation.dwMinorVersion >= 2) )
  {
    Flags = 512;
    dword_1400134B0 = 0x40000000;
  }
  *(_QWORD *)&stru_1400146A0.Type = 0i64;
  stru_1400146A0.DriverObject = (_DRIVER_OBJECT *)&unk_140012310;
  stru_1400146A0.NextDevice = 0i64;
  stru_1400146A0.CurrentIrp = 0i64;
  stru_1400146A0.Timer = (PIO_TIMER)1;
  sub_1400160F8();
  stru_1400146A0.CurrentIrp = 0i64;
  sub_140016070();
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001558((__int64)off_140013400->AttachedDevice, 0xAu, (__int64)&unk_140012330);
  }
  v2 = NdisGetVersion();
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_1400015BC((__int64)off_140013400->AttachedDevice, 0xBu, (__int64)&unk_140012330, HIWORD(v2));
  }
  memset(&unk_140014600, 0, 0x98ui64);
  sub_14000FAAC();
  RtlInitUnicodeString(&DestinationString, L"NNSNAHSL");
  RtlInitUnicodeString(&v12, L"Network Activity Hook Server - LightWeight Filter");
  RtlInitUnicodeString(&v13, L"{c98e08d2-c96c-4f43-947d-e63428be1bba}");
  *(_QWORD *)&stru_1400146A0.Queue.Wcb.NumberOfChannels = DriverObject;
  ExInitializeNPagedLookasideList(&Lookaside, 0i64, 0i64, Flags, 0x20ui64, 0x634C424Eu, 0);
  v3 = v13;
  FilterDriverCharacteristics.Header = (NDIS_OBJECT_HEADER)14680715;
  *(_QWORD *)&FilterDriverCharacteristics.Flags = 0i64;
  FilterDriverCharacteristics.CancelDirectOidRequestHandler = 0i64;
  FilterDriverCharacteristics.SetOptionsHandler = (SET_OPTIONS_HANDLER)sub_140004590;
  FilterDriverCharacteristics.AttachHandler = (FILTER_ATTACH_HANDLER)sub_1400026E0;
  FilterDriverCharacteristics.DetachHandler = (FILTER_DETACH_HANDLER)sub_1400031E0;
  FilterDriverCharacteristics.RestartHandler = (FILTER_RESTART_HANDLER)sub_140004670;
  FilterDriverCharacteristics.PauseHandler = (FILTER_PAUSE_HANDLER)sub_140003AA0;
  FilterDriverCharacteristics.SetFilterModuleOptionsHandler = (FILTER_SET_FILTER_MODULE_OPTIONS_HANDLER)sub_140005170;
  FilterDriverCharacteristics.OidRequestHandler = (FILTER_OID_REQUEST_HANDLER)sub_1400036A0;
  FilterDriverCharacteristics.OidRequestCompleteHandler = (FILTER_OID_REQUEST_COMPLETE_HANDLER)sub_140003910;
  FilterDriverCharacteristics.CancelOidRequestHandler = (FILTER_CANCEL_OID_REQUEST_HANDLER)sub_140003050;
  FilterDriverCharacteristics.SendNetBufferListsHandler = (FILTER_SEND_NET_BUFFER_LISTS_HANDLER)sub_140001690;
  FilterDriverCharacteristics.ReturnNetBufferListsHandler = (FILTER_RETURN_NET_BUFFER_LISTS_HANDLER)sub_140001A40;
  FilterDriverCharacteristics.SendNetBufferListsCompleteHandler = (FILTER_SEND_NET_BUFFER_LISTS_COMPLETE_HANDLER)sub_140001E70;
  FilterDriverCharacteristics.ReceiveNetBufferListsHandler = (FILTER_RECEIVE_NET_BUFFER_LISTS_HANDLER)sub_1400022B0;
  FilterDriverCharacteristics.DevicePnPEventNotifyHandler = (FILTER_DEVICE_PNP_EVENT_NOTIFY_HANDLER)sub_1400034B0;
  FilterDriverCharacteristics.NetPnPEventHandler = (FILTER_NET_PNP_EVENT_HANDLER)sub_140003590;
  *(_OWORD *)&FilterDriverCharacteristics.DirectOidRequestHandler = 0i64;
  FilterDriverCharacteristics.StatusHandler = (FILTER_STATUS_HANDLER)sub_1400051F0;
  v4 = v12;
  FilterDriverCharacteristics.CancelSendNetBufferListsHandler = (FILTER_CANCEL_SEND_HANDLER)sub_140003140;
  DriverObject->DriverUnload = (PDRIVER_UNLOAD)sub_1400053E0;
  FilterDriverCharacteristics.FriendlyName = v4;
  *(_DWORD *)&FilterDriverCharacteristics.MajorNdisVersion = 73222;
  FilterDriverCharacteristics.UniqueName = v3;
  FilterDriverCharacteristics.ServiceName = DestinationString;
  sub_14000CA98();
  KeInitializeSpinLock((PKSPIN_LOCK)&stru_1400146A0.Queue);
  stru_1400146A0.Queue.Wcb.DeviceRoutine = 0i64;
  *(_QWORD *)&stru_1400146A0.DeviceType = &stru_1400146A0.DeviceExtension;
  stru_1400146A0.DeviceExtension = &stru_1400146A0.DeviceExtension;
  v5 = NdisFRegisterFilterDriver(
         DriverObject,
         *(NDIS_HANDLE *)&stru_1400146A0.Queue.Wcb.NumberOfChannels,
         &FilterDriverCharacteristics,
         (PNDIS_HANDLE)&stru_1400146A0.Queue.Wcb.DeviceRoutine);
  v6 = v5;
  if ( v5 )
  {
    v7 = off_140013400;
    if ( off_140013400 == (PDEVICE_OBJECT)&off_140013400
      || !_bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
      || BYTE1(off_140013400->Timer) < 3u )
    {
      goto LABEL_26;
    }
    v8 = 12;
    v9 = v5;
    goto LABEL_25;
  }
  v6 = sub_14000121C();
  if ( !v6 )
  {
    sub_14000F510();
    goto LABEL_29;
  }
  NdisFDeregisterFilterDriver(stru_1400146A0.Queue.Wcb.DeviceRoutine);
  v7 = off_140013400;
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 3u )
  {
    v8 = 13;
    v9 = v6;
LABEL_25:
    sub_140001580((__int64)v7->AttachedDevice, v8, (__int64)&unk_140012330, v9);
  }
LABEL_26:
  if ( (unsigned int)sub_14000F090() )
  {
    sub_14000FEE4();
    sub_140010180();
  }
  sub_14000F468();
  ExDeleteNPagedLookasideList(&Lookaside);
  sub_140016000();
LABEL_29:
  if ( off_140013400 != (PDEVICE_OBJECT)&off_140013400
    && _bittest((const signed __int32 *)&off_140013400->Timer + 1, 0xAu)
    && BYTE1(off_140013400->Timer) >= 5u )
  {
    sub_140001580((__int64)off_140013400->AttachedDevice, 0xEu, (__int64)&unk_140012330, v6);
  }
  return v6;
}
// 1400134B0: using guessed type int dword_1400134B0;

//----- (0000000140017400) ----------------------------------------------------
NTSTATUS __stdcall DriverEntry(PDRIVER_OBJECT DriverObject, PUNICODE_STRING RegistryPath)
{
  _security_init_cookie();
  return sub_140017000(DriverObject);
}

// nfuncs=200 queued=146 decompiled=146 lumina nreq=0 worse=0 better=0
// ALL OK, 146 function(s) have been successfully decompiled
