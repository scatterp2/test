/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 sub_11008(UNICODE_STRING *a1, const wchar_t *a2, ...);
__int64 __fastcall sub_11088(__int64 a1, unsigned __int16 a2, __int64 a3);
__int64 __fastcall sub_110AC(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, int a6);
__int64 __fastcall sub_1112C(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_11190(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_11208(__int64 a1, __int64 a2, __int64 a3, __int16 a4, __int64 a5);
__int64 __fastcall sub_1135C(__int64 a1, char a2, __int64 *a3, __int64 a4);
NTSTATUS __stdcall DriverEntry(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath);
void __fastcall sub_119EC(struct _DEVICE_OBJECT *a1);
__int64 __fastcall sub_11F24(__int64 a1, IRP *a2);
__int64 sub_11F4C();
__int64 __fastcall sub_123DC(__int64 a1, IRP *a2);
__int64 __fastcall sub_12488(__int64 a1, IRP *a2);
void sub_12678();
void sub_128B4();
void sub_129FC();
__int64 sub_12AC4();
__int64 sub_12B64();
__int64 sub_12C24();
__int64 sub_12CC8();
__int64 sub_12D64(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
char __fastcall sub_12DA0(int a1, _DWORD *a2, _DWORD *a3, _DWORD *a4);
__int64 __fastcall sub_130B4(__int64 a1);
void __fastcall sub_13274(__int64 a1);
__int64 sub_13364();
__int64 sub_13AA4();
__int64 sub_13BC4();
__int64 __fastcall sub_13EA4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_13EE0(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_13F28(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_13F8C(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_14004(unsigned int a1, int *a2, __int64 *a3);
__int64 __fastcall sub_14694(__int64 a1);
__int64 __fastcall sub_14948(__int64 a1);
__int64 __fastcall sub_14AA8(__int64 a1);
__int64 __fastcall sub_14C10(__int64 *a1);
__int64 __fastcall sub_14D58(__int64 *a1);
__int64 __fastcall sub_14EA4(__int64 a1);
__int64 __fastcall sub_14FF4(__int64 a1);
__int64 __fastcall sub_15174(__int64 a1);
__int64 __fastcall sub_152D4(__int64 a1);
__int64 __fastcall sub_15444(int a1, __int64 a2);
__int64 __fastcall sub_156AC(_QWORD *a1);
__int64 __fastcall sub_15858(_QWORD *a1);
__int64 __fastcall sub_15A04(__int64 a1);
__int64 __fastcall sub_15B30(__int64 *a1);
__int64 __fastcall sub_15C8C(__int64 *a1);
__int64 __fastcall sub_15DF4(_QWORD *a1);
__int64 __fastcall sub_15FA0(__int64 a1);
__int64 __fastcall sub_1615C(unsigned int a1, __int64 a2);
__int64 __fastcall sub_16408(unsigned int a1, __int64 a2);
__int64 __fastcall sub_16730(__int64 a1);
__int64 __fastcall sub_16970(__int64 a1);
char __fastcall sub_16BDC(int a1);
char __fastcall sub_16CE8(int a1);
__int64 __fastcall sub_16D7C(int a1);
__int64 __fastcall sub_16F48(int a1);
__int64 __fastcall sub_17324(int a1, __int64 a2, int a3);
void __fastcall sub_176CC(__int64 a1);
__int64 __fastcall sub_178F0(int a1, int *a2);
__int64 __fastcall sub_17A28(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_17AC4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_17BF0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_17C3C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_17CBC(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_17D2C(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_17D8C(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_17DFC(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_17F9C(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_17FF0(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_18050(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_180C0(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_18210(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_18284(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_182DC(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_1835C(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_1842C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_18470(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_184C0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_18508(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_18578(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_185D8(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4);
__int64 __fastcall sub_18658(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_186B8(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 sub_18760(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_187E8(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_18848(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_188D8(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, char a5, char a6, const char *a7, const char *a8);
__int64 __fastcall sub_18A10(__int64 a1, __int64 a2, __int64 a3, const char *a4, char a5, char a6, const char *a7, const char *a8, const char *a9, const char *a10);
__int64 __fastcall sub_18BEC(__int64 a1, __int64 a2, __int64 a3, const char *a4, char a5, char a6, const char *a7, const char *a8, const char *a9, const char *a10, const char *a11);
__int64 __fastcall sub_18E14(int a1, __int64 a2, __int64 a3, __int64 a4, int *a5);
__int64 __fastcall sub_1928C(__int64 a1, __int64 a2, int a3, int a4, __int64 a5, __int64 a6, __int64 a7, __int64 a8);
__int64 __fastcall sub_196DC(__int64 a1);
__int64 __fastcall sub_1989C(__int64 a1);
__int64 sub_19A3C();
__int64 sub_19FA4();
__int64 __fastcall sub_1A1AC(void *Src); // idb
__int64 __fastcall sub_1A3B8(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_1A878(void *Src, int a2, int a3, __int64 a4);
char __fastcall sub_1AB80(int a1, __int64 a2);
__int64 __fastcall sub_1AD48(__int64 a1, _QWORD *a2);
__int64 __fastcall sub_1AF88(void *Src, _QWORD *a2, char *a3, _BYTE *a4, __int64 a5);
__int64 __fastcall sub_1B9C0(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_1BC78(__int64 a1, int a2);
__int64 __fastcall sub_1BEB4(__int64 a1, __int64 a2);
__int64 __fastcall sub_1C040(__int64 a1, __int64 a2);
__int64 __fastcall sub_1C45C(__int64 a1, __int64 a2, int a3, char a4);
char __fastcall sub_1C6B4(__int64 a1);
__int64 __fastcall sub_1C814(void *Src, int *a2, _QWORD *a3);
char __fastcall sub_1DD74(_QWORD *a1, char a2);
__int64 __fastcall sub_1DFC0(unsigned __int64 **a1, ULONG_PTR **a2, ULONG_PTR *a3, _QWORD *a4, __int64 a5, _DWORD *a6);
__int64 __fastcall sub_1E3E4(__int64 a1, __int64 a2);
__int64 __fastcall sub_1EBA4(__int64 a1, __int64 a2);
__int64 __fastcall sub_1F3EC(__int64 a1, int a2);
__int64 __fastcall sub_1F4D4(int a1, __int64 a2);
__int64 __fastcall sub_1F628(int a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_1F7D8(int a1, __int64 *a2);
char sub_1FCD0();
__int64 __fastcall sub_1FF60(_QWORD **a1);
void __fastcall sub_20018(__int64 a1);
__int64 __fastcall sub_200FC(__int64 a1, __int64 a2);
__int64 __fastcall sub_20238(__int64 a1);
__int64 __fastcall sub_206A8(__int64 a1, __int64 a2);
__int64 __fastcall sub_20B20(__int64 a1);
bool __fastcall sub_20DDC(__int64 a1, __int64 a2);
__int64 __fastcall sub_20F20(__int64 a1);
__int64 __fastcall sub_20FEC(void *Src, size_t MaxCount, unsigned __int64 a3);
__int64 __fastcall sub_212D0(_QWORD *a1);
__int64 __fastcall sub_21668(__int64 a1, char a2);
__int64 __fastcall sub_217FC(__int64 a1, char a2);
__int64 __fastcall sub_21920(unsigned __int64 *a1);
__int64 __fastcall sub_21CD8(_QWORD *a1, _QWORD *a2);
__int64 __fastcall sub_21E80(__int64 a1, __int64 *a2);
__int64 __fastcall sub_2209C(unsigned __int64 *a1);
__int64 __fastcall sub_22210(unsigned __int64 *a1);
__int64 __fastcall sub_22558(unsigned __int64 *a1);
__int64 __fastcall sub_22794(__int64 a1);
__int64 __fastcall sub_22984(__int64 a1);
__int64 __fastcall sub_22E04(__int64 a1);
__int64 __fastcall sub_2308C(__int64 a1, unsigned __int64 *a2);
__int64 __fastcall sub_23400(__int64 a1);
__int64 __fastcall sub_23544(__int64 a1, __int64 a2);
__int64 __fastcall sub_236DC(int a1, __int64 a2);
__int64 __fastcall sub_238E8(int a1, __int64 a2);
__int64 __fastcall sub_23B68(__int64 a1, const void *a2, unsigned int a3);
__int64 __fastcall sub_242A8(__int64 a1, const void *a2, unsigned int a3);
__int64 __fastcall sub_24A30(__int64 a1, const void *a2, unsigned int a3);
__int64 __fastcall sub_25110(__int64 a1, const void *a2, unsigned int a3);
__int64 __fastcall sub_25844(__int64 a1);
__int64 __fastcall sub_259F0(__int64 a1, __int64 a2);
__int64 __fastcall sub_26174(__int64 a1);
__int64 __fastcall sub_26348(ULONG_PTR BugCheckParameter2, __int64 a2, ULONG_PTR a3, __int64 a4, int a5, char a6, char a7, __int64 a8);
__int64 __fastcall sub_26500(ULONG_PTR BugCheckParameter2, __int64 a2, ULONG_PTR a3, __int64 a4, char a5, int a6, char a7, __int64 a8);
__int64 __fastcall sub_26644(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_2677C(_QWORD *a1, ULONG_PTR a2, ULONG_PTR a3, _QWORD *a4, int a5, _BYTE *a6);
__int64 __fastcall sub_26B9C(__int64 *a1);
__int64 __fastcall sub_26E24(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_26F64(_QWORD *a1, char a2, __int64 a3, ULONG_PTR *a4, ULONG_PTR **a5, __int64 *a6, _QWORD *a7, _DWORD *a8);
__int64 __fastcall sub_274C4(__int64 a1);
__int64 __fastcall sub_275B8(__int64 a1);
__int64 __fastcall sub_2793C(__int64 a1);
__int64 __fastcall sub_27BC8(__int64 a1);
__int64 __fastcall sub_27C7C(int a1, __int64 a2, int a3, __int64 a4, _DWORD *a5);
void __fastcall sub_27EEC(__int64 a1);
__int64 sub_28704(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_28788(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_287EC();
__int64 __fastcall sub_28AF8(int a1, unsigned __int64 **a2);
__int64 __fastcall sub_29054(__int64 a1);
__int64 __fastcall sub_29340(unsigned __int64 *a1);
__int64 __fastcall sub_294BC(_QWORD *a1);
__int64 __fastcall sub_29774(unsigned __int64 *a1);
__int64 __fastcall sub_29A20(unsigned __int64 *a1);
__int64 __fastcall sub_29B68(_QWORD *a1);
__int64 __fastcall sub_29CC8(__int64 a1);
__int64 __fastcall sub_2A134(__int64 a1);
__int64 __fastcall sub_2A390(unsigned __int64 *a1);
__int64 __fastcall sub_2A5C4(unsigned __int64 *a1);
__int64 __fastcall sub_2A78C(unsigned __int64 *a1);
__int64 __fastcall sub_2A938(unsigned __int64 *a1);
__int64 __fastcall sub_2ABC4(unsigned __int64 *a1);
__int64 __fastcall sub_2AD1C(_QWORD *a1);
__int64 __fastcall sub_2AF24(__int64 a1, __int64 a2);
__int64 __fastcall sub_2B1E8(__int64 a1, __int64 a2);
__int64 __fastcall sub_2B324(__int64 a1, unsigned int a2, const void *a3, unsigned int a4);
__int64 __fastcall sub_2B4D4(__int64 a1, __int64 a2);
__int64 __fastcall sub_2B6DC(__int64 a1);
__int64 __fastcall sub_2B7E4(int a1, __int64 a2, __int64 a3, __int64 **a4);
__int64 __fastcall sub_2B978(__int64 a1);
__int64 __fastcall sub_2BA9C(__int64 a1, __int64 a2);
__int64 __fastcall sub_2BD54(__int64 a1, unsigned int a2);
__int64 __fastcall sub_2BEE0(__int64 a1, __int64 a2);
__int64 __fastcall sub_2C064(__int64 a1);
__int64 __fastcall sub_2C1F8(__int64 a1, __int64 a2);
__int64 __fastcall sub_2C2F8(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_2C470(__int64 a1);
__int64 __fastcall sub_2C5B4(__int64 a1, __int64 a2, unsigned int a3);
__int64 __fastcall sub_2C728(__int64 a1, __int64 a2);
__int64 __fastcall sub_2CB70(__int64 a1, __int64 *a2, _DWORD *a3);
__int64 __fastcall sub_2CDB0(__int64 a1, __int64 a2, int a3);
__int64 sub_2CF4C();
__int64 __fastcall sub_2D13C(_QWORD *a1, _QWORD *a2);
__int64 __fastcall sub_2D2C8(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_2D348(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_2D3E0(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 sub_2D478(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_2D530(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_2D598(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 sub_2D608(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_2D678(__int16 a1);
__int64 __fastcall sub_2D968(__int64 a1);
char __fastcall sub_2DB00(int a1, unsigned __int16 a2, _DWORD *a3);
char __fastcall sub_2DC18(int a1, unsigned __int16 a2, __int64 a3);
__int64 __fastcall sub_2E098(int a1, unsigned __int16 a2, __int64 a3);
__int16 __fastcall sub_2E198(int a1, __int64 a2, __int64 a3);
char __fastcall sub_2E274(__int64 a1, int a2, int a3);
__int64 *__fastcall sub_2E39C(void *Src, unsigned int a2);
__int64 __fastcall sub_2E5FC(__int64 a1);
char __fastcall sub_2E71C(__int64 a1, __int64 a2);
__int64 __fastcall sub_2E830(__int64 a1);
__int16 __fastcall sub_2E94C(__int64 a1);
__int64 __fastcall sub_2EA7C(__int64 a1);
void **__fastcall sub_2EB7C(__int64 a1);
__int64 __fastcall sub_2EC90(__int64 a1);
__int64 __fastcall sub_2EEA0(void *Src, size_t MaxCount, __int64 a3, struct _KMUTANT *a4);
__int64 __fastcall sub_2F1DC(__int64 a1);
char __fastcall sub_2F2E0(__int64 a1);
__int64 *__fastcall sub_2F4D0(void *Src, unsigned int a2);
__int64 __fastcall sub_2F868(__int64 a1, const void *a2, unsigned __int16 a3, int a4, int a5, unsigned __int16 a6, unsigned __int8 a7);
__int64 __fastcall sub_2FDFC(__int64 a1, __int16 a2);
__int64 __fastcall sub_2FEB4(_DWORD *a1, int a2, int a3, unsigned __int16 a4);
__int64 __fastcall sub_30114(__int64 a1, int a2, __int64 a3, unsigned int a4, int a5, int a6, unsigned __int16 a7);
__int64 __fastcall sub_3068C(_QWORD *a1);
__int64 __fastcall sub_308B0(_QWORD *a1);
__int64 __fastcall sub_309F0(__int64 a1);
__int64 __fastcall sub_30B80(__int64 a1, __int64 a2);
__int64 __fastcall sub_30DA0(__int64 a1, char a2, unsigned __int16 a3);
__int64 sub_30E8C(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_30F10(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_30F74(_QWORD *a1, _QWORD *a2);
__int64 __fastcall sub_3112C(_QWORD *a1, __int64 *a2);
__int64 __fastcall sub_31508(_QWORD *a1, __int64 *a2);
__int64 __fastcall sub_318E8(__int64 a1, __int64 *a2);
__int64 __fastcall sub_31BA0(__int64 a1, __int64 a2);
__int64 __fastcall sub_31D84(__int64 a1, __int64 *a2);
__int64 __fastcall sub_3236C(__int64 a1, __int64 a2);
__int64 __fastcall sub_3264C(__int64 a1, __int64 *a2);
__int64 __fastcall sub_32908(__int64 a1, __int64 a2);
__int64 __fastcall sub_32B84(__int64 a1);
__int64 __fastcall sub_32D38(__int64 a1);
__int64 __fastcall sub_32E7C(__int64 a1);
__int64 __fastcall sub_32FC0(__int64 a1, unsigned __int64 a2);
char __fastcall sub_33508(__int64 a1, int *a2);
char __fastcall sub_33674(__int64 a1, _DWORD *a2);
char __fastcall sub_337DC(__int64 a1, int *a2);
__int64 __fastcall sub_33960(__int64 a1);
__int64 __fastcall sub_33A70(__int64 a1, char a2);
__int64 __fastcall sub_33B4C(__int64 a1);
__int64 sub_33D34(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_33DA4(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_33EAC(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_33F1C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_33F70(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_33FC4(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_34028(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_340AC(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_34100(__int64 a1, __int64 a2, __int64 a3, const char *a4, const char *a5, const char *a6, const char *a7);
__int64 sub_34250(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_342A4(__int64 a1, _QWORD ***a2);
__int64 __fastcall sub_34398(_QWORD *a1);
__int64 __fastcall sub_3464C(__int64 a1, _QWORD *a2);
__int64 __fastcall sub_34890(__int64 **a1, _QWORD *a2);
__int64 __fastcall sub_357AC(__int64 **a1, __int64 a2);
__int64 __fastcall sub_35D44(__int64 **a1, __int64 a2, _DWORD *a3, __int64 **a4);
__int64 __fastcall sub_35E4C(__int64 **a1, __int64 a2, _DWORD *a3);
__int64 __fastcall sub_35F38(__int64 a1, _QWORD *a2);
__int64 __fastcall sub_36880(__int64 **a1, __int64 a2, _DWORD *a3);
__int64 __fastcall sub_3696C(unsigned int a1, unsigned int a2, const void *a3, __int64 a4, _DWORD *a5);
__int64 __fastcall sub_36A5C(_QWORD *a1, int a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_36E40(__int64 a1, unsigned int a2, __int64 a3);
__int64 __fastcall sub_36FA0(__int64 *a1, __int64 a2, int a3, __int64 a4);
bool __fastcall sub_37138(int a1, __int64 a2);
__int64 __fastcall sub_37238(__int64 a1, char a2, char *a3, int *a4, int *a5);
__int64 __fastcall sub_373D0(__int64 a1, __int64 a2);
__int64 __fastcall sub_3756C(__int64 a1, int *a2, _BYTE *a3, int *a4, int *a5, char *a6, int *a7, char a8);
__int64 __fastcall sub_37E18(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_37FC0(__int64 a1);
char __fastcall sub_38428(__int64 a1, int a2);
__int64 __fastcall sub_384E8(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_3854C(int a1, _DWORD *a2);
__int64 sub_386DC();
__int64 __fastcall sub_387F0(__int64 a1);
__int64 __fastcall sub_389E8(_DWORD *a1);
__int64 __fastcall sub_38B9C(_DWORD *a1, _DWORD *a2);
__int64 __fastcall sub_38CE4(PVOID *a1);
__int64 __fastcall sub_38DDC(int a1, _DWORD *a2);
__int64 sub_39014(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_3906C(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_39144(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_39198(int a1, __int64 *a2);
__int64 __fastcall sub_39368(__int64 a1);
__int64 __fastcall sub_39488(_BYTE *a1, const void *a2, unsigned int a3);
__int64 __fastcall sub_3973C(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_39990(__int64 a1, _QWORD *a2);
__int64 __fastcall sub_39AE4(__int64 a1);
__int64 __fastcall sub_39D80(__int64 a1);
__int64 __fastcall sub_3A1DC(__int64 a1);
__int64 __fastcall sub_3A314(void *Dst, __int64 a2, const void *a3);
__int64 __fastcall sub_3A430(__int64 a1, __int64 a2, const void *a3, unsigned int a4);
void __fastcall sub_3A5F8(__int64 a1);
void __fastcall sub_3A754(__int64 a1);
__int64 __fastcall sub_3A8B8(void *Src, size_t MaxCount, int a3, __m128i *a4, __int64 a5);
__int64 __fastcall sub_3ABA0(__int64 a1);
__int64 __fastcall sub_3AC88(int a1, __int64 a2, int a3, _DWORD *a4, void **a5, _DWORD *a6);
__int64 __fastcall sub_3AE08(_QWORD *a1, unsigned int a2, _DWORD *a3);
__int64 __fastcall sub_3B050(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_3B104(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_3B178(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, const char *a5);
__int64 __fastcall sub_3B228(_QWORD *a1);
__int64 sub_3B75C();
__int64 __fastcall sub_3B910(__int64 a1);
__int64 __fastcall sub_3BA20(unsigned __int8 *a1, char a2, const void *a3, int a4, ULONG_PTR **a5, _DWORD *a6);
__int64 __fastcall sub_3BDD8(unsigned __int8 *a1, _QWORD *a2, _DWORD *a3);
__int64 __fastcall sub_3BF50(ULONG_PTR BugCheckParameter1); // idb
__int64 __fastcall sub_3C004(__int64 a1, const void *a2, int a3);
__int64 sub_3C1B8();
__int64 __fastcall sub_3C46C(__int64 a1, unsigned __int16 a2);
PVOID __fastcall sub_3C4EC(int a1, unsigned int a2, ULONG a3);
void __fastcall sub_3C570(PVOID P, ULONG Tag);
PVOID __fastcall sub_3C5E4(int a1, void *a2, unsigned int a3, unsigned int a4, ULONG Tag);
char *__fastcall sub_3C76C(int a1, unsigned int a2, ULONG a3);
void __fastcall sub_3C7F0(PVOID P);
_DWORD *__fastcall sub_3C910(__int64 a1);
void __fastcall sub_3C978(__int64 a1, __int64 a2);
__int64 __fastcall sub_3CAA4(PERESOURCE Resource); // idb
__int64 __fastcall sub_3CB78(PERESOURCE Resource); // idb
BOOLEAN __fastcall sub_3CC4C(PERESOURCE Resource);
BOOLEAN __fastcall sub_3CD24(PERESOURCE Resource);
void __fastcall sub_3CDFC(PERESOURCE Resource);
__int64 __fastcall sub_3CEC8(_QWORD *a1);
void __fastcall sub_3CF30(PKSPIN_LOCK SpinLock, KIRQL *a2);
void __fastcall sub_3CFA8(PKSPIN_LOCK SpinLock, KIRQL a2);
bool __fastcall sub_3D01C(struct _KEVENT **a1, char a2);
void __fastcall sub_3D094(PVOID P);
int __fastcall sub_3D0FC(PRKEVENT Event);
int __fastcall sub_3D164(PRKEVENT Event);
void __fastcall sub_3D230(__int64 a1);
void __fastcall sub_3D310(PFAST_MUTEX FastMutex);
void __fastcall sub_3D3DC(PFAST_MUTEX FastMutex);
__int64 __fastcall sub_3D4A8(unsigned int a1);
__int64 __fastcall sub_3D510(PVOID P); // idb
_QWORD *__fastcall sub_3D584(__int64 a1, int a2, __int64 a3, __int64 a4);
void __fastcall sub_3D714(__int64 a1);
void __fastcall sub_3D780(__int64 a1);
void __fastcall sub_3D7EC(__int64 a1, unsigned int a2);
__int64 __fastcall sub_3D860(PVOID Object); // idb
__int64 __fastcall sub_3D8CC(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_3D95C(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_3D9F8(__int64 a1, __int64 a2, __int64 a3, int a4);
PVOID __fastcall sub_3DA88(int a1, unsigned int a2, ULONG a3);
void __fastcall sub_3DBA4(PVOID P, ULONG Tag);
char *__fastcall sub_3DC9C(int a1, unsigned int a2, ULONG a3);
_DWORD *__fastcall sub_3DE50(__int64 a1);
__int64 __fastcall sub_3DF54(_QWORD *a1);
void __fastcall sub_3DFD8(PKSPIN_LOCK SpinLock, KIRQL *a2);
void __fastcall sub_3E090(PKSPIN_LOCK SpinLock, KIRQL a2);
bool __fastcall sub_3E134(struct _KEVENT **a1, char a2);
void __fastcall sub_3E21C(PVOID P);
int __fastcall sub_3E2B4(PRKEVENT Event);
void __fastcall HandleInformation(PVOID StartContext);
unsigned __int8 __fastcall sub_3E3E0(PVOID *Object, __int64 a2, __int64 (__fastcall *a3)(void ***a1));
__int64 __fastcall sub_3E548(PVOID Object); // idb
__int64 __fastcall sub_3E5DC(void ***a1);
__int64 __fastcall sub_3E8E8(unsigned int a1, char a2);
__int64 __fastcall sub_3EB9C(PVOID P); // idb
void __fastcall sub_3EEF8(__int64 a1, char a2);
void __fastcall sub_3EFBC(__int64 a1, unsigned int a2);
__int64 __fastcall sub_3F0C8(PVOID Object); // idb
__int64 __fastcall sub_3F170(ULONG Count, PVOID Object[]); // idb
void __fastcall DeferredRoutine(_KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2);
__int64 sub_3F2B0();
__int64 sub_3F3E4(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_3F444();
__int64 __fastcall sub_3F614(ULONG a1, __int64 *a2, int a3, void (__fastcall *a4)(__int64 *));
__int64 __fastcall sub_3F7C8(__int64 *a1, void (__fastcall *a2)(__int64 *));
__int64 __fastcall sub_3F8DC(__int64 a1, void (__fastcall *a2)(__int64 *));
__int64 __fastcall sub_3FA20(int *a1, __int64 a2);
__int64 __fastcall sub_3FC70(int *a1, _DWORD *a2);
__int64 __fastcall sub_3FEC8(int *a1, _DWORD *a2, _QWORD *a3);
__int64 __fastcall sub_400AC(__int64 a1, __int64 a2, __int64 a3, const wchar_t *a4);
__int64 __fastcall sub_4015C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_401BC(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_40228(__int16 *a1, int a2, unsigned int *a3);
__int64 __fastcall sub_403FC(char a1);
__int64 __fastcall sub_40498(int a1, int a2);
__int64 __fastcall sub_40678(int a1, __int64 a2);
__int64 sub_4086C();
__int64 __fastcall sub_40A2C(int a1, const void *a2, unsigned int a3, int a4, int *a5);
__int64 __fastcall sub_40C80(int a1, const void *a2, unsigned int a3, int a4, int *a5, void (__fastcall *a6)(const void *, _QWORD, PVOID, _QWORD, const void *, unsigned int));
__int64 __fastcall sub_40E90(unsigned int a1, __int64 a2);
__int64 sub_40FE0();
__int64 sub_41250();
__int64 __fastcall sub_414D8(int a1);
__int64 sub_4189C();
__int64 sub_42000();
__int64 __fastcall sub_42360(int a1, const void *a2, unsigned int a3, int a4, int *a5);
__int64 __fastcall sub_42684(int a1, const void *a2, unsigned int a3, int a4, int *a5, void (__fastcall *a6)(const void *, _QWORD, PVOID, _QWORD, const void *, unsigned int));
__int64 __fastcall sub_42BFC(int a1, const void *a2, unsigned int a3, _DWORD *a4);
__int64 __fastcall sub_42E50(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_430A8(unsigned int *a1);
__int64 __fastcall sub_43204(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_432F0(__int64 a1, int a2, unsigned int a3, void *a4);
__int64 __fastcall sub_434EC(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_43760(__int64 a1, __int64 a2, __int64 a3);
__int64 sub_43A78();
__int64 __fastcall sub_43B68(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_43D48(int a1);
__int64 sub_43E38();
__int64 sub_44024();
__int64 __fastcall sub_4421C(int a1, const void *a2, unsigned int a3);
__int64 __fastcall sub_44528(__int64 a1, __int64 a2, __int64 a3);
__int64 sub_446CC();
__int64 __fastcall sub_447C4(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_44834(__int64 a1, __int64 a2, _QWORD *a3);
__int64 sub_44D2C();
__int64 (**sub_45074())(void);
void sub_451A0();
__int64 __fastcall sub_4535C(unsigned int a1);
__int64 __fastcall sub_455C8(__int64 a1);
__int64 sub_45B80();
__int64 __fastcall sub_4624C(unsigned int a1, int a2, unsigned int a3, _DWORD *a4);
__int64 __fastcall sub_46844(__int64 a1, unsigned int a2, __int64 a3);
__int64 __fastcall sub_46C08(int a1);
__int64 __fastcall sub_46D64(int a1);
bool __fastcall sub_46E8C(__int64 a1);
char __fastcall sub_46EF0(PFAST_MUTEX FastMutex);
char __fastcall sub_46F50(PFAST_MUTEX FastMutex);
char __fastcall sub_46FB0(PFAST_MUTEX FastMutex);
char __fastcall sub_47018(PFAST_MUTEX FastMutex);
__int64 __fastcall sub_4707C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_470D8(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_47148(int a1, _QWORD *a2);
__int64 __fastcall sub_472EC(int a1, __int64 a2);
__int64 __fastcall sub_4744C(int a1, struct _FAST_MUTEX *a2, KIRQL *a3);
__int64 __fastcall sub_47510(int a1, struct _FAST_MUTEX *a2, KIRQL a3);
__int64 __fastcall sub_475A4(__int64 a1, __int64 a2, char a3);
__int64 __fastcall sub_476D0(__int64 a1, __int64 a2, char a3);
_DWORD *__fastcall sub_477F4(unsigned __int8 a1, __int64 a2, int a3, ULONG a4, __int64 a5, __int64 a6, __int64 a7, __int64 a8, __int64 a9, __int64 a10, _DWORD *a11);
__int64 __fastcall sub_47B3C(ULONG_PTR BugCheckParameter2); // idb
unsigned __int64 __fastcall sub_47FC8(__int64 a1, unsigned __int64 a2, _DWORD *a3);
_DWORD *__fastcall sub_480C4(__int64 a1, __int64 a2, _DWORD *a3);
__int64 __fastcall sub_4824C(__int64 a1, unsigned int a2, __int64 *a3);
__int64 __fastcall sub_48448(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_485C8(__int64 a1, __int64 a2);
__int64 __fastcall sub_487F8(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_488F0(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4);
__int64 __fastcall sub_48B2C(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, _DWORD *a4);
__int64 __fastcall sub_48DB0(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, __int64 a3, _DWORD *a4);
__int64 __fastcall sub_49034(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, _QWORD *a3, _DWORD *a4);
_QWORD *__fastcall sub_49228(__int64 a1, unsigned int a2, __int64 a3, _DWORD *a4);
ULONG_PTR __fastcall sub_493E8(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4, __int64 a5);
__int64 __fastcall sub_49870(ULONG_PTR BugCheckParameter2, ULONG_PTR *a2, _DWORD *a3);
__int64 __fastcall sub_49A3C(ULONG_PTR BugCheckParameter2, ULONG_PTR *a2, __int64 a3, _DWORD *a4);
__int64 __fastcall sub_49CF0(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1); // idb
__int64 __fastcall sub_49E94(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3);
__int64 __fastcall sub_49FD8(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3);
char __fastcall sub_4A154(_BYTE *a1, _DWORD *a2);
char __fastcall sub_4A2A0(_BYTE *a1, _DWORD *a2);
char __fastcall sub_4A3EC(_BYTE *a1, _DWORD *a2);
__int64 __fastcall sub_4A538(int a1);
__int64 __fastcall sub_4A5D8(unsigned int a1);
char __fastcall sub_4A708(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1);
const char *__fastcall sub_4A760(int a1);
const char *__fastcall sub_4A7C4(unsigned int a1);
const char *__fastcall sub_4A83C(int a1);
__int64 __fastcall sub_4A914(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_4AA58(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5, const char *a6);
__int64 __fastcall sub_4AB20(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_4AB78(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, const char *a5);
__int64 sub_4AC00(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_4AC4C(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_4ACE4(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_4AD64(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_4ADC8(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
_BYTE *__fastcall sub_4AE28(__int64 a1, int a2);
__int64 __fastcall sub_4B3A0(__int64 a1, unsigned int a2, __int64 *a3);
__int64 __fastcall sub_4B914(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_4BAA4(__int64 a1, __int64 a2);
__int64 __fastcall sub_4BB5C(__int64 a1, __int64 a2);
__int64 __fastcall sub_4BC10(__int64 a1, _WORD *a2);
__int64 __fastcall sub_4BCD4(_BYTE *a1, _BYTE *a2);
__int64 __fastcall sub_4BD84(_BYTE *a1, _BYTE *a2);
__int64 __fastcall sub_4BE34(__int64 a1, _WORD *a2);
__int64 __fastcall sub_4BEF8(__int64 a1, _WORD *a2);
__int64 __fastcall sub_4BFBC(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_4C06C(__int64 a1, _WORD *a2);
__int64 __fastcall sub_4C138(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_4C1E8(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_4C298(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_4C35C(__int64 a1, unsigned __int8 *a2, _QWORD *a3);
char __fastcall sub_4C620(__int64 a1);
__int64 __fastcall sub_4C7F4(__int64 a1, unsigned __int16 *a2);
__int64 __fastcall sub_4C8BC(__int64 a1, unsigned __int8 *a2);
__int64 __fastcall sub_4C970(__int64 a1, __m128i *a2);
__int64 __fastcall sub_4CA24(__int64 a1, __m128i *a2);
__int64 __fastcall sub_4CB80(_BYTE *a1, __m128i *a2);
__int64 __fastcall sub_4CFEC(_WORD *a1, _WORD *a2);
__int64 __fastcall sub_4D0B0(__int64 a1, _WORD *a2);
__int64 __fastcall sub_4D174(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_4D258(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_4D33C(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_4D3EC(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_4D4A8(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_4D558(__int64 a1, _WORD *a2);
__int64 __fastcall sub_4D61C(__int64 a1, _WORD *a2);
__int64 __fastcall sub_4D6E0(__int64 a1, __int64 a2, _WORD *a3);
__int64 __fastcall sub_4D8E4(unsigned __int8 a1, __int64 a2);
__int64 __fastcall sub_4DBC8(__int64 a1, unsigned __int8 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_4DEEC(__int64 a1, _BYTE *a2, _BYTE *a3);
__int64 __fastcall sub_4E0CC(_WORD *a1, _WORD *a2);
__int64 __fastcall sub_4E190(__int64 a1, _WORD *a2);
__int64 __fastcall sub_4E254(__int64 a1, _WORD *a2);
__int64 __fastcall sub_4E318(__int64 a1, _WORD *a2);
__int64 __fastcall sub_4E3DC(__int64 a1, unsigned __int8 *a2);
__int64 __fastcall sub_4E4D0(__int64 a1, unsigned __int8 *a2);
__int64 __fastcall sub_4E5C0(__int64 a1, unsigned __int16 a2);
__int64 __fastcall sub_4E684(__int64 a1, unsigned __int16 a2);
__int64 __fastcall sub_4E748(__int64 a1, unsigned __int8 a2);
__int64 __fastcall sub_4E800(__int64 a1);
__int64 __fastcall sub_4E8A4(__int64 a1, unsigned __int16 a2);
__int64 __fastcall sub_4E968(__int64 a1, unsigned int a2);
__int64 __fastcall sub_4EA38(__int64 a1, unsigned int a2);
char __fastcall sub_4EB08(__int64 a1);
__int64 __fastcall sub_4EBC8(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_4ED5C(__int64 a1, unsigned int a2, unsigned __int16 *a3);
__int64 __fastcall sub_4EF74(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_4F1E4(__int64 a1, unsigned __int8 a2, unsigned __int64 *a3);
__int64 __fastcall sub_4F544(__int64 a1, int *a2);
__int64 __fastcall sub_4F85C(__int64 a1);
__int64 __fastcall sub_4FA5C(_WORD *a1, unsigned __int16 a2);
__int64 __fastcall sub_4FB20(__int64 a1, unsigned __int16 a2);
__int64 __fastcall sub_4FBE4(__int64 a1, int a2);
__int64 __fastcall sub_4FCC4(__int64 a1, int a2);
__int64 __fastcall sub_4FDA4(__int64 a1);
__int64 __fastcall sub_4FE4C(__int64 a1, unsigned __int8 a2);
__int64 __fastcall sub_4FEF8(__int64 a1, unsigned __int16 a2);
__int64 __fastcall sub_4FFBC(__int64 a1, unsigned __int16 a2);
__int64 __fastcall sub_50080(_WORD *a1, unsigned __int16 a2);
__int64 __fastcall sub_50144(__int64 a1, unsigned __int16 a2);
__int64 __fastcall sub_50208(__int64 a1, unsigned __int16 a2);
__int64 __fastcall sub_502CC(__int64 a1, unsigned __int16 a2);
__int16 __fastcall sub_50390(unsigned __int16 *a1);
__int64 __fastcall sub_50500(_BYTE *a1, bool *a2);
__int64 __fastcall sub_506E8(__int64 a1, bool *a2);
__int64 __fastcall sub_50870(__int64 a1, char a2, unsigned __int16 *a3);
unsigned __int16 __fastcall sub_50CA0(__int16 a1, unsigned __int16 *a2, __int16 a3, unsigned __int16 *a4, unsigned __int16 *a5, unsigned __int8 a6);
__int64 __fastcall sub_50E34(__int64 a1, _QWORD *a2, _WORD *a3);
__int64 __fastcall sub_510E8(__int64 a1, unsigned __int8 *a2, _QWORD *a3);
char __fastcall sub_512A0(__int64 a1);
__int64 __fastcall sub_51370(__int64 a1, _BYTE *a2);
char __fastcall sub_514FC(__int64 a1);
char __fastcall sub_51640(__int64 a1);
char __fastcall sub_51784(__int64 a1);
char __fastcall sub_518C8(__int64 a1);
char __fastcall sub_51A0C(__int64 a1);
char __fastcall sub_51B48(__int64 a1);
bool __fastcall sub_51C84(char a1, char *a2);
const char *__fastcall sub_51DCC(unsigned __int8 a1);
__int64 __fastcall sub_51EBC(__int64 a1, const void *a2, size_t a3);
__int64 __fastcall sub_5201C(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5);
__int64 __fastcall sub_520A8(__int64 a1, __int64 a2, __int64 a3, double a4);
__int64 __fastcall sub_5211C(__int64 a1, __int64 a2, __int64 a3, double a4);
char *__fastcall sub_52180(unsigned __int8 *a1, unsigned int a2);
__int64 __fastcall sub_5226C(double a1, int a2, double *a3);
__int64 __fastcall sub_523D8(__int64 a1, unsigned int a2);
__int64 sub_524E8();
void sub_5261C();
__int64 sub_52828();
__int64 sub_529D0();
__int64 __fastcall sub_52BC8(_DWORD *a1, __int64 a2);
__int64 sub_52E90();
__int64 __fastcall sub_52F2C(__int64 a1);
int __fastcall sub_53044(__int64 a1);
__int64 __fastcall sub_531B8(_QWORD *a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_5339C(__int64 a1, __int64 a2, int a3);
__int64 __fastcall sub_53568(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall sub_53750(_QWORD *a1, _QWORD *a2);
void __fastcall sub_538D4(PVOID P);
__int64 __fastcall sub_53944(__int64 a1, __int64 a2);
__int64 __fastcall sub_53988(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, void *Src);
__int64 __fastcall sub_53AE8(char *a1, unsigned __int64 a2, unsigned __int16 *a3, int *a4);
__int64 sub_53B40(char *a1, unsigned __int64 a2, unsigned __int16 *a3, ...);
__int64 __fastcall sub_53B64(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4);
__int64 sub_53BB4(char *a1, unsigned __int64 a2, CHAR *a3, ...);
__int64 __fastcall sub_53BD8(void *a1, size_t a2, const void *a3, size_t a4);
__int64 __fastcall sub_53C7C(char *a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int16 *a4, int *a5);
__int64 sub_53D24(char *a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int16 *a4, ...);
_WORD *__fastcall sub_53D48(__int16 a1, __int64 a2, _DWORD *a3);
_WORD *__fastcall sub_53D98(__int16 *a1, int a2, __int64 a3, _DWORD *a4);
__int64 __fastcall sub_53DF8(__int64 a1, unsigned __int16 *a2, int *a3);
__int64 __fastcall sub_546DC(char *a1, unsigned __int64 a2, unsigned __int16 *a3, int *a4);
// __int64 __fastcall write_char(_QWORD, _QWORD, _QWORD); weak
// __int64 __fastcall write_multi_char(_QWORD, _QWORD, _QWORD, _QWORD); weak
__int64 __fastcall sub_54898(_BYTE *a1, int a2, __int64 a3, _DWORD *a4);
__int64 __fastcall sub_54908(__int64 a1, CHAR *a2, __int64 a3);
__int64 __fastcall sub_551D8(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4);
// int __cdecl flsbuf(int Ch, FILE *File);
// NTSTATUS __stdcall RtlWideCharArrayVPrintfWorker(wchar_t *pszDest, size_t cchDest, size_t *pcchNewDestLength, NTSTRSAFE_PCWSTR pszFormat, va_list argList);
// NTSTATUS __stdcall RtlUnicodeStringValidateDestWorker(PCUNICODE_STRING DestinationString, wchar_t **ppszDest, size_t *pcchDest, size_t *pcchDestLength, const size_t cchMax, ULONG dwFlags);
__int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // weak
// void *__cdecl memmove(void *Dst, const void *Src, size_t MaxCount);
// void *__cdecl memset(void *Dst, int Val, size_t Size);
// int __cdecl mbtowc(wchar_t *DstCh, const char *SrcCh, size_t SrcSizeInBytes);
// NTSTATUS __stdcall RtlUnicodeToMultiByteN(PCHAR MultiByteString, ULONG MaxBytesInMultiByteString, PULONG BytesInMultiByteString, PCWCH UnicodeString, ULONG BytesInUnicodeString);
__int64 __fastcall sub_5649C(_WORD *a1, __int64 a2, __int16 *a3);
// void __stdcall KeStallExecutionProcessor(ULONG MicroSeconds);
// LARGE_INTEGER __stdcall KeQueryPerformanceCounter(PLARGE_INTEGER PerformanceFrequency);
// void __stdcall ExFreePoolWithTag(PVOID P, ULONG Tag);
// NTSTATUS __stdcall IoWMIWriteEvent(PVOID WnodeEventItem);
// void __stdcall KeInitializeMutex(PRKMUTEX Mutex, ULONG Level);
// void __stdcall RtlInitUnicodeString(PUNICODE_STRING DestinationString, PCWSTR SourceString);
// void __stdcall IoDeleteDevice(PDEVICE_OBJECT DeviceObject);
// PVOID __stdcall MmGetSystemRoutineAddress(PUNICODE_STRING SystemRoutineName);
// NTSTATUS __stdcall IoGetDeviceObjectPointer(PUNICODE_STRING ObjectName, ACCESS_MASK DesiredAccess, PFILE_OBJECT *FileObject, PDEVICE_OBJECT *DeviceObject);
// void __stdcall IofCompleteRequest(PIRP Irp, CCHAR PriorityBoost);
// SIZE_T __stdcall RtlCompareMemory(const void *Source1, const void *Source2, SIZE_T Length);
// LONG_PTR __stdcall ObfDereferenceObject(PVOID Object);
// NTSTATUS __stdcall IoCreateDevice(PDRIVER_OBJECT DriverObject, ULONG DeviceExtensionSize, PUNICODE_STRING DeviceName, ULONG DeviceType, ULONG DeviceCharacteristics, BOOLEAN Exclusive, PDEVICE_OBJECT *DeviceObject);
// NTSTATUS __stdcall IofCallDriver(PDEVICE_OBJECT DeviceObject, PIRP Irp);
// LONG __stdcall KeReleaseMutex(PRKMUTEX Mutex, BOOLEAN Wait);
// NTSTATUS __stdcall KeWaitForSingleObject(PVOID Object, KWAIT_REASON WaitReason, KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Timeout);
// NTSTATUS __stdcall KeDelayExecutionThread(KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Interval);
// void KeLeaveCriticalRegion(void);
// void KeEnterCriticalRegion(void);
// void __stdcall __noreturn KeBugCheckEx(ULONG BugCheckCode, ULONG_PTR BugCheckParameter1, ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter3, ULONG_PTR BugCheckParameter4);
// BOOLEAN __stdcall ExAcquireResourceExclusiveLite(PERESOURCE Resource, BOOLEAN Wait);
// void __stdcall KeClearEvent(PRKEVENT Event);
// LONG __stdcall KeResetEvent(PRKEVENT Event);
// void __stdcall ExReleaseFastMutex(PFAST_MUTEX FastMutex);
// void __stdcall ExInitializeNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside, PALLOCATE_FUNCTION Allocate, PFREE_FUNCTION Free, ULONG Flags, SIZE_T Size, ULONG Tag, USHORT Depth);
// void __stdcall ExAcquireFastMutex(PFAST_MUTEX FastMutex);
// LONG __stdcall KeSetEvent(PRKEVENT Event, KPRIORITY Increment, BOOLEAN Wait);
// PSLIST_ENTRY __stdcall ExpInterlockedPushEntrySList(PSLIST_HEADER ListHead, PSLIST_ENTRY ListEntry);
// void __stdcall KeInitializeEvent(PRKEVENT Event, EVENT_TYPE Type, BOOLEAN State);
// void __stdcall KeReleaseSpinLock(PKSPIN_LOCK SpinLock, KIRQL NewIrql);
// PSLIST_ENTRY __stdcall ExpInterlockedPopEntrySList(PSLIST_HEADER ListHead);
// void __stdcall KeReleaseSpinLockFromDpcLevel(PKSPIN_LOCK SpinLock);
// PIRP __stdcall IoBuildDeviceIoControlRequest(ULONG IoControlCode, PDEVICE_OBJECT DeviceObject, PVOID InputBuffer, ULONG InputBufferLength, PVOID OutputBuffer, ULONG OutputBufferLength, BOOLEAN InternalDeviceIoControl, PKEVENT Event, PIO_STATUS_BLOCK IoStatusBlock);
// void __stdcall ExDeletePagedLookasideList(PPAGED_LOOKASIDE_LIST Lookaside);
// NTSTATUS __stdcall PsCreateSystemThread(PHANDLE ThreadHandle, ULONG DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, HANDLE ProcessHandle, PCLIENT_ID ClientId, PKSTART_ROUTINE StartRoutine, PVOID StartContext);
// NTSTATUS __stdcall PsTerminateSystemThread(NTSTATUS ExitStatus);
// BOOLEAN __stdcall ExAcquireResourceSharedLite(PERESOURCE Resource, BOOLEAN Wait);
// void __stdcall ExReleaseResourceLite(PERESOURCE Resource);
// NTSTATUS __stdcall ZwClose(HANDLE Handle);
// USHORT __stdcall ExQueryDepthSList(PSLIST_HEADER SListHead);
// NTSTATUS __stdcall ObReferenceObjectByHandle(HANDLE Handle, ACCESS_MASK DesiredAccess, POBJECT_TYPE ObjectType, KPROCESSOR_MODE AccessMode, PVOID *Object, POBJECT_HANDLE_INFORMATION HandleInformation);
// NTSTATUS __stdcall ExDeleteResourceLite(PERESOURCE Resource);
// void __stdcall ExInitializePagedLookasideList(PPAGED_LOOKASIDE_LIST Lookaside, PALLOCATE_FUNCTION Allocate, PFREE_FUNCTION Free, ULONG Flags, SIZE_T Size, ULONG Tag, USHORT Depth);
// NTSTATUS __stdcall ExInitializeResourceLite(PERESOURCE Resource);
// NTSTATUS __stdcall KeWaitForMultipleObjects(ULONG Count, PVOID Object[], WAIT_TYPE WaitType, KWAIT_REASON WaitReason, KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Timeout, PKWAIT_BLOCK WaitBlockArray);
// void __stdcall KeAcquireSpinLockAtDpcLevel(PKSPIN_LOCK SpinLock);
// void __stdcall ExDeleteNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside);
// KIRQL __stdcall KeAcquireSpinLockRaiseToDpc(PKSPIN_LOCK SpinLock);
// void __stdcall KeInitializeDpc(PRKDPC Dpc, PKDEFERRED_ROUTINE DeferredRoutine, PVOID DeferredContext);
// void __stdcall KeInitializeTimer(PKTIMER Timer);
// BOOLEAN __stdcall KeSetTimer(PKTIMER Timer, LARGE_INTEGER DueTime, PKDPC Dpc);
// BOOLEAN __stdcall KeCancelTimer(PKTIMER);
// NTSTATUS __stdcall IoWMIRegistrationControl(PDEVICE_OBJECT DeviceObject, ULONG Action);
// PVOID __stdcall ExAllocatePoolWithTag(POOL_TYPE PoolType, SIZE_T NumberOfBytes, ULONG Tag);
__int64 __fastcall sub_60008(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6);
void __fastcall sub_602B4(struct _DEVICE_OBJECT *a1);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_3FFFA; // weak
__int64 qword_56740[2] = { -3689348814755310775i64, -3689348814741910324i64 }; // weak
__int64 qword_567C0[2] = { -3689348814755310780i64, -3689348814741910324i64 }; // weak
__int64 qword_56840[2] = { -3689348814741910528i64, -3689348814741910324i64 }; // weak
unsigned __int8 byte_57220[352] =
{
  6u,
  128u,
  128u,
  134u,
  128u,
  129u,
  128u,
  0u,
  0u,
  16u,
  3u,
  134u,
  128u,
  134u,
  130u,
  128u,
  20u,
  5u,
  5u,
  69u,
  69u,
  69u,
  133u,
  133u,
  133u,
  5u,
  0u,
  0u,
  48u,
  48u,
  128u,
  80u,
  128u,
  128u,
  0u,
  8u,
  0u,
  32u,
  32u,
  48u,
  80u,
  87u,
  128u,
  0u,
  7u,
  0u,
  55u,
  48u,
  48u,
  80u,
  80u,
  136u,
  0u,
  0u,
  0u,
  32u,
  40u,
  128u,
  136u,
  128u,
  128u,
  0u,
  0u,
  0u,
  96u,
  96u,
  96u,
  104u,
  104u,
  96u,
  0u,
  0u,
  7u,
  120u,
  112u,
  112u,
  119u,
  112u,
  112u,
  8u,
  8u,
  0u,
  0u,
  8u,
  0u,
  8u,
  0u,
  7u,
  8u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u
}; // idb
_UNKNOWN unk_57AF0; // weak
_UNKNOWN unk_57B00; // weak
_UNKNOWN unk_57B10; // weak
_UNKNOWN unk_57B20; // weak
_UNKNOWN unk_57B30; // weak
_UNKNOWN unk_57B40; // weak
_UNKNOWN unk_57B50; // weak
_UNKNOWN unk_57B60; // weak
_UNKNOWN unk_57B70; // weak
_UNKNOWN unk_57BA0; // weak
_UNKNOWN unk_57BB0; // weak
_UNKNOWN unk_57BC0; // weak
_UNKNOWN unk_57BD0; // weak
_DWORD dword_57BE0[30] =
{
  1,
  11,
  23,
  53,
  97,
  193,
  389,
  769,
  1543,
  3079,
  6151,
  12289,
  24593,
  49157,
  98317,
  196613,
  393241,
  786433,
  1572869,
  3145739,
  6291469,
  12582917,
  25165843,
  50331653,
  100663319,
  201326611,
  402653189,
  805306457,
  1610612741,
  0
}; // idb
_UNKNOWN unk_57C58; // weak
_UNKNOWN unk_57C68; // weak
_UNKNOWN unk_57C78; // weak
_UNKNOWN unk_57C88; // weak
_UNKNOWN unk_57CA8; // weak
_UNKNOWN unk_57CB8; // weak
_UNKNOWN unk_57CC8; // weak
_UNKNOWN unk_57CD8; // weak
_UNKNOWN unk_57CE8; // weak
_UNKNOWN unk_57CF8; // weak
_UNKNOWN unk_57D08; // weak
_UNKNOWN unk_57D18; // weak
_UNKNOWN unk_57D28; // weak
_UNKNOWN unk_57D38; // weak
_UNKNOWN unk_57D48; // weak
_UNKNOWN unk_57D58; // weak
_UNKNOWN unk_57D68; // weak
_UNKNOWN unk_57D78; // weak
_UNKNOWN unk_57DAA; // weak
char *SrcCh = "(null)"; // idb
wchar_t *off_5A118 = L"(null)"; // weak
int dword_5A120 = 1; // weak
PDEVICE_OBJECT off_5A148 = &off_5A148; // idb
char aUnknownModule[15] = "Unknown module"; // weak
int dword_5A190 = 1; // weak
int dword_5A194 = 12; // weak
__int64 (__fastcall *qword_5A1B0)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (*qword_5A1C0)(void) = NULL; // weak
__int64 (__fastcall *qword_5A1C8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_5A1D0)(_QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
int dword_5A1D8 = 0; // weak
_UNKNOWN unk_5A1E0; // weak
struct _FAST_MUTEX stru_5A1F0 = { 0, NULL,  }; // idb
_UNKNOWN unk_5A228; // weak
char byte_5A5A0[4]; // idb
char byte_5A5A4[4]; // idb
char byte_5A5A8[8]; // idb
_UNKNOWN unk_5A5B0; // weak
int dword_5A644; // weak
PVOID Event; // idb
int dword_5A650; // weak
int dword_5A654; // weak
PVOID qword_5A658; // idb
PVOID qword_5A660; // idb
int dword_5A668; // weak
char byte_5A66C; // weak
char byte_5A66D; // weak
char byte_5A66E; // weak
char byte_5A66F; // weak
PDEVICE_OBJECT DeviceObject; // idb
__int64 qword_5A678; // weak
_UNKNOWN unk_5A680; // weak
_UNKNOWN unk_5A684; // weak
_UNKNOWN unk_5A688; // weak
_UNKNOWN unk_5A68C; // weak
_UNKNOWN unk_5A690; // weak
_UNKNOWN unk_5A694; // weak
_UNKNOWN unk_5A698; // weak
_UNKNOWN unk_5A69C; // weak
_UNKNOWN unk_5A6A0; // weak
_UNKNOWN unk_5A6A4; // weak
_UNKNOWN unk_5A6A8; // weak
_UNKNOWN unk_5A6AC; // weak
_UNKNOWN unk_5A6B0; // weak
_UNKNOWN unk_5A6B4; // weak
_UNKNOWN unk_5A6B8; // weak
_UNKNOWN unk_5A6BC; // weak
_UNKNOWN unk_5A6C0; // weak
_UNKNOWN unk_5A6C4; // weak
_UNKNOWN unk_5A6C8; // weak
_UNKNOWN unk_5A6CC; // weak
_UNKNOWN unk_5A6D0; // weak
_UNKNOWN unk_5A6D4; // weak
_UNKNOWN unk_5A6D8; // weak
_UNKNOWN unk_5A6DC; // weak
_UNKNOWN unk_5A6E0; // weak
_UNKNOWN unk_5A6E4; // weak
_UNKNOWN unk_5A6E8; // weak
_UNKNOWN unk_5A6EC; // weak
_UNKNOWN unk_5A6F0; // weak
_UNKNOWN unk_5A6F4; // weak
_UNKNOWN unk_5A6F8; // weak
_UNKNOWN unk_5A6FC; // weak
_UNKNOWN unk_5A700; // weak
_UNKNOWN unk_5A704; // weak
_UNKNOWN unk_5A708; // weak
_UNKNOWN unk_5A70C; // weak
_UNKNOWN unk_5A710; // weak
_UNKNOWN unk_5A714; // weak
_UNKNOWN unk_5A718; // weak
_UNKNOWN unk_5A71C; // weak
_UNKNOWN unk_5A720; // weak
_UNKNOWN unk_5A724; // weak
int dword_5A728; // weak
int dword_5A72C; // weak
int dword_5A730; // weak
int dword_5A734; // weak
int dword_5A738; // weak
int dword_5A73C; // weak
int dword_5A740; // weak
int dword_5A744; // weak
int dword_5A748; // weak
int dword_5A74C; // weak
int dword_5A750; // weak
int dword_5A754; // weak
int dword_5A758; // weak
int dword_5A75C; // weak
int dword_5A760; // weak
int dword_5A764; // weak
int dword_5A768; // weak
int dword_5A76C; // weak
int dword_5A770; // weak
_UNKNOWN unk_5A774; // weak
_UNKNOWN unk_5A778; // weak
_UNKNOWN unk_5A77C; // weak
_UNKNOWN unk_5A780; // weak
_UNKNOWN unk_5A784; // weak
_UNKNOWN unk_5A788; // weak
_UNKNOWN unk_5A78C; // weak
_UNKNOWN unk_5A790; // weak
_UNKNOWN unk_5A794; // weak
_UNKNOWN unk_5A798; // weak
_UNKNOWN unk_5A79C; // weak
_UNKNOWN unk_5A7A0; // weak
_UNKNOWN unk_5A7A4; // weak
_UNKNOWN unk_5A7A8; // weak
_UNKNOWN unk_5A7AC; // weak
_UNKNOWN unk_5A7B0; // weak
_UNKNOWN unk_5A7B4; // weak
_UNKNOWN unk_5A7B8; // weak
_UNKNOWN unk_5A7BC; // weak
_UNKNOWN unk_5A7C0; // weak
_UNKNOWN unk_5A7C4; // weak
_UNKNOWN unk_5A7C8; // weak
_UNKNOWN unk_5A7CC; // weak
_UNKNOWN unk_5A7D0; // weak
int dword_5A7D4; // weak
int dword_5A7D8; // weak
int dword_5A7DC; // weak
int dword_5A7E0; // weak
int dword_5A7E4; // weak
int dword_5A7E8; // weak
int dword_5A7EC; // weak
int dword_5A7F0; // weak
int dword_5A7F4; // weak
int dword_5A7F8; // weak
int dword_5A7FC; // weak
int dword_5A800; // weak
int dword_5A804; // weak
__int64 qword_5A808; // weak
__int64 qword_5A810; // weak
__int64 qword_5A818; // weak
__int64 qword_5A820; // weak
int dword_5A828; // weak
_UNKNOWN unk_5A82C; // weak
_UNKNOWN unk_5A834; // weak
_UNKNOWN unk_5A838; // weak
int dword_5A83C; // weak
_UNKNOWN unk_5A840; // weak
_UNKNOWN unk_5A848; // weak
_UNKNOWN unk_5A84C; // weak
__int64 qword_5A850; // weak
__int64 qword_5A858; // weak
_UNKNOWN unk_5A860; // weak
_UNKNOWN unk_5A868; // weak
_UNKNOWN unk_5A86C; // weak
_UNKNOWN unk_5A870; // weak
_UNKNOWN unk_5A878; // weak
_UNKNOWN unk_5A87C; // weak
_UNKNOWN unk_5A880; // weak
_UNKNOWN unk_5A888; // weak
_UNKNOWN unk_5A88C; // weak
int dword_5A894; // weak
__int64 qword_5A898; // weak
PVOID qword_5A8A0; // idb
PVOID qword_5A8A8; // idb
PVOID qword_5A8B0; // idb
PVOID qword_5A8B8; // idb
ULONG_PTR qword_5A8C0; // idb
ULONG_PTR qword_5A8C8; // idb
char byte_5A8D0; // weak
char byte_5A8D1; // weak
char byte_5A8D2; // weak
char byte_5A8D3; // weak
int dword_5A8D4; // weak
ULONG_PTR qword_5A8D8; // idb
PVOID qword_5A8E0; // idb
PVOID qword_5A8E8; // idb
PVOID qword_5A8F0; // idb
__int64 qword_5A8F8; // weak
_QWORD qword_5A900[10]; // idb
int dword_5A950; // weak
int dword_5A954; // weak
PVOID qword_5A958; // idb
PVOID P; // idb
__int64 qword_5CF60; // weak
union _LARGE_INTEGER PerformanceFrequency; // idb
PVOID qword_5CF70; // idb
PVOID qword_5CF78; // idb
PVOID qword_5CF80; // idb
__int64 qword_5CF88; // weak
PVOID qword_5CF90; // idb
__int64 qword_5CF98; // weak
wchar_t word_5CFA0[520]; // idb
int dword_5D3B0; // weak
PVOID qword_5D3B8; // idb
__int64 qword_5D3C0; // weak
PVOID qword_5D3C8; // idb
PVOID qword_5D3D0; // idb
int dword_5D3D8; // weak
int dword_5D3DC; // weak
char byte_5D3E0; // weak
char byte_5D3E1; // weak
char byte_5D3E2; // weak
char byte_5D3E3; // weak
char byte_5D3E4; // weak
__int64 (__fastcall *qword_5D3E8)(_QWORD); // weak
__int64 qword_5D3F0; // weak
__int64 qword_5D3F8; // weak
__int64 qword_5D400; // weak
__int64 qword_5D408; // weak
PVOID qword_5D410; // idb
__int64 qword_5D418; // weak
int dword_5D428; // weak
__int64 (__fastcall *qword_5D42C)(_QWORD, _QWORD, _QWORD); // weak
__int64 (__fastcall *qword_5D434)(_QWORD); // weak
__int64 qword_5D43C; // weak
__int64 qword_5D444; // weak
char byte_5D44C; // weak
struct _FAST_MUTEX stru_5D450; // idb
PVOID qword_5D488; // idb
int dword_5D494; // weak
PVOID qword_5D4A8; // idb
ULONG_PTR qword_5D4B0; // idb
struct _ERESOURCE Resource; // idb
__int64 qword_5D528; // weak
KSPIN_LOCK SpinLock; // idb
struct _FAST_MUTEX stru_5D540; // idb
struct _FAST_MUTEX stru_5D580; // idb
PVOID qword_5D5C0; // idb
__int64 qword_5D5C8; // weak
struct _FAST_MUTEX FastMutex; // idb
struct _KMUTANT Mutex; // idb
__int64 qword_5D678; // weak
struct _KDPC Dpc; // idb
__int64 qword_5D6C0; // weak
int dword_5D6D0; // weak
int dword_5D6D4; // weak
int dword_5D6D8; // weak
struct _KTIMER Timer; // idb
__int64 qword_5D720; // weak
__int64 qword_5D728; // weak
__int64 qword_5D730; // weak
__int64 qword_5D740; // weak
char byte_5D748; // weak
char byte_5D749; // weak
__int16 word_5D74A; // weak
int dword_5D74C; // weak
__int64 qword_5D760; // weak
__int64 qword_5D768; // weak
__int64 qword_5D770; // weak
__int64 qword_5D780; // weak
char byte_5D788; // weak
char byte_5D789; // weak
__int16 word_5D78A; // weak
int dword_5D78C; // weak
__int64 qword_5D7A0; // weak
__int64 qword_5D7A8; // weak
__int64 qword_5D7B0; // weak
__int64 qword_5D7C0; // weak
char byte_5D7C8; // weak
char byte_5D7C9; // weak
__int16 word_5D7CA; // weak
int dword_5D7CC; // weak
__int64 qword_5D7E0; // weak
__int64 qword_5D7E8; // weak
__int64 qword_5D7F0; // weak
__int64 qword_5D800; // weak
char byte_5D808; // weak
char byte_5D809; // weak
__int16 word_5D80A; // weak
int dword_5D80C; // weak
__int64 qword_5D820; // weak
__int64 qword_5D828; // weak
__int64 qword_5D830; // weak
__int64 qword_5D840; // weak
char byte_5D848; // weak
char byte_5D849; // weak
__int16 word_5D84A; // weak
int dword_5D84C; // weak


//----- (0000000000011008) ----------------------------------------------------
__int64 sub_11008(UNICODE_STRING *a1, const wchar_t *a2, ...)
{
  NTSTATUS v3; // er11
  size_t pcchNewDestLength; // [rsp+30h] [rbp-28h] BYREF
  size_t cchDest; // [rsp+38h] [rbp-20h] BYREF
  wchar_t *pszDest; // [rsp+40h] [rbp-18h] BYREF
  va_list va; // [rsp+70h] [rbp+18h] BYREF

  va_start(va, a2);
  v3 = RtlUnicodeStringValidateDestWorker(a1, &pszDest, &cchDest, 0i64, 0x7FFFui64, 0);
  if ( v3 >= 0 )
  {
    pcchNewDestLength = 0i64;
    v3 = RtlWideCharArrayVPrintfWorker(pszDest, cchDest, &pcchNewDestLength, a2, va);
    a1->Length = 2 * pcchNewDestLength;
  }
  return (unsigned int)v3;
}

//----- (0000000000011088) ----------------------------------------------------
__int64 __fastcall sub_11088(__int64 a1, unsigned __int16 a2, __int64 a3)
{
  return qword_5A1B8(a1, 43i64, a3, a2, 0i64);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000110AC) ----------------------------------------------------
__int64 __fastcall sub_110AC(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, int a6)
{
  int v7; // [rsp+88h] [rbp+20h] BYREF

  a6 = dword_5A654;
  a5 = dword_5A644;
  v7 = dword_5A650;
  return qword_5A1B8(a1, 43i64, &unk_57D78, 28i64, &v7);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 5A644: using guessed type int dword_5A644;
// 5A650: using guessed type int dword_5A650;
// 5A654: using guessed type int dword_5A654;

//----- (000000000001112C) ----------------------------------------------------
__int64 __fastcall sub_1112C(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D78, 20i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011190) ----------------------------------------------------
__int64 __fastcall sub_11190(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_5A1B8(a1, 43i64, a3, a2, v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011208) ----------------------------------------------------
__int64 __fastcall sub_11208(__int64 a1, __int64 a2, __int64 a3, __int16 a4, __int64 a5)
{
  char *v7; // rsi
  __int64 *v8; // rax
  __int64 v9; // r8
  SIZE_T v10; // rbx
  unsigned __int64 v11; // rcx
  int *v12; // rdx
  __int64 v13; // r9
  char *v15; // rax
  __int64 v16; // rbp
  const void **i; // rdi
  size_t v18; // rbx
  unsigned int v19; // ebx
  __int64 WnodeEventItem[7]; // [rsp+30h] [rbp-D8h] BYREF
  int v21; // [rsp+68h] [rbp-A0h] BYREF
  char *v22; // [rsp+70h] [rbp-98h]
  int v23; // [rsp+78h] [rbp-90h]
  __int16 v24; // [rsp+128h] [rbp+20h] BYREF

  v24 = a4;
  v7 = 0i64;
  memset(WnodeEventItem, 0, 0x30ui64);
  WnodeEventItem[1] = a1;
  WnodeEventItem[6] = (__int64)&v24;
  v8 = &a5;
  WnodeEventItem[3] = a3;
  HIDWORD(WnodeEventItem[5]) = 1703936;
  BYTE4(WnodeEventItem[0]) = -1;
  v21 = 2;
  v9 = a5;
  v10 = 0i64;
  v11 = 0i64;
  if ( a5 )
  {
    v12 = &v21;
    do
    {
      v13 = v8[1];
      ++v11;
      v12 += 4;
      v10 += v13;
      if ( v11 <= 7 )
      {
        *((_QWORD *)v12 - 1) = v9;
        *v12 = v13;
      }
      v8 += 2;
      v9 = *v8;
    }
    while ( *v8 );
  }
  if ( v10 > 0x2000 )
    return 3221225473i64;
  if ( v11 <= 7 )
  {
    LOWORD(WnodeEventItem[0]) = 16 * (v11 + 4);
  }
  else
  {
    v15 = (char *)ExAllocatePoolWithTag(NonPagedPool, v10, 0x45435453u);
    v7 = v15;
    if ( !v15 )
      return 3221225495i64;
    v22 = v15;
    v23 = v10;
    v16 = 0i64;
    for ( i = (const void **)&a5; *i; i += 2 )
    {
      v18 = (size_t)i[1];
      memmove(&v7[v16], *i, v18);
      v16 += v18;
    }
    LOWORD(WnodeEventItem[0]) = 80;
  }
  v19 = IoWMIWriteEvent(WnodeEventItem);
  if ( v7 )
    ExFreePoolWithTag(v7, 0);
  return v19;
}

//----- (000000000001135C) ----------------------------------------------------
__int64 __fastcall sub_1135C(__int64 a1, char a2, __int64 *a3, __int64 a4)
{
  __int64 result; // rax

  result = 0i64;
  if ( a2 == 1 || !a2 )
  {
    if ( a2 )
    {
      *(_DWORD *)(a4 + 44) = *((_DWORD *)a3 + 1);
      *(_BYTE *)(a4 + 41) = *((_BYTE *)a3 + 2);
      result = *a3;
    }
    else
    {
      *(_BYTE *)(a4 + 41) = 0;
      *(_DWORD *)(a4 + 44) = 0;
    }
    *(_QWORD *)(a4 + 24) = result;
  }
  return result;
}

//----- (0000000000011394) ----------------------------------------------------
NTSTATUS __stdcall DriverEntry(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath)
{
  int v3; // eax
  PDEVICE_OBJECT v4; // rcx
  __int64 *v5; // rbx
  __int64 v6; // rcx
  ULONG v7; // edx
  struct _DEVICE_OBJECT *v8; // rcx
  int v9; // ebx
  NTSTATUS v10; // ebx
  NTSTATUS result; // eax
  unsigned int v12; // eax
  unsigned int v13; // ebx
  __int64 v14; // rdi
  char *v15; // rbx
  void *v16; // rcx
  struct _UNICODE_STRING SystemRoutineName; // [rsp+40h] [rbp-38h] BYREF
  struct _UNICODE_STRING DestinationString; // [rsp+50h] [rbp-28h] BYREF
  unsigned int v19; // [rsp+90h] [rbp+18h] BYREF

  qword_5D728 = (__int64)&unk_57AF0;
  qword_5D730 = (__int64)&qword_5D760;
  qword_5D768 = (__int64)&unk_57B00;
  qword_5D770 = (__int64)&qword_5D7A0;
  qword_5D720 = 0i64;
  qword_5D7A8 = (__int64)&unk_57B10;
  qword_5D740 = 0i64;
  qword_5D7B0 = (__int64)&qword_5D7E0;
  byte_5D748 = 1;
  qword_5D7E8 = (__int64)&unk_57B20;
  byte_5D749 = 0;
  qword_5D7F0 = (__int64)&qword_5D820;
  word_5D74A = 0;
  dword_5D74C = 0;
  qword_5D760 = 0i64;
  qword_5D780 = 0i64;
  qword_5D828 = (__int64)&unk_57B30;
  byte_5D788 = 1;
  byte_5D789 = 0;
  word_5D78A = 0;
  dword_5D78C = 0;
  qword_5D7A0 = 0i64;
  qword_5D7C0 = 0i64;
  byte_5D7C8 = 1;
  byte_5D7C9 = 0;
  word_5D7CA = 0;
  dword_5D7CC = 0;
  qword_5D7E0 = 0i64;
  qword_5D800 = 0i64;
  byte_5D808 = 1;
  byte_5D809 = 0;
  word_5D80A = 0;
  dword_5D80C = 0;
  qword_5D820 = 0i64;
  qword_5D830 = 0i64;
  qword_5D840 = 0i64;
  byte_5D848 = 1;
  byte_5D849 = 0;
  word_5D84A = 0;
  dword_5D84C = 0;
  v19 = 0;
  RtlInitUnicodeString(&SystemRoutineName, L"PsGetVersion");
  qword_5A1D0 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
  RtlInitUnicodeString(&SystemRoutineName, L"WmiTraceMessage");
  qword_5A1B8 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
  if ( qword_5A1B8 )
  {
    RtlInitUnicodeString(&SystemRoutineName, L"WmiQueryTraceInformation");
    qword_5A1B0 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
    v3 = 2;
    dword_5A1D8 = 2;
    if ( qword_5A1D0 )
    {
      qword_5A1D0(&v19, 0i64, 0i64, 0i64);
      v3 = dword_5A1D8;
    }
    if ( v19 < 6 )
      goto LABEL_10;
    RtlInitUnicodeString(&SystemRoutineName, L"EtwRegisterClassicProvider");
    qword_5A1C8 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
    if ( !qword_5A1C8 )
    {
      v3 = dword_5A1D8;
      goto LABEL_10;
    }
    RtlInitUnicodeString(&SystemRoutineName, L"EtwUnregister");
    qword_5A1C0 = (__int64 (*)(void))MmGetSystemRoutineAddress(&SystemRoutineName);
    v3 = 4;
  }
  else
  {
    qword_5A1B8 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))sub_11208;
    v3 = 1;
  }
  dword_5A1D8 = v3;
LABEL_10:
  v4 = off_5A148;
  v5 = &qword_5D720;
  qword_5D740 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&qword_5D720 )
  {
    off_5A148 = (PDEVICE_OBJECT)&qword_5D720;
    if ( v3 == 4 )
    {
      do
      {
        v6 = v5[1];
        v5[7] = 0i64;
        qword_5A1C8(v6, 0i64, sub_1135C, v5, v5 + 7);
        v5 = (__int64 *)v5[2];
      }
      while ( v5 );
    }
    else
    {
      if ( v3 == 2 )
      {
        v7 = -2147418111;
        v8 = (struct _DEVICE_OBJECT *)&qword_5D720;
        qword_5D720 = (__int64)sub_60008;
      }
      else
      {
        qword_5D720 = 0i64;
        v7 = 1;
        v8 = (struct _DEVICE_OBJECT *)DriverObject;
      }
      IoWMIRegistrationControl(v8, v7);
    }
    v4 = off_5A148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0xAu, (__int64)&unk_57D78);
  }
  sub_3F2B0();
  sub_3F2B0();
  v9 = 0;
  while ( sub_46E8C((__int64)&stru_5A1F0 + 96 * v9) )
  {
    if ( ++v9 >= 10 )
    {
      DriverObject->DriverUnload = (PDRIVER_UNLOAD)sub_119EC;
      RtlInitUnicodeString(&DestinationString, L"\\Device\\NNS_Streamer");
      v10 = IoCreateDevice(DriverObject, 0, &DestinationString, 0x22u, 0, 0, &DeviceObject);
      if ( v10 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_11190(
            *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
            0xCu,
            (__int64)&unk_57D78,
            (const char *)L"\\Device\\NNS_Streamer");
        }
        sub_119EC((struct _DEVICE_OBJECT *)DriverObject);
        result = v10;
      }
      else
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xBu, (__int64)&unk_57D78);
        }
        DriverObject->MajorFunction[0] = (PDRIVER_DISPATCH)sub_11F24;
        DriverObject->MajorFunction[2] = (PDRIVER_DISPATCH)sub_11F24;
        DriverObject->MajorFunction[14] = (PDRIVER_DISPATCH)sub_123DC;
        DriverObject->MajorFunction[15] = (PDRIVER_DISPATCH)sub_12488;
        sub_3F444();
        KeInitializeMutex(&Mutex, 0);
        if ( (unsigned int)sub_13364() )
        {
          sub_119EC((struct _DEVICE_OBJECT *)DriverObject);
          result = -1073741823;
        }
        else
        {
          sub_11F4C();
          sub_524E8();
          sub_3D01C((struct _KEVENT **)&Event, 1);
          v12 = sub_4535C(0x2013016u);
          qword_5A658 = (PVOID)sub_3D4A8(v12);
          v13 = sub_4535C(0x2013018u);
          dword_5A194 = v13;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
            && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
          {
            sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x2Cu);
          }
          qword_5A660 = (PVOID)sub_3E8E8(v13, 1);
          sub_287EC();
          sub_3B75C();
          sub_403FC(1);
          qword_5D6C0 = 100000i64;
          KeInitializeDpc(&Dpc, (PKDEFERRED_ROUTINE)DeferredRoutine, sub_12678);
          KeInitializeTimer(&Timer);
          qword_5D678 = -1000000i64;
          KeSetTimer(&Timer, (LARGE_INTEGER)-1000000i64, &Dpc);
          result = 0;
        }
      }
      return result;
    }
  }
  v14 = v9 - 1;
  if ( v14 >= 0 )
  {
    v15 = (char *)&unk_5A228 + 96 * v14;
    do
    {
      if ( v15 != (char *)56 )
      {
        v16 = *(void **)v15;
        *((_DWORD *)v15 + 3) = 0;
        if ( v16 )
          sub_3D094(v16);
      }
      --v14;
      v15 -= 96;
    }
    while ( v14 >= 0 );
  }
  sub_602B4((struct _DEVICE_OBJECT *)DriverObject);
  return -536739837;
}
// 5A194: using guessed type int dword_5A194;
// 5A1B0: using guessed type __int64 (__fastcall *qword_5A1B0)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 5A1C0: using guessed type __int64 (*qword_5A1C0)(void);
// 5A1C8: using guessed type __int64 (__fastcall *qword_5A1C8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 5A1D0: using guessed type __int64 (__fastcall *qword_5A1D0)(_QWORD, _QWORD, _QWORD, _QWORD);
// 5A1D8: using guessed type int dword_5A1D8;
// 5D678: using guessed type __int64 qword_5D678;
// 5D6C0: using guessed type __int64 qword_5D6C0;
// 5D720: using guessed type __int64 qword_5D720;
// 5D728: using guessed type __int64 qword_5D728;
// 5D730: using guessed type __int64 qword_5D730;
// 5D740: using guessed type __int64 qword_5D740;
// 5D748: using guessed type char byte_5D748;
// 5D749: using guessed type char byte_5D749;
// 5D74A: using guessed type __int16 word_5D74A;
// 5D74C: using guessed type int dword_5D74C;
// 5D760: using guessed type __int64 qword_5D760;
// 5D768: using guessed type __int64 qword_5D768;
// 5D770: using guessed type __int64 qword_5D770;
// 5D780: using guessed type __int64 qword_5D780;
// 5D788: using guessed type char byte_5D788;
// 5D789: using guessed type char byte_5D789;
// 5D78A: using guessed type __int16 word_5D78A;
// 5D78C: using guessed type int dword_5D78C;
// 5D7A0: using guessed type __int64 qword_5D7A0;
// 5D7A8: using guessed type __int64 qword_5D7A8;
// 5D7B0: using guessed type __int64 qword_5D7B0;
// 5D7C0: using guessed type __int64 qword_5D7C0;
// 5D7C8: using guessed type char byte_5D7C8;
// 5D7C9: using guessed type char byte_5D7C9;
// 5D7CA: using guessed type __int16 word_5D7CA;
// 5D7CC: using guessed type int dword_5D7CC;
// 5D7E0: using guessed type __int64 qword_5D7E0;
// 5D7E8: using guessed type __int64 qword_5D7E8;
// 5D7F0: using guessed type __int64 qword_5D7F0;
// 5D800: using guessed type __int64 qword_5D800;
// 5D808: using guessed type char byte_5D808;
// 5D809: using guessed type char byte_5D809;
// 5D80A: using guessed type __int16 word_5D80A;
// 5D80C: using guessed type int dword_5D80C;
// 5D820: using guessed type __int64 qword_5D820;
// 5D828: using guessed type __int64 qword_5D828;
// 5D830: using guessed type __int64 qword_5D830;
// 5D840: using guessed type __int64 qword_5D840;
// 5D848: using guessed type char byte_5D848;
// 5D849: using guessed type char byte_5D849;
// 5D84A: using guessed type __int16 word_5D84A;
// 5D84C: using guessed type int dword_5D84C;

//----- (00000000000119EC) ----------------------------------------------------
void __fastcall sub_119EC(struct _DEVICE_OBJECT *a1)
{
  struct _FAST_MUTEX *v2; // rbx
  void *v3; // rcx
  PDEVICE_OBJECT v4; // rcx
  PVOID v5; // rax
  int v6; // eax
  PDEVICE_OBJECT v7; // rcx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xDu, (__int64)&unk_57D78);
  }
  byte_5A66C = 1;
  sub_403FC(0);
  v2 = &stru_5A1F0;
  do
  {
    if ( sub_46FB0(v2) )
    {
      (*(void (**)(void))&v2[-1].OldIrql)();
      sub_47018(v2);
    }
    sub_46F50(v2);
    if ( v2 )
    {
      v3 = *(void **)&v2[1].Count;
      HIDWORD(v2[1].Owner) = 0;
      if ( v3 )
        sub_3D094(v3);
    }
    v2 = (struct _FAST_MUTEX *)((char *)v2 + 96);
  }
  while ( (__int64)v2 < (__int64)&unk_5A5B0 );
  sub_5261C();
  KeCancelTimer(&Timer);
  if ( !DeviceObject )
    goto LABEL_17;
  IoDeleteDevice(DeviceObject);
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xEu, (__int64)&unk_57D78);
LABEL_17:
    v4 = off_5A148;
  }
  v5 = Event;
  if ( Event )
  {
    sub_3D0FC((PRKEVENT)Event);
    v4 = off_5A148;
    v5 = Event;
  }
  if ( qword_5A658 )
  {
    sub_4535C(0x2013017u);
    sub_3D510(qword_5A658);
    v4 = off_5A148;
    v5 = Event;
  }
  if ( qword_5A660 )
  {
    sub_4535C(0x2013019u);
    sub_3D510(qword_5A660);
    v4 = off_5A148;
    v5 = Event;
  }
  if ( v5 )
  {
    sub_3D094(v5);
    v4 = off_5A148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x10u, (__int64)&unk_57D28);
    v4 = off_5A148;
  }
  if ( qword_5A8D8 )
  {
    sub_2CF4C();
    sub_47B3C(qword_5A8D8);
    v4 = off_5A148;
    qword_5A8D8 = 0i64;
  }
  if ( qword_5A8E8 )
  {
    sub_3C7F0(qword_5A8E8);
    v4 = off_5A148;
    qword_5A8E8 = 0i64;
  }
  if ( qword_5A8F0 )
  {
    sub_3C7F0(qword_5A8F0);
    v4 = off_5A148;
    qword_5A8F0 = 0i64;
  }
  if ( qword_5A8E0 )
  {
    sub_3C7F0(qword_5A8E0);
    v4 = off_5A148;
    qword_5A8E0 = 0i64;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x11u, (__int64)&unk_57D28);
      v4 = off_5A148;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x18u, (__int64)&unk_57CC8);
    }
  }
  v6 = sub_47B3C(qword_5D4B0);
  if ( v6 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x19u, (__int64)&unk_57CC8, v6);
    }
  }
  else
  {
    sub_3C7F0(qword_5A958);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Au, (__int64)&unk_57CC8);
    }
  }
  sub_13BC4();
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xEu, (__int64)&unk_57C78);
    v7 = off_5A148;
  }
  if ( qword_5CF70 )
  {
    sub_3C7F0(qword_5CF70);
    v7 = off_5A148;
    qword_5CF70 = 0i64;
  }
  if ( qword_5CF78 )
  {
    sub_3C7F0(qword_5CF78);
    v7 = off_5A148;
    qword_5CF78 = 0i64;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 8) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0xFu, (__int64)&unk_57C78);
    v7 = off_5A148;
  }
  if ( P )
  {
    sub_3C570(P, 0x72746E63u);
    v7 = off_5A148;
    P = 0i64;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0x12u)
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0xDu, (__int64)&unk_57C88);
      v7 = off_5A148;
    }
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0x12u)
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EA4(*(_QWORD *)&v7->AlignmentRequirement, 0xEu, (__int64)&unk_57C88, 0);
    }
  }
  sub_602B4(a1);
}
// 5A66C: using guessed type char byte_5A66C;

//----- (0000000000011F24) ----------------------------------------------------
__int64 __fastcall sub_11F24(__int64 a1, IRP *a2)
{
  a2->IoStatus.Status = 0;
  a2->IoStatus.Information = 0i64;
  IofCompleteRequest(a2, 0);
  return 0i64;
}

//----- (0000000000011F4C) ----------------------------------------------------
__int64 sub_11F4C()
{
  int i; // edi
  PDEVICE_OBJECT v1; // rcx
  PDEVICE_OBJECT v2; // rcx
  __m128i *v3; // rax
  unsigned __int16 v4; // dx
  IRP *v5; // rax
  NTSTATUS v6; // ebx
  PDEVICE_OBJECT DeviceObject; // [rsp+50h] [rbp-A8h] BYREF
  PFILE_OBJECT FileObject; // [rsp+58h] [rbp-A0h] BYREF
  int InputBuffer[10]; // [rsp+60h] [rbp-98h] BYREF
  struct _UNICODE_STRING ObjectName; // [rsp+88h] [rbp-70h] BYREF
  struct _IO_STATUS_BLOCK IoStatusBlock; // [rsp+98h] [rbp-60h] BYREF
  __int16 v13; // [rsp+A8h] [rbp-50h] BYREF
  char Dst[40]; // [rsp+AAh] [rbp-4Eh] BYREF

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 9u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xFu, (__int64)&unk_57D78);
  }
  for ( i = 2; i <= 11; ++i )
  {
    FileObject = 0i64;
    DeviceObject = 0i64;
    IoStatusBlock.Pointer = 0i64;
    IoStatusBlock.Information = 0i64;
    v13 = 0;
    memset(Dst, 0, sizeof(Dst));
    ObjectName.MaximumLength = 42;
    ObjectName.Length = 0;
    ObjectName.Buffer = (PWSTR)&v13;
    sub_11008(&ObjectName, L"\\Device\\NNS_Parser%X", (unsigned int)i);
    memset(InputBuffer, 0, 0x25ui64);
    InputBuffer[0] = i;
    *(_QWORD *)&InputBuffer[1] = sub_14004;
    *(_QWORD *)&InputBuffer[3] = sub_16F48;
    if ( i == 10 )
    {
      v1 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xEu, (__int64)&unk_57B70);
          v1 = off_5A148;
        }
        if ( v1 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v1->Queue.Wcb.DeviceRoutine) & 2) != 0
          && BYTE1(v1->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_11088((__int64)v1->Queue.ListEntry.Blink, 0xFu, (__int64)&unk_57B70);
        }
      }
      memmove(&dword_5D428, InputBuffer, 0x25ui64);
      qword_5D43C = (__int64)sub_52BC8;
      dword_5D428 = 10;
      qword_5D444 = (__int64)sub_52E90;
      memmove(InputBuffer, &dword_5D428, 0x25ui64);
      sub_52828();
      v2 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
        && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x12u, (__int64)&unk_57B70, 0);
LABEL_19:
        v2 = off_5A148;
      }
      if ( (unsigned int)(InputBuffer[0] - 2) <= 9 )
        v3 = (__m128i *)((char *)&unk_5A1E0 + 96 * InputBuffer[0] - 192);
      else
        v3 = 0i64;
      *v3 = _mm_loadu_si128((const __m128i *)&InputBuffer[5]);
      if ( (unsigned int)(i - 2) <= 9 )
      {
        sub_46EF0((struct _FAST_MUTEX *)((char *)&stru_5A1F0 + 96 * i - 192));
        v2 = off_5A148;
      }
      if ( v2 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 9u)
        && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_1112C(*(_QWORD *)&v2->AlignmentRequirement, 20i64, (__int64)&unk_57D78, i);
        goto LABEL_49;
      }
      continue;
    }
    if ( IoGetDeviceObjectPointer(&ObjectName, 0, &FileObject, &DeviceObject) >= 0 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 9u)
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x11u, (__int64)&unk_57D78, i);
      }
      v5 = IoBuildDeviceIoControlRequest(
             0x223E80u,
             DeviceObject,
             InputBuffer,
             0x25u,
             InputBuffer,
             0x25u,
             1u,
             0i64,
             &IoStatusBlock);
      if ( v5 )
      {
        v6 = IofCallDriver(DeviceObject, v5);
        ObfDereferenceObject(FileObject);
        if ( v6 >= 0 )
          goto LABEL_19;
        v2 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 9u)
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          v4 = 19;
          goto LABEL_27;
        }
      }
      else
      {
        v2 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 9u)
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          v4 = 18;
          goto LABEL_27;
        }
      }
    }
    else
    {
      v2 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 9u)
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        v4 = 16;
LABEL_27:
        sub_13EA4(*(_QWORD *)&v2->AlignmentRequirement, v4, (__int64)&unk_57D78, i);
LABEL_49:
        v2 = off_5A148;
        continue;
      }
    }
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 9u)
    && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->AlignmentRequirement, 0x15u, (__int64)&unk_57D78);
  }
  return 0i64;
}
// 566F0: using guessed type wchar_t aDeviceNnsParse[21];
// 5D428: using guessed type int dword_5D428;
// 5D43C: using guessed type __int64 qword_5D43C;
// 5D444: using guessed type __int64 qword_5D444;

//----- (00000000000123DC) ----------------------------------------------------
__int64 __fastcall sub_123DC(__int64 a1, IRP *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x16u, (__int64)&unk_57D78);
  }
  a2->IoStatus.Status = 0;
  a2->IoStatus.Information = 0i64;
  IofCompleteRequest(a2, 0);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x17u, (__int64)&unk_57D78, 0);
  }
  return 0i64;
}

//----- (0000000000012488) ----------------------------------------------------
__int64 __fastcall sub_12488(__int64 a1, IRP *a2)
{
  unsigned int v3; // esi
  PDEVICE_OBJECT v4; // rcx
  struct _IO_STACK_LOCATION *v5; // rbx
  int v6; // er9
  unsigned int v7; // ebx
  __m128i v8; // xmm0
  __int64 v9; // rbx
  int Dst; // [rsp+20h] [rbp-48h] BYREF
  __int64 (__fastcall *v12)(unsigned int, int *, __int64 *); // [rsp+24h] [rbp-44h]
  __int64 (__fastcall *v13)(int); // [rsp+2Ch] [rbp-3Ch]
  __m128i v14; // [rsp+34h] [rbp-34h] BYREF

  v3 = 0;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x18u, (__int64)&unk_57D78);
    v4 = off_5A148;
  }
  v5 = a2->Tail.Overlay.CurrentStackLocation;
  v6 = v5->Parameters.Read.ByteOffset.LowPart;
  if ( v6 == 2244224 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x19u, (__int64)&unk_57D78);
    }
    if ( v5->Parameters.Create.Options < 0x25
      || v5->Parameters.Read.Length < 0x25
      || (memmove(&Dst, a2->AssociatedIrp.MasterIrp, 0x25ui64), (unsigned int)(Dst - 2) > 9) )
    {
      v7 = -1073741808;
    }
    else
    {
      v8 = _mm_loadu_si128(&v14);
      v12 = sub_14004;
      v9 = 96i64 * (Dst - 2);
      v13 = sub_16F48;
      *(__m128i *)((char *)&unk_5A1E0 + v9) = v8;
      memmove(a2->AssociatedIrp.MasterIrp, &Dst, 0x25ui64);
      v3 = 37;
      sub_46EF0((PFAST_MUTEX)((char *)&unk_5A1E0 + v9 + 16));
      v7 = 0;
    }
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_13EA4(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x1Au, (__int64)&unk_57D78, v6);
    }
    v7 = -1073741811;
  }
  a2->IoStatus.Status = v7;
  if ( (v7 & 0xC0000000) == -1073741824 )
    v3 = 0;
  a2->IoStatus.Information = v3;
  IofCompleteRequest(a2, 0);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 2) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Bu, (__int64)&unk_57D78, v7);
  }
  return v7;
}

//----- (0000000000012678) ----------------------------------------------------
void sub_12678()
{
  int v0; // eax
  __int64 v1; // r9
  int v2; // er8
  PDEVICE_OBJECT v3; // rcx

  v0 = dword_5A644 + 1;
  v1 = (unsigned int)(dword_5A650 + 1);
  v2 = ++dword_5A654;
  ++dword_5A644;
  ++dword_5A650;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xEu)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_110AC(*(_QWORD *)&off_5A148->AlignmentRequirement, 28i64, (__int64)&unk_57D78, v1, v0, v2);
      v3 = off_5A148;
    }
    if ( v3 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( _bittest((const signed __int32 *)&v3->DeviceQueue.DeviceListHead.Flink + 1, 0xEu)
        && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&v3->AlignmentRequirement, 0x1Du, (__int64)&unk_57D78, dword_5D6D4);
        v3 = off_5A148;
      }
      if ( v3 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( _bittest((const signed __int32 *)&v3->DeviceQueue.DeviceListHead.Flink + 1, 0xEu)
          && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_13EA4(*(_QWORD *)&v3->AlignmentRequirement, 0x1Eu, (__int64)&unk_57D78, dword_5D6D0);
          v3 = off_5A148;
        }
        if ( v3 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v3->DeviceQueue.DeviceListHead.Flink + 1, 0xEu)
          && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_13EA4(*(_QWORD *)&v3->AlignmentRequirement, 0x1Fu, (__int64)&unk_57D78, dword_5D6D8);
          v3 = off_5A148;
        }
      }
    }
  }
  if ( dword_5A650 >= dword_5D6D4 )
  {
    sub_128B4();
    dword_5A650 = 0;
    v3 = off_5A148;
  }
  if ( dword_5A644 >= dword_5D6D0 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( _bittest((const signed __int32 *)&v3->DeviceQueue.DeviceListHead.Flink + 1, 0xEu)
        && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v3->AlignmentRequirement, 0x23u, (__int64)&unk_57D78);
        v3 = off_5A148;
      }
      if ( v3 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v3->DeviceQueue.DeviceListHead.Flink + 1, 0xEu)
        && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v3->AlignmentRequirement, 0x24u, (__int64)&unk_57D78);
        v3 = off_5A148;
      }
    }
    dword_5A644 = 0;
  }
  if ( dword_5A654 >= dword_5D6D8 )
  {
    sub_129FC();
    dword_5A654 = 0;
    v3 = off_5A148;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v3->DeviceQueue.DeviceListHead.Flink + 1, 0xEu)
    && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v3->AlignmentRequirement, 0x20u, (__int64)&unk_57D78);
  }
}
// 5A644: using guessed type int dword_5A644;
// 5A650: using guessed type int dword_5A650;
// 5A654: using guessed type int dword_5A654;
// 5D6D0: using guessed type int dword_5D6D0;
// 5D6D4: using guessed type int dword_5D6D4;
// 5D6D8: using guessed type int dword_5D6D8;

//----- (00000000000128B4) ----------------------------------------------------
void sub_128B4()
{
  _QWORD *v0; // rax
  _QWORD *v1; // rax
  _QWORD *v2; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xEu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x21u, (__int64)&unk_57D78);
  }
  v0 = sub_3D584((__int64)qword_5A658, 4, (__int64)sub_12AC4, 0i64);
  if ( v0 )
    sub_3D780((__int64)v0);
  v1 = sub_3D584((__int64)qword_5A658, 4, (__int64)sub_12B64, 0i64);
  if ( v1 )
    sub_3D780((__int64)v1);
  v2 = sub_3D584((__int64)qword_5A658, 4, (__int64)sub_12CC8, 0i64);
  if ( v2 )
    sub_3D780((__int64)v2);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xEu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x22u, (__int64)&unk_57D78);
  }
}

//----- (00000000000129FC) ----------------------------------------------------
void sub_129FC()
{
  _QWORD *v0; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xEu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x25u, (__int64)&unk_57D78);
  }
  v0 = sub_3D584((__int64)qword_5A658, 4, (__int64)sub_12C24, 0i64);
  if ( v0 )
    sub_3D780((__int64)v0);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xEu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x26u, (__int64)&unk_57D78);
  }
}

//----- (0000000000012AC4) ----------------------------------------------------
__int64 sub_12AC4()
{
  unsigned int v0; // eax
  __int64 result; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x27u, (__int64)&unk_57D78);
  }
  v0 = sub_4535C(0x2013012u);
  result = sub_20238(1000000i64 * v0);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x28u, (__int64)&unk_57D78);
  }
  return result;
}

//----- (0000000000012B64) ----------------------------------------------------
__int64 sub_12B64()
{
  __int64 v0; // rbx
  unsigned int v1; // eax
  __int64 result; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x29u, (__int64)&unk_57D78);
  }
  v0 = 1000000i64 * (unsigned int)sub_4535C(0x2013013u);
  v1 = sub_4535C(0x2013023u);
  result = sub_206A8(v0, 1000000i64 * v1);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Au, (__int64)&unk_57D78);
  }
  return result;
}

//----- (0000000000012C24) ----------------------------------------------------
__int64 sub_12C24()
{
  unsigned int v0; // eax
  __int64 result; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Bu, (__int64)&unk_57D78);
  }
  v0 = sub_4535C(0x2013023u);
  sub_20B20(1000000i64 * v0);
  result = sub_3C1B8();
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Cu, (__int64)&unk_57D78);
  }
  return result;
}

//----- (0000000000012CC8) ----------------------------------------------------
__int64 sub_12CC8()
{
  __int64 result; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Du, (__int64)&unk_57D78);
  }
  sub_4535C(0x2013014u);
  result = sub_4535C(0x2013011u);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Eu, (__int64)&unk_57D78);
  }
  return result;
}

//----- (0000000000012D64) ----------------------------------------------------
__int64 sub_12D64(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+68h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, a3, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000012DA0) ----------------------------------------------------
char __fastcall sub_12DA0(int a1, _DWORD *a2, _DWORD *a3, _DWORD *a4)
{
  char v4; // r10

  v4 = 1;
  switch ( a1 )
  {
    case 33632257:
      *a2 = 0;
      goto LABEL_3;
    case 33632258:
      *a2 = 8;
      goto LABEL_3;
    case 33632259:
      *a2 = 12;
      goto LABEL_3;
    case 33632260:
      *a2 = 16;
      goto LABEL_3;
    case 33632261:
      *a2 = 20;
      goto LABEL_3;
    case 33632262:
      *a2 = 28;
      goto LABEL_3;
    case 33632263:
      *a2 = 136;
      goto LABEL_19;
    case 33632264:
      *a2 = 32;
      goto LABEL_3;
    case 33632265:
      *a2 = 36;
      goto LABEL_3;
    case 33632266:
      *a2 = 40;
      goto LABEL_3;
    case 33632267:
      *a2 = 44;
      goto LABEL_3;
    case 33632268:
      *a2 = 48;
      goto LABEL_15;
    case 33632269:
      *a2 = 49;
      goto LABEL_15;
    case 33632270:
      *a2 = 50;
      goto LABEL_15;
    case 33632271:
      *a2 = 51;
LABEL_19:
      *a3 = 1;
      goto LABEL_4;
    case 33632272:
      *a2 = 52;
      goto LABEL_3;
    case 33632273:
      *a2 = 56;
      goto LABEL_3;
    case 33632274:
      *a2 = 60;
      goto LABEL_3;
    case 33632275:
      *a2 = 64;
      goto LABEL_3;
    case 33632276:
      *a2 = 68;
      goto LABEL_3;
    case 33632277:
      *a2 = 80;
      goto LABEL_3;
    case 33632278:
      *a2 = 84;
      goto LABEL_29;
    case 33632279:
      *a2 = 88;
      goto LABEL_3;
    case 33632280:
      *a2 = 112;
      goto LABEL_29;
    case 33632281:
      *a2 = 116;
      goto LABEL_3;
    case 33632282:
      *a2 = 120;
      goto LABEL_15;
    case 33632283:
      *a2 = 124;
      goto LABEL_3;
    case 33632284:
      *a2 = 92;
      goto LABEL_29;
    case 33632285:
      *a2 = 94;
LABEL_29:
      *a3 = 2;
      *a4 = 6;
      return v4;
    case 33632286:
      *a2 = 4;
      goto LABEL_3;
    case 33632287:
      *a2 = 137;
LABEL_15:
      *a3 = 1;
      *a4 = 1;
      return v4;
    case 33632288:
      *a2 = 96;
      goto LABEL_3;
    case 33632289:
      *a2 = 100;
      goto LABEL_3;
    case 33632290:
      *a2 = 72;
      goto LABEL_3;
    case 33632291:
      *a2 = 76;
      goto LABEL_3;
    case 33632292:
      *a2 = 104;
      goto LABEL_3;
    case 33632293:
      *a2 = 140;
      goto LABEL_3;
    case 33632294:
      *a2 = 108;
      goto LABEL_3;
    case 33632295:
      *a2 = 24;
      goto LABEL_3;
    case 33632296:
      *a2 = 144;
      goto LABEL_3;
    case 33632297:
      *a2 = 148;
      goto LABEL_3;
    case 33632298:
      *a2 = 152;
      goto LABEL_3;
    case 33632299:
      *a2 = 156;
      goto LABEL_3;
    case 33632300:
      *a2 = 160;
      goto LABEL_3;
    case 33632301:
      *a2 = 164;
      goto LABEL_3;
    case 33632302:
      *a2 = 168;
      goto LABEL_3;
    case 33632304:
      *a2 = 128;
      goto LABEL_3;
    case 33632305:
      *a2 = 172;
      goto LABEL_3;
    case 33632307:
      *a2 = 132;
LABEL_3:
      *a3 = 4;
LABEL_4:
      *a4 = 0;
      break;
    default:
      v4 = 0;
      break;
  }
  return v4;
}

//----- (00000000000130B4) ----------------------------------------------------
__int64 __fastcall sub_130B4(__int64 a1)
{
  __int64 result; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xAu, (__int64)&unk_57D68);
  }
  *(_DWORD *)(a1 + 8) = (_DWORD)&loc_3FFFA + 6;
  *(_DWORD *)(a1 + 12) = (_DWORD)&loc_3FFFA + 6;
  *(_DWORD *)(a1 + 32) = 120;
  *(_DWORD *)(a1 + 36) = 120;
  *(_DWORD *)(a1 + 24) = 0;
  *(_BYTE *)(a1 + 49) = 0;
  *(_WORD *)(a1 + 92) = 590;
  *(_BYTE *)(a1 + 50) = 0;
  *(_WORD *)(a1 + 94) = 15;
  *(_DWORD *)(a1 + 80) = 0;
  *(_DWORD *)(a1 + 96) = 64;
  *(_DWORD *)(a1 + 100) = 64;
  *(_DWORD *)(a1 + 60) = 300;
  *(_DWORD *)(a1 + 64) = 300;
  *(_DWORD *)(a1 + 76) = 300;
  result = 12i64;
  *(_DWORD *)(a1 + 4) = 0;
  *(_DWORD *)(a1 + 140) = 0;
  *(_DWORD *)a1 = 1;
  *(_DWORD *)(a1 + 16) = 10;
  *(_DWORD *)(a1 + 20) = 4;
  *(_DWORD *)(a1 + 108) = 1;
  *(_DWORD *)(a1 + 28) = 0x4000;
  *(_DWORD *)(a1 + 160) = 11;
  *(_DWORD *)(a1 + 40) = 75;
  *(_DWORD *)(a1 + 44) = 432000;
  *(_BYTE *)(a1 + 48) = 1;
  *(_BYTE *)(a1 + 51) = 3;
  *(_BYTE *)(a1 + 136) = 1;
  *(_BYTE *)(a1 + 137) = 1;
  *(_DWORD *)(a1 + 104) = 128;
  *(_DWORD *)(a1 + 52) = 2;
  *(_DWORD *)(a1 + 56) = 5;
  *(_DWORD *)(a1 + 68) = 100;
  *(_DWORD *)(a1 + 72) = 50;
  *(_WORD *)(a1 + 84) = 3;
  *(_DWORD *)(a1 + 88) = 10;
  *(_WORD *)(a1 + 112) = 12;
  *(_DWORD *)(a1 + 116) = 10;
  *(_DWORD *)(a1 + 124) = 3000;
  *(_BYTE *)(a1 + 120) = 1;
  *(_DWORD *)(a1 + 128) = 3;
  *(_DWORD *)(a1 + 132) = 1;
  *(_DWORD *)(a1 + 152) = 1;
  *(_DWORD *)(a1 + 156) = 1;
  *(_DWORD *)(a1 + 164) = 10;
  *(_DWORD *)(a1 + 168) = 60;
  *(_DWORD *)(a1 + 144) = 1;
  *(_DWORD *)(a1 + 148) = 1000;
  *(_DWORD *)(a1 + 172) = 1500;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    result = sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xBu, (__int64)&unk_57D68);
  }
  return result;
}

//----- (0000000000013274) ----------------------------------------------------
void __fastcall sub_13274(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xCu, (__int64)&unk_57D68, a1);
    v2 = off_5A148;
  }
  if ( _bittest((const signed __int32 *)a1, 0x10u) )
  {
    _InterlockedExchange(&dword_5D6D4, sub_4535C(0x2013011u));
    v2 = off_5A148;
  }
  if ( _bittest((const signed __int32 *)a1, 0xFu) )
  {
    _InterlockedExchange(&dword_5D6D0, sub_4535C(0x2013010u));
    v2 = off_5A148;
  }
  if ( (*(_BYTE *)(a1 + 4) & 2) != 0 )
  {
    _InterlockedExchange(&dword_5D6D8, sub_4535C(0x2013022u));
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->AlignmentRequirement, 0xDu, (__int64)&unk_57D68);
  }
}
// 5D6D0: using guessed type int dword_5D6D0;
// 5D6D4: using guessed type int dword_5D6D4;
// 5D6D8: using guessed type int dword_5D6D8;

//----- (0000000000013364) ----------------------------------------------------
__int64 sub_13364()
{
  PDEVICE_OBJECT v0; // rcx
  int v1; // eax
  PDEVICE_OBJECT v3; // rcx
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  unsigned int v6; // ebx
  int v7; // eax
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  int v10; // eax
  __int64 v11[4]; // [rsp+20h] [rbp-C8h] BYREF
  int v12; // [rsp+40h] [rbp-A8h] BYREF
  char Dst[18]; // [rsp+44h] [rbp-A4h] BYREF
  char v14[110]; // [rsp+56h] [rbp-92h] BYREF
  int v15[3]; // [rsp+C4h] [rbp-24h] BYREF

  v12 = 33632256;
  memmove(Dst, L"Streamer", 0x12ui64);
  memset(v14, 0, sizeof(v14));
  v11[3] = 0i64;
  v11[0] = (__int64)sub_12DA0;
  qmemcpy(v15, "NSTR3", 5);
  v11[1] = (__int64)sub_130B4;
  v11[2] = (__int64)sub_13274;
  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xAu, (__int64)&unk_57D58);
      v0 = off_5A148;
    }
    if ( v0 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v0->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(v0->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v0->DeviceLock.Header.Lock, 0x1Cu, (__int64)&unk_57D58);
    }
  }
  byte_5A66D = 1;
  sub_3D230((__int64)&FastMutex);
  sub_3D310(&FastMutex);
  qword_5D5C8 = (__int64)&qword_5D5C0;
  qword_5D5C0 = &qword_5D5C0;
  sub_3D3DC(&FastMutex);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Du, (__int64)&unk_57D58);
  }
  v1 = sub_44834((__int64)&v12, 176i64, v11);
  if ( v1 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xBu, (__int64)&unk_57D58, v1);
    }
    return 258i64;
  }
  if ( (unsigned int)sub_43A78() )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xCu, (__int64)&unk_57D58);
    }
  }
  else
  {
    v3 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xF0u, (__int64)&unk_57C68);
      v3 = off_5A148;
    }
    byte_5A8D3 = 1;
    if ( v3 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EA4(*(_QWORD *)&v3->AlignmentRequirement, 0xF1u, (__int64)&unk_57C68, 0);
    }
  }
  if ( (unsigned int)sub_40498(40026, 1) )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_38;
    }
    v5 = 13;
LABEL_37:
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, v5, (__int64)&unk_57D58);
LABEL_38:
    sub_451A0();
    return 258i64;
  }
  if ( (unsigned int)sub_40498(40008, 1) )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_38;
    }
    v5 = 14;
    goto LABEL_37;
  }
  if ( (unsigned int)sub_40498(40031, 1) )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_38;
    }
    v5 = 15;
    goto LABEL_37;
  }
  if ( (unsigned int)sub_40498(40009, 1) )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_38;
    }
    v5 = 16;
    goto LABEL_37;
  }
  if ( (unsigned int)sub_40498(40010, 1) )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_38;
    }
    v5 = 17;
    goto LABEL_37;
  }
  if ( (unsigned int)sub_43D48(40021) )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_38;
    }
    v5 = 18;
    goto LABEL_37;
  }
  if ( (unsigned int)sub_43D48(40023) )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_38;
    }
    v5 = 19;
    goto LABEL_37;
  }
  if ( (unsigned int)sub_43D48(40022) )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_38;
    }
    v5 = 20;
    goto LABEL_37;
  }
  if ( (unsigned int)sub_43D48(40039) )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_38;
    }
    v5 = 21;
    goto LABEL_37;
  }
  if ( (unsigned int)sub_43D48(40044) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x16u, (__int64)&unk_57D58);
    }
    v6 = 258;
    goto LABEL_107;
  }
  sub_40678(40000, (__int64)sub_18E14);
  sub_40678(40031, (__int64)sub_27C7C);
  sub_43E38();
  sub_44024();
  sub_403FC(0);
  if ( (unsigned int)sub_4086C() )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x17u, (__int64)&unk_57D58);
    }
    v6 = 259;
    goto LABEL_107;
  }
  sub_44D2C();
  v7 = sub_19A3C();
  v6 = v7;
  if ( v7 )
  {
    v8 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_107;
    }
    v9 = 24;
LABEL_106:
    sub_13EA4(*(_QWORD *)&v8->DeviceLock.Header.Lock, v9, (__int64)&unk_57D58, v7);
LABEL_107:
    sub_451A0();
    return v6;
  }
  v10 = sub_386DC();
  if ( v10
    && off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x19u, (__int64)&unk_57D58, v10);
  }
  v7 = sub_13AA4();
  v6 = v7;
  if ( v7 )
  {
    v8 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_107;
    }
    v9 = 26;
    goto LABEL_106;
  }
  byte_5A66E = 1;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Bu, (__int64)&unk_57D58);
  }
  return 0i64;
}
// 56720: using guessed type wchar_t aStreamer[9];
// 5A66D: using guessed type char byte_5A66D;
// 5A66E: using guessed type char byte_5A66E;
// 5A8D3: using guessed type char byte_5A8D3;
// 5D5C8: using guessed type __int64 qword_5D5C8;

//----- (0000000000013AA4) ----------------------------------------------------
__int64 sub_13AA4()
{
  int v0; // eax
  unsigned int v1; // ebx
  PDEVICE_OBJECT v2; // rcx
  unsigned __int16 v3; // dx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Eu, (__int64)&unk_57D58);
  }
  v0 = sub_40E90(5u, (__int64)&qword_5A678);
  v1 = v0;
  if ( v0 )
  {
    v2 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return v1;
    }
    v3 = 31;
LABEL_10:
    sub_13EA4(*(_QWORD *)&v2->DeviceLock.Header.Lock, v3, (__int64)&unk_57D58, v0);
    return v1;
  }
  v0 = sub_40E90(0xBu, (__int64)&qword_5A898);
  v1 = v0;
  if ( v0 )
  {
    v2 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return v1;
    }
    v3 = 32;
    goto LABEL_10;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x21u, (__int64)&unk_57D58);
  }
  return 0i64;
}
// 5A678: using guessed type __int64 qword_5A678;
// 5A898: using guessed type __int64 qword_5A898;

//----- (0000000000013BC4) ----------------------------------------------------
__int64 sub_13BC4()
{
  int v0; // eax
  unsigned int v1; // ebx
  PDEVICE_OBJECT v2; // rcx
  PVOID v3; // rcx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x24u, (__int64)&unk_57D58);
  }
  if ( byte_5A66E )
    sub_45074();
  sub_40FE0();
  v0 = sub_19FA4();
  v1 = v0;
  if ( !v0 )
    goto LABEL_12;
  v2 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    goto LABEL_17;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x25u, (__int64)&unk_57D58, v0);
LABEL_12:
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x27u, (__int64)&unk_57D58);
    v2 = off_5A148;
  }
LABEL_17:
  if ( byte_5A66D )
  {
    sub_3D310(&FastMutex);
    while ( 1 )
    {
      v3 = qword_5D5C0;
      if ( qword_5D5C0 == &qword_5D5C0 )
        break;
      qword_5D5C0 = *(PVOID *)qword_5D5C0;
      *((_QWORD *)qword_5D5C0 + 1) = &qword_5D5C0;
      sub_3C570(v3, 0x746D7453u);
    }
    sub_3D3DC(&FastMutex);
    byte_5A66D = 0;
    goto LABEL_26;
  }
  if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
    goto LABEL_31;
  if ( (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x28u, (__int64)&unk_57D58);
LABEL_26:
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x29u, (__int64)&unk_57D58);
    v2 = off_5A148;
  }
LABEL_31:
  if ( byte_5A66E )
  {
    sub_451A0();
    v2 = off_5A148;
    byte_5A66E = 0;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x12u, (__int64)&unk_57CE8);
    v2 = off_5A148;
  }
  if ( qword_5D528 )
  {
    sub_3F7C8(&qword_5D528, (void (__fastcall *)(__int64 *))sub_38CE4);
    v2 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v1;
    if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      goto LABEL_47;
    }
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x14u, (__int64)&unk_57CE8, 0);
    goto LABEL_46;
  }
  if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
    return v1;
  if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x13u, (__int64)&unk_57CE8);
LABEL_46:
    v2 = off_5A148;
  }
LABEL_47:
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x26u, (__int64)&unk_57D58);
  }
  return v1;
}
// 5A66D: using guessed type char byte_5A66D;
// 5A66E: using guessed type char byte_5A66E;
// 5D528: using guessed type __int64 qword_5D528;

//----- (0000000000013EA4) ----------------------------------------------------
__int64 __fastcall sub_13EA4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+68h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, a3, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000013EE0) ----------------------------------------------------
__int64 sub_13EE0(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, a3, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000013F28) ----------------------------------------------------
__int64 sub_13F28(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D48, 79i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000013F8C) ----------------------------------------------------
__int64 __fastcall sub_13F8C(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_5A1B8(a1, 43i64, a3, a2, v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014004) ----------------------------------------------------
__int64 __fastcall sub_14004(unsigned int a1, int *a2, __int64 *a3)
{
  unsigned int v6; // ebx
  PDEVICE_OBJECT v7; // rcx
  int v8; // edx
  int v9; // edx
  int v10; // edx
  int v11; // edx
  int v12; // edx
  unsigned int v13; // eax
  int v14; // edx
  int v15; // edx
  int v16; // edx
  int v17; // edx
  int v18; // edx
  int v19; // edx
  int v20; // edx
  int v21; // edx
  int v22; // edx
  int v23; // edx
  int v24; // edx

  v6 = 0;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xAu, (__int64)&unk_57D48);
    v7 = off_5A148;
  }
  v8 = *a2;
  if ( *a2 <= 13 )
  {
    if ( v8 == 13 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x19u, (__int64)&unk_57D48);
      }
      v13 = sub_156AC(a3);
      goto LABEL_144;
    }
    if ( v8 > 6 )
    {
      v14 = v8 - 7;
      if ( !v14 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x13u, (__int64)&unk_57D48);
        }
        v13 = sub_15174((__int64)a3);
        goto LABEL_144;
      }
      v15 = v14 - 1;
      if ( !v15 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x17u, (__int64)&unk_57D48);
        }
        v13 = sub_15FA0((__int64)a3);
        goto LABEL_144;
      }
      v16 = v15 - 1;
      if ( !v16 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x18u, (__int64)&unk_57D48);
        }
        v13 = sub_15444(a1, (__int64)a3);
        goto LABEL_144;
      }
      v17 = v16 - 2;
      if ( !v17 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0xFu, (__int64)&unk_57D48);
        }
        v13 = sub_14C10(a3);
        goto LABEL_144;
      }
      if ( v17 == 1 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x10u, (__int64)&unk_57D48);
        }
        v13 = sub_14D58(a3);
        goto LABEL_144;
      }
    }
    else
    {
      if ( v8 == 6 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x12u, (__int64)&unk_57D48);
        }
        v13 = sub_14FF4((__int64)a3);
        goto LABEL_144;
      }
      v9 = v8 - 1;
      if ( !v9 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0xBu, (__int64)&unk_57D48);
        }
        v13 = sub_14694((__int64)a3);
        goto LABEL_144;
      }
      v10 = v9 - 1;
      if ( !v10 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0xCu, (__int64)&unk_57D48);
        }
        v13 = sub_14948((__int64)a3);
        goto LABEL_144;
      }
      v11 = v10 - 1;
      if ( !v11 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0xDu, (__int64)&unk_57D48);
        }
        v13 = sub_152D4((__int64)a3);
        goto LABEL_144;
      }
      v12 = v11 - 1;
      if ( !v12 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0xEu, (__int64)&unk_57D48);
        }
        v13 = sub_14AA8((__int64)a3);
        goto LABEL_144;
      }
      if ( v12 == 1 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x11u, (__int64)&unk_57D48);
        }
        v13 = sub_14EA4((__int64)a3);
LABEL_144:
        v6 = v13;
        goto LABEL_145;
      }
    }
LABEL_119:
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x20u, (__int64)&unk_57D48);
      v7 = off_5A148;
    }
    v6 = 277;
    goto LABEL_146;
  }
  if ( v8 > 19 )
  {
    v22 = v8 - 20;
    if ( !v22 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1Fu, (__int64)&unk_57D48);
      }
      v13 = sub_16970((__int64)a3);
      goto LABEL_144;
    }
    v23 = v22 - 1;
    if ( !v23 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1Cu, (__int64)&unk_57D48);
      }
      v13 = sub_1615C(a1, (__int64)a3);
      goto LABEL_144;
    }
    v24 = v23 - 1;
    if ( !v24 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1Du, (__int64)&unk_57D48);
      }
      v13 = sub_16408(a1, (__int64)a3);
      goto LABEL_144;
    }
    if ( v24 == 1 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x21u, (__int64)&unk_57D48);
      }
      v13 = sub_3B228(a3);
      goto LABEL_144;
    }
    goto LABEL_119;
  }
  if ( v8 != 19 )
  {
    v18 = v8 - 14;
    if ( !v18 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1Au, (__int64)&unk_57D48);
      }
      v13 = sub_15DF4(a3);
      goto LABEL_144;
    }
    v19 = v18 - 1;
    if ( !v19 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1Bu, (__int64)&unk_57D48);
      }
      v13 = sub_15858(a3);
      goto LABEL_144;
    }
    v20 = v19 - 1;
    if ( !v20 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x14u, (__int64)&unk_57D48);
      }
      v13 = sub_15A04((__int64)a3);
      goto LABEL_144;
    }
    v21 = v20 - 1;
    if ( !v21 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x15u, (__int64)&unk_57D48);
      }
      v13 = sub_15B30(a3);
      goto LABEL_144;
    }
    if ( v21 == 1 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x16u, (__int64)&unk_57D48);
      }
      v13 = sub_15C8C(a3);
      goto LABEL_144;
    }
    goto LABEL_119;
  }
  if ( v7 == (PDEVICE_OBJECT)&off_5A148 )
    return v6;
  if ( (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1Eu, (__int64)&unk_57D48);
LABEL_145:
    v7 = off_5A148;
  }
LABEL_146:
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x22u, (__int64)&unk_57D48);
  }
  return v6;
}

//----- (0000000000014694) ----------------------------------------------------
__int64 __fastcall sub_14694(__int64 a1)
{
  __int64 v2; // rbx
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  unsigned __int16 v5; // ax
  __int64 v6; // rax
  int v7; // eax
  unsigned int v8; // ebx
  unsigned __int64 *v10; // [rsp+30h] [rbp-48h] BYREF
  __int64 v11; // [rsp+38h] [rbp-40h]
  __int64 v12; // [rsp+40h] [rbp-38h]
  __int64 v13; // [rsp+48h] [rbp-30h] BYREF
  __int64 v14[4]; // [rsp+50h] [rbp-28h] BYREF
  int v15; // [rsp+80h] [rbp+8h] BYREF

  v15 = 0;
  v13 = 0i64;
  v11 = 0i64;
  v12 = 0i64;
  memset(v14, 0, sizeof(v14));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x23u, (__int64)&unk_57D48);
  }
  v2 = sub_49034(qword_5A8C0, *(_QWORD *)(a1 + 20), 0i64, &v15);
  if ( v15 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x27u, (__int64)&unk_57D48, *(_QWORD *)(a1 + 20), v15);
    }
  }
  else
  {
    v3 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x24u, (__int64)&unk_57D48, *(_QWORD *)(a1 + 20));
      v3 = off_5A148;
    }
    v4 = *(_WORD *)(v2 + 32);
    WORD2(v14[1]) = v4;
    v5 = *(_WORD *)(v2 + 40);
    HIWORD(v14[1]) = v5;
    if ( v3 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EA4(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x25u, (__int64)&unk_57D48, v4);
        v5 = HIWORD(v14[1]);
        v3 = off_5A148;
      }
      if ( v3 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EA4(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x26u, (__int64)&unk_57D48, v5);
      }
    }
  }
  LODWORD(v14[1]) = *(_DWORD *)(a1 + 16);
  v6 = *(_QWORD *)(a1 + 20);
  LODWORD(v11) = 40;
  v14[2] = v6;
  v14[3] = *(_QWORD *)(a1 + 28);
  v14[0] = *(_QWORD *)(a1 + 8);
  v10 = (unsigned __int64 *)&v13;
  v7 = sub_28AF8(769, &v10);
  v8 = v7;
  if ( v7 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x28u, (__int64)&unk_57D48, v7);
    }
    *(_QWORD *)a1 = 0i64;
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x29u, (__int64)&unk_57D48);
    }
    *(_QWORD *)a1 = v13;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Au, (__int64)&unk_57D48);
  }
  return v8;
}

//----- (0000000000014948) ----------------------------------------------------
__int64 __fastcall sub_14948(__int64 a1)
{
  __int64 v2; // rax
  int v3; // eax
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  __int64 v7; // [rsp+20h] [rbp-38h] BYREF
  __int64 v8; // [rsp+28h] [rbp-30h]
  __int64 v9; // [rsp+30h] [rbp-28h]
  unsigned __int64 *v10; // [rsp+38h] [rbp-20h] BYREF
  __int64 v11; // [rsp+40h] [rbp-18h]
  __int64 v12; // [rsp+48h] [rbp-10h]

  v7 = 0i64;
  v11 = 0i64;
  v12 = 0i64;
  v8 = 0i64;
  v9 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Bu, (__int64)&unk_57D48);
  }
  v7 = *(_QWORD *)a1;
  v2 = *(_QWORD *)(a1 + 8);
  LODWORD(v11) = 24;
  v8 = v2;
  LODWORD(v9) = *(_DWORD *)(a1 + 16);
  v10 = (unsigned __int64 *)&v7;
  v3 = sub_28AF8(771, &v10);
  v4 = v3;
  if ( !v3 )
  {
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v4;
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      goto LABEL_15;
    }
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Du, (__int64)&unk_57D48);
    goto LABEL_14;
  }
  v5 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v4;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Cu, (__int64)&unk_57D48, v3);
LABEL_14:
    v5 = off_5A148;
  }
LABEL_15:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x2Eu, (__int64)&unk_57D48);
  }
  return v4;
}

//----- (0000000000014AA8) ----------------------------------------------------
__int64 __fastcall sub_14AA8(__int64 a1)
{
  __int64 v2; // rax
  int v3; // eax
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  unsigned __int64 *v7; // [rsp+20h] [rbp-48h] BYREF
  __int64 v8; // [rsp+28h] [rbp-40h]
  __int64 v9; // [rsp+30h] [rbp-38h]
  __int64 v10; // [rsp+38h] [rbp-30h] BYREF
  __int64 v11; // [rsp+40h] [rbp-28h]
  __int64 v12; // [rsp+48h] [rbp-20h]
  __int64 v13; // [rsp+50h] [rbp-18h]

  v10 = 0i64;
  v8 = 0i64;
  v9 = 0i64;
  v11 = 0i64;
  v12 = 0i64;
  v13 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Fu, (__int64)&unk_57D48);
  }
  v10 = *(_QWORD *)a1;
  v2 = *(_QWORD *)(a1 + 12);
  LODWORD(v8) = 32;
  v12 = v2;
  LODWORD(v13) = *(_DWORD *)(a1 + 8);
  LODWORD(v11) = v13;
  v7 = (unsigned __int64 *)&v10;
  v3 = sub_28AF8(773, &v7);
  v4 = v3;
  if ( !v3 )
  {
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v4;
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_15;
    }
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x31u, (__int64)&unk_57D48);
    goto LABEL_14;
  }
  v5 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v4;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x30u, (__int64)&unk_57D48, v3);
LABEL_14:
    v5 = off_5A148;
  }
LABEL_15:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x32u, (__int64)&unk_57D48);
  }
  return v4;
}

//----- (0000000000014C10) ----------------------------------------------------
__int64 __fastcall sub_14C10(__int64 *a1)
{
  int v2; // eax
  unsigned int v3; // ebx
  PDEVICE_OBJECT v4; // rcx
  unsigned __int64 *v6; // [rsp+20h] [rbp-28h] BYREF
  __int64 v7; // [rsp+28h] [rbp-20h]
  __int64 v8; // [rsp+30h] [rbp-18h]
  __int64 v9; // [rsp+50h] [rbp+8h] BYREF

  v9 = 0i64;
  v7 = 0i64;
  v8 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x33u, (__int64)&unk_57D48);
  }
  v9 = *a1;
  LODWORD(v7) = 8;
  v6 = (unsigned __int64 *)&v9;
  v2 = sub_28AF8(770, &v6);
  v3 = v2;
  if ( !v2 )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v3;
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_15;
    }
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x35u, (__int64)&unk_57D48);
    goto LABEL_14;
  }
  v4 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v3;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x34u, (__int64)&unk_57D48, v2);
LABEL_14:
    v4 = off_5A148;
  }
LABEL_15:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x36u, (__int64)&unk_57D48);
  }
  return v3;
}

//----- (0000000000014D58) ----------------------------------------------------
__int64 __fastcall sub_14D58(__int64 *a1)
{
  int v2; // eax
  unsigned int v3; // ebx
  PDEVICE_OBJECT v4; // rcx
  unsigned __int64 *v6; // [rsp+20h] [rbp-28h] BYREF
  __int64 v7; // [rsp+28h] [rbp-20h]
  __int64 v8; // [rsp+30h] [rbp-18h]
  __int64 v9; // [rsp+50h] [rbp+8h] BYREF

  v9 = 0i64;
  v7 = 0i64;
  v8 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x37u, (__int64)&unk_57D48);
  }
  v9 = *a1;
  LODWORD(v7) = 8;
  v6 = (unsigned __int64 *)&v9;
  v2 = sub_28AF8(781, &v6);
  v3 = v2;
  if ( !v2 )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v3;
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_15;
    }
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x39u, (__int64)&unk_57D48);
    goto LABEL_14;
  }
  v4 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v3;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x38u, (__int64)&unk_57D48, v2);
LABEL_14:
    v4 = off_5A148;
  }
LABEL_15:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x3Au, (__int64)&unk_57D48);
  }
  return v3;
}

//----- (0000000000014EA4) ----------------------------------------------------
__int64 __fastcall sub_14EA4(__int64 a1)
{
  int v2; // eax
  int v3; // eax
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  __int64 v7; // [rsp+20h] [rbp-38h] BYREF
  __int64 v8; // [rsp+28h] [rbp-30h]
  unsigned __int64 *v9; // [rsp+30h] [rbp-28h] BYREF
  __int64 v10; // [rsp+38h] [rbp-20h]
  __int64 v11; // [rsp+40h] [rbp-18h]

  v7 = 0i64;
  v10 = 0i64;
  v11 = 0i64;
  v8 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Bu, (__int64)&unk_57D48);
  }
  v7 = *(_QWORD *)a1;
  v2 = *(_DWORD *)(a1 + 8);
  LODWORD(v10) = 16;
  LODWORD(v8) = v2;
  v9 = (unsigned __int64 *)&v7;
  v3 = sub_28AF8(774, &v9);
  v4 = v3;
  if ( !v3 )
  {
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v4;
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_15;
    }
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Du, (__int64)&unk_57D48);
    goto LABEL_14;
  }
  v5 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v4;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Cu, (__int64)&unk_57D48, v3);
LABEL_14:
    v5 = off_5A148;
  }
LABEL_15:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x3Eu, (__int64)&unk_57D48);
  }
  return v4;
}

//----- (0000000000014FF4) ----------------------------------------------------
__int64 __fastcall sub_14FF4(__int64 a1)
{
  __int64 v2; // rax
  int v3; // eax
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  unsigned __int64 *v7; // [rsp+20h] [rbp-48h] BYREF
  __int64 v8; // [rsp+28h] [rbp-40h]
  __int64 v9; // [rsp+30h] [rbp-38h]
  __int64 v10; // [rsp+38h] [rbp-30h] BYREF
  __int64 v11[4]; // [rsp+40h] [rbp-28h] BYREF

  v10 = 0i64;
  v8 = 0i64;
  v9 = 0i64;
  memset(v11, 0, sizeof(v11));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Fu, (__int64)&unk_57D48);
  }
  v10 = *(_QWORD *)a1;
  v2 = *(_QWORD *)(a1 + 12);
  LODWORD(v8) = 40;
  v11[1] = v2;
  LODWORD(v11[0]) = *(_DWORD *)(a1 + 8);
  v11[2] = *(_QWORD *)(a1 + 20);
  LODWORD(v11[3]) = *(_DWORD *)(a1 + 28);
  BYTE4(v11[3]) = *(_BYTE *)(a1 + 32);
  v7 = (unsigned __int64 *)&v10;
  v3 = sub_28AF8(775, &v7);
  v4 = v3;
  if ( !v3 )
  {
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v4;
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_15;
    }
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x41u, (__int64)&unk_57D48);
    goto LABEL_14;
  }
  v5 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v4;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x40u, (__int64)&unk_57D48, v3);
LABEL_14:
    v5 = off_5A148;
  }
LABEL_15:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x42u, (__int64)&unk_57D48);
  }
  return v4;
}

//----- (0000000000015174) ----------------------------------------------------
__int64 __fastcall sub_15174(__int64 a1)
{
  __int64 v2; // rax
  int v3; // eax
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  __int64 v7; // [rsp+20h] [rbp-38h] BYREF
  __int64 v8; // [rsp+28h] [rbp-30h]
  __int64 v9; // [rsp+30h] [rbp-28h]
  unsigned __int64 *v10; // [rsp+38h] [rbp-20h] BYREF
  __int64 v11; // [rsp+40h] [rbp-18h]
  __int64 v12; // [rsp+48h] [rbp-10h]

  v7 = 0i64;
  v11 = 0i64;
  v12 = 0i64;
  v8 = 0i64;
  v9 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x43u, (__int64)&unk_57D48);
  }
  v7 = *(_QWORD *)a1;
  v2 = *(_QWORD *)(a1 + 8);
  LODWORD(v11) = 24;
  v8 = v2;
  LOBYTE(v9) = *(_BYTE *)(a1 + 16);
  v10 = (unsigned __int64 *)&v7;
  v3 = sub_28AF8(776, &v10);
  v4 = v3;
  if ( !v3 )
  {
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v4;
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_15;
    }
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x45u, (__int64)&unk_57D48);
    goto LABEL_14;
  }
  v5 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v4;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x44u, (__int64)&unk_57D48, v3);
LABEL_14:
    v5 = off_5A148;
  }
LABEL_15:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x46u, (__int64)&unk_57D48);
  }
  return v4;
}

//----- (00000000000152D4) ----------------------------------------------------
__int64 __fastcall sub_152D4(__int64 a1)
{
  int v2; // eax
  int v3; // eax
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  __int64 v7; // [rsp+20h] [rbp-38h] BYREF
  __int64 v8; // [rsp+28h] [rbp-30h]
  __int64 v9; // [rsp+30h] [rbp-28h]
  unsigned __int64 *v10; // [rsp+38h] [rbp-20h] BYREF
  __int64 v11; // [rsp+40h] [rbp-18h]
  __int64 v12; // [rsp+48h] [rbp-10h]

  v7 = 0i64;
  v11 = 0i64;
  v12 = 0i64;
  v8 = 0i64;
  v9 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x47u, (__int64)&unk_57D48);
  }
  v7 = *(_QWORD *)a1;
  v2 = *(_DWORD *)(a1 + 8);
  LODWORD(v11) = 24;
  LODWORD(v8) = v2;
  v9 = *(_QWORD *)(a1 + 12);
  v10 = (unsigned __int64 *)&v7;
  v3 = sub_28AF8(772, &v10);
  v4 = v3;
  if ( !v3 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x49u, (__int64)&unk_57D48);
    }
    *(_QWORD *)(a1 + 12) = v9;
    goto LABEL_15;
  }
  v5 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v4;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x48u, (__int64)&unk_57D48, v3);
LABEL_15:
    v5 = off_5A148;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x4Au, (__int64)&unk_57D48);
  }
  return v4;
}

//----- (0000000000015444) ----------------------------------------------------
__int64 __fastcall sub_15444(int a1, __int64 a2)
{
  _QWORD *v4; // rdi
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx
  _QWORD *v8; // rax
  _QWORD *v9; // rbp
  signed __int64 v10; // rcx
  PDEVICE_OBJECT v11; // rcx
  const char *v12; // rax
  unsigned int v13; // ebx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Bu, (__int64)&unk_57D48);
  }
  v4 = sub_3D584((__int64)qword_5A660, 32, (__int64)sub_16730, (__int64)sub_176CC);
  if ( !v4 )
  {
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v6 = 76;
LABEL_10:
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, v6, (__int64)&unk_57D48);
    return 3i64;
  }
  v8 = sub_3C4EC(2, 8u, 0x6D707453u);
  v9 = v8;
  if ( !v8 )
  {
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v6 = 77;
    goto LABEL_10;
  }
  *v8 = *(_QWORD *)(a2 + 16);
  *(_DWORD *)v4 = a1;
  *((_DWORD *)v4 + 1) = 779;
  v4[2] = v8;
  *((_DWORD *)v4 + 6) = 8;
  v10 = _InterlockedIncrement64(&qword_5D418);
  v4[1] = v10;
  **(_QWORD **)(a2 + 24) = v10;
  v11 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    v12 = sub_4A83C(a1);
    sub_13F8C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Eu, (__int64)&unk_57D48, v12);
    v11 = off_5A148;
  }
  v13 = (*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)) % (unsigned int)dword_5A194 + 1;
  if ( v11 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v11->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
    && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_13F28(
      *(_QWORD *)&v11->DeviceLock.Header.Lock,
      79i64,
      (__int64)&unk_57D48,
      *(_QWORD *)a2,
      *v9,
      (*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)) % (unsigned int)dword_5A194 + 1,
      0);
  }
  sub_3D7EC((__int64)v4, v13);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x50u, (__int64)&unk_57D48);
  }
  return 0i64;
}
// 5A194: using guessed type int dword_5A194;
// 5D418: using guessed type __int64 qword_5D418;

//----- (00000000000156AC) ----------------------------------------------------
__int64 __fastcall sub_156AC(_QWORD *a1)
{
  _QWORD *v2; // rbx
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  _QWORD *v6; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x51u, (__int64)&unk_57D48);
  }
  v2 = sub_3D584((__int64)qword_5A660, 32, (__int64)sub_16730, (__int64)sub_176CC);
  if ( !v2 )
  {
    v3 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v4 = 82;
LABEL_10:
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, v4, (__int64)&unk_57D48);
    return 3i64;
  }
  v6 = sub_3C4EC(2, 0x10u, 0x6D707453u);
  if ( !v6 )
  {
    v3 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v4 = 83;
    goto LABEL_10;
  }
  *v6 = *a1;
  v6[1] = a1[1];
  *(_DWORD *)v2 = 0;
  v2[1] = 0i64;
  *((_DWORD *)v2 + 1) = 514;
  v2[2] = v6;
  *((_DWORD *)v2 + 6) = 8;
  sub_3D7EC((__int64)v2, (*(_DWORD *)a1 + *((_DWORD *)a1 + 2)) % (unsigned int)dword_5A194 + 1);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x54u, (__int64)&unk_57D48);
  }
  return 0i64;
}
// 5A194: using guessed type int dword_5A194;

//----- (0000000000015858) ----------------------------------------------------
__int64 __fastcall sub_15858(_QWORD *a1)
{
  _QWORD *v2; // rbx
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  _QWORD *v6; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x55u, (__int64)&unk_57D48);
  }
  v2 = sub_3D584((__int64)qword_5A660, 32, (__int64)sub_16730, (__int64)sub_176CC);
  if ( !v2 )
  {
    v3 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v4 = 86;
LABEL_10:
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, v4, (__int64)&unk_57D48);
    return 3i64;
  }
  v6 = sub_3C4EC(2, 0x10u, 0x6D707453u);
  if ( !v6 )
  {
    v3 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v4 = 87;
    goto LABEL_10;
  }
  *v6 = *a1;
  v6[1] = a1[1];
  *(_DWORD *)v2 = 0;
  v2[1] = 0i64;
  *((_DWORD *)v2 + 1) = 515;
  v2[2] = v6;
  *((_DWORD *)v2 + 6) = 8;
  sub_3D7EC((__int64)v2, (*(_DWORD *)a1 + *((_DWORD *)a1 + 2)) % (unsigned int)dword_5A194 + 1);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x58u, (__int64)&unk_57D48);
  }
  return 0i64;
}
// 5A194: using guessed type int dword_5A194;

//----- (0000000000015A04) ----------------------------------------------------
__int64 __fastcall sub_15A04(__int64 a1)
{
  __int64 v2; // rax
  int v3; // eax
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  __int64 v7[2]; // [rsp+20h] [rbp-38h] BYREF
  int v8; // [rsp+30h] [rbp-28h]
  __int64 *v9; // [rsp+38h] [rbp-20h] BYREF
  __int64 v10; // [rsp+40h] [rbp-18h]
  __int64 v11; // [rsp+48h] [rbp-10h]

  LODWORD(v7[0]) = 0;
  v10 = 0i64;
  v11 = 0i64;
  memset((char *)v7 + 4, 0, 0x14ui64);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x59u, (__int64)&unk_57D48);
  }
  v7[0] = *(_QWORD *)a1;
  v2 = *(_QWORD *)(a1 + 8);
  LODWORD(v10) = 24;
  v7[1] = v2;
  v8 = *(_DWORD *)(a1 + 16);
  v9 = v7;
  v3 = sub_1F7D8(518, (__int64 *)&v9);
  v4 = v3;
  if ( !v3 )
    goto LABEL_10;
  v5 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v4;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Au, (__int64)&unk_57D48, v3);
LABEL_10:
    v5 = off_5A148;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x5Bu, (__int64)&unk_57D48);
  }
  return v4;
}

//----- (0000000000015B30) ----------------------------------------------------
__int64 __fastcall sub_15B30(__int64 *a1)
{
  __int64 v2; // rax
  int v3; // eax
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  __int64 v7; // [rsp+20h] [rbp-38h] BYREF
  __int64 v8; // [rsp+28h] [rbp-30h]
  __int64 *v9; // [rsp+30h] [rbp-28h] BYREF
  __int64 v10; // [rsp+38h] [rbp-20h]
  __int64 v11; // [rsp+40h] [rbp-18h]

  v7 = 0i64;
  v10 = 0i64;
  v11 = 0i64;
  v8 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Cu, (__int64)&unk_57D48);
  }
  v7 = *a1;
  v2 = a1[1];
  LODWORD(v10) = 16;
  v8 = v2;
  v9 = &v7;
  v3 = sub_1F7D8(521, (__int64 *)&v9);
  v4 = v3;
  if ( !v3 )
  {
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v4;
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_15;
    }
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Eu, (__int64)&unk_57D48);
    goto LABEL_14;
  }
  v5 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v4;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Du, (__int64)&unk_57D48, v3);
LABEL_14:
    v5 = off_5A148;
  }
LABEL_15:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x5Fu, (__int64)&unk_57D48);
  }
  return v4;
}

//----- (0000000000015C8C) ----------------------------------------------------
__int64 __fastcall sub_15C8C(__int64 *a1)
{
  __int64 v2; // rax
  int v3; // eax
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  __int64 v7[3]; // [rsp+20h] [rbp-38h] BYREF
  __int64 *v8; // [rsp+38h] [rbp-20h] BYREF
  __int64 v9; // [rsp+40h] [rbp-18h]
  __int64 v10; // [rsp+48h] [rbp-10h]

  LODWORD(v7[0]) = 0;
  v9 = 0i64;
  v10 = 0i64;
  memset((char *)v7 + 4, 0, 0x14ui64);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x60u, (__int64)&unk_57D48);
  }
  v7[0] = *a1;
  v2 = a1[1];
  LODWORD(v9) = 24;
  v7[1] = v2;
  v7[2] = a1[2];
  v8 = v7;
  v3 = sub_1F7D8(523, (__int64 *)&v8);
  v4 = v3;
  if ( !v3 )
  {
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v4;
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_15;
    }
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x62u, (__int64)&unk_57D48);
    goto LABEL_14;
  }
  v5 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v4;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x61u, (__int64)&unk_57D48, v3);
LABEL_14:
    v5 = off_5A148;
  }
LABEL_15:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x63u, (__int64)&unk_57D48);
  }
  return v4;
}

//----- (0000000000015DF4) ----------------------------------------------------
__int64 __fastcall sub_15DF4(_QWORD *a1)
{
  _QWORD *v2; // rbx
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  _QWORD *v6; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x68u, (__int64)&unk_57D48);
  }
  v2 = sub_3D584((__int64)qword_5A660, 32, (__int64)sub_16730, (__int64)sub_176CC);
  if ( !v2 )
  {
    v3 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v4 = 105;
LABEL_10:
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, v4, (__int64)&unk_57D48);
    return 3i64;
  }
  v6 = sub_3C4EC(2, 0x10u, 0x6D707453u);
  if ( !v6 )
  {
    v3 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v4 = 106;
    goto LABEL_10;
  }
  *v6 = *a1;
  v6[1] = a1[1];
  *(_DWORD *)v2 = 0;
  v2[1] = 0i64;
  *((_DWORD *)v2 + 1) = 522;
  v2[2] = v6;
  *((_DWORD *)v2 + 6) = 8;
  sub_3D7EC((__int64)v2, (*(_DWORD *)a1 + *((_DWORD *)a1 + 2)) % (unsigned int)dword_5A194 + 1);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Bu, (__int64)&unk_57D48);
  }
  return 0i64;
}
// 5A194: using guessed type int dword_5A194;

//----- (0000000000015FA0) ----------------------------------------------------
__int64 __fastcall sub_15FA0(__int64 a1)
{
  _QWORD *v2; // rbx
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  _QWORD *v6; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Cu, (__int64)&unk_57D48);
  }
  v2 = sub_3D584((__int64)qword_5A660, 32, (__int64)sub_16730, (__int64)sub_176CC);
  if ( !v2 )
  {
    v3 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v4 = 109;
LABEL_10:
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, v4, (__int64)&unk_57D48);
    return 3i64;
  }
  v6 = sub_3C4EC(2, 0x10u, 0x6D707453u);
  if ( !v6 )
  {
    v3 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v4 = 110;
    goto LABEL_10;
  }
  *v6 = *(_QWORD *)(a1 + 25);
  v6[1] = *(_QWORD *)(a1 + 16);
  *(_DWORD *)v2 = 0;
  *((_DWORD *)v2 + 1) = 778;
  v2[2] = v6;
  *((_DWORD *)v2 + 6) = 8;
  v2[1] = _InterlockedIncrement64(&qword_5D418);
  sub_3D7EC((__int64)v2, (*(_DWORD *)a1 + *(_DWORD *)(a1 + 8)) % (unsigned int)dword_5A194 + 1);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Fu, (__int64)&unk_57D48);
  }
  return 0i64;
}
// 5A194: using guessed type int dword_5A194;
// 5D418: using guessed type __int64 qword_5D418;

//----- (000000000001615C) ----------------------------------------------------
__int64 __fastcall sub_1615C(unsigned int a1, __int64 a2)
{
  _QWORD *v4; // rdi
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx
  unsigned int *v8; // rax
  unsigned int *v9; // rbx
  __int64 v10; // rax
  unsigned int v11; // edx
  PVOID v12; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x70u, (__int64)&unk_57D48);
  }
  v4 = sub_3D584((__int64)qword_5A660, 32, (__int64)sub_16730, (__int64)sub_176CC);
  if ( !v4 )
  {
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v6 = 113;
LABEL_10:
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, v6, (__int64)&unk_57D48);
    return 3i64;
  }
  v8 = (unsigned int *)sub_3C4EC(2, 0x28u, 0x6E707453u);
  v9 = v8;
  if ( !v8 )
  {
    sub_3D714((__int64)v4);
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v6 = 114;
    goto LABEL_10;
  }
  memset(v8, 0, 0x28ui64);
  *(_QWORD *)v9 = *(_QWORD *)a2;
  v10 = *(_QWORD *)(a2 + 8);
  v9[4] = a1;
  *((_QWORD *)v9 + 1) = v10;
  v9[5] = *(_DWORD *)(a2 + 16);
  v11 = *(_DWORD *)(a2 + 28);
  v9[8] = v11;
  v12 = sub_3C4EC(2, v11, 0x6E707453u);
  *((_QWORD *)v9 + 3) = v12;
  if ( !v12 )
  {
    sub_3C570(v9, 0x6E707453u);
    sub_3D714((__int64)v4);
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v6 = 115;
    goto LABEL_10;
  }
  memset(v12, 0, v9[8]);
  memmove(*((void **)v9 + 3), *(const void **)(a2 + 20), *(unsigned int *)(a2 + 28));
  *(_DWORD *)v4 = 0;
  *((_DWORD *)v4 + 1) = 1281;
  v4[2] = v9;
  *((_DWORD *)v4 + 6) = 8;
  v4[1] = _InterlockedIncrement64(&qword_5D418);
  sub_3D7EC((__int64)v4, (*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)) % (unsigned int)dword_5A194 + 1);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x74u, (__int64)&unk_57D48);
  }
  return 0i64;
}
// 5A194: using guessed type int dword_5A194;
// 5D418: using guessed type __int64 qword_5D418;

//----- (0000000000016408) ----------------------------------------------------
__int64 __fastcall sub_16408(unsigned int a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  _QWORD *v5; // rbx
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  unsigned int *v9; // rax
  unsigned int *v10; // rsi
  __int64 v11; // rax
  unsigned int v12; // edx
  PVOID v13; // rax
  unsigned int v14; // esi
  __int64 v15; // [rsp+28h] [rbp-30h]

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x75u, (__int64)&unk_57D48);
      v4 = off_5A148;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EE0(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x76u, (__int64)&unk_57D48, *(_QWORD *)a2, *(_QWORD *)(a2 + 8));
    }
  }
  HIDWORD(v15) = 0;
  v5 = sub_3D584((__int64)qword_5A660, 32, (__int64)sub_16730, (__int64)sub_176CC);
  if ( !v5 )
  {
    v6 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v7 = 119;
LABEL_14:
    sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, v7, (__int64)&unk_57D48);
    return 3i64;
  }
  v9 = (unsigned int *)sub_3C4EC(2, 0x28u, 0x61707453u);
  v10 = v9;
  if ( !v9 )
  {
    sub_3D714((__int64)v5);
    v6 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v7 = 120;
    goto LABEL_14;
  }
  memset(v9, 0, 0x28ui64);
  *(_QWORD *)v10 = *(_QWORD *)a2;
  v11 = *(_QWORD *)(a2 + 8);
  v10[4] = a1;
  *((_QWORD *)v10 + 1) = v11;
  v10[5] = *(_DWORD *)(a2 + 16);
  v12 = *(_DWORD *)(a2 + 28);
  LODWORD(v15) = 0;
  v10[8] = v12;
  v13 = sub_3C4EC(2, v12, 0x61707453u);
  *((_QWORD *)v10 + 3) = v13;
  if ( !v13 )
  {
    sub_3C570(v10, 0x61707453u);
    sub_3D714((__int64)v5);
    v6 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v7 = 121;
    goto LABEL_14;
  }
  memset(v13, 0, v10[8]);
  memmove(*((void **)v10 + 3), *(const void **)(a2 + 20), *(unsigned int *)(a2 + 28));
  *(_DWORD *)v5 = 0;
  *((_DWORD *)v5 + 1) = 1282;
  v5[2] = v10;
  *((_DWORD *)v5 + 6) = 8;
  v5[1] = _InterlockedIncrement64(&qword_5D418);
  v14 = (*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)) % (unsigned int)dword_5A194 + 1;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_4AC00(
      *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
      0x7Au,
      (__int64)&unk_57D48,
      *(_QWORD *)a2,
      (*(_DWORD *)a2 + *(_DWORD *)(a2 + 8)) % (unsigned int)dword_5A194 + 1,
      v15,
      0);
  }
  sub_3D7EC((__int64)v5, v14);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x7Bu, (__int64)&unk_57D48);
  }
  return 0i64;
}
// 5A194: using guessed type int dword_5A194;
// 5D418: using guessed type __int64 qword_5D418;

//----- (0000000000016730) ----------------------------------------------------
__int64 __fastcall sub_16730(__int64 a1)
{
  __int64 result; // rax
  PDEVICE_OBJECT v3; // rcx
  int v4; // er9
  unsigned __int16 v5; // dx
  unsigned __int64 *v6; // [rsp+30h] [rbp-28h] BYREF
  __int64 v7; // [rsp+38h] [rbp-20h]
  __int64 v8; // [rsp+40h] [rbp-18h]

  result = 0i64;
  v7 = 0i64;
  v8 = 0i64;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x7Cu, (__int64)&unk_57D48);
    v3 = off_5A148;
  }
  v6 = (unsigned __int64 *)a1;
  LODWORD(v7) = 32;
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    result = sub_13EA4(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x7Du, (__int64)&unk_57D48, *(_DWORD *)(a1 + 4));
    v3 = off_5A148;
  }
  v4 = *(_DWORD *)(a1 + 4);
  if ( v4 >= 514 )
  {
    if ( v4 <= 515 || v4 == 522 )
    {
      result = sub_1F7D8(v4, (__int64 *)&v6);
      if ( !(_DWORD)result )
        goto LABEL_35;
      v3 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return result;
      if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        goto LABEL_36;
      }
      v5 = 127;
      goto LABEL_20;
    }
    if ( v4 > 777 )
    {
      if ( v4 <= 779 )
      {
        result = sub_28AF8(v4, &v6);
        if ( !(_DWORD)result )
          goto LABEL_35;
        v3 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
          return result;
        if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
          || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
        {
          goto LABEL_36;
        }
        v5 = 126;
        goto LABEL_20;
      }
      result = (unsigned int)(v4 - 1281);
      if ( (unsigned int)result <= 1 )
      {
        result = sub_39198(v4, (__int64 *)&v6);
        if ( !(_DWORD)result )
        {
LABEL_35:
          v3 = off_5A148;
          goto LABEL_36;
        }
        v3 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
          return result;
        if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
          || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
        {
          goto LABEL_36;
        }
        v5 = 128;
LABEL_20:
        result = sub_184C0(*(_QWORD *)&v3->DeviceLock.Header.Lock, v5, (__int64)&unk_57D48, *(_DWORD *)(a1 + 4));
        goto LABEL_35;
      }
    }
  }
  if ( v3 == (PDEVICE_OBJECT)&off_5A148 )
    return result;
  if ( (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    result = sub_13EA4(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x81u, (__int64)&unk_57D48, v4);
    goto LABEL_35;
  }
LABEL_36:
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x82u, (__int64)&unk_57D48);
  }
  return result;
}

//----- (0000000000016970) ----------------------------------------------------
__int64 __fastcall sub_16970(__int64 a1)
{
  PVOID *v2; // r11
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  _DWORD *v5; // rax
  _QWORD *v6; // r11
  _QWORD *v8; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x83u, (__int64)&unk_57D48);
  }
  if ( *(_BYTE *)(a1 + 4) )
  {
    sub_3D310(&FastMutex);
    v2 = (PVOID *)qword_5D5C0;
    if ( qword_5D5C0 != &qword_5D5C0 )
    {
      while ( *(_DWORD *)a1 != *((_DWORD *)v2 + 4) )
      {
        v2 = (PVOID *)*v2;
        if ( v2 == &qword_5D5C0 )
          goto LABEL_14;
      }
      *((_DWORD *)v2 + 5) = *(_DWORD *)(a1 + 5);
      *((_DWORD *)v2 + 6) = *(_DWORD *)(a1 + 9);
      *((_DWORD *)v2 + 7) = *(_DWORD *)(a1 + 17);
      *((_DWORD *)v2 + 8) = *(_DWORD *)(a1 + 13);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x84u, (__int64)&unk_57D48, *((_DWORD *)v2 + 4));
      }
    }
LABEL_14:
    sub_3D3DC(&FastMutex);
    return 0i64;
  }
  sub_3D310(&FastMutex);
  if ( sub_16CE8(*(_DWORD *)a1) )
  {
    sub_3D3DC(&FastMutex);
    v3 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      return 0i64;
    }
    v4 = 133;
LABEL_30:
    sub_13EA4(*(_QWORD *)&v3->DeviceLock.Header.Lock, v4, (__int64)&unk_57D48, *(_DWORD *)a1);
    return 0i64;
  }
  v5 = sub_3C4EC(2, 0x28u, 0x746D7453u);
  v6 = v5;
  if ( v5 )
  {
    v5[4] = *(_DWORD *)a1;
    v5[5] = *(_DWORD *)(a1 + 5);
    v5[6] = *(_DWORD *)(a1 + 9);
    v5[7] = *(_DWORD *)(a1 + 17);
    v5[8] = *(_DWORD *)(a1 + 13);
    v8 = qword_5D5C0;
    v6[1] = &qword_5D5C0;
    *v6 = v8;
    v8[1] = v6;
    qword_5D5C0 = v6;
    sub_3D3DC(&FastMutex);
    v3 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      return 0i64;
    }
    v4 = 135;
    goto LABEL_30;
  }
  sub_3D3DC(&FastMutex);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x86u, (__int64)&unk_57D48);
  }
  return 3i64;
}

//----- (0000000000016BDC) ----------------------------------------------------
char __fastcall sub_16BDC(int a1)
{
  char v2; // bl

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x88u, (__int64)&unk_57D48);
  }
  sub_3D310(&FastMutex);
  v2 = sub_16CE8(a1);
  if ( v2
    && off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x89u, (__int64)&unk_57D48, a1);
  }
  sub_3D3DC(&FastMutex);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x8Au, (__int64)&unk_57D48);
  }
  return v2;
}

//----- (0000000000016CE8) ----------------------------------------------------
char __fastcall sub_16CE8(int a1)
{
  PVOID *v1; // rax
  char v2; // bl
  const char *v3; // r9

  v1 = (PVOID *)qword_5D5C0;
  v2 = 0;
  while ( v1 != &qword_5D5C0 )
  {
    if ( a1 == *((_DWORD *)v1 + 4) )
    {
      v2 = 1;
      break;
    }
    v1 = (PVOID *)*v1;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    v3 = "IS NOT";
    if ( v2 )
      v3 = (const char *)qword_56740;
    sub_11190(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x8Bu, (__int64)&unk_57D48, v3);
  }
  return v2;
}
// 56740: using guessed type __int64 qword_56740[2];

//----- (0000000000016D7C) ----------------------------------------------------
__int64 __fastcall sub_16D7C(int a1)
{
  __int64 v2; // rax
  __int64 v3; // r8
  int v4; // eax
  int v5; // eax
  int v7; // [rsp+48h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+50h] [rbp+18h] BYREF

  BugCheckParameter1 = 0i64;
  v7 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x8Fu, (__int64)&unk_57D48);
  }
  KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
  v2 = sub_49870(qword_5A8C0, &BugCheckParameter1, &v7);
  if ( v2 )
  {
    do
    {
      if ( *(_DWORD *)(v2 + 24) == a1 )
      {
        LOBYTE(v3) = 1;
        sub_48DB0(qword_5A8C0, BugCheckParameter1, v3, &v7);
        if ( v7 )
        {
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
          {
            v5 = sub_4A538(v7);
            sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x91u, (__int64)&unk_57D48, v5);
          }
        }
      }
      LOBYTE(v3) = 1;
      v2 = sub_49A3C(qword_5A8C0, &BugCheckParameter1, v3, &v7);
    }
    while ( v2 );
  }
  else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
         && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
         && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v4 = sub_4A538(v7);
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x90u, (__int64)&unk_57D48, v4);
  }
  KeReleaseMutex(&Mutex, 0);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x92u, (__int64)&unk_57D48);
  }
  return 0i64;
}
// 16E7A: variable 'v3' is possibly undefined

//----- (0000000000016F48) ----------------------------------------------------
__int64 __fastcall sub_16F48(int a1)
{
  PDEVICE_OBJECT v2; // rcx
  unsigned int v3; // ebx
  PVOID *i; // rcx
  _QWORD *v5; // rdx
  PVOID *v6; // rax
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  __int64 v9; // rax
  __int64 v10; // r8
  PDEVICE_OBJECT v11; // rcx
  int v12; // eax
  int v13; // eax
  char *v14; // rbx
  char v15; // al
  int v17; // [rsp+58h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+60h] [rbp+18h] BYREF

  v2 = off_5A148;
  v3 = 4;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x97u, (__int64)&unk_57D48);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x8Cu, (__int64)&unk_57D48);
    }
  }
  sub_3D310(&FastMutex);
  for ( i = (PVOID *)qword_5D5C0; i != &qword_5D5C0; i = (PVOID *)*i )
  {
    if ( a1 == *((_DWORD *)i + 4) )
    {
      v5 = *i;
      v6 = (PVOID *)i[1];
      *v6 = *i;
      v5[1] = v6;
      sub_3C570(i, 0x746D7453u);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x8Du, (__int64)&unk_57D48, a1);
      }
      break;
    }
  }
  sub_3D3DC(&FastMutex);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x8Eu, (__int64)&unk_57D48);
  }
  if ( (unsigned int)sub_16D7C(a1) )
  {
    v7 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      v8 = 152;
LABEL_31:
      sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, v8, (__int64)&unk_57D48);
      v7 = off_5A148;
      goto LABEL_32;
    }
  }
  else
  {
    v7 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v8 = 153;
      goto LABEL_31;
    }
  }
LABEL_32:
  BugCheckParameter1 = 0i64;
  v17 = 0;
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x93u, (__int64)&unk_57D48);
  }
  v9 = sub_49870(qword_5A8D8, &BugCheckParameter1, &v17);
  if ( v9 )
  {
    do
    {
      if ( *(_DWORD *)(v9 + 32) == a1 )
      {
        LOBYTE(v10) = 1;
        sub_48DB0(qword_5A8D8, BugCheckParameter1, v10, &v17);
        if ( v17 )
        {
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
          {
            v13 = sub_4A538(v17);
            sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x95u, (__int64)&unk_57D48, v13);
          }
        }
      }
      LOBYTE(v10) = 1;
      v9 = sub_49A3C(qword_5A8D8, &BugCheckParameter1, v10, &v17);
    }
    while ( v9 );
    goto LABEL_48;
  }
  v11 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    goto LABEL_57;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v12 = sub_4A538(v17);
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x94u, (__int64)&unk_57D48, v12);
LABEL_48:
    v11 = off_5A148;
  }
  if ( v11 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(v11->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x96u, (__int64)&unk_57D48);
      v11 = off_5A148;
    }
    if ( v11 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v11->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x9Bu, (__int64)&unk_57D48);
      v11 = off_5A148;
    }
  }
LABEL_57:
  if ( (unsigned int)(a1 - 2) <= 9 )
  {
    v14 = (char *)&unk_5A1E0 + 96 * a1 - 192;
    v15 = sub_46F50((PFAST_MUTEX)(v14 + 16));
    v11 = off_5A148;
    if ( v15 )
    {
      *(_QWORD *)v14 = 0i64;
      *((_QWORD *)v14 + 1) = 0i64;
      v3 = 0;
    }
    else
    {
      v3 = 6;
    }
  }
  if ( v11 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v11->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x9Cu, (__int64)&unk_57D48);
  }
  return v3;
}
// 171C6: variable 'v10' is possibly undefined

//----- (0000000000017324) ----------------------------------------------------
__int64 __fastcall sub_17324(int a1, __int64 a2, int a3)
{
  char *v6; // rdi
  PDEVICE_OBJECT v7; // rcx
  int v9; // ebx
  int v10; // ebx
  int v11; // ebx
  int v12; // ebx
  int v13; // ebx
  int v14; // eax
  PDEVICE_OBJECT v15; // rcx
  unsigned __int16 v16; // dx
  int v17; // er9
  int v18; // eax
  int v19; // eax
  int v20; // eax
  int v21; // eax
  int v22; // [rsp+30h] [rbp-28h] BYREF
  __int64 v23[2]; // [rsp+34h] [rbp-24h] BYREF

  v22 = 0;
  memset(v23, 0, sizeof(v23));
  if ( (unsigned int)(a3 - 2) <= 9 )
    v6 = (char *)&unk_5A1E0 + 96 * a3 - 192;
  else
    v6 = 0i64;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x9Du, (__int64)&unk_57D48);
    v7 = off_5A148;
  }
  v23[1] = *(_QWORD *)(a2 + 16);
  if ( !v6 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
      && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x9Eu, (__int64)&unk_57D48, a3);
    }
    return 6i64;
  }
  v9 = a1 - 258;
  if ( v9 )
  {
    v10 = v9 - 1;
    if ( v10 )
    {
      v11 = v10 - 1;
      if ( v11 )
      {
        v12 = v11 - 1;
        if ( v12 )
        {
          v13 = v12 - 1;
          if ( v13 )
          {
            if ( v13 != 1 )
              goto LABEL_53;
            v14 = *(_DWORD *)(a2 + 8);
            LODWORD(v23[0]) = 0;
            HIDWORD(v23[0]) = v14;
            v22 = 12;
            if ( sub_46FB0((PFAST_MUTEX)(v6 + 16)) )
            {
              v15 = off_5A148;
              if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
                || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
                || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
              {
                goto LABEL_51;
              }
              v16 = 164;
              v17 = 263;
LABEL_50:
              sub_184C0(*(_QWORD *)&v15->DeviceLock.Header.Lock, v16, (__int64)&unk_57D48, v17);
LABEL_51:
              (*(void (__fastcall **)(int *, _QWORD))v6)(&v22, *(_QWORD *)a2);
              sub_47018((PFAST_MUTEX)(v6 + 16));
              goto LABEL_52;
            }
          }
          else
          {
            v18 = *(_DWORD *)(a2 + 8);
            LODWORD(v23[0]) = 0;
            HIDWORD(v23[0]) = v18;
            v22 = 10;
            if ( sub_46FB0((PFAST_MUTEX)(v6 + 16)) )
            {
              v15 = off_5A148;
              if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
                || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
                || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
              {
                goto LABEL_51;
              }
              v16 = 163;
              v17 = 262;
              goto LABEL_50;
            }
          }
        }
        else
        {
          v19 = *(_DWORD *)(a2 + 8);
          LODWORD(v23[0]) = 0;
          HIDWORD(v23[0]) = v19;
          v22 = 11;
          if ( sub_46FB0((PFAST_MUTEX)(v6 + 16)) )
          {
            v15 = off_5A148;
            if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
              || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
              || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
            {
              goto LABEL_51;
            }
            v16 = 162;
            v17 = 261;
            goto LABEL_50;
          }
        }
      }
      else
      {
        v20 = *(_DWORD *)(a2 + 8);
        LODWORD(v23[0]) = 0;
        HIDWORD(v23[0]) = v20;
        v22 = 9;
        if ( sub_46FB0((PFAST_MUTEX)(v6 + 16)) )
        {
          v15 = off_5A148;
          if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
            || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
            || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
          {
            goto LABEL_51;
          }
          v16 = 161;
          v17 = 260;
          goto LABEL_50;
        }
      }
    }
    else
    {
      LODWORD(v23[0]) = 0;
      v22 = 1;
      HIDWORD(v23[0]) = *(_DWORD *)(a2 + 8);
      if ( sub_46FB0((PFAST_MUTEX)(v6 + 16)) )
      {
        v15 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
          || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
          || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
        {
          goto LABEL_51;
        }
        v16 = 159;
        v17 = 259;
        goto LABEL_50;
      }
    }
  }
  else
  {
    v21 = *(_DWORD *)(a2 + 8);
    LODWORD(v23[0]) = 0;
    HIDWORD(v23[0]) = v21;
    v22 = 2;
    if ( sub_46FB0((PFAST_MUTEX)(v6 + 16)) )
    {
      v15 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
        goto LABEL_51;
      }
      v16 = 160;
      v17 = 258;
      goto LABEL_50;
    }
  }
LABEL_52:
  v7 = off_5A148;
LABEL_53:
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0xA5u, (__int64)&unk_57D48);
  }
  return 0i64;
}

//----- (00000000000176CC) ----------------------------------------------------
void __fastcall sub_176CC(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  PVOID *v3; // rbx
  ULONG v4; // edx
  PVOID *v5; // rcx
  _QWORD *v6; // rbx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA6u, (__int64)&unk_57D48, a1);
    v2 = off_5A148;
  }
  if ( a1 )
  {
    if ( *(_DWORD *)(a1 + 4) == 514
      || *(_DWORD *)(a1 + 4) == 515
      || *(_DWORD *)(a1 + 4) == 522
      || *(_DWORD *)(a1 + 4) == 778 )
    {
      v5 = *(PVOID **)(a1 + 16);
      v4 = 1836086355;
    }
    else
    {
      switch ( *(_DWORD *)(a1 + 4) )
      {
        case 0x30B:
          v6 = *(_QWORD **)(a1 + 16);
          sub_3C570(v6, 0x6D707453u);
          v2 = off_5A148;
          if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
            return;
          if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
            || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
          {
            goto LABEL_31;
          }
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA7u, (__int64)&unk_57D48, *v6, 0);
          goto LABEL_30;
        case 0x501:
          v3 = *(PVOID **)(a1 + 16);
          sub_3C570(v3[3], 0x6E707453u);
          v4 = 1852863571;
          break;
        case 0x502:
          v3 = *(PVOID **)(a1 + 16);
          sub_3C570(v3[3], 0x61707453u);
          v4 = 1634759763;
          break;
        default:
          if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
            return;
          if ( (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
            || BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) < 5u )
          {
            goto LABEL_31;
          }
          sub_13EA4(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0xA8u, (__int64)&unk_57D48, *(_DWORD *)(a1 + 4));
          goto LABEL_30;
      }
      v5 = v3;
    }
    sub_3C570(v5, v4);
LABEL_30:
    v2 = off_5A148;
    goto LABEL_31;
  }
  if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
    return;
  if ( (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0xA9u, (__int64)&unk_57D48);
    goto LABEL_30;
  }
LABEL_31:
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0xAAu, (__int64)&unk_57D48);
  }
}

//----- (00000000000178F0) ----------------------------------------------------
__int64 __fastcall sub_178F0(int a1, int *a2)
{
  unsigned int v4; // ebx
  PVOID *i; // r11
  int v6; // er9

  v4 = 5;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB3u, (__int64)&unk_57D48);
  }
  *a2 = 0;
  sub_3D310(&FastMutex);
  for ( i = (PVOID *)qword_5D5C0; i != &qword_5D5C0; i = (PVOID *)*i )
  {
    if ( a1 == *((_DWORD *)i + 4) )
    {
      v6 = *((_DWORD *)i + 6);
      *a2 = v6;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB4u, (__int64)&unk_57D48, v6);
      }
      v4 = 0;
      break;
    }
  }
  sub_3D3DC(&FastMutex);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB5u, (__int64)&unk_57D48);
  }
  return v4;
}

//----- (0000000000017A28) ----------------------------------------------------
__int64 __fastcall sub_17A28(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+D8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, a3, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000017AC4) ----------------------------------------------------
__int64 __fastcall sub_17AC4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+158h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D38, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000017BF0) ----------------------------------------------------
__int64 __fastcall sub_17BF0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, a3, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000017C3C) ----------------------------------------------------
__int64 __fastcall sub_17C3C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+A8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D38, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000017CBC) ----------------------------------------------------
__int64 sub_17CBC(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D38, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000017D2C) ----------------------------------------------------
__int64 sub_17D2C(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D38, 363i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000017D8C) ----------------------------------------------------
__int64 sub_17D8C(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D38, 310i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000017DFC) ----------------------------------------------------
__int64 sub_17DFC(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+B8h] [rbp+20h] BYREF
  va_list va; // [rsp+B8h] [rbp+20h]
  __int64 v7; // [rsp+C0h] [rbp+28h]
  const char *v8; // [rsp+C8h] [rbp+30h]
  const char *v9; // [rsp+D0h] [rbp+38h]
  const char *v10; // [rsp+D8h] [rbp+40h]
  const char *v11; // [rsp+E0h] [rbp+48h]
  va_list va1; // [rsp+E8h] [rbp+50h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, _QWORD);
  v8 = va_arg(va1, const char *);
  v9 = va_arg(va1, const char *);
  v10 = va_arg(va1, const char *);
  v11 = va_arg(va1, const char *);
  if ( v11 )
    strlen(v11);
  if ( v10 )
    strlen(v10);
  if ( v9 )
    strlen(v9);
  if ( v8 )
    strlen(v8);
  return qword_5A1B8(a1, 43i64, &unk_57D38, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000017F9C) ----------------------------------------------------
__int64 sub_17F9C(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D38, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000017FF0) ----------------------------------------------------
__int64 sub_17FF0(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D38, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000018050) ----------------------------------------------------
__int64 sub_18050(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D38, 93i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000180C0) ----------------------------------------------------
__int64 sub_180C0(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+108h] [rbp+20h] BYREF
  va_list va; // [rsp+108h] [rbp+20h]
  __int64 v7; // [rsp+110h] [rbp+28h]
  __int64 v8; // [rsp+118h] [rbp+30h]
  __int64 v9; // [rsp+120h] [rbp+38h]
  __int64 v10; // [rsp+128h] [rbp+40h]
  __int64 v11; // [rsp+130h] [rbp+48h]
  __int64 v12; // [rsp+138h] [rbp+50h]
  __int64 v13; // [rsp+140h] [rbp+58h]
  __int64 v14; // [rsp+148h] [rbp+60h]
  __int64 v15; // [rsp+150h] [rbp+68h]
  const char *v16; // [rsp+158h] [rbp+70h]
  va_list va1; // [rsp+160h] [rbp+78h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, _QWORD);
  v8 = va_arg(va1, _QWORD);
  v9 = va_arg(va1, _QWORD);
  v10 = va_arg(va1, _QWORD);
  v11 = va_arg(va1, _QWORD);
  v12 = va_arg(va1, _QWORD);
  v13 = va_arg(va1, _QWORD);
  v14 = va_arg(va1, _QWORD);
  v15 = va_arg(va1, _QWORD);
  v16 = va_arg(va1, const char *);
  if ( v16 )
    strlen(v16);
  return qword_5A1B8(a1, 43i64, a3, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000018210) ----------------------------------------------------
__int64 sub_18210(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D38, 339i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000018284) ----------------------------------------------------
__int64 sub_18284(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, a3, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000182DC) ----------------------------------------------------
__int64 sub_182DC(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+78h] [rbp+20h] BYREF
  va_list va; // [rsp+78h] [rbp+20h]
  const char *v7; // [rsp+80h] [rbp+28h]
  va_list va1; // [rsp+88h] [rbp+30h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, const char *);
  if ( v7 )
    strlen(v7);
  return qword_5A1B8(a1, 43i64, a3, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001835C) ----------------------------------------------------
__int64 sub_1835C(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v6; // [rsp+88h] [rbp+20h] BYREF
  va_list va; // [rsp+88h] [rbp+20h]
  const char *v8; // [rsp+90h] [rbp+28h]
  const char *v9; // [rsp+98h] [rbp+30h]
  va_list va1; // [rsp+A0h] [rbp+38h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v6 = va_arg(va1, _QWORD);
  v8 = va_arg(va1, const char *);
  v9 = va_arg(va1, const char *);
  if ( v9 )
    strlen(v9);
  if ( v8 )
    strlen(v8);
  return qword_5A1B8(a1, 43i64, &unk_57D38, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001842C) ----------------------------------------------------
__int64 __fastcall sub_1842C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+68h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D38, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000018470) ----------------------------------------------------
__int64 __fastcall sub_18470(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D38, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000184C0) ----------------------------------------------------
__int64 __fastcall sub_184C0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, a3, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000018508) ----------------------------------------------------
__int64 __fastcall sub_18508(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D38, 75i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000018578) ----------------------------------------------------
__int64 __fastcall sub_18578(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D38, 58i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000185D8) ----------------------------------------------------
__int64 __fastcall sub_185D8(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4)
{
  __int64 v5; // rcx
  const wchar_t *v6; // rdi
  bool v7; // zf

  if ( a4 && *a4 )
  {
    v5 = -1i64;
    v6 = a4;
    do
    {
      if ( !v5 )
        break;
      v7 = *v6++ == 0;
      --v5;
    }
    while ( !v7 );
  }
  if ( a4 )
  {
    if ( !*a4 )
      a4 = L"<NULL>";
  }
  else
  {
    a4 = L"NULL";
  }
  return qword_5A1B8(a1, 43i64, a3, a2, a4);
}
// 56760: using guessed type wchar_t aNull_4[7];
// 56770: using guessed type wchar_t aNull[5];
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000018658) ----------------------------------------------------
__int64 __fastcall sub_18658(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, a3, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000186B8) ----------------------------------------------------
__int64 __fastcall sub_186B8(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+D8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D38, 458i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000018760) ----------------------------------------------------
__int64 sub_18760(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+78h] [rbp+20h] BYREF
  va_list va; // [rsp+78h] [rbp+20h]
  const char *v7; // [rsp+80h] [rbp+28h]
  va_list va1; // [rsp+88h] [rbp+30h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, const char *);
  if ( v7 )
    strlen(v7);
  return qword_5A1B8(a1, 43i64, &unk_57CD8, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000187E8) ----------------------------------------------------
__int64 __fastcall sub_187E8(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_5A1B8(a1, 43i64, a3, a2, v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000018848) ----------------------------------------------------
__int64 __fastcall sub_18848(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D38, a2, v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000188D8) ----------------------------------------------------
__int64 __fastcall sub_188D8(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, char a5, char a6, const char *a7, const char *a8)
{
  const char *v11; // rdx

  if ( a8 )
    strlen(a8);
  if ( a7 )
    strlen(a7);
  if ( a4 )
    strlen(a4);
  v11 = "NULL";
  if ( a4 )
    v11 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D38, a2, v11);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000018A10) ----------------------------------------------------
__int64 __fastcall sub_18A10(__int64 a1, __int64 a2, __int64 a3, const char *a4, char a5, char a6, const char *a7, const char *a8, const char *a9, const char *a10)
{
  const char *v11; // r8

  if ( a10 )
    strlen(a10);
  if ( a9 )
    strlen(a9);
  if ( a8 )
    strlen(a8);
  if ( a7 )
    strlen(a7);
  if ( a4 )
    strlen(a4);
  v11 = "NULL";
  if ( a4 )
    v11 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D38, 325i64, v11);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000018BEC) ----------------------------------------------------
__int64 __fastcall sub_18BEC(__int64 a1, __int64 a2, __int64 a3, const char *a4, char a5, char a6, const char *a7, const char *a8, const char *a9, const char *a10, const char *a11)
{
  const char *v11; // r9

  if ( a11 )
    strlen(a11);
  if ( a10 )
    strlen(a10);
  if ( a9 )
    strlen(a9);
  if ( a8 )
    strlen(a8);
  if ( a7 )
    strlen(a7);
  if ( a4 )
    strlen(a4);
  v11 = "NULL";
  if ( a4 )
    v11 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D38, 351i64, v11);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000018E14) ----------------------------------------------------
__int64 __fastcall sub_18E14(int a1, __int64 a2, __int64 a3, __int64 a4, int *a5)
{
  unsigned int v5; // esi
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  const char *v9; // rax
  const char *v10; // rax
  int v12; // eax
  char v13[32]; // [rsp+48h] [rbp-90h] BYREF
  char v14[32]; // [rsp+68h] [rbp-70h] BYREF
  char v15[32]; // [rsp+88h] [rbp-50h] BYREF

  v5 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x17u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_17C3C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xAu, (__int64)&unk_57D38, a1);
  }
  *a5 = 1;
  if ( (*(_BYTE *)(a2 + 120) & 4) != 0 )
  {
    sub_53BB4(v13, 0x20ui64, "|STRMR-%I64u", 0i64);
    sub_51EBC(a2, v13, strlen(v13));
  }
  if ( (unsigned int)sub_4535C(0x2013001u) != 1 )
  {
    v7 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x17u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      v8 = 11;
LABEL_12:
      sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, v8, (__int64)&unk_57D38);
LABEL_13:
      v7 = off_5A148;
      goto LABEL_14;
    }
    goto LABEL_14;
  }
  if ( !_bittest((const signed __int32 *)(a2 + 120), 8u) )
  {
    if ( !*(_QWORD *)(a2 + 40) && !*(_QWORD *)(a2 + 48) )
    {
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x17u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        v8 = 14;
        goto LABEL_12;
      }
      goto LABEL_14;
    }
    sub_23400(a2);
    if ( dword_5A954 )
      _InterlockedAdd((volatile signed __int32 *)P, 1u);
    if ( !*(_QWORD *)(a2 + 312) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x17u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xFu, (__int64)&unk_57D38);
      }
      _InterlockedAdd64(&qword_5A810, 1ui64);
      goto LABEL_13;
    }
    if ( !*(_QWORD *)(a2 + 344) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x17u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x10u, (__int64)&unk_57D38);
      }
      _InterlockedAdd64(&qword_5A808, 1ui64);
    }
    if ( !*(_DWORD *)(a2 + 332) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x17u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x11u, (__int64)&unk_57D38);
      }
      _InterlockedAdd64(&qword_5A818, 1ui64);
    }
    if ( *(_DWORD *)(a2 + 328) == 1 )
    {
      v5 = sub_2308C(a2, (unsigned __int64 *)(a2 + 312));
    }
    else
    {
      if ( *(_QWORD *)(a2 + 48) && !(unsigned int)sub_4535C(0x2013026u) )
      {
        v7 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x17u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          v8 = 18;
          goto LABEL_12;
        }
        goto LABEL_14;
      }
      v12 = sub_1C814((void *)a2, a5, (_QWORD *)(a2 + 312));
      v5 = v12;
      if ( !v12 )
        goto LABEL_13;
      v7 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x17u)
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 3u )
      {
LABEL_71:
        if ( v5 )
        {
LABEL_17:
          if ( v5 != 4 && v5 != 6 && (*(_BYTE *)(a2 + 120) & 4) != 0 )
          {
            v10 = sub_4A760(*a5);
            sub_53BB4(v15, 0x20ui64, "-ERR-%s|", v10);
            sub_51EBC(a2, v15, strlen(v15));
            v7 = off_5A148;
          }
          goto LABEL_21;
        }
        goto LABEL_14;
      }
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x13u, (__int64)&unk_57D38, v12);
    }
    v7 = off_5A148;
    goto LABEL_71;
  }
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x17u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    v8 = 13;
    goto LABEL_12;
  }
LABEL_14:
  if ( (*(_BYTE *)(a2 + 120) & 4) != 0 )
  {
    v9 = sub_4A760(*a5);
    sub_53BB4(v14, 0x20ui64, "-OK-%s|", v9);
    sub_51EBC(a2, v14, strlen(v14));
    v7 = off_5A148;
  }
  if ( v5 )
    goto LABEL_17;
LABEL_21:
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v7->DeviceLock.Header.WaitListHead.Blink + 1, 0x17u)
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x15u, (__int64)&unk_57D38, v5);
  }
  return v5;
}
// 5A808: using guessed type __int64 qword_5A808;
// 5A810: using guessed type __int64 qword_5A810;
// 5A818: using guessed type __int64 qword_5A818;
// 5A954: using guessed type int dword_5A954;

//----- (000000000001928C) ----------------------------------------------------
__int64 __fastcall sub_1928C(__int64 a1, __int64 a2, int a3, int a4, __int64 a5, __int64 a6, __int64 a7, __int64 a8)
{
  int v8; // ebp
  _DWORD *v13; // rax
  __int64 v14; // rsi
  PVOID v16; // rax
  unsigned __int8 *v17; // rcx
  __int64 v18; // rax
  __int64 v19; // rdi
  int v20; // [rsp+30h] [rbp-98h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+38h] [rbp-90h] BYREF
  char v22[80]; // [rsp+40h] [rbp-88h] BYREF

  v8 = 0;
  v20 = 0;
  BugCheckParameter1 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x16u, (__int64)&unk_57D38);
  }
  v13 = sub_3C910((__int64)qword_5A8A0);
  v14 = (__int64)v13;
  if ( !v13 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x17u, (__int64)&unk_57D38);
    }
    return 0i64;
  }
  memset(v13, 0, 0x2C8ui64);
  *(_QWORD *)v14 = a1;
  if ( a2 )
    *(_QWORD *)(v14 + 392) = a2;
  if ( a7 )
  {
    *(_QWORD *)(v14 + 8) = a7;
  }
  else
  {
    v16 = sub_3C4EC(2, 0x38u, 0x4D537453u);
    *(_QWORD *)(v14 + 8) = v16;
    if ( !v16 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x18u, (__int64)&unk_57D38);
      }
      sub_3C978((__int64)qword_5A8A0, v14);
      return 0i64;
    }
    memset(v16, 0, 0x38ui64);
    KeInitializeMutex(*(PRKMUTEX *)(v14 + 8), 0);
  }
  *(_DWORD *)(v14 + 20) = a3;
  *(_QWORD *)(v14 + 32) = a5;
  *(_DWORD *)(v14 + 24) = a4;
  *(_QWORD *)(v14 + 408) = 0i64;
  *(_BYTE *)(v14 + 644) = 0;
  *(_BYTE *)(v14 + 645) = 0;
  *(_QWORD *)(v14 + 40) = a6;
  *(_BYTE *)(v14 + 57) = sub_4535C(0x201300Cu);
  *(_BYTE *)(v14 + 59) = sub_4535C(0x201300Eu);
  sub_236DC(a4, v14);
  sub_238E8(a4, v14);
  *(_QWORD *)(v14 + 456) = v14 + 448;
  *(_QWORD *)(v14 + 448) = v14 + 448;
  *(_QWORD *)(v14 + 504) = v14 + 496;
  *(_QWORD *)(v14 + 496) = v14 + 496;
  *(_QWORD *)(v14 + 552) = v14 + 544;
  *(_QWORD *)(v14 + 544) = v14 + 544;
  *(_QWORD *)(v14 + 600) = v14 + 592;
  *(_QWORD *)(v14 + 592) = v14 + 592;
  *(_DWORD *)(v14 + 420) = 1;
  *(_BYTE *)(v14 + 60) = 0;
  *(_DWORD *)(v14 + 64) = 0;
  *(_DWORD *)(v14 + 68) = 0;
  sub_20F20(v14);
  sub_38DDC(*(_DWORD *)(a8 + 372), (_DWORD *)(v14 + 416));
  sub_259F0(v14, a8);
  v17 = (unsigned __int8 *)(v14 + 88);
  LOBYTE(v8) = (*(_BYTE *)(a8 + 120) & 0x10) == 16;
  if ( v8 == 1 )
    v17 = (unsigned __int8 *)(v14 + 104);
  v18 = sub_3BDD8(v17, &BugCheckParameter1, &v20);
  v19 = v18;
  if ( v20 == 5 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x19u, (__int64)&unk_57D38, *(_QWORD *)v14);
    }
    _InterlockedAdd(&dword_5A800, 1u);
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13F8C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Au, (__int64)&unk_57D38, (const char *)(v18 + 17));
    }
    _InterlockedAdd(&dword_5A7FC, 1u);
    sub_53BD8((void *)(v14 + 129), 0x100ui64, (const void *)(v19 + 17), 0x100ui64);
    sub_3BF50(BugCheckParameter1);
    if ( (*(_BYTE *)(a8 + 120) & 4) != 0 && strlen((const char *)(v14 + 129)) )
    {
      sub_53BB4(v22, 0x46ui64, "-Domain:%s", (const char *)(v14 + 129));
      sub_51EBC(a8, v22, strlen(v22));
    }
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Bu, (__int64)&unk_57D38);
  }
  return v14;
}
// 5A7FC: using guessed type int dword_5A7FC;
// 5A800: using guessed type int dword_5A800;

//----- (00000000000196DC) ----------------------------------------------------
__int64 __fastcall sub_196DC(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 v3; // rax
  struct _KMUTANT *v4; // rcx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Cu, (__int64)&unk_57D38);
    v2 = off_5A148;
  }
  if ( a1 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_12D64(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x1Du, (__int64)&unk_57D38, *(_QWORD *)a1);
    }
    sub_2793C(a1);
    sub_1989C(a1);
    KeWaitForSingleObject(*(PVOID *)(a1 + 8), Executive, 0, 0, 0i64);
    v3 = *(_QWORD *)(a1 + 400);
    if ( v3 )
    {
      if ( *(_BYTE *)(v3 + 56) )
      {
        *(_QWORD *)(v3 + 400) = 0i64;
        *(_QWORD *)(*(_QWORD *)(a1 + 400) + 392i64) = 0i64;
      }
      else
      {
        sub_1989C(*(_QWORD *)(a1 + 400));
        sub_3C978((__int64)qword_5A8A0, *(_QWORD *)(a1 + 400));
        *(_QWORD *)(a1 + 400) = 0i64;
        *(_QWORD *)(a1 + 392) = 0i64;
      }
    }
    v4 = *(struct _KMUTANT **)(a1 + 8);
    if ( !v4 || *(_QWORD *)(a1 + 400) )
    {
      KeReleaseMutex(v4, 0);
    }
    else
    {
      KeReleaseMutex(v4, 0);
      sub_3C570(*(PVOID *)(a1 + 8), 0x4D537453u);
      *(_QWORD *)(a1 + 8) = 0i64;
    }
    sub_3C978((__int64)qword_5A8A0, a1);
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x1Eu, (__int64)&unk_57D38);
  }
  return 0i64;
}

//----- (000000000001989C) ----------------------------------------------------
__int64 __fastcall sub_1989C(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 result; // rax
  __int64 v4; // rcx
  __int64 v5; // rcx
  PDEVICE_OBJECT v6; // rcx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Fu, (__int64)&unk_57D38);
    v2 = off_5A148;
  }
  if ( a1 )
  {
    v4 = *(_QWORD *)(a1 + 672);
    if ( v4 )
    {
      sub_3C570(*(PVOID *)(v4 + 16), 0x50535453u);
      sub_3C978((__int64)qword_5A8A8, *(_QWORD *)(a1 + 672));
    }
    sub_1FF60((_QWORD **)(a1 + 448));
    sub_1FF60((_QWORD **)(a1 + 496));
    sub_1FF60((_QWORD **)(a1 + 544));
    sub_1FF60((_QWORD **)(a1 + 592));
    v5 = *(_QWORD *)(a1 + 408);
    if ( v5 )
      sub_2D968(v5);
    v6 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EE0(
          *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
          0x21u,
          (__int64)&unk_57D38,
          *(_QWORD *)a1,
          *(_QWORD *)(a1 + 392));
        v6 = off_5A148;
      }
      if ( v6 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x22u, (__int64)&unk_57D38);
      }
    }
    result = 0i64;
  }
  else
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x20u, (__int64)&unk_57D38);
    }
    result = 4i64;
  }
  return result;
}

//----- (0000000000019A3C) ----------------------------------------------------
__int64 sub_19A3C()
{
  unsigned int v0; // ebx
  PDEVICE_OBJECT v1; // rcx
  unsigned __int16 v2; // dx
  unsigned __int8 v3; // al
  _DWORD *v4; // rax
  int v5; // er9
  unsigned __int16 v6; // dx
  unsigned __int8 v7; // al
  _DWORD *v8; // rax
  int v9; // eax
  int v10; // eax
  __int64 v12; // [rsp+28h] [rbp-50h]
  __int64 v13; // [rsp+28h] [rbp-50h]
  int v14; // [rsp+80h] [rbp+8h] BYREF

  v0 = 0;
  v14 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x23u, (__int64)&unk_57D38);
  }
  qword_5A8A0 = sub_3C76C(1, 0x2C8u, 0x50535453u);
  if ( !qword_5A8A0 )
  {
    v1 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_11;
    }
    v2 = 36;
LABEL_10:
    sub_11088(*(_QWORD *)&v1->DeviceLock.Header.Lock, v2, (__int64)&unk_57D38);
    v1 = off_5A148;
LABEL_11:
    v0 = 3;
    goto LABEL_43;
  }
  qword_5A8A8 = sub_3C76C(2, 0x190u, 0x704E734Eu);
  if ( !qword_5A8A8 )
  {
    v1 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_11;
    }
    v2 = 37;
    goto LABEL_10;
  }
  qword_5A8B0 = sub_3C76C(2, 0x30u, 0x50535453u);
  if ( !qword_5A8B0 )
  {
    v1 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_11;
    }
    v2 = 38;
    goto LABEL_10;
  }
  qword_5A8B8 = sub_3C76C(1, 0xD8u, 0x6F537453u);
  if ( !qword_5A8B8 )
  {
    v1 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_11;
    }
    v2 = 39;
    goto LABEL_10;
  }
  v3 = sub_4535C(0x201300Fu);
  LODWORD(v12) = 2;
  v4 = sub_477F4(v3, 0i64, 1, 0x50535453u, 0i64, v12, 0i64, 0i64, (__int64)sub_196DC, 0i64, &v14);
  v5 = v14;
  qword_5A8C0 = (ULONG_PTR)v4;
  if ( v14 )
  {
    v1 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_42;
    }
    v6 = 40;
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x29u, (__int64)&unk_57D38);
    }
    v7 = sub_4535C(0x201300Fu);
    LODWORD(v13) = 2;
    v8 = sub_477F4(v7, 0i64, 1, 0x50535453u, 0i64, v13, 0i64, 0i64, (__int64)sub_196DC, 0i64, &v14);
    v5 = v14;
    qword_5A8C8 = (ULONG_PTR)v8;
    if ( !v14 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Bu, (__int64)&unk_57D38);
      }
      sub_3D230((__int64)&stru_5D580);
      byte_5A66F = 1;
      sub_3D230((__int64)&stru_5D540);
      byte_5A8D0 = 1;
      goto LABEL_72;
    }
    v1 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_42;
    }
    v6 = 42;
  }
  sub_13EA4(*(_QWORD *)&v1->DeviceLock.Header.Lock, v6, (__int64)&unk_57D38, v5);
  v1 = off_5A148;
LABEL_42:
  v0 = 1;
LABEL_43:
  if ( !qword_5A8C8 )
    goto LABEL_51;
  v9 = sub_47B3C(qword_5A8C8);
  if ( v9 )
  {
    v1 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_50;
    }
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Cu, (__int64)&unk_57D38, v9);
  }
  v1 = off_5A148;
LABEL_50:
  qword_5A8C8 = 0i64;
LABEL_51:
  if ( !qword_5A8C0 )
    goto LABEL_59;
  v10 = sub_47B3C(qword_5A8C0);
  if ( v10 )
  {
    v1 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_58;
    }
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Du, (__int64)&unk_57D38, v10);
  }
  v1 = off_5A148;
LABEL_58:
  qword_5A8C0 = 0i64;
LABEL_59:
  if ( qword_5A8B8 )
  {
    sub_3C7F0(qword_5A8B8);
    v1 = off_5A148;
    qword_5A8B8 = 0i64;
  }
  if ( qword_5A8B0 )
  {
    sub_3C7F0(qword_5A8B0);
    v1 = off_5A148;
    qword_5A8B0 = 0i64;
  }
  if ( qword_5A8A8 )
  {
    sub_3C7F0(qword_5A8A8);
    v1 = off_5A148;
    qword_5A8A8 = 0i64;
  }
  if ( qword_5A8A0 )
  {
    sub_3C7F0(qword_5A8A0);
    qword_5A8A0 = 0i64;
LABEL_72:
    v1 = off_5A148;
  }
  if ( v1 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v1->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(v1->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v1->DeviceLock.Header.Lock, 0x2Eu, (__int64)&unk_57D38, v0);
  }
  return v0;
}
// 19C60: variable 'v12' is possibly undefined
// 19D27: variable 'v13' is possibly undefined
// 5A66F: using guessed type char byte_5A66F;
// 5A8D0: using guessed type char byte_5A8D0;

//----- (0000000000019FA4) ----------------------------------------------------
__int64 sub_19FA4()
{
  PDEVICE_OBJECT v0; // rcx
  int v1; // eax
  int v2; // eax

  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Fu, (__int64)&unk_57D38);
    v0 = off_5A148;
  }
  byte_5A66F = 0;
  byte_5A8D0 = 0;
  if ( qword_5A8C8 )
  {
    v1 = sub_47B3C(qword_5A8C8);
    if ( v1 )
    {
      v0 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        goto LABEL_12;
      }
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x30u, (__int64)&unk_57D38, v1);
    }
    v0 = off_5A148;
LABEL_12:
    qword_5A8C8 = 0i64;
  }
  if ( !qword_5A8C0 )
    goto LABEL_21;
  v2 = sub_47B3C(qword_5A8C0);
  if ( v2 )
  {
    v0 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_20;
    }
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x31u, (__int64)&unk_57D38, v2);
  }
  v0 = off_5A148;
LABEL_20:
  qword_5A8C0 = 0i64;
LABEL_21:
  if ( qword_5A8B8 )
  {
    sub_3C7F0(qword_5A8B8);
    qword_5A8B8 = 0i64;
    v0 = off_5A148;
  }
  if ( qword_5A8B0 )
  {
    sub_3C7F0(qword_5A8B0);
    qword_5A8B0 = 0i64;
    v0 = off_5A148;
  }
  if ( qword_5A8A8 )
  {
    sub_3C7F0(qword_5A8A8);
    qword_5A8A8 = 0i64;
    v0 = off_5A148;
  }
  if ( qword_5A8A0 )
  {
    sub_3C7F0(qword_5A8A0);
    qword_5A8A0 = 0i64;
    v0 = off_5A148;
  }
  if ( v0 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v0->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(v0->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v0->DeviceLock.Header.Lock, 0x32u, (__int64)&unk_57D38);
  }
  return 0i64;
}
// 5A66F: using guessed type char byte_5A66F;
// 5A8D0: using guessed type char byte_5A8D0;

//----- (000000000001A1AC) ----------------------------------------------------
__int64 __fastcall sub_1A1AC(void *Src)
{
  PDEVICE_OBJECT v2; // rcx
  unsigned __int16 v4; // dx
  _DWORD *v5; // rax
  __int64 v6; // rdi
  PVOID v7; // rax
  __int64 v8; // [rsp+20h] [rbp-18h]
  int v9; // [rsp+28h] [rbp-10h]

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x33u, (__int64)&unk_57D38);
    v2 = off_5A148;
  }
  if ( !Src )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x34u, (__int64)&unk_57D38);
    }
    return 0i64;
  }
  if ( !*((_QWORD *)Src + 2) )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 0i64;
    }
    v4 = 53;
LABEL_16:
    sub_12D64(*(_QWORD *)&v2->DeviceLock.Header.Lock, v4, (__int64)&unk_57D38, *(_QWORD *)Src, v8, v9);
    return 0i64;
  }
  v5 = sub_3C910((__int64)qword_5A8A8);
  v6 = (__int64)v5;
  if ( !v5 )
  {
    v2 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 0i64;
    }
    v4 = 54;
    goto LABEL_16;
  }
  memmove(v5, Src, 0x190ui64);
  *(_QWORD *)(v6 + 220) = 0i64;
  v9 = 0;
  HIDWORD(v8) = 0;
  v7 = sub_3C4EC(2, *((_DWORD *)Src + 31), 0x50535453u);
  *(_QWORD *)(v6 + 16) = v7;
  if ( !v7 )
  {
    LODWORD(v8) = 0;
    sub_3C978((__int64)qword_5A8A8, v6);
    v2 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 0i64;
    }
    v4 = 55;
    goto LABEL_16;
  }
  memmove(v7, *((const void **)Src + 2), *((unsigned int *)Src + 31));
  sub_4B3A0(*(_QWORD *)(v6 + 16), *(_DWORD *)(v6 + 124), (__int64 *)(v6 + 24));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x38u, (__int64)&unk_57D38);
  }
  return v6;
}
// 1A270: variable 'v8' is possibly undefined
// 1A270: variable 'v9' is possibly undefined

//----- (000000000001A3B8) ----------------------------------------------------
__int64 __fastcall sub_1A3B8(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  __int64 *v7; // rbx
  _QWORD *v8; // rax
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  _QWORD *v11; // rax
  int v12; // eax
  __int64 v13; // rcx
  _QWORD *v14; // rax
  _QWORD *v15; // rcx
  _QWORD *v16; // rax
  __int64 *v17; // rcx
  __int64 *v18; // rax
  __int64 *v19; // rcx
  __int64 v20; // rax

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x39u, (__int64)&unk_57D38);
      v6 = off_5A148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_18578(*(_QWORD *)&v6->DeviceLock.Header.Lock, 58i64, (__int64)&unk_57D38, *(_DWORD *)(a3 + 32));
      v6 = off_5A148;
    }
  }
  if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x3Bu, (__int64)&unk_57D38, *(_DWORD *)(a2 + 680));
    }
    v7 = (__int64 *)(a2 + 592);
    if ( (__int64 *)*v7 == v7 )
    {
      v8 = (_QWORD *)*v7;
      *(_QWORD *)(a3 + 8) = v7;
      *(_QWORD *)a3 = v8;
      v8[1] = a3;
      *v7 = a3;
      _InterlockedAdd((volatile signed __int32 *)(a2 + 680), 1u);
      v9 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        v10 = 60;
LABEL_71:
        sub_1842C(*(_QWORD *)&v9->DeviceLock.Header.Lock, v10, (__int64)&unk_57D38, *(_DWORD *)(a3 + 32));
        return 0i64;
      }
      return 0i64;
    }
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x3Du, (__int64)&unk_57D38, *(_DWORD *)(a2 + 684));
    }
    v7 = (__int64 *)(a2 + 544);
    if ( (__int64 *)*v7 == v7 )
    {
      v11 = (_QWORD *)*v7;
      *(_QWORD *)(a3 + 8) = v7;
      *(_QWORD *)a3 = v11;
      v11[1] = a3;
      *v7 = a3;
      _InterlockedAdd((volatile signed __int32 *)(a2 + 684), 1u);
      v9 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        v10 = 62;
        goto LABEL_71;
      }
      return 0i64;
    }
  }
  if ( (unsigned __int8)sub_4535C(0x201301Fu) )
  {
    v12 = sub_4535C(0x2013024u);
    if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
    {
      if ( *(_DWORD *)(a2 + 680) > v12 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Fu, (__int64)&unk_57D38);
        }
        while ( (__int64 *)*v7 != v7 )
        {
          v13 = *v7;
          v14 = *(_QWORD **)*v7;
          *v7 = (__int64)v14;
          v14[1] = v7;
          sub_20018(v13);
          _InterlockedAdd((volatile signed __int32 *)(a2 + 680), 0xFFFFFFFF);
        }
        sub_3C570(*(PVOID *)(*(_QWORD *)(a3 + 16) + 16i64), 0x50535453u);
        sub_3C978((__int64)qword_5A8A8, *(_QWORD *)(a3 + 16));
        sub_3C978((__int64)qword_5A8B0, a3);
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x40u, (__int64)&unk_57D38);
        }
        *(_BYTE *)(a2 + 688) = 1;
        return 0i64;
      }
    }
    else if ( *(_DWORD *)(a2 + 684) > v12 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x41u, (__int64)&unk_57D38);
      }
      while ( (__int64 *)*v7 != v7 )
      {
        v15 = (_QWORD *)*v7;
        v16 = *(_QWORD **)*v7;
        *v7 = (__int64)v16;
        v16[1] = v7;
        sub_20018((__int64)v15);
        _InterlockedAdd((volatile signed __int32 *)(a2 + 684), 0xFFFFFFFF);
      }
      sub_3C570(*(PVOID *)(*(_QWORD *)(a3 + 16) + 16i64), 0x50535453u);
      sub_3C978((__int64)qword_5A8A8, *(_QWORD *)(a3 + 16));
      sub_3C978((__int64)qword_5A8B0, a3);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x42u, (__int64)&unk_57D38);
      }
      *(_BYTE *)(a2 + 689) = 1;
      return 0i64;
    }
  }
  v17 = v7;
  while ( *((_DWORD *)v17 + 8) <= *(_DWORD *)(a3 + 32) )
  {
    v17 = (__int64 *)*v17;
    if ( v17 == v7 )
    {
      v18 = (__int64 *)v7[1];
      *(_QWORD *)a3 = v7;
      *(_QWORD *)(a3 + 8) = v18;
      *v18 = a3;
      v7[1] = a3;
      if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
        _InterlockedAdd((volatile signed __int32 *)(a2 + 680), 1u);
      else
        _InterlockedAdd((volatile signed __int32 *)(a2 + 684), 1u);
      v9 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        v10 = 68;
        goto LABEL_71;
      }
      return 0i64;
    }
  }
  v19 = (__int64 *)v17[1];
  v20 = *v19;
  *(_QWORD *)(a3 + 8) = v19;
  *(_QWORD *)a3 = v20;
  *(_QWORD *)(v20 + 8) = a3;
  *v19 = a3;
  if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
    _InterlockedAdd((volatile signed __int32 *)(a2 + 680), 1u);
  else
    _InterlockedAdd((volatile signed __int32 *)(a2 + 684), 1u);
  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v10 = 67;
    goto LABEL_71;
  }
  return 0i64;
}

//----- (000000000001A878) ----------------------------------------------------
__int64 __fastcall sub_1A878(void *Src, int a2, int a3, __int64 a4)
{
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  _DWORD *v10; // rax
  __int64 v11; // rbx
  PDEVICE_OBJECT v12; // rcx
  unsigned __int16 v13; // dx
  __int64 v15; // rax
  __int16 v16; // ax
  __int64 v17; // r8
  __int64 v18; // [rsp+40h] [rbp-38h] BYREF
  __int16 v19; // [rsp+80h] [rbp+8h] BYREF

  v8 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x45u, (__int64)&unk_57D38);
    v8 = off_5A148;
  }
  if ( (*((_DWORD *)Src + 30) & 0x10) != 0 && *(_BYTE *)(a4 + 688) )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v8->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      || BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      return 0i64;
    }
    v9 = 70;
LABEL_43:
    sub_11088(*(_QWORD *)&v8->DeviceLock.Header.Lock, v9, (__int64)&unk_57D38);
    return 0i64;
  }
  if ( (*((_DWORD *)Src + 30) & 0x10) != 16 && *(_BYTE *)(a4 + 689) )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v8->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      || BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      return 0i64;
    }
    v9 = 71;
    goto LABEL_43;
  }
  v10 = sub_3C910((__int64)qword_5A8B0);
  v11 = (__int64)v10;
  if ( !v10 )
  {
    v12 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v13 = 72;
LABEL_22:
    sub_11088(*(_QWORD *)&v12->DeviceLock.Header.Lock, v13, (__int64)&unk_57D38);
    return 3i64;
  }
  memset(v10, 0, 0x30ui64);
  v15 = sub_1A1AC(Src);
  *(_QWORD *)(v11 + 16) = v15;
  if ( !v15 )
  {
    sub_3C978((__int64)qword_5A8B0, v11);
    v12 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v13 = 73;
    goto LABEL_22;
  }
  if ( !(unsigned int)sub_50E34(*(_QWORD *)(v15 + 16), &v18, &v19) )
  {
    v16 = v19;
    v17 = v18;
    *(_DWORD *)(v11 + 32) = a2;
    *(_WORD *)(v11 + 40) = v16;
    *(_QWORD *)(v11 + 24) = v17;
    *(_DWORD *)(v11 + 36) = a3;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_18508(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 75i64, (__int64)&unk_57D38, a2);
    }
    sub_1A3B8((__int64)Src, a4, v11);
    v8 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      return 0i64;
    }
    v9 = 76;
    goto LABEL_43;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Au, (__int64)&unk_57D38);
  }
  sub_3C570(*(PVOID *)(*(_QWORD *)(v11 + 16) + 16i64), 0x50535453u);
  sub_3C978((__int64)qword_5A8A8, *(_QWORD *)(v11 + 16));
  sub_3C978((__int64)qword_5A8B0, v11);
  return 6i64;
}

//----- (000000000001AB80) ----------------------------------------------------
char __fastcall sub_1AB80(int a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  __int64 v7; // rdx
  unsigned __int16 v8; // dx
  __int64 v9; // rdx

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Du, (__int64)&unk_57D38);
    v4 = off_5A148;
  }
  if ( a1 )
  {
    if ( a1 != 1 )
    {
      if ( v4 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          v5 = 82;
LABEL_11:
          sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, v5, (__int64)&unk_57D38);
          v4 = off_5A148;
          goto LABEL_12;
        }
        goto LABEL_12;
      }
      return 0;
    }
    v7 = *(_QWORD *)(a2 + 592);
    if ( v7 == a2 + 592 )
    {
      if ( v4 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          v5 = 80;
          goto LABEL_11;
        }
LABEL_12:
        if ( v4 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x53u, (__int64)&unk_57D38);
        }
      }
      return 0;
    }
    if ( *(_DWORD *)(a2 + 436) < *(_DWORD *)(v7 + 32) )
      goto LABEL_12;
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v8 = 81;
LABEL_37:
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, v8, (__int64)&unk_57D38);
      return 1;
    }
  }
  else
  {
    v9 = *(_QWORD *)(a2 + 544);
    if ( v9 == a2 + 544 )
    {
      if ( v4 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          v5 = 78;
          goto LABEL_11;
        }
        goto LABEL_12;
      }
      return 0;
    }
    if ( *(_DWORD *)(a2 + 432) < *(_DWORD *)(v9 + 32) )
      goto LABEL_12;
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v8 = 79;
      goto LABEL_37;
    }
  }
  return 1;
}

//----- (000000000001AD48) ----------------------------------------------------
__int64 __fastcall sub_1AD48(__int64 a1, _QWORD *a2)
{
  _BYTE *v4; // rax
  __int64 v5; // rsi
  int v7; // er8
  int v8; // eax
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  int v11; // er8
  int v12; // eax
  PDEVICE_OBJECT v13; // rcx
  unsigned __int16 v14; // dx
  __int64 v15; // [rsp+20h] [rbp-38h]
  char v16; // [rsp+60h] [rbp+8h] BYREF
  int v17; // [rsp+70h] [rbp+18h] BYREF
  int v18; // [rsp+78h] [rbp+20h] BYREF

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x54u, (__int64)&unk_57D38);
  }
  v4 = sub_4AE28(*(_QWORD *)(a1 + 16), 3);
  v5 = (__int64)v4;
  if ( !v4 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x55u, (__int64)&unk_57D38);
    }
    return 6i64;
  }
  sub_4D174((__int64)v4, &v17);
  v7 = v17;
  v8 = v17 + 1;
  if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
  {
    *((_DWORD *)a2 + 109) = v8;
    v9 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v10 = 87;
      goto LABEL_20;
    }
  }
  else
  {
    *((_DWORD *)a2 + 108) = v8;
    v9 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v10 = 86;
LABEL_20:
      sub_17F9C(*(_QWORD *)&v9->DeviceLock.Header.Lock, v10, (__int64)&unk_57D38, *a2, v7);
      goto LABEL_21;
    }
  }
LABEL_21:
  sub_4D4A8(v5, &v16);
  if ( (v16 & 0x10) == 0 )
  {
    if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
      *((_DWORD *)a2 + 107) |= 2u;
    else
      *((_DWORD *)a2 + 107) |= 1u;
    goto LABEL_36;
  }
  sub_4D258(v5, &v18);
  v11 = v18;
  v12 = v17 + 1;
  if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
  {
    *((_DWORD *)a2 + 111) = v18;
    *((_DWORD *)a2 + 110) = v12;
    v13 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      goto LABEL_32;
    }
    v14 = 89;
  }
  else
  {
    *((_DWORD *)a2 + 110) = v18;
    *((_DWORD *)a2 + 111) = v12;
    v13 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      goto LABEL_32;
    }
    v14 = 88;
  }
  LODWORD(v15) = v11;
  sub_17F9C(*(_QWORD *)&v13->DeviceLock.Header.Lock, v14, (__int64)&unk_57D38, *a2, v15);
LABEL_32:
  *((_DWORD *)a2 + 107) = 3;
LABEL_36:
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Au, (__int64)&unk_57D38);
  }
  return 0i64;
}
// 1AF1B: variable 'v15' is possibly undefined

//----- (000000000001AF88) ----------------------------------------------------
__int64 __fastcall sub_1AF88(void *Src, _QWORD *a2, char *a3, _BYTE *a4, __int64 a5)
{
  _BYTE *v9; // rax
  __int64 v10; // rbx
  PDEVICE_OBJECT v11; // rcx
  unsigned __int16 v12; // dx
  int v14; // er8
  int v15; // er10
  int v16; // er9
  int v17; // ebx
  PDEVICE_OBJECT v18; // rcx
  int v19; // ebx
  int v20; // eax
  int v21; // eax
  unsigned __int16 v22; // dx
  int v23; // ebx
  unsigned __int16 v24; // dx
  int v25; // er8
  int v26; // er9
  int v27; // ebx
  int v28; // ebx
  int v29; // eax
  int v30; // eax
  int v31; // ebx
  __int64 v32; // [rsp+20h] [rbp-68h]
  __int64 v33; // [rsp+28h] [rbp-60h]
  unsigned __int16 v34[2]; // [rsp+40h] [rbp-48h] BYREF
  int v35; // [rsp+44h] [rbp-44h] BYREF
  int v36; // [rsp+48h] [rbp-40h] BYREF
  __int64 v37; // [rsp+50h] [rbp-38h] BYREF
  unsigned __int16 v38; // [rsp+90h] [rbp+8h] BYREF

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Bu, (__int64)&unk_57D38);
  }
  v9 = sub_4AE28(*((_QWORD *)Src + 2), 3);
  v10 = (__int64)v9;
  if ( !v9 )
  {
    v11 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 6i64;
    }
    v12 = 92;
LABEL_10:
    sub_11088(*(_QWORD *)&v11->DeviceLock.Header.Lock, v12, (__int64)&unk_57D38);
    return 6i64;
  }
  sub_4D174((__int64)v9, &v35);
  sub_4D258(v10, &v36);
  sub_4D558(v10, v34);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_18050(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 93i64, (__int64)&unk_57D38, *a2, v35, v36, v34[0]);
  }
  if ( (unsigned int)sub_50E34(*((_QWORD *)Src + 2), &v37, &v38) )
  {
    v11 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 6i64;
    }
    v12 = 94;
    goto LABEL_10;
  }
  if ( (*((_BYTE *)Src + 120) & 0x10) == 0 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      LODWORD(v33) = *((_DWORD *)a2 + 108);
      LODWORD(v32) = v35;
      sub_17FF0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Fu, (__int64)&unk_57D38, *a2, v32, v33);
    }
    if ( sub_51640(*((_QWORD *)Src + 2)) )
    {
      v14 = v36;
      if ( v36 - *((_DWORD *)a2 + 110) > 0 )
      {
        *((_DWORD *)a2 + 110) = v36;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          LODWORD(v32) = v14;
          sub_17F9C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x60u, (__int64)&unk_57D38, *a2, v32);
        }
      }
    }
    else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
           && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
           && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EE0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x61u, (__int64)&unk_57D38, *a2, *(_QWORD *)Src);
    }
    v15 = v35;
    v16 = *((_DWORD *)a2 + 108);
    *((_BYTE *)a2 + 644) = v34[0] == 0;
    if ( v15 - v16 >= 0 )
      v17 = v15 - v16 <= 0;
    else
      v17 = 2;
    v18 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_184C0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x62u, (__int64)&unk_57D38, v16);
      v15 = v35;
      v18 = off_5A148;
    }
    if ( v17 )
    {
      v19 = v17 - 1;
      if ( v19 )
      {
        if ( v19 != 1 )
          goto LABEL_155;
        if ( v18 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v18->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
          && BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_1842C(*(_QWORD *)&v18->DeviceLock.Header.Lock, 0x65u, (__int64)&unk_57D38, v15);
          v15 = v35;
          v18 = off_5A148;
        }
        if ( *((_BYTE *)a2 + 645) )
        {
          v20 = v15 - *((_DWORD *)a2 + 108) + 1;
          if ( v20 >= 0 && v20 <= 0 )
          {
            if ( v18 != (PDEVICE_OBJECT)&off_5A148
              && _bittest((const signed __int32 *)&v18->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
              && BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              sub_11088(*(_QWORD *)&v18->DeviceLock.Header.Lock, 0x66u, (__int64)&unk_57D38);
              v15 = v35;
            }
            v21 = v38;
            *((_BYTE *)a2 + 645) = 0;
            *((_DWORD *)a2 + 108) = v21 + v15 + 1;
            *a3 = sub_1AB80(0, (__int64)a2);
            v18 = off_5A148;
            if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
              || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
              || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
            {
              return 0i64;
            }
            v22 = 103;
            goto LABEL_159;
          }
        }
        v23 = v38;
        if ( v15 + v38 - *((_DWORD *)a2 + 108) > 0 )
        {
          if ( v18 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&v18->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
            && BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_11088(*(_QWORD *)&v18->DeviceLock.Header.Lock, 0x68u, (__int64)&unk_57D38);
            v15 = v35;
          }
          *(_WORD *)a5 = *((_WORD *)a2 + 216) - v15;
          *((_DWORD *)a2 + 108) = v23 + v15;
          *a3 = sub_1AB80(0, (__int64)a2);
          v18 = off_5A148;
          if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
            || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
            || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
          {
            return 0i64;
          }
          v22 = 105;
          goto LABEL_159;
        }
        goto LABEL_154;
      }
      if ( !*((_BYTE *)a2 + 645) )
      {
        if ( v18 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v18->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
          && BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_18470(*(_QWORD *)&v18->DeviceLock.Header.Lock, 0x64u, (__int64)&unk_57D38, v15);
          v15 = v35;
        }
        *((_DWORD *)a2 + 108) = v15 + v38;
        *a3 = sub_1AB80(0, (__int64)a2);
        return 0i64;
      }
      if ( v18 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v18->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
        && BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_1842C(*(_QWORD *)&v18->DeviceLock.Header.Lock, 0x63u, (__int64)&unk_57D38, v15);
      }
      *((_BYTE *)a2 + 645) = 0;
      goto LABEL_153;
    }
    if ( v18 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v18->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      || BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      goto LABEL_152;
    }
    v24 = 106;
    goto LABEL_151;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    LODWORD(v33) = *((_DWORD *)a2 + 109);
    LODWORD(v32) = v35;
    sub_17FF0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Bu, (__int64)&unk_57D38, *a2, v32, v33);
  }
  if ( sub_51640(*((_QWORD *)Src + 2)) )
  {
    v25 = v36;
    if ( v36 - *((_DWORD *)a2 + 111) > 0 )
    {
      *((_DWORD *)a2 + 111) = v36;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        LODWORD(v32) = v25;
        sub_17F9C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Cu, (__int64)&unk_57D38, *a2, v32);
      }
    }
  }
  else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
         && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
         && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Du, (__int64)&unk_57D38, *a2, *(_QWORD *)Src);
  }
  v15 = v35;
  v26 = *((_DWORD *)a2 + 109);
  *((_BYTE *)a2 + 645) = v34[0] == 0;
  if ( v15 - v26 >= 0 )
    v27 = v15 - v26 <= 0;
  else
    v27 = 2;
  v18 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_184C0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Eu, (__int64)&unk_57D38, v26);
    v15 = v35;
    v18 = off_5A148;
  }
  if ( !v27 )
  {
    if ( v18 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v18->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      || BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      goto LABEL_152;
    }
    v24 = 119;
LABEL_151:
    sub_1842C(*(_QWORD *)&v18->DeviceLock.Header.Lock, v24, (__int64)&unk_57D38, v15);
    v15 = v35;
LABEL_152:
    sub_1A878(Src, v15, v36, (__int64)a2);
LABEL_153:
    v18 = off_5A148;
    goto LABEL_154;
  }
  v28 = v27 - 1;
  if ( !v28 )
  {
    if ( !*((_BYTE *)a2 + 644) )
    {
      if ( v18 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v18->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
        && BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_18470(*(_QWORD *)&v18->DeviceLock.Header.Lock, 0x70u, (__int64)&unk_57D38, v15);
        v15 = v35;
      }
      *((_DWORD *)a2 + 109) = v15 + v38;
      *a3 = sub_1AB80(1, (__int64)a2);
      v18 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
        return 0i64;
      }
      v22 = 113;
      goto LABEL_159;
    }
    if ( v18 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v18->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      && BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_1842C(*(_QWORD *)&v18->DeviceLock.Header.Lock, 0x6Fu, (__int64)&unk_57D38, v15);
    }
    *((_BYTE *)a2 + 644) = 0;
    goto LABEL_153;
  }
  if ( v28 != 1 )
    goto LABEL_155;
  if ( v18 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v18->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
    && BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_1842C(*(_QWORD *)&v18->DeviceLock.Header.Lock, 0x72u, (__int64)&unk_57D38, v15);
    v15 = v35;
    v18 = off_5A148;
  }
  if ( *((_BYTE *)a2 + 644) )
  {
    v29 = v15 - *((_DWORD *)a2 + 109) + 1;
    if ( v29 >= 0 && v29 <= 0 )
    {
      if ( v18 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v18->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
        && BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&v18->DeviceLock.Header.Lock, 0x73u, (__int64)&unk_57D38);
        v15 = v35;
      }
      v30 = v38;
      *((_BYTE *)a2 + 644) = 0;
      *((_DWORD *)a2 + 109) = v30 + v15 + 1;
      *a3 = sub_1AB80(1, (__int64)a2);
      v18 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
        return 0i64;
      }
      v22 = 116;
      goto LABEL_159;
    }
  }
  v31 = v38;
  if ( v15 + v38 - *((_DWORD *)a2 + 109) > 0 )
  {
    if ( v18 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v18->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      && BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&v18->DeviceLock.Header.Lock, 0x75u, (__int64)&unk_57D38);
      v15 = v35;
    }
    *(_WORD *)a5 = *((_WORD *)a2 + 218) - v15;
    *((_DWORD *)a2 + 109) = v31 + v15;
    *a3 = sub_1AB80(1, (__int64)a2);
    v18 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      return 0i64;
    }
    v22 = 118;
    goto LABEL_159;
  }
LABEL_154:
  *a4 = 1;
LABEL_155:
  if ( v18 == (PDEVICE_OBJECT)&off_5A148
    || (BYTE4(v18->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
    || BYTE1(v18->DeviceLock.Header.WaitListHead.Blink) < 5u )
  {
    return 0i64;
  }
  v22 = 120;
LABEL_159:
  sub_11088(*(_QWORD *)&v18->DeviceLock.Header.Lock, v22, (__int64)&unk_57D38);
  return 0i64;
}
// 1B15B: variable 'v32' is possibly undefined
// 1B15B: variable 'v33' is possibly undefined

//----- (000000000001B9C0) ----------------------------------------------------
__int64 __fastcall sub_1B9C0(__int64 a1, _BYTE *a2)
{
  _DWORD *v4; // rax
  __int64 v5; // rbx
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  __int64 v9; // rax
  _BYTE *v10; // rax
  __int64 v11; // rbp
  PDEVICE_OBJECT v12; // rcx
  unsigned __int16 v13; // dx
  __int64 v14; // rcx
  __int64 *v15; // rax
  int v16; // [rsp+30h] [rbp-38h] BYREF
  __int64 v17[6]; // [rsp+38h] [rbp-30h] BYREF
  __int16 v18; // [rsp+80h] [rbp+18h] BYREF
  int v19; // [rsp+88h] [rbp+20h] BYREF

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x79u, (__int64)&unk_57D38);
  }
  v4 = sub_3C910((__int64)qword_5A8B0);
  v5 = (__int64)v4;
  if ( !v4 )
  {
    v6 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v7 = 122;
LABEL_10:
    sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, v7, (__int64)&unk_57D38);
    return 3i64;
  }
  memset(v4, 0, 0x30ui64);
  v9 = sub_1A1AC(a2);
  *(_QWORD *)(v5 + 16) = v9;
  if ( !v9 )
  {
    sub_3C978((__int64)qword_5A8B0, v5);
    v6 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 3i64;
    }
    v7 = 123;
    goto LABEL_10;
  }
  v10 = sub_4AE28(*(_QWORD *)(v9 + 16), 3);
  v11 = (__int64)v10;
  if ( !v10 )
  {
    v12 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_23;
    }
    v13 = 124;
LABEL_22:
    sub_11088(*(_QWORD *)&v12->DeviceLock.Header.Lock, v13, (__int64)&unk_57D38);
LABEL_23:
    sub_3C570(*(PVOID *)(*(_QWORD *)(v5 + 16) + 16i64), 0x50535453u);
    sub_3C978((__int64)qword_5A8A8, *(_QWORD *)(v5 + 16));
    sub_3C978((__int64)qword_5A8B0, v5);
    return 6i64;
  }
  sub_4D174((__int64)v10, &v19);
  sub_4D258(v11, &v16);
  if ( (unsigned int)sub_50E34(*(_QWORD *)(*(_QWORD *)(v5 + 16) + 16i64), v17, &v18) )
  {
    v12 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_23;
    }
    v13 = 125;
    goto LABEL_22;
  }
  v14 = a1 + 448;
  *(_DWORD *)(v5 + 32) = v19;
  *(_DWORD *)(v5 + 36) = v16;
  *(_WORD *)(v5 + 40) = v18;
  *(_QWORD *)(v5 + 24) = v17[0];
  if ( (a2[120] & 0x10) != 0 )
    v14 = a1 + 496;
  v15 = *(__int64 **)(v14 + 8);
  *(_QWORD *)v5 = v14;
  *(_QWORD *)(v5 + 8) = v15;
  *v15 = v5;
  *(_QWORD *)(v14 + 8) = v5;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x7Eu, (__int64)&unk_57D38);
  }
  return 0i64;
}

//----- (000000000001BC78) ----------------------------------------------------
__int64 __fastcall sub_1BC78(__int64 a1, int a2)
{
  PDEVICE_OBJECT v4; // rcx
  unsigned int v5; // er9
  _QWORD **v6; // rdx
  _QWORD *v7; // r8
  _QWORD *v8; // rax
  _QWORD *v9; // rax
  _QWORD *v10; // rax
  unsigned __int16 v11; // dx
  unsigned int v12; // er9
  _QWORD **v13; // rdx
  _QWORD *v14; // r8
  _QWORD *v15; // rax
  _QWORD *v16; // rax
  _QWORD *v18; // rax

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x7Fu, (__int64)&unk_57D38);
    v4 = off_5A148;
  }
  if ( a2 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x82u, (__int64)&unk_57D38);
      v4 = off_5A148;
    }
    v12 = *(_DWORD *)(a1 + 436);
    v13 = (_QWORD **)(a1 + 592);
    if ( *v13 != v13 )
    {
      while ( 1 )
      {
        v14 = *v13;
        v15 = (_QWORD *)**v13;
        *v13 = v15;
        v15[1] = v13;
        if ( *((_DWORD *)v14 + 8) > v12 )
          break;
        v16 = *(_QWORD **)(a1 + 504);
        v12 = *((_DWORD *)v14 + 8) + *((unsigned __int16 *)v14 + 20);
        *v14 = a1 + 496;
        v14[1] = v16;
        *v16 = v14;
        *(_QWORD *)(a1 + 504) = v14;
        if ( *v13 == v13 )
        {
LABEL_25:
          v4 = off_5A148;
          goto LABEL_26;
        }
      }
      v18 = *v13;
      v14[1] = v13;
      *v14 = v18;
      v18[1] = v14;
      *v13 = v14;
      v4 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        v11 = 131;
        goto LABEL_30;
      }
      return 0i64;
    }
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x80u, (__int64)&unk_57D38);
      v4 = off_5A148;
    }
    v5 = *(_DWORD *)(a1 + 432);
    v6 = (_QWORD **)(a1 + 544);
    if ( *v6 != v6 )
    {
      while ( 1 )
      {
        v7 = *v6;
        v8 = (_QWORD *)**v6;
        *v6 = v8;
        v8[1] = v6;
        if ( *((_DWORD *)v7 + 8) > v5 )
          break;
        v9 = *(_QWORD **)(a1 + 456);
        v5 = *((_DWORD *)v7 + 8) + *((unsigned __int16 *)v7 + 20);
        *v7 = a1 + 448;
        v7[1] = v9;
        *v9 = v7;
        *(_QWORD *)(a1 + 456) = v7;
        if ( *v6 == v6 )
          goto LABEL_25;
      }
      v10 = *v6;
      v7[1] = v6;
      *v7 = v10;
      v10[1] = v7;
      *v6 = v7;
      v4 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        v11 = 129;
LABEL_30:
        sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, v11, (__int64)&unk_57D38);
        return 0i64;
      }
      return 0i64;
    }
  }
LABEL_26:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v11 = 132;
    goto LABEL_30;
  }
  return 0i64;
}

//----- (000000000001BEB4) ----------------------------------------------------
__int64 __fastcall sub_1BEB4(__int64 a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  _QWORD **v5; // rbx
  _QWORD *v6; // rbp
  _QWORD *v7; // rax
  int v8; // ecx
  int v9; // eax
  __int64 v11; // [rsp+20h] [rbp-58h]
  __int64 v12[3]; // [rsp+30h] [rbp-48h] BYREF
  int v13; // [rsp+48h] [rbp-30h]
  __int64 v14; // [rsp+51h] [rbp-27h]
  __int64 v15; // [rsp+59h] [rbp-1Fh]

  LODWORD(v12[0]) = 0;
  memset((char *)v12 + 4, 0, 0x2Dui64);
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x85u, (__int64)&unk_57D38);
    v4 = off_5A148;
  }
  v5 = (_QWORD **)(a1 + 448);
  if ( (*(_BYTE *)(a2 + 120) & 0x10) != 0 )
    v5 = (_QWORD **)(a1 + 496);
  if ( *v5 != v5 )
  {
    do
    {
      v6 = *v5;
      v7 = (_QWORD *)**v5;
      *v5 = v7;
      v7[1] = v5;
      v8 = *(_DWORD *)(a1 + 24);
      v12[0] = *(_QWORD *)a1;
      v14 = *(_QWORD *)(a1 + 32);
      v15 = *(_QWORD *)(a1 + 40);
      v12[2] = v6[3];
      v13 = *((unsigned __int16 *)v6 + 20);
      v9 = sub_1F628(v8, (__int64)v12, a2, a1);
      if ( v9
        && off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        LODWORD(v11) = v9;
        sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x86u, (__int64)&unk_57D38, *(_QWORD *)a1, v11);
      }
      sub_20018((__int64)v6);
    }
    while ( *v5 != v5 );
    v4 = off_5A148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x87u, (__int64)&unk_57D38);
  }
  return 0i64;
}
// 1BFCF: variable 'v11' is possibly undefined

//----- (000000000001C040) ----------------------------------------------------
__int64 __fastcall sub_1C040(__int64 a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  char v5; // al
  BOOL v6; // ebp
  unsigned __int16 v7; // dx
  __int64 *v8; // rsi
  __int64 v9; // rdi
  _QWORD *v10; // rax
  __int64 v11; // rax
  PDEVICE_OBJECT v12; // rcx
  int v13; // er9
  int v14; // eax
  int v15; // eax
  PDEVICE_OBJECT v16; // rcx
  unsigned __int16 v17; // dx
  int v18; // eax
  _QWORD *v20; // rax
  _QWORD *v21; // rax
  __int64 v22; // [rsp+20h] [rbp-68h]
  __int64 v23[3]; // [rsp+30h] [rbp-58h] BYREF
  int v24; // [rsp+48h] [rbp-40h]
  BOOL v25; // [rsp+4Ch] [rbp-3Ch]
  __int64 v26; // [rsp+51h] [rbp-37h]
  __int64 v27; // [rsp+59h] [rbp-2Fh]

  LODWORD(v23[0]) = 0;
  memset((char *)v23 + 4, 0, 0x2Dui64);
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x88u, (__int64)&unk_57D38);
    v4 = off_5A148;
  }
  v5 = *(_BYTE *)(a2 + 120) & 0x10;
  v6 = v5 == 16;
  if ( v5 == 16 )
  {
    if ( *(_BYTE *)(a1 + 688) )
    {
      if ( v4 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
        || BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) < 4u )
      {
        return 0i64;
      }
      v7 = 138;
LABEL_60:
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, v7, (__int64)&unk_57D38);
      return 0i64;
    }
    v8 = (__int64 *)(a1 + 592);
  }
  else
  {
    if ( *(_BYTE *)(a1 + 689) != v6 )
    {
      if ( v4 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
        || BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) < 4u )
      {
        return 0i64;
      }
      v7 = 137;
      goto LABEL_60;
    }
    v8 = (__int64 *)(a1 + 544);
  }
  if ( (__int64 *)*v8 == v8 )
  {
LABEL_56:
    if ( v4 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      return 0i64;
    }
    v7 = 146;
    goto LABEL_60;
  }
  while ( 1 )
  {
    v9 = *v8;
    v10 = *(_QWORD **)*v8;
    *v8 = (__int64)v10;
    v10[1] = v8;
    if ( v6 )
      _InterlockedAdd((volatile signed __int32 *)(a1 + 680), 0xFFFFFFFF);
    else
      _InterlockedAdd((volatile signed __int32 *)(a1 + 684), 0xFFFFFFFF);
    v11 = *(_QWORD *)a1;
    v25 = v6;
    v23[0] = v11;
    v26 = *(_QWORD *)(a1 + 32);
    v27 = *(_QWORD *)(a1 + 40);
    v24 = *(unsigned __int16 *)(v9 + 40);
    v23[2] = *(_QWORD *)(v9 + 24);
    v12 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_184C0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x8Bu, (__int64)&unk_57D38, *(_DWORD *)(v9 + 32));
      v12 = off_5A148;
    }
    v13 = *(_DWORD *)(v9 + 32);
    if ( v6 )
      break;
    v14 = v13 - *(_DWORD *)(a1 + 432);
    if ( v14 >= 0 && v14 > 0 )
    {
      v20 = (_QWORD *)*v8;
      *(_QWORD *)(v9 + 8) = v8;
      *(_QWORD *)v9 = v20;
      v20[1] = v9;
      *v8 = v9;
      _InterlockedAdd((volatile signed __int32 *)(a1 + 684), 1u);
      v4 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        v7 = 142;
        goto LABEL_60;
      }
      return 0i64;
    }
    if ( v12 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v12->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_1842C(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x8Cu, (__int64)&unk_57D38, v13);
    }
    *(_DWORD *)(a1 + 432) = *(_DWORD *)(v9 + 32) + *(unsigned __int16 *)(v9 + 40);
    if ( *(_DWORD *)(v9 + 36) - *(_DWORD *)(a1 + 440) > 0 )
      *(_DWORD *)(a1 + 440) = *(_DWORD *)(v9 + 36);
    v15 = sub_1F628(*(_DWORD *)(a1 + 24), (__int64)v23, a2, a1);
    if ( v15 )
    {
      v16 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        v17 = 141;
LABEL_53:
        LODWORD(v22) = v15;
        sub_4AC00(*(_QWORD *)&v16->DeviceLock.Header.Lock, v17, (__int64)&unk_57D38, *(_QWORD *)a1, v22);
        goto LABEL_54;
      }
    }
LABEL_54:
    sub_20018(v9);
    if ( (__int64 *)*v8 == v8 )
    {
      v4 = off_5A148;
      goto LABEL_56;
    }
  }
  v18 = v13 - *(_DWORD *)(a1 + 436);
  if ( v18 < 0 || v18 <= 0 )
  {
    if ( v12 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v12->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_1842C(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x8Fu, (__int64)&unk_57D38, v13);
    }
    *(_DWORD *)(a1 + 436) = *(_DWORD *)(v9 + 32) + *(unsigned __int16 *)(v9 + 40);
    if ( *(_DWORD *)(v9 + 36) - *(_DWORD *)(a1 + 444) > 0 )
      *(_DWORD *)(a1 + 444) = *(_DWORD *)(v9 + 36);
    v15 = sub_1F628(*(_DWORD *)(a1 + 24), (__int64)v23, a2, a1);
    if ( !v15 )
      goto LABEL_54;
    v16 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_54;
    }
    v17 = 144;
    goto LABEL_53;
  }
  v21 = (_QWORD *)*v8;
  *(_QWORD *)(v9 + 8) = v8;
  *(_QWORD *)v9 = v21;
  v21[1] = v9;
  *v8 = v9;
  _InterlockedAdd((volatile signed __int32 *)(a1 + 680), 1u);
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v7 = 145;
    goto LABEL_60;
  }
  return 0i64;
}
// 1C364: variable 'v22' is possibly undefined

//----- (000000000001C45C) ----------------------------------------------------
__int64 __fastcall sub_1C45C(__int64 a1, __int64 a2, int a3, char a4)
{
  unsigned int v8; // edi
  __int16 v9; // ax
  int v10; // eax
  __int64 v11; // rax
  int v12; // eax
  __int64 v14; // [rsp+30h] [rbp-58h] BYREF
  int v15; // [rsp+38h] [rbp-50h]
  __int16 v16; // [rsp+3Ch] [rbp-4Ch]
  __int16 v17; // [rsp+3Eh] [rbp-4Ah]
  __m128i v18; // [rsp+40h] [rbp-48h]
  __m128i v19; // [rsp+50h] [rbp-38h]
  int v20; // [rsp+60h] [rbp-28h]
  int v21; // [rsp+64h] [rbp-24h]

  v8 = 3;
  if ( a1 )
  {
    v20 = *(_DWORD *)(a1 + 124);
    v16 = *(_WORD *)(a1 + 72);
    v9 = *(_WORD *)(a1 + 74);
    v18 = _mm_loadu_si128((const __m128i *)(a1 + 88));
    v19 = _mm_loadu_si128((const __m128i *)(a1 + 104));
    v17 = v9;
    v21 = *(_DWORD *)(a1 + 16);
  }
  if ( a2 )
  {
    if ( sub_518C8(*(_QWORD *)(a2 + 16)) )
    {
      v14 = *(_QWORD *)a1;
      v10 = sub_1F3EC(a1, (*(_BYTE *)(a2 + 120) & 0x10) == 16);
      if ( *(_BYTE *)(a1 + 648) )
        v10 = 2;
      v15 = v10;
      if ( a4 )
        sub_1F4D4(a3, (__int64)&v14);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x93u, (__int64)&unk_57D38);
      }
      v8 = v15;
    }
    if ( sub_51B48(*(_QWORD *)(a2 + 16)) )
    {
      v11 = *(_QWORD *)a1;
      v15 = 2;
      v14 = v11;
      if ( a4 )
        sub_1F4D4(a3, (__int64)&v14);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x94u, (__int64)&unk_57D38);
      }
      v8 = 2;
    }
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x95u, (__int64)&unk_57D38, *(_QWORD *)a1);
    }
    v14 = *(_QWORD *)a1;
    v8 = 2;
    v15 = 2;
    if ( a4 )
    {
      sub_1F4D4(a3, (__int64)&v14);
      v8 = v15;
    }
  }
  if ( v8 == 2 )
  {
    if ( *(_BYTE *)(a1 + 648) )
    {
      v12 = sub_217FC(a1, 0);
      if ( v12 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x96u, (__int64)&unk_57D38, *(_QWORD *)a1, v12);
        }
      }
    }
  }
  return v8;
}

//----- (000000000001C6B4) ----------------------------------------------------
char __fastcall sub_1C6B4(__int64 a1)
{
  char v2; // bl
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  const char *v5; // rax

  v2 = 1;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x97u, (__int64)&unk_57D38);
    v3 = off_5A148;
  }
  if ( !*(_QWORD *)a1 )
  {
    if ( v3 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      goto LABEL_21;
    }
    v4 = 152;
LABEL_20:
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, v4, (__int64)&unk_57D38);
    v3 = off_5A148;
LABEL_21:
    v2 = 0;
    goto LABEL_22;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v5 = sub_4A7C4(*(_DWORD *)(a1 + 16));
    sub_187E8(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x99u, (__int64)&unk_57D38, v5);
    v3 = off_5A148;
  }
  if ( *(_DWORD *)(a1 + 16) == 6 && !*(_QWORD *)(a1 + 32) )
  {
    if ( v3 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      goto LABEL_21;
    }
    v4 = 154;
    goto LABEL_20;
  }
LABEL_22:
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x9Bu, (__int64)&unk_57D38);
  }
  return v2;
}

//----- (000000000001C814) ----------------------------------------------------
__int64 __fastcall sub_1C814(void *Src, int *a2, _QWORD *a3)
{
  unsigned int v3; // ebx
  int *v6; // rsi
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v9; // dx
  char v10; // r15
  PDEVICE_OBJECT v11; // rcx
  unsigned __int16 v12; // dx
  unsigned __int64 *v13; // rax
  unsigned int v14; // edi
  unsigned __int64 *v15; // rbp
  ULONG_PTR v16; // r13
  char v17; // si
  const char *v18; // r9
  ULONG_PTR v19; // r15
  char v20; // di
  ULONG_PTR v21; // rdx
  const char *v22; // rax
  __int64 v23; // r10
  PDEVICE_OBJECT v24; // rcx
  unsigned __int64 v25; // rdx
  _QWORD *v26; // rsi
  PDEVICE_OBJECT v27; // rcx
  __int64 v28; // rdi
  __int64 v29; // r8
  int v30; // eax
  ULONG_PTR v31; // rdx
  ULONG_PTR v32; // rcx
  unsigned __int64 *v33; // rdi
  int v34; // er11
  PDEVICE_OBJECT v35; // rcx
  unsigned __int16 v36; // dx
  int v37; // eax
  PDEVICE_OBJECT v38; // rcx
  int v39; // eax
  PDEVICE_OBJECT v40; // rcx
  int v41; // eax
  unsigned __int64 v42; // rdi
  int v43; // er15
  unsigned __int64 v44; // rsi
  int v45; // eax
  ULONG_PTR v46; // r12
  int v47; // er14
  __int64 v48; // r8
  __int64 v49; // r8
  int v50; // ebx
  int *v51; // r15
  PDEVICE_OBJECT v52; // rcx
  unsigned __int16 v53; // dx
  int v54; // eax
  ULONG_PTR v55; // rdi
  char v56; // si
  __int64 v57; // rcx
  __int64 v58; // rax
  __int64 v59; // rcx
  int v60; // eax
  int v61; // eax
  PLARGE_INTEGER Timeout; // [rsp+20h] [rbp-148h]
  PLARGE_INTEGER Timeouta; // [rsp+20h] [rbp-148h]
  PLARGE_INTEGER Timeoutb; // [rsp+20h] [rbp-148h]
  PLARGE_INTEGER Timeoutc; // [rsp+20h] [rbp-148h]
  __int64 v66; // [rsp+28h] [rbp-140h]
  char v67; // [rsp+28h] [rbp-140h]
  char v68; // [rsp+40h] [rbp-128h]
  char v69; // [rsp+41h] [rbp-127h] BYREF
  char v70[6]; // [rsp+42h] [rbp-126h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+48h] [rbp-120h] BYREF
  __int64 v72; // [rsp+50h] [rbp-118h] BYREF
  int v73; // [rsp+58h] [rbp-110h] BYREF
  ULONG_PTR v74; // [rsp+60h] [rbp-108h] BYREF
  ULONG_PTR BugCheckParameter2; // [rsp+68h] [rbp-100h] BYREF
  __int64 Dst[2]; // [rsp+70h] [rbp-F8h] BYREF
  __int64 v77; // [rsp+80h] [rbp-E8h] BYREF
  int v78[2]; // [rsp+88h] [rbp-E0h] BYREF
  __int64 v79; // [rsp+91h] [rbp-D7h]
  __int64 v80; // [rsp+99h] [rbp-CFh]
  __int64 v81; // [rsp+A8h] [rbp-C0h] BYREF
  unsigned __int64 *v82; // [rsp+B0h] [rbp-B8h] BYREF
  unsigned __int64 v83; // [rsp+B8h] [rbp-B0h] BYREF
  int v84; // [rsp+C0h] [rbp-A8h]
  unsigned __int64 v85; // [rsp+F0h] [rbp-78h] BYREF
  int v86; // [rsp+F8h] [rbp-70h]
  __int64 v87; // [rsp+170h] [rbp+8h] BYREF
  int *v88; // [rsp+178h] [rbp+10h]
  char v89; // [rsp+188h] [rbp+20h] BYREF

  v88 = a2;
  v3 = 0;
  v6 = a2;
  HIDWORD(v72) = 0;
  v73 = 0;
  v81 = 0i64;
  v89 = 0;
  v69 = 0;
  LOBYTE(v87) = 0;
  BugCheckParameter2 = 0i64;
  LODWORD(Dst[0]) = 0;
  memset((char *)Dst + 4, 0, 0x2Dui64);
  LOWORD(v72) = 0;
  v70[0] = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x9Cu, (__int64)&unk_57D38);
  }
  *v6 = 1;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    sub_17BF0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x9Du, (__int64)&unk_57D38, *((_DWORD *)Src + 32));
    v7 = off_5A148;
  }
  if ( *((_DWORD *)Src + 32) == 1 )
  {
    if ( (unsigned int)dword_5A954 > 1 )
    {
      _InterlockedAdd((volatile signed __int32 *)P + 1, 1u);
      v7 = off_5A148;
    }
    if ( *((_DWORD *)a3 + 4) != 6 && *((_DWORD *)a3 + 4) != 17 )
    {
      if ( v7 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) < 3u )
      {
        return 0i64;
      }
      v9 = 159;
      goto LABEL_23;
    }
    if ( !sub_1C6B4((__int64)a3) )
    {
      v7 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
      {
        return 0i64;
      }
      v9 = 160;
      goto LABEL_23;
    }
    v10 = sub_16BDC(*((_DWORD *)a3 + 5));
    v68 = v10;
    if ( v10 )
    {
      v11 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        v12 = 162;
        goto LABEL_38;
      }
    }
    else
    {
      v11 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        v12 = 161;
LABEL_38:
        sub_13EA4(*(_QWORD *)&v11->DeviceLock.Header.Lock, v12, (__int64)&unk_57D38, *((_DWORD *)a3 + 5));
        goto LABEL_39;
      }
    }
LABEL_39:
    KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
    v13 = (unsigned __int64 *)sub_26F64(
                                a3,
                                v10,
                                (__int64)Src,
                                &BugCheckParameter2,
                                (ULONG_PTR **)&BugCheckParameter1,
                                &v81,
                                &v74,
                                (_DWORD *)&v72 + 1);
    v14 = HIDWORD(v72);
    v15 = v13;
    v82 = v13;
    if ( HIDWORD(v72) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_17BF0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA4u, (__int64)&unk_57D38, SHIDWORD(v72));
      }
      KeReleaseMutex(&Mutex, 0);
      return v14;
    }
    v16 = BugCheckParameter2;
    if ( v13 )
    {
      KeReleaseMutex(&Mutex, 0);
      KeWaitForSingleObject((PVOID)v15[1], Executive, 0, 0, 0i64);
      sub_20F20((__int64)v15);
      v17 = *((_BYTE *)v15 + 58);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        v18 = "Non-DS";
        if ( v17 )
          v18 = (const char *)qword_567C0;
        Timeouta = (PLARGE_INTEGER)*v15;
        sub_18848(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA5u, (__int64)&unk_57D38, v18);
      }
      LOBYTE(Timeouta) = v10;
      v19 = BugCheckParameter1;
      v14 = sub_2677C(v15, BugCheckParameter1, v16, Src, (int)Timeouta, v70);
      if ( v14 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA7u, (__int64)&unk_57D38, v14);
        }
      }
      else if ( v70[0] )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
        {
          sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA6u, (__int64)&unk_57D38);
        }
        if ( v17 )
        {
          KeReleaseMutex((PRKMUTEX)v15[1], 0);
          sub_49CF0(v16, v19);
        }
        if ( v74 )
          sub_49CF0(v16, v74);
        return v14;
      }
      v6 = v88;
    }
    else
    {
      v19 = BugCheckParameter1;
    }
    v20 = v68;
    if ( !sub_1DD74(Src, v68) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA8u, (__int64)&unk_57D38, *(_QWORD *)Src);
      }
      *v6 = 1;
      if ( !v15 )
      {
        KeReleaseMutex(&Mutex, 0);
        return 0i64;
      }
      KeReleaseMutex((PRKMUTEX)v15[1], 0);
      v21 = v19;
      goto LABEL_310;
    }
    if ( *((_DWORD *)a3 + 4) == 17 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA9u, (__int64)&unk_57D38);
      }
      sub_1DFC0(&v82, (ULONG_PTR **)&BugCheckParameter1, &BugCheckParameter2, a3, (__int64)Src, v6);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        v22 = sub_4A760(*v6);
        sub_182DC(*(_QWORD *)(v23 + 280), 0xAAu, (__int64)&unk_57D38, *(_QWORD *)Src, v22);
      }
      return 0i64;
    }
    if ( !v15 )
    {
      v24 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xABu, (__int64)&unk_57D38, *a3);
        v24 = off_5A148;
      }
      if ( !v68 && *((_DWORD *)a3 + 5) != 1 )
      {
        if ( v24 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v24->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v24->DeviceLock.Header.WaitListHead.Blink) >= 3u )
        {
          sub_11088(*(_QWORD *)&v24->DeviceLock.Header.Lock, 0xACu, (__int64)&unk_57D38);
        }
        goto LABEL_181;
      }
      if ( sub_1FCD0() )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xADu, (__int64)&unk_57D38, *a3);
        }
        v3 = 10;
        goto LABEL_181;
      }
      v25 = a3[1];
      if ( v25 )
      {
        v26 = (_QWORD *)sub_49034(qword_5A8C0, v25, &BugCheckParameter1, &v73);
        if ( !v73 )
        {
          v27 = off_5A148;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
          {
            sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xAEu, (__int64)&unk_57D38, *a3);
            v27 = off_5A148;
          }
          v28 = v26[50];
          if ( v28 )
          {
            v29 = v26[50];
            *(_QWORD *)v28 = *a3;
            *(_QWORD *)(v28 + 392) = *v26;
            v26[49] = *(_QWORD *)v28;
            v30 = sub_488F0(qword_5A8C0, *(_QWORD *)v28, v29, (ULONG_PTR **)&v74);
            if ( !v30 )
            {
              sub_275B8(v28);
              *(_BYTE *)(v28 + 56) = 1;
              KeReleaseMutex(&Mutex, 0);
              KeWaitForSingleObject(*(PVOID *)(v28 + 8), Executive, 0, 0, 0i64);
              *v88 = 4;
              sub_30F74((_QWORD *)v28, Src);
              KeReleaseMutex(*(PRKMUTEX *)(v28 + 8), 0);
              sub_49CF0(qword_5A8C0, BugCheckParameter1);
              v31 = v74;
              if ( !v74 )
                return 0i64;
              v32 = qword_5A8C0;
LABEL_312:
              sub_49CF0(v32, v31);
              return 0i64;
            }
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
            {
              sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB0u, (__int64)&unk_57D38, v30);
            }
            v3 = 13;
            goto LABEL_181;
          }
          if ( v27 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(v27->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
            && BYTE1(v27->DeviceLock.Header.WaitListHead.Blink) >= 2u )
          {
            sub_12D64(*(_QWORD *)&v27->DeviceLock.Header.Lock, 0xAFu, (__int64)&unk_57D38, *v26);
          }
        }
        goto LABEL_114;
      }
      v33 = (unsigned __int64 *)sub_1928C(
                                  *a3,
                                  0i64,
                                  *((_DWORD *)a3 + 4),
                                  *((_DWORD *)a3 + 5),
                                  a3[4],
                                  a3[5],
                                  0i64,
                                  (__int64)Src);
      if ( !v33 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB1u, (__int64)&unk_57D38, *a3);
        }
        v3 = 3;
        goto LABEL_181;
      }
      if ( !sub_514FC(*((_QWORD *)Src + 2)) )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB9u, (__int64)&unk_57D38, *a3);
        }
        v39 = sub_488F0(qword_5A8C8, *v33, (__int64)v33, (ULONG_PTR **)&BugCheckParameter1);
        *((_BYTE *)v33 + 56) = 1;
        v16 = qword_5A8C8;
        if ( v39 )
        {
          v35 = off_5A148;
          if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
            || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
            || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
          {
            goto LABEL_151;
          }
          v36 = 186;
          LODWORD(Timeoutb) = v39;
          goto LABEL_150;
        }
        *((_BYTE *)v33 + 57) = 0;
        sub_275B8((__int64)v33);
        goto LABEL_180;
      }
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB2u, (__int64)&unk_57D38, *a3);
      }
      sub_1AD48((__int64)Src, v33);
      if ( byte_5A66C )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB3u, (__int64)&unk_57D38, *a3);
        }
        sub_488F0(qword_5A8C8, *v33, (__int64)v33, (ULONG_PTR **)&BugCheckParameter1);
        *((_BYTE *)v33 + 56) = 1;
        v16 = qword_5A8C8;
        *((_BYTE *)v33 + 57) = 0;
      }
      else
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB4u, (__int64)&unk_57D38, *a3);
        }
        sub_488F0(qword_5A8C0, *v33, (__int64)v33, (ULONG_PTR **)&BugCheckParameter1);
        *((_BYTE *)v33 + 56) = 1;
        v16 = qword_5A8C0;
      }
      sub_275B8((__int64)v33);
      if ( v34 )
      {
        v35 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
          || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
          || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
        {
          goto LABEL_151;
        }
        v36 = 181;
        LODWORD(Timeoutb) = v34;
LABEL_150:
        sub_4AC00(*(_QWORD *)&v35->DeviceLock.Header.Lock, v36, (__int64)&unk_57D38, *v33, Timeoutb);
LABEL_151:
        sub_196DC((__int64)v33);
LABEL_114:
        v3 = 5;
LABEL_181:
        KeReleaseMutex(&Mutex, 0);
        return v3;
      }
      if ( !*((_BYTE *)v33 + 58) )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_13EE0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB6u, (__int64)&unk_57D38, *(_QWORD *)Src, *v33);
        }
        v37 = sub_4D8E4(8u, (__int64)Src + 24);
        if ( v37 )
        {
          v38 = off_5A148;
          if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
            || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
            || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
          {
LABEL_163:
            if ( v16 == qword_5A8C0 && *((_BYTE *)v33 + 58) == 1 )
            {
              if ( v38 != (PDEVICE_OBJECT)&off_5A148
                && (BYTE4(v38->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
                && BYTE1(v38->DeviceLock.Header.WaitListHead.Blink) >= 4u )
              {
                sub_12D64(*(_QWORD *)&v38->DeviceLock.Header.Lock, 0xB8u, (__int64)&unk_57D38, *a3);
              }
              KeReleaseMutex(&Mutex, 0);
              *v6 = 4;
              KeWaitForSingleObject((PVOID)v33[1], Executive, 0, 0, 0i64);
              sub_30F74(v33, Src);
              KeReleaseMutex((PRKMUTEX)v33[1], 0);
LABEL_287:
              sub_49CF0(v16, BugCheckParameter1);
              return v3;
            }
LABEL_180:
            sub_49CF0(v16, BugCheckParameter1);
            goto LABEL_181;
          }
          sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB7u, (__int64)&unk_57D38, v37);
        }
      }
      v38 = off_5A148;
      goto LABEL_163;
    }
    v40 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xBBu, (__int64)&unk_57D38, *a3);
      v40 = off_5A148;
    }
    if ( !v68 && *((_DWORD *)a3 + 5) != 1 && *((_BYTE *)v15 + 57) )
    {
      if ( v40 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v40->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(v40->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        LODWORD(v66) = *((_DWORD *)a3 + 5);
        LODWORD(Timeout) = *((_DWORD *)v15 + 6);
        sub_18284(*(_QWORD *)&v40->DeviceLock.Header.Lock, 0xBCu, (__int64)&unk_57D38, *a3, Timeout, v66);
        v40 = off_5A148;
      }
      if ( v16 == qword_5A8C0 && *((_BYTE *)v15 + 58) )
      {
        if ( v40 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v40->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v40->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&v40->DeviceLock.Header.Lock, 0xBDu, (__int64)&unk_57D38, *a3);
        }
        sub_23544((__int64)v15, (__int64)a3);
      }
      else
      {
        if ( v40 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v40->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v40->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&v40->DeviceLock.Header.Lock, 0xBEu, (__int64)&unk_57D38, *a3);
        }
        *((_BYTE *)v15 + 57) = 0;
      }
      v40 = off_5A148;
    }
    if ( *((_BYTE *)v15 + 58) == 1 )
    {
      v41 = *((_DWORD *)v15 + 6);
      v42 = *v15;
      v43 = 0;
      HIDWORD(v72) = v41;
      if ( !v15[50] )
      {
        if ( v40 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v40->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v40->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_12D64(*(_QWORD *)&v40->DeviceLock.Header.Lock, 0xBFu, (__int64)&unk_57D38, v42);
        }
        KeReleaseMutex((PRKMUTEX)v15[1], 0);
        v3 = 5;
        goto LABEL_287;
      }
      v44 = *(_QWORD *)v15[50];
      if ( v41 == 1 )
      {
        v45 = *((_DWORD *)a3 + 5);
        if ( v45 != 1 )
        {
          *((_DWORD *)v15 + 6) = v45;
          *(_DWORD *)(v15[50] + 24) = *((_DWORD *)a3 + 5);
          v40 = off_5A148;
        }
      }
      if ( *((_BYTE *)v15 + 58) )
      {
        if ( v40 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v40->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v40->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&v40->DeviceLock.Header.Lock, 0xC0u, (__int64)&unk_57D38, *a3);
        }
        *v88 = 4;
        sub_30F74(v15, Src);
        if ( *((_DWORD *)v15 + 6) == 10 )
        {
          *((_DWORD *)v15 + 6) = 1;
          *(_DWORD *)(v15[50] + 24) = 1;
        }
        v46 = v74;
        v47 = *(_DWORD *)(v15[51] + 16);
        if ( v74 )
          v43 = *(_DWORD *)(*(_QWORD *)(v15[50] + 408) + 16i64);
        KeReleaseMutex((PRKMUTEX)v15[1], 0);
        sub_49CF0(v16, BugCheckParameter1);
        if ( v46 )
          sub_49CF0(v16, v46);
        if ( !v47 && !v43 )
        {
          KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
          LOBYTE(v48) = 1;
          sub_48B2C(qword_5A8C0, v42, v48, &v73);
          LOBYTE(v49) = 1;
          sub_48B2C(qword_5A8C0, v44, v49, &v73);
          KeReleaseMutex(&Mutex, 0);
          v50 = HIDWORD(v72);
          v83 = v42;
          v84 = 2;
          sub_1F4D4(SHIDWORD(v72), (__int64)&v83);
          v85 = v44;
          v86 = 2;
          sub_1F4D4(v50, (__int64)&v85);
        }
        return 0i64;
      }
      v20 = v68;
    }
    v51 = v88;
    *v88 = *((_DWORD *)v15 + 105);
    if ( !*((_BYTE *)v15 + 57) )
    {
      v52 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
      {
        goto LABEL_309;
      }
      v53 = 193;
LABEL_308:
      sub_12D64(*(_QWORD *)&v52->DeviceLock.Header.Lock, v53, (__int64)&unk_57D38, *a3);
LABEL_309:
      KeReleaseMutex((PRKMUTEX)v15[1], 0);
      v21 = BugCheckParameter1;
LABEL_310:
      sub_49CF0(v16, v21);
      v31 = v74;
      if ( !v74 )
        return 0i64;
      goto LABEL_311;
    }
    sub_200FC((__int64)Src, (__int64)v15);
    if ( sub_51784(*((_QWORD *)Src + 2)) )
    {
      if ( *((_DWORD *)v15 + 107) == 3 )
      {
        v52 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
          || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
          || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
        {
LABEL_241:
          if ( *((_DWORD *)v15 + 6) == 1 )
          {
            v54 = *((_DWORD *)a3 + 5);
            if ( v54 != 1 )
            {
              *((_DWORD *)v15 + 6) = v54;
              if ( !v20 )
              {
                *((_BYTE *)v15 + 57) = 0;
                v52 = off_5A148;
                if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
                  || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
                  || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
                {
                  goto LABEL_309;
                }
                v53 = 196;
                goto LABEL_308;
              }
              v52 = off_5A148;
              if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
                && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
              {
                sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xC5u, (__int64)&unk_57D38, *a3);
                v52 = off_5A148;
              }
              v56 = 1;
              goto LABEL_266;
            }
            sub_1B9C0((__int64)v15, Src);
            v52 = off_5A148;
          }
          v56 = 0;
LABEL_266:
          if ( v52 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(v52->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
            && BYTE1(v52->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_12D64(*(_QWORD *)&v52->DeviceLock.Header.Lock, 0xC6u, (__int64)&unk_57D38, *a3);
            v52 = off_5A148;
          }
          if ( !v20 )
          {
            if ( v89 )
            {
              sub_1BC78((__int64)v15, (*((_BYTE *)Src + 120) & 0x10) == 16);
              v52 = off_5A148;
            }
            if ( v52 == (PDEVICE_OBJECT)&off_5A148
              || (BYTE4(v52->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
              || BYTE1(v52->DeviceLock.Header.WaitListHead.Blink) < 4u )
            {
              goto LABEL_309;
            }
            v53 = 199;
            goto LABEL_308;
          }
          if ( v56 )
            sub_1BEB4((__int64)v15, (__int64)Src);
          sub_26348(v16, (__int64)v15, BugCheckParameter1, (__int64)Src, *((_DWORD *)a3 + 5), v20, 1, (__int64)&v87);
          if ( (_BYTE)v87 )
          {
            v7 = off_5A148;
            if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
              || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
              || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
            {
              return 0i64;
            }
            v9 = 200;
LABEL_23:
            sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, v9, (__int64)&unk_57D38);
            return 0i64;
          }
          v57 = a3[4];
          v78[1] = (*((_BYTE *)Src + 120) & 0x10) == 16;
          Dst[0] = *a3;
          if ( v57 )
          {
            v58 = a3[5];
            if ( v58 )
            {
              v79 = v57;
              v80 = v58;
            }
          }
          v59 = *((_QWORD *)Src + 2);
          v78[0] = 0;
          v60 = sub_50E34(v59, &v77, v78);
          v77 += (unsigned __int16)v72;
          v78[0] -= (unsigned __int16)v72;
          if ( v60 )
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
            {
              sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xC9u, (__int64)&unk_57D38);
            }
            KeReleaseMutex((PRKMUTEX)v15[1], 0);
            v3 = 12;
            goto LABEL_287;
          }
          v61 = sub_1F628(*((_DWORD *)a3 + 5), (__int64)Dst, (__int64)Src, (__int64)v15);
          if ( v61
            && off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            LODWORD(Timeoutc) = v61;
            sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xCAu, (__int64)&unk_57D38, *v15, Timeoutc);
          }
          if ( v89 )
            sub_1C040((__int64)v15, (__int64)Src);
          if ( *((_DWORD *)v15 + 6) == 10 )
            *((_DWORD *)v15 + 6) = 1;
          *v51 = *((_DWORD *)v15 + 105);
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
          {
            sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xCBu, (__int64)&unk_57D38);
          }
          KeReleaseMutex((PRKMUTEX)v15[1], 0);
          v31 = BugCheckParameter1;
LABEL_311:
          v32 = v16;
          goto LABEL_312;
        }
        sub_13EE0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xC2u, (__int64)&unk_57D38, *(_QWORD *)Src, *v15);
      }
      else
      {
        sub_1AD48((__int64)Src, v15);
      }
    }
    else
    {
      sub_1AF88(Src, v15, &v89, &v69, (__int64)&v72);
      if ( v69 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EE0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xC3u, (__int64)&unk_57D38, *(_QWORD *)Src, *v15);
        }
        v67 = v20;
        v55 = BugCheckParameter1;
        sub_26348(v16, (__int64)v15, BugCheckParameter1, (__int64)Src, *((_DWORD *)a3 + 5), v67, 1, (__int64)&v87);
        if ( (_BYTE)v87 )
          return 0i64;
        KeReleaseMutex((PRKMUTEX)v15[1], 0);
        v31 = v55;
        goto LABEL_311;
      }
    }
    v52 = off_5A148;
    goto LABEL_241;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x9Eu, (__int64)&unk_57D38);
  }
  return 6i64;
}
// 1CBF1: variable 'Timeouta' is possibly undefined
// 1CDFD: variable 'v23' is possibly undefined
// 1D251: variable 'v34' is possibly undefined
// 1D28C: variable 'Timeoutb' is possibly undefined
// 1D52B: variable 'Timeout' is possibly undefined
// 1D52B: variable 'v66' is possibly undefined
// 1D766: variable 'v48' is possibly undefined
// 1D77D: variable 'v49' is possibly undefined
// 1DC3C: variable 'Timeoutc' is possibly undefined
// 567C0: using guessed type __int64 qword_567C0[2];
// 5A66C: using guessed type char byte_5A66C;
// 5A954: using guessed type int dword_5A954;

//----- (000000000001DD74) ----------------------------------------------------
char __fastcall sub_1DD74(_QWORD *a1, char a2)
{
  char v4; // di
  PDEVICE_OBJECT v5; // rcx
  int v6; // eax
  const char *v7; // rax
  bool v8; // zf
  const char *v9; // rbx
  const char *v10; // rax
  const char *v11; // rbx
  const char *v12; // rax

  v4 = 1;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xCCu, (__int64)&unk_57D38);
    v5 = off_5A148;
  }
  v6 = *((_DWORD *)a1 + 83);
  if ( !a2 )
  {
    if ( v6 != 1 )
    {
      if ( v5 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) < 3u )
      {
        goto LABEL_33;
      }
      v7 = sub_4A83C(v6);
      sub_182DC(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xCDu, (__int64)&unk_57D38, *a1, v7);
LABEL_32:
      v5 = off_5A148;
LABEL_33:
      v4 = 0;
      goto LABEL_34;
    }
    goto LABEL_24;
  }
  if ( v6 == 4 || v6 == 5 || v6 == 9 || v6 == 7 )
  {
    v8 = *((_DWORD *)a1 + 82) == 6;
  }
  else
  {
    if ( v6 != 3 && v6 != 2 )
      goto LABEL_24;
    v8 = *((_DWORD *)a1 + 82) == 17;
  }
  if ( !v8 )
  {
    v4 = 0;
    _InterlockedAdd64(&qword_5A820, 1ui64);
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v4;
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      v9 = sub_4A83C(*((_DWORD *)a1 + 83));
      v10 = sub_4A7C4(*((_DWORD *)a1 + 82));
      sub_1835C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xCEu, (__int64)&unk_57D38, *a1, v10, v9);
      v5 = off_5A148;
    }
    goto LABEL_34;
  }
LABEL_24:
  if ( a1[6] && v6 != 4 && v6 != 5 && v6 != 2 )
  {
    if ( v5 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0x17u)
      || BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      goto LABEL_33;
    }
    v11 = sub_4A83C(v6);
    v12 = sub_4A7C4(*((_DWORD *)a1 + 82));
    sub_1835C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xCFu, (__int64)&unk_57D38, *a1, v12, v11);
    goto LABEL_32;
  }
LABEL_34:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xD0u, (__int64)&unk_57D38);
  }
  return v4;
}
// 5A820: using guessed type __int64 qword_5A820;

//----- (000000000001DFC0) ----------------------------------------------------
__int64 __fastcall sub_1DFC0(unsigned __int64 **a1, ULONG_PTR **a2, ULONG_PTR *a3, _QWORD *a4, __int64 a5, _DWORD *a6)
{
  unsigned int v10; // ebx
  __int64 v11; // rax
  unsigned __int64 *v12; // rcx
  ULONG_PTR v13; // rdx
  ULONG_PTR v14; // rax
  int v15; // er11
  __int64 v16; // rcx
  __int64 v17; // rax
  unsigned int v18; // eax
  unsigned __int64 *v19; // rcx
  PLARGE_INTEGER Timeout; // [rsp+20h] [rbp-78h]
  PLARGE_INTEGER Timeouta; // [rsp+20h] [rbp-78h]
  __int64 v23[2]; // [rsp+40h] [rbp-58h] BYREF
  __int64 v24; // [rsp+50h] [rbp-48h] BYREF
  int v25[2]; // [rsp+58h] [rbp-40h] BYREF
  __int64 v26; // [rsp+61h] [rbp-37h]
  __int64 v27; // [rsp+69h] [rbp-2Fh]

  LODWORD(v23[0]) = 0;
  memset((char *)v23 + 4, 0, 0x2Dui64);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 8) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xD1u, (__int64)&unk_57D38);
  }
  if ( !*a1 )
  {
    if ( sub_1FCD0() )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 8) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xD2u, (__int64)&unk_57D38, *a4);
      }
      KeReleaseMutex(&Mutex, 0);
      v10 = 10;
      goto LABEL_45;
    }
    v11 = sub_1928C(*a4, a4[1], *((_DWORD *)a4 + 4), *((_DWORD *)a4 + 5), a4[4], a4[5], 0i64, a5);
    *a1 = (unsigned __int64 *)v11;
    if ( !v11 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 8) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xD3u, (__int64)&unk_57D38, *a4);
      }
      KeReleaseMutex(&Mutex, 0);
      v10 = 3;
      goto LABEL_45;
    }
    if ( byte_5A66C )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 8) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xD4u, (__int64)&unk_57D38, *a4);
      }
      sub_488F0(qword_5A8C8, **a1, (__int64)*a1, a2);
      v12 = *a1;
      v13 = qword_5A8C8;
      *((_BYTE *)v12 + 56) = 1;
      *a3 = v13;
      *((_BYTE *)v12 + 57) = 0;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 8) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xD5u, (__int64)&unk_57D38, *a4);
      }
      sub_488F0(qword_5A8C0, **a1, (__int64)*a1, a2);
      v12 = *a1;
      v14 = qword_5A8C0;
      *((_BYTE *)*a1 + 56) = 1;
      *a3 = v14;
    }
    sub_275B8((__int64)v12);
    if ( v15 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 8) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        LODWORD(Timeouta) = v15;
        sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xD6u, (__int64)&unk_57D38, **a1, Timeouta);
      }
      sub_196DC((__int64)*a1);
      KeReleaseMutex(&Mutex, 0);
      v10 = 5;
      goto LABEL_45;
    }
    KeReleaseMutex(&Mutex, 0);
    KeWaitForSingleObject((PVOID)(*a1)[1], Executive, 0, 0, 0i64);
  }
  sub_200FC(a5, (__int64)*a1);
  v16 = a4[4];
  v25[1] = (*(_BYTE *)(a5 + 120) & 0x10) == 16;
  v23[0] = *a4;
  if ( v16 )
  {
    v17 = a4[5];
    if ( v17 )
    {
      v25[0] = 0;
      v26 = v16;
      v27 = v17;
    }
  }
  sub_50E34(*(_QWORD *)(a5 + 16), &v24, v25);
  v18 = sub_1F628(*((_DWORD *)a4 + 5), (__int64)v23, a5, (__int64)*a1);
  v10 = v18;
  if ( v18
    && off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 8) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    LODWORD(Timeout) = v18;
    sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xD7u, (__int64)&unk_57D38, **a1, Timeout);
  }
  v19 = *a1;
  *a6 = *((_DWORD *)*a1 + 105);
  KeReleaseMutex((PRKMUTEX)v19[1], 0);
  sub_49CF0(*a3, (ULONG_PTR)*a2);
LABEL_45:
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 8) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xD8u, (__int64)&unk_57D38);
  }
  return v10;
}
// 1E216: variable 'v15' is possibly undefined
// 1E254: variable 'Timeouta' is possibly undefined
// 1E354: variable 'Timeout' is possibly undefined
// 5A66C: using guessed type char byte_5A66C;

//----- (000000000001E3E4) ----------------------------------------------------
__int64 __fastcall sub_1E3E4(__int64 a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  _DWORD *v5; // rax
  __int64 v6; // rsi
  int v8; // er15
  unsigned int v9; // edx
  PVOID v10; // rax
  unsigned __int16 *v11; // rbx
  _BYTE *v12; // rdi
  __int16 v13; // ax
  int v14; // eax
  _DWORD *v15; // rax
  __int64 v16; // rdi
  int v17; // eax
  unsigned int v18; // edx
  PVOID v19; // rax
  unsigned __int16 *v20; // rbx
  _WORD *v21; // rsi
  __int64 v22; // rcx
  __int64 v23; // rcx
  __int16 v24; // dx
  __int16 v25; // ax
  int v26; // eax
  int v27; // ebx
  PDEVICE_OBJECT v28; // rcx
  char v29[4]; // [rsp+30h] [rbp-88h] BYREF
  unsigned __int16 v30; // [rsp+34h] [rbp-84h] BYREF
  unsigned __int16 v31[2]; // [rsp+38h] [rbp-80h] BYREF
  unsigned __int16 v32; // [rsp+3Ch] [rbp-7Ch] BYREF
  unsigned int v33; // [rsp+40h] [rbp-78h] BYREF
  unsigned int v34; // [rsp+44h] [rbp-74h] BYREF
  int v35; // [rsp+48h] [rbp-70h] BYREF
  int v36; // [rsp+50h] [rbp-68h] BYREF
  __int16 v37; // [rsp+54h] [rbp-64h]
  int v38; // [rsp+60h] [rbp-58h] BYREF
  __int16 v39; // [rsp+64h] [rbp-54h]
  __int64 v40; // [rsp+70h] [rbp-48h] BYREF
  int v41; // [rsp+78h] [rbp-40h] BYREF
  __int16 v42; // [rsp+7Ch] [rbp-3Ch]
  int v43; // [rsp+80h] [rbp-38h] BYREF
  __int16 v44; // [rsp+84h] [rbp-34h]

  v35 = 0;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xD9u, (__int64)&unk_57D38);
    v4 = off_5A148;
  }
  if ( a1 && a2 )
  {
    sub_50E34(*(_QWORD *)(a1 + 16), &v40, &v30);
    v5 = sub_3C910((__int64)qword_5A8A8);
    v6 = (__int64)v5;
    if ( !v5 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xDBu, (__int64)&unk_57D38);
      }
      return 3i64;
    }
    *(_QWORD *)(v5 + 55) = 0i64;
    v5[32] = 2;
    v5[93] = *(_DWORD *)(a1 + 372);
    v5[30] = 0;
    if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
      v5[30] = 16;
    *(_QWORD *)v5 = _InterlockedIncrement64(&qword_5D418) | 0x8000000000000000ui64;
    v8 = v30;
    *((_QWORD *)v5 + 1) = MEMORY[0xFFFFF78000000014];
    v9 = *(_DWORD *)(a1 + 124) - v8;
    v5[31] = v9;
    v10 = sub_3C4EC(2, v9, 0x624E734Eu);
    *(_QWORD *)(v6 + 16) = v10;
    if ( !v10 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xDCu, (__int64)&unk_57D38);
      }
      sub_3C978((__int64)qword_5A8A8, v6);
      return 3i64;
    }
    memmove(v10, *(const void **)(a1 + 16), *(unsigned int *)(v6 + 124));
    v11 = (unsigned __int16 *)sub_4AE28(*(_QWORD *)(v6 + 16), 1);
    v12 = sub_4AE28(*(_QWORD *)(v6 + 16), 3);
    sub_4E5C0((__int64)v11, *(_WORD *)(v6 + 124) - 14);
    v13 = sub_50390(v11);
    sub_4E8A4((__int64)v11, v13);
    sub_4C138((__int64)v11, &v33);
    sub_4C1E8((__int64)v11, &v34);
    sub_4D4A8((__int64)v12, v29);
    v29[0] = 4;
    sub_4FE4C((__int64)v12, 4u);
    sub_4FEF8((__int64)v12, 0);
    sub_26644(v6, (__int64)v12, a2);
    *(_DWORD *)(v6 + 120) |= 0x40u;
    *(_QWORD *)(v6 + 220) = 0i64;
    sub_3068C((_QWORD *)v6);
    sub_4B3A0(*(_QWORD *)(v6 + 16), *(_DWORD *)(v6 + 124), (__int64 *)(v6 + 24));
    sub_50870(v6 + 24, 1, 0i64);
    v14 = sub_4535C(0x2013015u);
    LODWORD(v11) = sub_40A2C(40008, (const void *)v6, 0x190u, v14, &v35);
    sub_308B0((_QWORD *)v6);
    sub_3C570(*(PVOID *)(v6 + 16), 0x624E734Eu);
    sub_3C978((__int64)qword_5A8A8, v6);
    if ( (_DWORD)v11
      && off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xDDu, (__int64)&unk_57D38);
    }
    v15 = sub_3C910((__int64)qword_5A8A8);
    v16 = (__int64)v15;
    if ( !v15 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xDEu, (__int64)&unk_57D38);
      }
      return 3i64;
    }
    *(_QWORD *)(v15 + 55) = 0i64;
    v15[32] = 2;
    v17 = *(_DWORD *)(a1 + 372);
    *(_DWORD *)(v16 + 120) = 0;
    *(_DWORD *)(v16 + 372) = v17;
    if ( (*(_BYTE *)(a1 + 120) & 0x10) == 0 )
      *(_DWORD *)(v16 + 120) = 16;
    *(_QWORD *)v16 = _InterlockedIncrement64(&qword_5D418) | 0x8000000000000000ui64;
    *(_QWORD *)(v16 + 8) = MEMORY[0xFFFFF78000000014];
    v18 = *(_DWORD *)(a1 + 124) - v8;
    *(_DWORD *)(v16 + 124) = v18;
    v19 = sub_3C4EC(2, v18, 0x624E734Eu);
    *(_QWORD *)(v16 + 16) = v19;
    if ( !v19 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xDFu, (__int64)&unk_57D38);
      }
      sub_3C978((__int64)qword_5A8A8, v16);
      return 3i64;
    }
    memmove(v19, *(const void **)(a1 + 16), *(unsigned int *)(v16 + 124));
    v20 = (unsigned __int16 *)sub_4AE28(*(_QWORD *)(v16 + 16), 1);
    v21 = sub_4AE28(*(_QWORD *)(v16 + 16), 3);
    sub_4BAA4(*(_QWORD *)(v16 + 16), (__int64)&v41);
    sub_4BB5C(*(_QWORD *)(v16 + 16), (__int64)&v43);
    v36 = v43;
    v22 = *(_QWORD *)(v16 + 16);
    v37 = v44;
    sub_4E3DC(v22, (unsigned __int8 *)&v36);
    v38 = v41;
    v23 = *(_QWORD *)(v16 + 16);
    v39 = v42;
    sub_4E4D0(v23, (unsigned __int8 *)&v38);
    sub_4E5C0((__int64)v20, *(_WORD *)(v16 + 124) - 14);
    sub_4E800((__int64)v20);
    sub_4C138((__int64)v20, &v33);
    sub_4C1E8((__int64)v20, &v34);
    sub_4E968((__int64)v20, v34);
    sub_4EA38((__int64)v20, v33);
    if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
      v24 = *(_WORD *)(a2 + 640);
    else
      v24 = *(_WORD *)(a2 + 642);
    sub_4E684((__int64)v20, v24 + 1);
    v25 = sub_50390(v20);
    sub_4E8A4((__int64)v20, v25);
    sub_4D4A8((__int64)v21, v29);
    v29[0] = 4;
    sub_4FE4C((__int64)v21, 4u);
    sub_4FEF8((__int64)v21, 0);
    sub_4CFEC(v21, &v32);
    sub_4D0B0((__int64)v21, v31);
    sub_4FA5C(v21, v31[0]);
    sub_4FB20((__int64)v21, v32);
    sub_26644(v16, (__int64)v21, a2);
    *(_DWORD *)(v16 + 120) |= 0x40u;
    *(_QWORD *)(v16 + 220) = 0i64;
    sub_3068C((_QWORD *)v16);
    sub_4B3A0(*(_QWORD *)(v16 + 16), *(_DWORD *)(v16 + 124), (__int64 *)(v16 + 24));
    sub_50870(v16 + 24, 1, 0i64);
    v26 = sub_4535C(0x2013015u);
    v27 = sub_40A2C(40008, (const void *)v16, 0x190u, v26, &v35);
    sub_308B0((_QWORD *)v16);
    sub_3C570(*(PVOID *)(v16 + 16), 0x624E734Eu);
    sub_3C978((__int64)qword_5A8A8, v16);
    if ( v27 )
    {
      v28 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
LABEL_49:
        if ( v28 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v28->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v28->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v28->DeviceLock.Header.Lock, 0xE1u, (__int64)&unk_57D38);
        }
        return 0i64;
      }
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xE0u, (__int64)&unk_57D38);
    }
    v28 = off_5A148;
    goto LABEL_49;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EE0(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0xDAu, (__int64)&unk_57D38, a1, a2);
  }
  return 4i64;
}
// 5D418: using guessed type __int64 qword_5D418;

//----- (000000000001EBA4) ----------------------------------------------------
__int64 __fastcall sub_1EBA4(__int64 a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  _DWORD *v5; // rax
  __int64 v6; // rsi
  int v8; // eax
  int v9; // er15
  unsigned int v10; // edx
  PVOID v11; // rax
  _BYTE *v12; // rbx
  _BYTE *v13; // rdi
  unsigned __int16 v14; // ax
  unsigned int v15; // edx
  __int64 v16; // rcx
  int v17; // eax
  int v18; // ebx
  _DWORD *v19; // rax
  __int64 v20; // rsi
  unsigned int v21; // edx
  PVOID v22; // rax
  _BYTE *v23; // rbx
  _WORD *v24; // rdi
  __int64 v25; // rcx
  __int64 v26; // rcx
  unsigned __int16 v27; // ax
  int v28; // eax
  int v29; // ebx
  PDEVICE_OBJECT v30; // rcx
  char v31[4]; // [rsp+30h] [rbp-D8h] BYREF
  int v32; // [rsp+34h] [rbp-D4h] BYREF
  unsigned __int16 v33; // [rsp+38h] [rbp-D0h]
  unsigned __int16 v34[2]; // [rsp+40h] [rbp-C8h] BYREF
  unsigned __int16 v35; // [rsp+44h] [rbp-C4h] BYREF
  __int16 v36[8]; // [rsp+48h] [rbp-C0h] BYREF
  int v37; // [rsp+58h] [rbp-B0h] BYREF
  int v38; // [rsp+60h] [rbp-A8h] BYREF
  __int16 v39; // [rsp+64h] [rbp-A4h]
  int v40; // [rsp+70h] [rbp-98h] BYREF
  __int16 v41; // [rsp+74h] [rbp-94h]
  __int64 v42; // [rsp+80h] [rbp-88h]
  __int64 v43; // [rsp+88h] [rbp-80h] BYREF
  int v44; // [rsp+90h] [rbp-78h] BYREF
  __int16 v45; // [rsp+94h] [rbp-74h]
  int v46; // [rsp+98h] [rbp-70h] BYREF
  __int16 v47; // [rsp+9Ch] [rbp-6Ch]
  __m128i v48; // [rsp+A0h] [rbp-68h] BYREF
  __m128i v49; // [rsp+B0h] [rbp-58h] BYREF

  v37 = 0;
  v32 = 0;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xE2u, (__int64)&unk_57D38);
    v4 = off_5A148;
  }
  if ( a1 && a2 )
  {
    sub_50E34(*(_QWORD *)(a1 + 16), &v43, v36);
    v5 = sub_3C910((__int64)qword_5A8A8);
    v6 = (__int64)v5;
    if ( !v5 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xE4u, (__int64)&unk_57D38);
      }
      return 3i64;
    }
    *(_QWORD *)(v5 + 55) = 0i64;
    v5[32] = 2;
    v8 = *(_DWORD *)(a1 + 372);
    *(_DWORD *)(v6 + 120) = 0;
    *(_DWORD *)(v6 + 372) = v8;
    if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
      *(_DWORD *)(v6 + 120) = 16;
    *(_QWORD *)v6 = _InterlockedIncrement64(&qword_5D418) | 0x8000000000000000ui64;
    v9 = (unsigned __int16)v36[0];
    *(_QWORD *)(v6 + 8) = MEMORY[0xFFFFF78000000014];
    v10 = *(_DWORD *)(a1 + 124) - v9;
    *(_DWORD *)(v6 + 124) = v10;
    v11 = sub_3C4EC(2, v10, 0x624E734Eu);
    *(_QWORD *)(v6 + 16) = v11;
    if ( !v11 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xE5u, (__int64)&unk_57D38);
      }
      sub_3C978((__int64)qword_5A8A8, v6);
      return 3i64;
    }
    memmove(v11, *(const void **)(a1 + 16), *(unsigned int *)(v6 + 124));
    v12 = sub_4AE28(*(_QWORD *)(v6 + 16), 2);
    v13 = sub_4AE28(*(_QWORD *)(v6 + 16), 3);
    sub_4F544(*(_QWORD *)(a1 + 48), &v32);
    v14 = v32 + *(_WORD *)(a1 + 104) - *(_WORD *)(a1 + 108);
    v12[6] = 6;
    v36[4] = v14;
    *((_WORD *)v12 + 2) = _byteswap_ushort(v14);
    sub_4C970((__int64)v12, &v49);
    sub_4CA24((__int64)v12, &v48);
    sub_4D4A8((__int64)v13, v31);
    v31[0] = 4;
    sub_4FE4C((__int64)v13, 4u);
    sub_4FEF8((__int64)v13, 0);
    sub_26644(v6, (__int64)v13, a2);
    *(_DWORD *)(v6 + 120) |= 0x40u;
    *(_QWORD *)(v6 + 220) = 0i64;
    sub_3068C((_QWORD *)v6);
    v15 = *(_DWORD *)(v6 + 124);
    v16 = *(_QWORD *)(v6 + 16);
    v42 = v6 + 24;
    sub_4B3A0(v16, v15, (__int64 *)(v6 + 24));
    sub_50870(v6 + 24, 1, 0i64);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xE6u, (__int64)&unk_57D38);
    }
    v17 = sub_4535C(0x2013015u);
    v18 = sub_40A2C(40008, (const void *)v6, 0x190u, v17, &v37);
    sub_308B0((_QWORD *)v6);
    sub_3C570(*(PVOID *)(v6 + 16), 0x624E734Eu);
    sub_3C978((__int64)qword_5A8A8, v6);
    if ( v18
      && off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xE7u, (__int64)&unk_57D38);
    }
    v19 = sub_3C910((__int64)qword_5A8A8);
    v20 = (__int64)v19;
    if ( !v19 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xE8u, (__int64)&unk_57D38);
      }
      return 3i64;
    }
    *(_QWORD *)(v19 + 55) = 0i64;
    v19[32] = 2;
    v19[93] = *(_DWORD *)(a1 + 372);
    v19[30] = 0;
    if ( (*(_BYTE *)(a1 + 120) & 0x10) == 0 )
      v19[30] = 16;
    *(_QWORD *)v19 = _InterlockedIncrement64(&qword_5D418) | 0x8000000000000000ui64;
    *((_QWORD *)v19 + 1) = MEMORY[0xFFFFF78000000014];
    v21 = *(_DWORD *)(a1 + 124) - v9;
    v19[31] = v21;
    v22 = sub_3C4EC(2, v21, 0x624E734Eu);
    *(_QWORD *)(v20 + 16) = v22;
    if ( !v22 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xE9u, (__int64)&unk_57D38);
      }
      sub_3C978((__int64)qword_5A8A8, v20);
      return 3i64;
    }
    memmove(v22, *(const void **)(a1 + 16), *(unsigned int *)(v20 + 124));
    v23 = sub_4AE28(*(_QWORD *)(v20 + 16), 2);
    v24 = sub_4AE28(*(_QWORD *)(v20 + 16), 3);
    sub_4BAA4(*(_QWORD *)(v20 + 16), (__int64)&v46);
    sub_4BB5C(*(_QWORD *)(v20 + 16), (__int64)&v44);
    v40 = v44;
    v25 = *(_QWORD *)(v20 + 16);
    v41 = v45;
    sub_4E3DC(v25, (unsigned __int8 *)&v40);
    v38 = v46;
    v26 = *(_QWORD *)(v20 + 16);
    v39 = v47;
    sub_4E4D0(v26, (unsigned __int8 *)&v38);
    sub_4F544(*(_QWORD *)(a1 + 48), &v32);
    v27 = v32 + *(_WORD *)(a1 + 104) - *(_WORD *)(a1 + 108);
    v23[6] = 6;
    v33 = v27;
    *((_WORD *)v23 + 2) = _byteswap_ushort(v27);
    sub_4C970((__int64)v23, &v49);
    sub_4CA24((__int64)v23, &v48);
    *(__m128i *)(v23 + 8) = _mm_loadu_si128(&v48);
    *(__m128i *)(v23 + 24) = _mm_loadu_si128(&v49);
    sub_4D4A8((__int64)v24, v31);
    v31[0] = 4;
    sub_4FE4C((__int64)v24, 4u);
    sub_4FEF8((__int64)v24, 0);
    sub_4CFEC(v24, &v35);
    sub_4D0B0((__int64)v24, v34);
    sub_4FA5C(v24, v34[0]);
    sub_4FB20((__int64)v24, v35);
    sub_26644(v20, (__int64)v24, a2);
    *(_DWORD *)(v20 + 120) |= 0x40u;
    *(_QWORD *)(v20 + 220) = 0i64;
    sub_3068C((_QWORD *)v20);
    sub_4B3A0(*(_QWORD *)(v20 + 16), *(_DWORD *)(v20 + 124), (__int64 *)(v20 + 24));
    sub_50870(v42, 1, 0i64);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xEAu, (__int64)&unk_57D38);
    }
    v28 = sub_4535C(0x2013015u);
    v29 = sub_40A2C(40008, (const void *)v20, 0x190u, v28, &v37);
    sub_308B0((_QWORD *)v20);
    sub_3C570(*(PVOID *)(v20 + 16), 0x624E734Eu);
    sub_3C978((__int64)qword_5A8A8, v20);
    if ( v29 )
    {
      v30 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
LABEL_54:
        if ( v30 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v30->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v30->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v30->DeviceLock.Header.Lock, 0xECu, (__int64)&unk_57D38);
        }
        return 0i64;
      }
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xEBu, (__int64)&unk_57D38);
    }
    v30 = off_5A148;
    goto LABEL_54;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EE0(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0xE3u, (__int64)&unk_57D38, a1, a2);
  }
  return 4i64;
}
// 5D418: using guessed type __int64 qword_5D418;

//----- (000000000001F3EC) ----------------------------------------------------
__int64 __fastcall sub_1F3EC(__int64 a1, int a2)
{
  unsigned int v4; // ebx
  int v5; // eax
  int v6; // eax

  v4 = 3;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xEDu, (__int64)&unk_57D38);
  }
  if ( a2 == 1 )
    *(_DWORD *)(a1 + 428) &= 0xFFFFFFFE;
  else
    *(_DWORD *)(a1 + 428) &= 0xFFFFFFFD;
  v5 = *(_DWORD *)(a1 + 428);
  if ( v5 )
  {
    v6 = v5 - 1;
    if ( v6 )
    {
      if ( v6 == 1 )
        v4 = 0;
    }
    else
    {
      v4 = 1;
    }
  }
  else
  {
    v4 = 2;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xEEu, (__int64)&unk_57D38);
  }
  return v4;
}

//----- (000000000001F4D4) ----------------------------------------------------
__int64 __fastcall sub_1F4D4(int a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  int v5; // eax
  unsigned int v6; // ebx
  __int64 v8; // [rsp+20h] [rbp-28h] BYREF
  __int64 v9; // [rsp+28h] [rbp-20h]
  __int64 v10; // [rsp+30h] [rbp-18h]

  v9 = 0i64;
  v10 = 0i64;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xEFu, (__int64)&unk_57D38);
    v4 = off_5A148;
  }
  v10 = 0i64;
  v8 = a2;
  LODWORD(v9) = 56;
  if ( a1 == 1 || !a1 )
  {
    if ( v4 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
LABEL_18:
      if ( v4 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0xF2u, (__int64)&unk_57D38);
      }
      return 0i64;
    }
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0xF1u, (__int64)&unk_57D38);
LABEL_17:
    v4 = off_5A148;
    goto LABEL_18;
  }
  v5 = sub_17324(258, (__int64)&v8, a1);
  v6 = v5;
  if ( !v5 )
    goto LABEL_17;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xF0u, (__int64)&unk_57D38, v5);
  }
  return v6;
}

//----- (000000000001F628) ----------------------------------------------------
__int64 __fastcall sub_1F628(int a1, __int64 a2, __int64 a3, __int64 a4)
{
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  int v10; // eax
  unsigned int v11; // ebx
  __int64 v13; // [rsp+30h] [rbp-38h] BYREF
  __int64 v14; // [rsp+38h] [rbp-30h]
  __int64 v15; // [rsp+40h] [rbp-28h]

  v14 = 0i64;
  v15 = 0i64;
  v8 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xF3u, (__int64)&unk_57D38);
    v8 = off_5A148;
  }
  v13 = a2;
  LODWORD(v14) = 49;
  if ( *(_BYTE *)(a4 + 58) )
    a3 = 0i64;
  v15 = a3;
  if ( !a1 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v8->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      return 0i64;
    }
    v9 = 244;
LABEL_28:
    sub_11088(*(_QWORD *)&v8->DeviceLock.Header.Lock, v9, (__int64)&unk_57D38);
    return 0i64;
  }
  v10 = sub_17324(259, (__int64)&v13, a1);
  v11 = v10;
  if ( !v10 )
  {
    if ( (*(_BYTE *)(a2 + 32) & 4) != 0 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xF6u, (__int64)&unk_57D38, *(_QWORD *)a4, a1);
      }
      *(_DWORD *)(a4 + 420) = 4;
    }
    v8 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      return 0i64;
    }
    v9 = 247;
    goto LABEL_28;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x13u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xF5u, (__int64)&unk_57D38, v10);
  }
  return v11;
}

//----- (000000000001F7D8) ----------------------------------------------------
__int64 __fastcall sub_1F7D8(int a1, __int64 *a2)
{
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  unsigned int v6; // eax

  v4 = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xF8u, (__int64)&unk_57D38);
      v5 = off_5A148;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xF9u, (__int64)&unk_57D38, a1);
      v5 = off_5A148;
    }
  }
  if ( a1 > 518 )
  {
    switch ( a1 )
    {
      case 519:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xFEu, (__int64)&unk_57D38, 519);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_25844(*a2);
          goto LABEL_46;
        }
        goto LABEL_94;
      case 520:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xFFu, (__int64)&unk_57D38, 520);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          sub_26174(*a2);
          goto LABEL_47;
        }
        goto LABEL_94;
      case 521:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x100u, (__int64)&unk_57D38, 521);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_22210((unsigned __int64 *)*a2);
          goto LABEL_46;
        }
        goto LABEL_94;
    }
    if ( a1 != 522 )
    {
      if ( a1 == 523 )
      {
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x101u, (__int64)&unk_57D38, 523);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_22558((unsigned __int64 *)*a2);
          goto LABEL_46;
        }
        goto LABEL_94;
      }
LABEL_59:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x105u, (__int64)&unk_57D38, a1);
        v5 = off_5A148;
      }
      v4 = 277;
      goto LABEL_95;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x104u, (__int64)&unk_57D38, 522);
      v5 = off_5A148;
    }
    if ( *a2 )
    {
      v6 = sub_22984(*a2);
      goto LABEL_46;
    }
  }
  else
  {
    switch ( a1 )
    {
      case 518:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xFDu, (__int64)&unk_57D38, 518);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_2209C((unsigned __int64 *)*a2);
          goto LABEL_46;
        }
        goto LABEL_94;
      case 513:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xFAu, (__int64)&unk_57D38, 513);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_20FEC(*(void **)*a2, *(unsigned int *)(*a2 + 8), *(_QWORD *)(*a2 + 16));
          goto LABEL_46;
        }
        break;
      case 514:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x102u, (__int64)&unk_57D38, 514);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_22794(*a2);
          goto LABEL_46;
        }
        break;
      case 515:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x103u, (__int64)&unk_57D38, 515);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_22E04(*a2);
          goto LABEL_46;
        }
        break;
      case 516:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xFBu, (__int64)&unk_57D38, 516);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_212D0((_QWORD *)*a2);
          goto LABEL_46;
        }
        break;
      case 517:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xFCu, (__int64)&unk_57D38, 517);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_21920((unsigned __int64 *)*a2);
LABEL_46:
          v4 = v6;
LABEL_47:
          v5 = off_5A148;
          break;
        }
LABEL_94:
        v4 = 6;
        break;
      default:
        goto LABEL_59;
    }
  }
LABEL_95:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x106u, (__int64)&unk_57D38);
  }
  return v4;
}

//----- (000000000001FCD0) ----------------------------------------------------
char sub_1FCD0()
{
  char v0; // bl
  PDEVICE_OBJECT v1; // rcx
  int v2; // edi
  int v3; // esi
  unsigned int v4; // esi
  PDEVICE_OBJECT v5; // rcx
  int v7; // [rsp+40h] [rbp+8h] BYREF

  v0 = 0;
  v1 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x107u, (__int64)&unk_57D38);
    v1 = off_5A148;
  }
  v2 = 0;
  v7 = 0;
  if ( v1 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v1->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v1->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v1->DeviceLock.Header.Lock, 0x10Bu, (__int64)&unk_57D38);
  }
  v3 = sub_487F8(qword_5A8C0, &v7);
  if ( v7 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x10Cu, (__int64)&unk_57D38, v7);
    }
    v2 = 1;
  }
  v4 = sub_487F8(qword_5A8C8, &v7) + 2 * v3;
  if ( v7 )
  {
    v5 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x10Du, (__int64)&unk_57D38, v7);
      v5 = off_5A148;
    }
    v2 = 1;
  }
  else
  {
    v5 = off_5A148;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x10Eu, (__int64)&unk_57D38, v4);
      v5 = off_5A148;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x10Fu, (__int64)&unk_57D38);
      v5 = off_5A148;
    }
  }
  if ( v4 )
  {
    if ( v4 >= (unsigned int)sub_4535C(0x2013006u) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x109u, (__int64)&unk_57D38, v4);
      }
      _InterlockedAdd(&dword_5A770, 1u);
      v0 = 1;
    }
    goto LABEL_41;
  }
  if ( v5 == (PDEVICE_OBJECT)&off_5A148 )
    return v0;
  if ( (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x108u, (__int64)&unk_57D38, v2);
LABEL_41:
    v5 = off_5A148;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x10Au, (__int64)&unk_57D38);
  }
  return v0;
}
// 5A770: using guessed type int dword_5A770;

//----- (000000000001FF60) ----------------------------------------------------
__int64 __fastcall sub_1FF60(_QWORD **a1)
{
  PDEVICE_OBJECT v2; // rcx
  _QWORD *v3; // rcx
  _QWORD *v4; // rax

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x110u, (__int64)&unk_57D38);
    v2 = off_5A148;
  }
  if ( *a1 != a1 )
  {
    do
    {
      v3 = *a1;
      v4 = (_QWORD *)**a1;
      *a1 = v4;
      v4[1] = a1;
      sub_20018((__int64)v3);
    }
    while ( *a1 != a1 );
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x111u, (__int64)&unk_57D38);
  }
  return 0i64;
}

//----- (0000000000020018) ----------------------------------------------------
void __fastcall sub_20018(__int64 a1)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x112u, (__int64)&unk_57D38);
  }
  sub_3C570(*(PVOID *)(*(_QWORD *)(a1 + 16) + 16i64), 0x50535453u);
  sub_3C978((__int64)qword_5A8A8, *(_QWORD *)(a1 + 16));
  sub_3C978((__int64)qword_5A8B0, a1);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x113u, (__int64)&unk_57D38);
  }
}

//----- (00000000000200FC) ----------------------------------------------------
__int64 __fastcall sub_200FC(__int64 a1, __int64 a2)
{
  _BYTE *v4; // rax
  __int16 v6; // [rsp+30h] [rbp+8h] BYREF

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x114u, (__int64)&unk_57D38);
  }
  if ( *(_QWORD *)(a1 + 40) )
  {
    v4 = sub_4AE28(*(_QWORD *)(a1 + 16), 1);
    if ( !v4 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x115u, (__int64)&unk_57D38);
      }
      return 5i64;
    }
    sub_4BEF8((__int64)v4, &v6);
    if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
      *(_WORD *)(a2 + 642) = v6;
    else
      *(_WORD *)(a2 + 640) = v6;
  }
  else
  {
    *(_WORD *)(a2 + 640) = 0;
    *(_WORD *)(a2 + 642) = 0;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x116u, (__int64)&unk_57D38);
  }
  return 0i64;
}

//----- (0000000000020238) ----------------------------------------------------
__int64 __fastcall sub_20238(__int64 a1)
{
  unsigned int v1; // esi
  int v3; // eax
  __int64 v4; // rbx
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx
  __int64 v7; // r8
  int v8; // eax
  int v9; // eax
  __int64 v10; // rax
  int v11; // edi
  int v12; // edi
  __int64 v14; // [rsp+28h] [rbp-80h]
  __int64 v15; // [rsp+30h] [rbp-78h]
  __int64 v16; // [rsp+40h] [rbp-68h] BYREF
  int v17; // [rsp+48h] [rbp-60h]
  __int16 v18; // [rsp+4Ch] [rbp-5Ch]
  __int16 v19; // [rsp+4Eh] [rbp-5Ah]
  __m128i v20; // [rsp+50h] [rbp-58h]
  __m128i v21; // [rsp+60h] [rbp-48h]
  int v22; // [rsp+70h] [rbp-38h]
  int v23; // [rsp+74h] [rbp-34h]
  int v24; // [rsp+B8h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+C0h] [rbp+18h] BYREF

  v1 = 0;
  BugCheckParameter1 = 0i64;
  v24 = 0;
  LODWORD(v16) = 0;
  memset((char *)&v16 + 4, 0, 0x34ui64);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x117u, (__int64)&unk_57D38);
  }
  sub_3D310(&stru_5D580);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    v3 = sub_487F8(qword_5A8C0, &v24);
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x118u, (__int64)&unk_57D38, v3);
  }
  v4 = sub_49870(qword_5A8C0, &BugCheckParameter1, &v24);
  if ( v4 )
  {
    do
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        LODWORD(v15) = *(_DWORD *)(v4 + 20);
        LODWORD(v14) = *(_DWORD *)(v4 + 16);
        sub_17CBC(
          *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
          0x11Au,
          (__int64)&unk_57D38,
          *(_QWORD *)v4,
          *(_QWORD *)(v4 + 392),
          v14,
          v15);
      }
      if ( sub_20DDC(v4, a1) )
      {
        v8 = *(_DWORD *)(v4 + 428);
        if ( v8 == 1 || v8 == 2 )
        {
          if ( *(_BYTE *)(v4 + 648) )
          {
            v9 = sub_217FC(v4, 1);
            v1 = v9;
            if ( v9 )
            {
              if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
                && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
              {
                sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x11Bu, (__int64)&unk_57D38, v9);
              }
            }
          }
          if ( *(_QWORD *)(v4 + 400) )
          {
            v10 = *(_QWORD *)(v4 + 392);
            v17 = 2;
            v16 = v10;
            v11 = *(_DWORD *)(v4 + 24);
            LOBYTE(v7) = 1;
            sub_48B2C(qword_5A8C0, *(_QWORD *)(v4 + 392), v7, &v24);
            if ( v24 )
            {
              if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
                && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
              {
                sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x11Cu, (__int64)&unk_57D38, v24);
              }
            }
            else
            {
              if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
                && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
              {
                sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x11Du, (__int64)&unk_57D38);
              }
              sub_1F4D4(v11, (__int64)&v16);
            }
          }
          v16 = *(_QWORD *)v4;
          v17 = 2;
          v12 = *(_DWORD *)(v4 + 24);
          v22 = *(_DWORD *)(v4 + 124);
          v18 = *(_WORD *)(v4 + 72);
          v19 = *(_WORD *)(v4 + 74);
          LOBYTE(v7) = 1;
          v20 = _mm_loadu_si128((const __m128i *)(v4 + 88));
          v21 = _mm_loadu_si128((const __m128i *)(v4 + 104));
          v23 = *(_DWORD *)(v4 + 16);
          sub_48DB0(qword_5A8C0, BugCheckParameter1, v7, &v24);
          if ( v24 )
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
            {
              sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x11Eu, (__int64)&unk_57D38, v24);
            }
          }
          else
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x11Fu, (__int64)&unk_57D38);
            }
            sub_1F4D4(v12, (__int64)&v16);
          }
        }
      }
      LOBYTE(v7) = 1;
      v4 = sub_49A3C(qword_5A8C0, &BugCheckParameter1, v7, &v24);
    }
    while ( v4 );
    v5 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v6 = 288;
      goto LABEL_53;
    }
  }
  else
  {
    v5 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v6 = 281;
LABEL_53:
      sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, v6, (__int64)&unk_57D38, v24);
      goto LABEL_54;
    }
  }
LABEL_54:
  sub_3D3DC(&stru_5D580);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x121u, (__int64)&unk_57D38);
  }
  return v1;
}
// 203B5: variable 'v14' is possibly undefined
// 203B5: variable 'v15' is possibly undefined
// 2046D: variable 'v7' is possibly undefined

//----- (00000000000206A8) ----------------------------------------------------
__int64 __fastcall sub_206A8(__int64 a1, __int64 a2)
{
  unsigned int v2; // esi
  int v5; // eax
  __int64 v6; // rbx
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  __int64 v9; // rdx
  __int64 v10; // r8
  int v11; // eax
  __int64 v12; // rax
  int v13; // edi
  int v14; // edi
  __int64 v16; // [rsp+28h] [rbp-80h]
  __int64 v17; // [rsp+30h] [rbp-78h]
  __int64 v18; // [rsp+40h] [rbp-68h] BYREF
  int v19; // [rsp+48h] [rbp-60h]
  __int16 v20; // [rsp+4Ch] [rbp-5Ch]
  __int16 v21; // [rsp+4Eh] [rbp-5Ah]
  __m128i v22; // [rsp+50h] [rbp-58h]
  __m128i v23; // [rsp+60h] [rbp-48h]
  int v24; // [rsp+70h] [rbp-38h]
  int v25; // [rsp+74h] [rbp-34h]
  int v26; // [rsp+C0h] [rbp+18h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+C8h] [rbp+20h] BYREF

  v2 = 0;
  BugCheckParameter1 = 0i64;
  v26 = 0;
  LODWORD(v18) = 0;
  memset((char *)&v18 + 4, 0, 0x34ui64);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x122u, (__int64)&unk_57D38);
  }
  sub_3D310(&stru_5D580);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    v5 = sub_487F8(qword_5A8C0, &v26);
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x123u, (__int64)&unk_57D38, v5);
  }
  v6 = sub_49870(qword_5A8C0, &BugCheckParameter1, &v26);
  if ( v6 )
  {
    do
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        LODWORD(v17) = *(_DWORD *)(v6 + 20);
        LODWORD(v16) = *(_DWORD *)(v6 + 16);
        sub_17CBC(
          *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
          0x125u,
          (__int64)&unk_57D38,
          *(_QWORD *)v6,
          *(_QWORD *)(v6 + 392),
          v16,
          v17);
      }
      v9 = a2;
      if ( *(_DWORD *)(v6 + 20) == 6 )
        v9 = a1;
      if ( sub_20DDC(v6, v9) )
      {
        if ( *(_BYTE *)(v6 + 648) )
        {
          if ( *(_DWORD *)(v6 + 20) == 6 )
          {
            v11 = sub_217FC(v6, 1);
            v2 = v11;
            if ( v11 )
            {
              if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
                && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
              {
                sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x126u, (__int64)&unk_57D38, v11);
              }
            }
          }
        }
        if ( *(_QWORD *)(v6 + 400) )
        {
          v12 = *(_QWORD *)(v6 + 392);
          v19 = 2;
          v18 = v12;
          v13 = *(_DWORD *)(v6 + 24);
          LOBYTE(v10) = 1;
          sub_48B2C(qword_5A8C0, *(_QWORD *)(v6 + 392), v10, &v26);
          if ( v26 )
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
            {
              sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x127u, (__int64)&unk_57D38, v26);
            }
          }
          else
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x128u, (__int64)&unk_57D38);
            }
            sub_1F4D4(v13, (__int64)&v18);
          }
        }
        v18 = *(_QWORD *)v6;
        v19 = 2;
        v14 = *(_DWORD *)(v6 + 24);
        v24 = *(_DWORD *)(v6 + 124);
        v20 = *(_WORD *)(v6 + 72);
        v21 = *(_WORD *)(v6 + 74);
        LOBYTE(v10) = 1;
        v22 = _mm_loadu_si128((const __m128i *)(v6 + 88));
        v23 = _mm_loadu_si128((const __m128i *)(v6 + 104));
        v25 = *(_DWORD *)(v6 + 16);
        sub_48DB0(qword_5A8C0, BugCheckParameter1, v10, &v26);
        if ( v26 )
        {
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
          {
            sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x129u, (__int64)&unk_57D38, v26);
          }
        }
        else
        {
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x12Au, (__int64)&unk_57D38);
          }
          sub_1F4D4(v14, (__int64)&v18);
        }
      }
      LOBYTE(v10) = 1;
      v6 = sub_49A3C(qword_5A8C0, &BugCheckParameter1, v10, &v26);
    }
    while ( v6 );
    v7 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v8 = 299;
      goto LABEL_54;
    }
  }
  else
  {
    v7 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v8 = 292;
LABEL_54:
      sub_13EA4(*(_QWORD *)&v7->DeviceLock.Header.Lock, v8, (__int64)&unk_57D38, v26);
      goto LABEL_55;
    }
  }
LABEL_55:
  sub_3D3DC(&stru_5D580);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x12Cu, (__int64)&unk_57D38);
  }
  return v2;
}
// 2082D: variable 'v16' is possibly undefined
// 2082D: variable 'v17' is possibly undefined
// 208DF: variable 'v10' is possibly undefined

//----- (0000000000020B20) ----------------------------------------------------
__int64 __fastcall sub_20B20(__int64 a1)
{
  int v2; // eax
  __int64 v3; // rbx
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  __int64 v6; // r8
  __int64 v8; // [rsp+28h] [rbp-30h]
  __int64 v9; // [rsp+30h] [rbp-28h]
  int v10; // [rsp+68h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+70h] [rbp+18h] BYREF

  BugCheckParameter1 = 0i64;
  v10 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x12Du, (__int64)&unk_57D38);
  }
  sub_3D310(&stru_5D540);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    v2 = sub_487F8(qword_5A8C8, &v10);
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x12Eu, (__int64)&unk_57D38, v2);
  }
  v3 = sub_49870(qword_5A8C8, &BugCheckParameter1, &v10);
  if ( v3 )
  {
    do
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xAu)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        LODWORD(v9) = *(_DWORD *)(v3 + 20);
        LODWORD(v8) = *(_DWORD *)(v3 + 16);
        sub_17CBC(
          *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
          0x130u,
          (__int64)&unk_57D38,
          *(_QWORD *)v3,
          *(_QWORD *)(v3 + 392),
          v8,
          v9);
      }
      if ( sub_20DDC(v3, a1) )
      {
        LOBYTE(v6) = 1;
        sub_48DB0(qword_5A8C8, BugCheckParameter1, v6, &v10);
        if ( v10 )
        {
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xAu)
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
          {
            sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x131u, (__int64)&unk_57D38, v10);
          }
        }
        else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
               && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xAu)
               && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x132u, (__int64)&unk_57D38);
        }
      }
      LOBYTE(v6) = 1;
      v3 = sub_49A3C(qword_5A8C8, &BugCheckParameter1, v6, &v10);
    }
    while ( v3 );
    v4 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xAu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v5 = 307;
      goto LABEL_33;
    }
  }
  else
  {
    v4 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xAu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v5 = 303;
LABEL_33:
      sub_13EA4(*(_QWORD *)&v4->DeviceLock.Header.Lock, v5, (__int64)&unk_57D38, v10);
      goto LABEL_34;
    }
  }
LABEL_34:
  sub_3D3DC(&stru_5D540);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x134u, (__int64)&unk_57D38);
  }
  return 0i64;
}
// 20C7C: variable 'v8' is possibly undefined
// 20C7C: variable 'v9' is possibly undefined
// 20CA8: variable 'v6' is possibly undefined

//----- (0000000000020DDC) ----------------------------------------------------
bool __fastcall sub_20DDC(__int64 a1, __int64 a2)
{
  __int64 v4; // rbx
  bool v5; // di

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x135u, (__int64)&unk_57D38);
  }
  v4 = MEMORY[0xFFFFF78000000014];
  KeWaitForSingleObject(*(PVOID *)(a1 + 8), Executive, 0, 0, 0i64);
  v5 = *(_QWORD *)(a1 + 48) + a2 < v4;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_17D8C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 310i64, (__int64)&unk_57D38);
  }
  KeReleaseMutex(*(PRKMUTEX *)(a1 + 8), 0);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 9u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x137u, (__int64)&unk_57D38);
  }
  return v5;
}

//----- (0000000000020F20) ----------------------------------------------------
__int64 __fastcall sub_20F20(__int64 a1)
{
  bool v2; // zf

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x138u, (__int64)&unk_57D38);
  }
  v2 = *(_QWORD *)(a1 + 400) == 0i64;
  *(_QWORD *)(a1 + 48) = MEMORY[0xFFFFF78000000014];
  if ( !v2 && *(_BYTE *)(a1 + 58) == 1 )
    *(_QWORD *)(*(_QWORD *)(a1 + 400) + 48i64) = MEMORY[0xFFFFF78000000014];
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x139u, (__int64)&unk_57D38);
  }
  return 0i64;
}

//----- (0000000000020FEC) ----------------------------------------------------
__int64 __fastcall sub_20FEC(void *Src, size_t MaxCount, unsigned __int64 a3)
{
  unsigned int v3; // esi
  PDEVICE_OBJECT v5; // rcx
  __int64 v7; // rax
  __int64 v8; // rbx
  __int64 v9; // rbp
  unsigned int v10; // ebx
  int v11; // eax
  PDEVICE_OBJECT v12; // rcx
  unsigned __int16 v13; // dx
  ULONG_PTR BugCheckParameter1[7]; // [rsp+30h] [rbp-38h] BYREF
  int v15; // [rsp+70h] [rbp+8h] BYREF
  unsigned __int64 v16; // [rsp+80h] [rbp+18h]

  v16 = a3;
  v15 = 0;
  v3 = MaxCount;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x13Au, (__int64)&unk_57D38);
    v5 = off_5A148;
  }
  if ( !Src )
  {
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x13Bu, (__int64)&unk_57D38);
    }
    return 4i64;
  }
  KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
  v7 = sub_49034(qword_5A8C0, v16, BugCheckParameter1, &v15);
  v8 = v7;
  if ( v15 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x13Cu, (__int64)&unk_57D38, v16);
    }
    KeReleaseMutex(&Mutex, 0);
    return 5i64;
  }
  v9 = *(_QWORD *)(v7 + 408);
  KeReleaseMutex(&Mutex, 0);
  if ( *(_BYTE *)(v8 + 58) )
  {
    v10 = sub_2EEA0(Src, v3, v9, *(struct _KMUTANT **)(v8 + 8));
  }
  else
  {
    if ( *(_DWORD *)(v8 + 20) == 6 )
    {
      if ( *(_DWORD *)(v8 + 16) == 34525 )
      {
        v11 = sub_24A30(v8, Src, v3);
        v10 = v11;
        if ( !v11 )
          goto LABEL_43;
        v12 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
          || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
          || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
        {
          goto LABEL_43;
        }
        v13 = 318;
      }
      else
      {
        v11 = sub_23B68(v8, Src, v3);
        v10 = v11;
        if ( !v11 )
          goto LABEL_43;
        v12 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
          || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
          || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
        {
          goto LABEL_43;
        }
        v13 = 319;
      }
    }
    else if ( *(_DWORD *)(v8 + 16) == 34525 )
    {
      v11 = sub_25110(v8, Src, v3);
      v10 = v11;
      if ( !v11 )
        goto LABEL_43;
      v12 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        goto LABEL_43;
      }
      v13 = 320;
    }
    else
    {
      v11 = sub_242A8(v8, Src, v3);
      v10 = v11;
      if ( !v11 )
        goto LABEL_43;
      v12 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        goto LABEL_43;
      }
      v13 = 321;
    }
    sub_13EA4(*(_QWORD *)&v12->DeviceLock.Header.Lock, v13, (__int64)&unk_57D38, v11);
  }
LABEL_43:
  sub_49CF0(qword_5A8C0, BugCheckParameter1[0]);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x142u, (__int64)&unk_57D38);
  }
  return v10;
}

//----- (00000000000212D0) ----------------------------------------------------
__int64 __fastcall sub_212D0(_QWORD *a1)
{
  unsigned int v2; // esi
  __int64 v3; // rbx
  int v4; // ebp
  char v5; // dl
  const char *v6; // r9
  const char *v7; // r8
  const char *v8; // rax
  int v9; // eax
  int v10; // ecx
  PDEVICE_OBJECT v11; // rsi
  const char *v12; // rax
  const char *v13; // r8
  const char *v14; // r9
  const char *v15; // r10
  const char *v16; // r11
  int v17; // er11
  char v18; // al
  int v19; // eax
  PDEVICE_OBJECT v20; // rcx
  __int64 v22; // [rsp+50h] [rbp-38h] BYREF
  int v23; // [rsp+58h] [rbp-30h]
  char v24; // [rsp+5Ch] [rbp-2Ch]
  int v25; // [rsp+98h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+A0h] [rbp+18h] BYREF

  v22 = 0i64;
  v23 = 0;
  v24 = 0;
  v2 = 0;
  v25 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x143u, (__int64)&unk_57D38);
  }
  KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
  v3 = sub_49034(qword_5A8C0, *a1, &BugCheckParameter1, &v25);
  KeReleaseMutex(&Mutex, 0);
  v4 = v25;
  if ( v25 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x146u, (__int64)&unk_57D38, *a1);
    }
    v2 = sub_4A538(v4);
    goto LABEL_42;
  }
  v5 = *((_BYTE *)a1 + 8);
  if ( !v5 )
  {
    if ( !*(_BYTE *)(v3 + 664) )
    {
      v9 = *((_DWORD *)a1 + 3);
      *(_BYTE *)(v3 + 664) = 1;
      *(_DWORD *)(v3 + 420) = v9;
      goto LABEL_22;
    }
LABEL_10:
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      v6 = "FALSE";
      v7 = "FALSE";
      v8 = "FALSE";
      if ( *(_BYTE *)(v3 + 664) )
        v7 = "TRUE";
      if ( *(_BYTE *)(v3 + 665) )
        v8 = "TRUE";
      if ( v5 )
        v6 = "TRUE";
      sub_188D8(
        *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
        0x144u,
        (__int64)&unk_57D38,
        v6,
        *a1,
        *(_QWORD *)(v3 + 656),
        v8,
        v7);
    }
    sub_49CF0(qword_5A8C0, BugCheckParameter1);
    goto LABEL_42;
  }
  if ( *(_BYTE *)(v3 + 665) )
    goto LABEL_10;
  *(_BYTE *)(v3 + 665) = 1;
LABEL_22:
  v10 = *(_DWORD *)(v3 + 420);
  *(_BYTE *)(v3 + 648) = v10 == 4 || v10 == 2;
  v11 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    v12 = sub_4A760(v10);
    if ( *((_BYTE *)a1 + 8) )
      v14 = "TRUE";
    sub_18A10(
      *(_QWORD *)&v11->DeviceLock.Header.Lock,
      325i64,
      (__int64)&unk_57D38,
      v14,
      *(_QWORD *)v3,
      *(_QWORD *)(v3 + 656),
      v12,
      v13,
      v15,
      v16);
  }
  sub_49CF0(qword_5A8C0, BugCheckParameter1);
  v17 = *((_DWORD *)a1 + 3);
  v22 = *(_QWORD *)(v3 + 656);
  v18 = *((_BYTE *)a1 + 8);
  v23 = v17;
  v24 = v18;
  v19 = sub_4421C(40021, &v22, 0xDu);
  v2 = v19;
  if ( !v19 )
    goto LABEL_42;
  v20 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v2;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x147u, (__int64)&unk_57D38, v19);
LABEL_42:
    v20 = off_5A148;
  }
  if ( v20 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v20->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v20->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v20->DeviceLock.Header.Lock, 0x148u, (__int64)&unk_57D38);
  }
  return v2;
}
// 213B1: conditional instruction was optimized away because of 'dl.1!=0'
// 21464: conditional instruction was optimized away because of 'dl.1==0'
// 21545: variable 'v14' is possibly undefined
// 21545: variable 'v13' is possibly undefined
// 21545: variable 'v15' is possibly undefined
// 21545: variable 'v16' is possibly undefined

//----- (0000000000021668) ----------------------------------------------------
__int64 __fastcall sub_21668(__int64 a1, char a2)
{
  __int64 v4; // rcx
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x149u, (__int64)&unk_57D38);
  }
  if ( a2 )
    KeWaitForSingleObject(*(PVOID *)(a1 + 8), Executive, 0, 0, 0i64);
  *(_DWORD *)(a1 + 420) = 4;
  if ( a2 )
    KeReleaseMutex(*(PRKMUTEX *)(a1 + 8), 0);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x14Au, (__int64)&unk_57D38, *(_QWORD *)a1);
  }
  v4 = *(_QWORD *)(a1 + 672);
  if ( *(_DWORD *)(a1 + 16) != 34525 )
  {
    sub_1E3E4(v4, a1);
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      goto LABEL_23;
    }
    v6 = 332;
    goto LABEL_22;
  }
  sub_1EBA4(v4, a1);
  v5 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return 0i64;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v6 = 331;
LABEL_22:
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, v6, (__int64)&unk_57D38);
    v5 = off_5A148;
  }
LABEL_23:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x14Du, (__int64)&unk_57D38);
  }
  return 0i64;
}

//----- (00000000000217FC) ----------------------------------------------------
__int64 __fastcall sub_217FC(__int64 a1, char a2)
{
  int v4; // eax
  unsigned int v5; // ebx
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x14Eu, (__int64)&unk_57D38);
  }
  if ( !*(_BYTE *)(a1 + 58) )
  {
    v4 = sub_21668(a1, a2);
    v5 = v4;
    if ( v4 )
    {
      v6 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return v5;
      if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        goto LABEL_18;
      }
      v7 = 336;
      goto LABEL_16;
    }
LABEL_17:
    v6 = off_5A148;
    goto LABEL_18;
  }
  v4 = sub_33A70(a1, a2);
  v5 = v4;
  if ( !v4 )
    goto LABEL_17;
  v6 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v5;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    v7 = 335;
LABEL_16:
    sub_13EA4(*(_QWORD *)&v6->DeviceLock.Header.Lock, v7, (__int64)&unk_57D38, v4);
    goto LABEL_17;
  }
LABEL_18:
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x151u, (__int64)&unk_57D38);
  }
  return v5;
}

//----- (0000000000021920) ----------------------------------------------------
__int64 __fastcall sub_21920(unsigned __int64 *a1)
{
  unsigned int v1; // ebx
  __int64 v3; // rdi
  __int64 v4; // rcx
  unsigned __int64 v5; // rbp
  PDEVICE_OBJECT v6; // r11
  __int64 v7; // r9
  _QWORD *v8; // rax
  const char *v9; // rax
  __int64 v10; // r11
  __int64 v11; // r8
  __int64 v12; // r9
  __int64 v13; // r10
  PLARGE_INTEGER Timeout; // [rsp+20h] [rbp-58h]
  __int16 v16; // [rsp+88h] [rbp+10h] BYREF
  __int64 v17; // [rsp+90h] [rbp+18h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+98h] [rbp+20h] BYREF

  v1 = 0;
  LODWORD(v17) = 0;
  v16 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x152u, (__int64)&unk_57D38);
  }
  KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
  v3 = sub_49034(qword_5A8C0, *a1, &BugCheckParameter1, &v17);
  KeReleaseMutex(&Mutex, 0);
  if ( !(_DWORD)v17 )
  {
    v4 = *(_QWORD *)(v3 + 672);
    v5 = a1[1];
    if ( v4 )
    {
      sub_3C570(*(PVOID *)(v4 + 16), 0x50535453u);
      sub_3C978((__int64)qword_5A8A8, *(_QWORD *)(v3 + 672));
    }
    *(_QWORD *)(v3 + 672) = sub_1A1AC((void *)a1[1]);
    sub_50E34(*(_QWORD *)(a1[1] + 16), &v17, &v16);
    v6 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v7 = *(_QWORD *)(v3 + 672);
      LODWORD(Timeout) = (*(_BYTE *)(v7 + 120) & 0x10) == 16;
      sub_18210(
        *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
        339i64,
        (__int64)&unk_57D38,
        *(_QWORD *)v7,
        Timeout,
        *(_QWORD *)v5,
        (*(_BYTE *)(v5 + 120) & 0x10) == 16);
      v6 = off_5A148;
    }
    if ( *((_BYTE *)a1 + 16) )
    {
      if ( v6 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
LABEL_23:
        v8 = (_QWORD *)a1[1];
        if ( *(_QWORD *)(v3 + 656) == *v8 )
        {
          if ( v6 == (PDEVICE_OBJECT)&off_5A148 )
          {
LABEL_34:
            sub_49CF0(qword_5A8C0, BugCheckParameter1);
            goto LABEL_40;
          }
          if ( (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
            || BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) < 3u )
          {
LABEL_30:
            if ( v6 != (PDEVICE_OBJECT)&off_5A148
              && (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
              && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              v9 = sub_4A760(*(_DWORD *)(v3 + 420));
              sub_17DFC(
                *(_QWORD *)(v10 + 280),
                0x157u,
                (__int64)&unk_57D38,
                *(_QWORD *)v3,
                *(_QWORD *)(v3 + 656),
                v9,
                v13,
                v11,
                v12);
            }
            goto LABEL_34;
          }
          sub_13EE0(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x156u, (__int64)&unk_57D38, *a1, *v8);
        }
        else
        {
          *(_QWORD *)(v3 + 656) = *v8;
          *(_BYTE *)(v3 + 664) = 0;
          *(_BYTE *)(v3 + 665) = 0;
        }
        v6 = off_5A148;
        goto LABEL_30;
      }
      sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x155u, (__int64)&unk_57D38);
    }
    else
    {
      if ( v6 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x154u, (__int64)&unk_57D38);
      }
      *(_DWORD *)(v3 + 420) = 4;
      *(_BYTE *)(v3 + 648) = 1;
    }
    v6 = off_5A148;
    goto LABEL_23;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x158u, (__int64)&unk_57D38, *a1);
  }
  v1 = sub_4A538(v17);
LABEL_40:
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x159u, (__int64)&unk_57D38);
  }
  return v1;
}
// 21AB3: variable 'Timeout' is possibly undefined
// 21BF7: variable 'v10' is possibly undefined
// 21C29: variable 'v13' is possibly undefined
// 21C29: variable 'v11' is possibly undefined
// 21C29: variable 'v12' is possibly undefined

//----- (0000000000021CD8) ----------------------------------------------------
__int64 __fastcall sub_21CD8(_QWORD *a1, _QWORD *a2)
{
  __int64 v3; // rcx
  __int64 v5; // rax
  PDEVICE_OBJECT v6; // rdi
  const char *v7; // rax
  __int64 v8; // r9
  __int64 v9; // r10
  __int64 v10; // r11

  v3 = a1[84];
  if ( v3 )
  {
    sub_3C570(*(PVOID *)(v3 + 16), 0x50535453u);
    sub_3C978((__int64)qword_5A8A8, a1[84]);
  }
  v5 = sub_1A1AC(a2);
  *((_DWORD *)a1 + 105) = 4;
  *((_BYTE *)a1 + 648) = 1;
  a1[84] = v5;
  if ( a1[82] != *a2 )
  {
    a1[82] = *a2;
    *((_BYTE *)a1 + 664) = 0;
    *((_BYTE *)a1 + 665) = 0;
LABEL_9:
    v6 = off_5A148;
    goto LABEL_10;
  }
  v6 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return 0i64;
  if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Au)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x15Au, (__int64)&unk_57D38, *a1, *a2);
    goto LABEL_9;
  }
LABEL_10:
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v6->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Au)
    && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    v7 = sub_4A760(*((_DWORD *)a1 + 105));
    sub_17DFC(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x15Bu, (__int64)&unk_57D38, *a1, *a2, v7, v10, v8, v9);
  }
  return 0i64;
}
// 21E5B: variable 'v10' is possibly undefined
// 21E5B: variable 'v8' is possibly undefined
// 21E5B: variable 'v9' is possibly undefined

//----- (0000000000021E80) ----------------------------------------------------
__int64 __fastcall sub_21E80(__int64 a1, __int64 *a2)
{
  unsigned int v2; // esi
  PDEVICE_OBJECT v5; // rbx
  const char *v6; // rax
  int v7; // eax
  __int64 v8; // rax
  int v9; // eax
  const char *v10; // rax
  const char *v11; // r8
  const char *v12; // r9
  const char *v13; // r10
  const char *v14; // r11
  __int64 v16; // [rsp+60h] [rbp-28h] BYREF
  int v17; // [rsp+68h] [rbp-20h]
  char v18; // [rsp+6Ch] [rbp-1Ch]

  v2 = 0;
  v16 = 0i64;
  v17 = 0;
  v18 = 0;
  if ( !*(_BYTE *)(a1 + 665) )
  {
    v7 = *(_DWORD *)(a1 + 420);
    *(_BYTE *)(a1 + 665) = 1;
    *(_BYTE *)(a1 + 648) = v7 == 4 || v7 == 2;
    v8 = *a2;
    v17 = 0;
    v16 = v8;
    v18 = 1;
    v9 = sub_4421C(40021, &v16, 0xDu);
    v2 = v9;
    if ( v9 )
    {
      v5 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return v2;
      if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Au)
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        goto LABEL_18;
      }
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x15Du, (__int64)&unk_57D38, v9);
    }
    goto LABEL_17;
  }
  v5 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v2;
  if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Au)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    v6 = "FALSE";
    if ( *(_BYTE *)(a1 + 664) )
      v6 = "TRUE";
    sub_188D8(
      *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
      0x15Cu,
      (__int64)&unk_57D38,
      "TRUE",
      *(_QWORD *)a1,
      *(_QWORD *)(a1 + 656),
      "TRUE",
      v6);
LABEL_17:
    v5 = off_5A148;
  }
LABEL_18:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Au)
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    v10 = sub_4A760(*(_DWORD *)(a1 + 420));
    sub_18BEC(
      *(_QWORD *)&v5->DeviceLock.Header.Lock,
      351i64,
      (__int64)&unk_57D38,
      "TRUE",
      *(_QWORD *)a1,
      *a2,
      v10,
      v13,
      v12,
      v14,
      v11);
  }
  return v2;
}
// 22072: variable 'v13' is possibly undefined
// 22072: variable 'v12' is possibly undefined
// 22072: variable 'v14' is possibly undefined
// 22072: variable 'v11' is possibly undefined

//----- (000000000002209C) ----------------------------------------------------
__int64 __fastcall sub_2209C(unsigned __int64 *a1)
{
  unsigned int v1; // ebx
  __int64 v3; // rsi
  struct _KMUTANT *v4; // rcx
  int v6; // [rsp+58h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+60h] [rbp+18h] BYREF

  v1 = 0;
  v6 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x160u, (__int64)&unk_57D38);
  }
  KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
  v3 = sub_49034(qword_5A8C0, *a1, &BugCheckParameter1, &v6);
  KeReleaseMutex(&Mutex, 0);
  if ( v6 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x161u, (__int64)&unk_57D38, *a1);
    }
    v1 = sub_4A538(v6);
  }
  else
  {
    KeWaitForSingleObject(*(PVOID *)(v3 + 8), Executive, 0, 0, 0i64);
    v4 = *(struct _KMUTANT **)(v3 + 8);
    *(_DWORD *)(v3 + 420) = *((_DWORD *)a1 + 4);
    KeReleaseMutex(v4, 0);
    sub_49CF0(qword_5A8C0, BugCheckParameter1);
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x162u, (__int64)&unk_57D38);
  }
  return v1;
}

//----- (0000000000022210) ----------------------------------------------------
__int64 __fastcall sub_22210(unsigned __int64 *a1)
{
  unsigned int v1; // ebx
  __int64 v2; // r13
  ULONG_PTR v4; // rsi
  PDEVICE_OBJECT v5; // rcx
  __int64 v6; // rax
  int v7; // ebp
  _QWORD *v8; // r12
  unsigned __int64 v9; // rdx
  __int64 v10; // rax
  int v11; // edi
  unsigned int v12; // eax
  unsigned int v13; // eax
  PLARGE_INTEGER Timeout; // [rsp+20h] [rbp-68h]
  PLARGE_INTEGER Timeouta; // [rsp+20h] [rbp-68h]
  PLARGE_INTEGER Timeoutb; // [rsp+20h] [rbp-68h]
  int v18; // [rsp+28h] [rbp-60h]
  ULONG_PTR BugCheckParameter1[9]; // [rsp+40h] [rbp-48h] BYREF
  __int64 v20; // [rsp+98h] [rbp+10h] BYREF
  int v21; // [rsp+A0h] [rbp+18h] BYREF
  ULONG_PTR v22; // [rsp+A8h] [rbp+20h] BYREF

  v1 = 0;
  v2 = 0i64;
  v21 = 0;
  BugCheckParameter1[0] = 0i64;
  v4 = 0i64;
  v22 = 0i64;
  LOBYTE(v20) = 1;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x163u, (__int64)&unk_57D38);
      v5 = off_5A148;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EE0(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x164u, (__int64)&unk_57D38, *a1, a1[1]);
    }
  }
  KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
  v6 = sub_49034(qword_5A8C0, *a1, BugCheckParameter1, &v21);
  v7 = v21;
  v8 = (_QWORD *)v6;
  if ( v21 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      LODWORD(Timeout) = v21;
      sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x165u, (__int64)&unk_57D38, *a1, Timeout);
    }
    v1 = sub_4A538(v7);
  }
  else
  {
    v9 = a1[1];
    if ( v9 )
    {
      v10 = sub_49034(qword_5A8C0, v9, &v22, &v21);
      v11 = v21;
      v2 = v10;
      if ( v21 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          LODWORD(Timeout) = v21;
          sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x166u, (__int64)&unk_57D38, *v8, Timeout);
        }
        v1 = sub_4A538(v11);
      }
      v4 = v22;
    }
  }
  KeReleaseMutex(&Mutex, 0);
  if ( v8 )
  {
    LOBYTE(v18) = 1;
    v12 = sub_26500(qword_5A8C0, (__int64)v8, BugCheckParameter1[0], 0i64, *((_DWORD *)v8 + 6), v18, 0, (__int64)&v20);
    v1 = v12;
    if ( v12
      && off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      LODWORD(Timeouta) = v12;
      sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x167u, (__int64)&unk_57D38, *v8, Timeouta);
    }
    sub_49CF0(qword_5A8C0, BugCheckParameter1[0]);
  }
  if ( v2 )
  {
    LOBYTE(v18) = 1;
    v13 = sub_26500(qword_5A8C0, v2, v4, 0i64, *(_DWORD *)(v2 + 24), v18, 0, (__int64)&v20);
    v1 = v13;
    if ( v13
      && off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      LODWORD(Timeoutb) = v13;
      sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x168u, (__int64)&unk_57D38, *(_QWORD *)v2, Timeoutb);
    }
    sub_49CF0(qword_5A8C0, v4);
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x169u, (__int64)&unk_57D38);
  }
  return v1;
}
// 22336: variable 'Timeout' is possibly undefined
// 22416: variable 'v18' is possibly undefined
// 2245B: variable 'Timeouta' is possibly undefined
// 224F1: variable 'Timeoutb' is possibly undefined

//----- (0000000000022558) ----------------------------------------------------
__int64 __fastcall sub_22558(unsigned __int64 *a1)
{
  PDEVICE_OBJECT v2; // rcx
  _QWORD *v3; // rsi
  int v4; // ebx
  unsigned int v5; // ebx
  unsigned int v6; // eax
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  PLARGE_INTEGER Timeout; // [rsp+20h] [rbp-28h]
  int v11; // [rsp+58h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+60h] [rbp+18h] BYREF

  v11 = 0;
  BugCheckParameter1 = 0i64;
  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Bu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x16Au, (__int64)&unk_57D38);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Bu)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_17D2C(*(_QWORD *)&v2->DeviceLock.Header.Lock, 363i64, (__int64)&unk_57D38, *a1, a1[1], *(_QWORD *)a1[2]);
    }
  }
  KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
  v3 = (_QWORD *)sub_49034(qword_5A8C0, *a1, &BugCheckParameter1, &v11);
  KeReleaseMutex(&Mutex, 0);
  v4 = v11;
  if ( v11 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Bu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      LODWORD(Timeout) = v11;
      sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x16Cu, (__int64)&unk_57D38, *a1, Timeout);
    }
    v5 = sub_4A538(v4);
    goto LABEL_26;
  }
  v6 = sub_21CD8(v3, (_QWORD *)a1[2]);
  v5 = v6;
  if ( v6 )
  {
    v7 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Bu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      v8 = 365;
LABEL_25:
      LODWORD(Timeout) = v6;
      sub_4AC00(*(_QWORD *)&v7->DeviceLock.Header.Lock, v8, (__int64)&unk_57D38, *v3, Timeout);
      goto LABEL_26;
    }
  }
  else
  {
    v6 = sub_21E80((__int64)v3, (__int64 *)a1[2]);
    v5 = v6;
    if ( !v6 )
    {
LABEL_26:
      v7 = off_5A148;
      goto LABEL_27;
    }
    v7 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Bu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      v8 = 366;
      goto LABEL_25;
    }
  }
LABEL_27:
  if ( BugCheckParameter1 )
  {
    sub_49CF0(qword_5A8C0, BugCheckParameter1);
    v7 = off_5A148;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v7->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Bu)
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x16Fu, (__int64)&unk_57D38);
  }
  return v5;
}
// 22686: variable 'Timeout' is possibly undefined

//----- (0000000000022794) ----------------------------------------------------
__int64 __fastcall sub_22794(__int64 a1)
{
  unsigned int v2; // ebx
  PDEVICE_OBJECT v3; // rcx
  unsigned __int64 *v4; // rdi
  _QWORD *v5; // rsi
  int v6; // eax
  int v8; // [rsp+50h] [rbp+8h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+58h] [rbp+10h] BYREF

  v2 = 0;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x170u, (__int64)&unk_57D38);
    v3 = off_5A148;
  }
  v4 = *(unsigned __int64 **)(a1 + 16);
  if ( v4 )
  {
    v8 = 0;
    BugCheckParameter1 = 0i64;
    KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
    v5 = (_QWORD *)sub_49034(qword_5A8C0, *v4, &BugCheckParameter1, &v8);
    KeReleaseMutex(&Mutex, 0);
    if ( !v8 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x171u, (__int64)&unk_57D38, *v5);
      }
      v6 = sub_274C4((__int64)v5);
      v2 = v6;
      if ( v6
        && off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x172u, (__int64)&unk_57D38, v6);
      }
      sub_49CF0(qword_5A8C0, BugCheckParameter1);
    }
    sub_3C570(v4, 0x6D707453u);
    v3 = off_5A148;
  }
  else
  {
    if ( v3 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x173u, (__int64)&unk_57D38);
      v3 = off_5A148;
    }
    v2 = 6;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x174u, (__int64)&unk_57D38);
  }
  return v2;
}

//----- (0000000000022984) ----------------------------------------------------
__int64 __fastcall sub_22984(__int64 a1)
{
  unsigned int v1; // edi
  _QWORD *v2; // r12
  PDEVICE_OBJECT v4; // rcx
  unsigned __int64 *v5; // r13
  __int64 v6; // rax
  int v7; // ebp
  _QWORD *v8; // rsi
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  unsigned __int64 v11; // rdx
  __int64 v12; // rax
  __int64 v13; // r8
  int v14; // ebp
  int v15; // ecx
  int v16; // esi
  int v17; // ecx
  PLARGE_INTEGER Timeout; // [rsp+20h] [rbp-88h]
  unsigned __int64 Dst; // [rsp+30h] [rbp-78h] BYREF
  int v21; // [rsp+38h] [rbp-70h]
  int v22; // [rsp+B0h] [rbp+8h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+B8h] [rbp+10h] BYREF
  ULONG_PTR v24; // [rsp+C0h] [rbp+18h] BYREF

  v1 = 0;
  v2 = 0i64;
  v22 = 0;
  BugCheckParameter1 = 0i64;
  v24 = 0i64;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x175u, (__int64)&unk_57D38);
    v4 = off_5A148;
  }
  v5 = *(unsigned __int64 **)(a1 + 16);
  if ( v5 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EE0(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x176u, (__int64)&unk_57D38, *v5, v5[1]);
    }
    KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
    v6 = sub_49034(qword_5A8C0, *v5, &BugCheckParameter1, &v22);
    v7 = v22;
    v8 = (_QWORD *)v6;
    if ( v22 )
    {
      v9 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        goto LABEL_22;
      }
      v10 = 375;
    }
    else
    {
      v11 = v5[1];
      if ( !v11 )
        goto LABEL_23;
      v12 = sub_49034(qword_5A8C0, v11, &v24, &v22);
      v7 = v22;
      v2 = (_QWORD *)v12;
      if ( !v22 )
        goto LABEL_23;
      v9 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
LABEL_22:
        v1 = sub_4A538(v7);
LABEL_23:
        KeReleaseMutex(&Mutex, 0);
        if ( v8 )
        {
          LOBYTE(v13) = 1;
          sub_48B2C(qword_5A8C0, *v8, v13, &v22);
          v14 = v22;
          if ( v22 )
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
            {
              LODWORD(Timeout) = v22;
              sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x179u, (__int64)&unk_57D38, *v8, Timeout);
            }
            v1 = sub_4A538(v14);
          }
          else
          {
            LODWORD(Dst) = 0;
            memset((char *)&Dst + 4, 0, 0x34ui64);
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x17Au, (__int64)&unk_57D38, *v8);
            }
            v15 = *((_DWORD *)v8 + 6);
            Dst = *v8;
            v21 = 2;
            sub_1F4D4(v15, (__int64)&Dst);
          }
          sub_49CF0(qword_5A8C0, BugCheckParameter1);
        }
        if ( v2 )
        {
          LOBYTE(v13) = 1;
          sub_48B2C(qword_5A8C0, *v2, v13, &v22);
          v16 = v22;
          if ( v22 )
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
            {
              LODWORD(Timeout) = v22;
              sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x17Bu, (__int64)&unk_57D38, *v2, Timeout);
            }
            v1 = sub_4A538(v16);
          }
          else
          {
            LODWORD(Dst) = 0;
            memset((char *)&Dst + 4, 0, 0x34ui64);
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x17Cu, (__int64)&unk_57D38, *v2);
            }
            v17 = *((_DWORD *)v2 + 6);
            Dst = *v2;
            v21 = 2;
            sub_1F4D4(v17, (__int64)&Dst);
          }
          sub_49CF0(qword_5A8C0, v24);
        }
        sub_3C570(v5, 0x6D707453u);
        v4 = off_5A148;
        goto LABEL_55;
      }
      v10 = 376;
    }
    LODWORD(Timeout) = v7;
    sub_4AC00(*(_QWORD *)&v9->DeviceLock.Header.Lock, v10, (__int64)&unk_57D38, *v8, Timeout);
    goto LABEL_22;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x17Du, (__int64)&unk_57D38);
    v4 = off_5A148;
  }
  v1 = 6;
LABEL_55:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x17Eu, (__int64)&unk_57D38);
  }
  return v1;
}
// 22B30: variable 'Timeout' is possibly undefined
// 22B6B: variable 'v13' is possibly undefined

//----- (0000000000022E04) ----------------------------------------------------
__int64 __fastcall sub_22E04(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  unsigned __int64 *v3; // rdi
  _QWORD *v4; // rbx
  int v5; // eax
  __int64 v6; // r8
  unsigned int v7; // ebx
  int v8; // eax
  int v9; // eax
  int v11; // [rsp+50h] [rbp+8h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+58h] [rbp+10h] BYREF

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x17Fu, (__int64)&unk_57D38);
    v2 = off_5A148;
  }
  v3 = *(unsigned __int64 **)(a1 + 16);
  if ( v3 )
  {
    v11 = 0;
    BugCheckParameter1 = 0i64;
    KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
    v4 = (_QWORD *)sub_49034(qword_5A8C0, *v3, &BugCheckParameter1, &v11);
    KeReleaseMutex(&Mutex, 0);
    if ( v11 )
    {
      v9 = sub_4A538(v11);
      v7 = v9;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x183u, (__int64)&unk_57D38, v9);
      }
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x180u, (__int64)&unk_57D38, *v4);
      }
      v5 = sub_217FC((__int64)v4, 0);
      v7 = v5;
      if ( v5
        && off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x181u, (__int64)&unk_57D38, v5);
      }
      LOBYTE(v6) = 1;
      sub_48DB0(qword_5A8C0, BugCheckParameter1, v6, &v11);
      if ( v11
        && off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        v8 = sub_4A538(v11);
        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x182u, (__int64)&unk_57D38, v8);
      }
      sub_49CF0(qword_5A8C0, BugCheckParameter1);
    }
    sub_3C570(v3, 0x6D707453u);
    v2 = off_5A148;
  }
  else
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x184u, (__int64)&unk_57D38);
      v2 = off_5A148;
    }
    v7 = 6;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x185u, (__int64)&unk_57D38);
  }
  return v7;
}
// 22F53: variable 'v6' is possibly undefined

//----- (000000000002308C) ----------------------------------------------------
__int64 __fastcall sub_2308C(__int64 a1, unsigned __int64 *a2)
{
  char *v4; // rbx
  PDEVICE_OBJECT v5; // rcx
  char v6; // al
  ULONG_PTR v7; // rdi
  __int64 v8; // rbx
  __int64 v9; // rcx
  int v11; // [rsp+30h] [rbp-38h] BYREF
  ULONG_PTR BugCheckParameter1[6]; // [rsp+38h] [rbp-30h] BYREF
  union _LARGE_INTEGER v13; // [rsp+70h] [rbp+8h] BYREF
  char v14; // [rsp+80h] [rbp+18h] BYREF
  unsigned __int16 v15; // [rsp+88h] [rbp+20h] BYREF

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x186u, (__int64)&unk_57D38);
  }
  v4 = sub_4AE28(*(_QWORD *)(a1 + 16), 6);
  if ( !v4 )
    goto LABEL_42;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xBBu, (__int64)&unk_57BC0, v4, &v14);
    v5 = off_5A148;
  }
  v14 = *v4;
  if ( v5 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0 && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v5->AlignmentRequirement, 0xBCu, (__int64)&unk_57BC0);
      v5 = off_5A148;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EE0(*(_QWORD *)&v5->AlignmentRequirement, 0xBDu, (__int64)&unk_57BC0, v4, &v13);
      v5 = off_5A148;
    }
  }
  v6 = v4[1];
  LOBYTE(v13.LowPart) = v6;
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->AlignmentRequirement, 0xBEu, (__int64)&unk_57BC0);
    v6 = v13.LowPart;
    v5 = off_5A148;
  }
  if ( v14 == 3 && v6 == 4 )
  {
    v11 = 0;
    v7 = 0i64;
    sub_4E318((__int64)v4, &v15);
    KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
    v8 = sub_49034(qword_5A8C0, *a2, BugCheckParameter1, &v11);
    if ( v11 )
    {
      v8 = sub_49034(qword_5A8C8, *a2, BugCheckParameter1, &v11);
      if ( v11 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x188u, (__int64)&unk_57D38, *a2);
        }
      }
      else
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x189u, (__int64)&unk_57D38, *a2);
        }
        v7 = qword_5A8C8;
      }
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x187u, (__int64)&unk_57D38, *a2);
      }
      v7 = qword_5A8C0;
    }
    KeReleaseMutex(&Mutex, 0);
    if ( v8 )
    {
      KeWaitForSingleObject(*(PVOID *)(v8 + 8), Executive, 0, 0, 0i64);
      v9 = *(_QWORD *)(v8 + 408);
      *(_DWORD *)(v8 + 416) = v15;
      sub_2FDFC(v9, v15 - 80);
      KeReleaseMutex(*(PRKMUTEX *)(v8 + 8), 0);
      sub_49CF0(v7, BugCheckParameter1[0]);
    }
LABEL_42:
    v5 = off_5A148;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x18Au, (__int64)&unk_57D38);
  }
  return 0i64;
}

//----- (0000000000023400) ----------------------------------------------------
__int64 __fastcall sub_23400(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  int v3; // eax

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x10u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x18Bu, (__int64)&unk_57D38);
    v2 = off_5A148;
  }
  if ( (*(_BYTE *)(a1 + 120) & 4) != 0 )
  {
    if ( !byte_5A8D1 )
    {
      if ( v2 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x10u)
        && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x18Cu, (__int64)&unk_57D38, *(_DWORD *)(a1 + 140));
        v2 = off_5A148;
      }
      v3 = *(_DWORD *)(a1 + 140);
      byte_5A8D1 = 1;
      dword_5A8D4 = v3;
    }
  }
  else if ( byte_5A8D1 == 1 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x10u)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x18Du, (__int64)&unk_57D38);
      v2 = off_5A148;
    }
    byte_5A8D1 = 0;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x10u)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x18Eu, (__int64)&unk_57D38);
  }
  return 0i64;
}
// 5A8D1: using guessed type char byte_5A8D1;
// 5A8D4: using guessed type int dword_5A8D4;

//----- (0000000000023544) ----------------------------------------------------
__int64 __fastcall sub_23544(__int64 a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 v5; // rbx
  int v7; // [rsp+20h] [rbp-18h]

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x18Fu, (__int64)&unk_57D38);
    v4 = off_5A148;
  }
  if ( *(_DWORD *)(a1 + 24) == 1 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      v7 = 1;
      sub_4AC00(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x190u, (__int64)&unk_57D38, *(_QWORD *)a1, v7);
    }
    v5 = *(_QWORD *)(a1 + 400);
    *(_BYTE *)(a1 + 58) = 0;
    *(_BYTE *)(a1 + 59) = 0;
    *(_BYTE *)(a1 + 57) = 0;
    *(_DWORD *)(a1 + 24) = *(_DWORD *)(a2 + 20);
    if ( v5 && *(_BYTE *)(v5 + 58) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x191u, (__int64)&unk_57D38);
      }
      *(_BYTE *)(v5 + 58) = 0;
      *(_BYTE *)(v5 + 59) = 0;
      *(_BYTE *)(v5 + 57) = 0;
      *(_DWORD *)(v5 + 24) = *(_DWORD *)(a2 + 20);
    }
    sub_33B4C(a1);
    goto LABEL_22;
  }
  if ( v4 == (PDEVICE_OBJECT)&off_5A148 )
    return 0i64;
  if ( (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x192u, (__int64)&unk_57D38);
LABEL_22:
    v4 = off_5A148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x193u, (__int64)&unk_57D38);
  }
  return 0i64;
}

//----- (00000000000236DC) ----------------------------------------------------
__int64 __fastcall sub_236DC(int a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  int v5; // edi
  int v6; // esi
  PVOID *i; // r11
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  int v10; // er9
  unsigned __int8 v11; // al
  __int64 v12; // rdx

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x198u, (__int64)&unk_57D38);
    v4 = off_5A148;
  }
  v5 = 5;
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0xB1u, (__int64)&unk_57D48);
  }
  v6 = 0;
  sub_3D310(&FastMutex);
  for ( i = (PVOID *)qword_5D5C0; i != &qword_5D5C0; i = (PVOID *)*i )
  {
    if ( a1 == *((_DWORD *)i + 4) )
    {
      v6 = *((_DWORD *)i + 5);
      v5 = 0;
      break;
    }
  }
  sub_3D3DC(&FastMutex);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB2u, (__int64)&unk_57D48);
  }
  if ( v5 )
  {
    v11 = sub_4535C(0x201300Du);
    *(_BYTE *)(a2 + 58) = v11;
    v8 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v10 = v11;
      v9 = 410;
      goto LABEL_28;
    }
  }
  else
  {
    *(_BYTE *)(a2 + 58) = v6 == 2;
    v8 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v9 = 409;
      v10 = v6;
LABEL_28:
      sub_13EA4(*(_QWORD *)&v8->DeviceLock.Header.Lock, v9, (__int64)&unk_57D38, v10);
      v8 = off_5A148;
      goto LABEL_29;
    }
  }
LABEL_29:
  v12 = *(_QWORD *)(a2 + 400);
  if ( v12 )
  {
    *(_BYTE *)(v12 + 58) = *(_BYTE *)(a2 + 58);
    v8 = off_5A148;
  }
  if ( v8 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v8->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x19Bu, (__int64)&unk_57D38);
  }
  return 0i64;
}

//----- (00000000000238E8) ----------------------------------------------------
__int64 __fastcall sub_238E8(int a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  unsigned int v5; // edi
  PVOID *i; // r11
  PDEVICE_OBJECT v7; // rcx
  int v8; // er9
  PDEVICE_OBJECT v9; // rcx

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x19Cu, (__int64)&unk_57D38);
    v4 = off_5A148;
  }
  v5 = 5;
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0xB6u, (__int64)&unk_57D48);
  }
  *(_DWORD *)(a2 + 700) = 0;
  *(_DWORD *)(a2 + 704) = 0;
  sub_3D310(&FastMutex);
  for ( i = (PVOID *)qword_5D5C0; i != &qword_5D5C0; i = (PVOID *)*i )
  {
    if ( a1 == *((_DWORD *)i + 4) )
    {
      *(_DWORD *)(a2 + 700) = *((_DWORD *)i + 7);
      *(_DWORD *)(a2 + 704) = *((_DWORD *)i + 8);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_184C0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB7u, (__int64)&unk_57D48, *(_DWORD *)(a2 + 700));
      }
      v5 = 0;
      break;
    }
  }
  sub_3D3DC(&FastMutex);
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB8u, (__int64)&unk_57D48);
    v7 = off_5A148;
  }
  if ( v5 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_13EA4(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x19Du, (__int64)&unk_57D38, v5);
    }
    *(_DWORD *)(a2 + 700) = sub_4535C(0x2013020u);
    *(_DWORD *)(a2 + 704) = sub_4535C(0x2013021u);
  }
  v8 = *(_DWORD *)(a2 + 700) << 10;
  *(_DWORD *)(a2 + 704) <<= 10;
  *(_DWORD *)(a2 + 700) = v8;
  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_184C0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x19Eu, (__int64)&unk_57D38, v8);
      v9 = off_5A148;
    }
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x19Fu, (__int64)&unk_57D38);
    }
  }
  return v5;
}

//----- (0000000000023B68) ----------------------------------------------------
__int64 __fastcall sub_23B68(__int64 a1, const void *a2, unsigned int a3)
{
  __int64 v3; // r13
  size_t v4; // rbp
  const void *v5; // rax
  PDEVICE_OBJECT v7; // rcx
  _DWORD *v9; // rax
  __int64 v10; // rdi
  int v11; // ecx
  PVOID v12; // rax
  __int64 v13; // rcx
  unsigned __int16 *v14; // r14
  _WORD *v15; // r12
  _BYTE *v16; // rbx
  _WORD *v17; // r15
  __int64 v18; // rcx
  __int16 v19; // dx
  __int16 v20; // ax
  unsigned __int8 *v21; // rsi
  int v22; // eax
  int v23; // ebx
  PDEVICE_OBJECT v24; // rcx
  char v25; // [rsp+70h] [rbp-B8h] BYREF
  unsigned __int8 v26[3]; // [rsp+71h] [rbp-B7h] BYREF
  unsigned __int16 v27; // [rsp+74h] [rbp-B4h] BYREF
  unsigned __int16 v28[2]; // [rsp+78h] [rbp-B0h] BYREF
  unsigned __int16 v29; // [rsp+7Ch] [rbp-ACh] BYREF
  unsigned __int16 v30[2]; // [rsp+80h] [rbp-A8h] BYREF
  int v31; // [rsp+84h] [rbp-A4h] BYREF
  unsigned int v32; // [rsp+88h] [rbp-A0h] BYREF
  unsigned int v33; // [rsp+8Ch] [rbp-9Ch] BYREF
  int v34; // [rsp+90h] [rbp-98h] BYREF
  const void *v35; // [rsp+98h] [rbp-90h]
  unsigned __int8 *v36; // [rsp+A0h] [rbp-88h] BYREF
  int v37; // [rsp+B0h] [rbp-78h] BYREF
  __int16 v38; // [rsp+B4h] [rbp-74h]
  int v39; // [rsp+C0h] [rbp-68h] BYREF
  __int16 v40; // [rsp+C4h] [rbp-64h]
  __int64 v41; // [rsp+D0h] [rbp-58h] BYREF
  int v42; // [rsp+D8h] [rbp-50h] BYREF
  __int16 v43; // [rsp+DCh] [rbp-4Ch]
  int v44; // [rsp+E0h] [rbp-48h] BYREF
  __int16 v45; // [rsp+E4h] [rbp-44h]

  v3 = *(_QWORD *)(a1 + 672);
  v4 = a3;
  v5 = a2;
  v35 = a2;
  v31 = 0;
  v34 = 0;
  v36 = 0i64;
  v27 = 0;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1A0u, (__int64)&unk_57D38);
    v7 = off_5A148;
    v5 = v35;
  }
  if ( !*(_QWORD *)(a1 + 672) )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1A1u, (__int64)&unk_57D38, a1);
    }
    return 4i64;
  }
  if ( !(_DWORD)v4 )
  {
    if ( !v5 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_4AC00(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1A2u, (__int64)&unk_57D38, 0i64, 0);
      }
      return 4i64;
    }
LABEL_18:
    sub_50E34(*(_QWORD *)(v3 + 16), &v41, v28);
    v9 = sub_3C910((__int64)qword_5A8A8);
    v10 = (__int64)v9;
    if ( !v9 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1A4u, (__int64)&unk_57D38);
      }
      return 3i64;
    }
    *(_QWORD *)(v9 + 55) = 0i64;
    v9[32] = 2;
    v9[93] = *(_DWORD *)(v3 + 372);
    v9[30] = 0;
    if ( (*(_BYTE *)(v3 + 120) & 0x10) == 0 )
      v9[30] = 16;
    *(_QWORD *)v9 = _InterlockedIncrement64(&qword_5D418) | 0x8000000000000000ui64;
    *((_QWORD *)v9 + 1) = MEMORY[0xFFFFF78000000014];
    v11 = *(_DWORD *)(v3 + 124) - v28[0];
    v9[31] = v11;
    v12 = sub_3C4EC(2, v11 + (int)v4, 0x624E734Eu);
    *(_QWORD *)(v10 + 16) = v12;
    if ( !v12 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1A5u, (__int64)&unk_57D38);
      }
      sub_3C978((__int64)qword_5A8A8, v10);
      return 3i64;
    }
    memmove(v12, *(const void **)(v3 + 16), *(unsigned int *)(v10 + 124));
    v13 = *(_QWORD *)(v10 + 16);
    *(_DWORD *)(v10 + 124) += v4;
    v14 = (unsigned __int16 *)sub_4AE28(v13, 1);
    v15 = sub_4AE28(*(_QWORD *)(v10 + 16), 3);
    v16 = sub_4AE28(*(_QWORD *)(v3 + 16), 1);
    v17 = sub_4AE28(*(_QWORD *)(v3 + 16), 3);
    sub_4BAA4(*(_QWORD *)(v3 + 16), (__int64)&v44);
    v39 = v44;
    v40 = v45;
    sub_4E4D0(*(_QWORD *)(v10 + 16), (unsigned __int8 *)&v39);
    sub_4BB5C(*(_QWORD *)(v3 + 16), (__int64)&v42);
    v37 = v42;
    v18 = *(_QWORD *)(v10 + 16);
    v38 = v43;
    sub_4E3DC(v18, (unsigned __int8 *)&v37);
    sub_4E5C0((__int64)v14, *(_WORD *)(v10 + 124) - 14);
    sub_4E800((__int64)v14);
    sub_4C138((__int64)v16, &v33);
    sub_4EA38((__int64)v14, v33);
    sub_4C1E8((__int64)v16, &v32);
    sub_4E968((__int64)v14, v32);
    if ( (*(_BYTE *)(v3 + 120) & 0x10) != 0 )
      v19 = *(_WORD *)(a1 + 640);
    else
      v19 = *(_WORD *)(a1 + 642);
    sub_4E684((__int64)v14, v19 + 1);
    v20 = sub_50390(v14);
    sub_4E8A4((__int64)v14, v20);
    sub_4D4A8((__int64)v15, v26);
    v26[0] &= 0x10u;
    sub_4FE4C((__int64)v15, v26[0]);
    sub_4CFEC(v17, v30);
    sub_4FB20((__int64)v15, v30[0]);
    sub_4D0B0((__int64)v17, &v29);
    sub_4FA5C(v15, v29);
    if ( (*(_BYTE *)(v10 + 120) & 0x10) != 0 )
    {
      sub_4FBE4((__int64)v15, *(_DWORD *)(a1 + 440));
      sub_4FCC4((__int64)v15, *(_DWORD *)(a1 + 432));
      *(_DWORD *)(a1 + 436) += v4;
    }
    else
    {
      sub_4D258((__int64)v17, &v31);
      sub_4FBE4((__int64)v15, v31);
      sub_4FCC4((__int64)v15, *(_DWORD *)(a1 + 436));
      *(_DWORD *)(a1 + 432) += v4;
    }
    sub_4BD84(v14, &v25);
    v25 *= 4;
    sub_50E34(*(_QWORD *)(v10 + 16), &v36, &v27);
    v21 = v36;
    if ( v36 )
    {
      if ( v27 >= 0x28u
        && off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_180C0(
          *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
          0x1A6u,
          (__int64)&unk_57D38,
          *(_QWORD *)v10,
          *(unsigned int *)(v10 + 124),
          0,
          *v36,
          v36[1],
          v36[2],
          v36[3],
          v36[4],
          v36[5],
          v36[6],
          v36);
      }
      sub_53BD8(v21, v27, v35, v4);
    }
    *(_QWORD *)(v10 + 220) = 0i64;
    sub_3068C((_QWORD *)v10);
    sub_4B3A0(*(_QWORD *)(v10 + 16), *(_DWORD *)(v10 + 124), (__int64 *)(v10 + 24));
    sub_50870(v10 + 24, 1, 0i64);
    v22 = sub_4535C(0x2013015u);
    v23 = sub_40A2C(40008, (const void *)v10, 0x190u, v22, &v34);
    sub_308B0((_QWORD *)v10);
    sub_3C570(*(PVOID *)(v10 + 16), 0x624E734Eu);
    sub_3C978((__int64)qword_5A8A8, v10);
    if ( v23 )
    {
      v24 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
LABEL_51:
        if ( v24 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v24->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v24->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v24->DeviceLock.Header.Lock, 0x1A8u, (__int64)&unk_57D38);
        }
        return 0i64;
      }
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1A7u, (__int64)&unk_57D38);
    }
    v24 = off_5A148;
    goto LABEL_51;
  }
  if ( (unsigned int)v4 <= 0x1C8 )
    goto LABEL_18;
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_184C0(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1A3u, (__int64)&unk_57D38, v4);
  }
  return 10i64;
}
// 5D418: using guessed type __int64 qword_5D418;

//----- (00000000000242A8) ----------------------------------------------------
__int64 __fastcall sub_242A8(__int64 a1, const void *a2, unsigned int a3)
{
  __int64 v3; // rbx
  size_t v4; // r12
  const void *v5; // rax
  PDEVICE_OBJECT v7; // rcx
  _DWORD *v9; // rax
  __int64 v10; // rdi
  int v11; // eax
  int v12; // ecx
  PVOID v13; // rax
  __int64 v14; // rcx
  unsigned __int16 *v15; // rsi
  _WORD *v16; // r13
  _BYTE *v17; // r14
  _WORD *v18; // r15
  __int64 v19; // rcx
  char *v20; // r11
  int *v21; // rcx
  char *v22; // rdx
  __int64 v23; // rcx
  __int16 v24; // ax
  __int64 v25; // rcx
  unsigned int v26; // edx
  __int16 v27; // dx
  __int16 v28; // ax
  unsigned __int16 v29; // dx
  unsigned __int8 *v30; // rsi
  int v31; // eax
  int v32; // ebx
  PDEVICE_OBJECT v33; // rcx
  char v34[4]; // [rsp+70h] [rbp-C8h] BYREF
  unsigned __int16 v35; // [rsp+74h] [rbp-C4h] BYREF
  unsigned __int16 v36[2]; // [rsp+78h] [rbp-C0h] BYREF
  unsigned __int16 v37; // [rsp+7Ch] [rbp-BCh] BYREF
  unsigned __int16 v38[2]; // [rsp+80h] [rbp-B8h] BYREF
  unsigned int v39; // [rsp+84h] [rbp-B4h] BYREF
  unsigned int v40; // [rsp+88h] [rbp-B0h] BYREF
  int v41; // [rsp+8Ch] [rbp-ACh] BYREF
  const void *v42; // [rsp+90h] [rbp-A8h]
  unsigned __int8 *v43; // [rsp+98h] [rbp-A0h] BYREF
  int v44; // [rsp+A0h] [rbp-98h] BYREF
  __int16 v45; // [rsp+A4h] [rbp-94h]
  char v46[16]; // [rsp+B0h] [rbp-88h] BYREF
  int v47; // [rsp+C0h] [rbp-78h] BYREF
  __int16 v48; // [rsp+C4h] [rbp-74h]
  char v49[16]; // [rsp+D0h] [rbp-68h] BYREF
  __int64 v50; // [rsp+E0h] [rbp-58h] BYREF
  int v51; // [rsp+E8h] [rbp-50h] BYREF
  __int16 v52; // [rsp+ECh] [rbp-4Ch]
  int v53; // [rsp+F0h] [rbp-48h] BYREF
  __int16 v54; // [rsp+F4h] [rbp-44h]

  v3 = *(_QWORD *)(a1 + 672);
  v4 = a3;
  v5 = a2;
  v42 = a2;
  v41 = 0;
  v43 = 0i64;
  v35 = 0;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1A9u, (__int64)&unk_57D38);
    v7 = off_5A148;
    v5 = v42;
  }
  if ( !*(_QWORD *)(a1 + 672) )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1AAu, (__int64)&unk_57D38, a1);
    }
    return 4i64;
  }
  if ( !(_DWORD)v4 )
  {
    if ( !v5 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_4AC00(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1ABu, (__int64)&unk_57D38, 0i64, 0);
      }
      return 4i64;
    }
LABEL_18:
    sub_50E34(*(_QWORD *)(v3 + 16), &v50, v38);
    v9 = sub_3C910((__int64)qword_5A8A8);
    v10 = (__int64)v9;
    if ( !v9 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1ADu, (__int64)&unk_57D38);
      }
      return 3i64;
    }
    *(_QWORD *)(v9 + 55) = 0i64;
    v9[32] = 2;
    v11 = *(_DWORD *)(v3 + 372);
    *(_DWORD *)(v10 + 120) = 0;
    *(_DWORD *)(v10 + 372) = v11;
    if ( *(_DWORD *)(a1 + 124) == 1 )
      *(_DWORD *)(v10 + 120) = 16;
    *(_QWORD *)v10 = _InterlockedIncrement64(&qword_5D418) | 0x8000000000000000ui64;
    *(_QWORD *)(v10 + 8) = MEMORY[0xFFFFF78000000014];
    v12 = *(_DWORD *)(v3 + 124) - v38[0];
    *(_DWORD *)(v10 + 124) = v12;
    v13 = sub_3C4EC(2, v12 + (int)v4, 0x624E734Eu);
    *(_QWORD *)(v10 + 16) = v13;
    if ( !v13 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1AEu, (__int64)&unk_57D38);
      }
      sub_3C978((__int64)qword_5A8A8, v10);
      return 3i64;
    }
    memmove(v13, *(const void **)(v3 + 16), *(unsigned int *)(v10 + 124));
    v14 = *(_QWORD *)(v10 + 16);
    *(_DWORD *)(v10 + 124) += v4;
    v15 = (unsigned __int16 *)sub_4AE28(v14, 1);
    v16 = sub_4AE28(*(_QWORD *)(v10 + 16), 4);
    v17 = sub_4AE28(*(_QWORD *)(v3 + 16), 1);
    v18 = sub_4AE28(*(_QWORD *)(v3 + 16), 4);
    sub_4BAA4(*(_QWORD *)(v3 + 16), (__int64)&v53);
    sub_4BB5C(*(_QWORD *)(v3 + 16), (__int64)&v51);
    if ( ((*(_DWORD *)(v10 + 120) & 0x10) == 0 || (*(_BYTE *)(v3 + 120) & 0x10) == 0)
      && ((*(_DWORD *)(v10 + 120) & 0x10) == 16 || (*(_BYTE *)(v3 + 120) & 0x10) != 0) )
    {
      v44 = v51;
      v23 = *(_QWORD *)(v10 + 16);
      v45 = v52;
      sub_4E3DC(v23, (unsigned __int8 *)&v44);
      v20 = v46;
      v21 = &v53;
      v22 = v46;
    }
    else
    {
      v47 = v53;
      v19 = *(_QWORD *)(v10 + 16);
      v48 = v54;
      sub_4E3DC(v19, (unsigned __int8 *)&v47);
      v20 = v49;
      v21 = &v51;
      v22 = v49;
    }
    *(_DWORD *)v20 = *v21;
    v24 = *((_WORD *)v21 + 2);
    v25 = *(_QWORD *)(v10 + 16);
    *((_WORD *)v20 + 2) = v24;
    sub_4E4D0(v25, (unsigned __int8 *)v22);
    sub_4E5C0((__int64)v15, *(_WORD *)(v10 + 124) - 14);
    sub_4E800((__int64)v15);
    sub_4C138((__int64)v17, &v40);
    sub_4C1E8((__int64)v17, &v39);
    if ( ((*(_DWORD *)(v10 + 120) & 0x10) == 0 || (*(_BYTE *)(v3 + 120) & 0x10) == 0)
      && ((*(_DWORD *)(v10 + 120) & 0x10) == 16 || (*(_BYTE *)(v3 + 120) & 0x10) != 0) )
    {
      sub_4E968((__int64)v15, v39);
      v26 = v40;
    }
    else
    {
      sub_4E968((__int64)v15, v40);
      v26 = v39;
    }
    sub_4EA38((__int64)v15, v26);
    if ( (*(_BYTE *)(v3 + 120) & 0x10) != 0 )
      v27 = *(_WORD *)(a1 + 640);
    else
      v27 = *(_WORD *)(a1 + 642);
    sub_4E684((__int64)v15, v27 + 1);
    v28 = sub_50390(v15);
    sub_4E8A4((__int64)v15, v28);
    sub_4E0CC(v18, v36);
    sub_4E190((__int64)v18, &v37);
    if ( ((*(_DWORD *)(v10 + 120) & 0x10) == 0 || (*(_BYTE *)(v3 + 120) & 0x10) == 0)
      && ((*(_DWORD *)(v10 + 120) & 0x10) == 16 || (*(_BYTE *)(v3 + 120) & 0x10) != 0) )
    {
      sub_50080(v16, v37);
      v29 = v36[0];
    }
    else
    {
      sub_50080(v16, v36[0]);
      v29 = v37;
    }
    sub_50144((__int64)v16, v29);
    sub_50208((__int64)v16, v4 + 8);
    sub_4BD84(v15, v34);
    v34[0] *= 4;
    sub_50E34(*(_QWORD *)(v10 + 16), &v43, &v35);
    v30 = v43;
    if ( v43 )
    {
      if ( v35 >= 0x28u
        && off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_180C0(
          *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
          0x1AFu,
          (__int64)&unk_57D38,
          *(_QWORD *)v10,
          *(unsigned int *)(v10 + 124),
          0,
          *v43,
          v43[1],
          v43[2],
          v43[3],
          v43[4],
          v43[5],
          v43[6],
          v43);
      }
      sub_53BD8(v30, v35, v42, v4);
    }
    *(_QWORD *)(v10 + 220) = 0i64;
    sub_3068C((_QWORD *)v10);
    sub_4B3A0(*(_QWORD *)(v10 + 16), *(_DWORD *)(v10 + 124), (__int64 *)(v10 + 24));
    sub_50870(v10 + 24, 1, 0i64);
    v31 = sub_4535C(0x2013015u);
    v32 = sub_40A2C(40008, (const void *)v10, 0x190u, v31, &v41);
    sub_308B0((_QWORD *)v10);
    sub_3C570(*(PVOID *)(v10 + 16), 0x624E734Eu);
    sub_3C978((__int64)qword_5A8A8, v10);
    if ( v32 )
    {
      v33 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
LABEL_66:
        if ( v33 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v33->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v33->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v33->DeviceLock.Header.Lock, 0x1B1u, (__int64)&unk_57D38);
        }
        return 0i64;
      }
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1B0u, (__int64)&unk_57D38);
    }
    v33 = off_5A148;
    goto LABEL_66;
  }
  if ( (unsigned int)v4 <= 0x200 )
    goto LABEL_18;
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_184C0(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1ACu, (__int64)&unk_57D38, v4);
  }
  return 10i64;
}
// 5D418: using guessed type __int64 qword_5D418;

//----- (0000000000024A30) ----------------------------------------------------
__int64 __fastcall sub_24A30(__int64 a1, const void *a2, unsigned int a3)
{
  __int64 v3; // r13
  size_t v4; // r12
  PDEVICE_OBJECT v7; // rcx
  _DWORD *v9; // rax
  __int64 v10; // rsi
  int v11; // eax
  PVOID v12; // rax
  __int64 v13; // rcx
  _BYTE *v14; // rdi
  _BYTE *v15; // rax
  __int64 v16; // rcx
  __int64 v17; // rbx
  _WORD *v18; // r14
  __int64 v19; // rcx
  __int16 v20; // ax
  __int64 v21; // rbx
  _WORD *v22; // rcx
  unsigned __int8 *v23; // rdi
  int v24; // eax
  int v25; // ebx
  PDEVICE_OBJECT v26; // rcx
  __int16 v27[8]; // [rsp+70h] [rbp-C8h] BYREF
  unsigned __int16 v28[2]; // [rsp+80h] [rbp-B8h] BYREF
  unsigned __int16 v29; // [rsp+84h] [rbp-B4h] BYREF
  int v30; // [rsp+88h] [rbp-B0h] BYREF
  int v31; // [rsp+8Ch] [rbp-ACh] BYREF
  int v32; // [rsp+90h] [rbp-A8h] BYREF
  unsigned __int8 *v33; // [rsp+98h] [rbp-A0h] BYREF
  int v34; // [rsp+A0h] [rbp-98h] BYREF
  __int16 v35; // [rsp+A4h] [rbp-94h]
  int v36; // [rsp+B0h] [rbp-88h] BYREF
  __int16 v37; // [rsp+B4h] [rbp-84h]
  _WORD *v38; // [rsp+C0h] [rbp-78h]
  int v39; // [rsp+C8h] [rbp-70h] BYREF
  __int16 v40; // [rsp+CCh] [rbp-6Ch]
  int v41; // [rsp+D0h] [rbp-68h] BYREF
  __int16 v42; // [rsp+D4h] [rbp-64h]
  __m128i v43; // [rsp+D8h] [rbp-60h] BYREF
  __m128i v44; // [rsp+E8h] [rbp-50h] BYREF

  v3 = *(_QWORD *)(a1 + 672);
  v4 = a3;
  v30 = 0;
  v32 = 0;
  v33 = 0i64;
  v27[0] = 0;
  v31 = 0;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1B2u, (__int64)&unk_57D38);
    v7 = off_5A148;
  }
  if ( !*(_QWORD *)(a1 + 672) )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1B3u, (__int64)&unk_57D38, a1);
    }
    return 4i64;
  }
  if ( !(_DWORD)v4 )
  {
    if ( !a2 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_4AC00(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1B4u, (__int64)&unk_57D38, 0i64, 0);
      }
      return 4i64;
    }
LABEL_18:
    v9 = sub_3C910((__int64)qword_5A8A8);
    v10 = (__int64)v9;
    if ( !v9 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1B6u, (__int64)&unk_57D38);
      }
      return 3i64;
    }
    *(_QWORD *)(v9 + 55) = 0i64;
    v9[32] = 2;
    v9[93] = *(_DWORD *)(v3 + 372);
    v9[30] = 0;
    if ( (*(_BYTE *)(v3 + 120) & 0x10) == 0 )
      v9[30] = 16;
    *(_QWORD *)v9 = _InterlockedIncrement64(&qword_5D418) | 0x8000000000000000ui64;
    *((_QWORD *)v9 + 1) = MEMORY[0xFFFFF78000000014];
    v11 = *(_DWORD *)(v3 + 124) - *(_DWORD *)(v3 + 108);
    *(_DWORD *)(v10 + 124) = v11;
    v12 = sub_3C4EC(2, v11 + (int)v4, 0x624E734Eu);
    *(_QWORD *)(v10 + 16) = v12;
    if ( !v12 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1B7u, (__int64)&unk_57D38);
      }
      sub_3C978((__int64)qword_5A8A8, v10);
      return 3i64;
    }
    memmove(v12, *(const void **)(v3 + 16), *(unsigned int *)(v10 + 124));
    v13 = *(_QWORD *)(v10 + 16);
    *(_DWORD *)(v10 + 124) += v4;
    v14 = sub_4AE28(v13, 2);
    v15 = sub_4AE28(*(_QWORD *)(v10 + 16), 3);
    v16 = *(_QWORD *)(v3 + 16);
    v17 = *(_QWORD *)(v3 + 48);
    v18 = v15;
    v38 = *(_WORD **)(v3 + 56);
    sub_4BAA4(v16, (__int64)&v39);
    v34 = v39;
    v35 = v40;
    sub_4E4D0(*(_QWORD *)(v10 + 16), (unsigned __int8 *)&v34);
    sub_4BB5C(*(_QWORD *)(v3 + 16), (__int64)&v41);
    v36 = v41;
    v19 = *(_QWORD *)(v10 + 16);
    v37 = v42;
    sub_4E3DC(v19, (unsigned __int8 *)&v36);
    sub_4F544((__int64)v14, &v31);
    v20 = v31 + *(_WORD *)(v3 + 104) - *(_WORD *)(v3 + 108);
    v14[6] = 6;
    v27[4] = v4 + v20;
    *((_WORD *)v14 + 2) = _byteswap_ushort(v4 + v20);
    sub_4C970(v17, &v43);
    *(__m128i *)(v14 + 24) = _mm_loadu_si128(&v43);
    sub_4CA24(v17, &v44);
    v21 = (__int64)v38;
    v22 = v38;
    *(__m128i *)(v14 + 8) = _mm_loadu_si128(&v44);
    sub_4CFEC(v22, v28);
    sub_4FB20((__int64)v18, v28[0]);
    sub_4D0B0(v21, &v29);
    sub_4FA5C(v18, v29);
    if ( (*(_BYTE *)(v10 + 120) & 0x10) != 0 )
    {
      sub_4FBE4((__int64)v18, *(_DWORD *)(a1 + 440));
      sub_4FCC4((__int64)v18, *(_DWORD *)(a1 + 432));
      *(_DWORD *)(a1 + 436) += v4;
    }
    else
    {
      sub_4D258(v21, &v30);
      sub_4FBE4((__int64)v18, v30);
      sub_4FCC4((__int64)v18, *(_DWORD *)(a1 + 436));
      *(_DWORD *)(a1 + 432) += v4;
    }
    sub_50E34(*(_QWORD *)(v10 + 16), &v33, v27);
    v23 = v33;
    if ( v33 )
    {
      if ( v27[0] >= 0x28u
        && off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_180C0(
          *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
          0x1B8u,
          (__int64)&unk_57D38,
          *(_QWORD *)v10,
          *(unsigned int *)(v10 + 124),
          0,
          *v33,
          v33[1],
          v33[2],
          v33[3],
          v33[4],
          v33[5],
          v33[6],
          v33);
      }
      sub_53BD8(v23, (unsigned __int16)v27[0], a2, v4);
    }
    sub_4B3A0(*(_QWORD *)(v10 + 16), *(_DWORD *)(v10 + 124), (__int64 *)(v10 + 24));
    sub_50870(v10 + 24, 1, 0i64);
    *(_QWORD *)(v10 + 220) = 0i64;
    sub_3068C((_QWORD *)v10);
    v24 = sub_4535C(0x2013015u);
    v25 = sub_40A2C(40008, (const void *)v10, 0x190u, v24, &v32);
    sub_308B0((_QWORD *)v10);
    sub_3C570(*(PVOID *)(v10 + 16), 0x624E734Eu);
    sub_3C978((__int64)qword_5A8A8, v10);
    if ( v25 )
    {
      v26 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
LABEL_48:
        if ( v26 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v26->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v26->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v26->DeviceLock.Header.Lock, 0x1BAu, (__int64)&unk_57D38);
        }
        return 0i64;
      }
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1B9u, (__int64)&unk_57D38);
    }
    v26 = off_5A148;
    goto LABEL_48;
  }
  if ( (unsigned int)v4 <= 0x1C8 )
    goto LABEL_18;
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_184C0(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1B5u, (__int64)&unk_57D38, v4);
  }
  return 10i64;
}
// 5D418: using guessed type __int64 qword_5D418;

//----- (0000000000025110) ----------------------------------------------------
__int64 __fastcall sub_25110(__int64 a1, const void *a2, unsigned int a3)
{
  __int64 v3; // rbx
  size_t v4; // r12
  PDEVICE_OBJECT v7; // rcx
  _DWORD *v9; // rax
  __int64 v10; // rdi
  int v11; // eax
  PVOID v12; // rax
  __int64 v13; // rcx
  _BYTE *v14; // rbp
  _BYTE *v15; // rax
  __int64 v16; // r14
  _WORD *v17; // r13
  _WORD *v18; // rsi
  __int64 v19; // rcx
  char *v20; // r11
  int *v21; // rcx
  char *v22; // rdx
  __int64 v23; // rcx
  __int16 v24; // ax
  __int64 v25; // rcx
  __int16 v26; // ax
  __m128i v27; // xmm1
  unsigned __int16 v28; // dx
  unsigned __int8 *v29; // rsi
  int v30; // eax
  int v31; // ebx
  PDEVICE_OBJECT v32; // rcx
  unsigned __int16 v33[2]; // [rsp+70h] [rbp-E8h] BYREF
  unsigned __int16 v34; // [rsp+74h] [rbp-E4h] BYREF
  unsigned __int16 v35[8]; // [rsp+78h] [rbp-E0h] BYREF
  int v36; // [rsp+88h] [rbp-D0h] BYREF
  int v37; // [rsp+8Ch] [rbp-CCh] BYREF
  unsigned __int8 *v38; // [rsp+90h] [rbp-C8h] BYREF
  char v39[16]; // [rsp+A0h] [rbp-B8h] BYREF
  int v40; // [rsp+B0h] [rbp-A8h] BYREF
  __int16 v41; // [rsp+B4h] [rbp-A4h]
  int v42; // [rsp+C0h] [rbp-98h] BYREF
  __int16 v43; // [rsp+C4h] [rbp-94h]
  char v44[16]; // [rsp+D0h] [rbp-88h] BYREF
  int v45; // [rsp+E0h] [rbp-78h] BYREF
  __int16 v46; // [rsp+E4h] [rbp-74h]
  int v47; // [rsp+E8h] [rbp-70h] BYREF
  __int16 v48; // [rsp+ECh] [rbp-6Ch]
  __m128i v49; // [rsp+F0h] [rbp-68h] BYREF
  __m128i v50; // [rsp+100h] [rbp-58h] BYREF

  v3 = *(_QWORD *)(a1 + 672);
  v4 = a3;
  v37 = 0;
  v38 = 0i64;
  v33[0] = 0;
  v36 = 0;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1BBu, (__int64)&unk_57D38);
    v7 = off_5A148;
  }
  if ( !*(_QWORD *)(a1 + 672) )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1BCu, (__int64)&unk_57D38, a1);
    }
    return 4i64;
  }
  if ( !(_DWORD)v4 )
  {
    if ( !a2 )
    {
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_4AC00(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1BDu, (__int64)&unk_57D38, 0i64, 0);
      }
      return 4i64;
    }
LABEL_18:
    v9 = sub_3C910((__int64)qword_5A8A8);
    v10 = (__int64)v9;
    if ( !v9 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1BFu, (__int64)&unk_57D38);
      }
      return 3i64;
    }
    *(_QWORD *)(v9 + 55) = 0i64;
    v9[32] = 2;
    v9[93] = *(_DWORD *)(v3 + 372);
    v9[30] = 0;
    if ( *(_DWORD *)(a1 + 124) == 1 )
      v9[30] = 16;
    *(_QWORD *)v9 = _InterlockedIncrement64(&qword_5D418) | 0x8000000000000000ui64;
    *((_QWORD *)v9 + 1) = MEMORY[0xFFFFF78000000014];
    v11 = *(_DWORD *)(v3 + 124) - *(_DWORD *)(v3 + 108);
    *(_DWORD *)(v10 + 124) = v11;
    v12 = sub_3C4EC(2, v11 + (int)v4, 0x624E734Eu);
    *(_QWORD *)(v10 + 16) = v12;
    if ( !v12 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1C0u, (__int64)&unk_57D38);
      }
      sub_3C978((__int64)qword_5A8A8, v10);
      return 3i64;
    }
    memmove(v12, *(const void **)(v3 + 16), *(unsigned int *)(v10 + 124));
    v13 = *(_QWORD *)(v10 + 16);
    *(_DWORD *)(v10 + 124) += v4;
    v14 = sub_4AE28(v13, 2);
    v15 = sub_4AE28(*(_QWORD *)(v10 + 16), 4);
    v16 = *(_QWORD *)(v3 + 48);
    v17 = *(_WORD **)(v3 + 64);
    v18 = v15;
    sub_4BAA4(*(_QWORD *)(v3 + 16), (__int64)&v45);
    sub_4BB5C(*(_QWORD *)(v3 + 16), (__int64)&v47);
    if ( ((*(_DWORD *)(v10 + 120) & 0x10) == 0 || (*(_BYTE *)(v3 + 120) & 0x10) == 0)
      && ((*(_DWORD *)(v10 + 120) & 0x10) == 16 || (*(_BYTE *)(v3 + 120) & 0x10) != 0) )
    {
      v40 = v47;
      v23 = *(_QWORD *)(v10 + 16);
      v41 = v48;
      sub_4E3DC(v23, (unsigned __int8 *)&v40);
      v20 = v44;
      v21 = &v45;
      v22 = v44;
    }
    else
    {
      v42 = v45;
      v19 = *(_QWORD *)(v10 + 16);
      v43 = v46;
      sub_4E3DC(v19, (unsigned __int8 *)&v42);
      v20 = v39;
      v21 = &v47;
      v22 = v39;
    }
    *(_DWORD *)v20 = *v21;
    v24 = *((_WORD *)v21 + 2);
    v25 = *(_QWORD *)(v10 + 16);
    *((_WORD *)v20 + 2) = v24;
    sub_4E4D0(v25, (unsigned __int8 *)v22);
    sub_4F544((__int64)v14, &v36);
    v26 = v36 + *(_WORD *)(v3 + 104) - *(_WORD *)(v3 + 108);
    v14[6] = 17;
    v35[4] = v4 + v26;
    *((_WORD *)v14 + 2) = _byteswap_ushort(v4 + v26);
    sub_4C970(v16, &v50);
    sub_4CA24(v16, &v49);
    if ( ((*(_DWORD *)(v10 + 120) & 0x10) == 0 || (*(_BYTE *)(v3 + 120) & 0x10) == 0)
      && ((*(_DWORD *)(v10 + 120) & 0x10) == 16 || (*(_BYTE *)(v3 + 120) & 0x10) != 0) )
    {
      *(__m128i *)(v14 + 8) = _mm_loadu_si128(&v49);
      v27 = _mm_loadu_si128(&v50);
    }
    else
    {
      *(__m128i *)(v14 + 8) = _mm_loadu_si128(&v50);
      v27 = _mm_loadu_si128(&v49);
    }
    *(__m128i *)(v14 + 24) = v27;
    sub_4E0CC(v17, &v34);
    sub_4E190((__int64)v17, v35);
    if ( ((*(_DWORD *)(v10 + 120) & 0x10) == 0 || (*(_BYTE *)(v3 + 120) & 0x10) == 0)
      && ((*(_DWORD *)(v10 + 120) & 0x10) == 16 || (*(_BYTE *)(v3 + 120) & 0x10) != 0) )
    {
      sub_50080(v18, v35[0]);
      v28 = v34;
    }
    else
    {
      sub_50080(v18, v34);
      v28 = v35[0];
    }
    sub_50144((__int64)v18, v28);
    sub_50208((__int64)v18, v4 + 8);
    sub_50E34(*(_QWORD *)(v10 + 16), &v38, v33);
    v29 = v38;
    if ( v38 )
    {
      if ( v33[0] >= 0x28u
        && off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_180C0(
          *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
          0x1C1u,
          (__int64)&unk_57D38,
          *(_QWORD *)v10,
          *(unsigned int *)(v10 + 124),
          0,
          *v38,
          v38[1],
          v38[2],
          v38[3],
          v38[4],
          v38[5],
          v38[6],
          v38);
      }
      sub_53BD8(v29, v33[0], a2, v4);
    }
    sub_4B3A0(*(_QWORD *)(v10 + 16), *(_DWORD *)(v10 + 124), (__int64 *)(v10 + 24));
    sub_50870(v10 + 24, 1, 0i64);
    *(_QWORD *)(v10 + 220) = 0i64;
    sub_3068C((_QWORD *)v10);
    v30 = sub_4535C(0x2013015u);
    v31 = sub_40A2C(40008, (const void *)v10, 0x190u, v30, &v37);
    sub_308B0((_QWORD *)v10);
    sub_3C570(*(PVOID *)(v10 + 16), 0x624E734Eu);
    sub_3C978((__int64)qword_5A8A8, v10);
    if ( v31 )
    {
      v32 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
LABEL_63:
        if ( v32 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v32->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
          && BYTE1(v32->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v32->DeviceLock.Header.Lock, 0x1C3u, (__int64)&unk_57D38);
        }
        return 0i64;
      }
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1C2u, (__int64)&unk_57D38);
    }
    v32 = off_5A148;
    goto LABEL_63;
  }
  if ( (unsigned int)v4 <= 0x200 )
    goto LABEL_18;
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_184C0(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x1BEu, (__int64)&unk_57D38, v4);
  }
  return 10i64;
}
// 5D418: using guessed type __int64 qword_5D418;

//----- (0000000000025844) ----------------------------------------------------
__int64 __fastcall sub_25844(__int64 a1)
{
  __int64 v2; // rbx
  __int64 result; // rax
  int v4; // [rsp+48h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+50h] [rbp+18h] BYREF

  v4 = 0;
  BugCheckParameter1 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1C4u, (__int64)&unk_57D38);
  }
  KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
  v2 = sub_49034(qword_5A8C0, *(_QWORD *)a1, &BugCheckParameter1, &v4);
  if ( v2 )
  {
    KeReleaseMutex(&Mutex, 0);
    KeWaitForSingleObject(*(PVOID *)(v2 + 8), Executive, 0, 0, 0i64);
    if ( *(_BYTE *)(a1 + 20) )
    {
      *(_DWORD *)(v2 + 68) = *(_DWORD *)(a1 + 8);
      *(_BYTE *)(v2 + 60) = *(_BYTE *)(a1 + 12);
      *(_DWORD *)(v2 + 64) = *(_DWORD *)(a1 + 16);
    }
    else
    {
      *(_DWORD *)(a1 + 8) = *(_DWORD *)(v2 + 68);
      *(_BYTE *)(a1 + 12) = *(_BYTE *)(v2 + 60);
      *(_DWORD *)(a1 + 16) = *(_DWORD *)(v2 + 64);
    }
    KeReleaseMutex(*(PRKMUTEX *)(v2 + 8), 0);
    if ( BugCheckParameter1 )
      sub_49CF0(qword_5A8C0, BugCheckParameter1);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1C6u, (__int64)&unk_57D38);
    }
    result = 0i64;
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1C5u, (__int64)&unk_57D38);
    }
    KeReleaseMutex(&Mutex, 0);
    result = 5i64;
  }
  return result;
}

//----- (00000000000259F0) ----------------------------------------------------
__int64 __fastcall sub_259F0(__int64 a1, __int64 a2)
{
  __int64 v2; // rsi
  __int64 v3; // r15
  unsigned int v4; // ebp
  int v5; // eax
  __int64 v6; // rcx
  char *v7; // rdx
  bool v8; // al
  __int64 v9; // rcx
  PDEVICE_OBJECT v10; // rcx
  PDEVICE_OBJECT v11; // rax
  char *v12; // rdx
  _WORD *v13; // rcx
  PDEVICE_OBJECT v14; // rcx
  __int64 v16; // [rsp+F0h] [rbp+8h]
  __int64 v17; // [rsp+F8h] [rbp+10h]
  unsigned __int16 v18; // [rsp+100h] [rbp+18h] BYREF
  unsigned int v19; // [rsp+108h] [rbp+20h]

  v17 = a2;
  v16 = a1;
  v2 = a2;
  v3 = a1;
  v4 = 0;
  v18 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1C7u, (__int64)&unk_57D38);
  }
  if ( !(unsigned int)sub_4BC10(*(_QWORD *)(v2 + 24), &v18) )
  {
    v5 = 2048;
    if ( v18 != 2048 )
    {
      switch ( v18 )
      {
        case 0x806u:
          v5 = 2054;
          break;
        case 0x8035u:
          v5 = 32821;
          break;
        case 0x86DDu:
          v5 = 34525;
          break;
        default:
          v5 = 0;
          break;
      }
    }
    *(_DWORD *)(v3 + 16) = v5;
  }
  *(_DWORD *)(v3 + 124) = ((*(_BYTE *)(v2 + 120) & 0x10) == 16) + 1;
  v6 = *(_QWORD *)(v2 + 40);
  if ( v6 )
  {
    if ( (unsigned int)sub_4C138(v6, (_DWORD *)(v3 + 88))
      && off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1C8u, (__int64)&unk_57D38);
    }
    v4 = sub_4C1E8(*(_QWORD *)(v2 + 40), (_DWORD *)(v3 + 104));
    v19 = v4;
    if ( v4 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1C9u, (__int64)&unk_57D38);
      }
    }
    else if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
           || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
           || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      v4 = 0;
    }
    else
    {
      sub_186B8(
        *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
        458i64,
        (__int64)&unk_57D38,
        *(unsigned __int8 *)(v3 + 88));
      v4 = v19;
    }
    if ( *(_DWORD *)(v3 + 124) == 2 )
      v7 = (char *)(v3 + 104);
    else
      v7 = (char *)(v3 + 88);
    v8 = sub_51C84(4, v7);
LABEL_57:
    *(_BYTE *)(v3 + 120) = !v8;
    goto LABEL_58;
  }
  v9 = *(_QWORD *)(v2 + 48);
  if ( !v9 )
  {
LABEL_58:
    v10 = off_5A148;
    goto LABEL_59;
  }
  if ( (unsigned int)sub_4C970(v9, (__m128i *)(v3 + 88))
    && off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1CBu, (__int64)&unk_57D38);
  }
  v4 = sub_4CA24(*(_QWORD *)(v2 + 48), (__m128i *)(v3 + 104));
  v19 = v4;
  if ( !v4 )
  {
    v11 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        v3 = v16;
        sub_17AC4(
          *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
          0x1CDu,
          (__int64)&unk_57D38,
          *(unsigned __int8 *)(v16 + 88));
        v11 = off_5A148;
      }
      if ( v11 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v11->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        v3 = v16;
        sub_17AC4(
          *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
          0x1CEu,
          (__int64)&unk_57D38,
          *(unsigned __int8 *)(v16 + 104));
      }
    }
    v12 = (char *)(v3 + 104);
    if ( *(_DWORD *)(v3 + 124) != 2 )
      v12 = (char *)(v3 + 88);
    v8 = sub_51C84(6, v12);
    v4 = v19;
    v2 = v17;
    goto LABEL_57;
  }
  v10 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1CCu, (__int64)&unk_57D38);
    goto LABEL_58;
  }
LABEL_59:
  if ( *(_QWORD *)(v2 + 24) )
  {
    sub_4BAA4(*(_QWORD *)(v2 + 24), v3 + 76);
    sub_4BB5C(*(_QWORD *)(v2 + 24), v3 + 82);
  }
  else if ( v10 != (PDEVICE_OBJECT)&off_5A148
         && (BYTE4(v10->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
         && BYTE1(v10->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v10->DeviceLock.Header.Lock, 0x1CFu, (__int64)&unk_57D38);
  }
  *(_DWORD *)(v3 + 20) = *(_DWORD *)(v2 + 328);
  v13 = *(_WORD **)(v2 + 56);
  if ( v13 )
  {
    sub_4CFEC(v13, (_WORD *)(v3 + 72));
    sub_4D0B0(*(_QWORD *)(v2 + 56), (_WORD *)(v3 + 74));
    v14 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_184C0(
        *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
        0x1D0u,
        (__int64)&unk_57D38,
        *(unsigned __int16 *)(v3 + 72));
      v14 = off_5A148;
    }
  }
  else
  {
    v14 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1D1u, (__int64)&unk_57D38);
      v14 = off_5A148;
    }
  }
  if ( *(_QWORD *)(v2 + 64) )
  {
    sub_4E0CC(*(_WORD **)(v2 + 64), (_WORD *)(v3 + 72));
    sub_4E190(*(_QWORD *)(v2 + 64), (_WORD *)(v3 + 74));
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_184C0(
        *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
        0x1D2u,
        (__int64)&unk_57D38,
        *(unsigned __int16 *)(v3 + 72));
    }
  }
  else if ( v14 != (PDEVICE_OBJECT)&off_5A148
         && (BYTE4(v14->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
         && BYTE1(v14->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v14->DeviceLock.Header.Lock, 0x1D3u, (__int64)&unk_57D38);
  }
  *(_DWORD *)(v3 + 24) = *(_DWORD *)(v2 + 332);
  if ( _bittest((const signed __int32 *)(v2 + 120), 9u) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1D4u, (__int64)&unk_57D38);
    }
    *(_BYTE *)(v3 + 121) = 1;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1D5u, (__int64)&unk_57D38);
  }
  return v4;
}

//----- (0000000000026174) ----------------------------------------------------
__int64 __fastcall sub_26174(__int64 a1)
{
  __int64 v2; // rdi
  __int64 result; // rax
  ULONG_PTR v4; // rdx
  int v5; // [rsp+48h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+50h] [rbp+18h] BYREF

  v5 = 0;
  BugCheckParameter1 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1D6u, (__int64)&unk_57D38);
  }
  KeWaitForSingleObject(&Mutex, Executive, 0, 0, 0i64);
  v2 = sub_49034(qword_5A8C0, *(_QWORD *)a1, &BugCheckParameter1, &v5);
  if ( v2 )
  {
    KeReleaseMutex(&Mutex, 0);
    v4 = BugCheckParameter1;
    *(_DWORD *)(a1 + 88) = *(_DWORD *)(v2 + 24);
    *(_DWORD *)(a1 + 8) = *(_DWORD *)(v2 + 16);
    *(_WORD *)(a1 + 12) = *(_WORD *)(v2 + 72);
    *(_WORD *)(a1 + 14) = *(_WORD *)(v2 + 74);
    *(_BYTE *)(a1 + 61) = *(_BYTE *)(v2 + 121);
    *(_BYTE *)(a1 + 60) = *(_BYTE *)(v2 + 120);
    *(_QWORD *)(a1 + 64) = *(_QWORD *)(v2 + 32);
    *(_QWORD *)(a1 + 72) = *(_QWORD *)(v2 + 40);
    *(_DWORD *)(a1 + 84) = *(_DWORD *)(v2 + 20);
    *(_DWORD *)(a1 + 80) = *(_DWORD *)(v2 + 124);
    *(_DWORD *)(a1 + 16) = *(_DWORD *)(v2 + 76);
    *(_WORD *)(a1 + 20) = *(_WORD *)(v2 + 80);
    *(_DWORD *)(a1 + 22) = *(_DWORD *)(v2 + 82);
    *(_WORD *)(a1 + 26) = *(_WORD *)(v2 + 86);
    *(__m128i *)(a1 + 28) = _mm_loadu_si128((const __m128i *)(v2 + 88));
    *(__m128i *)(a1 + 44) = _mm_loadu_si128((const __m128i *)(v2 + 104));
    if ( v4 )
      sub_49CF0(qword_5A8C0, v4);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1D8u, (__int64)&unk_57D38);
    }
    result = 0i64;
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1D7u, (__int64)&unk_57D38);
    }
    KeReleaseMutex(&Mutex, 0);
    result = 5i64;
  }
  return result;
}

//----- (0000000000026348) ----------------------------------------------------
__int64 __fastcall sub_26348(ULONG_PTR BugCheckParameter2, __int64 a2, ULONG_PTR a3, __int64 a4, int a5, char a6, char a7, __int64 a8)
{
  int v12; // eax
  __int64 v13; // r8
  int v14; // ebx
  PDEVICE_OBJECT v15; // rcx
  unsigned __int64 v16; // rbx
  __int64 v18; // [rsp+20h] [rbp-38h]
  int v19; // [rsp+20h] [rbp-38h]
  int v20[10]; // [rsp+30h] [rbp-28h] BYREF

  v20[0] = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1DDu, (__int64)&unk_57D38);
  }
  *(_BYTE *)a8 = 0;
  v12 = sub_1C45C(a2, a4, a5, a6);
  v14 = v12;
  v15 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    v19 = v12;
    sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1DEu, (__int64)&unk_57D38, *(_QWORD *)a2, v19);
    v15 = off_5A148;
  }
  if ( v14 == 2 )
  {
    v16 = *(_QWORD *)a2;
    if ( a7 )
    {
      KeReleaseMutex(*(PRKMUTEX *)(a2 + 8), 0);
      sub_49CF0(BugCheckParameter2, a3);
    }
    LOBYTE(v13) = 1;
    sub_48B2C(BugCheckParameter2, v16, v13, v20);
    if ( v20[0] )
    {
      v15 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        goto LABEL_18;
      }
      LODWORD(v18) = v20[0];
      sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1DFu, (__int64)&unk_57D38, v16, v18);
    }
    v15 = off_5A148;
LABEL_18:
    *(_BYTE *)a8 = 1;
  }
  if ( v15 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v15->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v15->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v15->DeviceLock.Header.Lock, 0x1E1u, (__int64)&unk_57D38);
  }
  return 0i64;
}
// 26458: variable 'v13' is possibly undefined
// 264A0: variable 'v18' is possibly undefined

//----- (0000000000026500) ----------------------------------------------------
__int64 __fastcall sub_26500(ULONG_PTR BugCheckParameter2, __int64 a2, ULONG_PTR a3, __int64 a4, char a5, int a6, char a7, __int64 a8)
{
  int v11; // eax
  unsigned int v12; // ebx
  PDEVICE_OBJECT v13; // rcx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1E2u, (__int64)&unk_57D38);
  }
  *(_BYTE *)a8 = 0;
  v11 = sub_26B9C((__int64 *)a2);
  v12 = v11;
  if ( !v11 )
  {
    if ( !*(_BYTE *)(a2 + 58) )
      sub_26348(BugCheckParameter2, a2, a3, 0i64, *(_DWORD *)(a2 + 24), a5, a7, a8);
    goto LABEL_12;
  }
  v13 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v12;
  if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1E3u, (__int64)&unk_57D38, v11);
LABEL_12:
    v13 = off_5A148;
  }
  if ( v13 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v13->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v13->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v13->DeviceLock.Header.Lock, 0x1E4u, (__int64)&unk_57D38);
  }
  return v12;
}

//----- (0000000000026644) ----------------------------------------------------
__int64 __fastcall sub_26644(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v6; // rcx
  __int64 v7; // rax
  int v8; // edx
  __int64 v9; // rax
  int v11; // [rsp+30h] [rbp+8h] BYREF

  v11 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1E5u, (__int64)&unk_57D38);
  }
  v6 = *(_QWORD *)(a3 + 672);
  if ( v6 )
    sub_4D174(*(_QWORD *)(v6 + 56), &v11);
  if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
  {
    sub_4FCC4(a2, 0);
    if ( *(_BYTE *)(a3 + 648) && (v7 = *(_QWORD *)(a3 + 672)) != 0 && (*(_BYTE *)(v7 + 120) & 0x10) != 0 )
      v8 = v11;
    else
      v8 = *(_DWORD *)(a3 + 440);
  }
  else
  {
    sub_4FCC4(a2, 0);
    if ( !*(_BYTE *)(a3 + 648) || (v9 = *(_QWORD *)(a3 + 672)) == 0 || (v8 = v11, (*(_BYTE *)(v9 + 120) & 0x10) != 0) )
      v8 = *(_DWORD *)(a3 + 444);
  }
  sub_4FBE4(a2, v8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1E6u, (__int64)&unk_57D38);
  }
  return 0i64;
}

//----- (000000000002677C) ----------------------------------------------------
__int64 __fastcall sub_2677C(_QWORD *a1, ULONG_PTR a2, ULONG_PTR a3, _QWORD *a4, int a5, _BYTE *a6)
{
  unsigned int v10; // ebp
  PDEVICE_OBJECT v11; // r10
  _BYTE *v12; // rdi
  const char *v13; // r9
  struct _KMUTANT *v15; // rcx
  const char *v16; // rax
  __int64 v17; // r10
  int v18; // er11
  PDEVICE_OBJECT v19; // rcx
  unsigned int v20; // eax
  unsigned int v21; // eax
  int v22; // eax
  __int64 v23; // [rsp+28h] [rbp-40h]
  __int64 v24; // [rsp+70h] [rbp+8h] BYREF

  v10 = 0;
  LOBYTE(v24) = 0;
  v11 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1E7u, (__int64)&unk_57D38);
    v11 = off_5A148;
  }
  v12 = a6;
  *a6 = 0;
  if ( v11 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v11->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
    && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    v13 = "Non-DS";
    if ( *((_BYTE *)a1 + 58) )
      v13 = (const char *)qword_567C0;
    v23 = a1[49];
    sub_18848(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x1E8u, (__int64)&unk_57D38, v13);
    v11 = off_5A148;
  }
  if ( *((_BYTE *)a1 + 58) )
  {
    if ( *((_BYTE *)a1 + 424) )
    {
      if ( v11 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v11->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
        && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x1E9u, (__int64)&unk_57D38);
      }
      *v12 = 1;
    }
    return 0i64;
  }
  if ( *((_BYTE *)a1 + 424) )
  {
    if ( v11 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v11->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
      && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x1EAu, (__int64)&unk_57D38);
    }
    v15 = (struct _KMUTANT *)a1[1];
    *v12 = 1;
    KeReleaseMutex(v15, 0);
    sub_49CF0(a3, a2);
    return 0i64;
  }
  if ( v11 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v11->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
    && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    v16 = sub_4A760(*((_DWORD *)a1 + 105));
    sub_182DC(*(_QWORD *)(v17 + 280), 0x1EBu, (__int64)&unk_57D38, *a1, v16);
  }
  sub_26E24((__int64)a4, (_DWORD *)a1 + 173);
  v18 = *((_DWORD *)a1 + 105);
  if ( v18 != 4 && v18 != 2 )
  {
    v19 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_184C0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1ECu, (__int64)&unk_57D38, *((_DWORD *)a1 + 173));
        v19 = off_5A148;
      }
      if ( v19 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v19->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
        && BYTE1(v19->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_184C0(*(_QWORD *)&v19->DeviceLock.Header.Lock, 0x1EDu, (__int64)&unk_57D38, *((_DWORD *)a1 + 175));
        v19 = off_5A148;
      }
    }
    v20 = *((_DWORD *)a1 + 175);
    if ( v20 && *((_DWORD *)a1 + 173) > v20 )
    {
      if ( v19 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v19->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
        && BYTE1(v19->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EE0(*(_QWORD *)&v19->DeviceLock.Header.Lock, 0x1EEu, (__int64)&unk_57D38, *a1, *a4);
        v19 = off_5A148;
      }
      *v12 = 1;
    }
    v21 = *((_DWORD *)a1 + 176);
    if ( v21 && *((_DWORD *)a1 + 174) > v21 )
    {
      if ( v19 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v19->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
        && BYTE1(v19->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EE0(*(_QWORD *)&v19->DeviceLock.Header.Lock, 0x1EFu, (__int64)&unk_57D38, *a1, *a4);
        v19 = off_5A148;
      }
      *v12 = 1;
    }
    if ( !*v12 )
      goto LABEL_60;
    LOBYTE(v23) = a5;
    v22 = sub_26500(a3, (__int64)a1, a2, 0i64, *((_DWORD *)a1 + 6), v23, 1, (__int64)&v24);
    v10 = v22;
    if ( v22 )
    {
      v19 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        goto LABEL_60;
      }
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1F0u, (__int64)&unk_57D38, v22);
    }
  }
  v19 = off_5A148;
LABEL_60:
  *v12 = v24;
  if ( v19 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v19->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
    && BYTE1(v19->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v19->DeviceLock.Header.Lock, 0x1F1u, (__int64)&unk_57D38);
  }
  return v10;
}
// 2692E: variable 'v17' is possibly undefined
// 26AF2: variable 'v23' is possibly undefined
// 567C0: using guessed type __int64 qword_567C0[2];

//----- (0000000000026B9C) ----------------------------------------------------
__int64 __fastcall sub_26B9C(__int64 *a1)
{
  bool v2; // zf
  int v3; // ecx
  __m128i v4; // xmm0
  __m128i v5; // xmm1
  __int16 v6; // ax
  __int16 v7; // ax
  volatile signed __int32 *v8; // rax
  volatile signed __int32 *v9; // rcx
  volatile signed __int32 *v10; // rax
  volatile signed __int32 *v11; // rax
  volatile signed __int32 *v12; // rax
  int v13; // eax
  unsigned int v14; // ebx
  PDEVICE_OBJECT v15; // rcx
  __int64 v17; // [rsp+20h] [rbp-48h] BYREF
  _BYTE v18[48]; // [rsp+28h] [rbp-40h]

  memset((char *)&v17 + 4, 0, 0x2Dui64);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1F2u, (__int64)&unk_57D38);
  }
  v2 = *((_BYTE *)a1 + 57) == 0;
  v3 = *((_DWORD *)a1 + 5);
  v4 = _mm_loadu_si128((const __m128i *)(a1 + 11));
  v5 = _mm_loadu_si128((const __m128i *)(a1 + 13));
  v17 = *a1;
  v6 = *((_WORD *)a1 + 36);
  *(__m128i *)&v18[9] = v4;
  *(__m128i *)&v18[25] = v5;
  *(_WORD *)&v18[5] = v6;
  v7 = *((_WORD *)a1 + 37);
  *(_DWORD *)v18 = v3;
  v18[4] = 1;
  *((_BYTE *)a1 + 424) = 1;
  *(_WORD *)&v18[7] = v7;
  if ( v3 == 6 )
  {
    v8 = (volatile signed __int32 *)&unk_5A6D4;
    if ( !v2 )
      v8 = (volatile signed __int32 *)&unk_5A680;
    _InterlockedAdd(v8, 1u);
    v9 = (volatile signed __int32 *)&unk_5A778;
    v10 = (volatile signed __int32 *)&unk_5A7A8;
  }
  else
  {
    v11 = (volatile signed __int32 *)&unk_5A6F0;
    if ( !v2 )
      v11 = (volatile signed __int32 *)&unk_5A69C;
    _InterlockedAdd(v11, 1u);
    v9 = (volatile signed __int32 *)&unk_5A790;
    v10 = (volatile signed __int32 *)&unk_5A7C0;
  }
  if ( !v2 )
    v10 = v9;
  _InterlockedAdd(v10, 1u);
  v12 = (volatile signed __int32 *)&unk_5A70C;
  if ( !v2 )
    v12 = (volatile signed __int32 *)&unk_5A6B8;
  _InterlockedAdd(v12, 1u);
  if ( !v2 )
  {
    switch ( *((_DWORD *)a1 + 6) )
    {
      case 2:
        _InterlockedAdd(&dword_5A74C, 1u);
        _InterlockedAdd(&dword_5A7E8, 1u);
        break;
      case 3:
        _InterlockedAdd(&dword_5A758, 1u);
        _InterlockedAdd(&dword_5A7F0, 1u);
        break;
      case 4:
        _InterlockedAdd(&dword_5A728, 1u);
        _InterlockedAdd(&dword_5A7D8, 1u);
        break;
      case 5:
        _InterlockedAdd(&dword_5A734, 1u);
        _InterlockedAdd(&dword_5A7E0, 1u);
        break;
      case 9:
        _InterlockedAdd(&dword_5A740, 1u);
        _InterlockedAdd(&dword_5A7F8, 1u);
        break;
    }
  }
  _InterlockedAdd(&dword_5A764, 1u);
  *((_DWORD *)a1 + 105) = 1;
  *((_BYTE *)a1 + 648) = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_12D64(
      *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
      0x1F3u,
      (__int64)&unk_57D38,
      *a1,
      v17,
      *(_OWORD *)v18,
      *(_QWORD *)&v18[16],
      *(_OWORD *)&v18[24],
      *(_QWORD *)&v18[40]);
  }
  v13 = sub_4421C(40023, &v17, 0x31u);
  v14 = v13;
  if ( !v13 )
    goto LABEL_36;
  v15 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v14;
  if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1F4u, (__int64)&unk_57D38, v13);
LABEL_36:
    v15 = off_5A148;
  }
  if ( v15 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v15->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
    && BYTE1(v15->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v15->DeviceLock.Header.Lock, 0x1F5u, (__int64)&unk_57D38);
  }
  return v14;
}
// 5A728: using guessed type int dword_5A728;
// 5A734: using guessed type int dword_5A734;
// 5A740: using guessed type int dword_5A740;
// 5A74C: using guessed type int dword_5A74C;
// 5A758: using guessed type int dword_5A758;
// 5A764: using guessed type int dword_5A764;
// 5A7D8: using guessed type int dword_5A7D8;
// 5A7E0: using guessed type int dword_5A7E0;
// 5A7E8: using guessed type int dword_5A7E8;
// 5A7F0: using guessed type int dword_5A7F0;
// 5A7F8: using guessed type int dword_5A7F8;

//----- (0000000000026E24) ----------------------------------------------------
__int64 __fastcall sub_26E24(__int64 a1, _DWORD *a2)
{
  unsigned __int16 v4; // r11
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx
  unsigned __int16 v8; // [rsp+50h] [rbp+8h] BYREF
  __int64 v9; // [rsp+60h] [rbp+18h] BYREF

  v8 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1F6u, (__int64)&unk_57D38);
  }
  sub_50E34(*(_QWORD *)(a1 + 16), &v9, &v8);
  v4 = v8;
  if ( !v8 )
    goto LABEL_16;
  if ( (*(_BYTE *)(a1 + 120) & 0x10) == 0 )
  {
    *a2 += v8;
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_17;
    }
    v6 = 504;
    goto LABEL_15;
  }
  a2[1] += v8;
  v5 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return 0i64;
  if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    v6 = 503;
LABEL_15:
    sub_184C0(*(_QWORD *)&v5->DeviceLock.Header.Lock, v6, (__int64)&unk_57D38, v4);
LABEL_16:
    v5 = off_5A148;
  }
LABEL_17:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0x14u)
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x1F9u, (__int64)&unk_57D38);
  }
  return 0i64;
}

//----- (0000000000026F64) ----------------------------------------------------
__int64 __fastcall sub_26F64(_QWORD *a1, char a2, __int64 a3, ULONG_PTR *a4, ULONG_PTR **a5, __int64 *a6, _QWORD *a7, _DWORD *a8)
{
  char v11; // r14
  ULONG_PTR v12; // rcx
  __int64 v13; // rbx
  ULONG_PTR v14; // rax
  PDEVICE_OBJECT v15; // r10
  __int64 v16; // r12
  __int64 v17; // rax
  int v18; // eax
  __int64 v19; // rax
  int v20; // er9
  __int64 v22; // [rsp+20h] [rbp-D8h]
  int v23; // [rsp+40h] [rbp-B8h] BYREF
  __int64 v24; // [rsp+48h] [rbp-B0h]
  _QWORD *v25; // [rsp+50h] [rbp-A8h]
  char v26[80]; // [rsp+60h] [rbp-98h] BYREF

  v25 = a7;
  v24 = a3;
  v23 = 0;
  v11 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1FAu, (__int64)&unk_57D38);
  }
  v12 = qword_5A8C0;
  *a4 = 0i64;
  *a5 = 0i64;
  *a6 = 0i64;
  *a7 = 0i64;
  *a8 = 0;
  v13 = sub_49034(v12, *a1, a5, &v23);
  if ( !v23 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1FBu, (__int64)&unk_57D38, *a1);
    }
    v14 = qword_5A8C0;
LABEL_11:
    *a4 = v14;
    v15 = off_5A148;
    v11 = 1;
LABEL_47:
    v16 = v24;
    goto LABEL_48;
  }
  v13 = sub_49034(qword_5A8C8, *a1, a5, &v23);
  if ( !v23 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1FCu, (__int64)&unk_57D38, *a1);
    }
    v14 = qword_5A8C8;
    goto LABEL_11;
  }
  v15 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1FDu, (__int64)&unk_57D38, *a1);
    v15 = off_5A148;
  }
  if ( a2 )
    goto LABEL_47;
  if ( v15 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v15->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v15->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    sub_17BF0(*(_QWORD *)&v15->DeviceLock.Header.Lock, 0x1FEu, (__int64)&unk_57D38, *((_DWORD *)a1 + 5));
  }
  if ( sub_1FCD0() )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 8) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1FFu, (__int64)&unk_57D38, *a1);
    }
    *a8 = 10;
LABEL_33:
    v15 = off_5A148;
    goto LABEL_65;
  }
  v16 = v24;
  v17 = sub_1928C(*a1, a1[1], *((_DWORD *)a1 + 4), *((_DWORD *)a1 + 5), a1[4], a1[5], 0i64, v24);
  v13 = v17;
  if ( !v17 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x201u, (__int64)&unk_57D38, *a1);
    }
    *a8 = 3;
    goto LABEL_33;
  }
  v18 = sub_488F0(qword_5A8C8, *a1, v17, a5);
  v23 = v18;
  if ( v18 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      LODWORD(v22) = v18;
      sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x200u, (__int64)&unk_57D38, *(_QWORD *)v13, v22);
    }
    sub_196DC(v13);
    *a8 = 5;
    goto LABEL_33;
  }
  *(_BYTE *)(v13 + 57) = 0;
  sub_275B8(v13);
  *a4 = qword_5A8C8;
  v15 = off_5A148;
LABEL_48:
  if ( v13 && *a4 == qword_5A8C0 && *(_QWORD *)(v13 + 400) )
  {
    v19 = sub_49034(*a4, a1[1], v25, &v23);
    v20 = v23;
    *a6 = v19;
    if ( v20 )
    {
      v15 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_17BF0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x202u, (__int64)&unk_57D38, v20);
LABEL_60:
        v15 = off_5A148;
        goto LABEL_61;
      }
    }
    else
    {
      v15 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x203u, (__int64)&unk_57D38, a1[1]);
        goto LABEL_60;
      }
    }
  }
LABEL_61:
  if ( v11 && (*(_BYTE *)(v16 + 120) & 4) != 0 && strlen((const char *)(v13 + 129)) )
  {
    sub_53BB4(v26, 0x46ui64, "-Domain:%s", (const char *)(v13 + 129));
    sub_51EBC(v16, v26, strlen(v26));
    v15 = off_5A148;
  }
LABEL_65:
  if ( v15 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v15->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v15->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v15->DeviceLock.Header.Lock, 0x204u, (__int64)&unk_57D38);
  }
  return v13;
}
// 2728C: variable 'v22' is possibly undefined

//----- (00000000000274C4) ----------------------------------------------------
__int64 __fastcall sub_274C4(__int64 a1)
{
  unsigned int v2; // ebx
  PDEVICE_OBJECT v3; // rcx
  int v4; // eax

  v2 = 0;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x205u, (__int64)&unk_57D38);
    v3 = off_5A148;
  }
  if ( !*(_BYTE *)(a1 + 58) )
    goto LABEL_12;
  v4 = sub_33960(a1);
  v2 = v4;
  if ( !v4 )
    goto LABEL_11;
  v3 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v2;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x206u, (__int64)&unk_57D38, v4);
LABEL_11:
    v3 = off_5A148;
  }
LABEL_12:
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 4) != 0
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x207u, (__int64)&unk_57D38);
  }
  return v2;
}

//----- (00000000000275B8) ----------------------------------------------------
__int64 __fastcall sub_275B8(__int64 a1)
{
  bool v1; // r8
  volatile signed __int32 *v2; // rax
  volatile signed __int32 *v3; // rax
  volatile signed __int32 *v4; // rax
  volatile signed __int32 *v5; // r10
  volatile signed __int32 *v6; // rax
  volatile signed __int32 *v7; // r10
  volatile signed __int32 *v8; // rax
  volatile signed __int32 *v9; // r10
  volatile signed __int32 *v10; // rax
  volatile signed __int32 *v11; // rax
  volatile signed __int32 *v12; // rax
  volatile signed __int32 *v13; // rax
  volatile signed __int32 *v14; // rax
  volatile signed __int32 *v15; // rax
  volatile signed __int32 *v16; // r10
  volatile signed __int32 *v17; // rax
  volatile signed __int32 *v18; // r10
  volatile signed __int32 *v19; // rax
  volatile signed __int32 *v20; // rax
  volatile signed __int32 *v21; // rax
  volatile signed __int32 *v22; // rax
  volatile signed __int32 *v23; // r10
  volatile signed __int32 *v24; // rax
  volatile signed __int32 *v25; // rax

  v1 = *(_BYTE *)(a1 + 57) != 0;
  if ( *(_DWORD *)(a1 + 20) != 6 )
  {
    v13 = (volatile signed __int32 *)&unk_5A7BC;
    if ( *(_BYTE *)(a1 + 57) )
      v13 = (volatile signed __int32 *)&unk_5A78C;
    _InterlockedAdd(v13, 1u);
    if ( *(_DWORD *)(a1 + 16) == 2048 )
    {
      v14 = (volatile signed __int32 *)&unk_5A6F4;
      if ( v1 )
        v14 = (volatile signed __int32 *)&unk_5A6A0;
      _InterlockedAdd(v14, 1u);
      v15 = (volatile signed __int32 *)&unk_5A7C4;
      if ( v1 )
        v15 = (volatile signed __int32 *)&unk_5A794;
      _InterlockedAdd(v15, 1u);
      if ( *(_DWORD *)(a1 + 124) == 1 )
      {
        v16 = (volatile signed __int32 *)&unk_5A6A8;
        v17 = (volatile signed __int32 *)&unk_5A6FC;
LABEL_34:
        if ( v1 )
          v17 = v16;
        _InterlockedAdd(v17, 1u);
        v7 = (volatile signed __int32 *)&unk_5A79C;
        v8 = (volatile signed __int32 *)&unk_5A7CC;
        goto LABEL_48;
      }
      v18 = (volatile signed __int32 *)&unk_5A6B0;
      v19 = (volatile signed __int32 *)&unk_5A704;
    }
    else
    {
      v20 = (volatile signed __int32 *)&unk_5A6F8;
      if ( v1 )
        v20 = (volatile signed __int32 *)&unk_5A6A4;
      _InterlockedAdd(v20, 1u);
      v21 = (volatile signed __int32 *)&unk_5A7C8;
      if ( v1 )
        v21 = (volatile signed __int32 *)&unk_5A798;
      _InterlockedAdd(v21, 1u);
      if ( *(_DWORD *)(a1 + 124) == 1 )
      {
        v16 = (volatile signed __int32 *)&unk_5A6AC;
        v17 = (volatile signed __int32 *)&unk_5A700;
        goto LABEL_34;
      }
      v18 = (volatile signed __int32 *)&unk_5A6B4;
      v19 = (volatile signed __int32 *)&unk_5A708;
    }
    if ( v1 )
      v19 = v18;
    _InterlockedAdd(v19, 1u);
    v8 = (volatile signed __int32 *)&unk_5A7D0;
    v7 = (volatile signed __int32 *)&unk_5A7A0;
    goto LABEL_48;
  }
  v2 = (volatile signed __int32 *)&unk_5A7A4;
  if ( *(_BYTE *)(a1 + 57) )
    v2 = (volatile signed __int32 *)&unk_5A774;
  _InterlockedAdd(v2, 1u);
  if ( *(_DWORD *)(a1 + 16) == 2048 )
  {
    v3 = (volatile signed __int32 *)&unk_5A6D8;
    if ( v1 )
      v3 = (volatile signed __int32 *)&unk_5A684;
    _InterlockedAdd(v3, 1u);
    v4 = (volatile signed __int32 *)&unk_5A7AC;
    if ( v1 )
      v4 = (volatile signed __int32 *)&unk_5A77C;
    _InterlockedAdd(v4, 1u);
    if ( *(_DWORD *)(a1 + 124) == 1 )
    {
      v5 = (volatile signed __int32 *)&unk_5A68C;
      v6 = (volatile signed __int32 *)&unk_5A6E0;
LABEL_11:
      if ( v1 )
        v6 = v5;
      _InterlockedAdd(v6, 1u);
      v7 = (volatile signed __int32 *)&unk_5A784;
      v8 = (volatile signed __int32 *)&unk_5A7B4;
      goto LABEL_48;
    }
    v9 = (volatile signed __int32 *)&unk_5A694;
    v10 = (volatile signed __int32 *)&unk_5A6E8;
  }
  else
  {
    v11 = (volatile signed __int32 *)&unk_5A6DC;
    if ( v1 )
      v11 = (volatile signed __int32 *)&unk_5A688;
    _InterlockedAdd(v11, 1u);
    v12 = (volatile signed __int32 *)&unk_5A7B0;
    if ( v1 )
      v12 = (volatile signed __int32 *)&unk_5A780;
    _InterlockedAdd(v12, 1u);
    if ( *(_DWORD *)(a1 + 124) == 1 )
    {
      v5 = (volatile signed __int32 *)&unk_5A690;
      v6 = (volatile signed __int32 *)&unk_5A6E4;
      goto LABEL_11;
    }
    v9 = (volatile signed __int32 *)&unk_5A698;
    v10 = (volatile signed __int32 *)&unk_5A6EC;
  }
  if ( v1 )
    v10 = v9;
  _InterlockedAdd(v10, 1u);
  v7 = (volatile signed __int32 *)&unk_5A788;
  v8 = (volatile signed __int32 *)&unk_5A7B8;
LABEL_48:
  if ( v1 )
    v8 = v7;
  _InterlockedAdd(v8, 1u);
  if ( *(_DWORD *)(a1 + 16) == 2048 )
  {
    v22 = (volatile signed __int32 *)&unk_5A710;
    if ( v1 )
      v22 = (volatile signed __int32 *)&unk_5A6BC;
    _InterlockedAdd(v22, 1u);
    if ( *(_DWORD *)(a1 + 124) == 1 )
    {
      v23 = (volatile signed __int32 *)&unk_5A6C4;
      v24 = (volatile signed __int32 *)&unk_5A718;
    }
    else
    {
      v23 = (volatile signed __int32 *)&unk_5A6CC;
      v24 = (volatile signed __int32 *)&unk_5A720;
    }
  }
  else
  {
    v25 = (volatile signed __int32 *)&unk_5A714;
    if ( v1 )
      v25 = (volatile signed __int32 *)&unk_5A6C0;
    _InterlockedAdd(v25, 1u);
    if ( *(_DWORD *)(a1 + 124) == 1 )
    {
      v23 = (volatile signed __int32 *)&unk_5A6C8;
      v24 = (volatile signed __int32 *)&unk_5A71C;
    }
    else
    {
      v23 = (volatile signed __int32 *)&unk_5A6D0;
      v24 = (volatile signed __int32 *)&unk_5A724;
    }
  }
  if ( v1 )
    v24 = v23;
  _InterlockedAdd(v24, 1u);
  if ( v1 )
  {
    switch ( *(_DWORD *)(a1 + 24) )
    {
      case 2:
        _InterlockedAdd(&dword_5A7E4, 1u);
        if ( *(_DWORD *)(a1 + 16) == 2048 )
          _InterlockedAdd(&dword_5A750, 1u);
        else
          _InterlockedAdd(&dword_5A754, 1u);
        break;
      case 3:
        _InterlockedAdd(&dword_5A7EC, 1u);
        if ( *(_DWORD *)(a1 + 16) == 2048 )
          _InterlockedAdd(&dword_5A75C, 1u);
        else
          _InterlockedAdd(&dword_5A760, 1u);
        break;
      case 4:
        _InterlockedAdd(&dword_5A7D4, 1u);
        if ( *(_DWORD *)(a1 + 16) == 2048 )
          _InterlockedAdd(&dword_5A72C, 1u);
        else
          _InterlockedAdd(&dword_5A730, 1u);
        break;
      case 5:
        _InterlockedAdd(&dword_5A7DC, 1u);
        if ( *(_DWORD *)(a1 + 16) == 2048 )
          _InterlockedAdd(&dword_5A738, 1u);
        else
          _InterlockedAdd(&dword_5A73C, 1u);
        break;
      case 9:
        _InterlockedAdd(&dword_5A7F4, 1u);
        if ( *(_DWORD *)(a1 + 16) == 2048 )
          _InterlockedAdd(&dword_5A744, 1u);
        else
          _InterlockedAdd(&dword_5A748, 1u);
        break;
    }
  }
  return 0i64;
}
// 5A72C: using guessed type int dword_5A72C;
// 5A730: using guessed type int dword_5A730;
// 5A738: using guessed type int dword_5A738;
// 5A73C: using guessed type int dword_5A73C;
// 5A744: using guessed type int dword_5A744;
// 5A748: using guessed type int dword_5A748;
// 5A750: using guessed type int dword_5A750;
// 5A754: using guessed type int dword_5A754;
// 5A75C: using guessed type int dword_5A75C;
// 5A760: using guessed type int dword_5A760;
// 5A7D4: using guessed type int dword_5A7D4;
// 5A7DC: using guessed type int dword_5A7DC;
// 5A7E4: using guessed type int dword_5A7E4;
// 5A7EC: using guessed type int dword_5A7EC;
// 5A7F4: using guessed type int dword_5A7F4;

//----- (000000000002793C) ----------------------------------------------------
__int64 __fastcall sub_2793C(__int64 a1)
{
  bool v1; // r8
  volatile signed __int32 *v2; // rax
  volatile signed __int32 *v3; // r10
  volatile signed __int32 *v4; // rax
  volatile signed __int32 *v5; // rax
  volatile signed __int32 *v6; // rax
  volatile signed __int32 *v7; // rax
  volatile signed __int32 *v8; // rax
  volatile signed __int32 *v9; // r10
  volatile signed __int32 *v10; // rax
  volatile signed __int32 *v11; // rax

  v1 = *(_BYTE *)(a1 + 57) != 0;
  if ( *(_DWORD *)(a1 + 20) == 6 )
  {
    if ( *(_DWORD *)(a1 + 16) == 2048 )
    {
      v2 = (volatile signed __int32 *)&unk_5A6D8;
      if ( *(_BYTE *)(a1 + 57) )
        v2 = (volatile signed __int32 *)&unk_5A684;
      _InterlockedAdd(v2, 0xFFFFFFFF);
      if ( *(_DWORD *)(a1 + 124) == 1 )
      {
        v3 = (volatile signed __int32 *)&unk_5A68C;
        v4 = (volatile signed __int32 *)&unk_5A6E0;
      }
      else
      {
        v3 = (volatile signed __int32 *)&unk_5A694;
        v4 = (volatile signed __int32 *)&unk_5A6E8;
      }
    }
    else
    {
      v5 = (volatile signed __int32 *)&unk_5A6DC;
      if ( *(_BYTE *)(a1 + 57) )
        v5 = (volatile signed __int32 *)&unk_5A688;
      _InterlockedAdd(v5, 0xFFFFFFFF);
      if ( *(_DWORD *)(a1 + 124) == 1 )
      {
        v3 = (volatile signed __int32 *)&unk_5A690;
        v4 = (volatile signed __int32 *)&unk_5A6E4;
      }
      else
      {
        v3 = (volatile signed __int32 *)&unk_5A698;
        v4 = (volatile signed __int32 *)&unk_5A6EC;
      }
    }
  }
  else if ( *(_DWORD *)(a1 + 16) == 2048 )
  {
    v6 = (volatile signed __int32 *)&unk_5A6F4;
    if ( *(_BYTE *)(a1 + 57) )
      v6 = (volatile signed __int32 *)&unk_5A6A0;
    _InterlockedAdd(v6, 0xFFFFFFFF);
    if ( *(_DWORD *)(a1 + 124) == 1 )
    {
      v3 = (volatile signed __int32 *)&unk_5A6A8;
      v4 = (volatile signed __int32 *)&unk_5A6FC;
    }
    else
    {
      v3 = (volatile signed __int32 *)&unk_5A6B0;
      v4 = (volatile signed __int32 *)&unk_5A704;
    }
  }
  else
  {
    v7 = (volatile signed __int32 *)&unk_5A6F8;
    if ( *(_BYTE *)(a1 + 57) )
      v7 = (volatile signed __int32 *)&unk_5A6A4;
    _InterlockedAdd(v7, 0xFFFFFFFF);
    if ( *(_DWORD *)(a1 + 124) == 1 )
    {
      v3 = (volatile signed __int32 *)&unk_5A6AC;
      v4 = (volatile signed __int32 *)&unk_5A700;
    }
    else
    {
      v3 = (volatile signed __int32 *)&unk_5A6B4;
      v4 = (volatile signed __int32 *)&unk_5A708;
    }
  }
  if ( v1 )
    v4 = v3;
  _InterlockedAdd(v4, 0xFFFFFFFF);
  if ( *(_DWORD *)(a1 + 16) == 2048 )
  {
    v8 = (volatile signed __int32 *)&unk_5A710;
    if ( v1 )
      v8 = (volatile signed __int32 *)&unk_5A6BC;
    _InterlockedAdd(v8, 0xFFFFFFFF);
    if ( *(_DWORD *)(a1 + 124) == 1 )
    {
      v9 = (volatile signed __int32 *)&unk_5A6C4;
      v10 = (volatile signed __int32 *)&unk_5A718;
    }
    else
    {
      v9 = (volatile signed __int32 *)&unk_5A6CC;
      v10 = (volatile signed __int32 *)&unk_5A720;
    }
  }
  else
  {
    v11 = (volatile signed __int32 *)&unk_5A714;
    if ( v1 )
      v11 = (volatile signed __int32 *)&unk_5A6C0;
    _InterlockedAdd(v11, 0xFFFFFFFF);
    if ( *(_DWORD *)(a1 + 124) == 1 )
    {
      v9 = (volatile signed __int32 *)&unk_5A6C8;
      v10 = (volatile signed __int32 *)&unk_5A71C;
    }
    else
    {
      v9 = (volatile signed __int32 *)&unk_5A6D0;
      v10 = (volatile signed __int32 *)&unk_5A724;
    }
  }
  if ( v1 )
    v10 = v9;
  _InterlockedAdd(v10, 0xFFFFFFFF);
  if ( v1 )
  {
    switch ( *(_DWORD *)(a1 + 24) )
    {
      case 2:
        if ( *(_DWORD *)(a1 + 16) == 2048 )
          _InterlockedAdd(&dword_5A750, 0xFFFFFFFF);
        else
          _InterlockedAdd(&dword_5A754, 0xFFFFFFFF);
        break;
      case 3:
        if ( *(_DWORD *)(a1 + 16) == 2048 )
          _InterlockedAdd(&dword_5A75C, 0xFFFFFFFF);
        else
          _InterlockedAdd(&dword_5A760, 0xFFFFFFFF);
        break;
      case 4:
        if ( *(_DWORD *)(a1 + 16) == 2048 )
          _InterlockedAdd(&dword_5A72C, 0xFFFFFFFF);
        else
          _InterlockedAdd(&dword_5A730, 0xFFFFFFFF);
        break;
      case 5:
        if ( *(_DWORD *)(a1 + 16) == 2048 )
          _InterlockedAdd(&dword_5A738, 0xFFFFFFFF);
        else
          _InterlockedAdd(&dword_5A73C, 0xFFFFFFFF);
        break;
      case 9:
        if ( *(_DWORD *)(a1 + 16) == 2048 )
          _InterlockedAdd(&dword_5A744, 0xFFFFFFFF);
        else
          _InterlockedAdd(&dword_5A748, 0xFFFFFFFF);
        break;
    }
  }
  if ( *(_BYTE *)(a1 + 424) )
    sub_27BC8(a1);
  return 0i64;
}
// 5A72C: using guessed type int dword_5A72C;
// 5A730: using guessed type int dword_5A730;
// 5A738: using guessed type int dword_5A738;
// 5A73C: using guessed type int dword_5A73C;
// 5A744: using guessed type int dword_5A744;
// 5A748: using guessed type int dword_5A748;
// 5A750: using guessed type int dword_5A750;
// 5A754: using guessed type int dword_5A754;
// 5A75C: using guessed type int dword_5A75C;
// 5A760: using guessed type int dword_5A760;

//----- (0000000000027BC8) ----------------------------------------------------
__int64 __fastcall sub_27BC8(__int64 a1)
{
  bool v1; // dl
  volatile signed __int32 *v2; // r8
  volatile signed __int32 *v3; // rax
  volatile signed __int32 *v4; // rax
  int v5; // ecx
  int v6; // ecx
  int v7; // ecx
  int v8; // ecx

  v1 = *(_BYTE *)(a1 + 57) != 0;
  if ( *(_BYTE *)(a1 + 424) )
  {
    if ( *(_DWORD *)(a1 + 20) == 6 )
    {
      v2 = (volatile signed __int32 *)&unk_5A680;
      v3 = (volatile signed __int32 *)&unk_5A6D4;
    }
    else
    {
      v2 = (volatile signed __int32 *)&unk_5A69C;
      v3 = (volatile signed __int32 *)&unk_5A6F0;
    }
    if ( *(_BYTE *)(a1 + 57) )
      v3 = v2;
    _InterlockedAdd(v3, 0xFFFFFFFF);
    v4 = (volatile signed __int32 *)&unk_5A70C;
    if ( v1 )
      v4 = (volatile signed __int32 *)&unk_5A6B8;
    _InterlockedAdd(v4, 0xFFFFFFFF);
    if ( v1 )
    {
      v5 = *(_DWORD *)(a1 + 24) - 2;
      if ( v5 )
      {
        v6 = v5 - 1;
        if ( v6 )
        {
          v7 = v6 - 1;
          if ( v7 )
          {
            v8 = v7 - 1;
            if ( v8 )
            {
              if ( v8 == 4 )
                _InterlockedAdd(&dword_5A740, 0xFFFFFFFF);
            }
            else
            {
              _InterlockedAdd(&dword_5A734, 0xFFFFFFFF);
            }
          }
          else
          {
            _InterlockedAdd(&dword_5A728, 0xFFFFFFFF);
          }
        }
        else
        {
          _InterlockedAdd(&dword_5A758, 0xFFFFFFFF);
        }
      }
      else
      {
        _InterlockedAdd(&dword_5A74C, 0xFFFFFFFF);
      }
    }
  }
  return 0i64;
}
// 5A728: using guessed type int dword_5A728;
// 5A734: using guessed type int dword_5A734;
// 5A740: using guessed type int dword_5A740;
// 5A74C: using guessed type int dword_5A74C;
// 5A758: using guessed type int dword_5A758;

//----- (0000000000027C7C) ----------------------------------------------------
__int64 __fastcall sub_27C7C(int a1, __int64 a2, int a3, __int64 a4, _DWORD *a5)
{
  __int64 v5; // rdi
  __int64 v6; // rbx
  _DWORD *v7; // rsi
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  PDEVICE_OBJECT v11; // rcx
  unsigned __int16 v12; // dx
  unsigned __int8 *v13; // rcx
  __int64 v14; // rax
  __int64 v15; // rdi
  ULONG_PTR v16; // rcx
  __int64 v17; // [rsp+20h] [rbp-48h]
  __int64 v20; // [rsp+38h] [rbp-30h]
  ULONG_PTR BugCheckParameter1[5]; // [rsp+40h] [rbp-28h] BYREF
  int v22; // [rsp+88h] [rbp+20h] BYREF

  v22 = 0;
  BugCheckParameter1[0] = 0i64;
  v5 = a4;
  v6 = a2;
  v7 = a5;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v20 = (__int64)a5;
    v17 = a2;
    sub_17C3C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x216u, (__int64)&unk_57D38, a1);
  }
  *v7 = 1;
  if ( !v5 )
  {
    v8 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 4i64;
    }
    v9 = 535;
LABEL_10:
    sub_11088(*(_QWORD *)&v8->DeviceLock.Header.Lock, v9, (__int64)&unk_57D38);
    return 4i64;
  }
  if ( !(unsigned int)sub_4535C(0x201302Au) )
  {
    v11 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      return 0i64;
    }
    v12 = 536;
    goto LABEL_39;
  }
  if ( !v6 )
  {
    v8 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 4i64;
    }
    v9 = 537;
    goto LABEL_10;
  }
  v13 = (unsigned __int8 *)(v6 + 36);
  if ( *(_DWORD *)(v6 + 24) == 2 )
    v13 = (unsigned __int8 *)(v6 + 52);
  v14 = sub_3BDD8(v13, BugCheckParameter1, &v22);
  v15 = v14;
  if ( v22 == 5 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x21Au, (__int64)&unk_57D38, *(_QWORD *)v6);
    }
    _InterlockedAdd(&dword_5A800, 1u);
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      v17 = *(_QWORD *)v6;
      sub_13F8C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x21Bu, (__int64)&unk_57D38, (const char *)(v14 + 17));
    }
    _InterlockedAdd(&dword_5A7FC, 1u);
    sub_53B40((char *)(v6 + 74), 0x100ui64, L"%S", v15 + 17, v17, a3, a4, v20);
    v16 = BugCheckParameter1[0];
    *(_DWORD *)(v6 + 68) = -4;
    sub_3BF50(v16);
  }
  sub_27EEC(v6);
  v11 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v12 = 540;
LABEL_39:
    sub_11088(*(_QWORD *)&v11->DeviceLock.Header.Lock, v12, (__int64)&unk_57D38);
  }
  return 0i64;
}
// 27E7D: variable 'v17' is possibly undefined
// 27E7D: variable 'a3' is possibly undefined
// 27E7D: variable 'a4' is possibly undefined
// 27E7D: variable 'v20' is possibly undefined
// 56800: using guessed type wchar_t aS[3];
// 5A7FC: using guessed type int dword_5A7FC;
// 5A800: using guessed type int dword_5A800;

//----- (0000000000027EEC) ----------------------------------------------------
void __fastcall sub_27EEC(__int64 a1)
{
  PDEVICE_OBJECT v2; // r14
  unsigned __int16 v3; // dx
  const char *v4; // rdi
  __int64 v5; // r9
  const char *v6; // rbx
  const char *v7; // rax
  const char *v8; // rax

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x21Du, (__int64)&unk_57D38);
    v2 = off_5A148;
  }
  if ( !a1 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v3 = 542;
LABEL_95:
      sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, v3, (__int64)&unk_57D38);
      return;
    }
    return;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x21Fu, (__int64)&unk_57D38);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
    {
      v4 = "UNKNOWN";
      if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
        && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        v5 = *(unsigned int *)(a1 + 16);
        if ( (_DWORD)v5 )
        {
          switch ( (_DWORD)v5 )
          {
            case 0x800:
              v6 = "IPv4";
              break;
            case 0x806:
              v6 = "ARP";
              break;
            case 0x8035:
              v6 = "RARP";
              break;
            case 0x86DD:
              v6 = "IPv6";
              break;
            default:
              v6 = byte_5A5A4;
              sub_53BB4(byte_5A5A4, 4ui64, "%d", v5);
              v2 = off_5A148;
              break;
          }
        }
        else
        {
          v6 = "UNKNOWN";
        }
        sub_187E8(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x220u, (__int64)&unk_57D38, v6);
        v2 = off_5A148;
      }
      if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
          && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          v7 = sub_4A7C4(*(_DWORD *)(a1 + 20));
          sub_187E8(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x221u, (__int64)&unk_57D38, v7);
          v2 = off_5A148;
        }
        if ( v2 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
          && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          if ( *(_DWORD *)(a1 + 24) == 1 )
          {
            v4 = "INCOMING";
          }
          else if ( *(_DWORD *)(a1 + 24) == 2 )
          {
            v4 = "OUTGOING";
          }
          sub_187E8(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x222u, (__int64)&unk_57D38, v4);
          v2 = off_5A148;
        }
      }
    }
  }
  if ( *(_DWORD *)(a1 + 16) == 2048 )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
      return;
    if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_18658(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x223u, (__int64)&unk_57D38, *(unsigned __int8 *)(a1 + 52));
      v2 = off_5A148;
    }
    if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
      return;
    if ( !_bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
      || BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_59;
    }
    sub_18658(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x224u, (__int64)&unk_57D38, *(unsigned __int8 *)(a1 + 36));
  }
  else
  {
    if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
      return;
    if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_17A28(
        *(_QWORD *)&v2->DeviceLock.Header.Lock,
        0x225u,
        (__int64)&unk_57D38,
        (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 52)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 52) << 8));
      v2 = off_5A148;
    }
    if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
      return;
    if ( !_bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
      || BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_59;
    }
    sub_17A28(
      *(_QWORD *)&v2->DeviceLock.Header.Lock,
      0x226u,
      (__int64)&unk_57D38,
      (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 36)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 36) << 8));
  }
  v2 = off_5A148;
LABEL_59:
  if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x227u, (__int64)&unk_57D38, *(_DWORD *)(a1 + 32));
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
        && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EA4(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x228u, (__int64)&unk_57D38, *(_DWORD *)(a1 + 28));
        v2 = off_5A148;
      }
      if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
          && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x229u, (__int64)&unk_57D38, *(_QWORD *)a1);
          v2 = off_5A148;
        }
        if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
        {
          if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
            && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_12D64(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x22Au, (__int64)&unk_57D38, *(_QWORD *)(a1 + 8));
            v2 = off_5A148;
          }
          if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
          {
            if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
              && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              sub_13EA4(
                *(_QWORD *)&v2->DeviceLock.Header.Lock,
                0x22Bu,
                (__int64)&unk_57D38,
                *(unsigned __int8 *)(a1 + 72));
              v2 = off_5A148;
            }
            if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
            {
              if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
                && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
              {
                sub_13EA4(
                  *(_QWORD *)&v2->DeviceLock.Header.Lock,
                  0x22Cu,
                  (__int64)&unk_57D38,
                  *(unsigned __int8 *)(a1 + 73));
                v2 = off_5A148;
              }
              if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
              {
                if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
                  && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
                {
                  v8 = sub_4A83C(*(_DWORD *)(a1 + 588));
                  sub_187E8(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x22Du, (__int64)&unk_57D38, v8);
                  v2 = off_5A148;
                }
                if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
                {
                  if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
                    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
                  {
                    sub_185D8(
                      *(_QWORD *)&v2->DeviceLock.Header.Lock,
                      0x22Eu,
                      (__int64)&unk_57D38,
                      (const wchar_t *)(a1 + 74));
                    v2 = off_5A148;
                  }
                  if ( v2 != (PDEVICE_OBJECT)&off_5A148
                    && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
                    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
                  {
                    v3 = 559;
                    goto LABEL_95;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}

//----- (0000000000028704) ----------------------------------------------------
__int64 sub_28704(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+A8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D28, 36i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000028788) ----------------------------------------------------
__int64 sub_28788(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D28, 67i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000287EC) ----------------------------------------------------
__int64 sub_287EC()
{
  unsigned int v0; // ebx
  PDEVICE_OBJECT v1; // rcx
  unsigned __int16 v2; // dx
  unsigned __int8 v3; // al
  __int64 v5; // [rsp+28h] [rbp-50h]
  int v6; // [rsp+80h] [rbp+8h] BYREF

  v0 = 0;
  v6 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xAu, (__int64)&unk_57D28);
  }
  qword_5A8E0 = sub_3C76C(2, 0x1A0u, 0x74737041u);
  if ( !qword_5A8E0 )
  {
    v1 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_11;
    }
    v2 = 11;
LABEL_10:
    sub_11088(*(_QWORD *)&v1->DeviceLock.Header.Lock, v2, (__int64)&unk_57D28);
    v1 = off_5A148;
LABEL_11:
    v0 = 3;
    goto LABEL_28;
  }
  qword_5A8E8 = sub_3C76C(1, 0x38u, 0x646D7341u);
  if ( !qword_5A8E8 )
  {
    v1 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_11;
    }
    v2 = 12;
    goto LABEL_10;
  }
  qword_5A8F0 = sub_3C76C(1, 0x38u, 0x65617341u);
  if ( !qword_5A8F0 )
  {
    v1 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_11;
    }
    v2 = 13;
    goto LABEL_10;
  }
  v3 = sub_4535C(0x201300Fu);
  LODWORD(v5) = 2;
  qword_5A8D8 = (ULONG_PTR)sub_477F4(v3, 0i64, 1, 0x74737041u, 0i64, v5, 0i64, 0i64, (__int64)sub_2AD1C, 0i64, &v6);
  if ( !v6 )
  {
LABEL_36:
    v1 = off_5A148;
    goto LABEL_37;
  }
  v1 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xEu, (__int64)&unk_57D28, v6);
    v1 = off_5A148;
  }
  v0 = 1;
LABEL_28:
  if ( qword_5A8D8 )
  {
    sub_47B3C(qword_5A8D8);
    v1 = off_5A148;
    qword_5A8D8 = 0i64;
  }
  if ( qword_5A8E8 )
  {
    sub_3C7F0(qword_5A8E8);
    v1 = off_5A148;
    qword_5A8E8 = 0i64;
  }
  if ( qword_5A8F0 )
  {
    sub_3C7F0(qword_5A8F0);
    v1 = off_5A148;
    qword_5A8F0 = 0i64;
  }
  if ( qword_5A8E0 )
  {
    sub_3C7F0(qword_5A8E0);
    qword_5A8E0 = 0i64;
    goto LABEL_36;
  }
LABEL_37:
  if ( v1 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v1->DeviceLock.Header.WaitListHead.Blink) & 1) != 0
    && BYTE1(v1->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v1->DeviceLock.Header.Lock, 0xFu, (__int64)&unk_57D28, v0);
  }
  return v0;
}
// 289AE: variable 'v5' is possibly undefined

//----- (0000000000028AF8) ----------------------------------------------------
__int64 __fastcall sub_28AF8(int a1, unsigned __int64 **a2)
{
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  unsigned int v6; // eax

  v4 = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x12u, (__int64)&unk_57D28);
    v5 = off_5A148;
  }
  if ( a1 > 775 )
  {
    switch ( a1 )
    {
      case 776:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x1Cu, (__int64)&unk_57D28, 776);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_2A938(*a2);
          goto LABEL_49;
        }
        break;
      case 777:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x1Au, (__int64)&unk_57D28, 777);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_29A20(*a2);
          goto LABEL_49;
        }
        goto LABEL_104;
      case 778:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x1Eu, (__int64)&unk_57D28, 778);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_2A134((__int64)*a2);
          goto LABEL_49;
        }
        goto LABEL_104;
      case 779:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x1Fu, (__int64)&unk_57D28, 779);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_29CC8((__int64)*a2);
          goto LABEL_49;
        }
        goto LABEL_104;
      case 780:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x1Du, (__int64)&unk_57D28, 780);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_2ABC4(*a2);
          goto LABEL_49;
        }
        break;
      case 781:
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x15u, (__int64)&unk_57D28, 781);
          v5 = off_5A148;
        }
        if ( *a2 )
        {
          v6 = sub_294BC(*a2);
          goto LABEL_49;
        }
        goto LABEL_104;
      default:
        goto LABEL_62;
    }
LABEL_103:
    v4 = 6;
    goto LABEL_104;
  }
  switch ( a1 )
  {
    case 775:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x1Bu, (__int64)&unk_57D28, 775);
        v5 = off_5A148;
      }
      if ( *a2 )
      {
        v6 = sub_2A78C(*a2);
        goto LABEL_49;
      }
      goto LABEL_103;
    case 769:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x13u, (__int64)&unk_57D28, 769);
        v5 = off_5A148;
      }
      if ( *a2 )
      {
        v6 = sub_29054((__int64)*a2);
        goto LABEL_49;
      }
      goto LABEL_104;
    case 770:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x14u, (__int64)&unk_57D28, 770);
        v5 = off_5A148;
      }
      if ( *a2 )
      {
        v6 = sub_29340(*a2);
        goto LABEL_49;
      }
      goto LABEL_104;
    case 771:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x16u, (__int64)&unk_57D28, 771);
        v5 = off_5A148;
      }
      if ( *a2 )
      {
        v6 = sub_29774(*a2);
        goto LABEL_49;
      }
      goto LABEL_104;
    case 772:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x18u, (__int64)&unk_57D28, 772);
        v5 = off_5A148;
      }
      if ( *a2 )
      {
        v6 = sub_2A5C4(*a2);
        goto LABEL_49;
      }
      goto LABEL_104;
  }
  if ( a1 != 773 )
  {
    if ( a1 == 774 )
    {
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x19u, (__int64)&unk_57D28, 774);
        v5 = off_5A148;
      }
      if ( *a2 )
      {
        v6 = sub_2A390(*a2);
LABEL_49:
        v5 = off_5A148;
        v4 = v6;
        goto LABEL_104;
      }
      goto LABEL_104;
    }
LABEL_62:
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x20u, (__int64)&unk_57D28, a1);
      v5 = off_5A148;
    }
    v4 = 277;
    goto LABEL_104;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x17u, (__int64)&unk_57D28, 773);
    v5 = off_5A148;
  }
  if ( *a2 )
  {
    v6 = sub_29B68(*a2);
    goto LABEL_49;
  }
LABEL_104:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x21u, (__int64)&unk_57D28);
  }
  return v4;
}

//----- (0000000000029054) ----------------------------------------------------
__int64 __fastcall sub_29054(__int64 a1)
{
  unsigned int v2; // esi
  _DWORD *v3; // rax
  _QWORD *v4; // rdi
  __int64 v5; // rax
  __int64 v6; // rax
  ULONG_PTR v7; // rcx
  int v8; // eax

  v2 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x22u, (__int64)&unk_57D28);
  }
  v3 = sub_3C910((__int64)qword_5A8E0);
  v4 = v3;
  if ( v3 )
  {
    memset(v3, 0, 0x1A0ui64);
    *v4 = _InterlockedIncrement64(&qword_5D418);
    v5 = *(_QWORD *)(a1 + 8);
    *((_DWORD *)v4 + 9) = 1;
    v4[1] = v5;
    *((_DWORD *)v4 + 8) = *(_DWORD *)(a1 + 16);
    *((_WORD *)v4 + 138) = *(_WORD *)(a1 + 20);
    *((_WORD *)v4 + 139) = *(_WORD *)(a1 + 22);
    v4[2] = *(_QWORD *)(a1 + 24);
    v6 = *(_QWORD *)(a1 + 32);
    *((_DWORD *)v4 + 65) = 0;
    v4[3] = v6;
    *((_DWORD *)v4 + 64) = 0;
    v4[31] = 0i64;
    *((_DWORD *)v4 + 66) = 0;
    *((_BYTE *)v4 + 288) = 0;
    *((_BYTE *)v4 + 290) = 0;
    *((_DWORD *)v4 + 71) = 4;
    v4[37] = 0i64;
    v4[38] = 0i64;
    sub_2D13C(v4 + 2, v4 + 40);
    *((_DWORD *)v4 + 67) = (unsigned int)sub_4535C(0x2013002u) << 10;
    *((_DWORD *)v4 + 68) = (unsigned int)sub_4535C(0x2013005u) << 10;
    *((_BYTE *)v4 + 280) = sub_4535C(0x2013004u);
    *((_DWORD *)v4 + 79) = sub_4535C(0x2013027u);
    v4[8] = v4 + 7;
    v4[7] = v4 + 7;
    *((_DWORD *)v4 + 18) = 0;
    sub_3D230((__int64)(v4 + 10));
    *((_BYTE *)v4 + 148) = 1;
    v4[20] = v4 + 19;
    v4[19] = v4 + 19;
    *((_DWORD *)v4 + 42) = 0;
    sub_3D230((__int64)(v4 + 22));
    v7 = qword_5A8D8;
    *((_BYTE *)v4 + 244) = 1;
    v8 = sub_488F0(v7, *v4, (__int64)v4, 0i64);
    if ( v8 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x23u, (__int64)&unk_57D28, *v4, v8);
      }
      sub_2AD1C(v4);
      *(_QWORD *)a1 = 0i64;
      v2 = 1;
    }
    else
    {
      *(_QWORD *)a1 = *v4;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_28704(
          *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
          36i64,
          (__int64)&unk_57D28,
          *v4,
          *((_DWORD *)v4 + 8),
          v4[2],
          v4[3],
          *((unsigned __int16 *)v4 + 138));
      }
      _InterlockedAdd(&dword_5A764, 1u);
    }
  }
  else
  {
    v2 = 3;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x25u, (__int64)&unk_57D28);
  }
  return v2;
}
// 5A764: using guessed type int dword_5A764;
// 5D418: using guessed type __int64 qword_5D418;

//----- (0000000000029340) ----------------------------------------------------
__int64 __fastcall sub_29340(unsigned __int64 *a1)
{
  unsigned int v1; // ebx
  __int64 v3; // rdi
  __int64 v4; // r8
  PDEVICE_OBJECT v5; // rcx
  int v7; // [rsp+48h] [rbp+10h] BYREF

  v1 = 0;
  v7 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x26u, (__int64)&unk_57D28);
  }
  v3 = sub_49034(qword_5A8D8, *a1, 0i64, &v7);
  if ( !v7 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x27u, (__int64)&unk_57D28, *a1);
    }
    v1 = sub_2C470(v3);
  }
  LOBYTE(v4) = 1;
  sub_48B2C(qword_5A8D8, *a1, v4, &v7);
  if ( v7 )
  {
    v5 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x28u, (__int64)&unk_57D28, *a1, v7);
      v5 = off_5A148;
    }
    v1 = 1;
  }
  else
  {
    v5 = off_5A148;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x29u, (__int64)&unk_57D28);
  }
  return v1;
}
// 2940D: variable 'v4' is possibly undefined

//----- (00000000000294BC) ----------------------------------------------------
__int64 __fastcall sub_294BC(_QWORD *a1)
{
  volatile signed __int32 *v2; // rbx
  __int64 v3; // r8
  PDEVICE_OBJECT v4; // rcx
  int v5; // eax
  __int64 v6; // rax
  PDEVICE_OBJECT v7; // rcx
  __m128i v8; // xmm0
  int v9; // eax
  __m128i v11; // [rsp+30h] [rbp-38h] BYREF
  int v12; // [rsp+78h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+80h] [rbp+18h] BYREF
  __int64 v14; // [rsp+88h] [rbp+20h]

  BugCheckParameter1 = 0i64;
  v12 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Au, (__int64)&unk_57D28);
  }
  v2 = (volatile signed __int32 *)sub_49870(qword_5A8D8, &BugCheckParameter1, &v12);
  if ( v2 )
  {
    do
    {
      v6 = *((_QWORD *)v2 + 2);
      if ( v6 == *a1 )
      {
        v11.m128i_i32[0] = 0;
        v11.m128i_i64[1] = 0i64;
        v7 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EE0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Cu, (__int64)&unk_57D28, *(_QWORD *)v2, v6);
          v7 = off_5A148;
        }
        v8 = _mm_loadu_si128((const __m128i *)(v2 + 74));
        v14 = *((_QWORD *)v2 + 2);
        v11 = v8;
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EE0(
            *(_QWORD *)&v7->DeviceLock.Header.Lock,
            0x2Du,
            (__int64)&unk_57D28,
            *((_QWORD *)v2 + 1),
            *((_QWORD *)v2 + 38));
        }
        if ( _InterlockedCompareExchange(v2 + 74, 0, 1) )
        {
          sub_2CDB0((__int64)&v11, v14, 4);
        }
        else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
               && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
               && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Eu, (__int64)&unk_57D28, *(_QWORD *)v2);
        }
        LOBYTE(v3) = 1;
        sub_48DB0(qword_5A8D8, BugCheckParameter1, v3, &v12);
        if ( v12
          && off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          v9 = sub_4A538(v12);
          sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Fu, (__int64)&unk_57D28, v9);
        }
      }
      LOBYTE(v3) = 1;
      v2 = (volatile signed __int32 *)sub_49A3C(qword_5A8D8, &BugCheckParameter1, v3, &v12);
    }
    while ( v2 );
    goto LABEL_31;
  }
  v4 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return 0i64;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v5 = sub_4A538(v12);
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Bu, (__int64)&unk_57D28, v5);
LABEL_31:
    v4 = off_5A148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x30u, (__int64)&unk_57D28);
  }
  return 0i64;
}
// 296B7: variable 'v3' is possibly undefined

//----- (0000000000029774) ----------------------------------------------------
__int64 __fastcall sub_29774(unsigned __int64 *a1)
{
  unsigned int v1; // esi
  __int64 v3; // rbx
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  int v7; // [rsp+58h] [rbp+10h] BYREF

  v1 = 0;
  v7 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x31u, (__int64)&unk_57D28);
  }
  v3 = sub_49034(qword_5A8D8, *a1, 0i64, &v7);
  if ( v7 )
  {
    v4 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x35u, (__int64)&unk_57D28, *a1, v7);
      v4 = off_5A148;
    }
    v1 = 1;
    goto LABEL_44;
  }
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x32u, (__int64)&unk_57D28, *a1);
    v4 = off_5A148;
  }
  if ( *(_DWORD *)(v3 + 36) == 1 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x33u, (__int64)&unk_57D28);
    }
    if ( (unsigned int)sub_2B1E8(v3, (__int64)a1) != 1 )
    {
      sub_2AF24(v3, (__int64)a1);
LABEL_38:
      v4 = off_5A148;
      goto LABEL_44;
    }
    v4 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x7Cu, (__int64)&unk_57D28);
        v4 = off_5A148;
      }
      if ( v4 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          v5 = 125;
LABEL_37:
          sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, v5, (__int64)&unk_57D28);
          goto LABEL_38;
        }
        goto LABEL_44;
      }
    }
  }
  else if ( v4 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x34u, (__int64)&unk_57D28);
      v4 = off_5A148;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x7Au, (__int64)&unk_57D28);
        v4 = off_5A148;
      }
      if ( v4 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          v5 = 123;
          goto LABEL_37;
        }
LABEL_44:
        if ( v4 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x36u, (__int64)&unk_57D28);
        }
        return v1;
      }
    }
  }
  return v1;
}

//----- (0000000000029A20) ----------------------------------------------------
__int64 __fastcall sub_29A20(unsigned __int64 *a1)
{
  __int64 v2; // rdi
  int v4; // [rsp+38h] [rbp+10h] BYREF

  v4 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x37u, (__int64)&unk_57D28);
  }
  v2 = sub_49034(qword_5A8D8, *a1, 0i64, &v4);
  if ( v4 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x39u, (__int64)&unk_57D28, *a1);
    }
    *(_QWORD *)a1[1] = 0i64;
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x38u, (__int64)&unk_57D28, *a1);
    }
    *(_QWORD *)a1[1] = v2;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Au, (__int64)&unk_57D28);
  }
  return 0i64;
}

//----- (0000000000029B68) ----------------------------------------------------
__int64 __fastcall sub_29B68(_QWORD *a1)
{
  unsigned int v1; // ebx
  __int64 v3; // rsi
  PDEVICE_OBJECT v4; // rcx
  int v6; // [rsp+38h] [rbp+10h] BYREF

  v1 = 0;
  v6 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Bu, (__int64)&unk_57D28);
  }
  v3 = sub_49034(qword_5A8D8, *a1, 0i64, &v6);
  if ( v6 )
  {
    v4 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Du, (__int64)&unk_57D28, *a1);
      v4 = off_5A148;
    }
    v1 = 5;
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Cu, (__int64)&unk_57D28, *a1);
    }
    sub_2B324(v3, *((_DWORD *)a1 + 2), (const void *)a1[2], *((_DWORD *)a1 + 6));
    v4 = off_5A148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x3Eu, (__int64)&unk_57D28);
  }
  return v1;
}

//----- (0000000000029CC8) ----------------------------------------------------
__int64 __fastcall sub_29CC8(__int64 a1)
{
  __int64 v2; // rbp
  unsigned int v3; // er12
  PDEVICE_OBJECT v4; // rcx
  unsigned __int64 *v5; // rsi
  __int64 v6; // rbx
  PDEVICE_OBJECT v7; // rcx
  int v8; // er13
  unsigned int v9; // edi
  PDEVICE_OBJECT v10; // rcx
  int v12; // [rsp+20h] [rbp-68h]
  __int64 v13; // [rsp+30h] [rbp-58h]
  __m128i v14; // [rsp+38h] [rbp-50h] BYREF
  unsigned int v15; // [rsp+90h] [rbp+8h] BYREF
  int v16; // [rsp+98h] [rbp+10h] BYREF
  __int64 v17; // [rsp+A0h] [rbp+18h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+A8h] [rbp+20h] BYREF

  v16 = 0;
  BugCheckParameter1 = 0i64;
  v2 = 0i64;
  v17 = 0i64;
  v3 = 0;
  v15 = 0;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Fu, (__int64)&unk_57D28);
    v4 = off_5A148;
  }
  v5 = *(unsigned __int64 **)(a1 + 16);
  if ( v5 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x40u, (__int64)&unk_57D28, *v5);
    }
    v6 = sub_49034(qword_5A8D8, *v5, &BugCheckParameter1, &v16);
    if ( v16 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        v12 = sub_4A538(v16);
        sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x48u, (__int64)&unk_57D28, *v5, v12);
      }
      v9 = 5;
      goto LABEL_51;
    }
    v14.m128i_i32[0] = 0;
    v14.m128i_i64[1] = 0i64;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x41u, (__int64)&unk_57D28, *v5);
    }
    *(_BYTE *)(v6 + 288) = 1;
    *(_QWORD *)(v6 + 48) = *(_QWORD *)(a1 + 8);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x42u, (__int64)&unk_57D28, *v5);
    }
    sub_2B978(v6);
    if ( *(_BYTE *)(v6 + 290) && *(_DWORD *)(v6 + 312) == 2 )
    {
      sub_2CB70(v6, &v17, &v15);
      v7 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
      {
        v2 = v17;
        v3 = v15;
LABEL_26:
        v8 = *(_DWORD *)(v6 + 284);
        v13 = *(_QWORD *)(v6 + 16);
        v14 = _mm_loadu_si128((const __m128i *)(v6 + 296));
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v7->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x44u, (__int64)&unk_57D28, *v5);
        }
        v9 = sub_2C5B4(v6, v2, v3);
        v10 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
        {
          if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x45u, (__int64)&unk_57D28, *v5);
            v10 = off_5A148;
          }
          if ( v10 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(v10->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
            && BYTE1(v10->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_13EE0(*(_QWORD *)&v10->DeviceLock.Header.Lock, 0x46u, (__int64)&unk_57D28, *v5, *(_QWORD *)(v6 + 304));
          }
        }
        if ( _InterlockedCompareExchange((volatile signed __int32 *)(v6 + 296), 0, 1) )
        {
          sub_2CDB0((__int64)&v14, v13, v8);
        }
        else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
               && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
               && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x47u, (__int64)&unk_57D28, *(_QWORD *)v6);
        }
        sub_49CF0(qword_5A8D8, BugCheckParameter1);
LABEL_51:
        sub_3C570(v5, 0x6D707453u);
        v4 = off_5A148;
        goto LABEL_57;
      }
      v3 = v15;
      v2 = v17;
      sub_28788(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 67i64, (__int64)&unk_57D28, *v5, v17, v15);
    }
    v7 = off_5A148;
    goto LABEL_26;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x49u, (__int64)&unk_57D28);
    v4 = off_5A148;
  }
  v9 = 6;
LABEL_57:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x4Au, (__int64)&unk_57D28);
  }
  return v9;
}

//----- (000000000002A134) ----------------------------------------------------
__int64 __fastcall sub_2A134(__int64 a1)
{
  unsigned int v1; // ebx
  PDEVICE_OBJECT v3; // rcx
  unsigned __int64 *v4; // rdi
  __int64 v5; // rsi
  __int64 v6; // r8
  int v8; // [rsp+20h] [rbp-28h]
  int v9; // [rsp+20h] [rbp-28h]
  int v10; // [rsp+50h] [rbp+8h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+58h] [rbp+10h] BYREF

  v1 = 0;
  v10 = 0;
  BugCheckParameter1 = 0i64;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Bu, (__int64)&unk_57D28);
    v3 = off_5A148;
  }
  v4 = *(unsigned __int64 **)(a1 + 16);
  if ( v4 )
  {
    v5 = sub_49034(qword_5A8D8, *v4, &BugCheckParameter1, &v10);
    if ( v10 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        v9 = sub_4A538(v10);
        sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Eu, (__int64)&unk_57D28, *v4, v9);
      }
      v1 = 5;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Cu, (__int64)&unk_57D28, *v4);
      }
      if ( !*(_BYTE *)(v5 + 289) )
      {
        sub_2C1F8(v5, v4[1]);
        *(_BYTE *)(v5 + 289) = 1;
        v1 = sub_2C470(v5);
      }
      LOBYTE(v6) = 1;
      sub_48B2C(qword_5A8D8, *v4, v6, &v10);
      if ( v10 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          v8 = sub_4A538(v10);
          sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Du, (__int64)&unk_57D28, *v4, v8);
        }
        v1 = 1;
      }
      sub_49CF0(qword_5A8D8, BugCheckParameter1);
    }
    sub_3C570(v4, 0x6D707453u);
    v3 = off_5A148;
  }
  else
  {
    if ( v3 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x4Fu, (__int64)&unk_57D28);
      v3 = off_5A148;
    }
    v1 = 6;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x50u, (__int64)&unk_57D28);
  }
  return v1;
}
// 2A23A: variable 'v6' is possibly undefined

//----- (000000000002A390) ----------------------------------------------------
__int64 __fastcall sub_2A390(unsigned __int64 *a1)
{
  __int64 v2; // rbx
  PDEVICE_OBJECT v3; // rcx
  __int64 v4; // rdx
  int v5; // eax
  unsigned int v6; // ebx
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  int v10; // [rsp+38h] [rbp+10h] BYREF

  v10 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x51u, (__int64)&unk_57D28);
  }
  v2 = sub_49034(qword_5A8D8, *a1, 0i64, &v10);
  if ( v10 )
  {
    v3 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x56u, (__int64)&unk_57D28, *a1);
      v3 = off_5A148;
    }
    v6 = 5;
    goto LABEL_34;
  }
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x52u, (__int64)&unk_57D28, *a1);
    v3 = off_5A148;
  }
  v4 = *((unsigned int *)a1 + 2);
  if ( *(_DWORD *)(v2 + 264) >= (unsigned int)v4 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x55u, (__int64)&unk_57D28);
      v3 = off_5A148;
    }
    v6 = 0;
    goto LABEL_34;
  }
  if ( !*(_DWORD *)(v2 + 316) )
  {
    v5 = sub_2BA9C(v2, v4);
    v6 = v5;
    if ( v5 )
    {
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        v8 = 83;
LABEL_17:
        sub_13EA4(*(_QWORD *)&v7->DeviceLock.Header.Lock, v8, (__int64)&unk_57D28, v5);
        return v6;
      }
      return v6;
    }
    goto LABEL_23;
  }
  v5 = sub_2BD54(v2, v4);
  v6 = v5;
  if ( !v5 )
  {
LABEL_23:
    v3 = off_5A148;
LABEL_34:
    if ( v3 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x57u, (__int64)&unk_57D28);
    }
    return v6;
  }
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    v8 = 84;
    goto LABEL_17;
  }
  return v6;
}

//----- (000000000002A5C4) ----------------------------------------------------
__int64 __fastcall sub_2A5C4(unsigned __int64 *a1)
{
  unsigned int v1; // ebx
  __int64 v3; // rsi
  PDEVICE_OBJECT v4; // rcx
  __int64 v5; // rdx
  __int64 v6; // rax
  unsigned int v7; // er9
  unsigned __int16 v8; // dx
  int v10; // [rsp+58h] [rbp+10h] BYREF

  v1 = 0;
  v10 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x58u, (__int64)&unk_57D28);
  }
  v3 = sub_49034(qword_5A8D8, *a1, 0i64, &v10);
  if ( v10 )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_28;
    }
    v8 = 92;
    goto LABEL_27;
  }
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x59u, (__int64)&unk_57D28, *a1);
    v4 = off_5A148;
  }
  v5 = *(_QWORD *)(v3 + 248);
  if ( !v5 )
  {
    if ( v4 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) == 0
      || BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_28;
    }
    v8 = 91;
LABEL_27:
    sub_12D64(*(_QWORD *)&v4->DeviceLock.Header.Lock, v8, (__int64)&unk_57D28, *a1);
    v4 = off_5A148;
LABEL_28:
    v1 = 5;
    goto LABEL_29;
  }
  v6 = *((unsigned int *)a1 + 2);
  v7 = *(_DWORD *)(v3 + 260);
  if ( (unsigned int)v6 >= v7 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_184C0(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x5Au, (__int64)&unk_57D28, v7);
    }
    a1[2] = 0i64;
    v1 = 4;
  }
  else
  {
    a1[2] = v5 + v6;
  }
  v4 = off_5A148;
LABEL_29:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x5Du, (__int64)&unk_57D28);
  }
  return v1;
}

//----- (000000000002A78C) ----------------------------------------------------
__int64 __fastcall sub_2A78C(unsigned __int64 *a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 v3; // rdi
  unsigned int v4; // eax
  PDEVICE_OBJECT v5; // rcx
  unsigned int v6; // ebx
  __int64 result; // rax
  int v8; // [rsp+40h] [rbp+8h] BYREF

  v8 = 0;
  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Eu, (__int64)&unk_57D28);
    v2 = off_5A148;
  }
  if ( a1[3] && *((_DWORD *)a1 + 8) )
  {
    v3 = sub_49034(qword_5A8D8, *a1, 0i64, &v8);
    if ( v8 )
    {
      v5 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x61u, (__int64)&unk_57D28, *a1);
        v5 = off_5A148;
      }
      v6 = 5;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x60u, (__int64)&unk_57D28, *a1);
      }
      v4 = sub_2B4D4(v3, (__int64)a1);
      v5 = off_5A148;
      v6 = v4;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x62u, (__int64)&unk_57D28);
    }
    result = v6;
  }
  else
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_4AC00(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x5Fu, (__int64)&unk_57D28);
    }
    result = 4i64;
  }
  return result;
}

//----- (000000000002A938) ----------------------------------------------------
__int64 __fastcall sub_2A938(unsigned __int64 *a1)
{
  unsigned int v1; // ebx
  PDEVICE_OBJECT v3; // rcx
  __int64 result; // rax
  __int64 v5; // rsi
  _QWORD *v6; // rbp
  __int64 v7; // rax
  PDEVICE_OBJECT v8; // rcx
  __int64 v9; // [rsp+30h] [rbp-58h] BYREF
  int v10; // [rsp+38h] [rbp-50h]
  int v11; // [rsp+3Ch] [rbp-4Ch]
  __int64 *v12; // [rsp+40h] [rbp-48h] BYREF
  __int64 v13; // [rsp+48h] [rbp-40h]
  __int64 v14; // [rsp+50h] [rbp-38h]
  __int64 Dst[2]; // [rsp+58h] [rbp-30h] BYREF
  char v16; // [rsp+68h] [rbp-20h]
  int v17; // [rsp+90h] [rbp+8h] BYREF

  v1 = 0;
  v17 = 0;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x63u, (__int64)&unk_57D28);
    v3 = off_5A148;
  }
  if ( a1 )
  {
    v5 = sub_49034(qword_5A8D8, *a1, 0i64, &v17);
    if ( v17 )
    {
      v8 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x67u, (__int64)&unk_57D28, *a1, v17);
        v8 = off_5A148;
      }
      v1 = 1;
    }
    else
    {
      v9 = 0i64;
      LODWORD(Dst[0]) = 0;
      v13 = 0i64;
      v14 = 0i64;
      v10 = 0;
      v11 = 0;
      memset((char *)Dst + 4, 0, 0x14ui64);
      v6 = (_QWORD *)a1[1];
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x65u, (__int64)&unk_57D28, *a1);
      }
      Dst[0] = *(_QWORD *)(v5 + 16);
      v7 = a1[1];
      LODWORD(v13) = 24;
      Dst[1] = v7;
      v16 = *((_BYTE *)a1 + 16);
      v12 = Dst;
      sub_1F7D8(517, (__int64 *)&v12);
      *(_QWORD *)(v5 + 304) = *v6;
      _InterlockedAdd((volatile signed __int32 *)(v5 + 296), 1u);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x66u, (__int64)&unk_57D28, *v6);
      }
      v9 = *(_QWORD *)(v5 + 16);
      LOBYTE(v10) = 1;
      v11 = 0;
      LODWORD(v13) = 16;
      v12 = &v9;
      sub_1F7D8(516, (__int64 *)&v12);
      v8 = off_5A148;
    }
    if ( v8 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v8->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x68u, (__int64)&unk_57D28);
    }
    result = v1;
  }
  else
  {
    if ( v3 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x64u, (__int64)&unk_57D28, 0i64);
    }
    result = 4i64;
  }
  return result;
}

//----- (000000000002ABC4) ----------------------------------------------------
__int64 __fastcall sub_2ABC4(unsigned __int64 *a1)
{
  __int64 v2; // rdi
  unsigned int v3; // eax
  PDEVICE_OBJECT v4; // rcx
  unsigned int v5; // ebx
  int v7; // [rsp+38h] [rbp+10h] BYREF

  v7 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x69u, (__int64)&unk_57D28);
  }
  v2 = sub_49034(qword_5A8D8, *a1, 0i64, &v7);
  if ( v7 )
  {
    v4 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Bu, (__int64)&unk_57D28, *a1);
      v4 = off_5A148;
    }
    v5 = 5;
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Au, (__int64)&unk_57D28, *a1);
    }
    v3 = sub_2BEE0(v2, (__int64)a1);
    *(_BYTE *)(v2 + 290) = 1;
    v4 = off_5A148;
    v5 = v3;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x6Cu, (__int64)&unk_57D28);
  }
  return v5;
}

//----- (000000000002AD1C) ----------------------------------------------------
__int64 __fastcall sub_2AD1C(_QWORD *a1)
{
  unsigned int v2; // edi
  PDEVICE_OBJECT v3; // rcx
  void *v4; // rcx

  v2 = 0;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Du, (__int64)&unk_57D28);
    v3 = off_5A148;
  }
  if ( a1 )
  {
    _InterlockedAdd(&dword_5A764, 0xFFFFFFFF);
    sub_2B6DC((__int64)a1);
    sub_2C064((__int64)a1);
    if ( *((_DWORD *)a1 + 79) )
    {
      v4 = (void *)a1[31];
      if ( v4 )
        sub_3C570(v4, 0x74647341u);
      goto LABEL_24;
    }
    if ( qword_5A678 )
    {
      if ( a1[5] )
      {
        (*(void (**)(void))(qword_5A678 + 16))();
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Eu, (__int64)&unk_57D28, *a1);
        }
        goto LABEL_24;
      }
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Fu, (__int64)&unk_57D28, *a1);
      }
    }
    else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
           && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
           && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x70u, (__int64)&unk_57D28);
    }
    v2 = 16;
LABEL_24:
    if ( *((_BYTE *)a1 + 148) )
      *((_BYTE *)a1 + 148) = 0;
    if ( *((_BYTE *)a1 + 244) )
      *((_BYTE *)a1 + 244) = 0;
    sub_3C978((__int64)qword_5A8E0, (__int64)a1);
    v3 = off_5A148;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x71u, (__int64)&unk_57D28);
  }
  return v2;
}
// 5A678: using guessed type __int64 qword_5A678;
// 5A764: using guessed type int dword_5A764;

//----- (000000000002AF24) ----------------------------------------------------
__int64 __fastcall sub_2AF24(__int64 a1, __int64 a2)
{
  unsigned int v4; // ebx
  unsigned int v5; // eax
  PDEVICE_OBJECT v6; // r10
  int v7; // er8
  unsigned int v8; // er9
  int v9; // ecx
  unsigned int v10; // ebx
  int v11; // eax
  PDEVICE_OBJECT v12; // rcx
  unsigned __int16 v13; // dx
  int v14; // eax

  v4 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x72u, (__int64)&unk_57D28);
  }
  v5 = *(_DWORD *)(a1 + 256) - *(_DWORD *)(a1 + 260);
  *(_DWORD *)(a1 + 264) = v5;
  if ( *(_DWORD *)(a2 + 16) <= v5 )
    goto LABEL_34;
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x73u, (__int64)&unk_57D28);
      v6 = off_5A148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x74u, (__int64)&unk_57D28, *(_DWORD *)(a1 + 256));
      v6 = off_5A148;
    }
  }
  v7 = *(_DWORD *)(a1 + 256);
  v8 = *(_DWORD *)(a2 + 16) - *(_DWORD *)(a1 + 264);
  if ( *(_DWORD *)(a1 + 272) > v8 )
    v8 = *(_DWORD *)(a1 + 272);
  v9 = *(unsigned __int8 *)(a1 + 280);
  if ( v8 <= v7 * v9 / 0x64u )
    v8 = v7 * v9 / 0x64u;
  v10 = v7 + v8;
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x75u, (__int64)&unk_57D28, v10);
  }
  if ( !*(_DWORD *)(a1 + 316) )
  {
    v11 = sub_2BA9C(a1, v10);
    v4 = v11;
    if ( v11 )
    {
      v12 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        v13 = 118;
LABEL_28:
        sub_13EA4(*(_QWORD *)&v12->DeviceLock.Header.Lock, v13, (__int64)&unk_57D28, v11);
        return v4;
      }
      return v4;
    }
LABEL_34:
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x78u, (__int64)&unk_57D28);
    }
    sub_53BD8(
      (void *)(*(_QWORD *)(a1 + 248) + *(unsigned int *)(a1 + 260)),
      *(unsigned int *)(a1 + 264),
      *(const void **)(a2 + 8),
      *(unsigned int *)(a2 + 16));
    v14 = *(_DWORD *)(a1 + 256);
    *(_DWORD *)(a1 + 260) += *(_DWORD *)(a2 + 16);
    *(_DWORD *)(a1 + 264) = v14 - *(_DWORD *)(a1 + 260);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x79u, (__int64)&unk_57D28);
    }
    return v4;
  }
  v11 = sub_2BD54(a1, v10);
  v4 = v11;
  if ( !v11 )
    goto LABEL_34;
  v12 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    v13 = 119;
    goto LABEL_28;
  }
  return v4;
}

//----- (000000000002B1E8) ----------------------------------------------------
__int64 __fastcall sub_2B1E8(__int64 a1, __int64 a2)
{
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx

  v4 = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x7Eu, (__int64)&unk_57D28);
    v5 = off_5A148;
  }
  if ( a1 )
  {
    if ( (unsigned int)(*(_DWORD *)(a2 + 16) + *(_DWORD *)(a1 + 260)) <= *(_DWORD *)(a1 + 268) )
    {
      if ( v5 == (PDEVICE_OBJECT)&off_5A148 )
        return v4;
      if ( (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x80u, (__int64)&unk_57D28);
        v5 = off_5A148;
      }
    }
    else
    {
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x7Fu, (__int64)&unk_57D28);
        v5 = off_5A148;
      }
      v4 = 1;
    }
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x81u, (__int64)&unk_57D28);
  }
  return v4;
}

//----- (000000000002B324) ----------------------------------------------------
__int64 __fastcall sub_2B324(__int64 a1, unsigned int a2, const void *a3, unsigned int a4)
{
  size_t v4; // rsi
  __int64 v6; // r12
  unsigned int v8; // ebx
  PDEVICE_OBJECT v9; // rcx
  int v10; // eax

  v4 = a4;
  v6 = a2;
  v8 = 0;
  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x82u, (__int64)&unk_57D28);
    v9 = off_5A148;
  }
  if ( a1 && a3 )
  {
    if ( *(_DWORD *)(a1 + 256) - (int)v6 < (unsigned int)v4 )
    {
      v10 = sub_2BA9C(a1, (unsigned int)(*(_DWORD *)(a1 + 256) + v4));
      v8 = v10;
      if ( v10 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x83u, (__int64)&unk_57D28, v10);
        }
        return v8;
      }
    }
    sub_53BD8((void *)(*(_QWORD *)(a1 + 248) + v6), *(unsigned int *)(a1 + 264), a3, v4);
    *(_DWORD *)(a1 + 260) += v4;
    *(_DWORD *)(a1 + 264) = *(_DWORD *)(a1 + 256) - *(_DWORD *)(a1 + 260);
    v9 = off_5A148;
  }
  else
  {
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x84u, (__int64)&unk_57D28);
      v9 = off_5A148;
    }
    v8 = 4;
  }
  if ( v9 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x85u, (__int64)&unk_57D28);
  }
  return v8;
}

//----- (000000000002B4D4) ----------------------------------------------------
__int64 __fastcall sub_2B4D4(__int64 a1, __int64 a2)
{
  _DWORD *v4; // rax
  _DWORD *v5; // rdi
  unsigned int v6; // edx
  char v7; // al
  PVOID v8; // rax
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  _QWORD *v11; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x88u, (__int64)&unk_57D28);
  }
  v4 = sub_3C910((__int64)qword_5A8E8);
  v5 = v4;
  if ( !v4 )
  {
    v9 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      return 3i64;
    }
    v10 = 138;
    goto LABEL_23;
  }
  memset(v4, 0, 0x38ui64);
  *((_QWORD *)v5 + 2) = *(_QWORD *)a2;
  v5[10] = *(_DWORD *)(a2 + 8);
  *((_QWORD *)v5 + 4) = *(_QWORD *)(a2 + 16);
  v6 = *(_DWORD *)(a2 + 32);
  v5[11] = v6;
  v7 = *(_BYTE *)(a2 + 36);
  *((_BYTE *)v5 + 48) = v7;
  if ( v7 )
  {
    v8 = sub_3C4EC(1, v6, 0x646D7341u);
    *((_QWORD *)v5 + 3) = v8;
    if ( !v8 )
    {
      sub_3C978((__int64)qword_5A8E8, 0i64);
      v9 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 3u )
      {
        return 3i64;
      }
      v10 = 137;
LABEL_23:
      sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, v10, (__int64)&unk_57D28);
      return 3i64;
    }
    memmove(v8, *(const void **)(a2 + 24), (unsigned int)v5[11]);
  }
  else
  {
    *((_QWORD *)v5 + 3) = *(_QWORD *)(a2 + 24);
  }
  sub_3D310((PFAST_MUTEX)(a1 + 80));
  v11 = *(_QWORD **)(a1 + 64);
  *(_QWORD *)v5 = a1 + 56;
  *((_QWORD *)v5 + 1) = v11;
  *v11 = v5;
  *(_QWORD *)(a1 + 64) = v5;
  ++*(_DWORD *)(a1 + 72);
  sub_3D3DC((PFAST_MUTEX)(a1 + 80));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x8Bu, (__int64)&unk_57D28);
  }
  return 0i64;
}

//----- (000000000002B6DC) ----------------------------------------------------
__int64 __fastcall sub_2B6DC(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  _QWORD **v3; // rbx
  _QWORD *v4; // rdi
  _QWORD *v5; // rax

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x8Cu, (__int64)&unk_57D28);
    v2 = off_5A148;
  }
  v3 = (_QWORD **)(a1 + 56);
  if ( *v3 != v3 )
  {
    do
    {
      v4 = *v3;
      v5 = (_QWORD *)**v3;
      *v3 = v5;
      v5[1] = v3;
      if ( *((_BYTE *)v4 + 48) )
        sub_3C570((PVOID)v4[3], 0x646D7341u);
      sub_3C978((__int64)qword_5A8E8, (__int64)v4);
      --*(_DWORD *)(a1 + 72);
    }
    while ( *v3 != v3 );
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x8Du, (__int64)&unk_57D28);
  }
  return 0i64;
}

//----- (000000000002B7E4) ----------------------------------------------------
__int64 __fastcall sub_2B7E4(int a1, __int64 a2, __int64 a3, __int64 **a4)
{
  unsigned int v8; // esi
  PDEVICE_OBJECT v9; // rcx
  __int64 *v10; // rdi
  __int64 *v11; // rbx
  unsigned __int16 v12; // dx

  v8 = 5;
  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x8Eu, (__int64)&unk_57D28);
    v9 = off_5A148;
  }
  *a4 = 0i64;
  v10 = (__int64 *)(a3 + 56);
  v11 = *(__int64 **)(a3 + 56);
  if ( v11 == v10 )
  {
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      v12 = 143;
LABEL_28:
      sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, v12, (__int64)&unk_57D28);
      return v8;
    }
  }
  else
  {
    while ( 1 )
    {
      if ( !v11
        && v9 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x90u, (__int64)&unk_57D28);
        v9 = off_5A148;
      }
      if ( *((_DWORD *)v11 + 10) == a1 && v11[4] == a2 )
        break;
      v11 = (__int64 *)*v11;
      if ( v11 == v10 )
        goto LABEL_24;
    }
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x91u, (__int64)&unk_57D28);
      v9 = off_5A148;
    }
    *a4 = v11;
    v8 = 0;
LABEL_24:
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v12 = 146;
      goto LABEL_28;
    }
  }
  return v8;
}

//----- (000000000002B978) ----------------------------------------------------
__int64 __fastcall sub_2B978(__int64 a1)
{
  unsigned int v1; // ebx
  PDEVICE_OBJECT v3; // rcx
  int v4; // eax
  __int64 *v6; // [rsp+20h] [rbp-28h] BYREF
  __int64 v7; // [rsp+28h] [rbp-20h]
  __int64 v8; // [rsp+30h] [rbp-18h]
  __int64 v9; // [rsp+50h] [rbp+8h] BYREF

  v1 = 0;
  v6 = 0i64;
  v9 = 0i64;
  v7 = 0i64;
  v8 = 0i64;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x93u, (__int64)&unk_57D28);
    v3 = off_5A148;
  }
  if ( !a1 )
    goto LABEL_12;
  v9 = a1;
  LODWORD(v7) = 8;
  v6 = &v9;
  v4 = sub_342A4(1025i64, (_QWORD ***)&v6);
  v1 = v4;
  if ( !v4 )
    goto LABEL_11;
  v3 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v1;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x94u, (__int64)&unk_57D28, v4);
LABEL_11:
    v3 = off_5A148;
  }
LABEL_12:
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x95u, (__int64)&unk_57D28);
  }
  return v1;
}

//----- (000000000002BA9C) ----------------------------------------------------
__int64 __fastcall sub_2BA9C(__int64 a1, __int64 a2)
{
  unsigned int v2; // esi
  unsigned int v4; // edi
  PDEVICE_OBJECT v5; // rcx
  __int64 v7; // rax
  int v8; // eax
  __int64 v9; // rbp
  unsigned int v10; // esi
  PDEVICE_OBJECT v11; // rcx

  v2 = a2;
  v4 = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x96u, (__int64)&unk_57D28);
    v5 = off_5A148;
  }
  if ( !qword_5A678 )
  {
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x97u, (__int64)&unk_57D28);
    }
    return 16i64;
  }
  if ( *(_DWORD *)(a1 + 256) )
  {
    v8 = (*(__int64 (__fastcall **)(_QWORD, _QWORD))(qword_5A678 + 8))(*(_QWORD *)(a1 + 40), v2);
    if ( v8 != 1792 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x9Au, (__int64)&unk_57D28, v8);
      }
      return 2i64;
    }
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x9Bu, (__int64)&unk_57D28, v2);
    }
  }
  else
  {
    LOBYTE(a2) = 1;
    v7 = (*(__int64 (__fastcall **)(_QWORD, __int64))qword_5A678)(v2, a2);
    *(_QWORD *)(a1 + 40) = v7;
    if ( v7 == -1 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x98u, (__int64)&unk_57D28);
      }
      return 2i64;
    }
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x99u, (__int64)&unk_57D28, v7);
    }
  }
  v9 = (*(__int64 (__fastcall **)(_QWORD))(qword_5A678 + 40))(*(_QWORD *)(a1 + 40));
  if ( v9 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x9Cu, (__int64)&unk_57D28);
    }
    *(_DWORD *)(a1 + 256) = v2;
    v10 = v2 - *(_DWORD *)(a1 + 260);
    *(_QWORD *)(a1 + 248) = v9;
    *(_DWORD *)(a1 + 264) = v10;
    v11 = off_5A148;
  }
  else
  {
    v11 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x9Du, (__int64)&unk_57D28);
      v11 = off_5A148;
    }
    v4 = 2;
  }
  if ( v11 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v11->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x9Eu, (__int64)&unk_57D28);
  }
  return v4;
}
// 2BB53: variable 'a2' is possibly undefined
// 5A678: using guessed type __int64 qword_5A678;

//----- (000000000002BD54) ----------------------------------------------------
__int64 __fastcall sub_2BD54(__int64 a1, unsigned int a2)
{
  unsigned int v4; // edi
  PVOID v5; // rbp
  unsigned int v6; // esi
  PDEVICE_OBJECT v7; // rcx

  v4 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x9Fu, (__int64)&unk_57D28);
  }
  v5 = sub_3C5E4(*(_DWORD *)(a1 + 316), *(void **)(a1 + 248), *(_DWORD *)(a1 + 256), a2, 0x74647341u);
  if ( v5 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA0u, (__int64)&unk_57D28, *(_DWORD *)(a1 + 316));
    }
    *(_DWORD *)(a1 + 256) = a2;
    v6 = a2 - *(_DWORD *)(a1 + 260);
    *(_QWORD *)(a1 + 248) = v5;
    *(_DWORD *)(a1 + 264) = v6;
    v7 = off_5A148;
  }
  else
  {
    v7 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA1u, (__int64)&unk_57D28);
      v7 = off_5A148;
    }
    v4 = 3;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0xA2u, (__int64)&unk_57D28);
  }
  return v4;
}

//----- (000000000002BEE0) ----------------------------------------------------
__int64 __fastcall sub_2BEE0(__int64 a1, __int64 a2)
{
  _DWORD *v4; // rax
  _DWORD *v5; // rdi
  _QWORD *v6; // rax
  __int64 result; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA3u, (__int64)&unk_57D28);
  }
  v4 = sub_3C910((__int64)qword_5A8F0);
  v5 = v4;
  if ( v4 )
  {
    memset(v4, 0, 0x38ui64);
    *((_QWORD *)v5 + 2) = *(_QWORD *)a2;
    *((_QWORD *)v5 + 3) = *(_QWORD *)(a2 + 8);
    v5[8] = *(_DWORD *)(a2 + 16);
    *((_QWORD *)v5 + 5) = *(_QWORD *)(a2 + 24);
    v5[12] = *(_DWORD *)(a2 + 32);
    sub_3D310((PFAST_MUTEX)(a1 + 176));
    v6 = *(_QWORD **)(a1 + 160);
    *(_QWORD *)v5 = a1 + 152;
    *((_QWORD *)v5 + 1) = v6;
    *v6 = v5;
    *(_QWORD *)(a1 + 160) = v5;
    ++*(_DWORD *)(a1 + 168);
    sub_3D3DC((PFAST_MUTEX)(a1 + 176));
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA5u, (__int64)&unk_57D28);
    }
    result = 0i64;
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA4u, (__int64)&unk_57D28);
    }
    result = 3i64;
  }
  return result;
}

//----- (000000000002C064) ----------------------------------------------------
__int64 __fastcall sub_2C064(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  _QWORD **v3; // rbx
  _QWORD *v4; // rdi
  _QWORD *v5; // rax

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA6u, (__int64)&unk_57D28);
    v2 = off_5A148;
  }
  v3 = (_QWORD **)(a1 + 152);
  if ( *v3 != v3 )
  {
    do
    {
      v4 = *v3;
      v5 = (_QWORD *)**v3;
      *v3 = v5;
      v5[1] = v3;
      if ( v4[5] != -1i64 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x11u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA7u, (__int64)&unk_57D28, v4[2]);
        }
        (*(void (__fastcall **)(_QWORD))(qword_5A678 + 104))(v4[5]);
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x11u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA8u, (__int64)&unk_57D28, v4[2]);
        }
        (*(void (__fastcall **)(_QWORD))(qword_5A678 + 72))(v4[5]);
      }
      sub_3C978((__int64)qword_5A8F0, (__int64)v4);
      --*(_DWORD *)(a1 + 168);
    }
    while ( *v3 != v3 );
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0xA9u, (__int64)&unk_57D28);
  }
  return 0i64;
}
// 5A678: using guessed type __int64 qword_5A678;

//----- (000000000002C1F8) ----------------------------------------------------
__int64 __fastcall sub_2C1F8(__int64 a1, __int64 a2)
{
  unsigned int v3; // ebx
  __int64 v4; // rax
  __int64 v5; // r8
  __int64 v6; // rcx
  unsigned int v7; // eax
  __int64 v9; // [rsp+38h] [rbp+10h]

  v9 = a2;
  v3 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xAAu, (__int64)&unk_57D28);
    a2 = v9;
  }
  if ( *(_BYTE *)(a1 + 290) )
  {
    v7 = sub_2C728(a1, a2);
    goto LABEL_12;
  }
  if ( !*(_DWORD *)(a1 + 316) )
  {
    v4 = (*(__int64 (__fastcall **)(_QWORD))(qword_5A678 + 40))(*(_QWORD *)(a1 + 40));
    v5 = v9;
    v6 = v4;
LABEL_8:
    v7 = sub_2C2F8(v6, *(_DWORD *)(a1 + 260), v5);
LABEL_12:
    v3 = v7;
    goto LABEL_13;
  }
  v6 = *(_QWORD *)(a1 + 248);
  if ( v6 )
  {
    v5 = a2;
    goto LABEL_8;
  }
LABEL_13:
  *(_BYTE *)(a1 + 289) = 1;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xABu, (__int64)&unk_57D28);
  }
  return v3;
}
// 5A678: using guessed type __int64 qword_5A678;

//----- (000000000002C2F8) ----------------------------------------------------
__int64 __fastcall sub_2C2F8(__int64 a1, int a2, __int64 a3)
{
  PDEVICE_OBJECT v5; // rcx
  int v7; // eax
  unsigned int v8; // ebx
  PDEVICE_OBJECT v9; // rcx
  __int64 v10; // [rsp+20h] [rbp-38h] BYREF
  __int64 v11; // [rsp+28h] [rbp-30h]
  __int64 v12; // [rsp+30h] [rbp-28h]
  __int64 *v13; // [rsp+38h] [rbp-20h] BYREF
  __int64 v14; // [rsp+40h] [rbp-18h]
  __int64 v15; // [rsp+48h] [rbp-10h]
  __int64 v16; // [rsp+70h] [rbp+18h]

  v16 = a3;
  v13 = 0i64;
  v10 = 0i64;
  v14 = 0i64;
  v15 = 0i64;
  v11 = 0i64;
  v12 = 0i64;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xACu, (__int64)&unk_57D28);
    a3 = v16;
    v5 = off_5A148;
  }
  if ( a1 )
  {
    v10 = a1;
    LODWORD(v11) = a2;
    v12 = a3;
    v13 = &v10;
    LODWORD(v14) = 24;
    v7 = sub_1F7D8(513, (__int64 *)&v13);
    v8 = v7;
    if ( v7 )
    {
      v9 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return v8;
      if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
LABEL_17:
        if ( v9 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0xAFu, (__int64)&unk_57D28);
        }
        return v8;
      }
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xAEu, (__int64)&unk_57D28, v7);
    }
    v9 = off_5A148;
    goto LABEL_17;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xADu, (__int64)&unk_57D28);
  }
  return 4i64;
}

//----- (000000000002C470) ----------------------------------------------------
__int64 __fastcall sub_2C470(__int64 a1)
{
  __int64 v2; // rax
  int v3; // er8
  __int64 v4; // rax
  int v5; // eax
  unsigned int v6; // ebx
  PDEVICE_OBJECT v7; // rcx
  __int64 *v9; // [rsp+20h] [rbp-48h] BYREF
  __int64 v10; // [rsp+28h] [rbp-40h]
  __int64 v11; // [rsp+30h] [rbp-38h]
  __int64 v12[2]; // [rsp+38h] [rbp-30h] BYREF
  int v13; // [rsp+48h] [rbp-20h]
  __int64 v14; // [rsp+4Ch] [rbp-1Ch]
  __int64 v15; // [rsp+54h] [rbp-14h]

  LODWORD(v12[0]) = 0;
  v10 = 0i64;
  v11 = 0i64;
  memset((char *)v12 + 4, 0, 0x20ui64);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB0u, (__int64)&unk_57D28);
  }
  v2 = *(_QWORD *)(a1 + 16);
  v3 = *(_DWORD *)(a1 + 32);
  v11 = 0i64;
  v12[0] = v2;
  v12[1] = *(_QWORD *)(a1 + 24);
  v14 = *(_QWORD *)(a1 + 48);
  v4 = *(_QWORD *)a1;
  v13 = v3;
  v15 = v4;
  LODWORD(v10) = 36;
  v9 = v12;
  v5 = sub_17324(261, (__int64)&v9, v3);
  v6 = v5;
  if ( !v5 )
    goto LABEL_10;
  v7 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v6;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB1u, (__int64)&unk_57D28, v5);
LABEL_10:
    v7 = off_5A148;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0xB2u, (__int64)&unk_57D28);
  }
  return v6;
}

//----- (000000000002C5B4) ----------------------------------------------------
__int64 __fastcall sub_2C5B4(__int64 a1, __int64 a2, unsigned int a3)
{
  __int64 v6; // rax
  int v7; // er8
  int v8; // eax
  unsigned int v9; // ebx
  PDEVICE_OBJECT v10; // rcx
  __int64 *v12; // [rsp+20h] [rbp-58h] BYREF
  __int64 v13; // [rsp+28h] [rbp-50h]
  __int64 v14; // [rsp+30h] [rbp-48h]
  __int64 v15; // [rsp+38h] [rbp-40h] BYREF
  __int64 v16[5]; // [rsp+40h] [rbp-38h] BYREF

  v15 = 0i64;
  v13 = 0i64;
  v14 = 0i64;
  memset(v16, 0, sizeof(v16));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB3u, (__int64)&unk_57D28);
  }
  v6 = *(_QWORD *)(a1 + 16);
  v7 = *(_DWORD *)(a1 + 32);
  v14 = 0i64;
  v16[0] = v6;
  v16[1] = *(_QWORD *)(a1 + 24);
  v15 = *(_QWORD *)a1;
  v16[2] = __PAIR64__(*(_DWORD *)(a1 + 284), v7);
  LODWORD(v6) = *(_DWORD *)(a1 + 312);
  v16[3] = a2;
  v16[4] = __PAIR64__(v6, a3);
  v12 = &v15;
  LODWORD(v13) = 48;
  v8 = sub_17324(262, (__int64)&v12, v7);
  v9 = v8;
  if ( !v8 )
    goto LABEL_10;
  v10 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v9;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB4u, (__int64)&unk_57D28, v8);
LABEL_10:
    v10 = off_5A148;
  }
  if ( v10 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v10->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v10->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v10->DeviceLock.Header.Lock, 0xB5u, (__int64)&unk_57D28);
  }
  return v9;
}

//----- (000000000002C728) ----------------------------------------------------
__int64 __fastcall sub_2C728(__int64 a1, __int64 a2)
{
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  __int64 v6; // r13
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  __int64 *v9; // rbx
  int v10; // er12
  __int64 v11; // rbp
  __int64 v12; // rax
  unsigned int v13; // ebp
  PDEVICE_OBJECT v14; // rcx
  __int64 *v15; // [rsp+70h] [rbp+8h] BYREF
  __int64 v16; // [rsp+78h] [rbp+10h]

  v16 = a2;
  v15 = 0i64;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xB6u, (__int64)&unk_57D28);
    v3 = off_5A148;
  }
  if ( !*(_BYTE *)(a1 + 290) )
  {
    if ( v3 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x20) == 0
      || BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 5i64;
    }
    v4 = 183;
LABEL_10:
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, v4, (__int64)&unk_57D28);
    return 5i64;
  }
  if ( *(_DWORD *)(a1 + 316) )
  {
    v6 = *(_QWORD *)(a1 + 248);
  }
  else
  {
    v6 = (*(__int64 (__fastcall **)(_QWORD))(qword_5A678 + 40))(*(_QWORD *)(a1 + 40));
    if ( !v6 )
    {
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        v8 = 184;
LABEL_18:
        sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, v8, (__int64)&unk_57D28);
      }
      return 6i64;
    }
    v3 = off_5A148;
  }
  v9 = *(__int64 **)(a1 + 152);
  if ( v9 == (__int64 *)(a1 + 152) )
  {
    if ( v3 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x20) == 0
      || BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 5i64;
    }
    v4 = 185;
    goto LABEL_10;
  }
  while ( 1 )
  {
    if ( !v9 )
    {
      if ( v3 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v3->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0xBAu, (__int64)&unk_57D28);
      }
      return 12i64;
    }
    if ( (unsigned int)sub_2B7E4(0, v9[3], a1, &v15) || !v15 )
      break;
    v10 = *(_DWORD *)v15[3];
    if ( (unsigned int)sub_2B7E4(1, v9[3], a1, &v15) || !v15 )
    {
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        v8 = 188;
        goto LABEL_18;
      }
      return 6i64;
    }
    v11 = *(unsigned int *)v15[3];
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_184C0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xBDu, (__int64)&unk_57D28, v10);
    }
    sub_2C2F8(v6, v10, v16);
    v12 = (*(__int64 (__fastcall **)(__int64))(qword_5A678 + 96))(v9[5]);
    if ( !v12 )
    {
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x11u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xBEu, (__int64)&unk_57D28, v9[2]);
          v7 = off_5A148;
        }
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          v8 = 191;
          goto LABEL_18;
        }
      }
      return 6i64;
    }
    sub_2C2F8(v12, *((_DWORD *)v9 + 12), v16);
    v13 = sub_2C2F8(v6 + v11, *(_DWORD *)(a1 + 260) - (int)v11, v16);
    if ( v9[5] != -1 )
    {
      v14 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x11u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xC0u, (__int64)&unk_57D28, v9[2]);
          v14 = off_5A148;
        }
        if ( v14 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v14->DeviceLock.Header.WaitListHead.Blink + 1, 0x11u)
          && BYTE1(v14->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&v14->DeviceLock.Header.Lock, 0xC1u, (__int64)&unk_57D28, v9[2]);
        }
      }
      (*(void (__fastcall **)(__int64))(qword_5A678 + 104))(v9[5]);
      (*(void (__fastcall **)(__int64))(qword_5A678 + 72))(v9[5]);
    }
    v9 = (__int64 *)*v9;
    v3 = off_5A148;
    if ( v9 == (__int64 *)(a1 + 152) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xC2u, (__int64)&unk_57D28);
      }
      return v13;
    }
  }
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    v8 = 187;
    goto LABEL_18;
  }
  return 6i64;
}
// 5A678: using guessed type __int64 qword_5A678;

//----- (000000000002CB70) ----------------------------------------------------
__int64 __fastcall sub_2CB70(__int64 a1, __int64 *a2, _DWORD *a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  __int64 result; // rax
  __int64 v9; // rax
  __int64 v10; // rbx
  __int64 v11; // rdi
  PDEVICE_OBJECT v12; // rcx
  int v13; // eax

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xC3u, (__int64)&unk_57D28);
    v6 = off_5A148;
  }
  if ( !*(_BYTE *)(a1 + 290) )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 0x20) == 0
      || BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 5i64;
    }
    v7 = 196;
LABEL_10:
    sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, v7, (__int64)&unk_57D28);
    return 5i64;
  }
  v9 = a1 + 152;
  v10 = *(_QWORD *)(a1 + 152);
  if ( v10 == v9 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 0x20) == 0
      || BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      return 5i64;
    }
    v7 = 197;
    goto LABEL_10;
  }
  if ( v10 )
  {
    v11 = (*(__int64 (__fastcall **)(_QWORD))(qword_5A678 + 96))(*(_QWORD *)(v10 + 40));
    if ( v11 )
    {
      v12 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x11u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xC8u, (__int64)&unk_57D28, *(_QWORD *)(v10 + 16));
        v12 = off_5A148;
      }
      if ( *(_QWORD *)(v10 + 40) != -1i64 )
      {
        if ( v12 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v12->DeviceLock.Header.WaitListHead.Blink + 1, 0x11u)
          && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0xC9u, (__int64)&unk_57D28, *(_QWORD *)(v10 + 16));
        }
        (*(void (__fastcall **)(_QWORD))(qword_5A678 + 104))(*(_QWORD *)(v10 + 40));
        v12 = off_5A148;
      }
      v13 = *(_DWORD *)(v10 + 48);
      *a2 = v11;
      *a3 = v13;
      if ( v12 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v12->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0xCAu, (__int64)&unk_57D28);
      }
      result = 0i64;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xC7u, (__int64)&unk_57D28);
      }
      result = 6i64;
    }
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0xC6u, (__int64)&unk_57D28);
    }
    result = 12i64;
  }
  return result;
}
// 5A678: using guessed type __int64 qword_5A678;

//----- (000000000002CDB0) ----------------------------------------------------
__int64 __fastcall sub_2CDB0(__int64 a1, __int64 a2, int a3)
{
  PDEVICE_OBJECT v5; // rcx
  __int64 result; // rax
  int v7; // ebx
  __int64 v8; // [rsp+30h] [rbp-38h] BYREF
  int v9; // [rsp+38h] [rbp-30h]
  int v10; // [rsp+3Ch] [rbp-2Ch]
  __int64 *v11; // [rsp+40h] [rbp-28h] BYREF
  __int64 v12; // [rsp+48h] [rbp-20h]
  __int64 v13; // [rsp+50h] [rbp-18h]

  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xD2u, (__int64)&unk_57D28);
    v5 = off_5A148;
  }
  if ( a1 )
  {
    if ( *(_DWORD *)a1 )
    {
      v8 = 0i64;
      v12 = 0i64;
      v13 = 0i64;
      v9 = 0;
      v10 = 0;
      v7 = 4;
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_4AC00(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xD4u, (__int64)&unk_57D28, *(_QWORD *)(a1 + 8), a3);
      }
      if ( a3 <= 0 || a3 > 3 )
        v7 = 3;
      v8 = a2;
      LOBYTE(v9) = 0;
      v10 = v7;
      LODWORD(v12) = 16;
      v11 = &v8;
      sub_1F7D8(516, (__int64 *)&v11);
      v5 = off_5A148;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xD5u, (__int64)&unk_57D28);
    }
    result = 0i64;
  }
  else
  {
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xD3u, (__int64)&unk_57D28, 0i64);
    }
    result = 4i64;
  }
  return result;
}

//----- (000000000002CF4C) ----------------------------------------------------
__int64 sub_2CF4C()
{
  volatile signed __int32 *v0; // rbx
  __int64 v1; // r8
  PDEVICE_OBJECT v2; // rcx
  int v3; // eax
  __m128i v5; // [rsp+30h] [rbp-28h] BYREF
  int v6; // [rsp+60h] [rbp+8h] BYREF
  ULONG_PTR v7; // [rsp+68h] [rbp+10h] BYREF

  v7 = 0i64;
  v6 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xD6u, (__int64)&unk_57D28);
  }
  v0 = (volatile signed __int32 *)sub_49870(qword_5A8D8, &v7, &v6);
  if ( v0 )
  {
    do
    {
      v5.m128i_i32[0] = 0;
      v5.m128i_i64[1] = 0i64;
      v5 = _mm_loadu_si128((const __m128i *)(v0 + 74));
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EE0(
          *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
          0xD8u,
          (__int64)&unk_57D28,
          *(_QWORD *)v0,
          *((_QWORD *)v0 + 38));
      }
      if ( _InterlockedCompareExchange(v0 + 74, 0, 1) )
      {
        sub_2CDB0((__int64)&v5, *((_QWORD *)v0 + 2), 4);
      }
      else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
             && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
             && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xD9u, (__int64)&unk_57D28, *(_QWORD *)v0);
      }
      LOBYTE(v1) = 1;
      v0 = (volatile signed __int32 *)sub_49A3C(qword_5A8D8, &v7, v1, &v6);
    }
    while ( v0 );
    goto LABEL_21;
  }
  v2 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return 0i64;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v3 = sub_4A538(v6);
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xD7u, (__int64)&unk_57D28, v3);
LABEL_21:
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0xDAu, (__int64)&unk_57D28);
  }
  return 0i64;
}
// 2D0E2: variable 'v1' is possibly undefined

//----- (000000000002D13C) ----------------------------------------------------
__int64 __fastcall sub_2D13C(_QWORD *a1, _QWORD *a2)
{
  PDEVICE_OBJECT v4; // rcx
  unsigned int v6; // ebx
  PDEVICE_OBJECT v7; // rcx
  _QWORD *v8; // [rsp+20h] [rbp-28h] BYREF
  __int64 v9; // [rsp+28h] [rbp-20h]
  __int64 v10; // [rsp+30h] [rbp-18h]

  v8 = 0i64;
  v9 = 0i64;
  v10 = 0i64;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xDBu, (__int64)&unk_57D28);
    v4 = off_5A148;
  }
  if ( *a1 )
  {
    *a2 = *a1;
    v8 = a2;
    LODWORD(v9) = 96;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xDDu, (__int64)&unk_57D28, *a1, v8, v9, v10);
    }
    v6 = sub_1F7D8(520, (__int64 *)&v8);
    if ( v6 )
    {
      v7 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return v6;
      if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) == 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
LABEL_21:
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0xDFu, (__int64)&unk_57D28);
        }
        return v6;
      }
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xDEu, (__int64)&unk_57D28, *a1);
    }
    v7 = off_5A148;
    goto LABEL_21;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0xDCu, (__int64)&unk_57D28);
  }
  return 4i64;
}

//----- (000000000002D2C8) ----------------------------------------------------
__int64 __fastcall sub_2D2C8(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+A8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D18, 98i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002D348) ----------------------------------------------------
__int64 __fastcall sub_2D348(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+C8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D18, 155i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002D3E0) ----------------------------------------------------
__int64 __fastcall sub_2D3E0(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+C8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D18, 156i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002D478) ----------------------------------------------------
__int64 sub_2D478(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+E8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D18, 154i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002D530) ----------------------------------------------------
__int64 __fastcall sub_2D530(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D18, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002D598) ----------------------------------------------------
__int64 __fastcall sub_2D598(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57D18, 112i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002D608) ----------------------------------------------------
__int64 sub_2D608(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D18, 107i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002D678) ----------------------------------------------------
__int64 __fastcall sub_2D678(__int16 a1)
{
  _DWORD *v2; // rax
  __int64 v3; // rbx
  PVOID v5; // rax
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  PVOID v8; // rax
  signed __int64 v9; // r9

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xAu, (__int64)&unk_57D18);
  }
  v2 = sub_3C910((__int64)qword_5A8B8);
  v3 = (__int64)v2;
  if ( !v2 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xBu, (__int64)&unk_57D18);
    }
    return 0i64;
  }
  memset(v2, 0, 0xD8ui64);
  v5 = sub_3C4EC(1, 0x10000u, 0x6F537453u);
  *(_QWORD *)(v3 + 80) = v5;
  if ( !v5 )
  {
    v6 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_17;
    }
    v7 = 12;
LABEL_16:
    sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, v7, (__int64)&unk_57D18);
LABEL_17:
    sub_3C978((__int64)qword_5A8B8, v3);
    return 0i64;
  }
  *(_DWORD *)(v3 + 116) = 0;
  *(_QWORD *)(v3 + 152) = 0i64;
  *(_QWORD *)(v3 + 120) = sub_3C4EC(1, 0x10000u, 0x6F537453u);
  if ( !*(_QWORD *)(v3 + 80) )
  {
    v6 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_17;
    }
    v7 = 13;
    goto LABEL_16;
  }
  *(_QWORD *)(v3 + 136) = 0i64;
  *(_DWORD *)(v3 + 144) = 0;
  v8 = sub_3C4EC(1, 0x80u, 0x6F537453u);
  *(_QWORD *)(v3 + 96) = v8;
  if ( !v8 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xEu, (__int64)&unk_57D18);
    }
    sub_3C570(*(PVOID *)(v3 + 80), 0x6F537453u);
    goto LABEL_17;
  }
  *(_DWORD *)(v3 + 104) = 128;
  memset(v8, 0, 0x80ui64);
  sub_3D01C((struct _KEVENT **)(v3 + 184), 0);
  sub_3D01C((struct _KEVENT **)(v3 + 192), 0);
  v9 = _InterlockedIncrement64(&qword_5D418);
  *(_DWORD *)(v3 + 16) = 1;
  *(_BYTE *)(v3 + 60) = 0;
  *(_BYTE *)(v3 + 32) = 1;
  *(_WORD *)(v3 + 168) = a1 - 94;
  *(_QWORD *)v3 = v9;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xFu, (__int64)&unk_57D18);
  }
  return v3;
}
// 5D418: using guessed type __int64 qword_5D418;

//----- (000000000002D968) ----------------------------------------------------
__int64 __fastcall sub_2D968(__int64 a1)
{
  void *v2; // rcx
  void *v3; // rcx
  void *v4; // rcx
  void *v5; // rcx
  __int64 v6; // rcx
  void *v7; // rcx
  void *v8; // rcx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x10u, (__int64)&unk_57D18);
  }
  sub_3D0FC(*(PRKEVENT *)(a1 + 192));
  v2 = *(void **)(a1 + 136);
  if ( v2 )
    sub_3C570(v2, 0x6F537453u);
  v3 = *(void **)(a1 + 120);
  if ( v3 )
  {
    if ( *(_DWORD *)(a1 + 116) )
    {
      if ( *(_DWORD *)(a1 + 116) != 1 )
        goto LABEL_12;
      v3 = *(void **)(a1 + 152);
    }
    sub_3C570(v3, 0x6F537453u);
  }
LABEL_12:
  v4 = *(void **)(a1 + 80);
  if ( v4 )
    sub_3C570(v4, 0x6F537453u);
  v5 = *(void **)(a1 + 96);
  if ( v5 )
    sub_3C570(v5, 0x6F537453u);
  v6 = *(_QWORD *)(a1 + 160);
  if ( v6 )
    sub_2E5FC(v6);
  v7 = *(void **)(a1 + 192);
  if ( v7 )
    sub_3D094(v7);
  v8 = *(void **)(a1 + 184);
  if ( v8 )
    sub_3D094(v8);
  sub_3C978((__int64)qword_5A8B8, a1);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x12u, (__int64)&unk_57D18);
  }
  return 0i64;
}

//----- (000000000002DB00) ----------------------------------------------------
char __fastcall sub_2DB00(int a1, unsigned __int16 a2, _DWORD *a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x13u, (__int64)&unk_57D18);
    v6 = off_5A148;
  }
  if ( a1 - *a3 < 0 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v6->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      || BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      return 0;
    }
    v7 = 20;
LABEL_10:
    sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, v7, (__int64)&unk_57D18);
    return 0;
  }
  if ( a1 + a2 - a3[2] > 0 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v6->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      || BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      return 0;
    }
    v7 = 21;
    goto LABEL_10;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v6->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x16u, (__int64)&unk_57D18);
  }
  return 1;
}

//----- (000000000002DC18) ----------------------------------------------------
char __fastcall sub_2DC18(int a1, unsigned __int16 a2, __int64 a3)
{
  unsigned int v3; // ebx
  int v6; // er12
  PDEVICE_OBJECT v8; // r10
  PDEVICE_OBJECT *v9; // rax
  unsigned __int16 v10; // dx
  unsigned int v11; // edi
  __int64 v12; // rsi
  _DWORD *v13; // r10
  _DWORD *v14; // rdx
  int v15; // ecx
  int v16; // eax
  __int64 v17; // rsi
  _DWORD *v18; // r8
  int v19; // ecx
  __int64 v20; // rdi
  _DWORD *i; // rax
  unsigned __int64 v22; // rcx
  int v23; // er14
  PVOID v24; // rax
  __int64 v25; // rcx
  __int64 v26; // rcx
  int v27; // eax
  char j; // al
  __int64 v29; // rdi
  unsigned __int16 v31; // [rsp+78h] [rbp+10h]

  v31 = a2;
  v3 = 0;
  v6 = 0;
  v8 = off_5A148;
  v9 = &off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x17u, (__int64)&unk_57D18);
    v8 = off_5A148;
    v9 = &off_5A148;
  }
  if ( a2 )
  {
    if ( v8 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v8->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
      && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x19u, (__int64)&unk_57D18);
      v8 = off_5A148;
    }
    v11 = 0;
    v12 = 0i64;
    do
    {
      if ( v8 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v8->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
        && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_2D530(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x1Au, (__int64)&unk_57D18, v11);
        v8 = off_5A148;
      }
      v11 += 2;
      v12 += 8i64;
    }
    while ( v11 < 0x20 );
    v13 = *(_DWORD **)(a3 + 16);
    v14 = v13 + 1;
    v15 = v13[1] - a1;
    if ( v15 >= 0 )
      v16 = v15 <= 0;
    else
      v16 = 2;
    v17 = 0i64;
    v18 = *(_DWORD **)(a3 + 16);
    while ( (*v18 || *v14) && v16 == 2 )
    {
      v17 += 2i64;
      v6 += 2;
      v14 += 2;
      v18 = &v13[v17];
      v19 = v18[1] - a1;
      if ( v19 >= 0 )
        v16 = v19 <= 0;
    }
    v20 = v6;
    for ( i = &v13[v6]; *i || i[1]; i += 2 )
      v20 += 2i64;
    v22 = *(unsigned int *)(a3 + 24);
    v23 = v6 + 2;
    if ( 4i64 * (v6 + 2) >= v22 )
    {
      v24 = sub_3C5E4(2, v13, v22, (int)v22 + 128, 0x6F537453u);
      *(_QWORD *)(a3 + 16) = v24;
      if ( !v24 )
      {
        v9 = &off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          v25 = *(_QWORD *)&off_5A148->DeviceLock.Header.Lock;
          v10 = 27;
LABEL_72:
          LOBYTE(v9) = sub_11088(v25, v10, (__int64)&unk_57D18);
          return (char)v9;
        }
        return (char)v9;
      }
      *(_DWORD *)(a3 + 24) += 128;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Cu, (__int64)&unk_57D18);
      }
    }
    while ( v20 >= v17 )
    {
      v26 = *(_QWORD *)(a3 + 16);
      v27 = *(_DWORD *)(v26 + 4 * v20--);
      *(_DWORD *)(v26 + 4 * v20 + 12) = v27;
    }
    *(_DWORD *)(*(_QWORD *)(a3 + 16) + 4i64 * v6) = a1;
    *(_DWORD *)(*(_QWORD *)(a3 + 16) + 4i64 * v6 + 4) = v31 + a1 - 1;
    for ( j = sub_2E274(a3, v6, v23); j; j = sub_2E274(a3, v6, v23) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Du, (__int64)&unk_57D18);
      }
    }
    while ( 1 )
    {
      LOBYTE(v9) = sub_2E274(a3, v6 - 2, v6);
      if ( !(_BYTE)v9 )
        break;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Eu, (__int64)&unk_57D18);
      }
    }
    v8 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      LOBYTE(v9) = sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Fu, (__int64)&unk_57D18);
      v8 = off_5A148;
    }
    v29 = 0i64;
    do
    {
      if ( v8 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v8->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
        && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        LOBYTE(v9) = sub_2D530(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x20u, (__int64)&unk_57D18, v3);
        v8 = off_5A148;
      }
      v3 += 2;
      v29 += 8i64;
    }
    while ( v3 < 0x20 );
    if ( v8 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v8->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v10 = 33;
      goto LABEL_71;
    }
  }
  else if ( v8 != (PDEVICE_OBJECT)&off_5A148
         && _bittest((const signed __int32 *)&v8->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
         && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v10 = 24;
LABEL_71:
    v25 = *(_QWORD *)&v8->DeviceLock.Header.Lock;
    goto LABEL_72;
  }
  return (char)v9;
}

//----- (000000000002E098) ----------------------------------------------------
__int64 __fastcall sub_2E098(int a1, unsigned __int16 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  __int64 result; // rax

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x22u, (__int64)&unk_57D18);
    v6 = off_5A148;
  }
  result = *(_DWORD *)(a3 + 4) - (unsigned int)a2 - a1;
  if ( (int)result < 0 )
  {
    *(_DWORD *)(a3 + 4) = a2 + a1;
    v6 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return result;
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      result = sub_13EA4(
                 *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
                 0x23u,
                 (__int64)&unk_57D18,
                 (unsigned int)a2 + a1);
      v6 = off_5A148;
    }
  }
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v6->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x24u, (__int64)&unk_57D18);
  }
  return result;
}

//----- (000000000002E198) ----------------------------------------------------
__int16 __fastcall sub_2E198(int a1, __int64 a2, __int64 a3)
{
  int v5; // edi
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // ax
  int v8; // eax
  __int16 v9; // ax

  LOWORD(v5) = 0;
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x25u, (__int64)&unk_57D18);
    v6 = off_5A148;
  }
  if ( *(_DWORD *)a3 - a1 < 0 )
  {
    v7 = a1 - *(_WORD *)a3;
    *(_DWORD *)a3 = a1;
    v5 = v7;
    v8 = *(_DWORD *)(a3 + 4);
    *(_DWORD *)(a3 + 8) += v5;
    if ( v8 - a1 < 0 )
    {
      v9 = *(_WORD *)(a3 + 4);
      *(_DWORD *)(a3 + 4) = a1;
      LOWORD(v5) = v9 - a1 + v5;
    }
    v6 = off_5A148;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v6->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x26u, (__int64)&unk_57D18);
  }
  return v5;
}

//----- (000000000002E274) ----------------------------------------------------
char __fastcall sub_2E274(__int64 a1, int a2, int a3)
{
  __int64 v3; // rdi
  __int64 v4; // rsi
  PDEVICE_OBJECT v6; // r9
  __int64 v7; // rax
  __int64 v9; // r8
  __int64 v10; // rax

  v3 = a3;
  v4 = a2;
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Cu, (__int64)&unk_57D18);
    v6 = off_5A148;
  }
  if ( (int)v4 < 0 )
    return 0;
  if ( (int)v3 < 0 )
    return 0;
  v7 = *(_QWORD *)(a1 + 16);
  if ( !*(_DWORD *)(v7 + 4 * v3) && !*(_DWORD *)(v7 + 4 * v3 + 4) )
    return 0;
  if ( *(_DWORD *)(v7 + 4 * v4 + 4) - *(_DWORD *)(v7 + 4 * v3) + 1 < 0 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x2Du, (__int64)&unk_57D18);
    }
    return 0;
  }
  v9 = 4 * v3 + 4;
  *(_DWORD *)(*(_QWORD *)(a1 + 16) + 4 * v4 + 4) = *(_DWORD *)(v7 + 4 * v3 + 4);
  while ( 1 )
  {
    v10 = *(_QWORD *)(a1 + 16);
    if ( !*(_DWORD *)(v9 + v10 - 4) && !*(_DWORD *)(v9 + v10) )
      break;
    *(_DWORD *)(v9 + v10 - 4) = *(_DWORD *)(v9 + v10 + 4);
    *(_DWORD *)(v9 + *(_QWORD *)(a1 + 16)) = *(_DWORD *)(v9 + *(_QWORD *)(a1 + 16) + 8);
    v9 += 8i64;
  }
  return 1;
}

//----- (000000000002E39C) ----------------------------------------------------
__int64 *__fastcall sub_2E39C(void *Src, unsigned int a2)
{
  __int64 *v4; // rsi
  PVOID v6; // rdi
  _BYTE *v7; // rbx
  _BYTE *v8; // rdi
  char v9; // [rsp+60h] [rbp+18h] BYREF
  char v10; // [rsp+68h] [rbp+20h] BYREF

  v9 = 0;
  v10 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Eu, (__int64)&unk_57D18);
  }
  v4 = (__int64 *)sub_3C910((__int64)qword_5A8A8);
  if ( !v4 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Fu, (__int64)&unk_57D18);
    }
    return 0i64;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x30u, (__int64)&unk_57D18, a2);
  }
  v6 = sub_3C4EC(2, a2, 0x624E734Eu);
  if ( !v6 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x31u, (__int64)&unk_57D18);
    }
    sub_3C978((__int64)qword_5A8A8, (__int64)v4);
    return 0i64;
  }
  memmove(v4, Src, 0x190ui64);
  *v4 = 0i64;
  v4[1] = 0i64;
  *((_DWORD *)v4 + 32) = 2;
  v4[2] = (__int64)v6;
  memmove(v6, *((const void **)Src + 2), *((unsigned int *)Src + 31));
  if ( (*((_BYTE *)Src + 120) & 0x10) != 0 )
    *((_DWORD *)v4 + 30) |= 0x10u;
  *(__int64 *)((char *)v4 + 220) = 0i64;
  *((_DWORD *)v4 + 30) &= 0xFFFFFFFB;
  *(__int64 *)((char *)v4 + 132) = 0i64;
  *((_DWORD *)v4 + 35) = 0;
  v7 = sub_4AE28(v4[2], 1);
  v8 = sub_4AE28(v4[2], 3);
  sub_4FDA4((__int64)v8);
  sub_4BD84(v7, &v9);
  v9 *= 4;
  sub_4D33C((__int64)v8, &v10);
  v10 *= 4;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x32u, (__int64)&unk_57D18);
  }
  return v4;
}

//----- (000000000002E5FC) ----------------------------------------------------
__int64 __fastcall sub_2E5FC(__int64 a1)
{
  unsigned int v2; // ebx
  PDEVICE_OBJECT v3; // rcx
  void *v4; // rcx

  v2 = 0;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x33u, (__int64)&unk_57D18);
    v3 = off_5A148;
  }
  if ( a1 )
  {
    v4 = *(void **)(a1 + 16);
    if ( v4 )
      sub_3C570(v4, 0x624E734Eu);
    sub_3C978((__int64)qword_5A8A8, a1);
    v3 = off_5A148;
  }
  else
  {
    if ( v3 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v3->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x34u, (__int64)&unk_57D18);
      v3 = off_5A148;
    }
    v2 = 4;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v3->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x35u, (__int64)&unk_57D18);
  }
  return v2;
}

//----- (000000000002E71C) ----------------------------------------------------
char __fastcall sub_2E71C(__int64 a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  _DWORD *v5; // rax
  unsigned __int16 v6; // dx

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x36u, (__int64)&unk_57D18);
    v4 = off_5A148;
  }
  v5 = *(_DWORD **)(a2 + 16);
  if ( !*v5 && !v5[1] )
  {
    if ( v4 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      || BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      return 0;
    }
    v6 = 55;
LABEL_21:
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, v6, (__int64)&unk_57D18);
    return 0;
  }
  if ( *v5 != *(_DWORD *)(a1 + 112) + 1 )
  {
    if ( v4 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      || BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      return 0;
    }
    v6 = 57;
    goto LABEL_21;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x38u, (__int64)&unk_57D18);
  }
  return 1;
}

//----- (000000000002E830) ----------------------------------------------------
__int64 __fastcall sub_2E830(__int64 a1)
{
  unsigned int v2; // ebp
  int v3; // ecx
  int v4; // er12
  __int64 v5; // rcx
  int v6; // ebx
  __int64 v7; // rdi
  __int64 result; // rax
  unsigned __int16 v9; // [rsp+30h] [rbp-28h]

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Au, (__int64)&unk_57D18);
  }
  v2 = 0;
  v3 = *(_DWORD *)(*(_QWORD *)(a1 + 96) + 4i64);
  if ( v3 )
    v4 = v3 + 1;
  else
    v4 = *(_DWORD *)(a1 + 52);
  v5 = *(unsigned int *)(a1 + 176);
  v6 = *(_DWORD *)(a1 + 20) + *(_DWORD *)(a1 + 172) - v5 - *(_DWORD *)(a1 + 24);
  v7 = v5 + *(_QWORD *)(a1 + 120) + (unsigned int)(*(_DWORD *)(a1 + 24) - *(_DWORD *)(a1 + 20));
  v9 = sub_4535C(0x201301Du);
  if ( v6 > 0 )
    v2 = v6;
  result = sub_30114(a1, 1, v7, v2, *(_DWORD *)(a1 + 24), v4, v9);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Bu, (__int64)&unk_57D18);
  }
  return result;
}

//----- (000000000002E94C) ----------------------------------------------------
__int16 __fastcall sub_2E94C(__int64 a1)
{
  int v2; // esi
  PDEVICE_OBJECT v3; // rcx
  int v4; // edi
  int v5; // eax

  v2 = 0;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Fu, (__int64)&unk_57D18);
    v3 = off_5A148;
  }
  v4 = *(_DWORD *)(a1 + 52);
  if ( *(_QWORD *)(a1 + 160) )
  {
    v5 = sub_2F868(a1, 0i64, 0, *(_DWORD *)(a1 + 24), v4, *(_WORD *)(a1 + 56) - (unsigned __int16)v4, 0x11u);
    v2 = v5;
  }
  else
  {
    if ( v3 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v3->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      || BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_12;
    }
    LOWORD(v5) = sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x40u, (__int64)&unk_57D18);
  }
  if ( !v2 )
  {
LABEL_12:
    LOWORD(v5) = sub_2E198(v4, (unsigned int)(v4 + *(_DWORD *)(a1 + 56) - *(_DWORD *)(a1 + 48)), a1 + 48);
    ++*(_DWORD *)(a1 + 24);
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    LOWORD(v5) = sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x41u, (__int64)&unk_57D18);
  }
  return v5;
}

//----- (000000000002EA7C) ----------------------------------------------------
__int64 __fastcall sub_2EA7C(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 result; // rax

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x42u, (__int64)&unk_57D18);
    v2 = off_5A148;
  }
  if ( *(_QWORD *)(a1 + 160) )
  {
    result = sub_2F868(
               a1,
               0i64,
               0,
               *(_DWORD *)(a1 + 24),
               *(_DWORD *)(a1 + 52),
               *(_WORD *)(a1 + 56) - *(_WORD *)(a1 + 52),
               4u);
LABEL_11:
    v2 = off_5A148;
    goto LABEL_12;
  }
  if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
    return result;
  if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    result = sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x43u, (__int64)&unk_57D18);
    goto LABEL_11;
  }
LABEL_12:
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x44u, (__int64)&unk_57D18);
  }
  return result;
}

//----- (000000000002EB7C) ----------------------------------------------------
void **__fastcall sub_2EB7C(__int64 a1)
{
  void **result; // rax
  PDEVICE_OBJECT v3; // r9
  __int64 v4; // rcx
  int v5; // ebp
  signed int v6; // edi
  __int64 v7; // rsi
  unsigned __int16 v8; // ax
  void *retaddr; // [rsp+48h] [rbp+0h] BYREF

  result = &retaddr;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = (void **)sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x45u, (__int64)&unk_57D18);
    v3 = off_5A148;
  }
  v4 = *(unsigned int *)(a1 + 176);
  v5 = *(_DWORD *)(a1 + 48);
  v6 = *(_DWORD *)(a1 + 20) + *(_DWORD *)(a1 + 172) - v4 - *(_DWORD *)(a1 + 24);
  v7 = v4 + *(_QWORD *)(a1 + 120) + (unsigned int)(*(_DWORD *)(a1 + 24) - *(_DWORD *)(a1 + 20));
  if ( v6 > 0 )
  {
    v8 = sub_4535C(0x201301Du);
    result = (void **)sub_30114(a1, 1, v7, v6, *(_DWORD *)(a1 + 24), v5, v8);
    v3 = off_5A148;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v3->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = (void **)sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x46u, (__int64)&unk_57D18);
  }
  return result;
}

//----- (000000000002EC90) ----------------------------------------------------
__int64 __fastcall sub_2EC90(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  int v3; // eax
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  PVOID Object[5]; // [rsp+40h] [rbp-28h] BYREF

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x47u, (__int64)&unk_57D18);
    v2 = off_5A148;
  }
  Object[0] = *(PVOID *)(a1 + 184);
  Object[1] = Event;
  Object[2] = *(PVOID *)(a1 + 192);
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)v2->Queue.ListEntry.Blink, 0x33u);
  }
  v3 = sub_3F170(3u, Object);
  switch ( v3 )
  {
    case 0:
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x48u, (__int64)&unk_57D18);
      }
      *(_DWORD *)(a1 + 200) = 0;
      goto LABEL_32;
    case 1:
      v4 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
        goto LABEL_26;
      }
      v5 = 73;
LABEL_25:
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, v5, (__int64)&unk_57D18);
LABEL_26:
      *(_DWORD *)(a1 + 200) = 7;
      goto LABEL_32;
    case 2:
      v4 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
        goto LABEL_26;
      }
      v5 = 74;
      goto LABEL_25;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Bu, (__int64)&unk_57D18, v3);
  }
  *(_DWORD *)(a1 + 200) = 1;
LABEL_32:
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Cu, (__int64)&unk_57D18);
  }
  return *(unsigned int *)(a1 + 200);
}

//----- (000000000002EEA0) ----------------------------------------------------
__int64 __fastcall sub_2EEA0(void *Src, size_t MaxCount, __int64 a3, struct _KMUTANT *a4)
{
  size_t v6; // rsi
  char v8; // r13
  PDEVICE_OBJECT v9; // rcx
  __int64 result; // rax
  unsigned int v11; // edi
  PDEVICE_OBJECT v12; // rcx
  unsigned __int16 v13; // dx
  __int64 v14; // rax
  __int64 v15; // rax

  v6 = (unsigned int)MaxCount;
  v8 = 0;
  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Du, (__int64)&unk_57D18);
      v9 = off_5A148;
    }
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v9->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x4Eu, (__int64)&unk_57D18, v6);
    }
  }
  KeWaitForSingleObject(a4, Executive, 0, 0, 0i64);
  if ( *(_DWORD *)(a3 + 16) == 5 )
  {
    if ( (unsigned int)(v6 + *(_DWORD *)(a3 + 172)) >= 0x10000 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x50u, (__int64)&unk_57D18);
      }
      while ( *(_DWORD *)(a3 + 172) )
      {
        KeReleaseMutex(a4, 0);
        v11 = sub_2EC90(a3);
        if ( v11 )
        {
          v12 = off_5A148;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            v13 = 81;
LABEL_29:
            sub_11088(*(_QWORD *)&v12->DeviceLock.Header.Lock, v13, (__int64)&unk_57D18);
          }
          return v11;
        }
        KeWaitForSingleObject(a4, Executive, 0, 0, 0i64);
      }
      if ( (unsigned int)v6 <= 0x10000 )
        goto LABEL_24;
      v14 = *(_QWORD *)(a3 + 120);
      *(_DWORD *)(a3 + 176) = 0;
      *(_DWORD *)(a3 + 116) = 1;
      *(_QWORD *)(a3 + 152) = v14;
      *(_QWORD *)(a3 + 120) = Src;
      *(_DWORD *)(a3 + 172) = v6;
      v8 = 1;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Fu, (__int64)&unk_57D18);
      }
LABEL_24:
      memmove((void *)(*(_QWORD *)(a3 + 120) + *(unsigned int *)(a3 + 172)), Src, v6);
      *(_DWORD *)(a3 + 172) += v6;
    }
    *(_DWORD *)(a3 + 200) = 0;
    sub_2F1DC(a3);
    if ( v8 )
    {
      while ( *(_DWORD *)(a3 + 172) )
      {
        KeReleaseMutex(a4, 0);
        v11 = sub_2EC90(a3);
        if ( v11 )
        {
          v12 = off_5A148;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            v13 = 82;
            goto LABEL_29;
          }
          return v11;
        }
        KeWaitForSingleObject(a4, Executive, 0, 0, 0i64);
      }
    }
    if ( *(_DWORD *)(a3 + 116) == 1 )
    {
      v15 = *(_QWORD *)(a3 + 152);
      *(_DWORD *)(a3 + 116) = 0;
      *(_QWORD *)(a3 + 120) = v15;
    }
    KeReleaseMutex(a4, 0);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x53u, (__int64)&unk_57D18);
    }
    result = *(unsigned int *)(a3 + 200);
  }
  else
  {
    KeReleaseMutex(a4, 0);
    result = 11i64;
    *(_DWORD *)(a3 + 200) = 11;
  }
  return result;
}

//----- (000000000002F1DC) ----------------------------------------------------
__int64 __fastcall sub_2F1DC(__int64 a1)
{
  int v2; // esi
  __int64 v3; // rdi
  int v4; // ebx
  unsigned __int16 v5; // ax
  __int64 result; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x56u, (__int64)&unk_57D18);
  }
  v2 = *(_DWORD *)(a1 + 24);
  v3 = *(unsigned int *)(a1 + 176);
  v4 = *(_DWORD *)(a1 + 20);
  v5 = sub_4535C(0x201301Du);
  result = sub_30114(
             a1,
             2,
             v3 + *(_QWORD *)(a1 + 120) + (unsigned int)(v2 - v4),
             v4 + *(_DWORD *)(a1 + 172) - (int)v3 - v2,
             v2,
             *(_DWORD *)(a1 + 52),
             v5);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x57u, (__int64)&unk_57D18);
  }
  return result;
}

//----- (000000000002F2E0) ----------------------------------------------------
char __fastcall sub_2F2E0(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  int *v3; // rax
  int v4; // edi
  int v5; // ebp
  unsigned int v6; // ebx
  __int64 v7; // r8
  _DWORD *v8; // rcx
  unsigned __int64 i; // rax
  PDEVICE_OBJECT v10; // rcx
  unsigned __int16 v11; // dx
  int v12; // er12
  int v13; // edi
  unsigned int v14; // edi
  __int64 v15; // r8
  __int64 v16; // rdx
  int v18; // [rsp+60h] [rbp+8h]

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x58u, (__int64)&unk_57D18);
    v2 = off_5A148;
  }
  v3 = *(int **)(a1 + 96);
  v4 = *v3;
  v5 = v3[1];
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_184C0(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x59u, (__int64)&unk_57D18, v4);
  }
  v6 = 0;
  v7 = 1i64;
  *(_DWORD *)(a1 + 112) = *(_DWORD *)(*(_QWORD *)(a1 + 96) + 4i64);
  *(_DWORD *)(a1 + 88) = v5 + 1;
  while ( 1 )
  {
    v8 = *(_DWORD **)(a1 + 96);
    if ( !v8[v7 - 1] && !v8[v7] )
      break;
    v8[v7 - 1] = v8[v7 + 1];
    *(_DWORD *)(v7 * 4 + *(_QWORD *)(a1 + 96)) = *(_DWORD *)(v7 * 4 + *(_QWORD *)(a1 + 96) + 8);
    v7 += 2i64;
  }
  i = *(_QWORD *)(a1 + 96);
  if ( *v8 || v8[1] )
  {
    v12 = v5 - v4;
    v13 = v18;
    for ( i = (unsigned __int64)(v8 + 1); *(_DWORD *)(i - 4) || *(_DWORD *)i; i += 8i64 )
      v13 = *(_DWORD *)i;
    v14 = v13 - v5;
    v10 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      LOBYTE(i) = sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Bu, (__int64)&unk_57D18, v14);
      v10 = off_5A148;
    }
    if ( v14 )
    {
      v15 = 0i64;
      do
      {
        v16 = *(_QWORD *)(a1 + 80);
        i = v12 + v6++ + 1;
        LOBYTE(i) = *(_BYTE *)(i + v16);
        *(_BYTE *)(v15 + v16) = i;
        ++v15;
      }
      while ( v6 < v14 );
      v10 = off_5A148;
    }
    if ( v10 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v10->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(v10->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v11 = 92;
      goto LABEL_35;
    }
  }
  else
  {
    v10 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v11 = 90;
LABEL_35:
      LOBYTE(i) = sub_11088(*(_QWORD *)&v10->DeviceLock.Header.Lock, v11, (__int64)&unk_57D18);
      return i;
    }
  }
  return i;
}

//----- (000000000002F4D0) ----------------------------------------------------
__int64 *__fastcall sub_2F4D0(void *Src, unsigned int a2)
{
  __int64 *v4; // rsi
  PVOID v6; // rbx
  _BYTE *v7; // rbx
  _WORD *v8; // rdi
  __int64 v9; // rcx
  char v10; // [rsp+30h] [rbp-78h] BYREF
  char v11; // [rsp+31h] [rbp-77h] BYREF
  char v12; // [rsp+32h] [rbp-76h] BYREF
  char v13; // [rsp+33h] [rbp-75h] BYREF
  unsigned __int16 v14; // [rsp+34h] [rbp-74h] BYREF
  unsigned __int16 v15; // [rsp+38h] [rbp-70h] BYREF
  int v16; // [rsp+40h] [rbp-68h] BYREF
  __int16 v17; // [rsp+44h] [rbp-64h]
  unsigned int v18[4]; // [rsp+50h] [rbp-58h] BYREF
  unsigned int v19[4]; // [rsp+60h] [rbp-48h] BYREF
  int v20; // [rsp+70h] [rbp-38h] BYREF
  __int16 v21; // [rsp+74h] [rbp-34h]
  int v22; // [rsp+78h] [rbp-30h] BYREF
  __int16 v23; // [rsp+7Ch] [rbp-2Ch]

  v11 = 0;
  v10 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Du, (__int64)&unk_57D18);
  }
  v4 = (__int64 *)sub_3C910((__int64)qword_5A8A8);
  if ( !v4 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Eu, (__int64)&unk_57D18);
    }
    return 0i64;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Fu, (__int64)&unk_57D18, a2);
  }
  v6 = sub_3C4EC(2, a2, 0x6252734Eu);
  if ( !v6 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x60u, (__int64)&unk_57D18);
    }
    sub_3C978((__int64)qword_5A8A8, (__int64)v4);
    return 0i64;
  }
  memmove(v4, Src, 0x190ui64);
  *v4 = 0i64;
  v4[1] = 0i64;
  *((_DWORD *)v4 + 30) = 0;
  *((_DWORD *)v4 + 32) = 2;
  v4[2] = (__int64)v6;
  if ( (*((_BYTE *)Src + 120) & 0x10) == 0 )
    *((_DWORD *)v4 + 30) = 16;
  *(__int64 *)((char *)v4 + 220) = 0i64;
  memmove(v6, *((const void **)Src + 2), *((unsigned int *)Src + 31));
  *((_DWORD *)v4 + 30) &= 0xFFFFFFFB;
  *(__int64 *)((char *)v4 + 132) = 0i64;
  *((_DWORD *)v4 + 35) = 0;
  v7 = sub_4AE28(v4[2], 1);
  v8 = sub_4AE28(v4[2], 3);
  sub_4BAA4(v4[2], (__int64)&v20);
  sub_4BB5C(v4[2], (__int64)&v22);
  v16 = v22;
  v17 = v23;
  sub_4E3DC(v4[2], (unsigned __int8 *)&v16);
  v16 = v20;
  v9 = v4[2];
  v17 = v21;
  sub_4E4D0(v9, (unsigned __int8 *)&v16);
  sub_4BFBC((__int64)v7, &v12);
  v12 = 0;
  sub_4E748((__int64)v7, 0);
  sub_4C138((__int64)v7, v18);
  sub_4C1E8((__int64)v7, v19);
  sub_4E968((__int64)v7, v19[0]);
  sub_4EA38((__int64)v7, v18[0]);
  sub_4CFEC(v8, &v14);
  sub_4D0B0((__int64)v8, &v15);
  sub_4FA5C(v8, v15);
  sub_4FB20((__int64)v8, v14);
  sub_4D4A8((__int64)v8, &v13);
  v13 = 16;
  sub_4FE4C((__int64)v8, 0x10u);
  sub_4FDA4((__int64)v8);
  sub_4BD84(v7, &v11);
  v11 *= 4;
  sub_4D33C((__int64)v8, &v10);
  v10 *= 4;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x61u, (__int64)&unk_57D18);
  }
  return v4;
}

//----- (000000000002F868) ----------------------------------------------------
__int64 __fastcall sub_2F868(__int64 a1, const void *a2, unsigned __int16 a3, int a4, int a5, unsigned __int16 a6, unsigned __int8 a7)
{
  PDEVICE_OBJECT v10; // rcx
  __int64 result; // rax
  unsigned __int16 v12; // bx
  _BYTE *v13; // rsi
  _BYTE *v14; // rdi
  unsigned __int8 *v15; // r14
  _BYTE *v16; // rax
  PDEVICE_OBJECT v17; // rsi
  __int64 v18; // rdi
  int v19; // eax
  unsigned int v20; // ebx
  int v21; // [rsp+20h] [rbp-D8h]
  int v22; // [rsp+28h] [rbp-D0h]
  int v23; // [rsp+30h] [rbp-C8h]
  int v24; // [rsp+38h] [rbp-C0h]
  int v25; // [rsp+40h] [rbp-B8h]
  int v26; // [rsp+48h] [rbp-B0h]
  int v27; // [rsp+50h] [rbp-A8h]
  int v28; // [rsp+58h] [rbp-A0h]
  int v29; // [rsp+60h] [rbp-98h]
  unsigned __int8 v30; // [rsp+70h] [rbp-88h] BYREF
  char v31[3]; // [rsp+71h] [rbp-87h] BYREF
  __int16 v32; // [rsp+74h] [rbp-84h] BYREF
  int v33; // [rsp+78h] [rbp-80h] BYREF
  unsigned int v34; // [rsp+7Ch] [rbp-7Ch]
  int v35; // [rsp+80h] [rbp-78h]
  __int16 v36; // [rsp+84h] [rbp-74h]
  int v37; // [rsp+88h] [rbp-70h] BYREF
  __int16 v38; // [rsp+8Ch] [rbp-6Ch] BYREF
  unsigned __int8 *v39; // [rsp+90h] [rbp-68h] BYREF
  void *Dst[3]; // [rsp+98h] [rbp-60h] BYREF
  int v41[4]; // [rsp+B0h] [rbp-48h] BYREF
  int v42[4]; // [rsp+C0h] [rbp-38h] BYREF

  v34 = 0;
  v37 = 0;
  v39 = 0i64;
  v32 = 0;
  v33 = 0;
  v10 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_2D2C8(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 98i64, (__int64)&unk_57D18, a3);
    v10 = off_5A148;
  }
  if ( *(_QWORD *)(a1 + 160) )
  {
    if ( a3 <= *(_WORD *)(a1 + 168) )
    {
      v12 = _InterlockedExchangeAdd(&dword_5A668, 1u) + 1;
      v35 = v12;
      v13 = sub_4AE28(*(_QWORD *)(*(_QWORD *)(a1 + 160) + 16i64), 1);
      Dst[2] = v13;
      v14 = sub_4AE28(*(_QWORD *)(*(_QWORD *)(a1 + 160) + 16i64), 3);
      Dst[1] = v14;
      sub_4BD84(v13, v31);
      sub_4D33C((__int64)v14, &v30);
      v31[0] *= 4;
      v30 *= 4;
      sub_4E5C0((__int64)v13, a3 + (unsigned __int8)v31[0] + v30);
      sub_4E684((__int64)v13, v12);
      v36 = sub_50390((unsigned __int16 *)v13);
      sub_4E8A4((__int64)v13, v36);
      sub_4FE4C((__int64)v14, a7);
      sub_4FBE4((__int64)v14, a4);
      sub_4FCC4((__int64)v14, a5);
      sub_4FEF8((__int64)v14, a6);
      sub_4C138((__int64)v13, v41);
      sub_4C1E8((__int64)v13, v42);
      if ( a3 )
      {
        sub_50E34(*(_QWORD *)(*(_QWORD *)(a1 + 160) + 16i64), Dst, &v38);
        memmove(Dst[0], a2, a3);
      }
      *(_DWORD *)(*(_QWORD *)(a1 + 160) + 124i64) = (unsigned __int8)v31[0] + v30 + a3 + 14;
      *(_QWORD *)(*(_QWORD *)(a1 + 160) + 8i64) = MEMORY[0xFFFFF78000000014];
      *(_DWORD *)(*(_QWORD *)(a1 + 160) + 120i64) |= 0x40u;
      **(_QWORD **)(a1 + 160) = _InterlockedIncrement64(&qword_5D418);
      **(_QWORD **)(a1 + 160) |= 0x8000000000000000ui64;
      *(_QWORD *)(*(_QWORD *)(a1 + 160) + 220i64) = 0i64;
      sub_3068C(*(_QWORD **)(a1 + 160));
      sub_4B3A0(
        *(_QWORD *)(*(_QWORD *)(a1 + 160) + 16i64),
        *(_DWORD *)(*(_QWORD *)(a1 + 160) + 124i64),
        (__int64 *)(*(_QWORD *)(a1 + 160) + 24i64));
      sub_50870(*(_QWORD *)(a1 + 160) + 24i64, 1, 0i64);
      sub_50E34(*(_QWORD *)(*(_QWORD *)(a1 + 160) + 16i64), &v39, &v32);
      v15 = v39;
      if ( v39 )
      {
        v16 = sub_4AE28(*(_QWORD *)(*(_QWORD *)(a1 + 160) + 16i64), 3);
        sub_4D174((__int64)v16, &v33);
        v17 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          v18 = *(_QWORD *)(a1 + 160);
          v29 = v15[6];
          v28 = v15[5];
          v27 = v15[4];
          v26 = v15[3];
          v25 = v15[2];
          v24 = v15[1];
          v23 = *v15;
          v22 = v33;
          v21 = *(_DWORD *)(v18 + 124);
          sub_180C0(
            *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
            0x65u,
            (__int64)&unk_57D18,
            *(_QWORD *)v18,
            v21,
            v22,
            v23,
            v24,
            v25,
            v26,
            v27,
            v28,
            v29,
            v15);
          v17 = off_5A148;
        }
        if ( v17 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v17->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
          && BYTE1(v17->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_11088(*(_QWORD *)&v17->DeviceLock.Header.Lock, 0x66u, (__int64)&unk_57D18);
        }
        sub_309F0(a1);
      }
      v19 = sub_4535C(0x2013015u);
      v20 = sub_40A2C(40008, *(const void **)(a1 + 160), 0x190u, v19, &v37);
      v34 = v20;
      sub_308B0(*(_QWORD **)(a1 + 160));
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x68u, (__int64)&unk_57D18);
      }
      result = v20;
    }
    else
    {
      if ( v10 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v10->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        && BYTE1(v10->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&v10->DeviceLock.Header.Lock, 0x64u, (__int64)&unk_57D18);
      }
      result = 20i64;
    }
  }
  else
  {
    if ( v10 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v10->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(v10->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v10->DeviceLock.Header.Lock, 0x63u, (__int64)&unk_57D18);
    }
    result = 4i64;
  }
  return result;
}
// 5A668: using guessed type int dword_5A668;
// 5D418: using guessed type __int64 qword_5D418;

//----- (000000000002FDFC) ----------------------------------------------------
__int64 __fastcall sub_2FDFC(__int64 a1, __int16 a2)
{
  int v4; // eax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x69u, (__int64)&unk_57D18);
  }
  v4 = *(_DWORD *)(a1 + 20);
  *(_WORD *)(a1 + 168) = a2;
  *(_DWORD *)(a1 + 24) = v4;
  sub_2F1DC(a1);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Au, (__int64)&unk_57D18);
  }
  return 0i64;
}

//----- (000000000002FEB4) ----------------------------------------------------
__int64 __fastcall sub_2FEB4(_DWORD *a1, int a2, int a3, unsigned __int16 a4)
{
  unsigned __int16 v4; // bx
  bool v9; // r13
  bool v10; // di
  PDEVICE_OBJECT v11; // rcx
  int v12; // esi
  int v13; // eax
  int v14; // ebp
  int v15; // eax

  HIBYTE(v4) = 0;
  v9 = 0;
  v10 = 0;
  v11 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_2D608(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 107i64, (__int64)&unk_57D18, a1, a2, a3, a4);
      v11 = off_5A148;
    }
    if ( v11 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v11->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_18658(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x6Cu, (__int64)&unk_57D18, a1[12]);
      v11 = off_5A148;
    }
  }
  v12 = 2;
  v13 = a1[12] - a2;
  if ( v13 >= 0 )
    v14 = v13 <= 0;
  else
    v14 = 2;
  v15 = a1[5] - a3;
  if ( v15 >= 0 )
    v12 = v15 <= 0;
  if ( v11 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v11->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_184C0(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x6Du, (__int64)&unk_57D18, v14);
    v11 = off_5A148;
  }
  if ( v14 != 1 )
    v9 = a4 != 0;
  if ( v12 == 1 )
    v10 = a1[44] < a1[43];
  if ( v11 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v11->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_184C0(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x6Eu, (__int64)&unk_57D18, v9);
    v11 = off_5A148;
  }
  if ( v9 || v10 )
  {
    LOBYTE(v4) = v10;
    sub_30DA0((__int64)a1, v10, v4);
    v11 = off_5A148;
  }
  if ( v11 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v11->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x6Fu, (__int64)&unk_57D18, 0);
  }
  return 0i64;
}

//----- (0000000000030114) ----------------------------------------------------
__int64 __fastcall sub_30114(__int64 a1, int a2, __int64 a3, unsigned int a4, int a5, int a6, unsigned __int16 a7)
{
  int v7; // er13
  __int64 v10; // rbx
  unsigned int v11; // ebp
  PDEVICE_OBJECT v12; // r10
  unsigned int v14; // ebx
  int v15; // er12
  int v16; // er9
  unsigned __int16 v17; // r15
  int v18; // eax
  PDEVICE_OBJECT v19; // r10
  unsigned __int16 v20; // dx
  int v21; // eax
  unsigned __int16 v23; // [rsp+60h] [rbp-48h]
  unsigned int v24; // [rsp+64h] [rbp-44h]
  int i; // [rsp+68h] [rbp-40h]
  char v26; // [rsp+B0h] [rbp+8h]
  __int64 v27; // [rsp+C0h] [rbp+18h]

  v27 = a3;
  v7 = a2;
  v10 = a3;
  v23 = 0;
  LOWORD(v11) = 0;
  v24 = 0;
  v26 = 0;
  v12 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_2D598(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 112i64, (__int64)&unk_57D18, a2);
    v12 = off_5A148;
  }
  if ( !a1 )
  {
    if ( v12 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v12->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EE0(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x71u, (__int64)&unk_57D18, 0i64, v10);
      v12 = off_5A148;
    }
    v14 = 4;
    goto LABEL_73;
  }
  v15 = a5;
  v16 = *(_DWORD *)(a1 + 208);
  v17 = *(_WORD *)(a1 + 28) - a5;
  for ( i = v16; ; v16 = i )
  {
    if ( v12 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v12->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_17A28(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x72u, (__int64)&unk_57D18, a4);
      v16 = i;
    }
    if ( v7 > 0 && v7 <= 2 )
    {
      if ( a4 )
      {
        v11 = *(unsigned __int16 *)(a1 + 168);
        if ( a4 < v11 )
          LOWORD(v11) = a4;
        if ( (unsigned __int16)v11 > v17 )
          LOWORD(v11) = v17;
        if ( v15 + (unsigned __int16)v11 - v16 > 0 )
        {
          v26 = 1;
          LOWORD(v11) = v16 - v15;
        }
      }
      else
      {
        LOWORD(v11) = 0;
      }
    }
    v18 = sub_2F868(a1, (const void *)(v10 + v24), v11, v15, a6, *(_WORD *)(a1 + 56) - *(_WORD *)(a1 + 52), 0x10u);
    v14 = v18;
    if ( v18 )
      break;
    if ( v7 == 1 )
    {
      sub_2E198(a6, (unsigned int)(a6 + *(_DWORD *)(a1 + 56) - *(_DWORD *)(a1 + 48)), a1 + 48);
      v7 = 2;
    }
    v19 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x27u, (__int64)&unk_57D18);
      v19 = off_5A148;
    }
    if ( (_WORD)v11 )
    {
      if ( v19 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v19->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        && BYTE1(v19->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_33F1C(*(_QWORD *)&v19->DeviceLock.Header.Lock, 0x29u, (__int64)&unk_57D18, v15);
        v19 = off_5A148;
      }
      v21 = *(_DWORD *)(a1 + 24);
      if ( (v15 - v21 < 0 || v15 - v21 <= 0) && v21 - (unsigned __int16)v11 - v15 < 0 )
      {
        *(_DWORD *)(a1 + 24) = (unsigned __int16)v11 + v15;
        v19 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
          goto LABEL_54;
        if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_13EA4(
            *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
            0x2Au,
            (__int64)&unk_57D18,
            (unsigned __int16)v11 + v15);
          v19 = off_5A148;
        }
      }
      if ( v19 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v19->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        && BYTE1(v19->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        v20 = 43;
        goto LABEL_53;
      }
    }
    else if ( v19 != (PDEVICE_OBJECT)&off_5A148
           && _bittest((const signed __int32 *)&v19->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
           && BYTE1(v19->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      v20 = 40;
LABEL_53:
      sub_11088(*(_QWORD *)&v19->DeviceLock.Header.Lock, v20, (__int64)&unk_57D18);
      v19 = off_5A148;
      goto LABEL_54;
    }
LABEL_54:
    a6 = *(_DWORD *)(a1 + 52);
    v17 -= v11;
    v24 += (unsigned __int16)v11;
    v15 += (unsigned __int16)v11;
    a4 -= (unsigned __int16)v11;
    ++v23;
    if ( v19 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v19->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
      && BYTE1(v19->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&v19->DeviceLock.Header.Lock, 0x74u, (__int64)&unk_57D18);
    }
    sub_309F0(a1);
    if ( v23 >= a7 || !a4 || v17 <= *(_WORD *)(a1 + 168) )
    {
      v12 = off_5A148;
      goto LABEL_69;
    }
    v12 = off_5A148;
    if ( v26 )
      goto LABEL_69;
    v10 = v27;
  }
  v12 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v14;
  if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x73u, (__int64)&unk_57D18, v18);
    v12 = off_5A148;
  }
LABEL_69:
  if ( v12 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&v12->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_17A28(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x75u, (__int64)&unk_57D18, a4);
      v12 = off_5A148;
    }
LABEL_73:
    if ( v12 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v12->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_13EA4(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x76u, (__int64)&unk_57D18, v14);
    }
  }
  return v14;
}

//----- (000000000003068C) ----------------------------------------------------
__int64 __fastcall sub_3068C(_QWORD *a1)
{
  PDEVICE_OBJECT v2; // rcx
  int v3; // edi
  _DWORD *v4; // rax
  __int64 v5; // r9
  char v7[128]; // [rsp+40h] [rbp-98h] BYREF

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x10u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x77u, (__int64)&unk_57D18);
    v2 = off_5A148;
  }
  if ( !a1 )
    goto LABEL_19;
  *((_DWORD *)a1 + 35) = 0;
  *(_QWORD *)((char *)a1 + 132) = 0i64;
  if ( byte_5A8D1 != 1 )
  {
    *((_DWORD *)a1 + 30) &= 0xFFFFFFFB;
    goto LABEL_18;
  }
  v3 = dword_5A8D4;
  v4 = sub_3C4EC(2, dword_5A8D4 + 5, 0x7470704Eu);
  *(_QWORD *)((char *)a1 + 132) = v4;
  if ( v4 )
  {
    *((_DWORD *)a1 + 35) = v3;
    *v4 = 0;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x10u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x79u, (__int64)&unk_57D18, *a1, 0i64, 0);
    }
    *((_DWORD *)a1 + 30) |= 8u;
    v5 = *a1;
    qword_5A8F8 = 0i64;
    sub_53BB4(v7, 0x80ui64, "|STRM-START-ID%I64u-(BASE %I64u)-%I64u|", v5, PerformanceFrequency.QuadPart, 0i64);
    sub_51EBC((__int64)a1, v7, strlen(v7));
    *((_DWORD *)a1 + 30) |= 4u;
    goto LABEL_18;
  }
  v2 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return 0i64;
  if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x10u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x78u, (__int64)&unk_57D18, *a1, 0i64, 0);
LABEL_18:
    v2 = off_5A148;
  }
LABEL_19:
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x10u)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x7Au, (__int64)&unk_57D18);
  }
  return 0i64;
}
// 5A8D1: using guessed type char byte_5A8D1;
// 5A8D4: using guessed type int dword_5A8D4;
// 5A8F8: using guessed type __int64 qword_5A8F8;

//----- (00000000000308B0) ----------------------------------------------------
__int64 __fastcall sub_308B0(_QWORD *a1)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x10u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x7Bu, (__int64)&unk_57D18);
    v2 = off_5A148;
  }
  if ( !a1 )
    goto LABEL_17;
  if ( *(_QWORD *)((char *)a1 + 132) )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x10u)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_12D64(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x7Cu, (__int64)&unk_57D18, *a1);
    }
    sub_3C570(*(PVOID *)((char *)a1 + 132), 0x7470704Eu);
    *(_QWORD *)((char *)a1 + 132) = 0i64;
    *((_DWORD *)a1 + 30) &= 0xFFFFFFFB;
    goto LABEL_16;
  }
  if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
    return 0i64;
  if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x10u)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_12D64(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x7Du, (__int64)&unk_57D18, *a1);
LABEL_16:
    v2 = off_5A148;
  }
LABEL_17:
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x10u)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x7Eu, (__int64)&unk_57D18);
  }
  return 0i64;
}

//----- (00000000000309F0) ----------------------------------------------------
__int64 __fastcall sub_309F0(__int64 a1)
{
  PDEVICE_OBJECT v2; // r10
  __int64 result; // rax
  int v4; // [rsp+28h] [rbp-40h]
  int v5; // [rsp+30h] [rbp-38h]
  int v6; // [rsp+38h] [rbp-30h]
  int v7; // [rsp+40h] [rbp-28h]
  int v8; // [rsp+48h] [rbp-20h]
  int v9; // [rsp+50h] [rbp-18h]
  int v10; // [rsp+58h] [rbp-10h]

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      v10 = *(unsigned __int16 *)(a1 + 44);
      v9 = *(_DWORD *)(a1 + 40);
      v8 = *(unsigned __int8 *)(a1 + 36);
      v7 = *(_DWORD *)(a1 + 28);
      v6 = *(_DWORD *)(a1 + 24);
      v5 = *(_DWORD *)(a1 + 20);
      v4 = *(_DWORD *)(a1 + 16);
      result = sub_2D478(
                 *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
                 154i64,
                 (__int64)&unk_57D18,
                 *(_QWORD *)a1,
                 **(_QWORD **)(a1 + 8),
                 v4,
                 v5,
                 v6,
                 v7,
                 v8,
                 v9,
                 v10);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
        && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        result = sub_2D348(*(_QWORD *)&v2->DeviceLock.Header.Lock, 155i64, (__int64)&unk_57D18, *(_DWORD *)(a1 + 48));
        v2 = off_5A148;
      }
      if ( v2 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
        && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        result = sub_2D3E0(*(_QWORD *)&v2->DeviceLock.Header.Lock, 156i64, (__int64)&unk_57D18, *(_DWORD *)(a1 + 112));
      }
    }
  }
  return result;
}

//----- (0000000000030B80) ----------------------------------------------------
__int64 __fastcall sub_30B80(__int64 a1, __int64 a2)
{
  unsigned int v2; // ebx
  PDEVICE_OBJECT v5; // rcx
  __int64 v6; // rcx
  __int64 v7; // rcx
  __int64 v8; // rcx
  __int64 v9; // rcx
  int v11; // [rsp+30h] [rbp-58h] BYREF
  __int16 v12; // [rsp+34h] [rbp-54h]
  _BYTE v13[6]; // [rsp+40h] [rbp-48h] BYREF
  _BYTE v14[6]; // [rsp+48h] [rbp-40h] BYREF
  _BYTE v15[6]; // [rsp+50h] [rbp-38h] BYREF
  _BYTE v16[6]; // [rsp+58h] [rbp-30h] BYREF

  v2 = 0;
  *(_DWORD *)&v14[1] = 0;
  v14[5] = 0;
  *(_DWORD *)&v13[1] = 0;
  v13[5] = 0;
  *(_DWORD *)&v16[1] = 0;
  v16[5] = 0;
  *(_DWORD *)&v15[1] = 0;
  v15[5] = 0;
  v14[0] = 0;
  v13[0] = 0;
  v16[0] = 0;
  v15[0] = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA1u, (__int64)&unk_57D18);
    v5 = off_5A148;
  }
  if ( a1 && a2 )
  {
    sub_4BAA4(*(_QWORD *)(a1 + 16), (__int64)v14);
    sub_4BB5C(*(_QWORD *)(a1 + 16), (__int64)v13);
    sub_4BAA4(*(_QWORD *)(a2 + 16), (__int64)v16);
    sub_4BB5C(*(_QWORD *)(a2 + 16), (__int64)v15);
    v11 = *(_DWORD *)v15;
    v6 = *(_QWORD *)(a1 + 16);
    v12 = *(_WORD *)&v15[4];
    sub_4E3DC(v6, (unsigned __int8 *)&v11);
    v11 = *(_DWORD *)v16;
    v7 = *(_QWORD *)(a1 + 16);
    v12 = *(_WORD *)&v16[4];
    sub_4E4D0(v7, (unsigned __int8 *)&v11);
    v11 = *(_DWORD *)v13;
    v8 = *(_QWORD *)(a2 + 16);
    v12 = *(_WORD *)&v13[4];
    sub_4E3DC(v8, (unsigned __int8 *)&v11);
    v11 = *(_DWORD *)v14;
    v9 = *(_QWORD *)(a2 + 16);
    v12 = *(_WORD *)&v14[4];
    sub_4E4D0(v9, (unsigned __int8 *)&v11);
    v5 = off_5A148;
  }
  else
  {
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EE0(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xA2u, (__int64)&unk_57D18, a1, a2);
      v5 = off_5A148;
    }
    v2 = 4;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xA3u, (__int64)&unk_57D18);
  }
  return v2;
}

//----- (0000000000030DA0) ----------------------------------------------------
__int64 __fastcall sub_30DA0(__int64 a1, char a2, unsigned __int16 a3)
{
  unsigned int v6; // er9
  __int64 result; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA4u, (__int64)&unk_57D18);
  }
  v6 = 0;
  if ( a2 )
    v6 = *(_DWORD *)(a1 + 24) - *(_DWORD *)(a1 + 20);
  result = sub_30114(
             a1,
             1,
             *(_QWORD *)(a1 + 120) + *(unsigned int *)(a1 + 176),
             v6,
             *(_DWORD *)(a1 + 20),
             *(_DWORD *)(a1 + 48),
             a3);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    result = sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xA5u, (__int64)&unk_57D18);
  }
  return result;
}

//----- (0000000000030E8C) ----------------------------------------------------
__int64 sub_30E8C(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+A8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D08, 51i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000030F10) ----------------------------------------------------
__int64 sub_30F10(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57D08, 13i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000030F74) ----------------------------------------------------
__int64 __fastcall sub_30F74(_QWORD *a1, _QWORD *a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 v5; // rax
  __int64 result; // rax
  int v7; // [rsp+40h] [rbp+8h] BYREF

  v7 = 0;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xAu, (__int64)&unk_57D08);
    v4 = off_5A148;
  }
  if ( a1[51] )
    goto LABEL_30;
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v4->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_12D64(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0xBu, (__int64)&unk_57D08, *a1);
  }
  v5 = sub_2D678(*((_DWORD *)a1 + 104));
  a1[51] = v5;
  if ( v5 )
  {
LABEL_30:
    if ( (a2[15] & 0x10) != 0 || !sub_33508((__int64)a2, &v7) )
    {
      *((_DWORD *)a2 + 30) |= 0x40u;
      sub_3112C(a1, a2);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xEu, (__int64)&unk_57D08);
      }
      result = 0i64;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_30F10(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 13i64, (__int64)&unk_57D08, *a2, *a1, v7);
      }
      result = 6i64;
    }
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xCu, (__int64)&unk_57D08, *a1);
    }
    result = 3i64;
  }
  return result;
}

//----- (000000000003112C) ----------------------------------------------------
__int64 __fastcall sub_3112C(_QWORD *a1, __int64 *a2)
{
  __int64 v2; // rbx
  PDEVICE_OBJECT v5; // rcx
  int v6; // edx
  unsigned __int16 v7; // dx
  int v8; // edx
  int v9; // edx
  int v10; // edx
  int v11; // edx
  int v12; // edx
  unsigned __int16 v13; // dx

  v2 = a1[51];
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x80) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xFu, (__int64)&unk_57D08, *a2);
    v5 = off_5A148;
  }
  v6 = *(_DWORD *)(v2 + 16);
  if ( v6 > 5 )
  {
    v8 = v6 - 6;
    if ( !v8 )
    {
      if ( v5 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) == 0
        || BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
        goto LABEL_81;
      }
      v7 = 22;
      goto LABEL_79;
    }
    v9 = v8 - 1;
    if ( !v9 )
    {
      if ( v5 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) == 0
        || BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
        goto LABEL_81;
      }
      v7 = 23;
      goto LABEL_79;
    }
    v10 = v9 - 1;
    if ( v10 )
    {
      v11 = v10 - 1;
      if ( !v11 )
      {
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x19u, (__int64)&unk_57D08);
        }
        sub_3236C((__int64)a1, (__int64)a2);
        goto LABEL_80;
      }
      v12 = v11 - 1;
      if ( !v12 )
      {
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x1Au, (__int64)&unk_57D08);
        }
        sub_3264C((__int64)a1, a2);
        goto LABEL_80;
      }
      if ( v12 != 1 )
        goto LABEL_81;
      if ( v5 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) == 0
        || BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
        goto LABEL_56;
      }
      v13 = 27;
    }
    else
    {
      if ( v5 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) == 0
        || BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
        goto LABEL_56;
      }
      v13 = 24;
    }
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, v13, (__int64)&unk_57D08);
LABEL_56:
    sub_32908((__int64)a1, (__int64)a2);
LABEL_80:
    v5 = off_5A148;
    goto LABEL_81;
  }
  switch ( v6 )
  {
    case 5:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x15u, (__int64)&unk_57D08);
      }
      sub_31D84((__int64)a1, a2);
      goto LABEL_80;
    case -1:
      if ( v5 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) == 0
        || BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
        break;
      }
      v7 = 28;
      goto LABEL_79;
    case 0:
      if ( v5 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) == 0
        || BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
        break;
      }
      v7 = 16;
LABEL_79:
      sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, v7, (__int64)&unk_57D08);
      goto LABEL_80;
    case 1:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x11u, (__int64)&unk_57D08);
      }
      sub_31508(a1, a2);
      goto LABEL_80;
    case 2:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x12u, (__int64)&unk_57D08);
      }
      sub_31BA0((__int64)a1, (__int64)a2);
      goto LABEL_80;
    case 3:
      if ( v5 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) == 0
        || BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) < 5u )
      {
        break;
      }
      v7 = 19;
      goto LABEL_79;
    case 4:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x14u, (__int64)&unk_57D08);
      }
      sub_318E8((__int64)a1, a2);
      goto LABEL_80;
  }
LABEL_81:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x80) != 0
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x1Du, (__int64)&unk_57D08);
  }
  return 0i64;
}

//----- (0000000000031508) ----------------------------------------------------
__int64 __fastcall sub_31508(_QWORD *a1, __int64 *a2)
{
  __int64 v4; // rbp
  _BYTE *v5; // r14
  _QWORD *v6; // rax
  __int64 v7; // rdi
  __int64 v9; // rax
  __int64 v10; // r13
  __int64 v11; // rcx
  PDEVICE_OBJECT v12; // rcx
  unsigned __int16 v13; // [rsp+70h] [rbp+8h] BYREF
  __int16 v14; // [rsp+78h] [rbp+10h] BYREF
  int v15; // [rsp+80h] [rbp+18h] BYREF

  v14 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Eu, (__int64)&unk_57D08);
  }
  v4 = a1[51];
  if ( sub_514FC(a2[2]) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Fu, (__int64)&unk_57D08);
    }
    v5 = sub_4AE28(a2[2], 3);
    sub_4D174((__int64)v5, &v15);
    sub_4D558((__int64)v5, &v13);
    if ( !v13 )
      v13 = 0x2000;
    *(_DWORD *)(v4 + 48) = v15;
    *(_DWORD *)(v4 + 52) = v15 + 1;
    *(_DWORD *)(v4 + 112) = v15;
    *(_DWORD *)(v4 + 56) = v15 + 0x7FFF;
    *(_DWORD *)(v4 + 28) = v13;
    v6 = (_QWORD *)sub_1928C(
                     _InterlockedIncrement64(&qword_5D418),
                     *a1,
                     *((_DWORD *)a1 + 5),
                     *((_DWORD *)a1 + 6),
                     a1[4],
                     a1[5],
                     a1[1],
                     (__int64)a2);
    v7 = (__int64)v6;
    if ( !v6 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x20u, (__int64)&unk_57D08, *a1);
      }
      return 3i64;
    }
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_13EE0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x21u, (__int64)&unk_57D08, *v6, *a1);
    }
    *(_QWORD *)(v7 + 392) = *a1;
    a1[49] = *(_QWORD *)v7;
    *(_QWORD *)(v7 + 400) = a1;
    a1[50] = v7;
    v9 = sub_2D678(*(_DWORD *)(v7 + 416));
    v10 = v9;
    *(_QWORD *)(v7 + 408) = v9;
    if ( !v9 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x22u, (__int64)&unk_57D08, *(_QWORD *)v7);
      }
      sub_196DC(v7);
      return 3i64;
    }
    *(_QWORD *)(v7 + 48) = a1[6];
    *(_QWORD *)(v9 + 8) = a1[51];
    v11 = a1[51];
    *(_QWORD *)(v11 + 8) = *(_QWORD *)(v7 + 408);
    LOBYTE(v11) = 2;
    *(_DWORD *)(v9 + 20) = *(_DWORD *)(v4 + 48);
    *(_DWORD *)(v9 + 24) = *(_DWORD *)(v4 + 52);
    if ( (unsigned int)sub_4D6E0(v11, (__int64)v5, &v14) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x23u, (__int64)&unk_57D08);
      }
    }
    else
    {
      *(_WORD *)(v4 + 168) = v14;
    }
    *(_DWORD *)(v4 + 16) = 3;
    *(_DWORD *)(v10 + 16) = 4;
    if ( !*(_QWORD *)(v4 + 160) )
      *(_QWORD *)(v4 + 160) = sub_2F4D0(a2, (unsigned int)*(unsigned __int16 *)(v4 + 168) + 134);
    sub_32FC0((__int64)a2, *a1);
    goto LABEL_41;
  }
  v12 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
LABEL_42:
      if ( v12 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(v12->DeviceLock.Header.WaitListHead.Blink) < 0
        && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x25u, (__int64)&unk_57D08);
      }
      return 0i64;
    }
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x24u, (__int64)&unk_57D08);
LABEL_41:
    v12 = off_5A148;
    goto LABEL_42;
  }
  return 0i64;
}
// 5D418: using guessed type __int64 qword_5D418;

//----- (00000000000318E8) ----------------------------------------------------
__int64 __fastcall sub_318E8(__int64 a1, __int64 *a2)
{
  _BYTE *v4; // rbp
  __int64 v5; // rcx
  unsigned __int16 v6; // r11
  __int64 v7; // rdi
  _DWORD *v8; // r12
  int v9; // eax
  PDEVICE_OBJECT v10; // rcx
  unsigned __int16 v11; // dx
  int v13[18]; // [rsp+30h] [rbp-48h] BYREF
  unsigned __int16 v14; // [rsp+88h] [rbp+10h] BYREF
  __int16 v15; // [rsp+90h] [rbp+18h] BYREF
  int v16; // [rsp+98h] [rbp+20h] BYREF

  v15 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x26u, (__int64)&unk_57D08);
  }
  if ( sub_51784(a2[2]) )
  {
    v4 = sub_4AE28(a2[2], 3);
    sub_4D174((__int64)v4, &v16);
    sub_4D558((__int64)v4, &v14);
    sub_4D258((__int64)v4, v13);
    v6 = v14;
    if ( !v14 )
    {
      v6 = 0x2000;
      v14 = 0x2000;
    }
    v7 = *(_QWORD *)(a1 + 408);
    v8 = *(_DWORD **)(*(_QWORD *)(a1 + 400) + 408i64);
    *(_DWORD *)(v7 + 208) = v13[0] + v6;
    v9 = *(_DWORD *)(v7 + 24);
    if ( v13[0] != v9 )
    {
      v10 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        v11 = 39;
LABEL_31:
        sub_11088(*(_QWORD *)&v10->DeviceLock.Header.Lock, v11, (__int64)&unk_57D08);
        return 0i64;
      }
      return 0i64;
    }
    *(_DWORD *)(v7 + 20) = v9;
    v8[12] = v8[13];
    *(_DWORD *)(v7 + 48) = v16;
    LOBYTE(v5) = 2;
    *(_DWORD *)(v7 + 52) = v16 + 1;
    *(_DWORD *)(v7 + 112) = v16;
    *(_DWORD *)(v7 + 56) = v16 + 0x7FFF;
    v8[5] = v16;
    v8[6] = v16 + 1;
    v8[7] += v16;
    *(_DWORD *)(v7 + 28) = *(_DWORD *)(v7 + 20) + v14;
    if ( (unsigned int)sub_4D6E0(v5, (__int64)v4, &v15) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x28u, (__int64)&unk_57D08);
      }
    }
    else
    {
      *(_WORD *)(v7 + 168) = v15;
    }
    *(_DWORD *)(v7 + 16) = 6;
    v8[4] = 2;
    if ( !*(_QWORD *)(v7 + 160) )
      *(_QWORD *)(v7 + 160) = sub_2F4D0(a2, (unsigned int)*(unsigned __int16 *)(v7 + 168) + 134);
    sub_32FC0((__int64)a2, 0i64);
  }
  else
  {
    v10 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      goto LABEL_27;
    }
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x29u, (__int64)&unk_57D08);
  }
  v10 = off_5A148;
LABEL_27:
  if ( v10 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v10->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(v10->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v11 = 42;
    goto LABEL_31;
  }
  return 0i64;
}
// 31A97: variable 'v5' is possibly undefined

//----- (0000000000031BA0) ----------------------------------------------------
__int64 __fastcall sub_31BA0(__int64 a1, __int64 a2)
{
  _BYTE *v4; // rdi
  unsigned __int16 v5; // r11
  __int64 v6; // rcx
  __int64 v7; // rdx
  int v8; // eax
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  unsigned __int16 v12; // [rsp+58h] [rbp+10h] BYREF
  int v13; // [rsp+60h] [rbp+18h] BYREF
  int v14; // [rsp+68h] [rbp+20h] BYREF

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Bu, (__int64)&unk_57D08);
  }
  if ( sub_51640(*(_QWORD *)(a2 + 16)) )
  {
    v4 = sub_4AE28(*(_QWORD *)(a2 + 16), 3);
    sub_4D174((__int64)v4, &v14);
    sub_4D558((__int64)v4, &v12);
    sub_4D258((__int64)v4, &v13);
    v5 = v12;
    if ( !v12 )
    {
      v5 = 0x2000;
      v12 = 0x2000;
    }
    v6 = *(_QWORD *)(a1 + 408);
    v7 = *(_QWORD *)(*(_QWORD *)(a1 + 400) + 408i64);
    *(_DWORD *)(v6 + 208) = v13 + v5;
    v8 = *(_DWORD *)(v6 + 24);
    if ( v13 != v8 )
    {
      v9 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        v10 = 44;
LABEL_23:
        sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, v10, (__int64)&unk_57D08);
        return 0i64;
      }
      return 0i64;
    }
    *(_DWORD *)(v6 + 20) = v8;
    *(_DWORD *)(v7 + 48) = *(_DWORD *)(v7 + 52);
    *(_DWORD *)(v6 + 16) = 5;
    *(_DWORD *)(v7 + 16) = 5;
    *(_DWORD *)(v6 + 88) = *(_DWORD *)(v6 + 48);
    *(_DWORD *)(v6 + 128) = *(_DWORD *)(v6 + 20);
    *(_DWORD *)(v7 + 88) = *(_DWORD *)(v7 + 48);
    *(_DWORD *)(v7 + 128) = *(_DWORD *)(v7 + 20);
    sub_30B80(*(_QWORD *)(v6 + 160), *(_QWORD *)(v7 + 160));
    sub_32FC0(a2, 0i64);
  }
  else
  {
    v9 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      goto LABEL_19;
    }
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Du, (__int64)&unk_57D08);
  }
  v9 = off_5A148;
LABEL_19:
  if ( v9 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v9->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v10 = 46;
    goto LABEL_23;
  }
  return 0i64;
}

//----- (0000000000031D84) ----------------------------------------------------
__int64 __fastcall sub_31D84(__int64 a1, __int64 *a2)
{
  __int64 v4; // rsi
  __int64 v5; // r14
  PDEVICE_OBJECT v6; // rbp
  _BYTE *v8; // rbx
  int v9; // er9
  unsigned __int16 v10; // di
  unsigned __int16 v11; // ax
  int v12; // ecx
  int v13; // edx
  int v14; // eax
  struct _KEVENT *v15; // rcx
  int v16; // ebx
  int v17; // eax
  int v18; // eax
  PDEVICE_OBJECT v19; // rcx
  __int64 v20; // [rsp+20h] [rbp-C8h]
  __int64 v21; // [rsp+28h] [rbp-C0h]
  __int64 v22; // [rsp+30h] [rbp-B8h]
  __int64 v23; // [rsp+38h] [rbp-B0h]
  void *Src[2]; // [rsp+70h] [rbp-78h] BYREF
  _DWORD Dst[26]; // [rsp+80h] [rbp-68h] BYREF
  unsigned __int16 v26; // [rsp+F0h] [rbp+8h] BYREF
  unsigned __int16 v27; // [rsp+F8h] [rbp+10h] BYREF
  int v28; // [rsp+100h] [rbp+18h] BYREF
  int v29; // [rsp+108h] [rbp+20h] BYREF

  Src[0] = 0i64;
  v26 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Fu, (__int64)&unk_57D08);
  }
  v4 = *(_QWORD *)(a1 + 408);
  v5 = *(_QWORD *)(*(_QWORD *)(a1 + 400) + 408i64);
  sub_50E34(a2[2], Src, &v26);
  if ( Src[0] )
  {
    v6 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_180C0(
          *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
          0x30u,
          (__int64)&unk_57D08,
          *a2,
          *((_DWORD *)a2 + 31),
          v26,
          *(unsigned __int8 *)Src[0],
          *((unsigned __int8 *)Src[0] + 1),
          *((unsigned __int8 *)Src[0] + 2),
          *((unsigned __int8 *)Src[0] + 3),
          *((unsigned __int8 *)Src[0] + 4),
          *((unsigned __int8 *)Src[0] + 5),
          *((unsigned __int8 *)Src[0] + 6),
          Src[0]);
        v6 = off_5A148;
      }
      if ( v6 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v6->DeviceLock.Header.WaitListHead.Blink + 1, 0xDu)
        && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x31u, (__int64)&unk_57D08);
      }
    }
    sub_309F0(v4);
  }
  if ( !*(_QWORD *)(v5 + 160) )
    *(_QWORD *)(v5 + 160) = sub_2E39C(a2, (unsigned int)*(unsigned __int16 *)(v5 + 168) + 134);
  if ( !sub_51B48(a2[2]) )
  {
    v8 = sub_4AE28(a2[2], 3);
    sub_4D174((__int64)v8, &v28);
    sub_4D558((__int64)v8, &v27);
    sub_4D258((__int64)v8, &v29);
    sub_50E34(a2[2], Src, &v26);
    v9 = v29 + v27;
    *(_DWORD *)(v4 + 208) = v9;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      LODWORD(v23) = v9;
      LODWORD(v22) = v29;
      LODWORD(v21) = v27;
      LODWORD(v20) = v28;
      sub_30E8C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 51i64, (__int64)&unk_57D08, *a2, v20, v21, v22, v23);
    }
    memmove(Dst, (const void *)(v4 + 48), 0x1Cui64);
    v10 = v26;
    if ( sub_2DB00(v28, v26, Dst) )
    {
      memmove((void *)(*(_QWORD *)(v4 + 80) + (unsigned int)(v28 - *(_DWORD *)(v4 + 88))), Src[0], v10);
      sub_2DC18(v28, v10, v4 + 80);
      sub_2E098(v28, v10, v4 + 48);
      v11 = sub_2E198(v29, *(unsigned int *)(v4 + 208), v4 + 20);
      *(_DWORD *)(v4 + 176) += v11;
      v12 = *(_DWORD *)(v4 + 172);
      v13 = *(_DWORD *)(v4 + 176);
      if ( v12 && v11 )
        *(_DWORD *)(v4 + 204) = 0;
      if ( v13 == v12 + 1 )
      {
        --*(_DWORD *)(v4 + 20);
        --*(_DWORD *)(v4 + 28);
        *(_DWORD *)(v4 + 176) = v13 - 1;
      }
      v14 = *(_DWORD *)(v4 + 176);
      if ( v14 == v12 && (v12 || v14) )
      {
        v15 = *(struct _KEVENT **)(v4 + 184);
        *(_DWORD *)(v4 + 172) = 0;
        *(_DWORD *)(v4 + 176) = 0;
        sub_3D0FC(v15);
      }
      if ( !*(_QWORD *)(v4 + 160) )
        *(_QWORD *)(v4 + 160) = sub_2F4D0(a2, (unsigned int)*(unsigned __int16 *)(v4 + 168) + 134);
      memmove(Dst, (const void *)(v4 + 80), 0x20ui64);
      if ( sub_2E71C(v4, (__int64)Dst) )
      {
        sub_2E830(v4);
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x43u, (__int64)&unk_57D08);
        }
        v16 = sub_32B84(a1);
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x44u, (__int64)&unk_57D08);
        }
        if ( !v16 )
          sub_2F2E0(v4);
      }
      else
      {
        v17 = *(_DWORD *)(v4 + 172);
        if ( *(_DWORD *)(v4 + 176) == v17 || !v17 )
          sub_2FEB4((_DWORD *)v4, v28, v29, v10);
        else
          sub_2EB7C(v4);
      }
      if ( !sub_51A0C(a2[2]) )
        goto LABEL_61;
      if ( v28 + v10 != *(_DWORD *)(v4 + 48) )
        goto LABEL_61;
      ++*(_DWORD *)(v4 + 52);
      *(_DWORD *)(v4 + 16) = 7;
      sub_2E830(v4);
      v18 = sub_32D38(a1);
      if ( !v18 )
        goto LABEL_61;
      v19 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 0
          || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
        {
LABEL_62:
          if ( v19 != (PDEVICE_OBJECT)&off_5A148
            && SBYTE4(v19->DeviceLock.Header.WaitListHead.Blink) < 0
            && BYTE1(v19->DeviceLock.Header.WaitListHead.Blink) >= 5u )
          {
            sub_11088(*(_QWORD *)&v19->DeviceLock.Header.Lock, 0x35u, (__int64)&unk_57D08);
          }
          return 0i64;
        }
        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x34u, (__int64)&unk_57D08, v18);
LABEL_61:
        v19 = off_5A148;
        goto LABEL_62;
      }
    }
    else
    {
      sub_30DA0(v4, 0, 0);
    }
    return 0i64;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x32u, (__int64)&unk_57D08);
  }
  *(_DWORD *)(v4 + 16) = 0;
  return sub_32E7C(a1);
}
// 3205B: variable 'v20' is possibly undefined
// 3205B: variable 'v21' is possibly undefined
// 3205B: variable 'v22' is possibly undefined
// 3205B: variable 'v23' is possibly undefined

//----- (000000000003236C) ----------------------------------------------------
__int64 __fastcall sub_3236C(__int64 a1, __int64 a2)
{
  __int64 v4; // rdi
  _BYTE *v5; // rbx
  unsigned __int16 v7; // ax
  int v8; // ecx
  int v9; // edx
  int v10; // eax
  struct _KEVENT *v11; // rcx
  __int64 v12; // rcx
  PDEVICE_OBJECT v13; // rcx
  unsigned __int16 v14; // dx
  __int64 v15[9]; // [rsp+20h] [rbp-48h] BYREF
  unsigned __int16 v16; // [rsp+70h] [rbp+8h] BYREF
  unsigned __int16 v17; // [rsp+78h] [rbp+10h] BYREF
  int v18; // [rsp+80h] [rbp+18h] BYREF
  int v19; // [rsp+88h] [rbp+20h] BYREF

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x36u, (__int64)&unk_57D08);
  }
  v4 = *(_QWORD *)(a1 + 408);
  v5 = sub_4AE28(*(_QWORD *)(a2 + 16), 3);
  sub_4D174((__int64)v5, &v19);
  sub_4D558((__int64)v5, &v17);
  sub_4D258((__int64)v5, &v18);
  sub_50E34(*(_QWORD *)(a2 + 16), v15, &v16);
  if ( !sub_51B48(*(_QWORD *)(a2 + 16)) )
  {
    sub_2DC18(v19, v16, v4 + 80);
    sub_2E098(v19, v16, v4 + 48);
    v7 = sub_2E198(v18, *(unsigned int *)(v4 + 208), v4 + 20);
    *(_DWORD *)(v4 + 208) = v18 + v17;
    *(_DWORD *)(v4 + 176) += v7;
    v8 = *(_DWORD *)(v4 + 172);
    v9 = *(_DWORD *)(v4 + 176);
    if ( v8 && v7 )
      *(_DWORD *)(v4 + 204) = 0;
    if ( v9 == v8 + 1 )
    {
      --*(_DWORD *)(v4 + 20);
      --*(_DWORD *)(v4 + 28);
      *(_DWORD *)(v4 + 176) = v9 - 1;
    }
    v10 = *(_DWORD *)(v4 + 176);
    if ( v10 == v8 && (v8 || v10) )
    {
      v11 = *(struct _KEVENT **)(v4 + 184);
      *(_DWORD *)(v4 + 172) = 0;
      *(_DWORD *)(v4 + 176) = 0;
      sub_3D0FC(v11);
    }
    v12 = *(_QWORD *)(a2 + 16);
    if ( *(_DWORD *)(v4 + 24) - v18 >= 0 )
    {
      if ( !sub_51A0C(v12) )
      {
        *(_DWORD *)(v4 + 16) = 10;
        goto LABEL_35;
      }
      ++*(_DWORD *)(v4 + 52);
      *(_DWORD *)(v4 + 16) = 0;
      sub_2E830(v4);
      if ( !(unsigned int)sub_32D38(a1) )
      {
LABEL_35:
        v13 = off_5A148;
        goto LABEL_36;
      }
      v13 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          v14 = 56;
          goto LABEL_27;
        }
LABEL_36:
        if ( v13 != (PDEVICE_OBJECT)&off_5A148
          && SBYTE4(v13->DeviceLock.Header.WaitListHead.Blink) < 0
          && BYTE1(v13->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v13->DeviceLock.Header.Lock, 0x3Au, (__int64)&unk_57D08);
        }
        return 0i64;
      }
    }
    else
    {
      if ( !sub_51A0C(v12) )
        goto LABEL_35;
      ++*(_DWORD *)(v4 + 52);
      *(_DWORD *)(v4 + 16) = 11;
      sub_2E830(v4);
      if ( !(unsigned int)sub_32D38(a1) )
        goto LABEL_35;
      v13 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          v14 = 57;
LABEL_27:
          sub_11088(*(_QWORD *)&v13->DeviceLock.Header.Lock, v14, (__int64)&unk_57D08);
          goto LABEL_35;
        }
        goto LABEL_36;
      }
    }
    return 0i64;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x37u, (__int64)&unk_57D08);
  }
  *(_DWORD *)(v4 + 16) = 0;
  return sub_32E7C(a1);
}

//----- (000000000003264C) ----------------------------------------------------
__int64 __fastcall sub_3264C(__int64 a1, __int64 *a2)
{
  __int64 v4; // rdi
  __int64 v5; // r12
  _BYTE *v6; // rbx
  unsigned __int16 v8; // ax
  int v9; // ecx
  int v10; // edx
  int v11; // eax
  struct _KEVENT *v12; // rcx
  PDEVICE_OBJECT v13; // rcx
  __int64 v14[9]; // [rsp+20h] [rbp-48h] BYREF
  unsigned __int16 v15; // [rsp+70h] [rbp+8h] BYREF
  unsigned __int16 v16; // [rsp+78h] [rbp+10h] BYREF
  int v17; // [rsp+80h] [rbp+18h] BYREF
  int v18; // [rsp+88h] [rbp+20h] BYREF

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Bu, (__int64)&unk_57D08);
  }
  v4 = *(_QWORD *)(a1 + 408);
  v5 = *(_QWORD *)(*(_QWORD *)(a1 + 400) + 408i64);
  v6 = sub_4AE28(a2[2], 3);
  sub_4D174((__int64)v6, &v17);
  sub_4D558((__int64)v6, &v16);
  sub_4D258((__int64)v6, &v18);
  sub_50E34(a2[2], v14, &v15);
  if ( !*(_QWORD *)(v5 + 160) )
    *(_QWORD *)(v5 + 160) = sub_2E39C(a2, (unsigned int)*(unsigned __int16 *)(v5 + 168) + 134);
  if ( !sub_51B48(a2[2]) )
  {
    sub_2DC18(v17, v15, v4 + 80);
    sub_2E098(v17, v15, v4 + 48);
    v8 = sub_2E198(v18, *(unsigned int *)(v4 + 208), v4 + 20);
    *(_DWORD *)(v4 + 208) = v18 + v16;
    *(_DWORD *)(v4 + 176) += v8;
    v9 = *(_DWORD *)(v4 + 172);
    v10 = *(_DWORD *)(v4 + 176);
    if ( v9 && v8 )
      *(_DWORD *)(v4 + 204) = 0;
    if ( v10 == v9 + 1 )
    {
      --*(_DWORD *)(v4 + 20);
      --*(_DWORD *)(v4 + 28);
      *(_DWORD *)(v4 + 176) = v10 - 1;
    }
    v11 = *(_DWORD *)(v4 + 176);
    if ( v11 == v9 && (v9 || v11) )
    {
      v12 = *(struct _KEVENT **)(v4 + 184);
      *(_DWORD *)(v4 + 172) = 0;
      *(_DWORD *)(v4 + 176) = 0;
      sub_3D0FC(v12);
    }
    if ( sub_51A0C(a2[2]) )
    {
      ++*(_DWORD *)(v4 + 52);
      *(_DWORD *)(v4 + 16) = 0;
      *(_DWORD *)(v4 + 172) = 0;
      *(_DWORD *)(v4 + 176) = 0;
      sub_2E830(v4);
      if ( (unsigned int)sub_32D38(a1) )
      {
        v13 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
          return 0i64;
        if ( SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 0
          || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
        {
LABEL_29:
          if ( v13 != (PDEVICE_OBJECT)&off_5A148
            && SBYTE4(v13->DeviceLock.Header.WaitListHead.Blink) < 0
            && BYTE1(v13->DeviceLock.Header.WaitListHead.Blink) >= 5u )
          {
            sub_11088(*(_QWORD *)&v13->DeviceLock.Header.Lock, 0x3Eu, (__int64)&unk_57D08);
          }
          return 0i64;
        }
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Du, (__int64)&unk_57D08);
      }
    }
    v13 = off_5A148;
    goto LABEL_29;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Cu, (__int64)&unk_57D08);
  }
  *(_DWORD *)(v4 + 16) = 0;
  return sub_32E7C(a1);
}

//----- (0000000000032908) ----------------------------------------------------
__int64 __fastcall sub_32908(__int64 a1, __int64 a2)
{
  __int64 v4; // rdi
  _BYTE *v5; // rbx
  unsigned __int16 v7; // ax
  int v8; // ecx
  int v9; // edx
  int v10; // eax
  struct _KEVENT *v11; // rcx
  __int64 v12[9]; // [rsp+20h] [rbp-48h] BYREF
  unsigned __int16 v13; // [rsp+70h] [rbp+8h] BYREF
  unsigned __int16 v14; // [rsp+78h] [rbp+10h] BYREF
  int v15; // [rsp+80h] [rbp+18h] BYREF
  int v16; // [rsp+88h] [rbp+20h] BYREF

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Fu, (__int64)&unk_57D08);
  }
  v4 = *(_QWORD *)(a1 + 408);
  v5 = sub_4AE28(*(_QWORD *)(a2 + 16), 3);
  sub_4D174((__int64)v5, &v16);
  sub_4D558((__int64)v5, &v14);
  sub_4D258((__int64)v5, &v15);
  sub_50E34(*(_QWORD *)(a2 + 16), v12, &v13);
  if ( sub_51B48(*(_QWORD *)(a2 + 16)) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x40u, (__int64)&unk_57D08);
    }
    *(_DWORD *)(v4 + 16) = 0;
    return sub_32D38(a1);
  }
  sub_2DC18(v16, v13, v4 + 80);
  sub_2E098(v16, v13, v4 + 48);
  v7 = sub_2E198(v15, *(unsigned int *)(v4 + 208), v4 + 20);
  *(_DWORD *)(v4 + 208) = v15 + v14;
  *(_DWORD *)(v4 + 176) += v7;
  v8 = *(_DWORD *)(v4 + 172);
  v9 = *(_DWORD *)(v4 + 176);
  if ( v8 && v7 )
    *(_DWORD *)(v4 + 204) = 0;
  if ( v9 == v8 + 1 )
  {
    --*(_DWORD *)(v4 + 20);
    --*(_DWORD *)(v4 + 28);
    *(_DWORD *)(v4 + 176) = v9 - 1;
  }
  v10 = *(_DWORD *)(v4 + 176);
  if ( v10 == v8 && (v8 || v10) )
  {
    v11 = *(struct _KEVENT **)(v4 + 184);
    *(_DWORD *)(v4 + 172) = 0;
    *(_DWORD *)(v4 + 176) = 0;
    sub_3D0FC(v11);
  }
  if ( *(_DWORD *)(v4 + 24) - v15 < 0 )
  {
    if ( sub_51A0C(*(_QWORD *)(a2 + 16)) )
    {
      sub_2E94C(v4);
      goto LABEL_29;
    }
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x41u, (__int64)&unk_57D08);
    }
    sub_2EA7C(v4);
  }
  *(_DWORD *)(v4 + 16) = 0;
LABEL_29:
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x42u, (__int64)&unk_57D08);
  }
  return 0i64;
}

//----- (0000000000032B84) ----------------------------------------------------
__int64 __fastcall sub_32B84(__int64 a1)
{
  PDEVICE_OBJECT v2; // r9
  __int64 v3; // rax
  __int64 v4; // rcx
  int v6; // eax
  unsigned int v7; // ebx
  PDEVICE_OBJECT v8; // rcx
  __int64 *v9; // [rsp+20h] [rbp-58h] BYREF
  __int64 v10; // [rsp+28h] [rbp-50h]
  __int64 v11; // [rsp+30h] [rbp-48h]
  __int64 v12[3]; // [rsp+38h] [rbp-40h] BYREF
  int v13; // [rsp+50h] [rbp-28h]
  BOOL v14; // [rsp+54h] [rbp-24h]
  char v15; // [rsp+58h] [rbp-20h]

  v10 = 0i64;
  v11 = 0i64;
  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x45u, (__int64)&unk_57D08);
    v2 = off_5A148;
  }
  v3 = *(_QWORD *)(a1 + 400);
  LODWORD(v10) = 49;
  v11 = 0i64;
  v4 = *(_QWORD *)(a1 + 408);
  v14 = (*(_BYTE *)(*(_QWORD *)(*(_QWORD *)(v3 + 408) + 160i64) + 120i64) & 0x10) == 16;
  v12[0] = *(_QWORD *)a1;
  v12[1] = *(_QWORD *)(a1 + 392);
  v12[2] = *(_QWORD *)(v4 + 80);
  LODWORD(v4) = *(_DWORD *)(*(_QWORD *)(v4 + 96) + 4i64) - **(_DWORD **)(v4 + 96);
  v15 = 0;
  v9 = v12;
  v13 = v4 + 1;
  if ( (_DWORD)v4 != -1 )
  {
    v6 = sub_17324(259, (__int64)&v9, *(_DWORD *)(a1 + 24));
    v7 = v6;
    if ( v6 )
    {
      v8 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return v7;
      if ( SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 0
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
LABEL_17:
        if ( v8 != (PDEVICE_OBJECT)&off_5A148
          && SBYTE4(v8->DeviceLock.Header.WaitListHead.Blink) < 0
          && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x48u, (__int64)&unk_57D08);
        }
        return v7;
      }
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x47u, (__int64)&unk_57D08, v6);
    }
    v8 = off_5A148;
    goto LABEL_17;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v2->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x46u, (__int64)&unk_57D08);
  }
  return 278i64;
}

//----- (0000000000032D38) ----------------------------------------------------
__int64 __fastcall sub_32D38(__int64 a1)
{
  char v2; // cl
  bool v3; // zf
  int v4; // ecx
  int v5; // eax
  unsigned int v6; // ebx
  PDEVICE_OBJECT v7; // rcx
  __int64 v9[3]; // [rsp+20h] [rbp-48h] BYREF
  int v10; // [rsp+38h] [rbp-30h]
  BOOL v11; // [rsp+3Ch] [rbp-2Ch]
  char v12; // [rsp+40h] [rbp-28h]
  __int64 v13; // [rsp+41h] [rbp-27h]
  __int64 v14; // [rsp+49h] [rbp-1Fh]

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x49u, (__int64)&unk_57D08);
  }
  v2 = *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(*(_QWORD *)(a1 + 400) + 408i64) + 160i64) + 120i64);
  v12 = 1;
  v3 = (v2 & 0x10) == 16;
  v4 = *(_DWORD *)(a1 + 24);
  v9[2] = 0i64;
  v10 = 0;
  v11 = v3;
  v9[0] = *(_QWORD *)a1;
  v13 = *(_QWORD *)(a1 + 32);
  v14 = *(_QWORD *)(a1 + 40);
  v9[1] = *(_QWORD *)(a1 + 392);
  v5 = sub_1F628(v4, (__int64)v9, 0i64, a1);
  v6 = v5;
  if ( !v5 )
    goto LABEL_10;
  v7 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v6;
  if ( SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Au, (__int64)&unk_57D08, v5);
LABEL_10:
    v7 = off_5A148;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v7->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x4Bu, (__int64)&unk_57D08);
  }
  return v6;
}

//----- (0000000000032E7C) ----------------------------------------------------
__int64 __fastcall sub_32E7C(__int64 a1)
{
  char v2; // cl
  bool v3; // zf
  int v4; // ecx
  int v5; // eax
  unsigned int v6; // ebx
  PDEVICE_OBJECT v7; // rcx
  __int64 v9[3]; // [rsp+20h] [rbp-48h] BYREF
  int v10; // [rsp+38h] [rbp-30h]
  BOOL v11; // [rsp+3Ch] [rbp-2Ch]
  char v12; // [rsp+40h] [rbp-28h]
  __int64 v13; // [rsp+41h] [rbp-27h]
  __int64 v14; // [rsp+49h] [rbp-1Fh]

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Cu, (__int64)&unk_57D08);
  }
  v2 = *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(*(_QWORD *)(a1 + 400) + 408i64) + 160i64) + 120i64);
  v12 = 2;
  v3 = (v2 & 0x10) == 16;
  v4 = *(_DWORD *)(a1 + 24);
  v9[2] = 0i64;
  v10 = 0;
  v11 = v3;
  v9[0] = *(_QWORD *)a1;
  v9[1] = *(_QWORD *)(a1 + 392);
  v13 = *(_QWORD *)(a1 + 32);
  v14 = *(_QWORD *)(a1 + 40);
  v5 = sub_1F628(v4, (__int64)v9, 0i64, a1);
  v6 = v5;
  if ( !v5 )
    goto LABEL_10;
  v7 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v6;
  if ( SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Du, (__int64)&unk_57D08, v5);
LABEL_10:
    v7 = off_5A148;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v7->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x4Eu, (__int64)&unk_57D08);
  }
  return v6;
}

//----- (0000000000032FC0) ----------------------------------------------------
__int64 __fastcall sub_32FC0(__int64 a1, unsigned __int64 a2)
{
  unsigned __int64 *v3; // rax
  unsigned __int64 *v4; // rdi
  int v6; // eax
  unsigned int v7; // edx
  PVOID v8; // rax
  int v9; // eax
  int v10; // eax
  int v11; // eax
  int v12; // eax
  unsigned int v13; // er12
  unsigned __int8 *v14; // rbp
  PDEVICE_OBJECT v15; // rsi
  unsigned __int16 v16; // dx
  int v17; // eax
  __int64 v18; // [rsp+20h] [rbp-98h]
  __int64 v19; // [rsp+70h] [rbp-48h] BYREF
  __int64 v20[8]; // [rsp+78h] [rbp-40h] BYREF
  char v22; // [rsp+D0h] [rbp+18h] BYREF
  __int16 v23; // [rsp+D8h] [rbp+20h] BYREF

  LODWORD(v19) = 0;
  v22 = 0;
  v20[0] = 0i64;
  v23 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Fu, (__int64)&unk_57D08);
  }
  v3 = (unsigned __int64 *)sub_3C910((__int64)qword_5A8A8);
  v4 = v3;
  if ( !v3 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x50u, (__int64)&unk_57D08);
    }
    return 3i64;
  }
  *(unsigned __int64 *)((char *)v3 + 220) = 0i64;
  v6 = *(_DWORD *)(a1 + 372);
  *((_DWORD *)v4 + 30) = 0;
  *((_DWORD *)v4 + 93) = v6;
  if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
    *((_DWORD *)v4 + 30) = 16;
  *((_DWORD *)v4 + 32) = 2;
  *v4 = _InterlockedIncrement64(&qword_5D418) | 0x8000000000000000ui64;
  v4[1] = MEMORY[0xFFFFF78000000014];
  v7 = *(_DWORD *)(a1 + 124);
  *((_DWORD *)v4 + 31) = v7;
  v8 = sub_3C4EC(2, v7, 0x624E734Eu);
  v4[2] = (unsigned __int64)v8;
  if ( !v8 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x51u, (__int64)&unk_57D08);
    }
    sub_3C978((__int64)qword_5A8A8, (__int64)v4);
    return 3i64;
  }
  memmove(v8, *(const void **)(a1 + 16), *((unsigned int *)v4 + 31));
  sub_4B3A0(v4[2], *((_DWORD *)v4 + 31), (__int64 *)v4 + 3);
  sub_51370(v4[2], &v22);
  if ( v22 )
  {
    v9 = sub_4D8E4(4u, (__int64)(v4 + 3));
    if ( v9
      && off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x52u, (__int64)&unk_57D08, v9);
    }
    v10 = sub_4D8E4(3u, (__int64)(v4 + 3));
    if ( v10
      && off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x53u, (__int64)&unk_57D08, v10);
    }
    v11 = sub_4D8E4(8u, (__int64)(v4 + 3));
    if ( v11
      && off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x54u, (__int64)&unk_57D08, v11);
    }
  }
  *((_DWORD *)v4 + 30) |= 0x40u;
  sub_3068C(v4);
  if ( a2 )
  {
    if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x56u, (__int64)&unk_57D08);
      }
      *((_DWORD *)v4 + 92) = 2;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x55u, (__int64)&unk_57D08);
      }
      *((_DWORD *)v4 + 92) = 1;
    }
    v4[45] = a2;
    v12 = sub_4535C(0x2013015u);
    v13 = sub_40A2C(40008, v4, 0x190u, v12, (int *)&v19);
    sub_50E34(v4[2], v20, &v23);
    v14 = (unsigned __int8 *)v20[0];
    if ( !v20[0] )
      goto LABEL_58;
    v15 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xCu)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      goto LABEL_58;
    }
    v16 = 87;
  }
  else
  {
    v17 = sub_4535C(0x2013015u);
    v13 = sub_40A2C(40008, v4, 0x190u, v17, (int *)&v19);
    sub_50E34(v4[2], v20, &v23);
    v14 = (unsigned __int8 *)v20[0];
    if ( !v20[0] )
      goto LABEL_58;
    v15 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xCu)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      goto LABEL_58;
    }
    v16 = 88;
  }
  LODWORD(v18) = *((_DWORD *)v4 + 31);
  sub_180C0(
    *(_QWORD *)&v15->DeviceLock.Header.Lock,
    v16,
    (__int64)&unk_57D08,
    *v4,
    v18,
    v13,
    *v14,
    v14[1],
    v14[2],
    v14[3],
    v14[4],
    v14[5],
    v14[6],
    v14,
    v19);
LABEL_58:
  sub_308B0(v4);
  sub_3C570((PVOID)v4[2], 0x624E734Eu);
  sub_3C978((__int64)qword_5A8A8, (__int64)v4);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x59u, (__int64)&unk_57D08);
  }
  return v13;
}
// 33474: variable 'v18' is possibly undefined
// 5D418: using guessed type __int64 qword_5D418;

//----- (0000000000033508) ----------------------------------------------------
char __fastcall sub_33508(__int64 a1, int *a2)
{
  PDEVICE_OBJECT v4; // rcx
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Fu, (__int64)&unk_57D08);
    v4 = off_5A148;
  }
  *a2 = 0;
  if ( !a1 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v4->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x60u, (__int64)&unk_57D08);
    }
    *a2 = 4;
    return 1;
  }
  if ( sub_33674(a1, a2) )
  {
    v6 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      return 1;
    }
    v7 = 97;
LABEL_17:
    sub_13EA4(*(_QWORD *)&v6->DeviceLock.Header.Lock, v7, (__int64)&unk_57D08, *a2);
    return 1;
  }
  if ( sub_337DC(a1, a2) )
  {
    v6 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      return 1;
    }
    v7 = 98;
    goto LABEL_17;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x63u, (__int64)&unk_57D08);
  }
  return 0;
}

//----- (0000000000033674) ----------------------------------------------------
char __fastcall sub_33674(__int64 a1, _DWORD *a2)
{
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  bool v7; // [rsp+30h] [rbp+8h] BYREF

  v7 = 0;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x64u, (__int64)&unk_57D08);
    v4 = off_5A148;
  }
  *a2 = 0;
  if ( !a1 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v4->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x65u, (__int64)&unk_57D08);
    }
    *a2 = 4;
    return 1;
  }
  if ( !*(_QWORD *)(a1 + 40) )
  {
    if ( v4 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v4->DeviceLock.Header.WaitListHead.Blink) >= 0
      || BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      goto LABEL_27;
    }
    v5 = 102;
    goto LABEL_26;
  }
  sub_50500(*(_BYTE **)(a1 + 40), &v7);
  if ( !v7 )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      goto LABEL_27;
    }
    v5 = 103;
LABEL_26:
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, v5, (__int64)&unk_57D08);
LABEL_27:
    *a2 = 6;
    return 1;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x68u, (__int64)&unk_57D08);
  }
  return 0;
}

//----- (00000000000337DC) ----------------------------------------------------
char __fastcall sub_337DC(__int64 a1, int *a2)
{
  PDEVICE_OBJECT v4; // rcx
  int v6; // eax
  bool v7; // [rsp+30h] [rbp+8h] BYREF

  v7 = 0;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x69u, (__int64)&unk_57D08);
    v4 = off_5A148;
  }
  *a2 = 0;
  if ( !a1 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v4->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x6Au, (__int64)&unk_57D08);
    }
    *a2 = 4;
    return 1;
  }
  v6 = sub_506E8(a1 + 24, &v7);
  *a2 = v6;
  if ( v6 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Bu, (__int64)&unk_57D08, v6);
    }
    return 1;
  }
  if ( !v7 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Cu, (__int64)&unk_57D08);
    }
    *a2 = 6;
    return 1;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Du, (__int64)&unk_57D08);
  }
  return 0;
}

//----- (0000000000033960) ----------------------------------------------------
__int64 __fastcall sub_33960(__int64 a1)
{
  __int64 v2; // rcx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Eu, (__int64)&unk_57D08);
  }
  KeWaitForSingleObject(*(PVOID *)(a1 + 8), Executive, 0, 0, 0i64);
  v2 = *(_QWORD *)(a1 + 408);
  switch ( *(_DWORD *)(v2 + 16) )
  {
    case 5:
      sub_2E94C(v2);
      *(_DWORD *)(*(_QWORD *)(a1 + 408) + 16i64) = 9;
      break;
    case 7:
      sub_2E94C(v2);
      *(_DWORD *)(*(_QWORD *)(a1 + 408) + 16i64) = 8;
      break;
    case 9:
      sub_2E94C(v2);
      *(_DWORD *)(*(_QWORD *)(a1 + 408) + 16i64) = 11;
      break;
  }
  KeReleaseMutex(*(PRKMUTEX *)(a1 + 8), 0);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Fu, (__int64)&unk_57D08);
  }
  return 0i64;
}

//----- (0000000000033A70) ----------------------------------------------------
__int64 __fastcall sub_33A70(__int64 a1, char a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x70u, (__int64)&unk_57D08);
  }
  if ( a2 )
    KeWaitForSingleObject(*(PVOID *)(a1 + 8), Executive, 0, 0, 0i64);
  sub_2EA7C(*(_QWORD *)(a1 + 408));
  if ( a2 )
    KeReleaseMutex(*(PRKMUTEX *)(a1 + 8), 0);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x71u, (__int64)&unk_57D08);
  }
  return 0i64;
}

//----- (0000000000033B4C) ----------------------------------------------------
__int64 __fastcall sub_33B4C(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 v3; // rsi
  unsigned int v4; // ebx
  unsigned __int16 v5; // dx
  _DWORD *v6; // rax
  int v7; // ebp
  __int64 v8; // r12
  int v9; // edi
  unsigned __int16 v11; // [rsp+30h] [rbp-28h]

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x72u, (__int64)&unk_57D08);
    v2 = off_5A148;
  }
  v3 = *(_QWORD *)(a1 + 408);
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x9Du, (__int64)&unk_57D18);
    v2 = off_5A148;
  }
  v4 = 0;
  if ( v3 )
  {
    v6 = *(_DWORD **)(v3 + 96);
    v7 = *(_DWORD *)(v3 + 20);
    v8 = *(_QWORD *)(v3 + 80);
    v9 = v6[1] - *v6;
    if ( *v6 && v6[1] )
      ++v9;
    if ( v9 )
    {
      v11 = sub_4535C(0x201301Du);
      if ( v9 > 0 )
        v4 = v9;
      sub_30114(*(_QWORD *)(v3 + 8), 2, v8, v4, *(_DWORD *)(v3 + 24), v7, v11);
    }
    else
    {
      if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( !_bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
        || BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) < 4u )
      {
        goto LABEL_26;
      }
      sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x9Fu, (__int64)&unk_57D18);
    }
    v2 = off_5A148;
LABEL_26:
    if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( !_bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
      || BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      goto LABEL_31;
    }
    v5 = 160;
    goto LABEL_30;
  }
  if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
    return 0i64;
  if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 8u)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    v5 = 158;
LABEL_30:
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, v5, (__int64)&unk_57D18);
    v2 = off_5A148;
  }
LABEL_31:
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v2->DeviceLock.Header.WaitListHead.Blink) < 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x73u, (__int64)&unk_57D08);
  }
  return 0i64;
}

//----- (0000000000033D34) ----------------------------------------------------
__int64 sub_33D34(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57CF8, 68i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000033DA4) ----------------------------------------------------
__int64 sub_33DA4(__int64 a1, __int64 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+B8h] [rbp+20h] BYREF
  va_list va; // [rsp+B8h] [rbp+20h]
  __int64 v7; // [rsp+C0h] [rbp+28h]
  __int64 v8; // [rsp+C8h] [rbp+30h]
  __int64 v9; // [rsp+D0h] [rbp+38h]
  const char *v10; // [rsp+D8h] [rbp+40h]
  const char *v11; // [rsp+E0h] [rbp+48h]
  va_list va1; // [rsp+E8h] [rbp+50h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, _QWORD);
  v8 = va_arg(va1, _QWORD);
  v9 = va_arg(va1, _QWORD);
  v10 = va_arg(va1, const char *);
  v11 = va_arg(va1, const char *);
  if ( v11 )
    strlen(v11);
  if ( v10 )
    strlen(v10);
  return qword_5A1B8(a1, 43i64, &unk_57CF8, 52i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000033EAC) ----------------------------------------------------
__int64 sub_33EAC(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57CF8, 132i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000033F1C) ----------------------------------------------------
__int64 __fastcall sub_33F1C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, a3, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000033F70) ----------------------------------------------------
__int64 sub_33F70(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57CF8, 157i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000033FC4) ----------------------------------------------------
__int64 sub_33FC4(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57CF8, 159i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000034028) ----------------------------------------------------
__int64 sub_34028(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+A8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57CF8, 160i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000340AC) ----------------------------------------------------
__int64 sub_340AC(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57CF8, 161i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000034100) ----------------------------------------------------
__int64 __fastcall sub_34100(__int64 a1, __int64 a2, __int64 a3, const char *a4, const char *a5, const char *a6, const char *a7)
{
  const char *v9; // rdi

  if ( a7 )
    strlen(a7);
  if ( a6 )
    strlen(a6);
  if ( a5 )
    strlen(a5);
  if ( a4 )
    strlen(a4);
  v9 = "NULL";
  if ( a4 )
    v9 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57CF8, 152i64, v9);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000034250) ----------------------------------------------------
__int64 sub_34250(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57CF8, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000342A4) ----------------------------------------------------
__int64 __fastcall sub_342A4(__int64 a1, _QWORD ***a2)
{
  unsigned int v3; // ebx
  PDEVICE_OBJECT v4; // rcx
  unsigned int v5; // eax

  v3 = 0;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xEu, (__int64)&unk_57CF8);
      v4 = off_5A148;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0xFu, (__int64)&unk_57CF8, 1025);
      v4 = off_5A148;
    }
  }
  if ( *a2 )
  {
    v5 = sub_34398(**a2);
    v4 = off_5A148;
    v3 = v5;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x11u, (__int64)&unk_57CF8);
  }
  return v3;
}

//----- (0000000000034398) ----------------------------------------------------
__int64 __fastcall sub_34398(_QWORD *a1)
{
  __int64 v1; // r13
  __int64 v3; // rdi
  char v4; // r14
  PDEVICE_OBJECT v5; // rcx
  __int64 result; // rax
  __int64 v7; // rbx
  __int64 v8; // rsi
  int v9; // edx
  int v10; // edx
  unsigned int v11; // ebx
  __int64 Dst[7]; // [rsp+20h] [rbp-38h] BYREF

  v1 = 0i64;
  v3 = 0i64;
  v4 = 1;
  Dst[0] = 0i64;
  Dst[1] = 0i64;
  Dst[2] = 0i64;
  Dst[3] = 0i64;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x12u, (__int64)&unk_57CF8);
    v5 = off_5A148;
  }
  if ( a1 )
  {
    v7 = a1[7];
    if ( (_QWORD *)v7 == a1 + 7 )
    {
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x14u, (__int64)&unk_57CF8);
      }
      result = 5i64;
    }
    else
    {
      do
      {
        if ( !v7
          && v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x15u, (__int64)&unk_57CF8);
          v5 = off_5A148;
        }
        v8 = *(_QWORD *)(v7 + 32);
        if ( v4 )
        {
          v3 = *(_QWORD *)(v7 + 32);
          v4 = 0;
        }
        if ( v8 != v3 )
        {
          sub_3464C((__int64)Dst, a1);
          memset(Dst, 0, 0x20ui64);
          v1 = Dst[0];
          v5 = off_5A148;
          v4 = 1;
        }
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x17u, (__int64)&unk_57CF8);
          v5 = off_5A148;
        }
        v9 = *(_DWORD *)(v7 + 40);
        if ( !v1 )
          v1 = v7;
        Dst[0] = v1;
        if ( v9 )
        {
          v10 = v9 - 1;
          if ( v10 )
          {
            if ( v10 == 1 )
              Dst[1] = v7;
          }
          else
          {
            Dst[3] = v7;
          }
        }
        else
        {
          Dst[2] = v7;
        }
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
          && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x18u, (__int64)&unk_57CF8);
          v5 = off_5A148;
        }
        v7 = *(_QWORD *)v7;
        v3 = v8;
      }
      while ( (_QWORD *)v7 != a1 + 7 );
      v11 = sub_3464C((__int64)Dst, a1);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x16u, (__int64)&unk_57CF8);
      }
      result = v11;
    }
  }
  else
  {
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x13u, (__int64)&unk_57CF8);
    }
    result = 4i64;
  }
  return result;
}

//----- (000000000003464C) ----------------------------------------------------
__int64 __fastcall sub_3464C(__int64 a1, _QWORD *a2)
{
  unsigned int v4; // ebx
  __int64 v6; // r11
  unsigned int v7; // eax
  union _LARGE_INTEGER Interval; // [rsp+50h] [rbp+18h] BYREF

  v4 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x19u, (__int64)&unk_57CF8);
  }
  if ( !(unsigned __int8)sub_4535C(0x201301Au) )
    goto LABEL_37;
  if ( !*(_QWORD *)(a1 + 8) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Au, (__int64)&unk_57CF8);
    }
    return 6i64;
  }
  v6 = (unsigned int)sub_4535C(0x2013025u);
  if ( (unsigned __int64)(v6 - 1) <= 0xEA5E )
  {
    Interval.QuadPart = -10000 * v6;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Bu, (__int64)&unk_57CF8, v6);
    }
    KeDelayExecutionThread(0, 0, &Interval);
  }
  switch ( *(_DWORD *)(*(_QWORD *)(a1 + 8) + 24i64) )
  {
    case 1:
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Cu, (__int64)&unk_57CF8);
      }
      v7 = sub_34890((__int64 **)a1, a2);
      break;
    case 2:
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Eu, (__int64)&unk_57CF8);
      }
      v7 = sub_35F38(a1, a2);
      break;
    case 6:
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Du, (__int64)&unk_57CF8);
      }
      v7 = sub_357AC((__int64 **)a1, (__int64)a2);
      break;
    default:
      goto LABEL_37;
  }
  v4 = v7;
LABEL_37:
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Fu, (__int64)&unk_57CF8);
  }
  return v4;
}

//----- (0000000000034890) ----------------------------------------------------
__int64 __fastcall sub_34890(__int64 **a1, _QWORD *a2)
{
  unsigned __int32 v4; // er13
  PDEVICE_OBJECT v5; // rcx
  __int64 result; // rax
  int v7; // eax
  __int64 v8; // rdx
  unsigned int v9; // ebx
  __int64 *v10; // r14
  __int64 v11; // rax
  __int64 v12; // r15
  __int64 v13; // rdx
  __int64 v14; // r15
  __int64 v15; // rax
  __int64 v16; // r14
  unsigned int v17; // ebx
  __int64 v18; // r14
  _QWORD *v19; // r13
  char *v20; // rcx
  __int64 v21; // rdx
  __int64 v22; // rax
  __int64 **v23; // rcx
  __int64 v24; // r13
  _QWORD *v25; // rdx
  const void *v26; // r8
  unsigned __int16 *v27; // rax
  unsigned __int16 *v28; // r13
  int v29; // er13
  __int64 v30; // rbx
  _DWORD *v31; // r14
  const char *v32; // r14
  PDEVICE_OBJECT v33; // rcx
  PDEVICE_OBJECT v34; // rcx
  int v35; // eax
  int v36; // er14
  _BYTE *v37; // rbx
  const char *v38; // rax
  __int64 v39; // r10
  PDEVICE_OBJECT v40; // rcx
  __int64 v41; // r14
  __int64 v42; // r13
  __int64 v43; // [rsp+20h] [rbp-248h]
  __int64 v44; // [rsp+30h] [rbp-238h]
  char v45[4]; // [rsp+50h] [rbp-218h] BYREF
  int v46; // [rsp+54h] [rbp-214h]
  _QWORD *v47; // [rsp+58h] [rbp-210h]
  char v48[4]; // [rsp+60h] [rbp-208h] BYREF
  int v49; // [rsp+64h] [rbp-204h] BYREF
  int v50; // [rsp+68h] [rbp-200h] BYREF
  __int16 v51; // [rsp+6Ch] [rbp-1FCh] BYREF
  __int16 v52; // [rsp+6Eh] [rbp-1FAh]
  __int64 v53; // [rsp+70h] [rbp-1F8h]
  char *v54; // [rsp+78h] [rbp-1F0h]
  unsigned int v55; // [rsp+80h] [rbp-1E8h]
  int v56; // [rsp+84h] [rbp-1E4h] BYREF
  int v57; // [rsp+88h] [rbp-1E0h] BYREF
  int v58; // [rsp+8Ch] [rbp-1DCh] BYREF
  __int64 *v59; // [rsp+90h] [rbp-1D8h] BYREF
  int v60; // [rsp+98h] [rbp-1D0h]
  __int64 **v61; // [rsp+A0h] [rbp-1C8h]
  __int64 v62; // [rsp+A8h] [rbp-1C0h]
  __int64 v63; // [rsp+B0h] [rbp-1B8h]
  __int64 v64; // [rsp+B8h] [rbp-1B0h] BYREF
  __int64 v65; // [rsp+C0h] [rbp-1A8h]
  __int64 v66; // [rsp+C8h] [rbp-1A0h]
  __int64 v67; // [rsp+D0h] [rbp-198h]
  __int64 v68; // [rsp+D8h] [rbp-190h]
  __int64 v69; // [rsp+E0h] [rbp-188h]
  __int64 v70; // [rsp+E8h] [rbp-180h]
  int v71[2]; // [rsp+F0h] [rbp-178h] BYREF
  __int64 v72; // [rsp+F8h] [rbp-170h]
  __int64 v73; // [rsp+100h] [rbp-168h]
  void *v74; // [rsp+108h] [rbp-160h]
  void *v75; // [rsp+110h] [rbp-158h]
  void *v76; // [rsp+118h] [rbp-150h]
  void *v77; // [rsp+120h] [rbp-148h]
  void *v78; // [rsp+128h] [rbp-140h]
  char v79; // [rsp+130h] [rbp-138h] BYREF
  _BYTE v80[255]; // [rsp+131h] [rbp-137h] BYREF

  v47 = a2;
  v61 = a1;
  v46 = 0;
  v49 = 0;
  v63 = -1i64;
  v53 = -1i64;
  v54 = 0i64;
  v58 = 0;
  v50 = 0;
  v51 = 0;
  v52 = 0;
  v64 = 0i64;
  v65 = 0i64;
  v66 = 0i64;
  v67 = 0i64;
  v59 = 0i64;
  v79 = 0;
  memset(v80, 0, sizeof(v80));
  v55 = 0;
  do
  {
    do
    {
      v4 = _InterlockedIncrement(&dword_5A190);
      v60 = v4;
    }
    while ( v4 == 0x7FFFFFFF );
  }
  while ( !v4 );
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x20u, (__int64)&unk_57CF8);
    v5 = off_5A148;
  }
  if ( qword_5A678 )
  {
    if ( *a1 )
    {
      v7 = sub_35D44(a1, (__int64)a2, &v58, &v59);
      v9 = v7;
      v46 = v7;
      if ( v7 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x23u, (__int64)&unk_57CF8, v7);
        }
        result = v9;
      }
      else
      {
        v10 = v59;
        if ( v59 && v59[3] )
        {
          LOBYTE(v8) = 1;
          v11 = (*(__int64 (__fastcall **)(_QWORD, __int64))(qword_5A678 + 56))((unsigned int)(v58 + 29), v8);
          v12 = v11;
          v62 = v11;
          if ( v11 == -1 )
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
            {
              sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x25u, (__int64)&unk_57CF8);
            }
            v46 = 3;
            result = 3i64;
          }
          else
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              sub_34250(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x26u, (__int64)&unk_57CF8, v11, v4);
            }
            v14 = (*(__int64 (__fastcall **)(__int64, _QWORD))(qword_5A898 + 48))(v12, v4);
            v68 = v14;
            if ( v14 )
            {
              LOBYTE(v13) = 1;
              v15 = (*(__int64 (__fastcall **)(_QWORD, __int64))(qword_5A678 + 56))(*((unsigned int *)v10 + 11), v13);
              v16 = v15;
              v63 = v15;
              if ( v15 == -1 )
              {
                if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                  && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
                  && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
                {
                  sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x27u, (__int64)&unk_57CF8);
                }
                v17 = 3;
                v46 = 3;
                v18 = v53;
                v19 = v47;
              }
              else
              {
                if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                  && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
                  && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
                {
                  LODWORD(v43) = v4;
                  sub_34250(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x28u, (__int64)&unk_57CF8, v15, v43);
                }
                v20 = (char *)(*(__int64 (__fastcall **)(__int64, _QWORD))(qword_5A898 + 48))(v16, v4);
                v54 = v20;
                if ( v20 )
                {
                  memmove(v20, (const void *)v59[3], *((unsigned int *)v59 + 11));
                  *(_DWORD *)v14 = *((_DWORD *)v59 + 11);
                  *(_QWORD *)(v14 + 4) = v16;
                  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
                    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
                  {
                    sub_187E8(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x29u, (__int64)&unk_57CF8, v54);
                  }
                  LOBYTE(v21) = 1;
                  v22 = (*(__int64 (__fastcall **)(__int64, __int64))(qword_5A678 + 56))(1i64, v21);
                  v18 = v22;
                  v53 = v22;
                  if ( v22 == -1 )
                  {
                    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
                      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
                    {
                      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Bu, (__int64)&unk_57CF8);
                    }
                    v17 = 3;
                    v46 = 3;
                    v19 = v47;
                  }
                  else if ( (*(__int64 (__fastcall **)(__int64, _QWORD))(qword_5A898 + 48))(v22, v4) )
                  {
                    *(_DWORD *)(v14 + 12) = 1;
                    *(_QWORD *)(v14 + 16) = v18;
                    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x11u)
                      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
                    {
                      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Du, (__int64)&unk_57CF8, *v47);
                    }
                    v23 = v61;
                    v24 = (__int64)*v61;
                    v70 = (__int64)*v61;
                    v25 = v47;
                    while ( (_QWORD *)v24 != v25 + 7 && *(_QWORD *)(v24 + 32) == (*v23)[4] )
                    {
                      switch ( *(_DWORD *)(v24 + 40) )
                      {
                        case 2:
                          sub_3696C(2u, *(_DWORD *)(v24 + 44), (const void *)(v24 + 24), v14, &v50);
                          v25 = v47;
                          break;
                        case 3:
                          sub_3696C(0x102u, *(_DWORD *)(v24 + 44), *(const void **)(v24 + 24), v14, &v50);
                          if ( *(_DWORD *)(v24 + 44) )
                          {
                            v26 = *(const void **)(v24 + 24);
                            if ( v26 )
                            {
                              v55 = *(_DWORD *)(v24 + 44);
                              sub_53BD8(&v79, 0x100ui64, v26, v55);
                            }
                            v25 = v47;
                          }
                          else
                          {
                            v25 = v47;
                          }
                          break;
                        case 4:
                          sub_3696C(0x103u, *(_DWORD *)(v24 + 44), (const void *)(v24 + 24), v14, &v50);
                          v25 = v47;
                          break;
                        case 7:
                          sub_3696C(0x101u, *(_DWORD *)(v24 + 44), *(const void **)(v24 + 24), v14, &v50);
                          v25 = v47;
                          break;
                      }
                      v24 = *(_QWORD *)v24;
                      v70 = v24;
                      v23 = v61;
                    }
                    v51 = *((_WORD *)v25 + 138);
                    v52 = *((_WORD *)v25 + 139);
                    sub_3696C(3u, 4u, &v51, v14, &v50);
                    sub_3696C(6u, 4u, v47 + 4, v14, &v50);
                    v27 = (unsigned __int16 *)sub_3C4EC(1, 0x4Du, 0x746A624Fu);
                    v28 = v27;
                    if ( v27 )
                    {
                      sub_373D0((__int64)v47, (__int64)v27);
                      if ( (unsigned int)sub_4535C(0x201302Au) )
                      {
                        sub_39488((_BYTE *)v47 + 320, &v79, v55);
                      }
                      else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                             && _bittest(
                                  (const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1,
                                  0x19u)
                             && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
                      {
                        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Eu, (__int64)&unk_57CF8);
                      }
                      sub_3696C(4u, v28[21] + v28[20] + 45, v28, v14, &v50);
                      sub_3C570(v28, 0x746A624Fu);
                    }
                    sub_3696C(7u, 0, 0i64, v14, &v50);
                    LODWORD(v69) = 0;
                    v57 = 0;
                    v56 = 0;
                    v48[0] = 0;
                    v45[0] = 1;
                    v29 = v60;
                    HIDWORD(v67) = v60;
                    v64 = v62;
                    v65 = *(_QWORD *)(v14 + 4);
                    v66 = *(_QWORD *)(v14 + 16);
                    LODWORD(v67) = 1;
                    v30 = MEMORY[0xFFFFF78000000014];
                    v69 = MEMORY[0xFFFFF78000000014];
                    v14 = v68;
                    v31 = (_DWORD *)(v68 + 24);
                    sub_3756C((__int64)v47, (int *)(v68 + 24), v45, &v49, &v56, v48, &v57, 1);
                    if ( v45[0] )
                    {
                      if ( (unsigned int)sub_4535C(0x2013033u) == 1 )
                      {
                        v32 = v54;
                        if ( sub_38428((__int64)v54, *(_DWORD *)v14) )
                        {
                          v33 = off_5A148;
                          if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
                          {
                            v31 = (_DWORD *)(v14 + 24);
                          }
                          else if ( _bittest(
                                      (const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1,
                                      0xEu) )
                          {
                            if ( BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
                            {
                              sub_187E8(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x30u, (__int64)&unk_57CF8, v32);
                              v33 = off_5A148;
                            }
                            v31 = (_DWORD *)(v14 + 24);
                          }
                          else
                          {
                            v31 = (_DWORD *)(v14 + 24);
                          }
                        }
                        else
                        {
                          v34 = off_5A148;
                          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                            && _bittest(
                                 (const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1,
                                 0xEu)
                            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
                          {
                            sub_187E8(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x31u, (__int64)&unk_57CF8, v32);
                            v34 = off_5A148;
                          }
                          if ( v34 != (PDEVICE_OBJECT)&off_5A148
                            && _bittest((const signed __int32 *)&v34->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
                            && BYTE1(v34->DeviceLock.Header.WaitListHead.Blink) >= 4u )
                          {
                            sub_11088(*(_QWORD *)&v34->DeviceLock.Header.Lock, 0x32u, (__int64)&unk_57CF8);
                          }
                          v31 = (_DWORD *)(v14 + 24);
                          *(_DWORD *)(v14 + 24) |= 0x80u;
                          v33 = off_5A148;
                        }
                      }
                      else
                      {
                        v33 = off_5A148;
                      }
                      if ( v33 != (PDEVICE_OBJECT)&off_5A148
                        && _bittest((const signed __int32 *)&v33->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
                        && BYTE1(v33->DeviceLock.Header.WaitListHead.Blink) >= 4u )
                      {
                        sub_12D64(*(_QWORD *)&v33->DeviceLock.Header.Lock, 0x33u, (__int64)&unk_57CF8, *v47);
                      }
                      sub_37E18((__int64)(v47 + 40), v31);
                      v35 = sub_4535C(0x201301Bu);
                      v36 = sub_40A2C(40026, &v64, 0x20u, v35, &v49);
                      v46 = v36;
                      v71[0] = v36;
                      v71[1] = v49;
                      v72 = v30;
                      v73 = *v47;
                      v74 = &unk_5A82C;
                      v75 = &unk_5A840;
                      v76 = &unk_5A880;
                      v78 = &unk_5A860;
                      v77 = &unk_5A870;
                      sub_37FC0((__int64)v71);
                      v37 = (_BYTE *)(v14 + 24);
                      sub_3756C((__int64)v47, (int *)(v14 + 24), v45, &v49, &v56, v48, &v57, 0);
                    }
                    else
                    {
                      v36 = v46;
                      v37 = (_BYTE *)(v14 + 24);
                    }
                    if ( v36 )
                    {
                      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
                        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
                      {
                        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x36u, (__int64)&unk_57CF8, v36);
                      }
                      v17 = 11;
                      v46 = 11;
                      v18 = v53;
                      v19 = v47;
                    }
                    else
                    {
                      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
                        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
                      {
                        v38 = sub_4A760(v49);
                        LODWORD(v44) = v29;
                        sub_33DA4(
                          *(_QWORD *)(v39 + 280),
                          52i64,
                          (__int64)&unk_57CF8,
                          *v47,
                          v47[2],
                          v47[3],
                          v44,
                          v54,
                          v38);
                      }
                      v19 = v47;
                      *((_DWORD *)v47 + 78) = 2;
                      if ( (*v37 & 2) != 0 )
                        sub_523D8(0i64, *(_DWORD *)(v14 + 12));
                      v17 = sub_36A5C(v19, v49, v14, (__int64)v61);
                      v46 = v17;
                      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
                        || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) == 0
                        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
                      {
                        v18 = v53;
                      }
                      else
                      {
                        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x35u, (__int64)&unk_57CF8, v49);
                        v18 = v53;
                      }
                    }
                  }
                  else
                  {
                    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
                      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
                    {
                      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Cu, (__int64)&unk_57CF8);
                    }
                    v17 = 5;
                    v46 = 5;
                    v19 = v47;
                  }
                }
                else
                {
                  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
                    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
                  {
                    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Au, (__int64)&unk_57CF8);
                  }
                  v17 = 5;
                  v46 = 5;
                  v18 = v53;
                  v19 = v47;
                }
              }
            }
            else
            {
              if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
                && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
              {
                sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Fu, (__int64)&unk_57CF8);
              }
              v17 = 5;
              v46 = 5;
              v18 = v53;
              v19 = v47;
            }
            if ( sub_37138(v49, v14) )
            {
              v40 = off_5A148;
              if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
                && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
              {
                sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x37u, (__int64)&unk_57CF8);
                v40 = off_5A148;
              }
            }
            else if ( v18 == -1 )
            {
              v40 = off_5A148;
            }
            else
            {
              if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x11u)
                && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
              {
                sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x38u, (__int64)&unk_57CF8, *v19);
              }
              (*(void (__fastcall **)(__int64))(qword_5A678 + 104))(v18);
              (*(void (__fastcall **)(__int64))(qword_5A678 + 72))(v18);
              v40 = off_5A148;
            }
            v41 = v62;
            if ( v62 != -1 )
            {
              if ( v14 )
                (*(void (__fastcall **)(__int64))(qword_5A678 + 104))(v62);
              (*(void (__fastcall **)(__int64))(qword_5A678 + 72))(v41);
              v40 = off_5A148;
            }
            v42 = v63;
            if ( v63 != -1 )
            {
              if ( v54 )
                (*(void (__fastcall **)(__int64))(qword_5A678 + 104))(v63);
              (*(void (__fastcall **)(__int64))(qword_5A678 + 72))(v42);
              v40 = off_5A148;
            }
            if ( v40 != (PDEVICE_OBJECT)&off_5A148
              && (BYTE4(v40->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
              && BYTE1(v40->DeviceLock.Header.WaitListHead.Blink) >= 5u )
            {
              sub_11088(*(_QWORD *)&v40->DeviceLock.Header.Lock, 0x3Au, (__int64)&unk_57CF8);
            }
            result = v17;
          }
        }
        else
        {
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
          {
            sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x24u, (__int64)&unk_57CF8);
          }
          result = 6i64;
          v46 = 6;
        }
      }
    }
    else
    {
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x22u, (__int64)&unk_57CF8);
      }
      result = 6i64;
      v46 = 6;
    }
  }
  else
  {
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x21u, (__int64)&unk_57CF8);
    }
    result = 16i64;
    v46 = 16;
  }
  return result;
}
// 35069: conditional instruction was optimized away because of 'ebx.4==0'
// 34AF1: variable 'v8' is possibly undefined
// 34BB2: variable 'v13' is possibly undefined
// 34C44: variable 'v43' is possibly undefined
// 34CD8: variable 'v21' is possibly undefined
// 35404: variable 'v39' is possibly undefined
// 3540B: variable 'v44' is possibly undefined
// 5A190: using guessed type int dword_5A190;
// 5A678: using guessed type __int64 qword_5A678;
// 5A898: using guessed type __int64 qword_5A898;

//----- (00000000000357AC) ----------------------------------------------------
__int64 __fastcall sub_357AC(__int64 **a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  int v6; // eax
  __int64 v7; // rdx
  unsigned int v8; // ebx
  __int64 v9; // rax
  __int64 v10; // r13
  unsigned __int32 v11; // edi
  __int64 v12; // rsi
  __int64 *i; // rbx
  const void *v14; // r8
  unsigned int v15; // ecx
  __int64 v16; // rax
  int v17; // eax
  int v18; // eax
  __int64 v19; // rcx
  int v20; // [rsp+40h] [rbp-98h] BYREF
  int v21; // [rsp+44h] [rbp-94h] BYREF
  __int64 v22; // [rsp+48h] [rbp-90h] BYREF
  __int64 v23; // [rsp+50h] [rbp-88h]
  __int64 v24; // [rsp+58h] [rbp-80h]
  __int64 v25; // [rsp+60h] [rbp-78h]
  __int64 v26; // [rsp+68h] [rbp-70h]
  int v27[2]; // [rsp+70h] [rbp-68h] BYREF
  __int64 v28; // [rsp+78h] [rbp-60h]
  __int64 v29; // [rsp+80h] [rbp-58h]
  void *v30; // [rsp+88h] [rbp-50h]
  __int64 v31; // [rsp+90h] [rbp-48h]
  __int64 v32; // [rsp+98h] [rbp-40h]
  __int64 v33; // [rsp+A0h] [rbp-38h]
  __int64 v34; // [rsp+A8h] [rbp-30h]
  int v35; // [rsp+F0h] [rbp+18h] BYREF
  __int16 v36; // [rsp+F8h] [rbp+20h] BYREF
  __int16 v37; // [rsp+FAh] [rbp+22h]

  v23 = 0i64;
  v22 = 0i64;
  v24 = 0i64;
  v25 = 0i64;
  v20 = 0;
  v21 = 0;
  v35 = 0;
  v36 = 0;
  v37 = 0;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Bu, (__int64)&unk_57CF8);
    v4 = off_5A148;
  }
  if ( !qword_5A678 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x3Cu, (__int64)&unk_57CF8);
    }
    return 16i64;
  }
  if ( !*a1 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x3Du, (__int64)&unk_57CF8);
    }
    return 6i64;
  }
  v6 = sub_35E4C(a1, a2, &v21);
  v8 = v6;
  if ( v6 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Eu, (__int64)&unk_57CF8, v6);
    }
    return v8;
  }
  LOBYTE(v7) = 1;
  v9 = (*(__int64 (__fastcall **)(_QWORD, __int64))(qword_5A678 + 56))((unsigned int)(v21 + 29), v7);
  v10 = v9;
  if ( v9 != -1 )
  {
    do
    {
      do
        v11 = _InterlockedIncrement(&dword_5A190);
      while ( v11 == 0x7FFFFFFF );
    }
    while ( !v11 );
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_34250(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x40u, (__int64)&unk_57CF8, v9, v11);
    }
    v12 = (*(__int64 (__fastcall **)(__int64, _QWORD))(qword_5A898 + 48))(v10, v11);
    if ( !v12 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x42u, (__int64)&unk_57CF8);
      }
      v8 = 5;
LABEL_70:
      if ( v12 )
        (*(void (__fastcall **)(__int64))(qword_5A678 + 104))(v10);
      (*(void (__fastcall **)(__int64))(qword_5A678 + 72))(v10);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x46u, (__int64)&unk_57CF8);
      }
      return v8;
    }
    *(_QWORD *)v12 = 0i64;
    *(_QWORD *)(v12 + 8) = 0i64;
    *(_QWORD *)(v12 + 16) = 0i64;
    *(_DWORD *)(v12 + 24) = 0;
    *(_BYTE *)(v12 + 28) = 0;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x41u, (__int64)&unk_57CF8);
    }
    for ( i = *a1; ; i = (__int64 *)*i )
    {
      if ( i == (__int64 *)(a2 + 56) || i[4] != (*a1)[4] )
      {
        v36 = *(_WORD *)(a2 + 276);
        v37 = *(_WORD *)(a2 + 278);
        sub_3696C(3u, 4u, &v36, v12, &v35);
        sub_3696C(7u, 0, 0i64, v12, &v35);
        HIDWORD(v25) = v11;
        v22 = v10;
        v23 = *(_QWORD *)(v12 + 4);
        v16 = *(_QWORD *)(v12 + 16);
        LODWORD(v25) = 6;
        v24 = v16;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x43u, (__int64)&unk_57CF8, *(_QWORD *)a2);
        }
        v26 = MEMORY[0xFFFFF78000000014];
        v17 = sub_4535C(0x201301Bu);
        v18 = sub_40A2C(40026, &v22, 0x20u, v17, &v20);
        v27[1] = v20;
        v8 = v18;
        v28 = v26;
        v19 = *(_QWORD *)a2;
        v27[0] = v18;
        v29 = v19;
        v31 = 0i64;
        v32 = 0i64;
        v34 = 0i64;
        v30 = &unk_5A834;
        v33 = 0i64;
        sub_37FC0((__int64)v27);
        if ( v8 )
        {
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
          {
            sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x45u, (__int64)&unk_57CF8, v8);
          }
          v8 = 11;
        }
        else
        {
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_33D34(
              *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
              68i64,
              (__int64)&unk_57CF8,
              *(_QWORD *)a2,
              *(_QWORD *)(a2 + 16),
              *(_QWORD *)(a2 + 24),
              v20);
          }
          *(_DWORD *)(a2 + 312) = 2;
        }
        goto LABEL_70;
      }
      switch ( *((_DWORD *)i + 10) )
      {
        case 2:
          v14 = i + 3;
          v15 = 2;
          break;
        case 5:
          v14 = (const void *)i[3];
          v15 = 260;
          break;
        case 0xE:
          v14 = (const void *)i[3];
          v15 = 261;
          break;
        default:
          continue;
      }
      sub_3696C(v15, *((_DWORD *)i + 11), v14, v12, &v35);
    }
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Fu, (__int64)&unk_57CF8);
  }
  return 3i64;
}
// 35922: variable 'v7' is possibly undefined
// 5A190: using guessed type int dword_5A190;
// 5A678: using guessed type __int64 qword_5A678;
// 5A898: using guessed type __int64 qword_5A898;

//----- (0000000000035D44) ----------------------------------------------------
__int64 __fastcall sub_35D44(__int64 **a1, __int64 a2, _DWORD *a3, __int64 **a4)
{
  __int64 *i; // rdx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x47u, (__int64)&unk_57CF8);
  }
  *a3 = 0;
  *a4 = 0i64;
  for ( i = *a1; i != (__int64 *)(a2 + 56) && i[4] == (*a1)[4]; i = (__int64 *)*i )
  {
    if ( *((int *)i + 10) >= 2 )
    {
      if ( *((int *)i + 10) <= 4 )
      {
        *a3 += *((_DWORD *)i + 11) + 8;
      }
      else if ( *((_DWORD *)i + 10) == 5 )
      {
        *a4 = i;
      }
    }
  }
  *a3 += 145;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x48u, (__int64)&unk_57CF8);
  }
  return 0i64;
}

//----- (0000000000035E4C) ----------------------------------------------------
__int64 __fastcall sub_35E4C(__int64 **a1, __int64 a2, _DWORD *a3)
{
  PDEVICE_OBJECT v6; // rcx
  __int64 *v7; // rdx
  __int64 v8; // r8

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x49u, (__int64)&unk_57CF8);
    v6 = off_5A148;
  }
  v7 = *a1;
  *a3 = 0;
  if ( v7 != (__int64 *)(a2 + 56) )
  {
    v8 = v7[4];
    do
    {
      if ( v7[4] != v8 )
        break;
      if ( *((_DWORD *)v7 + 10) == 2 || *((_DWORD *)v7 + 10) == 5 || *((_DWORD *)v7 + 10) == 14 )
        *a3 += *((_DWORD *)v7 + 11) + 8;
      v7 = (__int64 *)*v7;
    }
    while ( v7 != (__int64 *)(a2 + 56) );
  }
  *a3 += 20;
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x4Au, (__int64)&unk_57CF8);
  }
  return 0i64;
}

//----- (0000000000035F38) ----------------------------------------------------
__int64 __fastcall sub_35F38(__int64 a1, _QWORD *a2)
{
  __int64 v3; // r15
  __int64 v4; // r14
  __int64 v6; // r12
  PDEVICE_OBJECT v7; // rcx
  unsigned int v8; // ebx
  unsigned __int16 v9; // dx
  __int64 v10; // rax
  __int64 v11; // rax
  int v12; // eax
  __int64 v13; // rdx
  __int64 v14; // rax
  unsigned __int32 v15; // edi
  _DWORD *v16; // rdx
  unsigned int v17; // ebx
  __int64 v18; // rax
  __int64 v19; // r13
  char *v20; // r13
  __int64 v21; // rdx
  __int64 v22; // rax
  __int64 *i; // rbx
  const void *v24; // r8
  unsigned int v25; // ecx
  __int64 v26; // rax
  __int64 v27; // rbx
  int v28; // edi
  __int64 v29; // rax
  int v30; // edx
  PDEVICE_OBJECT v31; // rcx
  __int64 v33; // [rsp+30h] [rbp-C8h]
  __int16 v34; // [rsp+38h] [rbp-C0h] BYREF
  __int16 v35; // [rsp+3Ah] [rbp-BEh]
  int v36; // [rsp+3Ch] [rbp-BCh] BYREF
  char *v37; // [rsp+40h] [rbp-B8h]
  __int64 v38; // [rsp+48h] [rbp-B0h] BYREF
  __int64 v39; // [rsp+50h] [rbp-A8h]
  __int64 v40; // [rsp+58h] [rbp-A0h]
  __int64 v41; // [rsp+60h] [rbp-98h]
  int v42[2]; // [rsp+70h] [rbp-88h] BYREF
  __int64 v43; // [rsp+78h] [rbp-80h]
  __int64 v44; // [rsp+80h] [rbp-78h]
  int *v45; // [rsp+88h] [rbp-70h]
  void *v46; // [rsp+90h] [rbp-68h]
  void *v47; // [rsp+98h] [rbp-60h]
  void *v48; // [rsp+A0h] [rbp-58h]
  void *v49; // [rsp+A8h] [rbp-50h]
  __int64 v50; // [rsp+B0h] [rbp-48h]
  int v51; // [rsp+110h] [rbp+18h] BYREF
  int v52; // [rsp+118h] [rbp+20h] BYREF

  v3 = -1i64;
  v4 = -1i64;
  v33 = -1i64;
  v52 = 0;
  v6 = 0i64;
  v37 = 0i64;
  v36 = 0;
  v39 = 0i64;
  v40 = 0i64;
  v41 = 0i64;
  v35 = 0;
  v51 = 0;
  v38 = 0i64;
  v34 = 0;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Bu, (__int64)&unk_57CF8);
    v7 = off_5A148;
  }
  if ( !qword_5A678 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x4Cu, (__int64)&unk_57CF8);
    }
    v8 = 16;
    goto LABEL_109;
  }
  if ( !*(_QWORD *)a1 )
  {
    if ( v7 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x40) == 0
      || BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_108;
    }
    v9 = 77;
LABEL_107:
    sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, v9, (__int64)&unk_57CF8);
LABEL_108:
    v8 = 6;
LABEL_109:
    v19 = -1i64;
    goto LABEL_110;
  }
  v10 = *(_QWORD *)(a1 + 16);
  if ( !v10 || !*(_QWORD *)(v10 + 24) || (v11 = *(_QWORD *)(a1 + 24)) == 0 || !*(_QWORD *)(v11 + 24) )
  {
    if ( v7 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v7->DeviceLock.Header.WaitListHead.Blink) & 0x40) == 0
      || BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_108;
    }
    v9 = 78;
    goto LABEL_107;
  }
  v12 = sub_36880((__int64 **)a1, (__int64)a2, &v36);
  v8 = v12;
  if ( v12 )
  {
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_46;
    }
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Fu, (__int64)&unk_57CF8, v12);
    goto LABEL_109;
  }
  LOBYTE(v13) = 1;
  v14 = (*(__int64 (__fastcall **)(_QWORD, __int64))(qword_5A678 + 56))((unsigned int)(v36 + 29), v13);
  v3 = v14;
  if ( v14 == -1 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x50u, (__int64)&unk_57CF8);
    }
    v8 = 3;
    goto LABEL_109;
  }
  do
  {
    do
      v15 = _InterlockedIncrement(&dword_5A190);
    while ( v15 == 0x7FFFFFFF );
  }
  while ( !v15 );
  v6 = (*(__int64 (__fastcall **)(__int64, _QWORD))(qword_5A898 + 48))(v14, v15);
  if ( !v6 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x56u, (__int64)&unk_57CF8);
    }
    v8 = 5;
    goto LABEL_109;
  }
  v16 = *(_DWORD **)(*(_QWORD *)(a1 + 16) + 24i64);
  v17 = **(_DWORD **)(*(_QWORD *)(a1 + 24) + 24i64) - *v16;
  if ( v17 > *((_DWORD *)a2 + 67) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x51u, (__int64)&unk_57CF8);
    }
    v8 = 18;
    goto LABEL_109;
  }
  LOBYTE(v16) = 1;
  v18 = (*(__int64 (__fastcall **)(_QWORD, _DWORD *))(qword_5A678 + 56))(v17, v16);
  v4 = v18;
  if ( v18 == -1 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x52u, (__int64)&unk_57CF8);
    }
    v8 = 3;
    goto LABEL_46;
  }
  v20 = (char *)(*(__int64 (__fastcall **)(__int64, _QWORD))(qword_5A898 + 48))(v18, v15);
  v37 = v20;
  if ( !v20 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x54u, (__int64)&unk_57CF8);
    }
    v8 = 5;
LABEL_46:
    v19 = v33;
    goto LABEL_110;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_187E8(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x53u, (__int64)&unk_57CF8, v20);
  }
  memmove(v20, (const void *)(a2[31] + **(unsigned int **)(*(_QWORD *)(a1 + 16) + 24i64)), v17);
  *(_DWORD *)v6 = v17;
  *(_QWORD *)(v6 + 4) = v4;
  LOBYTE(v21) = 1;
  v22 = (*(__int64 (__fastcall **)(__int64, __int64))(qword_5A678 + 56))(1i64, v21);
  v19 = v22;
  v33 = v22;
  if ( v22 == -1 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x55u, (__int64)&unk_57CF8);
    }
    v8 = 3;
    goto LABEL_110;
  }
  *(_DWORD *)(v6 + 12) = 1;
  *(_QWORD *)(v6 + 16) = v22;
  for ( i = *(__int64 **)a1; i != a2 + 7 && i[4] == *(_QWORD *)(*(_QWORD *)a1 + 32i64); i = (__int64 *)*i )
  {
    switch ( *((_DWORD *)i + 10) )
    {
      case 2:
        v24 = i + 3;
        v25 = 2;
        break;
      case 0xA:
        v24 = (const void *)i[3];
        v25 = 513;
        break;
      case 0xB:
        v24 = (const void *)i[3];
        v25 = 514;
        break;
      case 0xC:
        v24 = (const void *)i[3];
        v25 = 515;
        break;
      default:
        continue;
    }
    sub_3696C(v25, *((_DWORD *)i + 11), v24, v6, &v51);
  }
  v34 = *((_WORD *)a2 + 138);
  v35 = *((_WORD *)a2 + 139);
  sub_3696C(3u, 4u, &v34, v6, &v51);
  sub_3696C(6u, 4u, a2 + 4, v6, &v51);
  sub_3696C(7u, 0, 0i64, v6, &v51);
  HIDWORD(v41) = v15;
  v38 = v3;
  v39 = *(_QWORD *)(v6 + 4);
  v26 = *(_QWORD *)(v6 + 16);
  LODWORD(v41) = 2;
  v40 = v26;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x57u, (__int64)&unk_57CF8, *a2);
  }
  v27 = MEMORY[0xFFFFF78000000014];
  v50 = MEMORY[0xFFFFF78000000014];
  v28 = sub_40A2C(40026, &v38, 0x20u, 15000, &v52);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x58u, (__int64)&unk_57CF8, *a2);
  }
  v42[0] = v28;
  v42[1] = v52;
  v29 = *a2;
  v43 = v27;
  v44 = v29;
  v45 = &dword_5A83C;
  v46 = &unk_5A84C;
  v47 = &unk_5A88C;
  v49 = &unk_5A86C;
  v48 = &unk_5A87C;
  sub_37FC0((__int64)v42);
  if ( !v28 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x59u, (__int64)&unk_57CF8, v52);
    }
    _InterlockedAdd(&dword_5A83C, 1u);
    _InterlockedAdd(&dword_5A828, 1u);
    v30 = v52;
    *((_DWORD *)a2 + 78) = 1;
    v8 = sub_36A5C(a2, v30, v6, a1);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Au, (__int64)&unk_57CF8, v52);
    }
    goto LABEL_46;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Bu, (__int64)&unk_57CF8, v28);
  }
  v19 = v33;
  v8 = 11;
LABEL_110:
  if ( sub_37138(v52, v6) )
  {
    v31 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Cu, (__int64)&unk_57CF8);
      goto LABEL_117;
    }
  }
  else
  {
    if ( v19 != -1 )
      (*(void (__fastcall **)(__int64))(qword_5A678 + 72))(v19);
LABEL_117:
    v31 = off_5A148;
  }
  if ( v3 != -1 )
  {
    if ( v6 )
      (*(void (__fastcall **)(__int64))(qword_5A678 + 104))(v3);
    (*(void (__fastcall **)(__int64))(qword_5A678 + 72))(v3);
    v31 = off_5A148;
  }
  if ( v4 != -1 )
  {
    if ( v37 )
      (*(void (__fastcall **)(__int64))(qword_5A678 + 104))(v4);
    (*(void (__fastcall **)(__int64))(qword_5A678 + 72))(v4);
    v31 = off_5A148;
  }
  if ( v31 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v31->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(v31->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v31->DeviceLock.Header.Lock, 0x5Du, (__int64)&unk_57CF8);
  }
  return v8;
}
// 360F4: variable 'v13' is possibly undefined
// 362CD: variable 'v21' is possibly undefined
// 5A190: using guessed type int dword_5A190;
// 5A678: using guessed type __int64 qword_5A678;
// 5A828: using guessed type int dword_5A828;
// 5A83C: using guessed type int dword_5A83C;
// 5A898: using guessed type __int64 qword_5A898;

//----- (0000000000036880) ----------------------------------------------------
__int64 __fastcall sub_36880(__int64 **a1, __int64 a2, _DWORD *a3)
{
  PDEVICE_OBJECT v6; // rcx
  __int64 *v7; // rdx
  __int64 *v8; // rdi
  __int64 v9; // r8
  int v10; // eax

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x5Eu, (__int64)&unk_57CF8);
    v6 = off_5A148;
  }
  v7 = *a1;
  *a3 = 0;
  v8 = (__int64 *)(a2 + 56);
  if ( v7 != v8 )
  {
    v9 = v7[4];
    do
    {
      if ( v7[4] != v9 )
        break;
      v10 = *((_DWORD *)v7 + 10);
      if ( v10 == 2 || (unsigned int)(v10 - 10) <= 2 )
        *a3 += *((_DWORD *)v7 + 11) + 8;
      v7 = (__int64 *)*v7;
    }
    while ( v7 != v8 );
  }
  *a3 += 32;
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x5Fu, (__int64)&unk_57CF8);
  }
  return 0i64;
}

//----- (000000000003696C) ----------------------------------------------------
__int64 __fastcall sub_3696C(unsigned int a1, unsigned int a2, const void *a3, __int64 a4, _DWORD *a5)
{
  size_t v7; // rsi
  __int64 v9; // rbx
  __int64 v10; // rbx

  v7 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x60u, (__int64)&unk_57CF8);
  }
  v9 = (unsigned int)*a5;
  *(_QWORD *)(v9 + a4 + 28) = __PAIR64__(v7, a1);
  v10 = (unsigned int)(v9 + 8);
  if ( a3 )
    memmove((void *)(v10 + a4 + 28), a3, v7);
  *a5 = v10 + v7;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x61u, (__int64)&unk_57CF8);
  }
  return 0i64;
}

//----- (0000000000036A5C) ----------------------------------------------------
__int64 __fastcall sub_36A5C(_QWORD *a1, int a2, __int64 a3, __int64 a4)
{
  unsigned int v8; // edi
  PDEVICE_OBJECT v9; // rcx
  unsigned int v11; // edi
  unsigned __int16 v12; // dx
  unsigned int v13; // eax

  v8 = 0;
  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x62u, (__int64)&unk_57CF8);
    v9 = off_5A148;
  }
  if ( !a3 )
  {
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x63u, (__int64)&unk_57CF8);
    }
    return 4i64;
  }
  if ( a2 == 4 || a2 == 2 )
  {
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x64u, (__int64)&unk_57CF8, a2);
      v9 = off_5A148;
    }
    if ( (*(_BYTE *)(a3 + 24) & 2) != 0 )
    {
      if ( v9 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
        && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x65u, (__int64)&unk_57CF8);
        v9 = off_5A148;
      }
      v11 = 3;
    }
    else if ( (*(_BYTE *)(a3 + 24) & 1) != 0 )
    {
      if ( v9 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
        && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x66u, (__int64)&unk_57CF8);
        v9 = off_5A148;
      }
      LOBYTE(v8) = *((_DWORD *)a1 + 71) == 2;
      v11 = v8 + 1;
    }
    else
    {
      if ( v9 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
        && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x67u, (__int64)&unk_57CF8);
        v9 = off_5A148;
      }
      v11 = 1;
    }
    if ( *((_DWORD *)a1 + 71) != 3 )
    {
      *((_DWORD *)a1 + 71) = v11;
      v9 = off_5A148;
    }
    switch ( v11 )
    {
      case 3u:
        if ( v9 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
          && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EE0(
            *(_QWORD *)&v9->DeviceLock.Header.Lock,
            0x68u,
            (__int64)&unk_57CF8,
            *a1,
            *(_QWORD *)(*(_QWORD *)(a4 + 8) + 32i64));
        }
        sub_36FA0(a1, a3, 3, *(_QWORD *)(*(_QWORD *)(a4 + 8) + 32i64));
        goto LABEL_66;
      case 1u:
        if ( v9 == (PDEVICE_OBJECT)&off_5A148 )
          goto LABEL_61;
        if ( (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
          && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EE0(
            *(_QWORD *)&v9->DeviceLock.Header.Lock,
            0x69u,
            (__int64)&unk_57CF8,
            *a1,
            *(_QWORD *)(*(_QWORD *)(a4 + 8) + 32i64));
          v9 = off_5A148;
        }
        if ( v9 == (PDEVICE_OBJECT)&off_5A148
          || (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x40) == 0
          || BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) < 4u )
        {
          goto LABEL_61;
        }
        v12 = 106;
        break;
      case 2u:
        if ( v9 == (PDEVICE_OBJECT)&off_5A148 )
          goto LABEL_61;
        if ( (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
          && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EE0(
            *(_QWORD *)&v9->DeviceLock.Header.Lock,
            0x6Bu,
            (__int64)&unk_57CF8,
            *a1,
            *(_QWORD *)(*(_QWORD *)(a4 + 8) + 32i64));
          v9 = off_5A148;
        }
        if ( v9 == (PDEVICE_OBJECT)&off_5A148
          || (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x40) == 0
          || BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) < 4u )
        {
          goto LABEL_61;
        }
        v12 = 108;
        break;
      default:
        if ( v9 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
          && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_13EE0(
            *(_QWORD *)&v9->DeviceLock.Header.Lock,
            0x6Du,
            (__int64)&unk_57CF8,
            *a1,
            *(_QWORD *)(*(_QWORD *)(a4 + 8) + 32i64));
        }
        goto LABEL_66;
    }
    sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, v12, (__int64)&unk_57CF8);
LABEL_61:
    *((_BYTE *)a1 + 289) = 1;
LABEL_66:
    v13 = sub_36E40((__int64)a1, v11, *(_QWORD *)(*(_QWORD *)(a4 + 8) + 32i64));
    v9 = off_5A148;
    v8 = v13;
  }
  if ( v9 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x6Eu, (__int64)&unk_57CF8);
  }
  return v8;
}

//----- (0000000000036E40) ----------------------------------------------------
__int64 __fastcall sub_36E40(__int64 a1, unsigned int a2, __int64 a3)
{
  __int64 v6; // rax
  int v7; // er8
  int v8; // eax
  unsigned int v9; // ebx
  PDEVICE_OBJECT v10; // rcx
  __int64 *v12; // [rsp+20h] [rbp-48h] BYREF
  __int64 v13; // [rsp+28h] [rbp-40h]
  __int64 v14; // [rsp+30h] [rbp-38h]
  __int64 v15; // [rsp+38h] [rbp-30h] BYREF
  __int64 v16[4]; // [rsp+40h] [rbp-28h] BYREF

  v15 = 0i64;
  v13 = 0i64;
  v14 = 0i64;
  memset(v16, 0, sizeof(v16));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x6Fu, (__int64)&unk_57CF8);
  }
  v6 = *(_QWORD *)a1;
  v7 = *(_DWORD *)(a1 + 32);
  v14 = 0i64;
  v15 = v6;
  v16[0] = *(_QWORD *)(a1 + 16);
  v16[1] = *(_QWORD *)(a1 + 24);
  v16[2] = __PAIR64__(a2, v7);
  v16[3] = a3;
  LODWORD(v13) = 40;
  v12 = &v15;
  v8 = sub_17324(260, (__int64)&v12, v7);
  v9 = v8;
  if ( !v8 )
    goto LABEL_10;
  v10 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v9;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x70u, (__int64)&unk_57CF8, v8);
LABEL_10:
    v10 = off_5A148;
  }
  if ( v10 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v10->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(v10->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v10->DeviceLock.Header.Lock, 0x71u, (__int64)&unk_57CF8);
  }
  return v9;
}

//----- (0000000000036FA0) ----------------------------------------------------
__int64 __fastcall sub_36FA0(__int64 *a1, __int64 a2, int a3, __int64 a4)
{
  __int64 v8; // rax
  int v9; // eax
  unsigned int v10; // ebx
  PDEVICE_OBJECT v11; // rcx
  __int64 *v13; // [rsp+20h] [rbp-48h] BYREF
  __int64 v14; // [rsp+28h] [rbp-40h]
  __int64 v15; // [rsp+30h] [rbp-38h]
  __int64 v16; // [rsp+38h] [rbp-30h] BYREF
  __int64 v17[4]; // [rsp+40h] [rbp-28h] BYREF

  v16 = 0i64;
  v14 = 0i64;
  v15 = 0i64;
  memset(v17, 0, sizeof(v17));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x72u, (__int64)&unk_57CF8);
  }
  v16 = *a1;
  v8 = *(_QWORD *)(a2 + 16);
  v17[0] = a4;
  v17[2] = v8;
  LODWORD(v8) = *(_DWORD *)(a2 + 12);
  LODWORD(v17[1]) = a3;
  LODWORD(v17[3]) = v8;
  LODWORD(v14) = 40;
  v13 = &v16;
  v9 = sub_28AF8(780i64, &v13);
  v10 = v9;
  if ( !v9 )
  {
    v11 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v10;
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_15;
    }
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x74u, (__int64)&unk_57CF8);
    goto LABEL_14;
  }
  v11 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v10;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x73u, (__int64)&unk_57CF8, v9);
LABEL_14:
    v11 = off_5A148;
  }
LABEL_15:
  if ( v11 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v11->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x75u, (__int64)&unk_57CF8);
  }
  return v10;
}
// 28AF8: using guessed type __int64 __fastcall sub_28AF8(_QWORD, _QWORD);

//----- (0000000000037138) ----------------------------------------------------
bool __fastcall sub_37138(int a1, __int64 a2)
{
  bool v4; // bl
  PDEVICE_OBJECT v5; // rcx
  bool result; // al

  v4 = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x76u, (__int64)&unk_57CF8);
    v5 = off_5A148;
  }
  if ( a2 )
  {
    if ( a1 == 4 || a1 == 2 )
      v4 = (*(_BYTE *)(a2 + 24) & 2) != 0;
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x78u, (__int64)&unk_57CF8);
    }
    result = v4;
  }
  else
  {
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x77u, (__int64)&unk_57CF8);
    }
    result = 0;
  }
  return result;
}

//----- (0000000000037238) ----------------------------------------------------
__int64 __fastcall sub_37238(__int64 a1, char a2, char *a3, int *a4, int *a5)
{
  __int64 v6; // rbx
  PDEVICE_OBJECT v9; // rcx
  __int64 result; // rax
  unsigned int v11; // ebx
  __int64 v12; // [rsp+20h] [rbp-48h] BYREF
  int v13; // [rsp+28h] [rbp-40h]
  char v14; // [rsp+2Ch] [rbp-3Ch]
  int v15; // [rsp+30h] [rbp-38h]
  char v16; // [rsp+34h] [rbp-34h]
  __int64 *v17; // [rsp+38h] [rbp-30h] BYREF
  __int64 v18; // [rsp+40h] [rbp-28h]
  __int64 v19; // [rsp+48h] [rbp-20h]
  __int64 v20; // [rsp+70h] [rbp+8h]

  v20 = a1;
  v17 = 0i64;
  LODWORD(v12) = 0;
  v6 = a1;
  v18 = 0i64;
  v19 = 0i64;
  memset((char *)&v12 + 4, 0, 0x14ui64);
  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x79u, (__int64)&unk_57CF8);
    v6 = v20;
    v9 = off_5A148;
  }
  if ( v6 )
  {
    v12 = v6;
    v16 = a2;
    if ( a2 )
    {
      v14 = *a3;
      v15 = *a5;
      v13 = *a4;
    }
    v17 = &v12;
    LODWORD(v18) = 24;
    v11 = sub_1F7D8(519, (__int64 *)&v17);
    if ( !v11 && !a2 )
    {
      *a3 = v14;
      *a4 = v13;
      *a5 = v15;
    }
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x7Bu, (__int64)&unk_57CF8);
    }
    result = v11;
  }
  else
  {
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v9->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x7Au, (__int64)&unk_57CF8);
    }
    result = 4i64;
  }
  return result;
}

//----- (00000000000373D0) ----------------------------------------------------
__int64 __fastcall sub_373D0(__int64 a1, __int64 a2)
{
  int v4; // er9
  __int16 v5; // ax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x7Cu, (__int64)&unk_57CF8);
  }
  *(_QWORD *)a2 = MEMORY[0xFFFFF78000000014];
  *(_QWORD *)(a2 + 8) = *(_QWORD *)(a1 + 16);
  *(_QWORD *)(a2 + 16) = *(_QWORD *)(a1 + 24);
  *(_WORD *)(a2 + 36) = *(_WORD *)(a1 + 332);
  *(_WORD *)(a2 + 38) = *(_WORD *)(a1 + 334);
  *(_DWORD *)(a2 + 24) = *(_DWORD *)(a1 + 336);
  *(_WORD *)(a2 + 28) = *(_WORD *)(a1 + 340);
  *(_DWORD *)(a2 + 30) = *(_DWORD *)(a1 + 342);
  *(_WORD *)(a2 + 34) = *(_WORD *)(a1 + 346);
  v4 = *(_DWORD *)(a1 + 328);
  if ( v4 == 2048 )
  {
    v5 = 4;
LABEL_9:
    *(_WORD *)(a2 + 40) = v5;
    *(_WORD *)(a2 + 42) = v5;
    goto LABEL_14;
  }
  if ( v4 == 34525 )
  {
    v5 = 16;
    goto LABEL_9;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x7Du, (__int64)&unk_57CF8, v4);
  }
LABEL_14:
  memmove((void *)(a2 + 44), (const void *)(a1 + 348), *(unsigned __int16 *)(a2 + 40));
  memmove((void *)(a2 + 44 + *(unsigned __int16 *)(a2 + 40)), (const void *)(a1 + 364), *(unsigned __int16 *)(a2 + 42));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x7Eu, (__int64)&unk_57CF8);
  }
  return 0i64;
}

//----- (000000000003756C) ----------------------------------------------------
__int64 __fastcall sub_3756C(__int64 a1, int *a2, _BYTE *a3, int *a4, int *a5, char *a6, int *a7, char a8)
{
  unsigned int v11; // edi
  PDEVICE_OBJECT v12; // rcx
  PDEVICE_OBJECT v13; // rcx
  unsigned int v14; // er12
  int *v15; // r13
  char *v16; // rsi
  int *v17; // r14
  int v18; // eax
  unsigned __int16 v19; // dx
  int v20; // eax
  int *v21; // r10
  unsigned __int8 v22; // cf
  int v23; // eax
  int *v24; // rdi
  char *v25; // r14
  int *v26; // rbp
  int v27; // eax
  int *v28; // r12
  int v29; // eax
  int v30; // eax
  __int64 v32; // [rsp+20h] [rbp-58h]
  unsigned int v33; // [rsp+80h] [rbp+8h] BYREF
  int *v34; // [rsp+88h] [rbp+10h]
  int *v35; // [rsp+98h] [rbp+20h]

  v35 = a4;
  v34 = a2;
  v33 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x81u, (__int64)&unk_57CF8);
  }
  *a3 = 1;
  if ( !a1 || !a2 )
  {
    v12 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EE0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x82u, (__int64)&unk_57CF8, a1, a2);
      v12 = off_5A148;
    }
    v11 = 4;
    goto LABEL_122;
  }
  v11 = sub_178F0(*(_DWORD *)(a1 + 32), (int *)&v33);
  if ( v11 )
  {
    v12 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v11;
    if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_122;
    }
    sub_184C0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x83u, (__int64)&unk_57CF8, *(_DWORD *)(a1 + 32));
    goto LABEL_12;
  }
  v13 = off_5A148;
  v14 = v33;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_33EAC(
      *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
      132i64,
      (__int64)&unk_57CF8,
      *(_QWORD *)(a1 + 16),
      (unsigned __int16)v33,
      (v33 >> 30) & 1,
      (v33 >> 29) & 1);
    v13 = off_5A148;
  }
  if ( !a8 )
  {
    v24 = a7;
    v25 = a6;
    if ( v13 == (PDEVICE_OBJECT)&off_5A148 )
      goto LABEL_78;
    if ( _bittest((const signed __int32 *)&v13->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
      && BYTE1(v13->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_33F1C(*(_QWORD *)&v13->DeviceLock.Header.Lock, 0x8Eu, (__int64)&unk_57CF8, (unsigned __int8)*a3);
      v13 = off_5A148;
    }
    if ( v13 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v13->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u) )
    {
LABEL_78:
      v26 = a5;
    }
    else
    {
      v26 = a5;
      if ( BYTE1(v13->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_33F1C(*(_QWORD *)&v13->DeviceLock.Header.Lock, 0x8Fu, (__int64)&unk_57CF8, (unsigned __int8)*v25);
        v13 = off_5A148;
      }
    }
    if ( !(_WORD)v14 )
    {
      if ( v13 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v13->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
        && BYTE1(v13->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&v13->DeviceLock.Header.Lock, 0x90u, (__int64)&unk_57CF8, *(_QWORD *)(a1 + 16));
        v13 = off_5A148;
      }
      if ( _bittest((const int *)&v14, 0x1Du) && *v25 )
      {
        v27 = (unsigned __int16)*v24;
        if ( v27 != 2 && v27 != 4 || !_bittest((const int *)&v14, 0x1Eu) )
        {
          if ( v13 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&v13->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
            && BYTE1(v13->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_11088(*(_QWORD *)&v13->DeviceLock.Header.Lock, 0x92u, (__int64)&unk_57CF8);
          }
          v28 = v35;
          *v35 = *v24;
          *a2 = *v26;
          v13 = off_5A148;
          goto LABEL_94;
        }
        if ( v13 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v13->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
          && BYTE1(v13->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_11088(*(_QWORD *)&v13->DeviceLock.Header.Lock, 0x91u, (__int64)&unk_57CF8);
          v13 = off_5A148;
        }
      }
    }
    v28 = v35;
LABEL_94:
    v29 = (unsigned __int16)*v24;
    if ( v29 == 2 || v29 == 4 )
    {
      v30 = (unsigned __int16)*v28;
      if ( v30 == 3 || v30 == 1 )
      {
        if ( v13 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v13->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
          && BYTE1(v13->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_11088(*(_QWORD *)&v13->DeviceLock.Header.Lock, 0x93u, (__int64)&unk_57CF8);
        }
        *a2 = 1;
        *v28 = 4;
        *(_DWORD *)(a1 + 284) = 2;
      }
    }
    *v25 = 1;
    *v26 = *a2;
    *v24 = *v28;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_33F1C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x94u, (__int64)&unk_57CF8, (unsigned __int8)*v25);
    }
    v18 = sub_37238(*(_QWORD *)(a1 + 16), 1, v25, v24, v26);
    v11 = v18;
    if ( !v18 )
      goto LABEL_12;
    v12 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v11;
    if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_122;
    }
    v19 = 149;
    goto LABEL_23;
  }
  v15 = a7;
  v16 = a6;
  v17 = a5;
  v18 = sub_37238(*(_QWORD *)(a1 + 16), 0, a6, a7, a5);
  v11 = v18;
  if ( v18 )
  {
    v12 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v11;
    if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
    {
      goto LABEL_122;
    }
    v19 = 133;
LABEL_23:
    sub_13EA4(*(_QWORD *)&v12->DeviceLock.Header.Lock, v19, (__int64)&unk_57CF8, v18);
    goto LABEL_12;
  }
  v12 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_33F1C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x86u, (__int64)&unk_57CF8, (unsigned __int8)*v16);
    v12 = off_5A148;
  }
  if ( (unsigned __int16)v14 != 1 )
  {
    if ( (_WORD)v14 )
    {
      if ( v12 == (PDEVICE_OBJECT)&off_5A148 )
        return v11;
      if ( !_bittest((const signed __int32 *)&v12->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
        || BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) < 3u )
      {
        goto LABEL_122;
      }
      LODWORD(v32) = v14;
      sub_4AC00(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x8Du, (__int64)&unk_57CF8, *(_QWORD *)(a1 + 16), v32);
    }
    else
    {
      if ( v12 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v12->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
        && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x89u, (__int64)&unk_57CF8, *(_QWORD *)(a1 + 16));
      }
      v22 = _bittest((const int *)&v14, 0x1Du);
      *a3 = 1;
      if ( v22 )
      {
        v12 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x8Au, (__int64)&unk_57CF8);
          v12 = off_5A148;
        }
        if ( !*v16 )
          goto LABEL_122;
        v23 = (unsigned __int16)*v15;
        if ( v23 != 2 && v23 != 4 || !_bittest((const int *)&v14, 0x1Eu) )
        {
          if ( v12 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&v12->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
            && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_11088(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x8Cu, (__int64)&unk_57CF8);
          }
          *v34 |= 0x80u;
          v12 = off_5A148;
          goto LABEL_122;
        }
        if ( v12 == (PDEVICE_OBJECT)&off_5A148 )
          return v11;
        if ( !_bittest((const signed __int32 *)&v12->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
          || BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) < 4u )
        {
          goto LABEL_122;
        }
        sub_11088(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x8Bu, (__int64)&unk_57CF8);
      }
    }
    goto LABEL_12;
  }
  if ( v12 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v12->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
    && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_12D64(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x87u, (__int64)&unk_57CF8, *(_QWORD *)(a1 + 16));
    v12 = off_5A148;
  }
  if ( !*v16 )
    goto LABEL_122;
  v20 = (unsigned __int16)*v15;
  if ( (v20 == 2 || v20 == 4) && _bittest((const int *)&v14, 0x1Eu) )
  {
    *a3 = 1;
  }
  else
  {
    v21 = v35;
    *v34 = *v17;
    *v21 = *v15;
    *a3 = 0;
  }
  v12 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
LABEL_122:
      if ( v12 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v12->DeviceLock.Header.WaitListHead.Blink + 1, 0x12u)
        && BYTE1(v12->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v12->DeviceLock.Header.Lock, 0x96u, (__int64)&unk_57CF8);
      }
      return v11;
    }
    sub_33F1C(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x88u, (__int64)&unk_57CF8, (unsigned __int8)*a3);
LABEL_12:
    v12 = off_5A148;
    goto LABEL_122;
  }
  return v11;
}
// 37A79: variable 'v32' is possibly undefined

//----- (0000000000037E18) ----------------------------------------------------
__int64 __fastcall sub_37E18(__int64 a1, _DWORD *a2)
{
  char v4; // bl
  int v5; // eax
  int v6; // er11
  int v7; // eax
  int v8; // eax
  int v9; // er11
  int v10; // er11
  const char *v11; // rcx
  const char *v12; // r8
  const char *v13; // rax
  const char *v14; // r9

  v4 = 1;
  if ( a1 && a2 )
  {
    v5 = sub_4535C(0x2013030u);
    v6 = v5;
    if ( v5 )
    {
      v7 = v5 - 1;
      if ( v7 )
      {
        v8 = v7 - 1;
        if ( v8 )
        {
          if ( v8 != 1 )
            goto LABEL_14;
          goto LABEL_10;
        }
        if ( *(_BYTE *)(a1 + 60) || *(_BYTE *)(a1 + 61) )
        {
LABEL_10:
          v4 = 1;
          goto LABEL_14;
        }
      }
      else if ( !*(_BYTE *)(a1 + 60) && !*(_BYTE *)(a1 + 61) )
      {
        goto LABEL_10;
      }
    }
    v4 = 0;
LABEL_14:
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      if ( v6 )
      {
        v9 = v6 - 1;
        if ( v9 )
        {
          v10 = v9 - 1;
          if ( v10 )
          {
            if ( v10 == 1 )
              v11 = "BOTH";
            else
              v11 = "UNKNOWN_DEFAULT";
          }
          else
          {
            v11 = "ONLY_PUBLIC";
          }
        }
        else
        {
          v11 = "ONLY_PRIVATE";
        }
      }
      else
      {
        v11 = "NONE";
      }
      v12 = "FALSE";
      v13 = "FALSE";
      v14 = "NOT ";
      if ( *(_BYTE *)(a1 + 61) )
        v13 = "TRUE";
      if ( *(_BYTE *)(a1 + 60) )
        v12 = "TRUE";
      if ( v4 )
        v14 = (const char *)qword_56840;
      sub_34100(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 152i64, (__int64)&unk_57CF8, v14, v11, v12, v13);
    }
    if ( !v4 )
      *a2 |= 0x80u;
    return 0i64;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x97u, (__int64)&unk_57CF8, a1, a2);
  }
  return 4i64;
}
// 56840: using guessed type __int64 qword_56840[2];

//----- (0000000000037FC0) ----------------------------------------------------
__int64 __fastcall sub_37FC0(__int64 a1)
{
  double v2; // xmm0_8
  __int64 v3; // rsi
  PDEVICE_OBJECT v4; // rcx
  volatile signed __int32 *v6; // rax
  volatile signed __int32 *v7; // rax
  volatile signed __int32 *v8; // rax
  volatile signed __int32 *v9; // rcx
  __int64 v10; // rdi
  PDEVICE_OBJECT v11; // rcx
  double v12; // xmm0_8
  int v13; // er11
  _QWORD *v14; // rcx
  int v15; // er11
  PDEVICE_OBJECT v16; // rcx
  KIRQL v17; // [rsp+80h] [rbp+8h] BYREF
  double v18; // [rsp+88h] [rbp+10h] BYREF
  __int64 v19; // [rsp+90h] [rbp+18h]

  v2 = (double)(int)qword_5A850;
  if ( qword_5A850 < 0 )
    v2 = v2 + 1.844674407370955e19;
  v18 = v2;
  v3 = 0i64;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x99u, (__int64)&unk_57CF8);
    v4 = off_5A148;
  }
  if ( !*(_DWORD *)a1 )
  {
    if ( _bittest((const signed __int32 *)(a1 + 4), 0x1Au) )
    {
      if ( v4 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
        && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_12D64(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x9Bu, (__int64)&unk_57CF8, *(_QWORD *)(a1 + 16));
      }
      v6 = *(volatile signed __int32 **)(a1 + 32);
      if ( v6 )
        _InterlockedAdd(v6, 1u);
    }
    _InterlockedAdd(&dword_5A828, 1u);
    v7 = *(volatile signed __int32 **)(a1 + 24);
    if ( v7 )
      _InterlockedAdd(v7, 1u);
    v8 = *(volatile signed __int32 **)(a1 + 48);
    if ( v8 )
    {
      v9 = *(volatile signed __int32 **)(a1 + 56);
      if ( v9 )
      {
        if ( *(_QWORD *)(a1 + 40) )
        {
          if ( !*(_DWORD *)(a1 + 4) )
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
            {
              sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x9Cu, (__int64)&unk_57CF8, *(_QWORD *)(a1 + 16));
            }
            _InterlockedAdd(*(volatile signed __int32 **)(a1 + 40), 1u);
            goto LABEL_59;
          }
          if ( *(_DWORD *)(a1 + 4) == 4 )
            _InterlockedAdd(v8, 1u);
          else
            _InterlockedAdd(v9, 1u);
        }
      }
    }
    v19 = MEMORY[0xFFFFF78000000014];
    v10 = (MEMORY[0xFFFFF78000000014] - *(_QWORD *)(a1 + 8)) / 10000i64;
    if ( (unsigned __int64)v10 <= 0x2BC )
    {
      if ( !v10 )
      {
        v16 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
          return 0i64;
        if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xFu)
          || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 3u )
        {
LABEL_60:
          if ( v16 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&v16->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
            && BYTE1(v16->DeviceLock.Header.WaitListHead.Blink) >= 5u )
          {
            sub_11088(*(_QWORD *)&v16->DeviceLock.Header.Lock, 0xA2u, (__int64)&unk_57CF8);
          }
          return 0i64;
        }
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x9Eu, (__int64)&unk_57CF8, *(_QWORD *)(a1 + 16));
LABEL_59:
        v16 = off_5A148;
        goto LABEL_60;
      }
    }
    else
    {
      v11 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      {
LABEL_44:
        v12 = (double)(int)v10;
        if ( v10 < 0 )
          v12 = v12 + 1.844674407370955e19;
        sub_5226C(v12, dword_5A828, &v18);
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_34028(
            *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
            160i64,
            (__int64)&unk_57CF8,
            *(_QWORD *)(a1 + 16),
            (unsigned int)dword_5A828,
            v10,
            qword_5A850,
            (unsigned int)(int)v18);
        }
        sub_3CF30(&SpinLock, &v17);
        v13 = dword_5A950;
        v14 = qword_5A900;
        qword_5A900[dword_5A950] = v10;
        v15 = v13 + 1;
        if ( v15 >= 10 )
          v15 = 0;
        dword_5A950 = v15;
        do
          v3 += *v14++;
        while ( (__int64)v14 < (__int64)&dword_5A950 );
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_340AC(
            *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
            161i64,
            (__int64)&unk_57CF8,
            *(_QWORD *)(a1 + 16),
            v3 / 10);
        }
        sub_3CFA8(&SpinLock, v17);
        _InterlockedExchange64(&qword_5A850, (unsigned int)(int)v18);
        _InterlockedExchange64(&qword_5A858, v3 / 10);
        goto LABEL_59;
      }
      if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xFu)
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 3u )
      {
LABEL_40:
        if ( v11 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v11->DeviceLock.Header.WaitListHead.Blink + 1, 0xFu)
          && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_33FC4(
            *(_QWORD *)&v11->DeviceLock.Header.Lock,
            159i64,
            (__int64)&unk_57CF8,
            *(_QWORD *)(a1 + 16),
            v10,
            *(_DWORD *)(a1 + 4));
        }
        goto LABEL_44;
      }
      sub_33F70(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 157i64, (__int64)&unk_57CF8, *(_QWORD *)(a1 + 16), v10);
    }
    v11 = off_5A148;
    goto LABEL_40;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_12D64(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x9Au, (__int64)&unk_57CF8, *(_QWORD *)(a1 + 16));
  }
  return 11i64;
}
// 5A828: using guessed type int dword_5A828;
// 5A850: using guessed type __int64 qword_5A850;
// 5A858: using guessed type __int64 qword_5A858;
// 5A950: using guessed type int dword_5A950;

//----- (0000000000038428) ----------------------------------------------------
char __fastcall sub_38428(__int64 a1, int a2)
{
  int v2; // er9
  char result; // al
  __int64 i; // r8
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v6; // dx

  v2 = 0;
  result = 1;
  if ( !a1 || a2 < 3 )
  {
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 3u )
    {
      return 0;
    }
    v6 = 163;
    goto LABEL_18;
  }
  for ( i = 0i64; i < a2; ++i )
  {
    if ( i >= 20 )
      break;
    if ( v2 >= 3 )
      goto LABEL_10;
    if ( *(_BYTE *)(i + a1) == 58 )
      ++v2;
  }
  if ( v2 < 3 )
    return result;
LABEL_10:
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
  {
    v6 = 164;
LABEL_18:
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, v6, (__int64)&unk_57CF8);
  }
  return 0;
}
// 38446: conditional instruction was optimized away because of 'edx.4>=3'

//----- (00000000000384E8) ----------------------------------------------------
__int64 __fastcall sub_384E8(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57CE8, 11i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003854C) ----------------------------------------------------
__int64 __fastcall sub_3854C(int a1, _DWORD *a2)
{
  unsigned int v4; // edi
  PDEVICE_OBJECT v5; // rcx

  v4 = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xAu, (__int64)&unk_57CE8);
      v5 = off_5A148;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_384E8(*(_QWORD *)&v5->DeviceLock.Header.Lock, 11i64, (__int64)&unk_57CE8, a1);
      v5 = off_5A148;
    }
  }
  if ( !a2 )
  {
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xCu, (__int64)&unk_57CE8);
    }
    return 4i64;
  }
  if ( a2[5] == 2 )
  {
    sub_387F0((__int64)a2);
  }
  else
  {
    if ( a2[5] != 3 )
    {
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xDu, (__int64)&unk_57CE8);
        v5 = off_5A148;
      }
      v4 = 4;
      goto LABEL_25;
    }
    sub_389E8(a2);
  }
  v5 = off_5A148;
LABEL_25:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xEu, (__int64)&unk_57CE8);
  }
  return v4;
}

//----- (00000000000386DC) ----------------------------------------------------
__int64 sub_386DC()
{
  int v0; // eax
  unsigned int v1; // ebx
  PDEVICE_OBJECT v2; // rcx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xFu, (__int64)&unk_57CE8);
  }
  memset(&Resource, 0, 0x70ui64);
  v0 = sub_3F614(0x4D69614Eu, &qword_5D528, 0, (void (__fastcall *)(__int64 *))sub_38CE4);
  v1 = v0;
  if ( v0 )
  {
    v2 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x10u, (__int64)&unk_57CE8, v0);
      v2 = off_5A148;
    }
    qword_5D528 = 0i64;
  }
  else
  {
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x11u, (__int64)&unk_57CE8, v1);
  }
  return v1;
}
// 5D528: using guessed type __int64 qword_5D528;

//----- (00000000000387F0) ----------------------------------------------------
__int64 __fastcall sub_387F0(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 result; // rax
  _QWORD *v4; // rax
  __int64 v5; // rdi
  unsigned int v6; // ebx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x15u, (__int64)&unk_57CE8, a1);
    v2 = off_5A148;
  }
  if ( !qword_5D528 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x16u, (__int64)&unk_57CE8);
    }
    return 4i64;
  }
  if ( !a1 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x17u, (__int64)&unk_57CE8, 0i64);
    }
    return 4i64;
  }
  v4 = sub_3C4EC(1, 0x1Cu, 0x4D69614Eu);
  v5 = (__int64)v4;
  if ( v4 )
  {
    *v4 = *(_QWORD *)a1;
    v4[1] = *(_QWORD *)(a1 + 8);
    v4[2] = *(_QWORD *)(a1 + 16);
    *((_DWORD *)v4 + 6) = *(_DWORD *)(a1 + 24);
    KeEnterCriticalRegion();
    sub_3CC4C(&Resource);
    v6 = sub_3FA20((int *)qword_5D528, v5);
    sub_3CDFC(&Resource);
    KeLeaveCriticalRegion();
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x19u, (__int64)&unk_57CE8, v6);
    }
    result = v6;
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x18u, (__int64)&unk_57CE8);
    }
    result = 3i64;
  }
  return result;
}
// 5D528: using guessed type __int64 qword_5D528;

//----- (00000000000389E8) ----------------------------------------------------
__int64 __fastcall sub_389E8(_DWORD *a1)
{
  PDEVICE_OBJECT v2; // rcx
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Au, (__int64)&unk_57CE8);
    v2 = off_5A148;
  }
  if ( !qword_5D528 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x1Bu, (__int64)&unk_57CE8);
    }
    return 4i64;
  }
  if ( !a1 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x1Cu, (__int64)&unk_57CE8, 0i64);
    }
    return 4i64;
  }
  KeEnterCriticalRegion();
  sub_3CC4C(&Resource);
  v4 = sub_3FC70((int *)qword_5D528, a1);
  sub_3CDFC(&Resource);
  KeLeaveCriticalRegion();
  if ( !v4 )
    goto LABEL_21;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
LABEL_22:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x1Eu, (__int64)&unk_57CE8, v4);
      }
      return v4;
    }
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Du, (__int64)&unk_57CE8, v4);
LABEL_21:
    v5 = off_5A148;
    goto LABEL_22;
  }
  return v4;
}
// 5D528: using guessed type __int64 qword_5D528;

//----- (0000000000038B9C) ----------------------------------------------------
__int64 __fastcall sub_38B9C(_DWORD *a1, _DWORD *a2)
{
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx

  v4 = 1;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Fu, (__int64)&unk_57CE8);
    v5 = off_5A148;
  }
  if ( a1 && a2 )
  {
    if ( *a1 == *a2 )
    {
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x21u, (__int64)&unk_57CE8);
        v5 = off_5A148;
      }
      v4 = 7;
    }
    else
    {
      v4 = 8;
    }
  }
  else
  {
    if ( v5 == (PDEVICE_OBJECT)&off_5A148 )
      return v4;
    if ( _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_13EE0(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x20u, (__int64)&unk_57CE8, a1, a2);
      v5 = off_5A148;
    }
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0x22u, (__int64)&unk_57CE8, v4);
  }
  return v4;
}

//----- (0000000000038CE4) ----------------------------------------------------
__int64 __fastcall sub_38CE4(PVOID *a1)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x23u, (__int64)&unk_57CE8);
    v2 = off_5A148;
  }
  if ( a1 && *a1 )
  {
    sub_3C570(*a1, 0x4D69614Eu);
    *a1 = 0i64;
LABEL_12:
    v2 = off_5A148;
    goto LABEL_13;
  }
  if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
    return 0i64;
  if ( _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_12D64(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x24u, (__int64)&unk_57CE8, a1);
    goto LABEL_12;
  }
LABEL_13:
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x25u, (__int64)&unk_57CE8);
  }
  return 0i64;
}

//----- (0000000000038DDC) ----------------------------------------------------
__int64 __fastcall sub_38DDC(int a1, _DWORD *a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  unsigned int v6; // edi
  unsigned __int16 v7; // ax
  __int64 v8; // [rsp+30h] [rbp-48h] BYREF
  int v9; // [rsp+38h] [rbp-40h] BYREF
  char Dst[24]; // [rsp+3Ch] [rbp-3Ch] BYREF

  v9 = 0;
  memset(Dst, 0, sizeof(Dst));
  v8 = 0i64;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x26u, (__int64)&unk_57CE8);
    v4 = off_5A148;
  }
  if ( qword_5D528 )
  {
    v9 = a1;
    KeEnterCriticalRegion();
    sub_3CC4C(&Resource);
    v6 = sub_3FEC8((int *)qword_5D528, &v9, &v8);
    if ( v6 || !v8 )
    {
      v7 = sub_4535C(0x201301Cu);
      *a2 = v7;
      if ( v7 < 0x24Eu )
        *a2 = 590;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_184C0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x29u, (__int64)&unk_57CE8, a1);
      }
      v6 = 5;
    }
    else
    {
      *a2 = *(_DWORD *)(v8 + 4);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_184C0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x28u, (__int64)&unk_57CE8, a1);
      }
    }
    sub_3CDFC(&Resource);
    KeLeaveCriticalRegion();
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Au, (__int64)&unk_57CE8);
    }
    result = v6;
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 0xBu)
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x27u, (__int64)&unk_57CE8);
    }
    result = 4i64;
  }
  return result;
}
// 5D528: using guessed type __int64 qword_5D528;

//----- (0000000000039014) ----------------------------------------------------
__int64 sub_39014(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57CD8, 51i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003906C) ----------------------------------------------------
__int64 sub_3906C(__int64 a1, __int64 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+98h] [rbp+20h] BYREF
  va_list va; // [rsp+98h] [rbp+20h]
  const char *v7; // [rsp+A0h] [rbp+28h]
  const char *v8; // [rsp+A8h] [rbp+30h]
  va_list va1; // [rsp+B0h] [rbp+38h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, const char *);
  v8 = va_arg(va1, const char *);
  if ( v8 )
    strlen(v8);
  if ( v7 )
    strlen(v7);
  return qword_5A1B8(a1, 43i64, &unk_57CD8, 88i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000039144) ----------------------------------------------------
__int64 sub_39144(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, a3, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000039198) ----------------------------------------------------
__int64 __fastcall sub_39198(int a1, __int64 *a2)
{
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  unsigned int v6; // eax

  v4 = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xAu, (__int64)&unk_57CD8);
      v5 = off_5A148;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xBu, (__int64)&unk_57CD8, a1);
      v5 = off_5A148;
    }
  }
  if ( a1 == 1281 )
  {
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xCu, (__int64)&unk_57CD8, 1281);
      v5 = off_5A148;
    }
    if ( *a2 )
    {
      v6 = sub_39AE4(*a2);
      goto LABEL_28;
    }
  }
  else
  {
    if ( a1 != 1282 )
    {
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
        && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xEu, (__int64)&unk_57CD8, a1);
        v5 = off_5A148;
      }
      v4 = 277;
      goto LABEL_29;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xDu, (__int64)&unk_57CD8, 1282);
      v5 = off_5A148;
    }
    if ( *a2 )
    {
      v6 = sub_39D80(*a2);
LABEL_28:
      v5 = off_5A148;
      v4 = v6;
      goto LABEL_29;
    }
  }
LABEL_29:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v5->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
    && BYTE1(v5->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->DeviceLock.Header.Lock, 0xFu, (__int64)&unk_57CD8);
  }
  return v4;
}

//----- (0000000000039368) ----------------------------------------------------
__int64 __fastcall sub_39368(__int64 a1)
{
  int v2; // eax
  unsigned int v3; // ebx
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  int v6; // er9

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x10u, (__int64)&unk_57CD8);
  }
  v2 = sub_4421C(*(_DWORD *)(a1 + 20), *(const void **)(a1 + 24), *(_DWORD *)(a1 + 32));
  v3 = v2;
  if ( !v2 )
  {
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v3;
    if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_15;
    }
    v6 = *(_DWORD *)(a1 + 20);
    v5 = 18;
    goto LABEL_14;
  }
  v4 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v3;
  if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    v5 = 17;
    v6 = v2;
LABEL_14:
    sub_13EA4(*(_QWORD *)&v4->DeviceLock.Header.Lock, v5, (__int64)&unk_57CD8, v6);
    v4 = off_5A148;
  }
LABEL_15:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
    && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x13u, (__int64)&unk_57CD8);
  }
  return v3;
}

//----- (0000000000039488) ----------------------------------------------------
__int64 __fastcall sub_39488(_BYTE *a1, const void *a2, unsigned int a3)
{
  size_t v3; // rbp
  int v6; // eax
  int v7; // ebx
  _QWORD *v9; // rbx
  PDEVICE_OBJECT v10; // rcx
  unsigned __int16 v11; // dx
  _DWORD *v12; // rax
  _DWORD *v13; // rsi

  v3 = a3;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x14u, (__int64)&unk_57CD8);
  }
  _InterlockedAdd(&dword_5A894, 1u);
  v6 = sub_4535C(0x2013028u);
  v7 = v6;
  if ( a1[61] || v6 == 2 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x15u, (__int64)&unk_57CD8);
    }
    if ( !v7 )
      goto LABEL_11;
    v9 = sub_3D584((__int64)qword_5A658, 24, (__int64)sub_3A5F8, (__int64)sub_3A754);
    if ( v9 )
    {
      v12 = sub_3C4EC(2, 0x168u, 0x68737453u);
      v13 = v12;
      if ( v12 )
      {
        sub_53BD8(v12 + 24, 0x100ui64, a2, v3);
        v13[88] = v3;
        sub_53BD8(v13, 0x60ui64, a1, 0x60ui64);
        *(_DWORD *)v9 = 257;
        v9[1] = v13;
        *((_DWORD *)v9 + 4) = 360;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x18u, (__int64)&unk_57CD8);
        }
        sub_3D7EC((__int64)v9, 0);
        goto LABEL_12;
      }
      v10 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        return 3i64;
      }
      v11 = 23;
    }
    else
    {
      v10 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
        return 3i64;
      }
      v11 = 22;
    }
    sub_11088(*(_QWORD *)&v10->DeviceLock.Header.Lock, v11, (__int64)&unk_57CD8);
    return 3i64;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x19u, (__int64)&unk_57CD8);
  }
LABEL_11:
  sub_3973C((__int64)a1, (__int64)a2, (unsigned int)v3, -4);
LABEL_12:
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Au, (__int64)&unk_57CD8);
  }
  return 0i64;
}
// 5A894: using guessed type int dword_5A894;

//----- (000000000003973C) ----------------------------------------------------
__int64 __fastcall sub_3973C(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v7; // edx
  char v8; // cl
  int v9; // eax
  char *v10; // rdx
  bool v11; // al
  __m128i v12; // xmm0
  __m128i v13; // xmm1
  int v14; // eax
  unsigned int v15; // ebx
  PDEVICE_OBJECT v16; // rcx
  int v18[4]; // [rsp+30h] [rbp-298h] BYREF
  __int64 v19; // [rsp+40h] [rbp-288h] BYREF
  __int64 Dst[73]; // [rsp+48h] [rbp-280h] BYREF

  v18[0] = 0;
  v19 = 0i64;
  memset(Dst, 0, sizeof(Dst));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Bu, (__int64)&unk_57CD8);
  }
  v7 = *(_DWORD *)(a1 + 8);
  v8 = 6;
  HIDWORD(Dst[1]) = *(_DWORD *)(a1 + 84);
  v19 = *(_QWORD *)(a1 + 64);
  Dst[0] = *(_QWORD *)(a1 + 72);
  if ( v7 == 2048 )
    v8 = 4;
  LODWORD(Dst[3]) = *(unsigned __int16 *)(a1 + 14);
  v9 = *(unsigned __int16 *)(a1 + 12);
  LODWORD(Dst[1]) = v7;
  HIDWORD(Dst[2]) = v9;
  v10 = (char *)(a1 + 28);
  BYTE1(Dst[8]) = *(_BYTE *)(a1 + 61);
  LODWORD(Dst[2]) = *(_DWORD *)(a1 + 80);
  if ( LODWORD(Dst[2]) != 1 )
    v10 = (char *)(a1 + 44);
  v11 = sub_51C84(v8, v10);
  v12 = _mm_loadu_si128((const __m128i *)(a1 + 28));
  v13 = _mm_loadu_si128((const __m128i *)(a1 + 44));
  HIDWORD(Dst[7]) = a4;
  *(__m128i *)((char *)&Dst[3] + 4) = v12;
  *(__m128i *)((char *)&Dst[5] + 4) = v13;
  LOBYTE(Dst[8]) = !v11;
  sub_53D24((char *)&Dst[8] + 2, 0xFFui64, 0xFFui64, L"%S", a2);
  HIDWORD(Dst[72]) = *(_DWORD *)(a1 + 88);
  sub_27EEC((__int64)&v19);
  v14 = sub_40A2C(40031, &v19, 0x250u, 0, v18);
  v15 = v14;
  if ( !v14 )
  {
    v16 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v15;
    if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
      || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
      goto LABEL_19;
    }
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Du, (__int64)&unk_57CD8, v18[0]);
    goto LABEL_18;
  }
  v16 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v15;
  if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Cu, (__int64)&unk_57CD8, v14);
LABEL_18:
    v16 = off_5A148;
  }
LABEL_19:
  if ( v16 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v16->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
    && BYTE1(v16->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v16->DeviceLock.Header.Lock, 0x1Eu, (__int64)&unk_57CD8);
  }
  return v15;
}
// 56800: using guessed type wchar_t aS[3];

//----- (0000000000039990) ----------------------------------------------------
__int64 __fastcall sub_39990(__int64 a1, _QWORD *a2)
{
  PDEVICE_OBJECT v3; // rax
  int v5; // eax
  unsigned int v6; // ebx
  PDEVICE_OBJECT v7; // rcx
  _QWORD *v8; // [rsp+20h] [rbp-28h] BYREF
  __int64 v9; // [rsp+28h] [rbp-20h]
  __int64 v10; // [rsp+30h] [rbp-18h]
  __int64 v11; // [rsp+50h] [rbp+8h]

  v11 = a1;
  v8 = 0i64;
  v9 = 0i64;
  v10 = 0i64;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Fu, (__int64)&unk_57CD8);
    a1 = v11;
    v3 = off_5A148;
  }
  if ( a2 )
  {
    *a2 = a1;
    v8 = a2;
    LODWORD(v9) = 96;
    v5 = sub_1F7D8(520, (__int64 *)&v8);
    v6 = v5;
    if ( v5 )
    {
      v7 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return v6;
      if ( !_bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
        || BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) < 2u )
      {
LABEL_17:
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v7->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
          && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x22u, (__int64)&unk_57CD8);
        }
        return v6;
      }
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x21u, (__int64)&unk_57CD8, v5);
    }
    v7 = off_5A148;
    goto LABEL_17;
  }
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v3->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
    && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x20u, (__int64)&unk_57CD8);
  }
  return 4i64;
}

//----- (0000000000039AE4) ----------------------------------------------------
__int64 __fastcall sub_39AE4(__int64 a1)
{
  PDEVICE_OBJECT v2; // rax
  __int64 result; // rax
  __int64 v4; // rbx
  __int64 v5; // rsi
  const char *v6; // rax
  unsigned int v7; // edi
  __int64 v8; // [rsp+30h] [rbp-88h] BYREF
  int v9; // [rsp+38h] [rbp-80h]
  char v10[52]; // [rsp+5Ch] [rbp-5Ch] BYREF

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x23u, (__int64)&unk_57CD8);
    v2 = off_5A148;
  }
  if ( a1 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x25u, (__int64)&unk_57CD8, *(_DWORD *)(a1 + 4));
      v2 = off_5A148;
    }
    v4 = *(_QWORD *)(a1 + 16);
    if ( v4 )
    {
      if ( *(_DWORD *)(v4 + 20) != 40044 )
        goto LABEL_34;
      v5 = *(_QWORD *)(v4 + 24);
      if ( v2 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Du)
        && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        v6 = sub_4A83C(*(_DWORD *)(v4 + 16));
        sub_18760(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x27u, (__int64)&unk_57CD8, *(_QWORD *)v4, v6);
      }
      if ( *(_DWORD *)(v5 + 33) )
        goto LABEL_34;
      LODWORD(v8) = 0;
      memset((char *)&v8 + 4, 0, 0x5Cui64);
      v7 = sub_39990(*(_QWORD *)v4, &v8);
      if ( v7 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
        {
          sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x28u, (__int64)&unk_57CD8);
        }
      }
      else
      {
        sub_53BD8((void *)(v5 + 17), 0x10ui64, v10, 0x10ui64);
        *(_DWORD *)(v5 + 33) = v9;
      }
      if ( !v7 )
LABEL_34:
        v7 = sub_39368(v4);
      sub_3C570(*(PVOID *)(v4 + 24), 0x6E707453u);
      sub_3C570((PVOID)v4, 0x6E707453u);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x29u, (__int64)&unk_57CD8);
      }
      result = v7;
    }
    else
    {
      if ( v2 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
        && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x26u, (__int64)&unk_57CD8);
      }
      result = 6i64;
    }
  }
  else
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x24u, (__int64)&unk_57CD8);
    }
    result = 4i64;
  }
  return result;
}

//----- (0000000000039D80) ----------------------------------------------------
__int64 __fastcall sub_39D80(__int64 a1)
{
  unsigned int v1; // er13
  PDEVICE_OBJECT v3; // rcx
  __int64 result; // rax
  __int64 v5; // rsi
  _QWORD *v6; // rdi
  const char *v7; // rax
  unsigned int v8; // eax
  int v9; // er12
  PDEVICE_OBJECT v10; // rcx
  char *v11; // rax
  char *v12; // rbp
  __int64 v13; // rax
  __int64 v14; // [rsp+20h] [rbp-38h]
  __int64 v15; // [rsp+30h] [rbp-28h] BYREF
  int v16; // [rsp+38h] [rbp-20h]
  int v17; // [rsp+3Ch] [rbp-1Ch]
  int v18; // [rsp+60h] [rbp+8h] BYREF

  v1 = 0;
  v18 = 0;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Au, (__int64)&unk_57CD8);
    v3 = off_5A148;
  }
  if ( a1 )
  {
    if ( v3 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v3->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
      && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x2Cu, (__int64)&unk_57CD8, *(_DWORD *)(a1 + 4));
      v3 = off_5A148;
    }
    v5 = *(_QWORD *)(a1 + 16);
    if ( v5 )
    {
      if ( *(_DWORD *)(v5 + 20) == 40010 )
      {
        v6 = *(_QWORD **)(v5 + 24);
        HIDWORD(v15) = 0;
        v16 = 0;
        v17 = 0;
        *v6 = *(_QWORD *)v5;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          v7 = sub_4A83C(*(_DWORD *)(v5 + 16));
          sub_18760(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Eu, (__int64)&unk_57CD8, *v6, v7);
        }
        v8 = sub_3AE08(v6, *(_DWORD *)(v5 + 32), &v18);
        v9 = v18;
        v1 = v8;
        if ( !v8 && v18 == 4 )
        {
          v10 = off_5A148;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
          {
            if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Fu, (__int64)&unk_57CD8, *v6);
              v10 = off_5A148;
            }
            if ( v10 != (PDEVICE_OBJECT)&off_5A148
              && _bittest((const signed __int32 *)&v10->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
              && BYTE1(v10->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              LODWORD(v14) = *((_DWORD *)v6 + 71);
              sub_4AC00(*(_QWORD *)&v10->DeviceLock.Header.Lock, 0x30u, (__int64)&unk_57CD8, v6[34], v14);
            }
          }
          v11 = sub_52180((unsigned __int8 *)v6[34], *((_DWORD *)v6 + 67));
          v12 = v11;
          if ( v11 )
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              sub_187E8(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x31u, (__int64)&unk_57CD8, v11);
            }
            sub_3C570(v12, 0x7368624Du);
          }
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x32u, (__int64)&unk_57CD8);
          }
          sub_20FEC((void *)v6[34], *((unsigned int *)v6 + 67), *(_QWORD *)v5);
        }
        v13 = *(_QWORD *)v5;
        v17 = v9;
        v15 = v13;
        LOBYTE(v16) = 0;
        sub_212D0(&v15);
        if ( v6[34] && *((_DWORD *)v6 + 67) )
        {
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
          {
            LODWORD(v14) = *((_DWORD *)v6 + 71);
            sub_39014(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 51i64, (__int64)&unk_57CD8, *v6, v14);
          }
          sub_3C570((PVOID)v6[34], 0x6D724453u);
        }
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x34u, (__int64)&unk_57CD8, *v6);
        }
        sub_3A1DC(v5);
      }
      sub_3C570(*(PVOID *)(v5 + 24), 0x61707453u);
      sub_3C570((PVOID)v5, 0x61707453u);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x35u, (__int64)&unk_57CD8);
      }
      result = v1;
    }
    else
    {
      if ( v3 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v3->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
        && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x2Du, (__int64)&unk_57CD8);
      }
      result = 6i64;
    }
  }
  else
  {
    if ( v3 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v3->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
      && BYTE1(v3->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v3->DeviceLock.Header.Lock, 0x2Bu, (__int64)&unk_57CD8);
    }
    result = 4i64;
  }
  return result;
}
// 39FB8: variable 'v14' is possibly undefined

//----- (000000000003A1DC) ----------------------------------------------------
__int64 __fastcall sub_3A1DC(__int64 a1)
{
  __int64 v2; // rax
  int v3; // er8
  int v4; // eax
  unsigned int v5; // ebx
  PDEVICE_OBJECT v6; // rcx
  __int64 *v8; // [rsp+20h] [rbp-58h] BYREF
  __int64 v9; // [rsp+28h] [rbp-50h]
  __int64 v10; // [rsp+30h] [rbp-48h]
  __int64 v11; // [rsp+38h] [rbp-40h] BYREF
  __int64 v12[5]; // [rsp+40h] [rbp-38h] BYREF

  v11 = 0i64;
  v9 = 0i64;
  v10 = 0i64;
  memset(v12, 0, sizeof(v12));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x36u, (__int64)&unk_57CD8);
  }
  v2 = *(_QWORD *)a1;
  v3 = *(_DWORD *)(a1 + 16);
  v10 = 0i64;
  v12[0] = v2;
  v12[1] = *(_QWORD *)(a1 + 8);
  LODWORD(v12[2]) = v3;
  LODWORD(v9) = 48;
  v8 = &v11;
  v4 = sub_17324(262, (__int64)&v8, v3);
  v5 = v4;
  if ( !v4 )
    goto LABEL_10;
  v6 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v5;
  if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x37u, (__int64)&unk_57CD8, v4);
LABEL_10:
    v6 = off_5A148;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x38u, (__int64)&unk_57CD8);
  }
  return v5;
}

//----- (000000000003A314) ----------------------------------------------------
__int64 __fastcall sub_3A314(void *Dst, __int64 a2, const void *a3)
{
  PDEVICE_OBJECT v6; // rcx
  __int64 result; // rax

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x39u, (__int64)&unk_57CD8);
    v6 = off_5A148;
  }
  if ( Dst && a2 && a3 )
  {
    memmove(Dst, a3, 0x118ui64);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Bu, (__int64)&unk_57CD8);
    }
    result = 0i64;
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
      && BYTE1(v6->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_39144(*(_QWORD *)&v6->DeviceLock.Header.Lock, 0x3Au, (__int64)&unk_57CD8, Dst, a2, a3);
    }
    result = 4i64;
  }
  return result;
}

//----- (000000000003A430) ----------------------------------------------------
__int64 __fastcall sub_3A430(__int64 a1, __int64 a2, const void *a3, unsigned int a4)
{
  size_t v4; // rbx
  PDEVICE_OBJECT v8; // rcx
  __int64 result; // rax

  v4 = a4;
  v8 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Cu, (__int64)&unk_57CD8);
    v8 = off_5A148;
  }
  if ( a1 && a2 && a3 )
  {
    if ( (_DWORD)v4 )
    {
      if ( v8 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v8->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
        && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x3Eu, (__int64)&unk_57CD8, v4);
      }
      *(_DWORD *)(a1 + 268) = v4;
      *(_QWORD *)(a1 + 272) = sub_3C4EC(2, v4, 0x6D724453u);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x40u, (__int64)&unk_57CD8, v4);
      }
      memmove(*(void **)(a1 + 272), a3, v4);
      v8 = off_5A148;
    }
    if ( v8 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v8->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
      && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x41u, (__int64)&unk_57CD8);
    }
    result = 0i64;
  }
  else
  {
    if ( v8 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v8->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
      && BYTE1(v8->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_39144(*(_QWORD *)&v8->DeviceLock.Header.Lock, 0x3Du, (__int64)&unk_57CD8, a1, a2, a3);
    }
    result = 4i64;
  }
  return result;
}

//----- (000000000003A5F8) ----------------------------------------------------
void __fastcall sub_3A5F8(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  void *v3; // rbx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x42u, (__int64)&unk_57CD8);
    v2 = off_5A148;
  }
  if ( *(_DWORD *)a1 != 257 )
  {
    if ( *(_DWORD *)a1 != 258 && *(_DWORD *)a1 != 259 )
    {
      if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
        return;
      if ( (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x44u, (__int64)&unk_57CD8);
LABEL_20:
        v2 = off_5A148;
        goto LABEL_21;
      }
    }
    goto LABEL_21;
  }
  v3 = *(void **)(a1 + 8);
  if ( !(unsigned int)sub_3ABA0((__int64)v3) )
    goto LABEL_17;
  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x43u, (__int64)&unk_57CD8);
LABEL_17:
    v2 = off_5A148;
  }
  if ( v3 )
  {
    sub_3C570(v3, 0x68737453u);
    goto LABEL_20;
  }
LABEL_21:
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x45u, (__int64)&unk_57CD8);
  }
}

//----- (000000000003A754) ----------------------------------------------------
void __fastcall sub_3A754(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  unsigned __int16 v3; // dx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x46u, (__int64)&unk_57CD8, a1);
    v2 = off_5A148;
  }
  if ( !a1 )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
      return;
    if ( (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      goto LABEL_24;
    }
    v3 = 73;
    goto LABEL_23;
  }
  if ( *(_DWORD *)a1 != 257 )
  {
    if ( *(_DWORD *)a1 == 258 || *(_DWORD *)a1 == 259 )
      goto LABEL_24;
    if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
      return;
    if ( (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 0x10) == 0
      || BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) < 5u )
    {
      goto LABEL_24;
    }
    v3 = 72;
    goto LABEL_23;
  }
  if ( *(_QWORD *)(a1 + 8) )
  {
    sub_3C570(*(PVOID *)(a1 + 8), 0x68737453u);
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( !_bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
      || BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) < 4u )
    {
LABEL_24:
      if ( v2 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v2->DeviceLock.Header.WaitListHead.Blink) & 0x10) != 0
        && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x4Au, (__int64)&unk_57CD8);
      }
      return;
    }
    v3 = 71;
LABEL_23:
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, v3, (__int64)&unk_57CD8);
    v2 = off_5A148;
    goto LABEL_24;
  }
}

//----- (000000000003A8B8) ----------------------------------------------------
__int64 __fastcall sub_3A8B8(void *Src, size_t MaxCount, int a3, __m128i *a4, __int64 a5)
{
  size_t v7; // rsi
  unsigned int v8; // ebx
  PDEVICE_OBJECT v10; // rcx
  __int64 result; // rax
  int v12; // eax
  unsigned __int64 v13; // rsi
  int v14; // [rsp+30h] [rbp-1A8h] BYREF
  char v15[9]; // [rsp+38h] [rbp-1A0h]
  int v16; // [rsp+41h] [rbp-197h]
  __int16 v17; // [rsp+45h] [rbp-193h]
  char v18; // [rsp+47h] [rbp-191h]
  __int64 v19; // [rsp+48h] [rbp-190h]
  __int64 v20; // [rsp+50h] [rbp-188h]
  char Dst; // [rsp+60h] [rbp-178h] BYREF
  char v22[287]; // [rsp+61h] [rbp-177h] BYREF

  v7 = (unsigned int)MaxCount;
  v8 = 0;
  Dst = 0;
  memset(v22, 0, 0x117ui64);
  v14 = 0;
  v19 = MEMORY[0xFFFFF78000000014];
  v10 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Bu, (__int64)&unk_57CD8);
    v10 = off_5A148;
  }
  if ( Src )
  {
    *(_DWORD *)&v22[255] = a3;
    *(_DWORD *)&v22[259] = 6;
    memmove(&Dst, Src, v7);
    v12 = sub_4535C(0x2013029u);
    sub_40C80(
      40009,
      &Dst,
      0x118u,
      v12,
      &v14,
      (void (__fastcall *)(const void *, _QWORD, PVOID, _QWORD, const void *, unsigned int))sub_3A314);
    v20 = MEMORY[0xFFFFF78000000014];
    v13 = (MEMORY[0xFFFFF78000000014] - v19) / 10000;
    if ( v13 < (unsigned int)sub_4535C(0x2013029u) )
    {
      v15[0] = 0;
      *(_QWORD *)&v15[1] = 0i64;
      v16 = 0;
      v17 = 0;
      v18 = 0;
      if ( *(_DWORD *)&v22[263] )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_187E8(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Eu, (__int64)&unk_57CD8, (const char *)Src);
        }
        *a4 = _mm_loadu_si128((const __m128i *)&v22[263]);
        *(_DWORD *)a5 = v13;
      }
      else
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
          && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
        {
          sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Fu, (__int64)&unk_57CD8);
        }
        *(_DWORD *)a5 = -6;
        v8 = 17;
      }
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0xEu)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 3u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x4Du, (__int64)&unk_57CD8, v13);
      }
      *(_DWORD *)a5 = -5;
      v8 = 10;
    }
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x50u, (__int64)&unk_57CD8);
    }
    result = v8;
  }
  else
  {
    if ( v10 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v10->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
      && BYTE1(v10->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v10->DeviceLock.Header.Lock, 0x4Cu, (__int64)&unk_57CD8);
    }
    *(_DWORD *)a5 = -6;
    result = 4i64;
  }
  return result;
}

//----- (000000000003ABA0) ----------------------------------------------------
__int64 __fastcall sub_3ABA0(__int64 a1)
{
  unsigned int v2; // edi
  __int64 v4; // [rsp+40h] [rbp+8h] BYREF

  LODWORD(v4) = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x51u, (__int64)&unk_57CD8);
  }
  v2 = sub_3A8B8(
         (void *)(a1 + 96),
         *(unsigned int *)(a1 + 352),
         *(_DWORD *)(a1 + 8),
         (__m128i *)(a1 + 44),
         (__int64)&v4);
  sub_3973C(a1, a1 + 96, *(unsigned int *)(a1 + 352), v4);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x19u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x52u, (__int64)&unk_57CD8);
  }
  return v2;
}

//----- (000000000003AC88) ----------------------------------------------------
__int64 __fastcall sub_3AC88(int a1, __int64 a2, int a3, _DWORD *a4, void **a5, _DWORD *a6)
{
  PDEVICE_OBJECT v9; // rcx
  __int64 result; // rax
  PVOID v11; // rax

  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x53u, (__int64)&unk_57CD8, a1);
    v9 = off_5A148;
  }
  if ( a3 == 536 )
  {
    v11 = sub_3C4EC(2, 0x218u, 0x64445453u);
    *a5 = v11;
    if ( v11 )
    {
      *a4 = 536;
      *a6 = 1682199635;
      memmove(*a5, &unk_5A680, 0x218ui64);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x56u, (__int64)&unk_57CD8);
      }
      result = 0i64;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x55u, (__int64)&unk_57CD8);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v9->DeviceLock.Header.WaitListHead.Blink + 1, 0x16u)
      && BYTE1(v9->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&v9->DeviceLock.Header.Lock, 0x54u, (__int64)&unk_57CD8, a3);
    }
    result = 6i64;
  }
  return result;
}

//----- (000000000003AE08) ----------------------------------------------------
__int64 __fastcall sub_3AE08(_QWORD *a1, unsigned int a2, _DWORD *a3)
{
  int v6; // eax
  int v7; // eax
  unsigned int v8; // ebx
  signed __int32 v9; // ecx
  __int64 v10; // rdi
  PDEVICE_OBJECT v11; // r10
  const char *v12; // rax
  __int64 v13; // r10
  int v15[2]; // [rsp+40h] [rbp-58h] BYREF
  __int64 v16; // [rsp+48h] [rbp-50h]
  __int64 v17; // [rsp+50h] [rbp-48h]
  void *v18; // [rsp+58h] [rbp-40h]
  void *v19; // [rsp+60h] [rbp-38h]
  void *v20; // [rsp+68h] [rbp-30h]
  void *v21; // [rsp+70h] [rbp-28h]
  void *v22; // [rsp+78h] [rbp-20h]
  int v23; // [rsp+B0h] [rbp+18h] BYREF
  __int64 v24; // [rsp+B8h] [rbp+20h]

  v23 = 1;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x57u, (__int64)&unk_57CD8);
  }
  v24 = MEMORY[0xFFFFF78000000014];
  v6 = sub_4535C(0x2013031u);
  v7 = sub_40C80(
         40010,
         a1,
         a2,
         v6,
         &v23,
         (void (__fastcall *)(const void *, _QWORD, PVOID, _QWORD, const void *, unsigned int))sub_3A430);
  v15[1] = v23;
  v8 = v7;
  v16 = v24;
  v15[0] = v7;
  do
  {
    do
      v9 = _InterlockedIncrement(&dword_5A190);
    while ( v9 == 0x7FFFFFFF );
  }
  while ( !v9 );
  v10 = v9;
  v18 = &unk_5A838;
  v17 = v9;
  v19 = &unk_5A848;
  v20 = &unk_5A888;
  v22 = &unk_5A868;
  v21 = &unk_5A878;
  sub_37FC0((__int64)v15);
  if ( v8 )
  {
    v11 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x59u, (__int64)&unk_57CD8, v8);
      v11 = off_5A148;
    }
    v8 = 11;
  }
  else
  {
    v11 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      v12 = sub_4A760(v23);
      sub_3906C(*(_QWORD *)(v13 + 280), 88i64, (__int64)&unk_57CD8, *a1, (char *)a1 + 12, v12, v10);
      v11 = off_5A148;
    }
  }
  *a3 = v23;
  if ( v11 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v11->DeviceLock.Header.WaitListHead.Blink + 1, 0x1Cu)
    && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x5Au, (__int64)&unk_57CD8);
  }
  return v8;
}
// 3AF79: variable 'v13' is possibly undefined
// 5A190: using guessed type int dword_5A190;

//----- (000000000003B050) ----------------------------------------------------
__int64 __fastcall sub_3B050(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+E8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57CC8, 13i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003B104) ----------------------------------------------------
__int64 __fastcall sub_3B104(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+A8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, a3, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003B178) ----------------------------------------------------
__int64 __fastcall sub_3B178(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4, const char *a5)
{
  const char *v7; // rcx

  if ( a5 )
    strlen(a5);
  if ( a4 )
    strlen(a4);
  v7 = "NULL";
  if ( a4 )
    v7 = a4;
  return qword_5A1B8(a1, 43i64, a3, a2, v7);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003B228) ----------------------------------------------------
__int64 __fastcall sub_3B228(_QWORD *a1)
{
  _QWORD *v1; // rbx
  unsigned int v2; // edi
  __int64 result; // rax
  PDEVICE_OBJECT v4; // r14
  int v5; // esi
  __int64 v6; // r15
  __int64 v7; // rdi
  __int16 v8; // r9
  __int16 v9; // si
  __int16 v10; // bx
  __int16 v11; // r12
  __int64 v12; // r12
  __int64 v13; // rax
  PDEVICE_OBJECT v14; // rcx
  int v15; // eax
  unsigned int v16; // [rsp+60h] [rbp-98h] BYREF
  __int16 v17; // [rsp+68h] [rbp-90h]
  __int16 v18; // [rsp+70h] [rbp-88h]
  __int16 v19; // [rsp+78h] [rbp-80h]
  __int16 v20; // [rsp+80h] [rbp-78h]
  __int16 v21; // [rsp+88h] [rbp-70h]
  int v22; // [rsp+90h] [rbp-68h]
  ULONG_PTR BugCheckParameter1; // [rsp+98h] [rbp-60h] BYREF
  __int64 v24; // [rsp+A0h] [rbp-58h]
  _QWORD *v25; // [rsp+100h] [rbp+8h]

  v25 = a1;
  v1 = a1;
  v2 = 0;
  v16 = 0;
  BugCheckParameter1 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xAu, (__int64)&unk_57CC8);
  }
  if ( (unsigned int)sub_4535C(0x201302Bu) )
  {
    v4 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_11190(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xCu, (__int64)&unk_57CC8, (const char *)*v1);
      v4 = off_5A148;
    }
    v5 = 0;
    v22 = 0;
    if ( *((_WORD *)v1 + 4) )
    {
      v6 = 0i64;
      do
      {
        v7 = *(_QWORD *)((char *)v1 + 10);
        v24 = v7;
        if ( *(_BYTE *)(v6 + v7 + 20) == 16 )
        {
          if ( v4 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
            && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            v8 = *(_WORD *)(v6 + v7 + 10);
            v9 = *(_WORD *)(v6 + v7 + 6);
            v10 = *(_WORD *)(v6 + v7 + 8);
            v11 = *(_WORD *)(v6 + v7 + 4);
            v20 = *(_WORD *)(v6 + v7 + 12);
            v18 = v8;
            v21 = v9;
            v19 = v10;
            v17 = v11;
            v5 = v22;
            sub_3B050(*(_QWORD *)&v4->DeviceLock.Header.Lock, 13i64, (__int64)&unk_57CC8, v22);
            v1 = v25;
            v7 = v24;
          }
        }
        else if ( v4 != (PDEVICE_OBJECT)&off_5A148
               && _bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
               && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_3B104(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0xEu, (__int64)&unk_57CC8, v5);
        }
        v12 = sub_3BDD8((unsigned __int8 *)(v6 + v7 + 4), &BugCheckParameter1, &v16);
        if ( v16 == 5 )
        {
          v13 = sub_3BA20(
                  (unsigned __int8 *)(v6 + v7 + 4),
                  *(_BYTE *)(v6 + v7 + 20),
                  (const void *)*v1,
                  *(_DWORD *)(v6 + v7),
                  (ULONG_PTR **)&BugCheckParameter1,
                  &v16);
          v2 = v16;
          if ( v16 )
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
            {
              sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xFu, (__int64)&unk_57CC8, v16);
            }
          }
          else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
                 && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
                 && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
          {
            sub_182DC(
              *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
              0x10u,
              (__int64)&unk_57CC8,
              *(_QWORD *)(v13 + 280),
              *v1);
          }
        }
        else
        {
          v14 = off_5A148;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
          {
            if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
              && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              sub_182DC(
                *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
                0x11u,
                (__int64)&unk_57CC8,
                *(_QWORD *)(v12 + 280),
                *v1);
              v14 = off_5A148;
            }
            if ( v14 != (PDEVICE_OBJECT)&off_5A148
              && _bittest((const signed __int32 *)&v14->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
              && BYTE1(v14->DeviceLock.Header.WaitListHead.Blink) >= 4u )
            {
              sub_11088(*(_QWORD *)&v14->DeviceLock.Header.Lock, 0x12u, (__int64)&unk_57CC8);
            }
          }
          sub_3C004(v12, (const void *)*v1, *(_DWORD *)(v6 + v7));
          _InterlockedAdd(&dword_5A804, 1u);
          v2 = v16;
        }
        sub_3BF50(BugCheckParameter1);
        v15 = *((unsigned __int16 *)v1 + 4);
        v4 = off_5A148;
        ++v5;
        v6 += 21i64;
        v22 = v5;
      }
      while ( v5 < v15 );
    }
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v4->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(v4->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v4->DeviceLock.Header.Lock, 0x13u, (__int64)&unk_57CC8);
    }
    result = v2;
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0xBu, (__int64)&unk_57CC8);
    }
    result = 0i64;
  }
  return result;
}
// 5A804: using guessed type int dword_5A804;

//----- (000000000003B75C) ----------------------------------------------------
__int64 sub_3B75C()
{
  __int64 result; // rax
  unsigned __int8 v1; // al
  __int64 v2; // [rsp+28h] [rbp-40h]
  int v3; // [rsp+70h] [rbp+8h] BYREF

  v3 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x14u, (__int64)&unk_57CC8);
  }
  qword_5A958 = sub_3C76C(2, 0x168u, 0x63646153u);
  if ( qword_5A958 )
  {
    v1 = sub_4535C(0x201302Cu);
    LODWORD(v2) = 2;
    qword_5D4B0 = (ULONG_PTR)sub_477F4(v1, 0i64, 2, 0x63646153u, 0i64, v2, 0i64, 0i64, (__int64)sub_3B910, 0i64, &v3);
    if ( v3 )
    {
      sub_3C7F0(qword_5A958);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x16u, (__int64)&unk_57CC8, v3);
      }
      result = 1i64;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x17u, (__int64)&unk_57CC8);
      }
      result = 0i64;
    }
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x15u, (__int64)&unk_57CC8);
    }
    result = 3i64;
  }
  return result;
}
// 3B860: variable 'v2' is possibly undefined

//----- (000000000003B910) ----------------------------------------------------
__int64 __fastcall sub_3B910(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  char v3; // al

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x21u, (__int64)&unk_57CC8);
    v2 = off_5A148;
  }
  if ( a1 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_12D64(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x22u, (__int64)&unk_57CC8, *(_QWORD *)(a1 + 280));
    }
    v3 = *(_BYTE *)(a1 + 16);
    if ( v3 == 4 )
    {
      _InterlockedAdd(&dword_5A768, 0xFFFFFFFF);
    }
    else if ( v3 == 16 )
    {
      _InterlockedAdd(&dword_5A76C, 0xFFFFFFFF);
    }
    sub_3C978((__int64)qword_5A958, a1);
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x23u, (__int64)&unk_57CC8);
  }
  return 0i64;
}
// 5A768: using guessed type int dword_5A768;
// 5A76C: using guessed type int dword_5A76C;

//----- (000000000003BA20) ----------------------------------------------------
__int64 __fastcall sub_3BA20(unsigned __int8 *a1, char a2, const void *a3, int a4, ULONG_PTR **a5, _DWORD *a6)
{
  PDEVICE_OBJECT v10; // rcx
  _DWORD *v11; // rdi
  _DWORD *v12; // rax
  __int64 v13; // rbx
  PDEVICE_OBJECT v14; // rcx
  unsigned int v16; // ecx
  unsigned __int8 *v17; // rdx
  __int64 v18; // r8
  int v19; // eax
  unsigned __int64 v20; // rbp
  unsigned int v21; // eax
  __int64 v22; // rax
  ULONG_PTR v23; // rcx
  int v24; // eax
  int v25; // eax
  PDEVICE_OBJECT v26; // rcx
  char v27; // al

  v10 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x24u, (__int64)&unk_57CC8);
    v10 = off_5A148;
  }
  v11 = a6;
  *a6 = 0;
  if ( v10 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v10->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(v10->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v10->DeviceLock.Header.Lock, 0x1Eu, (__int64)&unk_57CC8);
  }
  v12 = sub_3C910((__int64)qword_5A958);
  v13 = (__int64)v12;
  if ( !v12 )
  {
    v14 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
        && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x1Fu, (__int64)&unk_57CC8);
        v14 = off_5A148;
      }
      if ( v14 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v14->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
        && BYTE1(v14->DeviceLock.Header.WaitListHead.Blink) >= 2u )
      {
        sub_11088(*(_QWORD *)&v14->DeviceLock.Header.Lock, 0x25u, (__int64)&unk_57CC8);
      }
    }
    *v11 = 3;
    return 0i64;
  }
  memset(v12, 0, 0x168ui64);
  sub_3D230(v13 + 288);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x20u, (__int64)&unk_57CC8);
  }
  v16 = 0;
  v17 = a1;
  v18 = 16i64;
  do
  {
    v19 = *v17++;
    v16 = v19 ^ (-2128831035 * v16);
    --v18;
  }
  while ( v18 );
  v20 = v16;
  *(_QWORD *)(v13 + 280) = v16;
  sub_53BD8((void *)(v13 + 17), 0x100ui64, a3, 0x100ui64);
  sub_53BD8((void *)v13, 0x10ui64, a1, 0x10ui64);
  *(_BYTE *)(v13 + 16) = a2;
  *(_DWORD *)(v13 + 276) = a4 * sub_4535C(0x201302Du);
  v21 = sub_4535C(0x201302Eu);
  if ( *(_DWORD *)(v13 + 276) < v21 )
    *(_DWORD *)(v13 + 276) = v21;
  v22 = MEMORY[0xFFFFF78000000014];
  v23 = qword_5D4B0;
  *(_DWORD *)(v13 + 344) = 0;
  *(_QWORD *)(v13 + 352) = v22;
  v24 = sub_488F0(v23, v20, v13, a5);
  LODWORD(a6) = v24;
  if ( v24 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
    {
      sub_4AC00(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x26u, (__int64)&unk_57CC8, *(_QWORD *)(v13 + 280), v24);
    }
    sub_3B910(v13);
    *v11 = 13;
    return 0i64;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
  {
    sub_4AC00(
      *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
      0x27u,
      (__int64)&unk_57CC8,
      *(_QWORD *)(v13 + 280),
      *(_DWORD *)(v13 + 276));
  }
  v25 = sub_487F8(qword_5D4B0, &a6);
  v26 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x28u, (__int64)&unk_57CC8, v25);
    v26 = off_5A148;
  }
  v27 = *(_BYTE *)(v13 + 16);
  if ( v27 == 4 )
  {
    _InterlockedAdd(&dword_5A768, 1u);
  }
  else
  {
    if ( v27 != 16 )
      goto LABEL_47;
    _InterlockedAdd(&dword_5A76C, 1u);
  }
  v26 = off_5A148;
LABEL_47:
  if ( v26 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v26->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(v26->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v26->DeviceLock.Header.Lock, 0x29u, (__int64)&unk_57CC8);
  }
  return v13;
}
// 5A768: using guessed type int dword_5A768;
// 5A76C: using guessed type int dword_5A76C;

//----- (000000000003BDD8) ----------------------------------------------------
__int64 __fastcall sub_3BDD8(unsigned __int8 *a1, _QWORD *a2, _DWORD *a3)
{
  unsigned int v6; // ecx
  __int64 v7; // rdx
  int v8; // eax
  __int64 v9; // rsi
  __int64 v10; // rbx
  PDEVICE_OBJECT v11; // rcx
  int v13; // [rsp+50h] [rbp+18h] BYREF

  v13 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Au, (__int64)&unk_57CC8);
  }
  *a3 = 0;
  v6 = 0;
  v7 = 16i64;
  do
  {
    v8 = *a1++;
    v6 = v8 ^ (-2128831035 * v6);
    --v7;
  }
  while ( v7 );
  v9 = v6;
  v10 = sub_49034(qword_5D4B0, v6, a2, &v13);
  if ( v13 )
  {
    v11 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Cu, (__int64)&unk_57CC8, v9);
      v11 = off_5A148;
    }
    *a3 = 5;
    v10 = 0i64;
  }
  else
  {
    v11 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x2Bu, (__int64)&unk_57CC8, v9);
      v11 = off_5A148;
    }
    *a3 = 0;
  }
  if ( v11 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v11->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(v11->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v11->DeviceLock.Header.Lock, 0x2Du, (__int64)&unk_57CC8);
  }
  return v10;
}

//----- (000000000003BF50) ----------------------------------------------------
__int64 __fastcall sub_3BF50(ULONG_PTR BugCheckParameter1)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x32u, (__int64)&unk_57CC8);
    v2 = off_5A148;
  }
  if ( BugCheckParameter1 )
  {
    sub_49CF0(qword_5D4B0, BugCheckParameter1);
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v2->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(v2->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->DeviceLock.Header.Lock, 0x33u, (__int64)&unk_57CC8);
  }
  return 0i64;
}

//----- (000000000003C004) ----------------------------------------------------
__int64 __fastcall sub_3C004(__int64 a1, const void *a2, int a3)
{
  unsigned int v6; // eax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x34u, (__int64)&unk_57CC8);
  }
  sub_3D310((PFAST_MUTEX)(a1 + 288));
  sub_53BD8((void *)(a1 + 17), 0x100ui64, a2, 0x100ui64);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_3B178(
      *(_QWORD *)&off_5A148->DeviceLock.Header.Lock,
      0x35u,
      (__int64)&unk_57CC8,
      (const char *)(a1 + 17),
      (const char *)a2);
  }
  ++*(_DWORD *)(a1 + 344);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x36u, (__int64)&unk_57CC8, *(_DWORD *)(a1 + 344));
  }
  *(_QWORD *)(a1 + 352) = MEMORY[0xFFFFF78000000014];
  *(_DWORD *)(a1 + 276) = a3 * sub_4535C(0x201302Du);
  v6 = sub_4535C(0x201302Eu);
  if ( *(_DWORD *)(a1 + 276) < v6 )
    *(_DWORD *)(a1 + 276) = v6;
  sub_3D3DC((PFAST_MUTEX)(a1 + 288));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x37u, (__int64)&unk_57CC8);
  }
  return 0i64;
}

//----- (000000000003C1B8) ----------------------------------------------------
__int64 sub_3C1B8()
{
  int v0; // eax
  __int64 v1; // r8
  __int64 v2; // r11
  int v3; // eax
  __int64 v4; // rbx
  int v5; // eax
  int v6; // eax
  PDEVICE_OBJECT v7; // rcx
  int v9; // [rsp+40h] [rbp+8h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+48h] [rbp+10h] BYREF

  BugCheckParameter1 = 0i64;
  v9 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x38u, (__int64)&unk_57CC8);
  }
  v0 = sub_487F8(qword_5D4B0, &v9);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x39u, (__int64)&unk_57CC8, v0);
  }
  v2 = sub_49870(qword_5D4B0, &BugCheckParameter1, &v9);
  if ( v2 )
  {
    do
    {
      v4 = *(_QWORD *)(v2 + 280);
      if ( (MEMORY[0xFFFFF78000000014] - *(_QWORD *)(v2 + 352)) / 10000i64 > (unsigned __int64)(unsigned int)(1000 * *(_DWORD *)(v2 + 276)) )
      {
        LOBYTE(v1) = 1;
        sub_48DB0(qword_5D4B0, BugCheckParameter1, v1, &v9);
        if ( v9 )
        {
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
            && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 2u )
          {
            v5 = sub_4A538(v9);
            sub_17BF0(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Bu, (__int64)&unk_57CC8, v5);
          }
        }
        else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
               && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
               && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Cu, (__int64)&unk_57CC8, v4);
        }
      }
      LOBYTE(v1) = 1;
      v2 = sub_49A3C(qword_5D4B0, &BugCheckParameter1, v1, &v9);
    }
    while ( v2 );
  }
  else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
         && (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
         && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 5u )
  {
    v3 = sub_4A538(v9);
    sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Au, (__int64)&unk_57CC8, v3);
  }
  v6 = sub_487F8(qword_5D4B0, &v9);
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceLock.Header.WaitListHead.Blink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceLock.Header.WaitListHead.Blink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->DeviceLock.Header.Lock, 0x3Du, (__int64)&unk_57CC8, v6);
      v7 = off_5A148;
    }
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v7->DeviceLock.Header.WaitListHead.Blink + 1, 0x18u)
      && BYTE1(v7->DeviceLock.Header.WaitListHead.Blink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v7->DeviceLock.Header.Lock, 0x3Eu, (__int64)&unk_57CC8);
    }
  }
  return 0i64;
}
// 3C32C: variable 'v1' is possibly undefined

//----- (000000000003C46C) ----------------------------------------------------
__int64 __fastcall sub_3C46C(__int64 a1, unsigned __int16 a2)
{
  strlen(aUnknownModule);
  return qword_5A1B8(a1, 43i64, &unk_57CB8, a2, aUnknownModule);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003C4EC) ----------------------------------------------------
PVOID __fastcall sub_3C4EC(int a1, unsigned int a2, ULONG a3)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0xAu);
  }
  return sub_3DA88(a1, a2, a3);
}

//----- (000000000003C570) ----------------------------------------------------
void __fastcall sub_3C570(PVOID P, ULONG Tag)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0xBu);
  }
  sub_3DBA4(P, Tag);
}

//----- (000000000003C5E4) ----------------------------------------------------
PVOID __fastcall sub_3C5E4(int a1, void *a2, unsigned int a3, unsigned int a4, ULONG Tag)
{
  size_t v6; // r12
  PDEVICE_OBJECT v9; // rcx
  PVOID v10; // rax
  PVOID v11; // rbx

  v6 = a3;
  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 4) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0xCu);
      v9 = off_5A148;
    }
    if ( v9 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( (BYTE4(v9->Queue.Wcb.DeviceRoutine) & 2) != 0 && BYTE1(v9->Queue.Wcb.DeviceRoutine) >= 4u )
      {
        sub_11088((__int64)v9->Queue.ListEntry.Blink, 0x10u, (__int64)&unk_57CA8);
        v9 = off_5A148;
      }
      if ( v9 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v9->Queue.Wcb.DeviceRoutine) & 4) != 0
        && BYTE1(v9->Queue.Wcb.DeviceRoutine) >= 6u )
      {
        sub_3D95C((__int64)v9->Queue.ListEntry.Blink, 17i64, (__int64)&unk_57CA8, (int)a2);
      }
    }
  }
  v10 = sub_3DA88(a1, a4, Tag);
  v11 = v10;
  if ( v10 && a2 )
  {
    memmove(v10, a2, v6);
    sub_3DBA4(a2, Tag);
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x12u, (__int64)&unk_57CA8, (int)v11);
  }
  return v11;
}

//----- (000000000003C76C) ----------------------------------------------------
char *__fastcall sub_3C76C(int a1, unsigned int a2, ULONG a3)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0xDu);
  }
  return sub_3DC9C(a1, a2, a3);
}

//----- (000000000003C7F0) ----------------------------------------------------
void __fastcall sub_3C7F0(PVOID P)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 4) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0xEu);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0 && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
      {
        sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x16u, (__int64)&unk_57CA8);
        v2 = off_5A148;
      }
      if ( v2 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 4) != 0
        && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x17u, (__int64)&unk_57CA8);
      }
    }
  }
  if ( *(_DWORD *)P == 2 )
  {
    ExDeleteNPagedLookasideList((PNPAGED_LOOKASIDE_LIST)((char *)P + 64));
  }
  else if ( *(_DWORD *)P == 1 )
  {
    ExDeletePagedLookasideList((PPAGED_LOOKASIDE_LIST)((char *)P + 64));
  }
  sub_3DBA4(P, *((_DWORD *)P + 2));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x18u, (__int64)&unk_57CA8);
  }
}

//----- (000000000003C910) ----------------------------------------------------
_DWORD *__fastcall sub_3C910(__int64 a1)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0xFu);
  }
  return sub_3DE50(a1);
}

//----- (000000000003C978) ----------------------------------------------------
void __fastcall sub_3C978(__int64 a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  struct _SLIST_ENTRY *v5; // rdi

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 4) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x10u);
      v4 = off_5A148;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)v4->Queue.ListEntry.Blink, 0x1Bu, (__int64)&unk_57CA8);
      v4 = off_5A148;
    }
  }
  v5 = (struct _SLIST_ENTRY *)(a2 - 4);
  if ( LODWORD(v5->Next) )
  {
    if ( LODWORD(v5->Next) == 1 )
    {
      sub_3DBA4(v5, *(_DWORD *)(a1 + 8));
LABEL_18:
      v4 = off_5A148;
      goto LABEL_19;
    }
  }
  else if ( *(_DWORD *)a1 == 2 || *(_DWORD *)a1 == 1 )
  {
    ++*(_DWORD *)(a1 + 92);
    if ( ExQueryDepthSList((PSLIST_HEADER)(a1 + 64)) < *(_WORD *)(a1 + 80) )
    {
      ExpInterlockedPushEntrySList((PSLIST_HEADER)(a1 + 64), v5);
    }
    else
    {
      ++*(_DWORD *)(a1 + 96);
      (*(void (__fastcall **)(struct _SLIST_ENTRY *))(a1 + 120))(v5);
    }
    goto LABEL_18;
  }
LABEL_19:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)v4->Queue.ListEntry.Blink, 0x1Cu, (__int64)&unk_57CA8);
  }
}

//----- (000000000003CAA4) ----------------------------------------------------
__int64 __fastcall sub_3CAA4(PERESOURCE Resource)
{
  PDEVICE_OBJECT v2; // rcx
  int v3; // eax
  unsigned int v4; // ebx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x12u);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x1Fu, (__int64)&unk_57CA8);
    }
  }
  v3 = ExInitializeResourceLite(Resource);
  v4 = v3;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x20u, (__int64)&unk_57CA8, v3);
  }
  return v4;
}

//----- (000000000003CB78) ----------------------------------------------------
__int64 __fastcall sub_3CB78(PERESOURCE Resource)
{
  PDEVICE_OBJECT v2; // rcx
  int v3; // eax
  unsigned int v4; // ebx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x13u);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x21u, (__int64)&unk_57CA8);
    }
  }
  v3 = ExDeleteResourceLite(Resource);
  v4 = v3;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x22u, (__int64)&unk_57CA8, v3);
  }
  return v4;
}

//----- (000000000003CC4C) ----------------------------------------------------
BOOLEAN __fastcall sub_3CC4C(PERESOURCE Resource)
{
  PDEVICE_OBJECT v2; // rcx
  BOOLEAN v3; // al
  BOOLEAN v4; // bl

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x15u);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x25u, (__int64)&unk_57CA8);
    }
  }
  v3 = ExAcquireResourceExclusiveLite(Resource, 1u);
  v4 = v3;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x26u, (__int64)&unk_57CA8, v3);
  }
  return v4;
}

//----- (000000000003CD24) ----------------------------------------------------
BOOLEAN __fastcall sub_3CD24(PERESOURCE Resource)
{
  PDEVICE_OBJECT v2; // rcx
  BOOLEAN v3; // al
  BOOLEAN v4; // bl

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x16u);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x27u, (__int64)&unk_57CA8);
    }
  }
  v3 = ExAcquireResourceSharedLite(Resource, 1u);
  v4 = v3;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x28u, (__int64)&unk_57CA8, v3);
  }
  return v4;
}

//----- (000000000003CDFC) ----------------------------------------------------
void __fastcall sub_3CDFC(PERESOURCE Resource)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x18u);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x2Bu, (__int64)&unk_57CA8);
    }
  }
  ExReleaseResourceLite(Resource);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x2Cu, (__int64)&unk_57CA8);
  }
}

//----- (000000000003CEC8) ----------------------------------------------------
__int64 __fastcall sub_3CEC8(_QWORD *a1)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x1Au);
  }
  return sub_3DF54(a1);
}

//----- (000000000003CF30) ----------------------------------------------------
void __fastcall sub_3CF30(PKSPIN_LOCK SpinLock, KIRQL *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x1Bu);
  }
  sub_3DFD8(SpinLock, a2);
}

//----- (000000000003CFA8) ----------------------------------------------------
void __fastcall sub_3CFA8(PKSPIN_LOCK SpinLock, KIRQL a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x1Cu);
  }
  sub_3E090(SpinLock, a2);
}

//----- (000000000003D01C) ----------------------------------------------------
bool __fastcall sub_3D01C(struct _KEVENT **a1, char a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x1Du);
  }
  return sub_3E134(a1, a2);
}

//----- (000000000003D094) ----------------------------------------------------
void __fastcall sub_3D094(PVOID P)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x1Eu);
  }
  sub_3E21C(P);
}

//----- (000000000003D0FC) ----------------------------------------------------
int __fastcall sub_3D0FC(PRKEVENT Event)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x1Fu);
  }
  return sub_3E2B4(Event);
}

//----- (000000000003D164) ----------------------------------------------------
int __fastcall sub_3D164(PRKEVENT Event)
{
  PDEVICE_OBJECT v2; // rcx
  int result; // eax

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x20u);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x3Bu, (__int64)&unk_57CA8);
    }
  }
  result = KeResetEvent(Event);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    result = sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x3Cu, (__int64)&unk_57CA8);
  }
  return result;
}

//----- (000000000003D230) ----------------------------------------------------
void __fastcall sub_3D230(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x21u);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x3Du, (__int64)&unk_57CA8);
    }
  }
  *(_QWORD *)(a1 + 8) = 0i64;
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)a1 = 1;
  KeInitializeEvent((PRKEVENT)(a1 + 24), SynchronizationEvent, 0);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x3Eu, (__int64)&unk_57CA8);
  }
}

//----- (000000000003D310) ----------------------------------------------------
void __fastcall sub_3D310(PFAST_MUTEX FastMutex)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x22u);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x3Fu, (__int64)&unk_57CA8);
    }
  }
  ExAcquireFastMutex(FastMutex);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x40u, (__int64)&unk_57CA8);
  }
}

//----- (000000000003D3DC) ----------------------------------------------------
void __fastcall sub_3D3DC(PFAST_MUTEX FastMutex)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x24u);
      v2 = off_5A148;
    }
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x43u, (__int64)&unk_57CA8);
    }
  }
  ExReleaseFastMutex(FastMutex);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x44u, (__int64)&unk_57CA8);
  }
}

//----- (000000000003D4A8) ----------------------------------------------------
__int64 __fastcall sub_3D4A8(unsigned int a1)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x2Bu);
  }
  return sub_3E8E8(a1, 0);
}

//----- (000000000003D510) ----------------------------------------------------
__int64 __fastcall sub_3D510(PVOID P)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x2Du);
  }
  return sub_3EB9C(P);
}

//----- (000000000003D584) ----------------------------------------------------
_QWORD *__fastcall sub_3D584(__int64 a1, int a2, __int64 a3, __int64 a4)
{
  PDEVICE_OBJECT v8; // rcx
  _QWORD *v9; // rbx
  _QWORD *v10; // rdi
  unsigned int v11; // ebp

  v8 = off_5A148;
  v9 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x2Eu);
    v8 = off_5A148;
  }
  v10 = 0i64;
  v11 = a2 + 40;
  if ( v8 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v8->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v8->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)v8->Queue.ListEntry.Blink, 0x68u, (__int64)&unk_57CA8);
    v8 = off_5A148;
  }
  if ( a1 && a3 && a2 )
  {
    v10 = sub_3DA88(2, v11, 0x6E635749u);
LABEL_17:
    if ( v10 )
    {
      memset(v10, 0, v11);
      v10[1] = v10;
      *v10 = v10;
      v10[3] = a3;
      v10[4] = a4;
      v10[2] = a1;
      v9 = v10 + 5;
    }
    v8 = off_5A148;
    goto LABEL_20;
  }
  if ( v8 == (PDEVICE_OBJECT)&off_5A148 )
    return v9;
  if ( SBYTE4(v8->Queue.Wcb.DeviceRoutine) < 0 && BYTE1(v8->Queue.Wcb.DeviceRoutine) >= 3u )
  {
    sub_11088((__int64)v8->Queue.ListEntry.Blink, 0x69u, (__int64)&unk_57CA8);
    goto LABEL_17;
  }
LABEL_20:
  if ( v8 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v8->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v8->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)v8->Queue.ListEntry.Blink, 0x6Au, (__int64)&unk_57CA8, (int)v9);
  }
  return v9;
}

//----- (000000000003D714) ----------------------------------------------------
void __fastcall sub_3D714(__int64 a1)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x2Fu);
  }
  sub_3EEF8(a1, 0);
}

//----- (000000000003D780) ----------------------------------------------------
void __fastcall sub_3D780(__int64 a1)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x30u);
  }
  sub_3EFBC(a1, 0);
}

//----- (000000000003D7EC) ----------------------------------------------------
void __fastcall sub_3D7EC(__int64 a1, unsigned int a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x31u);
  }
  sub_3EFBC(a1, a2);
}

//----- (000000000003D860) ----------------------------------------------------
__int64 __fastcall sub_3D860(PVOID Object)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 0x20) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_3C46C((__int64)off_5A148->Queue.ListEntry.Blink, 0x32u);
  }
  return sub_3F0C8(Object);
}

//----- (000000000003D8CC) ----------------------------------------------------
__int64 __fastcall sub_3D8CC(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+B8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57CA8, 14i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003D95C) ----------------------------------------------------
__int64 __fastcall sub_3D95C(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+C8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57CA8, 17i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003D9F8) ----------------------------------------------------
__int64 __fastcall sub_3D9F8(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+B8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57CA8, 11i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003DA88) ----------------------------------------------------
PVOID __fastcall sub_3DA88(int a1, unsigned int a2, ULONG a3)
{
  SIZE_T v4; // rdi
  PDEVICE_OBJECT v6; // rcx
  PVOID v7; // rax
  PVOID v8; // rbx

  v4 = a2;
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xAu, (__int64)&unk_57CA8);
      v6 = off_5A148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v6->Queue.Wcb.DeviceRoutine) & 4) != 0
      && BYTE1(v6->Queue.Wcb.DeviceRoutine) >= 6u )
    {
      sub_3D9F8((__int64)v6->Queue.ListEntry.Blink, 11i64, (__int64)&unk_57CA8, v4);
    }
  }
  v7 = ExAllocatePoolWithTag((POOL_TYPE)(a1 != 2), v4, a3);
  v8 = v7;
  if ( v7 )
    memset(v7, 0, v4);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0xCu, (__int64)&unk_57CA8, (int)v8);
  }
  return v8;
}

//----- (000000000003DBA4) ----------------------------------------------------
void __fastcall sub_3DBA4(PVOID P, ULONG Tag)
{
  PDEVICE_OBJECT v4; // rcx

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xDu, (__int64)&unk_57CA8);
      v4 = off_5A148;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 4) != 0
      && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 6u )
    {
      sub_3D8CC((__int64)v4->Queue.ListEntry.Blink, 14i64, (__int64)&unk_57CA8, (int)P);
      v4 = off_5A148;
    }
  }
  if ( P )
  {
    ExFreePoolWithTag(P, Tag);
    v4 = off_5A148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)v4->Queue.ListEntry.Blink, 0xFu, (__int64)&unk_57CA8);
  }
}

//----- (000000000003DC9C) ----------------------------------------------------
char *__fastcall sub_3DC9C(int a1, unsigned int a2, ULONG a3)
{
  __int64 v4; // rsi
  char *v5; // rbx
  PDEVICE_OBJECT v7; // rcx
  bool v8; // dl
  char *v9; // rax

  v4 = a2;
  v5 = 0i64;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x13u, (__int64)&unk_57CA8);
    v7 = off_5A148;
  }
  v8 = (_DWORD)v4 != 0;
  if ( a1 != 2 && a1 != 1 )
    v8 = 0;
  if ( v8 )
  {
    v9 = (char *)sub_3DA88(2, 0xC0u, a3);
    v5 = v9;
    if ( v9 )
    {
      memset(v9, 0, 0xC0ui64);
      *((_DWORD *)v5 + 1) = v4;
      *(_DWORD *)v5 = a1;
      *((_DWORD *)v5 + 2) = a3;
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 4) != 0
        && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x14u, (__int64)&unk_57CA8);
        v7 = off_5A148;
      }
      if ( *(_DWORD *)v5 == 2 )
      {
        ExInitializeNPagedLookasideList((PNPAGED_LOOKASIDE_LIST)(v5 + 64), 0i64, 0i64, 0, v4 + 7, a3, 0);
        v7 = off_5A148;
      }
      if ( *(_DWORD *)v5 == 1 )
      {
        ExInitializePagedLookasideList((PPAGED_LOOKASIDE_LIST)(v5 + 64), 0i64, 0i64, 0, v4 + 7, a3, 0);
        v7 = off_5A148;
      }
    }
    else
    {
      v7 = off_5A148;
    }
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v7->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)v7->Queue.ListEntry.Blink, 0x15u, (__int64)&unk_57CA8, (int)v5);
  }
  return v5;
}

//----- (000000000003DE50) ----------------------------------------------------
_DWORD *__fastcall sub_3DE50(__int64 a1)
{
  _DWORD *v2; // rbx
  _DWORD *v3; // rax

  v2 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x19u, (__int64)&unk_57CA8);
  }
  if ( (*(_DWORD *)a1 == 2 || *(_DWORD *)a1 == 1)
    && ((++*(_DWORD *)(a1 + 84), (v3 = ExpInterlockedPopEntrySList((PSLIST_HEADER)(a1 + 64))) != 0i64)
     || (++*(_DWORD *)(a1 + 88),
         (v3 = (_DWORD *)(*(__int64 (__fastcall **)(_QWORD, _QWORD, _QWORD))(a1 + 112))(
                           *(unsigned int *)(a1 + 100),
                           *(unsigned int *)(a1 + 108),
                           *(unsigned int *)(a1 + 104))) != 0i64)) )
  {
    *v3 = 0;
  }
  else
  {
    v3 = sub_3DA88(*(_DWORD *)a1, *(_DWORD *)(a1 + 4) + 7, *(_DWORD *)(a1 + 8));
    if ( !v3 )
      goto LABEL_14;
    *v3 = 1;
  }
  v2 = v3 + 1;
  if ( v3 != (_DWORD *)-4i64 )
    memset(v3 + 1, 0, *(unsigned int *)(a1 + 4));
LABEL_14:
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x1Au, (__int64)&unk_57CA8, (int)v2);
  }
  return v2;
}

//----- (000000000003DF54) ----------------------------------------------------
__int64 __fastcall sub_3DF54(_QWORD *a1)
{
  __int64 result; // rax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    result = sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x2Fu, (__int64)&unk_57CA8);
  }
  *a1 = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    result = sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x30u, (__int64)&unk_57CA8);
  }
  return result;
}

//----- (000000000003DFD8) ----------------------------------------------------
void __fastcall sub_3DFD8(PKSPIN_LOCK SpinLock, KIRQL *a2)
{
  unsigned __int8 v4; // si

  v4 = KeGetCurrentIrql();
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x31u, (__int64)&unk_57CA8);
  }
  if ( v4 == 2 )
  {
    *a2 = 2;
    KeAcquireSpinLockAtDpcLevel(SpinLock);
  }
  else
  {
    *a2 = KeAcquireSpinLockRaiseToDpc(SpinLock);
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x32u, (__int64)&unk_57CA8);
  }
}

//----- (000000000003E090) ----------------------------------------------------
void __fastcall sub_3E090(PKSPIN_LOCK SpinLock, KIRQL a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x33u, (__int64)&unk_57CA8);
  }
  if ( a2 == 2 )
    KeReleaseSpinLockFromDpcLevel(SpinLock);
  else
    KeReleaseSpinLock(SpinLock, a2);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x34u, (__int64)&unk_57CA8);
  }
}

//----- (000000000003E134) ----------------------------------------------------
bool __fastcall sub_3E134(struct _KEVENT **a1, char a2)
{
  struct _KEVENT *v4; // rax
  struct _KEVENT *v5; // rdi

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x35u, (__int64)&unk_57CA8);
  }
  *a1 = 0i64;
  v4 = (struct _KEVENT *)sub_3DA88(2, 0x18u, 0x6E634556u);
  v5 = v4;
  if ( v4 )
  {
    KeInitializeEvent(v4, (EVENT_TYPE)(a2 == 0), 0);
    *a1 = v5;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x36u, (__int64)&unk_57CA8, v5 != 0i64);
  }
  return v5 != 0i64;
}

//----- (000000000003E21C) ----------------------------------------------------
void __fastcall sub_3E21C(PVOID P)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x37u, (__int64)&unk_57CA8);
  }
  KeClearEvent((PRKEVENT)P);
  sub_3DBA4(P, 0x6E634556u);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x38u, (__int64)&unk_57CA8);
  }
}

//----- (000000000003E2B4) ----------------------------------------------------
int __fastcall sub_3E2B4(PRKEVENT Event)
{
  int result; // eax

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x39u, (__int64)&unk_57CA8);
  }
  result = KeSetEvent(Event, 0, 0);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    result = sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x3Au, (__int64)&unk_57CA8);
  }
  return result;
}

//----- (000000000003E344) ----------------------------------------------------
void __fastcall HandleInformation(PVOID StartContext)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x49u, (__int64)&unk_57CA8);
  }
  (*(void (__fastcall **)(_QWORD))StartContext)(*((_QWORD *)StartContext + 1));
  sub_3DBA4(StartContext, 0x6E635448u);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x4Au, (__int64)&unk_57CA8);
  }
  PsTerminateSystemThread(0);
}

//----- (000000000003E3E0) ----------------------------------------------------
unsigned __int8 __fastcall sub_3E3E0(PVOID *Object, __int64 a2, __int64 (__fastcall *a3)(void ***a1))
{
  unsigned __int8 v5; // bl
  __int64 (__fastcall **v6)(void ***); // rax
  __int64 (__fastcall **StartContext)(void ***); // rsi
  struct _OBJECT_ATTRIBUTES ObjectAttributes; // [rsp+40h] [rbp-48h] BYREF
  void *ThreadHandle; // [rsp+90h] [rbp+8h] BYREF

  v5 = 1;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x4Bu, (__int64)&unk_57CA8);
  }
  v6 = (__int64 (__fastcall **)(void ***))sub_3DA88(2, 0x10u, 0x6E635448u);
  *Object = 0i64;
  StartContext = v6;
  if ( !v6 )
    goto LABEL_10;
  memset(&ObjectAttributes.RootDirectory, 0, 0x28ui64);
  ThreadHandle = 0i64;
  *StartContext = sub_3E5DC;
  ObjectAttributes.Length = 48;
  StartContext[1] = a3;
  if ( !PsCreateSystemThread(
          &ThreadHandle,
          0x1F03FFu,
          &ObjectAttributes,
          0i64,
          0i64,
          (PKSTART_ROUTINE)HandleInformation,
          StartContext) )
  {
    ObReferenceObjectByHandle(ThreadHandle, 0, 0i64, 0, Object, 0i64);
    ZwClose(ThreadHandle);
  }
  if ( !*Object )
  {
    sub_3DBA4(StartContext, 0x6E635448u);
LABEL_10:
    v5 = 0;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x4Cu, (__int64)&unk_57CA8, v5);
  }
  return v5;
}

//----- (000000000003E548) ----------------------------------------------------
__int64 __fastcall sub_3E548(PVOID Object)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 result; // rax

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    result = sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x4Du, (__int64)&unk_57CA8);
    v2 = off_5A148;
  }
  if ( Object )
  {
    result = ObfDereferenceObject(Object);
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    result = sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x4Eu, (__int64)&unk_57CA8);
  }
  return result;
}

//----- (000000000003E5DC) ----------------------------------------------------
__int64 __fastcall sub_3E5DC(void ***a1)
{
  void **v1; // r12
  __int64 v2; // rdi
  void *v4; // rax
  ULONG v5; // er14
  void *v6; // rdx
  PDEVICE_OBJECT v7; // r10
  unsigned int v8; // ebp
  __int64 v9; // rsi
  __int64 v10; // r13
  __int64 v11; // rsi
  _QWORD **v12; // rcx
  _QWORD *v13; // rbx
  _QWORD *v14; // rax
  char *v15; // rcx
  void (__fastcall *v16)(_QWORD *); // rax
  __int64 result; // rax
  PDEVICE_OBJECT v18; // rcx
  PVOID v19[2]; // [rsp+30h] [rbp-48h] BYREF
  __int64 v20; // [rsp+40h] [rbp-38h]
  KIRQL v21; // [rsp+80h] [rbp+8h] BYREF

  v1 = *a1;
  v2 = *((int *)a1 + 2);
  v4 = **a1;
  v5 = 2;
  v21 = 0;
  v19[0] = v4;
  v6 = (void *)*((_QWORD *)v1[3] + 3);
  v20 = 0i64;
  v19[1] = v6;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x53u, (__int64)&unk_57CA8);
    v7 = off_5A148;
  }
  if ( *((_BYTE *)v1 + 12) )
  {
    v5 = 3;
    v20 = *((_QWORD *)v1[3] + 4 * (unsigned int)v2 + 3);
  }
  if ( a1[2] )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v7->Queue.Wcb.DeviceRoutine) < 0
      && BYTE1(v7->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_13EA4((__int64)v7->Queue.ListEntry.Blink, 0x54u, (__int64)&unk_57CA8, v2);
    }
    sub_3E2B4((PRKEVENT)a1[2]);
  }
  while ( 1 )
  {
    result = sub_3F170(v5, v19);
    if ( !(_DWORD)result )
      break;
    v8 = 0;
    v9 = 0i64;
    if ( (_DWORD)result == 2 )
    {
      v8 = v2;
      v9 = v2;
    }
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
      && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x56u, (__int64)&unk_57CA8, v2);
    }
    v10 = 32i64 * v8;
    sub_3DFD8((PKSPIN_LOCK)((char *)v1[3] + v10), &v21);
    v11 = 32 * v9;
    v12 = (_QWORD **)((char *)v1[3] + v11 + 8);
    v13 = 0i64;
    if ( *v12 != v12 )
    {
      v13 = *v12;
      v14 = (_QWORD *)**v12;
      *v12 = v14;
      v14[1] = v12;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
        && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_184C0((__int64)off_5A148->Queue.ListEntry.Blink, 0x57u, (__int64)&unk_57CA8, v2);
      }
      v15 = (char *)v1[3];
      if ( *(char **)&v15[v11 + 8] != &v15[v11 + 8] )
        sub_3E2B4(*(PRKEVENT *)&v15[v11 + 24]);
    }
    sub_3E090((PKSPIN_LOCK)((char *)v1[3] + v10), v21);
    if ( v13 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
        && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_184C0((__int64)off_5A148->Queue.ListEntry.Blink, 0x58u, (__int64)&unk_57CA8, v2);
      }
      v16 = (void (__fastcall *)(_QWORD *))v13[3];
      if ( v16 )
        v16(v13 + 5);
      sub_3EEF8((__int64)(v13 + 5), 0);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
        && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_184C0((__int64)off_5A148->Queue.ListEntry.Blink, 0x59u, (__int64)&unk_57CA8, v2);
      }
    }
  }
  v18 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      result = sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x55u, (__int64)&unk_57CA8, v2);
      v18 = off_5A148;
    }
    if ( v18 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v18->Queue.Wcb.DeviceRoutine) & 2) != 0
      && BYTE1(v18->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      result = sub_11088((__int64)v18->Queue.ListEntry.Blink, 0x5Au, (__int64)&unk_57CA8);
    }
  }
  return result;
}

//----- (000000000003E8E8) ----------------------------------------------------
__int64 __fastcall sub_3E8E8(unsigned int a1, char a2)
{
  __int64 v3; // r12
  int v4; // esi
  __int64 v5; // r14
  PVOID v6; // rax
  __int64 v7; // rdi
  unsigned int v8; // ebx
  PVOID v9; // rax
  _QWORD *v10; // r11
  __int64 v11; // r13
  unsigned int v12; // ebp
  __int64 v13; // rbx
  _QWORD *v14; // rax
  __int64 v16; // [rsp+30h] [rbp-48h] BYREF
  unsigned int v17; // [rsp+38h] [rbp-40h]
  PVOID P; // [rsp+40h] [rbp-38h] BYREF

  v3 = a1;
  v4 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x5Bu, (__int64)&unk_57CA8);
  }
  v5 = 32i64;
  v6 = sub_3DA88(2, 0x20u, 0x6E635450u);
  v7 = (__int64)v6;
  if ( !v6 )
    goto LABEL_24;
  memset(v6, 0, 0x20ui64);
  sub_3E134((struct _KEVENT **)v7, 1);
  *(_DWORD *)(v7 + 8) = v3;
  *(_BYTE *)(v7 + 12) = a2;
  *(_QWORD *)(v7 + 16) = sub_3DA88(2, 8 * (int)v3, 0x6E635450u);
  v8 = a2 ? 32 * (v3 + 1) : 32;
  v9 = sub_3DA88(2, v8, 0x6E635450u);
  *(_QWORD *)(v7 + 24) = v9;
  if ( *(_QWORD *)(v7 + 16) && v9 )
  {
    v16 = v7;
    sub_3E134((struct _KEVENT **)&P, 0);
    memset(*(void **)(v7 + 16), 0, 8 * v3);
    memset(*(void **)(v7 + 24), 0, v8);
    sub_3DF54(*(_QWORD **)(v7 + 24));
    sub_3E134((struct _KEVENT **)(*(_QWORD *)(v7 + 24) + 24i64), 0);
    v10 = (_QWORD *)(*(_QWORD *)(v7 + 24) + 8i64);
    v10[1] = v10;
    *v10 = v10;
    if ( (_DWORD)v3 )
    {
      v11 = 0i64;
      v12 = 1;
      while ( 1 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
          && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_184C0((__int64)off_5A148->Queue.ListEntry.Blink, 0x5Cu, (__int64)&unk_57CA8, v12);
        }
        v17 = v12;
        if ( a2 )
        {
          v13 = 32i64 * v12;
          sub_3DF54((_QWORD *)(v13 + *(_QWORD *)(v7 + 24)));
          sub_3E134((struct _KEVENT **)(v13 + *(_QWORD *)(v7 + 24) + 24), 0);
          v14 = (_QWORD *)(v5 + *(_QWORD *)(v7 + 24) + 8);
          v14[1] = v14;
          *v14 = v14;
        }
        sub_3E3E0(
          (PVOID *)(*(_QWORD *)(v7 + 16) + 8i64 * (v12 - 1)),
          (__int64)sub_3E5DC,
          (__int64 (__fastcall *)(void ***))&v16);
        if ( !*(_QWORD *)(v11 + *(_QWORD *)(v7 + 16)) )
          break;
        sub_3F0C8(P);
        ++v12;
        v5 += 32i64;
        v11 += 8i64;
        if ( v12 - 1 >= (unsigned int)v3 )
          goto LABEL_23;
      }
      v4 = -16777213;
    }
LABEL_23:
    sub_3E21C(P);
  }
  else
  {
LABEL_24:
    v4 = -16777213;
  }
  if ( v4 && v7 )
  {
    sub_3EB9C((PVOID)v7);
    v7 = 0i64;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x5Du, (__int64)&unk_57CA8, v7);
  }
  return v7;
}

//----- (000000000003EB9C) ----------------------------------------------------
__int64 __fastcall sub_3EB9C(PVOID P)
{
  PDEVICE_OBJECT v2; // rcx
  unsigned int v3; // eax
  __int64 v4; // rsi
  __int64 v5; // rbp
  __int64 v6; // r12
  PDEVICE_OBJECT v7; // rcx
  __int64 v8; // rdx
  _QWORD **v9; // rcx
  _QWORD *v10; // rdi
  _QWORD *v11; // rax
  unsigned int v12; // esi
  __int64 v13; // rdi
  __int64 v14; // rbp
  KIRQL v16; // [rsp+50h] [rbp+8h] BYREF

  v16 = 0;
  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x5Eu, (__int64)&unk_57CA8);
    v2 = off_5A148;
  }
  if ( *((_BYTE *)P + 12) )
    v3 = *((_DWORD *)P + 2) + 1;
  else
    v3 = 1;
  if ( v3 )
  {
    v4 = 0i64;
    v5 = 0i64;
    v6 = v3;
    do
    {
      sub_3DFD8((PKSPIN_LOCK)(v5 + *((_QWORD *)P + 3)), &v16);
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
        && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x5Fu, (__int64)&unk_57CA8);
        v7 = off_5A148;
      }
      v8 = *((_QWORD *)P + 3);
      if ( *(_QWORD *)(v4 + v8 + 8) != v4 + v8 + 8 )
      {
        do
        {
          v9 = (_QWORD **)(v4 + v8 + 8);
          v10 = *v9;
          v11 = (_QWORD *)**v9;
          *v9 = v11;
          v11[1] = v9;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
            && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
          {
            sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x60u, (__int64)&unk_57CA8, (int)v10);
          }
          sub_3EEF8((__int64)(v10 + 5), 1);
          v8 = *((_QWORD *)P + 3);
        }
        while ( *(_QWORD *)(v4 + v8 + 8) != v4 + v8 + 8 );
        v7 = off_5A148;
      }
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(v7->Queue.Wcb.DeviceRoutine) < 0
        && BYTE1(v7->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_11088((__int64)v7->Queue.ListEntry.Blink, 0x61u, (__int64)&unk_57CA8);
      }
      sub_3E090((PKSPIN_LOCK)(v5 + *((_QWORD *)P + 3)), v16);
      v5 += 32i64;
      v4 += 32i64;
      --v6;
    }
    while ( v6 );
    v2 = off_5A148;
  }
  if ( *(_QWORD *)P )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v2->Queue.Wcb.DeviceRoutine) < 0
      && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x62u, (__int64)&unk_57CA8);
    }
    sub_3E2B4(*(PRKEVENT *)P);
    v2 = off_5A148;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v2->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_13EA4((__int64)v2->Queue.ListEntry.Blink, 0x63u, (__int64)&unk_57CA8, *((_DWORD *)P + 2));
    v2 = off_5A148;
  }
  v12 = 0;
  if ( *((_DWORD *)P + 2) )
  {
    v13 = 0i64;
    v14 = 32i64;
    do
    {
      if ( *(_QWORD *)(v13 + *((_QWORD *)P + 2)) )
      {
        if ( v2 != (PDEVICE_OBJECT)&off_5A148
          && SBYTE4(v2->Queue.Wcb.DeviceRoutine) < 0
          && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_13EA4((__int64)v2->Queue.ListEntry.Blink, 0x64u, (__int64)&unk_57CA8, v12);
        }
        sub_3F0C8(*(PVOID *)(v13 + *((_QWORD *)P + 2)));
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && SBYTE4(off_5A148->Queue.Wcb.DeviceRoutine) < 0
          && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
        {
          sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x65u, (__int64)&unk_57CA8, v12);
        }
        sub_3E548(*(PVOID *)(v13 + *((_QWORD *)P + 2)));
        *(_QWORD *)(v13 + *((_QWORD *)P + 2)) = 0i64;
        if ( *((_BYTE *)P + 12) )
          sub_3E21C(*(PVOID *)(*((_QWORD *)P + 3) + v14 + 24));
        v2 = off_5A148;
      }
      ++v12;
      v14 += 32i64;
      v13 += 8i64;
    }
    while ( v12 < *((_DWORD *)P + 2) );
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v2->Queue.Wcb.DeviceRoutine) < 0
    && BYTE1(v2->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_11088((__int64)v2->Queue.ListEntry.Blink, 0x66u, (__int64)&unk_57CA8);
  }
  sub_3E21C(*(PVOID *)(*((_QWORD *)P + 3) + 24i64));
  sub_3E21C(*(PVOID *)P);
  sub_3DBA4(*((PVOID *)P + 2), 0x6E635450u);
  sub_3DBA4(*((PVOID *)P + 3), 0x6E635450u);
  sub_3DBA4(P, 0x6E635450u);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x67u, (__int64)&unk_57CA8);
  }
  return 0i64;
}

//----- (000000000003EEF8) ----------------------------------------------------
void __fastcall sub_3EEF8(__int64 a1, char a2)
{
  PDEVICE_OBJECT v4; // rcx
  void (__fastcall *v5)(__int64); // rax

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x6Bu, (__int64)&unk_57CA8);
    v4 = off_5A148;
  }
  if ( a1 )
  {
    if ( a2 )
    {
      v5 = *(void (__fastcall **)(__int64))(a1 - 8);
      if ( v5 )
        v5(a1);
    }
    sub_3DBA4((PVOID)(a1 - 40), 0x6E635749u);
    v4 = off_5A148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)v4->Queue.ListEntry.Blink, 0x6Cu, (__int64)&unk_57CA8);
  }
}

//----- (000000000003EFBC) ----------------------------------------------------
void __fastcall sub_3EFBC(__int64 a1, unsigned int a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 *v5; // rbp
  __int64 v6; // rdi
  __int64 v7; // rbx
  __int64 v8; // r11
  __int64 v9; // rcx
  __int64 **v10; // rax
  KIRQL v11; // [rsp+40h] [rbp+8h] BYREF

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x6Du, (__int64)&unk_57CA8);
    v4 = off_5A148;
  }
  if ( a1 )
  {
    v5 = (__int64 *)(a1 - 40);
    v11 = 0;
    v6 = *(_QWORD *)(a1 - 40 + 16);
    if ( a2 > *(_DWORD *)(v6 + 8) || !*(_BYTE *)(v6 + 12) )
      a2 = 0;
    v7 = 32i64 * a2;
    sub_3DFD8((PKSPIN_LOCK)(v7 + *(_QWORD *)(v6 + 24)), &v11);
    v8 = *(_QWORD *)(v6 + 24);
    v9 = v7 + v8 + 8;
    v10 = *(__int64 ***)(v7 + v8 + 16);
    *v5 = v9;
    v5[1] = (__int64)v10;
    *v10 = v5;
    *(_QWORD *)(v9 + 8) = v5;
    sub_3E2B4(*(PRKEVENT *)(v7 + *(_QWORD *)(v6 + 24) + 24));
    sub_3E090((PKSPIN_LOCK)(v7 + *(_QWORD *)(v6 + 24)), v11);
    v4 = off_5A148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)v4->Queue.ListEntry.Blink, 0x6Eu, (__int64)&unk_57CA8);
  }
}

//----- (000000000003F0C8) ----------------------------------------------------
__int64 __fastcall sub_3F0C8(PVOID Object)
{
  int v2; // eax
  unsigned int v3; // ebx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x6Fu, (__int64)&unk_57CA8);
  }
  v2 = KeWaitForSingleObject(Object, Executive, 0, 0, 0i64);
  v3 = v2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x70u, (__int64)&unk_57CA8, v2);
  }
  return v3;
}

//----- (000000000003F170) ----------------------------------------------------
__int64 __fastcall sub_3F170(ULONG Count, PVOID Object[])
{
  struct _KWAIT_BLOCK *WaitBlockArray; // rdi
  unsigned int v6; // ebx

  WaitBlockArray = 0i64;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x71u, (__int64)&unk_57CA8);
  }
  if ( Count > 3 )
  {
    WaitBlockArray = (struct _KWAIT_BLOCK *)sub_3DA88(2, 48 * Count, 0x6E635742u);
    if ( !WaitBlockArray )
      return 4278190083i64;
  }
  v6 = KeWaitForMultipleObjects(Count, Object, WaitAny, Executive, 0, 0, 0i64, WaitBlockArray);
  if ( WaitBlockArray )
    sub_3DBA4(WaitBlockArray, 0x6E635742u);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 2) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x72u, (__int64)&unk_57CA8, v6);
  }
  return v6;
}

//----- (000000000003F27C) ----------------------------------------------------
void __fastcall DeferredRoutine(_KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)
{
  if ( DeferredContext )
    ((void (__fastcall *)(_KDPC *, PVOID, PVOID, PVOID))DeferredContext)(
      Dpc,
      DeferredContext,
      SystemArgument1,
      SystemArgument2);
  KeSetTimer(&Timer, (LARGE_INTEGER)qword_5D678, &::Dpc);
}
// 5D678: using guessed type __int64 qword_5D678;

//----- (000000000003F2B0) ----------------------------------------------------
__int64 sub_3F2B0()
{
  unsigned __int8 v0; // bl
  unsigned __int8 v2; // [rsp+48h] [rbp+10h]
  unsigned __int8 v3; // [rsp+50h] [rbp+18h]

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0x12u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xAu, (__int64)&unk_57C88, 1);
  }
  v0 = KeGetCurrentIrql();
  __writecr8(2ui64);
  v3 = 0;
  KeStallExecutionProcessor(1u);
  v2 = 0;
  __writecr8(v0);
  qword_5CF60 = v2 - (unsigned __int64)v3;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0x12u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_17BF0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xBu, (__int64)&unk_57C88, 1);
  }
  KeQueryPerformanceCounter(&PerformanceFrequency);
  byte_5A8D2 = 1;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0x12u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xCu, (__int64)&unk_57C88, 0);
  }
  return 0i64;
}
// 5A8D2: using guessed type char byte_5A8D2;
// 5CF60: using guessed type __int64 qword_5CF60;

//----- (000000000003F3E4) ----------------------------------------------------
__int64 sub_3F3E4(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, a3, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000003F444) ----------------------------------------------------
__int64 sub_3F444()
{
  unsigned int v0; // ebx
  char *v1; // r11
  PDEVICE_OBJECT v2; // rcx
  char *v3; // rax

  v0 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xAu, (__int64)&unk_57C78);
  }
  v1 = sub_3C76C(1, 0x10u, 0x4E4C6547u);
  qword_5CF70 = v1;
  if ( v1 )
  {
    v3 = sub_3C76C(1, 0x10u, 0x494C6547u);
    qword_5CF78 = v3;
    if ( v3 )
    {
LABEL_21:
      v2 = off_5A148;
      goto LABEL_22;
    }
    v2 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xCu, (__int64)&unk_57C78);
      v2 = off_5A148;
      v3 = (char *)qword_5CF78;
    }
    v1 = (char *)qword_5CF70;
  }
  else
  {
    v2 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xBu, (__int64)&unk_57C78);
      v2 = off_5A148;
      v1 = (char *)qword_5CF70;
    }
    v3 = (char *)qword_5CF78;
  }
  v0 = 3;
  if ( v1 )
  {
    sub_3C7F0(v1);
    qword_5CF70 = 0i64;
    v2 = off_5A148;
    v3 = (char *)qword_5CF78;
  }
  if ( v3 )
  {
    sub_3C7F0(v3);
    qword_5CF78 = 0i64;
    goto LABEL_21;
  }
LABEL_22:
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 8) != 0
    && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v2->AlignmentRequirement, 0xDu, (__int64)&unk_57C78, v0);
  }
  return v0;
}

//----- (000000000003F614) ----------------------------------------------------
__int64 __fastcall sub_3F614(ULONG a1, __int64 *a2, int a3, void (__fastcall *a4)(__int64 *))
{
  PDEVICE_OBJECT v8; // rcx
  __int64 result; // rax
  _QWORD *v10; // rax
  _QWORD *v11; // rdi

  v8 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x10u, (__int64)&unk_57C78);
    v8 = off_5A148;
  }
  if ( a2 )
  {
    if ( *a2 )
    {
      if ( v8 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 8) != 0
        && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v8->AlignmentRequirement, 0x12u, (__int64)&unk_57C78);
      }
      sub_3F7C8(a2, a4);
    }
    v10 = sub_3C4EC(1, 0x20u, a1);
    v11 = v10;
    *a2 = (__int64)v10;
    if ( v10 )
    {
      memset(v10, 0, 0x20ui64);
      v11[1] = 0i64;
      v11[2] = 0i64;
      *((_DWORD *)v11 + 6) = 0;
      *(_DWORD *)v11 = a3;
      *((_DWORD *)v11 + 7) = a1;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x14u, (__int64)&unk_57C78);
      }
      result = 0i64;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x13u, (__int64)&unk_57C78);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v8 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 8) != 0
      && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v8->AlignmentRequirement, 0x11u, (__int64)&unk_57C78);
    }
    result = 4i64;
  }
  return result;
}

//----- (000000000003F7C8) ----------------------------------------------------
__int64 __fastcall sub_3F7C8(__int64 *a1, void (__fastcall *a2)(__int64 *))
{
  PDEVICE_OBJECT v4; // rcx
  unsigned int v5; // edi
  __int64 result; // rax

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1Bu, (__int64)&unk_57C78);
    v4 = off_5A148;
  }
  if ( a1 && *a1 )
  {
    v5 = sub_3F8DC(*a1, a2);
    sub_3C570((PVOID)*a1, *(_DWORD *)(*a1 + 28));
    *a1 = 0i64;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1Du, (__int64)&unk_57C78);
    }
    result = v5;
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 8) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x1Cu, (__int64)&unk_57C78);
    }
    result = 4i64;
  }
  return result;
}

//----- (000000000003F8DC) ----------------------------------------------------
__int64 __fastcall sub_3F8DC(__int64 a1, void (__fastcall *a2)(__int64 *))
{
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  __int64 *v6; // rdi
  __int64 v7; // [rsp+40h] [rbp+8h] BYREF

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1Eu, (__int64)&unk_57C78);
    v4 = off_5A148;
  }
  if ( a1 )
  {
    while ( *(_QWORD *)(a1 + 8) )
    {
      v6 = *(__int64 **)(a1 + 8);
      if ( a2 )
      {
        v7 = *v6;
        a2(&v7);
      }
      *(_QWORD *)(a1 + 8) = *(_QWORD *)(*(_QWORD *)(a1 + 8) + 8i64);
      sub_3C978((__int64)qword_5CF70, (__int64)v6);
    }
    *(_QWORD *)(a1 + 8) = 0i64;
    *(_QWORD *)(a1 + 16) = 0i64;
    *(_DWORD *)(a1 + 24) = 0;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x20u, (__int64)&unk_57C78);
    }
    result = 0i64;
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 8) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x1Fu, (__int64)&unk_57C78);
    }
    result = 4i64;
  }
  return result;
}

//----- (000000000003FA20) ----------------------------------------------------
__int64 __fastcall sub_3FA20(int *a1, __int64 a2)
{
  _QWORD *v4; // rsi
  PDEVICE_OBJECT v5; // rcx
  _QWORD *v6; // rax
  _QWORD *v7; // rdi
  __int64 result; // rax
  int v9; // eax
  _QWORD *v10; // rbp
  int v11; // eax
  __int64 v12; // rax

  v4 = 0i64;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_39144(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x27u, (__int64)&unk_57C78, a1, a2, 0i64);
    v5 = off_5A148;
  }
  if ( a1 && a2 )
  {
    if ( *a1 != 2 && *a1 != 3 )
    {
      v6 = sub_3C910((__int64)qword_5CF70);
      v7 = v6;
      if ( !v6 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x2Au, (__int64)&unk_57C78);
        }
        return 3i64;
      }
      v6[1] = 0i64;
      *v6 = a2;
      v9 = *a1;
      if ( *a1 )
      {
        if ( v9 == 1 )
          goto LABEL_27;
        if ( (unsigned int)(v9 - 2) > 1 )
          goto LABEL_27;
        v10 = (_QWORD *)*((_QWORD *)a1 + 1);
        if ( !v10 )
          goto LABEL_27;
        do
        {
          v11 = MEMORY[0](*v7, *v10);
          if ( *a1 == 2 && v11 == 5 )
            break;
          if ( *a1 == 3 && v11 == 6 )
            break;
          v4 = v10;
          v10 = (_QWORD *)v10[1];
        }
        while ( v10 );
      }
      else
      {
        v4 = (_QWORD *)*((_QWORD *)a1 + 2);
      }
      if ( v4 )
      {
        if ( !v4[1] )
          *((_QWORD *)a1 + 2) = v7;
        v7[1] = v4[1];
        v4[1] = v7;
        goto LABEL_34;
      }
LABEL_27:
      v12 = *((_QWORD *)a1 + 1);
      if ( v12 )
        v7[1] = v12;
      else
        *((_QWORD *)a1 + 2) = v7;
      *((_QWORD *)a1 + 1) = v7;
LABEL_34:
      ++a1[6];
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x2Bu, (__int64)&unk_57C78, a1[6]);
      }
      return 0i64;
    }
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 8) != 0
      && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v5->AlignmentRequirement, 0x29u, (__int64)&unk_57C78);
    }
    result = 6i64;
  }
  else
  {
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 8) != 0
      && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EE0(*(_QWORD *)&v5->AlignmentRequirement, 0x28u, (__int64)&unk_57C78, a1, a2);
    }
    result = 4i64;
  }
  return result;
}

//----- (000000000003FC70) ----------------------------------------------------
__int64 __fastcall sub_3FC70(int *a1, _DWORD *a2)
{
  __int64 v4; // rbp
  char v5; // r12
  PDEVICE_OBJECT v6; // rcx
  int v7; // esi
  __int64 v8; // rdi
  int v9; // eax
  __int64 result; // rax
  __int64 v11; // rax

  v4 = 0i64;
  v5 = 1;
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_3F3E4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x2Cu, (__int64)&unk_57C78, a1, a2, sub_38B9C, sub_38CE4);
    v6 = off_5A148;
  }
  if ( a1 && a2 && sub_38B9C )
  {
    v7 = *a1;
    if ( *a1 == 2 || v7 == 3 )
      v7 = 0;
    v8 = *((_QWORD *)a1 + 1);
    if ( v8 )
    {
      while ( 1 )
      {
        if ( !v5 )
        {
LABEL_18:
          v6 = off_5A148;
          goto LABEL_19;
        }
        v9 = sub_38B9C(*(_DWORD **)v8, a2);
        if ( v9 == 7 )
          break;
        if ( v7 == 2 && v9 == 6 )
          v5 = 0;
        v4 = v8;
        v8 = *(_QWORD *)(v8 + 8);
        if ( !v8 )
          goto LABEL_18;
      }
      if ( sub_38CE4 )
        sub_38CE4((PVOID *)v8);
      if ( *((_QWORD *)a1 + 2) == v8 )
        *((_QWORD *)a1 + 2) = v4;
      v11 = *((_QWORD *)a1 + 1);
      if ( v11 == v8 )
        *((_QWORD *)a1 + 1) = *(_QWORD *)(v11 + 8);
      if ( v4 )
        *(_QWORD *)(v4 + 8) = *(_QWORD *)(v8 + 8);
      sub_3C978((__int64)qword_5CF70, v8);
      --a1[6];
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x2Eu, (__int64)&unk_57C78, a1[6]);
      }
      result = 0i64;
    }
    else
    {
LABEL_19:
      if ( v6 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 8) != 0
        && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0x2Fu, (__int64)&unk_57C78, a1[6]);
      }
      result = 5i64;
    }
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 8) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_39144(*(_QWORD *)&v6->AlignmentRequirement, 0x2Du, (__int64)&unk_57C78, a1, a2, sub_38B9C);
    }
    result = 4i64;
  }
  return result;
}
// 3FD55: conditional instruction was optimized away because of 'esi.4 in (<2u|>=4u)'

//----- (000000000003FEC8) ----------------------------------------------------
__int64 __fastcall sub_3FEC8(int *a1, _DWORD *a2, _QWORD *a3)
{
  unsigned int v6; // esi
  PDEVICE_OBJECT v7; // rcx
  int v8; // edi
  __int64 v9; // rbx
  int v10; // eax
  __int64 result; // rax

  v6 = 5;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_3F3E4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x30u, (__int64)&unk_57C78, a1, a2, a3, sub_38B9C);
    v7 = off_5A148;
  }
  if ( a1 && a2 && sub_38B9C )
  {
    if ( a3 )
    {
      *a3 = 0i64;
      v7 = off_5A148;
    }
    v8 = *a1;
    if ( *a1 == 2 || v8 == 3 )
      v8 = 0;
    v9 = *((_QWORD *)a1 + 1);
    if ( v9 )
    {
      while ( 1 )
      {
        v10 = sub_38B9C(*(_DWORD **)v9, a2);
        if ( v10 == 7 )
          break;
        if ( v8 != 2 || v10 != 6 )
        {
          v9 = *(_QWORD *)(v9 + 8);
          if ( v9 )
            continue;
        }
        v7 = off_5A148;
        goto LABEL_26;
      }
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 8) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x32u, (__int64)&unk_57C78);
        v7 = off_5A148;
      }
      if ( a3 )
      {
        *a3 = *(_QWORD *)v9;
        v7 = off_5A148;
      }
      v6 = 0;
    }
LABEL_26:
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 8) != 0
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EA4(*(_QWORD *)&v7->AlignmentRequirement, 0x33u, (__int64)&unk_57C78, v6);
    }
    result = v6;
  }
  else
  {
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 8) != 0
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_39144(*(_QWORD *)&v7->AlignmentRequirement, 0x31u, (__int64)&unk_57C78, a1, a2, sub_38B9C);
    }
    result = 4i64;
  }
  return result;
}
// 3FFA7: conditional instruction was optimized away because of 'edi.4 in (<2u|>=4u)'

//----- (00000000000400AC) ----------------------------------------------------
__int64 __fastcall sub_400AC(__int64 a1, __int64 a2, __int64 a3, const wchar_t *a4)
{
  __int64 v5; // rcx
  const wchar_t *v6; // rdi
  bool v7; // zf

  if ( a4 && *a4 )
  {
    v5 = -1i64;
    v6 = a4;
    do
    {
      if ( !v5 )
        break;
      v7 = *v6++ == 0;
      --v5;
    }
    while ( !v7 );
  }
  if ( a4 )
  {
    if ( !*a4 )
      a4 = L"<NULL>";
  }
  else
  {
    a4 = L"NULL";
  }
  return qword_5A1B8(a1, 43i64, &unk_57C68, 71i64, a4);
}
// 57D90: using guessed type wchar_t aNull_1[7];
// 57DA0: using guessed type wchar_t aNull_2[5];
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004015C) ----------------------------------------------------
__int64 __fastcall sub_4015C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57C68, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000401BC) ----------------------------------------------------
__int64 sub_401BC(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57C68, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000040228) ----------------------------------------------------
__int64 __fastcall sub_40228(__int16 *a1, int a2, unsigned int *a3)
{
  PDEVICE_OBJECT v6; // rbx
  __int64 v7; // rcx
  unsigned __int16 v8; // dx

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xAu, (__int64)&unk_57C68);
    v6 = off_5A148;
  }
  if ( !byte_5D3E2 )
  {
    memset(&qword_5CF80, 0, 0x470ui64);
    if ( a3 )
    {
      if ( !(unsigned int)sub_430A8(a3) )
      {
        dword_5D3D8 = 0;
        dword_5D3DC = 0;
        byte_5D3E3 = 0;
        byte_5D3E0 = 0;
        byte_5D3E1 = 0;
        sub_5649C(word_5CFA0, 520i64, a1);
        dword_5D3B0 = a2;
        byte_5D3E2 = 1;
        sub_403FC(1);
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xEu, (__int64)&unk_57C68, 0);
        }
        return 0i64;
      }
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) == 0
        || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        return 264i64;
      }
      v7 = *(_QWORD *)&off_5A148->AlignmentRequirement;
      v8 = 13;
    }
    else
    {
      if ( v6 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) == 0
        || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        return 264i64;
      }
      v7 = *(_QWORD *)&v6->AlignmentRequirement;
      v8 = 12;
    }
    sub_11088(v7, v8, (__int64)&unk_57C68);
    return 264i64;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0xBu, (__int64)&unk_57C68);
  }
  return 0i64;
}
// 5D3B0: using guessed type int dword_5D3B0;
// 5D3D8: using guessed type int dword_5D3D8;
// 5D3DC: using guessed type int dword_5D3DC;
// 5D3E0: using guessed type char byte_5D3E0;
// 5D3E1: using guessed type char byte_5D3E1;
// 5D3E2: using guessed type char byte_5D3E2;
// 5D3E3: using guessed type char byte_5D3E3;

//----- (00000000000403FC) ----------------------------------------------------
__int64 __fastcall sub_403FC(char a1)
{
  PDEVICE_OBJECT v2; // rcx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xFu, (__int64)&unk_57C68);
    v2 = off_5A148;
  }
  byte_5D3E4 = a1;
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v2->AlignmentRequirement, 0x10u, (__int64)&unk_57C68, 0);
  }
  return 0i64;
}
// 5D3E4: using guessed type char byte_5D3E4;

//----- (0000000000040498) ----------------------------------------------------
__int64 __fastcall sub_40498(int a1, int a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  _QWORD *v6; // rax
  _QWORD *v7; // rcx
  PDEVICE_OBJECT v8; // rcx

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x11u, (__int64)&unk_57C68);
    v4 = off_5A148;
  }
  if ( byte_5D3E2 )
  {
    if ( !dword_5D3D8 )
    {
      qword_5CF88 = (__int64)&qword_5CF80;
      qword_5CF80 = &qword_5CF80;
    }
    v6 = sub_3C4EC(2, 0x28u, 0x74785072u);
    if ( v6 )
    {
      v6[4] = 0i64;
      *((_DWORD *)v6 + 4) = a1;
      *((_DWORD *)v6 + 6) = a2;
      *((_DWORD *)v6 + 7) = 2;
      v7 = (_QWORD *)qword_5CF88;
      *v6 = &qword_5CF80;
      v6[1] = v7;
      *v7 = v6;
      ++dword_5D3D8;
      qword_5CF88 = (__int64)v6;
      v8 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x14u, (__int64)&unk_57C68, a1);
          v8 = off_5A148;
        }
        if ( v8 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_13EA4(*(_QWORD *)&v8->AlignmentRequirement, 0x15u, (__int64)&unk_57C68, 0);
        }
      }
      result = 0i64;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x13u, (__int64)&unk_57C68);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x12u, (__int64)&unk_57C68);
    }
    result = 258i64;
  }
  return result;
}
// 5CF88: using guessed type __int64 qword_5CF88;
// 5D3D8: using guessed type int dword_5D3D8;
// 5D3E2: using guessed type char byte_5D3E2;

//----- (0000000000040678) ----------------------------------------------------
__int64 __fastcall sub_40678(int a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  _QWORD *v6; // rax
  _QWORD *v7; // rcx
  PDEVICE_OBJECT v8; // rcx

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x16u, (__int64)&unk_57C68);
    v4 = off_5A148;
  }
  if ( byte_5D3E2 )
  {
    if ( !dword_5D3DC )
    {
      qword_5CF98 = (__int64)&qword_5CF90;
      qword_5CF90 = &qword_5CF90;
    }
    v6 = sub_3C4EC(2, 0x48u, 0x746D436Eu);
    if ( v6 )
    {
      v6[6] = 0i64;
      *((_DWORD *)v6 + 4) = a1;
      v6[4] = a2;
      *((_DWORD *)v6 + 6) = 1;
      *((_DWORD *)v6 + 7) = 7;
      v6[8] = &qword_5CF80;
      v7 = (_QWORD *)qword_5CF98;
      *v6 = &qword_5CF90;
      v6[1] = v7;
      *v7 = v6;
      ++dword_5D3DC;
      qword_5CF98 = (__int64)v6;
      v8 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x19u, (__int64)&unk_57C68, a1);
          v8 = off_5A148;
        }
        if ( v8 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_13EA4(*(_QWORD *)&v8->AlignmentRequirement, 0x1Au, (__int64)&unk_57C68, 0);
        }
      }
      result = 0i64;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x18u, (__int64)&unk_57C68);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x17u, (__int64)&unk_57C68);
    }
    result = 258i64;
  }
  return result;
}
// 5CF98: using guessed type __int64 qword_5CF98;
// 5D3DC: using guessed type int dword_5D3DC;
// 5D3E2: using guessed type char byte_5D3E2;

//----- (000000000004086C) ----------------------------------------------------
__int64 sub_4086C()
{
  PDEVICE_OBJECT v0; // rcx
  PDEVICE_OBJECT v2; // rcx
  unsigned __int16 v3; // dx

  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1Bu, (__int64)&unk_57C68);
    v0 = off_5A148;
  }
  if ( !byte_5D3E2 )
  {
    if ( v0 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v0->AlignmentRequirement, 0x1Cu, (__int64)&unk_57C68);
    }
    return 258i64;
  }
  if ( !dword_5D3D8
    && !dword_5D3DC
    && v0 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v0->AlignmentRequirement, 0x1Du, (__int64)&unk_57C68);
  }
  if ( (unsigned int)sub_41250() )
  {
    v2 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) == 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 257i64;
    }
    v3 = 30;
LABEL_22:
    sub_11088(*(_QWORD *)&v2->AlignmentRequirement, v3, (__int64)&unk_57C68);
    return 257i64;
  }
  if ( (unsigned int)sub_4189C() )
  {
    v2 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) == 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 257i64;
    }
    v3 = 31;
    goto LABEL_22;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x20u, (__int64)&unk_57C68);
  }
  sub_446CC();
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x21u, (__int64)&unk_57C68, 0);
  }
  return 0i64;
}
// 5D3D8: using guessed type int dword_5D3D8;
// 5D3DC: using guessed type int dword_5D3DC;
// 5D3E2: using guessed type char byte_5D3E2;

//----- (0000000000040A2C) ----------------------------------------------------
__int64 __fastcall sub_40A2C(int a1, const void *a2, unsigned int a3, int a4, int *a5)
{
  unsigned int v9; // ebx
  PDEVICE_OBJECT v10; // rcx
  PDEVICE_OBJECT v12; // rcx

  v9 = 0;
  v10 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x22u, (__int64)&unk_57C68);
    v10 = off_5A148;
  }
  if ( !byte_5D3E3 )
  {
    if ( v10 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v10->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v10->AlignmentRequirement, 0x23u, (__int64)&unk_57C68);
    }
    return 260i64;
  }
  if ( (unsigned int)(a1 - 40000) > 0x4D )
  {
    if ( v10 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v10->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v10->AlignmentRequirement, 0x24u, (__int64)&unk_57C68);
    }
    return 261i64;
  }
  if ( !a2 )
  {
    if ( v10 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v10->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v10->AlignmentRequirement, 0x25u, (__int64)&unk_57C68);
    }
    return 4i64;
  }
  if ( *((_QWORD *)qword_5D3C8 + 8 * (unsigned __int64)(unsigned int)(a1 - 40000) + 4) )
  {
    if ( (unsigned int)sub_42BFC(a1, a2, a3, a5) )
    {
      v12 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x27u, (__int64)&unk_57C68);
        v12 = off_5A148;
      }
      v9 = 262;
      goto LABEL_37;
    }
  }
  else if ( (unsigned int)sub_42360(a1, a2, a3, a4, a5) )
  {
    v12 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x26u, (__int64)&unk_57C68);
      v12 = off_5A148;
    }
    v9 = 263;
    goto LABEL_37;
  }
  v12 = off_5A148;
LABEL_37:
  if ( v12 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v12->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(v12->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v12->AlignmentRequirement, 0x28u, (__int64)&unk_57C68, v9);
  }
  return v9;
}
// 5D3E3: using guessed type char byte_5D3E3;

//----- (0000000000040C80) ----------------------------------------------------
__int64 __fastcall sub_40C80(int a1, const void *a2, unsigned int a3, int a4, int *a5, void (__fastcall *a6)(const void *, _QWORD, PVOID, _QWORD, const void *, unsigned int))
{
  unsigned int v10; // ebx
  PDEVICE_OBJECT v11; // r10
  __int64 result; // rax

  v10 = 0;
  v11 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x29u, (__int64)&unk_57C68);
    v11 = off_5A148;
  }
  if ( byte_5D3E3 )
  {
    if ( (unsigned int)(a1 - 40000) <= 0x4D )
    {
      if ( a2 )
      {
        if ( !*((_QWORD *)qword_5D3C8 + 8 * (unsigned __int64)(unsigned int)(a1 - 40000) + 4) )
        {
          if ( (unsigned int)sub_42684(a1, a2, a3, a4, a5, a6) )
          {
            v11 = off_5A148;
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
              && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
            {
              sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x2Du, (__int64)&unk_57C68);
              v11 = off_5A148;
            }
            v10 = 263;
          }
          else
          {
            v11 = off_5A148;
          }
        }
        if ( v11 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v11->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
          && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_13EA4(*(_QWORD *)&v11->AlignmentRequirement, 0x2Eu, (__int64)&unk_57C68, v10);
        }
        result = v10;
      }
      else
      {
        if ( v11 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v11->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
          && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_11088(*(_QWORD *)&v11->AlignmentRequirement, 0x2Cu, (__int64)&unk_57C68);
        }
        result = 4i64;
      }
    }
    else
    {
      if ( v11 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v11->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11088(*(_QWORD *)&v11->AlignmentRequirement, 0x2Bu, (__int64)&unk_57C68);
      }
      result = 261i64;
    }
  }
  else
  {
    if ( v11 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v11->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v11->AlignmentRequirement, 0x2Au, (__int64)&unk_57C68);
    }
    result = 260i64;
  }
  return result;
}
// 5D3E3: using guessed type char byte_5D3E3;

//----- (0000000000040E90) ----------------------------------------------------
__int64 __fastcall sub_40E90(unsigned int a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  int v6; // eax

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x35u, (__int64)&unk_57C68);
    v4 = off_5A148;
  }
  if ( byte_5D3E3 )
  {
    if ( qword_5D3B8 && a2 )
    {
      v6 = (*(__int64 (__fastcall **)(_QWORD, _QWORD, __int64))(*((_QWORD *)qword_5D3B8 + 1) + 8i64))(
             **((_QWORD **)qword_5D3B8 + 1),
             a1,
             a2);
      v4 = off_5A148;
    }
    else
    {
      v6 = 1796;
    }
    if ( v6 )
    {
      if ( v4 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&v4->AlignmentRequirement, 0x37u, (__int64)&unk_57C68, v6);
      }
      result = 257i64;
    }
    else
    {
      if ( v4 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&v4->AlignmentRequirement, 0x38u, (__int64)&unk_57C68, 0);
      }
      result = 0i64;
    }
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x36u, (__int64)&unk_57C68);
    }
    result = 260i64;
  }
  return result;
}
// 5D3E3: using guessed type char byte_5D3E3;

//----- (0000000000040FE0) ----------------------------------------------------
__int64 sub_40FE0()
{
  PDEVICE_OBJECT v0; // rcx
  int v2; // eax
  unsigned int v3; // edi
  PDEVICE_OBJECT v4; // rbx
  PVOID *v5; // rcx
  PVOID *v6; // rcx

  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x39u, (__int64)&unk_57C68);
    v0 = off_5A148;
  }
  if ( byte_5D3E2 )
  {
    v2 = sub_42000();
    v3 = v2;
    if ( v2 )
    {
      v4 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Bu, (__int64)&unk_57C68, v2);
        v4 = off_5A148;
      }
      if ( v3 != 260 )
        return v3;
    }
    else
    {
      v4 = off_5A148;
    }
    if ( dword_5D3D8 )
    {
      v5 = (PVOID *)qword_5CF80;
      if ( qword_5CF80 != &qword_5CF80 )
      {
        do
        {
          qword_5CF80 = *v5;
          *((_QWORD *)qword_5CF80 + 1) = &qword_5CF80;
          sub_3C570(v5, 0x74785072u);
          v5 = (PVOID *)qword_5CF80;
        }
        while ( qword_5CF80 != &qword_5CF80 );
        v4 = off_5A148;
      }
    }
    if ( dword_5D3DC )
    {
      v6 = (PVOID *)qword_5CF90;
      if ( qword_5CF90 != &qword_5CF90 )
      {
        do
        {
          qword_5CF90 = *v6;
          *((_QWORD *)qword_5CF90 + 1) = &qword_5CF90;
          sub_3C570(v6, 0x746D436Eu);
          v6 = (PVOID *)qword_5CF90;
        }
        while ( qword_5CF90 != &qword_5CF90 );
        v4 = off_5A148;
      }
    }
    if ( qword_5D3C8 && byte_5D3E0 == 1 )
    {
      sub_3C570(qword_5D3C8, 0x74785072u);
      qword_5D3C8 = 0i64;
      v4 = off_5A148;
    }
    if ( qword_5D3D0 && byte_5D3E1 == 1 )
    {
      sub_3C570(qword_5D3D0, 0x746D436Eu);
      v4 = off_5A148;
    }
    memset(&qword_5CF80, 0, 0x470ui64);
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EA4(*(_QWORD *)&v4->AlignmentRequirement, 0x3Cu, (__int64)&unk_57C68, v3);
    }
    return v3;
  }
  if ( v0 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v0->AlignmentRequirement, 0x3Au, (__int64)&unk_57C68);
  }
  return 0i64;
}
// 5D3D8: using guessed type int dword_5D3D8;
// 5D3DC: using guessed type int dword_5D3DC;
// 5D3E0: using guessed type char byte_5D3E0;
// 5D3E1: using guessed type char byte_5D3E1;
// 5D3E2: using guessed type char byte_5D3E2;

//----- (0000000000041250) ----------------------------------------------------
__int64 sub_41250()
{
  PDEVICE_OBJECT v0; // rcx
  PVOID v1; // rax
  PVOID v3; // rax

  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Du, (__int64)&unk_57C68);
    v0 = off_5A148;
  }
  if ( dword_5D3D8 )
  {
    v1 = sub_3C4EC(2, 0x1340u, 0x74785072u);
    qword_5D3C8 = v1;
    if ( !v1 )
      return 3i64;
    memset(v1, 0, 0x1340ui64);
    if ( (unsigned int)sub_414D8(0) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Eu, (__int64)&unk_57C68);
      }
      sub_3C570(qword_5D3C8, 0x74785072u);
      qword_5D3C8 = 0i64;
      return 1i64;
    }
    v0 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Fu, (__int64)&unk_57C68);
      v0 = off_5A148;
    }
    byte_5D3E0 = 1;
  }
  if ( dword_5D3DC )
  {
    v3 = sub_3C4EC(2, 0x9A0u, 0x746D436Eu);
    qword_5D3D0 = v3;
    if ( v3 )
    {
      memset(v3, 0, 0x9A0ui64);
      if ( (unsigned int)sub_414D8(1) )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x40u, (__int64)&unk_57C68);
        }
        sub_3C570(qword_5D3D0, 0x746D436Eu);
        qword_5D3D0 = 0i64;
        return 1i64;
      }
      v0 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x41u, (__int64)&unk_57C68);
        v0 = off_5A148;
      }
      byte_5D3E1 = 1;
      goto LABEL_33;
    }
    return 3i64;
  }
LABEL_33:
  if ( v0 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v0->AlignmentRequirement, 0x42u, (__int64)&unk_57C68, 0);
  }
  return 0i64;
}
// 5D3D8: using guessed type int dword_5D3D8;
// 5D3DC: using guessed type int dword_5D3DC;
// 5D3E0: using guessed type char byte_5D3E0;
// 5D3E1: using guessed type char byte_5D3E1;

//----- (00000000000414D8) ----------------------------------------------------
__int64 __fastcall sub_414D8(int a1)
{
  unsigned int v2; // edi
  PDEVICE_OBJECT v3; // rcx
  PVOID *j; // rbx
  int v5; // edx
  unsigned int v6; // er9
  unsigned __int64 v7; // r8
  PVOID *i; // rbx
  unsigned int v9; // er9
  __int64 v10; // r8
  __int64 (__fastcall *v11)(__int64, __int64, __int64); // rcx
  int v12; // eax

  v2 = 0;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x43u, (__int64)&unk_57C68);
    v3 = off_5A148;
  }
  if ( a1 )
  {
    for ( i = (PVOID *)qword_5CF90; i != &qword_5CF90; i = (PVOID *)*i )
    {
      v9 = *((_DWORD *)i + 4) - 40000;
      if ( v9 >= 0x4D )
      {
        if ( v3 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_13EA4(*(_QWORD *)&v3->AlignmentRequirement, 0x45u, (__int64)&unk_57C68, v9);
          v3 = off_5A148;
        }
        v2 = 1;
      }
      else
      {
        v10 = 32i64 * v9;
        *(_DWORD *)((char *)qword_5D3D0 + v10) = *((_DWORD *)i + 4);
        *(_DWORD *)((char *)qword_5D3D0 + v10 + 4) = -1;
        *(_DWORD *)((char *)qword_5D3D0 + v10 + 8) = *((_DWORD *)i + 6);
        *(_DWORD *)((char *)qword_5D3D0 + v10 + 12) = *((_DWORD *)i + 7);
        *(_QWORD *)((char *)qword_5D3D0 + v10 + 24) = i + 3;
        if ( *((_DWORD *)i + 4) == 40005 )
        {
          v11 = sub_43B68;
        }
        else
        {
          v12 = *((_DWORD *)i + 4);
          if ( v12 == 40015
            || v12 == 40016
            || v12 == 40017
            || v12 == 40018
            || v12 == 40019
            || v12 == 40020
            || v12 == 40021
            || v12 == 40023
            || v12 == 40022
            || v12 == 40039
            || v12 == 40044
            || v12 == 40024
            || v12 == 40036
            || v12 == 40012
            || v12 == 40037
            || v12 == 40014
            || v12 == 40041
            || v12 == 40042
            || v12 == 40013
            || v12 == 40038
            || v12 == 40025 )
          {
            v11 = sub_44528;
          }
          else if ( v12 == 40011
                 || v12 == 40053
                 || v12 == 40050
                 || v12 == 40051
                 || v12 == 40052
                 || v12 == 40045
                 || v12 == 40003 )
          {
            v11 = sub_43760;
          }
          else
          {
            v11 = sub_434EC;
          }
        }
        *(_QWORD *)((char *)qword_5D3D0 + v10 + 16) = v11;
        v3 = off_5A148;
      }
    }
  }
  else
  {
    for ( j = (PVOID *)qword_5CF80; j != &qword_5CF80; j = (PVOID *)*j )
    {
      v5 = *((_DWORD *)j + 4);
      v6 = v5 - 40000;
      if ( (unsigned int)(v5 - 40000) >= 0x4D )
      {
        if ( v3 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_13EA4(*(_QWORD *)&v3->AlignmentRequirement, 0x44u, (__int64)&unk_57C68, v6);
          v3 = off_5A148;
        }
        v2 = 1;
      }
      else
      {
        v7 = (unsigned __int64)v6 << 6;
        *(_DWORD *)((char *)qword_5D3C8 + v7) = v5;
        *(_DWORD *)((char *)qword_5D3C8 + v7 + 4) = *((_DWORD *)j + 6);
        *(_DWORD *)((char *)qword_5D3C8 + v7 + 8) = -1;
        *(_QWORD *)((char *)qword_5D3C8 + v7 + 16) = 0i64;
        *(_DWORD *)((char *)qword_5D3C8 + v7 + 24) = *((_DWORD *)j + 7);
        *(_QWORD *)((char *)qword_5D3C8 + v7 + 32) = (unsigned __int64)sub_42E50 & -(__int64)(j[4] != 0i64);
        *(_QWORD *)((char *)qword_5D3C8 + v7 + 40) = j + 3;
        *(_DWORD *)((char *)qword_5D3C8 + v7 + 48) = 0;
        *(_QWORD *)((char *)qword_5D3C8 + v7 + 56) = 0i64;
        v3 = off_5A148;
      }
    }
  }
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v3->AlignmentRequirement, 0x46u, (__int64)&unk_57C68, v2);
  }
  return v2;
}

//----- (000000000004189C) ----------------------------------------------------
__int64 sub_4189C()
{
  PDEVICE_OBJECT v0; // rcx
  _QWORD *v1; // rax
  _QWORD *v2; // rbx
  int v3; // edi
  PDEVICE_OBJECT v4; // rcx
  unsigned __int16 v5; // dx
  int v6; // er9
  unsigned int v7; // esi
  __int64 v8; // rdi
  _QWORD *v9; // rbp
  int v10; // er12
  int v11; // eax
  __int64 v12; // rax
  int v13; // eax
  __int64 v14; // r9
  __int64 v15; // r8
  __int64 v16; // rcx
  PDEVICE_OBJECT v18; // r10
  unsigned int v19; // ebx
  __int64 v20; // rdi
  int v21; // er9
  __int64 v22; // rax
  unsigned int v23; // ebx
  __int64 v24; // rdi
  __int64 v25; // rax
  __int64 v26; // rax
  unsigned __int16 v27; // dx
  __int64 (__fastcall **v28)(_QWORD *, _QWORD, void *); // [rsp+60h] [rbp+8h] BYREF

  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_400AC(*(_QWORD *)&off_5A148->AlignmentRequirement, 71i64, (__int64)&unk_57C68, word_5CFA0);
    v0 = off_5A148;
  }
  if ( byte_5D3E0 || byte_5D3E1 )
    goto LABEL_11;
  if ( v0 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0 && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v0->AlignmentRequirement, 0x48u, (__int64)&unk_57C68);
      v0 = off_5A148;
    }
LABEL_11:
    if ( v0 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&v0->AlignmentRequirement, 0x49u, (__int64)&unk_57C68, &qword_5D3B8);
    }
  }
  qword_5D3B8 = 0i64;
  v1 = sub_3C4EC(2, 0x38u, 0x41434E50u);
  v2 = v1;
  if ( !v1 )
  {
    v3 = 1793;
LABEL_25:
    v4 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) == 0
      || !BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) )
    {
      return 260i64;
    }
    v5 = 74;
    v6 = v3;
LABEL_53:
    v16 = *(_QWORD *)&v4->AlignmentRequirement;
    goto LABEL_54;
  }
  memset(v1, 0, 0x38ui64);
  v3 = sub_53750(v2 + 6, v2 + 1);
  if ( v3
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531842i64,
               v2 + 2)) != 0
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531845i64,
               v2 + 5)) != 0
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531843i64,
               v2 + 4)) != 0
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531844i64,
               v2 + 3)) != 0 )
  {
    sub_538D4(v2);
    v2 = qword_5D3B8;
  }
  else
  {
    *(_BYTE *)v2 = 1;
    qword_5D3B8 = v2;
  }
  if ( v3 )
    goto LABEL_25;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x4Bu, (__int64)&unk_57C68, &qword_5D3B8, 0i64, 0);
    v4 = off_5A148;
    v2 = qword_5D3B8;
  }
  v7 = dword_5D3B0;
  v8 = 0i64;
  v9 = v2;
  v10 = 1796;
  if ( v2 )
  {
    v11 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(v2[1] + 8i64))(*(_QWORD *)v2[1], 1i64, &v28);
    v4 = off_5A148;
    v2 = qword_5D3B8;
    if ( !v11 )
    {
      v12 = (*v28)(v9, v7, word_5CFA0);
      v4 = off_5A148;
      v2 = qword_5D3B8;
      v8 = v12;
    }
  }
  qword_5D3C0 = v8;
  if ( !v8 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) )
    {
      sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x4Cu, (__int64)&unk_57C68);
    }
    return 260i64;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_39144(*(_QWORD *)&v4->AlignmentRequirement, 0x4Du, (__int64)&unk_57C68, v2, v8, &qword_5D3F0);
    v4 = off_5A148;
    v8 = qword_5D3C0;
    v2 = qword_5D3B8;
  }
  v13 = 1796;
  if ( !v8 || (v14 = *(_QWORD *)(v8 + 1112)) == 0 )
  {
LABEL_49:
    if ( v4 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) == 0
      || !BYTE1(v4->DeviceQueue.DeviceListHead.Flink) )
    {
      return 260i64;
    }
    v5 = 78;
    v6 = v13;
    goto LABEL_53;
  }
  v13 = (*(__int64 (__fastcall **)(_QWORD *, __int64, __int64 *))(v14 + 112))(v2, v8, &qword_5D3F0);
  if ( v13 )
  {
    v4 = off_5A148;
    goto LABEL_49;
  }
  v18 = off_5A148;
  if ( !dword_5D3D8 )
  {
LABEL_71:
    if ( dword_5D3DC )
    {
      v23 = 0;
      v24 = 0i64;
      do
      {
        if ( v18 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v18->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v18->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_39144(
            *(_QWORD *)&v18->AlignmentRequirement,
            0x52u,
            (__int64)&unk_57C68,
            qword_5D3B8,
            qword_5D3C0,
            (char *)qword_5D3D0 + 32 * v23);
          v18 = off_5A148;
        }
        if ( *(_DWORD *)((char *)qword_5D3D0 + v24) )
        {
          v21 = 1796;
          if ( !qword_5D3C0 )
            goto LABEL_105;
          v25 = *(_QWORD *)(qword_5D3C0 + 1112);
          if ( !v25 )
            goto LABEL_105;
          v21 = (*(__int64 (__fastcall **)(__int64, char *, __int64, __int64))(v25 + 40))(
                  qword_5D3C0,
                  (char *)qword_5D3D0 + 32 * v23,
                  v15,
                  1796i64);
          if ( v21 )
          {
            v18 = off_5A148;
LABEL_105:
            if ( v18 != (PDEVICE_OBJECT)&off_5A148
              && (BYTE4(v18->DeviceQueue.DeviceListHead.Flink) & 1) != 0
              && BYTE1(v18->DeviceQueue.DeviceListHead.Flink) )
            {
              v27 = 83;
LABEL_103:
              sub_184C0(*(_QWORD *)&v18->AlignmentRequirement, v27, (__int64)&unk_57C68, v21);
            }
            return 260i64;
          }
          v18 = off_5A148;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) )
          {
            sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x54u, (__int64)&unk_57C68, v23);
            v18 = off_5A148;
          }
        }
        ++v23;
        v24 += 32i64;
      }
      while ( v23 < 0x4D );
    }
    if ( v18 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v18->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v18->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_13EE0(*(_QWORD *)&v18->AlignmentRequirement, 0x55u, (__int64)&unk_57C68, qword_5D3B8, qword_5D3C0);
      v18 = off_5A148;
    }
    if ( qword_5D3C0 )
    {
      v26 = *(_QWORD *)(qword_5D3C0 + 1112);
      if ( v26 )
      {
        v10 = (*(__int64 (__fastcall **)(PVOID))(v26 + 8))(qword_5D3B8);
        if ( !v10 )
        {
          byte_5D3E3 = 1;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x57u, (__int64)&unk_57C68, 0);
          }
          return 0i64;
        }
        v18 = off_5A148;
      }
    }
    if ( v18 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v18->DeviceQueue.DeviceListHead.Flink) & 1) == 0
      || !BYTE1(v18->DeviceQueue.DeviceListHead.Flink) )
    {
      return 260i64;
    }
    v16 = *(_QWORD *)&v18->AlignmentRequirement;
    v5 = 86;
    v6 = v10;
LABEL_54:
    sub_13EA4(v16, v5, (__int64)&unk_57C68, v6);
    return 260i64;
  }
  v19 = 0;
  v20 = 0i64;
  while ( 1 )
  {
    if ( v18 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v18->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v18->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_39144(
        *(_QWORD *)&v18->AlignmentRequirement,
        0x4Fu,
        (__int64)&unk_57C68,
        qword_5D3B8,
        qword_5D3C0,
        (char *)qword_5D3C8 + 64 * (unsigned __int64)v19);
      v18 = off_5A148;
    }
    if ( !*(_DWORD *)((char *)qword_5D3C8 + v20) )
      goto LABEL_70;
    v21 = 1796;
    if ( !qword_5D3C0 )
      goto LABEL_99;
    v22 = *(_QWORD *)(qword_5D3C0 + 1112);
    if ( !v22 )
      goto LABEL_99;
    v21 = (*(__int64 (__fastcall **)(__int64, char *, __int64, __int64))(v22 + 64))(
            qword_5D3C0,
            (char *)qword_5D3C8 + 64 * (unsigned __int64)v19,
            v15,
            1796i64);
    if ( v21 )
      break;
    v18 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x51u, (__int64)&unk_57C68, v19);
      v18 = off_5A148;
    }
LABEL_70:
    ++v19;
    v20 += 64i64;
    if ( v19 >= 0x4D )
      goto LABEL_71;
  }
  v18 = off_5A148;
LABEL_99:
  if ( v18 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v18->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v18->DeviceQueue.DeviceListHead.Flink) )
  {
    v27 = 80;
    goto LABEL_103;
  }
  return 260i64;
}
// 41D19: variable 'v15' is possibly undefined
// 5D3B0: using guessed type int dword_5D3B0;
// 5D3C0: using guessed type __int64 qword_5D3C0;
// 5D3D8: using guessed type int dword_5D3D8;
// 5D3DC: using guessed type int dword_5D3DC;
// 5D3E0: using guessed type char byte_5D3E0;
// 5D3E1: using guessed type char byte_5D3E1;
// 5D3E3: using guessed type char byte_5D3E3;
// 5D3F0: using guessed type __int64 qword_5D3F0;

//----- (0000000000042000) ----------------------------------------------------
__int64 sub_42000()
{
  PDEVICE_OBJECT v0; // rcx
  unsigned int v2; // ebx
  __int64 v3; // rdx
  unsigned int v4; // eax
  PVOID v5; // rdi
  __int64 v6; // rax
  int v7; // esi
  int v8; // eax
  int v9; // er11
  char v10; // al
  __int64 v11; // rax
  __int64 v12; // r8
  int v13; // eax
  __int64 v14; // rdx
  __int64 v15; // [rsp+20h] [rbp-28h]
  __int64 v16; // [rsp+50h] [rbp+8h] BYREF

  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x58u, (__int64)&unk_57C68);
    v0 = off_5A148;
  }
  if ( !byte_5D3E3 )
  {
    if ( v0 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v0->AlignmentRequirement, 0x59u, (__int64)&unk_57C68);
    }
    return 260i64;
  }
  if ( v0 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_12D64(*(_QWORD *)&v0->AlignmentRequirement, 0x5Au, (__int64)&unk_57C68, qword_5D3C0);
    v0 = off_5A148;
  }
  v2 = 0;
  if ( qword_5D3C0 )
  {
    v3 = *(_QWORD *)(qword_5D3C0 + 1112);
    if ( v3 )
    {
      v4 = (*(__int64 (__fastcall **)(__int64))(v3 + 88))(qword_5D3C0);
      v0 = off_5A148;
      v2 = v4;
    }
  }
  if ( v0 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_4AC00(*(_QWORD *)&v0->AlignmentRequirement, 0x5Bu, (__int64)&unk_57C68, qword_5D3B8, v2);
    v0 = off_5A148;
  }
  v5 = qword_5D3B8;
  v6 = 0i64;
  v7 = 1796;
  v16 = 0i64;
  if ( qword_5D3B8 )
  {
    v8 = (*(__int64 (__fastcall **)(_QWORD, __int64, __int64 *))(*((_QWORD *)qword_5D3B8 + 1) + 8i64))(
           **((_QWORD **)qword_5D3B8 + 1),
           1i64,
           &v16);
    v0 = off_5A148;
    v9 = v8;
    v6 = v16;
  }
  else
  {
    v9 = 1796;
  }
  if ( !v9 )
  {
    v10 = (*(__int64 (__fastcall **)(PVOID, _QWORD))(v6 + 80))(v5, v2);
    v0 = off_5A148;
    if ( v10 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        LODWORD(v15) = v2;
        sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x5Du, (__int64)&unk_57C68, qword_5D3B8, v15);
        v0 = off_5A148;
      }
      v11 = qword_5D3C0;
      if ( qword_5D3C0 )
      {
        v12 = *(_QWORD *)(qword_5D3C0 + 1112);
        if ( v12 )
        {
          v13 = (*(__int64 (__fastcall **)(PVOID, __int64))(v12 + 16))(qword_5D3B8, qword_5D3C0);
          v0 = off_5A148;
          v7 = v13;
          v11 = qword_5D3C0;
        }
      }
      if ( v7 )
      {
        if ( v0 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_13EA4(*(_QWORD *)&v0->AlignmentRequirement, 0x5Eu, (__int64)&unk_57C68, v7 != 0);
        }
        return 257i64;
      }
      if ( v0 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&v0->AlignmentRequirement, 0x5Fu, (__int64)&unk_57C68);
        v0 = off_5A148;
        v11 = qword_5D3C0;
      }
      if ( !v11 )
        goto LABEL_52;
      v14 = *(_QWORD *)(v11 + 1112);
      if ( !v14 )
        goto LABEL_52;
      (*(void (__fastcall **)(__int64))(v14 + 32))(v11);
      goto LABEL_51;
    }
  }
  if ( v0 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) == 0 || BYTE1(v0->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
LABEL_52:
      if ( v0 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&v0->AlignmentRequirement, 0x60u, (__int64)&unk_57C68, qword_5D3B8);
      }
      goto LABEL_56;
    }
    sub_11088(*(_QWORD *)&v0->AlignmentRequirement, 0x5Cu, (__int64)&unk_57C68);
LABEL_51:
    v0 = off_5A148;
    goto LABEL_52;
  }
LABEL_56:
  sub_538D4(qword_5D3B8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x61u, (__int64)&unk_57C68, 0);
  }
  return 0i64;
}
// 421C8: variable 'v15' is possibly undefined
// 5D3C0: using guessed type __int64 qword_5D3C0;
// 5D3E3: using guessed type char byte_5D3E3;

//----- (0000000000042360) ----------------------------------------------------
__int64 __fastcall sub_42360(int a1, const void *a2, unsigned int a3, int a4, int *a5)
{
  unsigned int v5; // edi
  size_t v7; // rbp
  PDEVICE_OBJECT v10; // r10
  __int64 v11; // rdx
  int v12; // er9
  __int64 v13; // rax
  int v15; // eax
  PDEVICE_OBJECT v16; // rcx
  __int64 v17; // rdx
  int *v18; // rbx
  PDEVICE_OBJECT v19; // rcx
  char v20[8]; // [rsp+40h] [rbp-38h] BYREF
  __int64 v21; // [rsp+48h] [rbp-30h] BYREF
  int v22; // [rsp+80h] [rbp+8h] BYREF

  v5 = 0;
  v7 = a3;
  v21 = 0i64;
  v22 = 0;
  v10 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_4015C(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x62u, (__int64)&unk_57C68, a1);
      v10 = off_5A148;
    }
    if ( v10 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v10->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_401BC(*(_QWORD *)&v10->AlignmentRequirement, 0x63u, (__int64)&unk_57C68, qword_5D3B8, &unk_5CFA0, v7, &v21);
      v10 = off_5A148;
    }
  }
  v11 = *((_QWORD *)qword_5D3C8 + 8 * (unsigned __int64)(unsigned int)(a1 - 40000) + 2);
  v21 = 0i64;
  if ( !qword_5D3B8 )
  {
    v12 = 1799;
    goto LABEL_15;
  }
  if ( !v11 )
  {
    v12 = 1796;
    goto LABEL_15;
  }
  v13 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(*((_QWORD *)qword_5D3B8 + 5) + 16i64))(
          **((_QWORD **)qword_5D3B8 + 5),
          v11,
          (unsigned int)v7);
  v21 = v13;
  if ( !v13 )
  {
    v10 = off_5A148;
    v12 = 1798;
LABEL_15:
    if ( v10 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v10->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&v10->AlignmentRequirement, 0x64u, (__int64)&unk_57C68, v12);
    }
    return 1i64;
  }
  if ( a4 )
  {
    *(_DWORD *)(v13 + 32) = a4;
    v13 = v21;
  }
  memmove(*(void **)(v13 + 56), a2, v7);
  v15 = sub_53944((__int64)qword_5D3B8, v21);
  if ( v15 )
  {
    v16 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x66u, (__int64)&unk_57C68, v15);
      v16 = off_5A148;
    }
    v5 = 263;
  }
  else
  {
    v16 = off_5A148;
  }
  v17 = v21;
  if ( qword_5D3B8 && v21 )
  {
    v18 = a5;
    (*(void (__fastcall **)(_QWORD, __int64, int *, int *, char *, _QWORD))(*((_QWORD *)qword_5D3B8 + 5) + 32i64))(
      **((_QWORD **)qword_5D3B8 + 5),
      v21,
      &v22,
      a5,
      v20,
      0i64);
    v17 = v21;
  }
  else
  {
    if ( v16 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v16->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v16->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11088(*(_QWORD *)&v16->AlignmentRequirement, 0x67u, (__int64)&unk_57C68);
      v17 = v21;
    }
    v18 = a5;
    *a5 = 0;
  }
  v19 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x68u, (__int64)&unk_57C68, *v18);
    v17 = v21;
    v19 = off_5A148;
  }
  if ( v17 && qword_5D3B8 )
  {
    (*(void (__fastcall **)(_QWORD))(*((_QWORD *)qword_5D3B8 + 5) + 24i64))(**((_QWORD **)qword_5D3B8 + 5));
    v19 = off_5A148;
  }
  if ( v19 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v19->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(v19->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v19->AlignmentRequirement, 0x69u, (__int64)&unk_57C68, v5);
  }
  return v5;
}

//----- (0000000000042684) ----------------------------------------------------
__int64 __fastcall sub_42684(int a1, const void *a2, unsigned int a3, int a4, int *a5, void (__fastcall *a6)(const void *, _QWORD, PVOID, _QWORD, const void *, unsigned int))
{
  size_t v7; // rsi
  const void *v8; // r13
  unsigned int v10; // er12
  PVOID v11; // rbp
  PDEVICE_OBJECT v12; // r10
  __int64 v13; // rdx
  int v14; // er9
  __int64 v15; // rax
  int v17; // eax
  __int64 v18; // r8
  int *v19; // rbx
  PDEVICE_OBJECT v20; // rcx
  __int64 v21; // r9
  unsigned __int16 v22; // dx
  const void *v23; // [rsp+20h] [rbp-58h]
  unsigned int v24; // [rsp+28h] [rbp-50h]
  int v25; // [rsp+40h] [rbp-38h] BYREF
  __int64 v26; // [rsp+48h] [rbp-30h] BYREF
  unsigned int v27; // [rsp+80h] [rbp+8h] BYREF

  v7 = a3;
  v8 = a2;
  v10 = 0;
  v26 = 0i64;
  v25 = 0;
  v27 = 0;
  v11 = 0i64;
  v12 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v24 = a3;
      v23 = a2;
      sub_4015C(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Au, (__int64)&unk_57C68, a1);
      v12 = off_5A148;
    }
    if ( v12 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v12->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v12->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_401BC(*(_QWORD *)&v12->AlignmentRequirement, 0x6Bu, (__int64)&unk_57C68, qword_5D3B8, &unk_5CFA0, v7, &v26);
      v12 = off_5A148;
    }
  }
  v13 = *((_QWORD *)qword_5D3C8 + 8 * (unsigned __int64)(unsigned int)(a1 - 40000) + 2);
  v26 = 0i64;
  if ( !qword_5D3B8 )
  {
    v14 = 1799;
    goto LABEL_15;
  }
  if ( !v13 )
  {
    v14 = 1796;
    goto LABEL_15;
  }
  v15 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(*((_QWORD *)qword_5D3B8 + 5) + 16i64))(
          **((_QWORD **)qword_5D3B8 + 5),
          v13,
          (unsigned int)v7);
  v26 = v15;
  if ( !v15 )
  {
    v12 = off_5A148;
    v14 = 1798;
LABEL_15:
    if ( v12 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v12->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v12->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&v12->AlignmentRequirement, 0x6Cu, (__int64)&unk_57C68, v14);
    }
    return 1i64;
  }
  if ( a4 )
  {
    *(_DWORD *)(v15 + 32) = a4;
    v15 = v26;
  }
  memmove(*(void **)(v15 + 56), v8, v7);
  v17 = sub_53944((__int64)qword_5D3B8, v26);
  if ( v17 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Eu, (__int64)&unk_57C68, v17);
    }
    v10 = 263;
  }
  if ( qword_5D3B8 && v26 )
  {
    v19 = a5;
    (*(void (__fastcall **)(_QWORD, __int64, int *, int *, unsigned int *, _QWORD))(*((_QWORD *)qword_5D3B8 + 5) + 32i64))(
      **((_QWORD **)qword_5D3B8 + 5),
      v26,
      &v25,
      a5,
      &v27,
      0i64);
  }
  else
  {
    v19 = a5;
    *a5 = 0;
  }
  v20 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Fu, (__int64)&unk_57C68, *v19);
    v20 = off_5A148;
  }
  if ( !qword_5D3B8 )
  {
    v21 = 1799i64;
    goto LABEL_64;
  }
  if ( !v26 )
  {
    v21 = 1796i64;
    goto LABEL_64;
  }
  (*(void (__fastcall **)(_QWORD, __int64, int *, int *, unsigned int *, _QWORD))(*((_QWORD *)qword_5D3B8 + 5) + 32i64))(
    **((_QWORD **)qword_5D3B8 + 5),
    v26,
    &v25,
    v19,
    &v27,
    0i64);
  v21 = 0i64;
  if ( v27 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x70u, (__int64)&unk_57C68, v27);
    }
    v24 = 0;
    v23 = 0i64;
    v11 = sub_3C4EC(2, v27, 0x726D624Eu);
    if ( v11 )
    {
      if ( !qword_5D3B8 )
      {
        v21 = 1799i64;
        goto LABEL_50;
      }
      if ( !v26 )
      {
        v21 = 1796i64;
LABEL_50:
        v20 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
          || !_bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
          || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
        {
          goto LABEL_69;
        }
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x72u, (__int64)&unk_57C68, v21);
        goto LABEL_68;
      }
      (*(void (__fastcall **)(_QWORD, __int64, int *, int *, unsigned int *, PVOID))(*((_QWORD *)qword_5D3B8 + 5) + 32i64))(
        **((_QWORD **)qword_5D3B8 + 5),
        v26,
        &v25,
        v19,
        &v27,
        v11);
      v20 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 4u )
      {
        goto LABEL_69;
      }
      v22 = 113;
    }
    else
    {
      v20 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_69;
      }
      v22 = 115;
    }
    sub_11088(*(_QWORD *)&v20->AlignmentRequirement, v22, (__int64)&unk_57C68);
    goto LABEL_68;
  }
  v20 = off_5A148;
LABEL_64:
  if ( v20 == (PDEVICE_OBJECT)&off_5A148
    || !_bittest((const signed __int32 *)&v20->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    || BYTE1(v20->DeviceQueue.DeviceListHead.Flink) < 2u )
  {
    goto LABEL_69;
  }
  LODWORD(v23) = v27;
  sub_184C0(*(_QWORD *)&v20->AlignmentRequirement, 0x74u, (__int64)&unk_57C68, v21);
LABEL_68:
  v20 = off_5A148;
LABEL_69:
  if ( a6 )
  {
    a6(v8, *(_QWORD *)(v26 + 56), v11, v27, v23, v24);
    v20 = off_5A148;
  }
  if ( v11 )
  {
    sub_3C570(v11, 0x726D624Eu);
    v20 = off_5A148;
  }
  if ( v26 && qword_5D3B8 )
  {
    (*(void (__fastcall **)(_QWORD, __int64, __int64, __int64))(*((_QWORD *)qword_5D3B8 + 5) + 24i64))(
      **((_QWORD **)qword_5D3B8 + 5),
      v26,
      v18,
      v21);
    v20 = off_5A148;
  }
  if ( v20 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v20->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(v20->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v20->AlignmentRequirement, 0x75u, (__int64)&unk_57C68, v10);
  }
  return v10;
}
// 42B50: variable 'v23' is possibly undefined
// 42B50: variable 'v24' is possibly undefined
// 42B97: variable 'v18' is possibly undefined
// 42B97: variable 'v21' is possibly undefined

//----- (0000000000042BFC) ----------------------------------------------------
__int64 __fastcall sub_42BFC(int a1, const void *a2, unsigned int a3, _DWORD *a4)
{
  size_t v5; // rdi
  const void *v6; // rsi
  __int64 v8; // rdx
  int v9; // eax
  __int64 v10; // rax
  __int64 v11; // rbx
  PDEVICE_OBJECT v13; // rcx
  _QWORD *v14; // rdx
  int v15; // eax
  const void *v16; // [rsp+20h] [rbp-28h]

  v5 = a3;
  v6 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v16 = a2;
    sub_4015C(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x7Eu, (__int64)&unk_57C68, a1);
  }
  *a4 = 0;
  v8 = *((_QWORD *)qword_5D3C8 + 8 * (unsigned __int64)(unsigned int)(a1 - 40000) + 2);
  if ( !qword_5D3B8 )
  {
    v9 = 1799;
LABEL_11:
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x7Fu, (__int64)&unk_57C68, v9);
    }
    return 1i64;
  }
  if ( !v8 )
  {
    v9 = 1796;
    goto LABEL_11;
  }
  v10 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(*((_QWORD *)qword_5D3B8 + 5) + 16i64))(
          **((_QWORD **)qword_5D3B8 + 5),
          v8,
          (unsigned int)v5);
  v11 = v10;
  if ( !v10 )
  {
    v9 = 1798;
    goto LABEL_11;
  }
  memmove(*(void **)(v10 + 56), v6, v5);
  v13 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_39144(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x81u, (__int64)&unk_57C68, qword_5D3B8, v11, sub_42E50);
    v13 = off_5A148;
  }
  v14 = qword_5D3B8;
  if ( !qword_5D3B8 )
  {
    v15 = 1799;
LABEL_26:
    if ( v13 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v13->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v13->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&v13->AlignmentRequirement, 0x82u, (__int64)&unk_57C68, v15);
      v14 = qword_5D3B8;
    }
    if ( v14 )
      (*(void (__fastcall **)(_QWORD, __int64))(v14[5] + 24i64))(*(_QWORD *)v14[5], v11);
    return 1i64;
  }
  if ( sub_42E50 )
  {
    LOBYTE(v16) = 0;
    v15 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, const void *, __int64 (__fastcall *)(__int64, __int64, __int64)))(*((_QWORD *)qword_5D3B8 + 3) + 16i64))(
            **((_QWORD **)qword_5D3B8 + 3),
            v11,
            0i64,
            0i64,
            v16,
            sub_42E50);
    v13 = off_5A148;
    v14 = qword_5D3B8;
  }
  else
  {
    v15 = 1796;
  }
  if ( v15 )
    goto LABEL_26;
  if ( v13 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v13->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(v13->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v13->AlignmentRequirement, 0x83u, (__int64)&unk_57C68, 0);
  }
  return 0i64;
}
// 42D90: variable 'v16' is possibly undefined

//----- (0000000000042E50) ----------------------------------------------------
__int64 __fastcall sub_42E50(__int64 a1, __int64 a2, __int64 a3)
{
  unsigned int v3; // esi
  PDEVICE_OBJECT v7; // rcx
  void (__fastcall *v9)(_QWORD, _QWORD, _QWORD, int *); // rdi
  unsigned __int16 v10; // dx
  char v11[40]; // [rsp+40h] [rbp-28h] BYREF
  int v12; // [rsp+80h] [rbp+18h] BYREF
  char v13; // [rsp+88h] [rbp+20h] BYREF

  v3 = 0;
  v12 = 0;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_39144(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x84u, (__int64)&unk_57C68, a1, a2, a3);
    v7 = off_5A148;
  }
  if ( a3 )
  {
    if ( a2 )
    {
      v9 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, int *))(a2 + 8);
      if ( v9 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
          && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_3F3E4(*(_QWORD *)&v7->AlignmentRequirement, 0x86u, (__int64)&unk_57C68, qword_5D3B8, a3, &v13, &v12);
          v7 = off_5A148;
        }
        if ( qword_5D3B8 )
        {
          (*(void (__fastcall **)(_QWORD, __int64, char *, int *, char *, _QWORD))(*((_QWORD *)qword_5D3B8 + 5) + 32i64))(
            **((_QWORD **)qword_5D3B8 + 5),
            a3,
            &v13,
            &v12,
            v11,
            0i64);
        }
        else
        {
          v3 = 1799;
          if ( v7 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
            && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            sub_13EA4(*(_QWORD *)&v7->AlignmentRequirement, 0x87u, (__int64)&unk_57C68, 1799);
          }
        }
        v9(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), &v12);
        if ( qword_5D3B8 )
          (*(void (__fastcall **)(_QWORD, __int64))(*((_QWORD *)qword_5D3B8 + 5) + 24i64))(
            **((_QWORD **)qword_5D3B8 + 5),
            a3);
        goto LABEL_34;
      }
      if ( v7 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
          && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          v10 = 136;
LABEL_33:
          sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v10, (__int64)&unk_57C68);
LABEL_34:
          v7 = off_5A148;
          goto LABEL_35;
        }
        goto LABEL_35;
      }
    }
    else if ( v7 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        v10 = 137;
        goto LABEL_33;
      }
LABEL_35:
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&v7->AlignmentRequirement, 0x8Au, (__int64)&unk_57C68, v3);
      }
      return v3;
    }
    return v3;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0x85u, (__int64)&unk_57C68);
  }
  return 3899654172i64;
}

//----- (00000000000430A8) ----------------------------------------------------
__int64 __fastcall sub_430A8(unsigned int *a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 result; // rax

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x8Bu, (__int64)&unk_57C68);
    v2 = off_5A148;
  }
  qword_5D3F0 = 0i64;
  qword_5D3F8 = 0i64;
  qword_5D400 = 0i64;
  qword_5D3F0 = *a1;
  HIDWORD(qword_5D3F0) = *((unsigned __int8 *)a1 + 4);
  qword_5D3F8 = *((_QWORD *)a1 + 1);
  if ( *((_QWORD *)a1 + 2) )
  {
    qword_5D400 = (__int64)sub_43204;
    qword_5D3E8 = (__int64 (__fastcall *)(_QWORD))*((_QWORD *)a1 + 2);
    if ( v2 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 1) != 0 && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&v2->AlignmentRequirement, 0x8Cu, (__int64)&unk_57C68);
        v2 = off_5A148;
      }
      if ( v2 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&v2->AlignmentRequirement, 0x8Eu, (__int64)&unk_57C68, 0);
      }
    }
    result = 0i64;
  }
  else
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v2->AlignmentRequirement, 0x8Du, (__int64)&unk_57C68);
    }
    result = 264i64;
  }
  return result;
}
// 5D3E8: using guessed type __int64 (__fastcall *qword_5D3E8)(_QWORD);
// 5D3F0: using guessed type __int64 qword_5D3F0;
// 5D3F8: using guessed type __int64 qword_5D3F8;
// 5D400: using guessed type __int64 qword_5D400;

//----- (0000000000043204) ----------------------------------------------------
__int64 __fastcall sub_43204(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v4; // rcx

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x8Fu, (__int64)&unk_57C68);
      v4 = off_5A148;
    }
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v4->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_12D64(*(_QWORD *)&v4->AlignmentRequirement, 0x90u, (__int64)&unk_57C68, a3);
      v4 = off_5A148;
    }
  }
  if ( qword_5D3E8 )
  {
    qword_5D3E8(a3);
    v4 = off_5A148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v4->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v4->AlignmentRequirement, 0x91u, (__int64)&unk_57C68, 0);
  }
  return 0i64;
}
// 5D3E8: using guessed type __int64 (__fastcall *qword_5D3E8)(_QWORD);

//----- (00000000000432F0) ----------------------------------------------------
__int64 __fastcall sub_432F0(__int64 a1, int a2, unsigned int a3, void *a4)
{
  unsigned int v8; // ebx
  PDEVICE_OBJECT v9; // rcx
  _DWORD *v11; // rdi
  __int64 v12; // r8
  int v13; // eax

  v8 = 6;
  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_184C0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x92u, (__int64)&unk_57C68, a2);
    v9 = off_5A148;
  }
  if ( !byte_5D3E3 )
  {
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v9->AlignmentRequirement, 0x93u, (__int64)&unk_57C68);
    }
    return 260i64;
  }
  v11 = *(_DWORD **)(a1 + 56);
  if ( v11 )
  {
    if ( a2
      && v9 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_13EA4(*(_QWORD *)&v9->AlignmentRequirement, 0x94u, (__int64)&unk_57C68, a2);
      v9 = off_5A148;
    }
    v12 = a2 != 0 ? 0x80000000 : 0;
    if ( *v11 == 3 || *v11 == 8 )
    {
      v13 = sub_53988((__int64)qword_5D3B8, a1, v12, a3, a4);
    }
    else
    {
      if ( !qword_5D3B8 )
      {
        v13 = 1799;
        goto LABEL_24;
      }
      v13 = (*(__int64 (__fastcall **)(_QWORD, __int64, __int64, _QWORD, _QWORD))(*((_QWORD *)qword_5D3B8 + 3) + 24i64))(
              **((_QWORD **)qword_5D3B8 + 3),
              a1,
              v12,
              0i64,
              0i64);
    }
    v9 = off_5A148;
LABEL_24:
    if ( v13 )
    {
      if ( v9 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&v9->AlignmentRequirement, 0x95u, (__int64)&unk_57C68, v13);
        v9 = off_5A148;
      }
      v8 = 273;
    }
    else
    {
      v8 = 0;
    }
  }
  if ( v9 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v9->AlignmentRequirement, 0x96u, (__int64)&unk_57C68, v8);
  }
  return v8;
}
// 5D3E3: using guessed type char byte_5D3E3;

//----- (00000000000434EC) ----------------------------------------------------
__int64 __fastcall sub_434EC(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, _QWORD, __int64, unsigned int *); // rax
  unsigned int v8; // ebx
  unsigned int v9; // eax
  unsigned __int16 v11; // dx
  unsigned int v12; // [rsp+58h] [rbp+20h] BYREF

  v12 = 3;
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_39144(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x97u, (__int64)&unk_57C68, a1, a2, a3);
      v6 = off_5A148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0x98u, (__int64)&unk_57C68, *(_DWORD *)a3);
      v6 = off_5A148;
    }
  }
  if ( !byte_5D3E4 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x99u, (__int64)&unk_57C68);
    }
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_37;
      }
      v11 = 157;
LABEL_36:
      sub_11088(*(_QWORD *)&v6->AlignmentRequirement, v11, (__int64)&unk_57C68);
      v6 = off_5A148;
      goto LABEL_37;
    }
    return 0i64;
  }
  v7 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, __int64, unsigned int *))(a2 + 8);
  if ( !v7 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_37;
      }
      v11 = 156;
      goto LABEL_36;
    }
    return 0i64;
  }
  v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), a3, &v12);
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x9Au, (__int64)&unk_57C68, v12);
    v6 = off_5A148;
  }
  if ( !qword_5D3B8 )
  {
    v8 = 1799;
    goto LABEL_23;
  }
  v9 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, _QWORD))(*((_QWORD *)qword_5D3B8 + 3) + 24i64))(
         **((_QWORD **)qword_5D3B8 + 3),
         a3,
         v12,
         0i64,
         0i64);
  v6 = off_5A148;
  v8 = v9;
  if ( !v9 )
  {
LABEL_37:
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0x9Eu, (__int64)&unk_57C68, 0);
    }
    return 0i64;
  }
LABEL_23:
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0x9Bu, (__int64)&unk_57C68, v8);
  }
  return v8;
}
// 5D3E4: using guessed type char byte_5D3E4;

//----- (0000000000043760) ----------------------------------------------------
__int64 __fastcall sub_43760(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, _QWORD, unsigned int *, PVOID *, __int64 *); // rax
  PDEVICE_OBJECT v8; // rcx
  int v9; // eax
  unsigned int v10; // ebx
  unsigned __int16 v12; // dx
  __int64 v13; // [rsp+20h] [rbp-28h]
  __int64 Tag; // [rsp+30h] [rbp-18h] BYREF
  PVOID P[2]; // [rsp+38h] [rbp-10h] BYREF
  unsigned int v16; // [rsp+68h] [rbp+20h] BYREF

  P[0] = 0i64;
  v16 = 0;
  LODWORD(Tag) = 0;
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_39144(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x9Fu, (__int64)&unk_57C68, a1, a2, a3, Tag);
      v6 = off_5A148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0xA0u, (__int64)&unk_57C68, *(_DWORD *)a3);
      v6 = off_5A148;
    }
  }
  if ( !byte_5D3E4 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0xA1u, (__int64)&unk_57C68);
    }
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_46;
    }
    v12 = 167;
    goto LABEL_44;
  }
  v7 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, unsigned int *, PVOID *, __int64 *))(a2 + 16);
  if ( !v7 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_46;
    }
    v12 = 166;
LABEL_44:
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, v12, (__int64)&unk_57C68);
    goto LABEL_45;
  }
  v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), &v16, P, &Tag);
  v8 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xA2u, (__int64)&unk_57C68, 5);
      v8 = off_5A148;
    }
    if ( v8 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v8->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v8->AlignmentRequirement, 0xA3u, (__int64)&unk_57C68, v16);
    }
  }
  v9 = sub_53988((__int64)qword_5D3B8, a3, 5i64, v16, P[0]);
  v10 = v9;
  if ( !v9 )
  {
    if ( !P[0] || !v16 )
      goto LABEL_45;
    LODWORD(v13) = 0;
    sub_3C570(P[0], Tag);
    v6 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xA5u, (__int64)&unk_57C68, P[0], v13);
LABEL_45:
        v6 = off_5A148;
      }
LABEL_46:
      if ( v6 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
        && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0xA8u, (__int64)&unk_57C68, 0);
      }
    }
    return 0i64;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xA4u, (__int64)&unk_57C68, v9);
  }
  return v10;
}
// 439CF: variable 'v13' is possibly undefined
// 5D3E4: using guessed type char byte_5D3E4;

//----- (0000000000043A78) ----------------------------------------------------
__int64 sub_43A78()
{
  PDEVICE_OBJECT v0; // rcx
  __int64 result; // rax
  int v2; // eax
  unsigned int v3; // ebx

  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xE3u, (__int64)&unk_57C68);
    v0 = off_5A148;
  }
  if ( byte_5D3E2 )
  {
    v2 = sub_40498(40005, 2);
    v3 = v2;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xE5u, (__int64)&unk_57C68, v2);
    }
    result = v3;
  }
  else
  {
    if ( v0 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v0->AlignmentRequirement, 0xE4u, (__int64)&unk_57C68);
    }
    result = 258i64;
  }
  return result;
}
// 5D3E2: using guessed type char byte_5D3E2;

//----- (0000000000043B68) ----------------------------------------------------
__int64 __fastcall sub_43B68(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, __int64, __int64); // rax
  unsigned __int16 v8; // dx

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_39144(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xF7u, (__int64)&unk_57C68, a1, a2, a3);
      v6 = off_5A148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0xF8u, (__int64)&unk_57C68, *(_DWORD *)a3);
      v6 = off_5A148;
    }
  }
  if ( !byte_5D3E4 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0xF9u, (__int64)&unk_57C68);
    }
    return 0i64;
  }
  if ( a2 )
  {
    v7 = *(void (__fastcall **)(_QWORD, _QWORD, __int64, __int64))(a2 + 24);
    if ( v7 )
    {
      v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), 1024i64, a1);
      v6 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) == 0
        || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 4u )
      {
        goto LABEL_30;
      }
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xFAu, (__int64)&unk_57C68, 3);
      goto LABEL_29;
    }
    if ( v6 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) == 0 || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      goto LABEL_30;
    v8 = 251;
  }
  else
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) == 0 || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      goto LABEL_30;
    v8 = 252;
  }
  sub_11088(*(_QWORD *)&v6->AlignmentRequirement, v8, (__int64)&unk_57C68);
LABEL_29:
  v6 = off_5A148;
LABEL_30:
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0xFDu, (__int64)&unk_57C68, 0);
  }
  return 0i64;
}
// 43C6B: variable 'a1' is possibly undefined
// 5D3E4: using guessed type char byte_5D3E4;

//----- (0000000000043D48) ----------------------------------------------------
__int64 __fastcall sub_43D48(int a1)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 result; // rax
  int v4; // eax
  unsigned int v5; // ebx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xFEu, (__int64)&unk_57C68);
    v2 = off_5A148;
  }
  if ( byte_5D3E2 )
  {
    v4 = sub_40498(a1, 2);
    v5 = v4;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x100u, (__int64)&unk_57C68, v4);
    }
    result = v5;
  }
  else
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v2->AlignmentRequirement, 0xFFu, (__int64)&unk_57C68);
    }
    result = 258i64;
  }
  return result;
}
// 5D3E2: using guessed type char byte_5D3E2;

//----- (0000000000043E38) ----------------------------------------------------
__int64 sub_43E38()
{
  PDEVICE_OBJECT v0; // rcx
  __int64 result; // rax
  _QWORD *v2; // rax
  _QWORD *v3; // rcx
  PDEVICE_OBJECT v4; // rcx

  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x101u, (__int64)&unk_57C68);
    v0 = off_5A148;
  }
  if ( byte_5D3E2 )
  {
    if ( !dword_5D3DC )
    {
      qword_5CF98 = (__int64)&qword_5CF90;
      qword_5CF90 = &qword_5CF90;
    }
    v2 = sub_3C4EC(2, 0x48u, 0x746D436Eu);
    if ( v2 )
    {
      v2[4] = 0i64;
      v2[6] = 0i64;
      *((_DWORD *)v2 + 6) = 1;
      *((_DWORD *)v2 + 7) = 7;
      v2[7] = sub_3854C;
      *((_DWORD *)v2 + 4) = 40020;
      v2[8] = &qword_5CF80;
      v3 = (_QWORD *)qword_5CF98;
      *v2 = &qword_5CF90;
      v2[1] = v3;
      *v3 = v2;
      ++dword_5D3DC;
      qword_5CF98 = (__int64)v2;
      v4 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x104u, (__int64)&unk_57C68, 40020);
          v4 = off_5A148;
        }
        if ( v4 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_13EA4(*(_QWORD *)&v4->AlignmentRequirement, 0x105u, (__int64)&unk_57C68, 0);
        }
      }
      result = 0i64;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x103u, (__int64)&unk_57C68);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v0 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v0->AlignmentRequirement, 0x102u, (__int64)&unk_57C68);
    }
    result = 258i64;
  }
  return result;
}
// 5CF98: using guessed type __int64 qword_5CF98;
// 5D3DC: using guessed type int dword_5D3DC;
// 5D3E2: using guessed type char byte_5D3E2;

//----- (0000000000044024) ----------------------------------------------------
__int64 sub_44024()
{
  PDEVICE_OBJECT v0; // rcx
  __int64 result; // rax
  _QWORD *v2; // rax
  _QWORD *v3; // r11
  _QWORD *v4; // rax
  PDEVICE_OBJECT v5; // rcx

  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x106u, (__int64)&unk_57C68);
    v0 = off_5A148;
  }
  if ( byte_5D3E2 )
  {
    if ( !dword_5D3DC )
    {
      qword_5CF98 = (__int64)&qword_5CF90;
      qword_5CF90 = &qword_5CF90;
    }
    v2 = sub_3C4EC(2, 0x48u, 0x746D436Eu);
    v3 = v2;
    if ( v2 )
    {
      v2[4] = 0i64;
      v2[6] = 0i64;
      v2[7] = 0i64;
      *((_DWORD *)v2 + 6) = 1;
      *((_DWORD *)v2 + 7) = 7;
      *((_DWORD *)v2 + 4) = 40053;
      v2[5] = sub_3AC88;
      v2[8] = &qword_5CF80;
      v4 = (_QWORD *)qword_5CF98;
      *v3 = &qword_5CF90;
      v3[1] = v4;
      *v4 = v3;
      ++dword_5D3DC;
      qword_5CF98 = (__int64)v3;
      v5 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x109u, (__int64)&unk_57C68, 40053);
          v5 = off_5A148;
        }
        if ( v5 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 1) != 0
          && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_13EA4(*(_QWORD *)&v5->AlignmentRequirement, 0x10Au, (__int64)&unk_57C68, 0);
        }
      }
      result = 0i64;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x108u, (__int64)&unk_57C68);
      }
      result = 3i64;
    }
  }
  else
  {
    if ( v0 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v0->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v0->AlignmentRequirement, 0x107u, (__int64)&unk_57C68);
    }
    result = 258i64;
  }
  return result;
}
// 5CF98: using guessed type __int64 qword_5CF98;
// 5D3DC: using guessed type int dword_5D3DC;
// 5D3E2: using guessed type char byte_5D3E2;

//----- (000000000004421C) ----------------------------------------------------
__int64 __fastcall sub_4421C(int a1, const void *a2, unsigned int a3)
{
  unsigned int v3; // ebx
  size_t v4; // rsi
  PDEVICE_OBJECT v7; // r10
  unsigned int v9; // edi
  __int64 v10; // rdx
  __int64 v11; // rax
  __int64 v12; // rcx
  unsigned __int16 v13; // dx
  int v14; // eax
  PDEVICE_OBJECT v15; // rcx
  __int64 v16; // [rsp+78h] [rbp+20h] BYREF

  v3 = 0;
  v4 = a3;
  v16 = 0i64;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x10Bu, (__int64)&unk_57C68);
    v7 = off_5A148;
  }
  if ( !byte_5D3E3 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0x10Cu, (__int64)&unk_57C68);
    }
    return 260i64;
  }
  v9 = a1 - 40000;
  if ( v9 <= 0x4D )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_401BC(*(_QWORD *)&v7->AlignmentRequirement, 0x10Eu, (__int64)&unk_57C68, qword_5D3B8, &unk_5CFA0, v4, &v16);
      v7 = off_5A148;
    }
    v10 = *((_QWORD *)qword_5D3C8 + 8 * (unsigned __int64)v9 + 2);
    v16 = 0i64;
    if ( qword_5D3B8 )
    {
      if ( v10 )
      {
        v11 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(*((_QWORD *)qword_5D3B8 + 5) + 16i64))(
                **((_QWORD **)qword_5D3B8 + 5),
                v10,
                (unsigned int)v4);
        v16 = v11;
        if ( v11 )
        {
          memmove(*(void **)(v11 + 56), a2, v4);
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
          {
            sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x111u, (__int64)&unk_57C68, qword_5D3B8, v16);
          }
          v14 = sub_53944((__int64)qword_5D3B8, v16);
          if ( v14 )
          {
            v15 = off_5A148;
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
              && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
            {
              sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x112u, (__int64)&unk_57C68, v14);
              v15 = off_5A148;
            }
            v3 = 263;
          }
          else
          {
            v15 = off_5A148;
          }
          if ( v16 )
          {
            if ( qword_5D3B8 )
            {
              (*(void (__fastcall **)(_QWORD))(*((_QWORD *)qword_5D3B8 + 5) + 24i64))(**((_QWORD **)qword_5D3B8 + 5));
              v15 = off_5A148;
            }
            v16 = 0i64;
          }
          if ( v15 == (PDEVICE_OBJECT)&off_5A148
            || !_bittest((const signed __int32 *)&v15->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
            || BYTE1(v15->DeviceQueue.DeviceListHead.Flink) < 5u )
          {
            return v3;
          }
          v12 = *(_QWORD *)&v15->AlignmentRequirement;
          v13 = 275;
          goto LABEL_50;
        }
        v7 = off_5A148;
        v3 = 1798;
      }
      else
      {
        v3 = 1796;
      }
    }
    else
    {
      v3 = 1799;
    }
    if ( v7 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
      || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return v3;
    }
    v12 = *(_QWORD *)&v7->AlignmentRequirement;
    v13 = 271;
LABEL_50:
    sub_13EA4(v12, v13, (__int64)&unk_57C68, v3);
    return v3;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 0xDu)
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0x10Du, (__int64)&unk_57C68);
  }
  return 261i64;
}
// 5D3E3: using guessed type char byte_5D3E3;

//----- (0000000000044528) ----------------------------------------------------
__int64 __fastcall sub_44528(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, _QWORD, __int64); // rax
  unsigned __int16 v8; // dx

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_39144(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x114u, (__int64)&unk_57C68, a1, a2, a3);
      v6 = off_5A148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0x115u, (__int64)&unk_57C68, *(_DWORD *)a3);
      v6 = off_5A148;
    }
  }
  if ( !byte_5D3E4 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 0xAu)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x116u, (__int64)&unk_57C68);
    }
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) == 0 || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      goto LABEL_27;
    v8 = 280;
    goto LABEL_25;
  }
  v7 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, __int64))(a2 + 32);
  if ( !v7 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) == 0 || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      goto LABEL_27;
    v8 = 279;
LABEL_25:
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, v8, (__int64)&unk_57C68);
    goto LABEL_26;
  }
  v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), a1);
LABEL_26:
  v6 = off_5A148;
LABEL_27:
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0x119u, (__int64)&unk_57C68, 0);
  }
  return 0i64;
}
// 44629: variable 'a1' is possibly undefined
// 5D3E4: using guessed type char byte_5D3E4;

//----- (00000000000446CC) ----------------------------------------------------
__int64 sub_446CC()
{
  unsigned int v0; // ebx
  PDEVICE_OBJECT v1; // rcx
  int v2; // eax

  v0 = 0;
  v1 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x11Au, (__int64)&unk_57C68);
    v1 = off_5A148;
  }
  if ( qword_5D408 )
    goto LABEL_12;
  v2 = sub_40E90(9u, (__int64)&qword_5D408);
  v0 = v2;
  if ( !v2 )
    goto LABEL_11;
  v1 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v0;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x11Bu, (__int64)&unk_57C68, v2);
LABEL_11:
    v1 = off_5A148;
  }
LABEL_12:
  if ( v1 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v1->DeviceQueue.DeviceListHead.Flink) & 1) != 0
    && BYTE1(v1->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v1->AlignmentRequirement, 0x11Cu, (__int64)&unk_57C68, v0);
  }
  return v0;
}
// 5D408: using guessed type __int64 qword_5D408;

//----- (00000000000447C4) ----------------------------------------------------
__int64 __fastcall sub_447C4(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57C58, 115i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000044834) ----------------------------------------------------
__int64 __fastcall sub_44834(__int64 a1, __int64 a2, _QWORD *a3)
{
  bool v5; // r12
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  char *v8; // rbx
  unsigned int v9; // edi
  int v10; // er9
  unsigned int v11; // eax
  _WORD *v12; // rdx
  char *v13; // rax
  PVOID v14; // rax
  unsigned int v15; // edx
  __int64 v16; // r8
  _QWORD *v17; // rax
  char *v18; // rcx
  unsigned int *v19; // rbx
  unsigned int v20; // eax
  void *v21; // rcx
  void *v22; // rcx

  v5 = 0;
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xAu, (__int64)&unk_57C58);
    v6 = off_5A148;
  }
  if ( !a1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_12;
    }
    v7 = 11;
    goto LABEL_10;
  }
  v10 = *(_DWORD *)a1;
  if ( (*(_DWORD *)a1 & 0xFF000000) != 0x2000000 || (v10 & 0xFFFF00) == 0 || (_BYTE)v10 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0xCu, (__int64)&unk_57C58, v10);
      v6 = off_5A148;
    }
    v9 = 4;
    goto LABEL_57;
  }
  v11 = 0;
  v12 = (_WORD *)(a1 + 4);
  do
  {
    if ( !*v12 )
      break;
    ++v11;
    ++v12;
  }
  while ( v11 < 0x40 );
  if ( v11 < 0x40 )
  {
    if ( !a3 || !*a3 )
    {
      if ( v6 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_12;
      }
      sub_12D64(*(_QWORD *)&v6->AlignmentRequirement, 0xEu, (__int64)&unk_57C58, a3);
      goto LABEL_11;
    }
    v13 = (char *)sub_3C4EC(2, 0x210u, 0x66634E4Eu);
    v8 = v13;
    qword_5D410 = v13;
    if ( !v13 )
    {
      v6 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xFu, (__int64)&unk_57C58, 176);
        v6 = off_5A148;
        v8 = (char *)qword_5D410;
      }
      v9 = 3;
      goto LABEL_64;
    }
    memset(v13, 0, 0x210ui64);
    v5 = sub_46E8C((__int64)(v8 + 128));
    if ( !v5 )
    {
      v6 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x10u, (__int64)&unk_57C58);
        v6 = off_5A148;
      }
      v9 = 9;
LABEL_58:
      v8 = (char *)qword_5D410;
LABEL_59:
      if ( v5 && v8 != (char *)-128i64 )
      {
        v21 = (void *)*((_QWORD *)v8 + 23);
        *((_DWORD *)v8 + 49) = 0;
        if ( v21 )
        {
          sub_3D094(v21);
          v8 = (char *)qword_5D410;
        }
        v6 = off_5A148;
      }
      goto LABEL_64;
    }
    v14 = sub_3C4EC(1, 4 * (unsigned int)*(unsigned __int8 *)(a1 + 136), 0x66634E4Eu);
    v8 = (char *)qword_5D410;
    *((_QWORD *)qword_5D410 + 26) = v14;
    if ( !v14 )
    {
      v6 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) )
      {
        sub_13EA4(
          *(_QWORD *)&off_5A148->AlignmentRequirement,
          0x11u,
          (__int64)&unk_57C58,
          4 * *(unsigned __int8 *)(a1 + 136));
        v6 = off_5A148;
        v8 = (char *)qword_5D410;
      }
      v9 = 3;
      goto LABEL_59;
    }
    v15 = 0;
    if ( *(_BYTE *)(a1 + 136) )
    {
      v16 = 0i64;
      do
      {
        *(_DWORD *)(v16 + *((_QWORD *)v8 + 26)) = *(_DWORD *)a1 | ++v15;
        v16 += 4i64;
      }
      while ( v15 < *(unsigned __int8 *)(a1 + 136) );
    }
    *(_DWORD *)v8 = 2;
    *((_DWORD *)v8 + 1) = 176;
    v8[8] = 0;
    *((_DWORD *)v8 + 4) = *(_DWORD *)a1;
    v8[20] = *(_BYTE *)(a1 + 136);
    *((_QWORD *)v8 + 3) = *((_QWORD *)v8 + 26);
    *((_QWORD *)v8 + 4) = sub_455C8;
    sub_3CAA4((PERESOURCE)(v8 + 216));
    v17 = (char *)qword_5D410 + 56;
    v18 = (char *)qword_5D410 + 72;
    *((_QWORD *)qword_5D410 + 8) = (char *)qword_5D410 + 56;
    *v17 = v17;
    sub_3D230((__int64)v18);
    v19 = (unsigned int *)qword_5D410;
    memmove((char *)qword_5D410 + 320, a3, 0x20ui64);
    v20 = sub_40228((__int16 *)(a1 + 4), *(_DWORD *)(a1 + 132), v19 + 4);
    v6 = off_5A148;
    v9 = v20;
LABEL_57:
    if ( !v9 )
      goto LABEL_68;
    goto LABEL_58;
  }
  if ( v6 == (PDEVICE_OBJECT)&off_5A148
    || !_bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
  {
    goto LABEL_12;
  }
  v7 = 13;
LABEL_10:
  sub_11088(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_57C58);
LABEL_11:
  v6 = off_5A148;
LABEL_12:
  v8 = (char *)qword_5D410;
  v9 = 4;
LABEL_64:
  if ( v8 )
  {
    v22 = (void *)*((_QWORD *)v8 + 26);
    if ( v22 )
    {
      sub_3C570(v22, 0x66634E4Eu);
      v8 = (char *)qword_5D410;
    }
    sub_3C570(v8, 0x66634E4Eu);
    v6 = off_5A148;
    qword_5D410 = 0i64;
  }
LABEL_68:
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0x12u, (__int64)&unk_57C58, v9);
  }
  return v9;
}

//----- (0000000000044D2C) ----------------------------------------------------
__int64 sub_44D2C()
{
  char v0; // di
  PDEVICE_OBJECT v1; // rcx
  PVOID v2; // rdx
  unsigned int v3; // ebx
  void *v4; // rcx
  int v5; // eax
  _QWORD *v6; // rax
  unsigned int v7; // eax
  int v8; // eax

  v0 = 0;
  v1 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x13u, (__int64)&unk_57C58);
    v1 = off_5A148;
  }
  v2 = qword_5D410;
  if ( !qword_5D410 )
  {
    if ( v1 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v1->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v1->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v1->AlignmentRequirement, 0x14u, (__int64)&unk_57C58);
      v1 = off_5A148;
    }
    v3 = 16;
    goto LABEL_59;
  }
  if ( *((_QWORD *)qword_5D410 + 5) )
  {
    if ( v1 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v1->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v1->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v1->AlignmentRequirement, 0x15u, (__int64)&unk_57C58);
      v1 = off_5A148;
    }
    v3 = 6;
    goto LABEL_59;
  }
  v4 = (void *)*((_QWORD *)qword_5D410 + 26);
  if ( v4 )
  {
    sub_3C570(v4, 0x66634E4Eu);
    v2 = qword_5D410;
    *((_QWORD *)qword_5D410 + 26) = 0i64;
  }
  v5 = sub_40E90(6u, (__int64)v2 + 40);
  v3 = v5;
  if ( v5 )
  {
    v1 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x16u, (__int64)&unk_57C58, v5);
      v1 = off_5A148;
    }
    goto LABEL_55;
  }
  v6 = (_QWORD *)*((_QWORD *)qword_5D410 + 5);
  if ( !v6 || !*v6 || !v6[1] || !v6[2] || !v6[3] || !v6[4] || !v6[5] || !v6[6] || !v6[7] || !v6[8] || !v6[9] || !v6[10] )
  {
    v3 = 2;
    goto LABEL_58;
  }
  v7 = ((__int64 (__fastcall *)(_QWORD, char *))*v6)(*((unsigned int *)qword_5D410 + 4), (char *)qword_5D410 + 48);
  if ( v7 < 0x700 )
  {
    v0 = sub_46EF0((PFAST_MUTEX)((char *)qword_5D410 + 128));
    if ( !v0 )
    {
      v1 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x18u, (__int64)&unk_57C58);
        v1 = off_5A148;
      }
      v3 = 9;
LABEL_56:
      if ( !v0 )
        goto LABEL_59;
      sub_46F50((PFAST_MUTEX)((char *)qword_5D410 + 128));
LABEL_58:
      v1 = off_5A148;
      goto LABEL_59;
    }
    v8 = sub_45B80();
    v3 = v8;
    if ( !v8 )
      goto LABEL_58;
    v1 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x19u, (__int64)&unk_57C58, v8);
      v1 = off_5A148;
    }
    v3 = 0;
LABEL_55:
    if ( !v3 )
      goto LABEL_59;
    goto LABEL_56;
  }
  v1 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x17u, (__int64)&unk_57C58, v7);
    v1 = off_5A148;
  }
  v3 = 8;
LABEL_59:
  if ( v1 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v1->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v1->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v1->AlignmentRequirement, 0x1Au, (__int64)&unk_57C58, v3);
  }
  return v3;
}

//----- (0000000000045074) ----------------------------------------------------
__int64 (**sub_45074())(void)
{
  PDEVICE_OBJECT v0; // rcx
  __int64 (**result)(void); // rax
  unsigned __int16 v2; // dx

  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1Bu, (__int64)&unk_57C58);
    v0 = off_5A148;
  }
  result = (__int64 (**)(void))qword_5D410;
  if ( qword_5D410 )
  {
    sub_46F50((PFAST_MUTEX)((char *)qword_5D410 + 128));
    result = (__int64 (**)(void))*((_QWORD *)qword_5D410 + 5);
    if ( result && *((_QWORD *)qword_5D410 + 6) )
    {
      result = (__int64 (**)(void))result[1]();
      *((_QWORD *)qword_5D410 + 6) = 0i64;
    }
    v0 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v2 = 30;
      return (__int64 (**)(void))sub_11088(*(_QWORD *)&v0->AlignmentRequirement, v2, (__int64)&unk_57C58);
    }
  }
  else if ( v0 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&v0->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      result = (__int64 (**)(void))sub_11088(
                                     *(_QWORD *)&v0->AlignmentRequirement,
                                     (unsigned __int16)qword_5D410 + 28,
                                     (__int64)&unk_57C58);
      v0 = off_5A148;
    }
    if ( v0 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v0->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v2 = 29;
      return (__int64 (**)(void))sub_11088(*(_QWORD *)&v0->AlignmentRequirement, v2, (__int64)&unk_57C58);
    }
  }
  return result;
}

//----- (00000000000451A0) ----------------------------------------------------
void sub_451A0()
{
  PDEVICE_OBJECT v0; // rcx
  unsigned __int16 v1; // dx
  char *v2; // rcx
  PVOID *v3; // rax
  _QWORD *v4; // rcx
  _QWORD *v5; // rax
  _QWORD **v6; // rdx

  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1Fu, (__int64)&unk_57C58);
    v0 = off_5A148;
  }
  if ( qword_5D410 )
  {
    sub_40FE0();
    v2 = (char *)qword_5D410;
    v3 = (PVOID *)((char *)qword_5D410 + 128);
    if ( qword_5D410 != (PVOID)-128i64 )
    {
      *((_DWORD *)qword_5D410 + 49) = 0;
      if ( v3[7] )
      {
        sub_3D094(v3[7]);
        v2 = (char *)qword_5D410;
      }
    }
    if ( !*((_QWORD *)v2 + 26) )
      goto LABEL_21;
    v4 = (_QWORD *)*((_QWORD *)v2 + 26);
    while ( 1 )
    {
      sub_3C570(v4, 0x66634E4Eu);
      v2 = (char *)qword_5D410;
LABEL_21:
      v6 = (_QWORD **)(v2 + 56);
      if ( *v6 == v6 )
        break;
      v5 = (_QWORD *)**v6;
      v4 = *v6 - 5;
      *v6 = v5;
      v5[1] = v6;
    }
    sub_3CB78((PERESOURCE)(v2 + 216));
    sub_3C570(qword_5D410, 0x66634E4Eu);
    qword_5D410 = 0i64;
    v0 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v1 = 34;
      goto LABEL_26;
    }
  }
  else if ( v0 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&v0->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v0->AlignmentRequirement, 0x20u, (__int64)&unk_57C58);
      v0 = off_5A148;
    }
    if ( v0 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v0->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v0->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v1 = 33;
LABEL_26:
      sub_11088(*(_QWORD *)&v0->AlignmentRequirement, v1, (__int64)&unk_57C58);
      return;
    }
  }
}

//----- (000000000004535C) ----------------------------------------------------
__int64 __fastcall sub_4535C(unsigned int a1)
{
  PDEVICE_OBJECT v2; // r10
  unsigned __int16 v3; // dx
  unsigned __int8 (__fastcall *v5)(_QWORD, unsigned int *, size_t *, char *); // r11
  __int64 v6; // rcx
  unsigned __int16 v7; // dx
  char *v8; // rbx
  char v9[40]; // [rsp+30h] [rbp-28h] BYREF
  unsigned int Dst; // [rsp+68h] [rbp+10h] BYREF
  size_t MaxCount; // [rsp+70h] [rbp+18h] BYREF
  unsigned int v12; // [rsp+78h] [rbp+20h] BYREF

  Dst = 0;
  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x2Cu, (__int64)&unk_57C58, a1);
    v2 = off_5A148;
  }
  if ( !qword_5D410 )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v2->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 0i64;
    }
    v3 = (_WORD)qword_5D410 + 45;
    goto LABEL_10;
  }
  v5 = (unsigned __int8 (__fastcall *)(_QWORD, unsigned int *, size_t *, char *))*((_QWORD *)qword_5D410 + 40);
  if ( !v5 )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v2->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 0i64;
    }
    v3 = 46;
LABEL_10:
    sub_11088(*(_QWORD *)&v2->AlignmentRequirement, v3, (__int64)&unk_57C58);
    return 0i64;
  }
  if ( (unsigned __int8)(a1 - 1) >= (unsigned int)*((unsigned __int8 *)qword_5D410 + 20) )
  {
    if ( v2 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v2->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(v2->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 0i64;
    }
    v6 = *(_QWORD *)&v2->AlignmentRequirement;
    v7 = 47;
    goto LABEL_22;
  }
  if ( !v5(a1, &v12, &MaxCount, v9) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_184C0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x30u, (__int64)&unk_57C58, a1);
    }
    return 0i64;
  }
  if ( (unsigned int)MaxCount > 4 )
  {
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 0i64;
    }
    v6 = *(_QWORD *)&off_5A148->AlignmentRequirement;
    v7 = 49;
LABEL_22:
    sub_33F1C(v6, v7, (__int64)&unk_57C58, a1);
    return 0i64;
  }
  KeEnterCriticalRegion();
  sub_3CD24((PERESOURCE)((char *)qword_5D410 + 216));
  v8 = (char *)qword_5D410;
  memmove(&Dst, (char *)qword_5D410 + v12 + 352, (unsigned int)MaxCount);
  sub_3CDFC((PERESOURCE)(v8 + 216));
  KeLeaveCriticalRegion();
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x32u, (__int64)&unk_57C58, Dst);
  }
  return Dst;
}

//----- (00000000000455C8) ----------------------------------------------------
__int64 __fastcall sub_455C8(__int64 a1)
{
  char *v1; // r8
  unsigned int v2; // ebx
  __int64 (__fastcall **v4)(_QWORD, _QWORD); // r13
  __int64 v5; // r14
  int v6; // ebp
  PDEVICE_OBJECT v7; // rcx
  _DWORD *v8; // rdi
  unsigned __int16 v10; // dx
  unsigned __int16 v11; // dx
  int v12; // edx
  int *v13; // rdi
  int *v14; // rbp
  int v15; // edi
  int *v16; // rbp
  int v17; // edi

  v1 = (char *)qword_5D410;
  v2 = 0;
  v4 = (__int64 (__fastcall **)(_QWORD, _QWORD))*((_QWORD *)qword_5D410 + 5);
  v5 = *((_QWORD *)qword_5D410 + 6);
  v6 = 0;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x5Bu, (__int64)&unk_57C58);
    v1 = (char *)qword_5D410;
    v7 = off_5A148;
  }
  if ( !a1 )
    goto LABEL_6;
  v8 = *(_DWORD **)(a1 + 56);
  if ( !v8 )
    goto LABEL_6;
  switch ( *v8 )
  {
    case 0:
      v16 = v8 + 1;
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0x5Cu, (__int64)&unk_57C58);
        v1 = (char *)qword_5D410;
        v7 = off_5A148;
      }
      if ( v8 != (_DWORD *)-4i64 )
      {
        if ( !sub_46FB0((PFAST_MUTEX)(v1 + 128)) )
          goto LABEL_26;
        v2 = sub_46C08(*v16);
        if ( v2 )
          goto LABEL_65;
        v17 = v4[9](v5, (unsigned int)*v16);
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_184C0(*(_QWORD *)&off_5A148->AlignmentRequirement, v2 + 93, (__int64)&unk_57C58, *v16);
        }
        sub_47018((PFAST_MUTEX)((char *)qword_5D410 + 128));
        if ( !v17 )
          goto LABEL_26;
        v2 = 8;
        v7 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
        {
          if ( _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            v10 = 94;
            goto LABEL_91;
          }
          goto LABEL_93;
        }
        goto LABEL_53;
      }
LABEL_6:
      v2 = 2;
      goto LABEL_93;
    case 1:
      v14 = v8 + 1;
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0x5Fu, (__int64)&unk_57C58);
        v1 = (char *)qword_5D410;
        v7 = off_5A148;
      }
      if ( v8 != (_DWORD *)-4i64 )
      {
        if ( !sub_46FB0((PFAST_MUTEX)(v1 + 128)) )
          goto LABEL_26;
        v2 = sub_46D64(*v14);
        if ( v2 )
        {
LABEL_65:
          sub_47018((PFAST_MUTEX)((char *)qword_5D410 + 128));
LABEL_92:
          v7 = off_5A148;
          goto LABEL_93;
        }
        v15 = v4[10](v5, (unsigned int)*v14);
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_184C0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x60u, (__int64)&unk_57C58, *v14);
        }
        sub_47018((PFAST_MUTEX)((char *)qword_5D410 + 128));
        if ( !v15 )
          goto LABEL_26;
        v2 = 8;
        v7 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
        {
          if ( _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            v10 = 97;
            goto LABEL_91;
          }
LABEL_93:
          if ( v7 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0x68u, (__int64)&unk_57C58);
          }
          if ( v2 )
            goto LABEL_53;
          goto LABEL_98;
        }
LABEL_53:
        v12 = v2;
        goto LABEL_27;
      }
      goto LABEL_6;
    case 2:
      if ( sub_46FB0((PFAST_MUTEX)(v1 + 128)) )
      {
        v2 = sub_4624C(v8[1], v8[2], v8[3], v8 + 4);
        sub_47018((PFAST_MUTEX)((char *)qword_5D410 + 128));
      }
      goto LABEL_53;
    case 3:
      if ( sub_46FB0((PFAST_MUTEX)(v1 + 128)) )
      {
        v2 = sub_46844((unsigned int)v8[1], v8[2], a1);
        sub_47018((PFAST_MUTEX)((char *)qword_5D410 + 128));
      }
      goto LABEL_28;
    case 4:
      v13 = v8 + 1;
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0x62u, (__int64)&unk_57C58);
        v1 = (char *)qword_5D410;
      }
      if ( sub_46FB0((PFAST_MUTEX)(v1 + 128)) )
      {
        if ( v13 )
        {
          v6 = v4[8](v5, (unsigned int)*v13);
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
          {
            sub_184C0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x63u, (__int64)&unk_57C58, *v13);
          }
        }
        sub_47018((PFAST_MUTEX)((char *)qword_5D410 + 128));
        if ( !v13 || v6 )
        {
          v2 = 8;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x64u, (__int64)&unk_57C58);
          }
        }
      }
      goto LABEL_53;
    case 5:
      if ( v7 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 4u )
      {
        goto LABEL_26;
      }
      v11 = 101;
      goto LABEL_25;
  }
  if ( *v8 != 6 )
  {
    if ( *((_QWORD *)v1 + 43) )
      return (*((__int64 (__fastcall **)(__int64, _QWORD, char *, void *))v1 + 43))(
               a1,
               (unsigned int)(*v8 - 5),
               v1,
               &unk_57C58);
    if ( v7 == (PDEVICE_OBJECT)&off_5A148 )
    {
LABEL_98:
      v2 = 17;
      goto LABEL_53;
    }
    if ( _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      v10 = 103;
LABEL_91:
      sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v10, (__int64)&unk_57C58);
      goto LABEL_92;
    }
    goto LABEL_93;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    v11 = 102;
LABEL_25:
    sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v11, (__int64)&unk_57C58);
  }
LABEL_26:
  v12 = 0;
LABEL_27:
  sub_432F0(a1, v12, 0, 0i64);
LABEL_28:
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x69u, (__int64)&unk_57C58, v2);
  }
  return v2;
}

//----- (0000000000045B80) ----------------------------------------------------
__int64 sub_45B80()
{
  __int64 v0; // rsi
  __int64 v1; // r15
  unsigned int v2; // er13
  int v3; // eax
  void *v4; // rbp
  void **v5; // r14
  unsigned int v6; // er12
  void (__fastcall *v7)(char *); // rax
  int v8; // eax
  PDEVICE_OBJECT v9; // r10
  _DWORD *v10; // r11
  unsigned int i; // er9
  void (__fastcall *v12)(int *); // rax
  PVOID v13; // r11
  int v14; // esi
  unsigned int v15; // eax
  unsigned int v16; // esi
  PVOID v17; // rax
  char *v18; // rbx
  int v19; // eax
  int v20; // ebx
  unsigned int v21; // eax
  unsigned int v22; // ebx
  int v23; // eax
  char *v24; // rsi
  size_t v25; // r8
  void (__fastcall *v26)(int *); // rax
  __int64 v28; // [rsp+20h] [rbp-A8h]
  __int64 v29; // [rsp+28h] [rbp-A0h]
  __int64 v30; // [rsp+30h] [rbp-98h]
  int v31; // [rsp+38h] [rbp-90h]
  char v32[8]; // [rsp+40h] [rbp-88h] BYREF
  void *Src; // [rsp+48h] [rbp-80h] BYREF
  __int64 v34; // [rsp+50h] [rbp-78h]
  int v35[28]; // [rsp+58h] [rbp-70h] BYREF
  _BYTE v36[28]; // [rsp+5Ch] [rbp-6Ch] BYREF
  char v37; // [rsp+D0h] [rbp+8h] BYREF
  size_t MaxCount; // [rsp+D8h] [rbp+10h] BYREF
  unsigned int v39; // [rsp+E0h] [rbp+18h] BYREF
  size_t v40; // [rsp+E8h] [rbp+20h] BYREF

  v0 = *((_QWORD *)qword_5D410 + 6);
  v1 = *((_QWORD *)qword_5D410 + 5);
  v34 = v0;
  v2 = 0;
  v37 = 0;
  v35[0] = 0;
  memset(v36, 0, sizeof(v36));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Au, (__int64)&unk_57C58);
  }
  v3 = (*(__int64 (__fastcall **)(__int64, _QWORD, char *))(v1 + 40))(v0, 0i64, &v37);
  if ( !v3 )
  {
    v13 = qword_5D410;
    v20 = *((_DWORD *)qword_5D410 + 4);
    v21 = v20 | *((char *)qword_5D410 + 20);
    v22 = v20 | 1;
    if ( v22 > v21 )
    {
LABEL_73:
      v9 = off_5A148;
      goto LABEL_74;
    }
    while ( 1 )
    {
      Src = 0i64;
      LODWORD(MaxCount) = 0;
      if ( (*((unsigned __int8 (__fastcall **)(_QWORD, unsigned int *, size_t *, char *, _DWORD))v13 + 40))(
             v22,
             &v39,
             &v40,
             v32,
             v28) )
      {
        v23 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, void **, size_t *))(v1 + 16))(
                v0,
                0i64,
                v22,
                &Src,
                &MaxCount);
        if ( v23 || !Src )
        {
          v9 = off_5A148;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            LODWORD(v28) = v22;
            sub_184C0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x70u, (__int64)&unk_57C58, v23);
            v9 = off_5A148;
          }
          v2 = 8;
          goto LABEL_66;
        }
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x71u, (__int64)&unk_57C58, v22);
        }
        KeEnterCriticalRegion();
        LODWORD(v28) = 0;
        sub_3CC4C((PERESOURCE)((char *)qword_5D410 + 216));
        v24 = (char *)qword_5D410;
        v25 = (unsigned int)MaxCount;
        if ( (unsigned int)MaxCount >= (unsigned int)v40 )
          v25 = (unsigned int)v40;
        memmove((char *)qword_5D410 + v39 + 352, Src, v25);
        sub_3CDFC((PERESOURCE)(v24 + 216));
        KeLeaveCriticalRegion();
        v0 = v34;
        (*(void (__fastcall **)(__int64, void *))(v1 + 32))(v34, Src);
        v35[(unsigned __int8)(v22 - 1) >> 5] |= 1 << ((v22 - 1) & 0x1F);
      }
      v9 = off_5A148;
LABEL_66:
      v13 = qword_5D410;
      if ( ++v22 > (*((_DWORD *)qword_5D410 + 4) | (unsigned int)*((char *)qword_5D410 + 20)) )
        goto LABEL_74;
    }
  }
  v4 = 0i64;
  v5 = 0i64;
  v6 = 0;
  if ( v3 == 1879048199 || v3 == 1879048193 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Bu, (__int64)&unk_57C58, 0);
    }
  }
  else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
         && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
         && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    LODWORD(v28) = 0;
    sub_184C0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Cu, (__int64)&unk_57C58, v3);
  }
  v7 = (void (__fastcall *)(char *))*((_QWORD *)qword_5D410 + 41);
  if ( v7 )
    v7((char *)qword_5D410 + 352);
  v8 = (*(__int64 (__fastcall **)(__int64, _QWORD))(v1 + 64))(v0, 0i64);
  if ( v8 )
  {
    v9 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Du, (__int64)&unk_57C58, v8);
      v9 = off_5A148;
    }
    v10 = qword_5D410;
    for ( i = *((_DWORD *)qword_5D410 + 4) | 1; i <= (v10[4] | (unsigned int)*((char *)v10 + 20)); ++i )
      v35[(unsigned __int8)(i - 1) >> 5] |= 1 << ((i - 1) & 0x1F);
    v12 = (void (__fastcall *)(int *))*((_QWORD *)v10 + 42);
    if ( v12 )
    {
      v12(v35);
      v9 = off_5A148;
    }
    v2 = 8;
    goto LABEL_76;
  }
  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Eu, (__int64)&unk_57C58, 0);
    v9 = off_5A148;
  }
  v13 = qword_5D410;
  v14 = *((_DWORD *)qword_5D410 + 4);
  v15 = v14 | *((char *)qword_5D410 + 20);
  v16 = v14 | 1;
  if ( v16 > v15 )
    goto LABEL_74;
  do
  {
    if ( !(*((unsigned __int8 (__fastcall **)(_QWORD, unsigned int *, size_t *, size_t *, __int64, __int64))v13 + 40))(
            v16,
            &v39,
            &MaxCount,
            &v40,
            v28,
            v29) )
      goto LABEL_44;
    if ( (unsigned int)MaxCount > v6 )
    {
      if ( (unsigned int)MaxCount > 8 )
      {
        if ( v4 )
        {
          v31 = 0;
          v30 = 0i64;
          v29 = 0i64;
          v17 = sub_3C5E4(1, v4, v6, MaxCount, 0x706D744Eu);
        }
        else
        {
          LODWORD(v29) = 0;
          v28 = 0i64;
          v17 = sub_3C4EC(1, MaxCount, 0x706D744Eu);
        }
        v4 = v17;
        v5 = (void **)v17;
        v6 = v17 != 0i64 ? MaxCount : 0;
      }
      else
      {
        v5 = &Src;
        v6 = 8;
      }
    }
    v35[(unsigned __int8)(v16 - 1) >> 5] |= 1 << ((v16 - 1) & 0x1F);
    if ( !v5 )
    {
      v2 = 3;
LABEL_44:
      v9 = off_5A148;
      goto LABEL_45;
    }
    KeEnterCriticalRegion();
    sub_3CD24((PERESOURCE)((char *)qword_5D410 + 216));
    v18 = (char *)qword_5D410;
    memmove(v5, (char *)qword_5D410 + v39 + 352, (unsigned int)MaxCount);
    sub_3CDFC((PERESOURCE)(v18 + 216));
    KeLeaveCriticalRegion();
    LODWORD(v29) = MaxCount;
    v19 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, void **, __int64, __int64, int))(v1 + 24))(
            v34,
            0i64,
            0i64,
            v16,
            v5,
            v29,
            v30,
            v31);
    if ( !v19 )
      goto LABEL_44;
    v9 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      LODWORD(v28) = v16;
      sub_184C0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Fu, (__int64)&unk_57C58, v19);
      v9 = off_5A148;
    }
    v2 = 8;
LABEL_45:
    v13 = qword_5D410;
    ++v16;
  }
  while ( v16 <= (*((_DWORD *)qword_5D410 + 4) | (unsigned int)*((char *)qword_5D410 + 20)) );
  if ( v4 )
  {
    sub_3C570(v4, 0x706D744Eu);
    v13 = qword_5D410;
    goto LABEL_73;
  }
LABEL_74:
  v26 = (void (__fastcall *)(int *))*((_QWORD *)v13 + 42);
  if ( v26 )
  {
    v26(v35);
    v9 = off_5A148;
  }
LABEL_76:
  if ( v9 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v9->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v9->AlignmentRequirement, 0x72u, (__int64)&unk_57C58, v2);
  }
  return v2;
}
// 45E06: variable 'v28' is possibly undefined
// 45E06: variable 'v29' is possibly undefined
// 45F83: variable 'v30' is possibly undefined
// 45F83: variable 'v31' is possibly undefined
// 45B80: using guessed type int var_70[28];

//----- (000000000004624C) ----------------------------------------------------
__int64 __fastcall sub_4624C(unsigned int a1, int a2, unsigned int a3, _DWORD *a4)
{
  _QWORD *v4; // rsi
  __int64 v6; // rax
  __int64 v7; // r15
  _QWORD *v9; // r14
  unsigned int v10; // ebx
  PDEVICE_OBJECT v13; // rcx
  _QWORD *i; // rax
  char *v16; // rsi
  size_t v17; // r8
  char *v18; // rcx
  _QWORD *v19; // rax
  void (__fastcall *v20)(int *); // rdx
  int v21; // eax
  PDEVICE_OBJECT v22; // rcx
  unsigned __int16 v23; // dx
  __int64 v24; // r9
  PDEVICE_OBJECT v25; // rcx
  unsigned __int16 v26; // dx
  unsigned __int64 v27; // r11
  __int64 v28; // rcx
  int v29; // eax
  int v30; // [rsp+20h] [rbp-78h]
  unsigned int v31; // [rsp+28h] [rbp-70h]
  unsigned int v32; // [rsp+40h] [rbp-58h] BYREF
  int v33; // [rsp+44h] [rbp-54h] BYREF
  __int64 v34; // [rsp+48h] [rbp-50h]
  int v35[8]; // [rsp+50h] [rbp-48h] BYREF
  _BYTE v36[28]; // [rsp+54h] [rbp-44h] BYREF
  size_t MaxCount; // [rsp+A0h] [rbp+8h] BYREF

  v4 = qword_5D410;
  v6 = *((_QWORD *)qword_5D410 + 6);
  v7 = *((_QWORD *)qword_5D410 + 5);
  v9 = 0i64;
  v10 = 0;
  v32 = 0;
  LODWORD(MaxCount) = 0;
  v35[0] = 0;
  v34 = v6;
  memset(v36, 0, sizeof(v36));
  v13 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      v31 = a3;
      v30 = a2;
      sub_447C4(*(_QWORD *)&off_5A148->AlignmentRequirement, 115i64, (__int64)&unk_57C58, a1);
      v4 = qword_5D410;
      v13 = off_5A148;
    }
    if ( v13 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v13->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v13->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11088(*(_QWORD *)&v13->AlignmentRequirement, 0x74u, (__int64)&unk_57C58);
      v4 = qword_5D410;
      v13 = off_5A148;
    }
  }
  if ( a1 )
  {
    for ( i = (_QWORD *)v4[7]; i != v4 + 7; i = (_QWORD *)*i )
    {
      v9 = i - 5;
      if ( *((_DWORD *)i - 10) == a1 )
        goto LABEL_15;
    }
    v9 = 0i64;
LABEL_15:
    if ( !v9 )
    {
      if ( v13 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v13->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v13->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&v13->AlignmentRequirement, 0x75u, (__int64)&unk_57C58, a1);
      }
      return 4i64;
    }
  }
  if ( !((unsigned __int8 (__fastcall *)(_QWORD, unsigned int *, size_t *, int *, int, unsigned int))v4[40])(
          a3,
          &v32,
          &MaxCount,
          &v33,
          v30,
          v31) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x76u, (__int64)&unk_57C58, a3);
    }
    return 4i64;
  }
  if ( a1 )
  {
    v16 = (char *)v9 + v32 + 56;
    sub_3D310((PFAST_MUTEX)((char *)qword_5D410 + 72));
  }
  else
  {
    v16 = (char *)qword_5D410 + v32 + 352;
    KeEnterCriticalRegion();
    sub_3CC4C((PERESOURCE)((char *)qword_5D410 + 216));
  }
  if ( v33 < 0 )
    goto LABEL_34;
  if ( v33 <= 1 )
    goto LABEL_77;
  if ( v33 == 2 )
  {
    if ( a4 )
    {
      v24 = (unsigned int)*a4;
      if ( 2 * v24 <= (unsigned __int64)(unsigned int)MaxCount )
      {
        memmove(v16, a4 + 1, 2 * v24);
        v27 = 2i64 * (unsigned int)*a4;
        if ( v27 >= (unsigned int)MaxCount )
          goto LABEL_44;
        v17 = (unsigned int)MaxCount - v27;
        v18 = &v16[v27];
        goto LABEL_43;
      }
      v22 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || !_bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
LABEL_64:
        v10 = 6;
        goto LABEL_44;
      }
      v23 = 121;
LABEL_58:
      sub_33F1C(*(_QWORD *)&v22->AlignmentRequirement, v23, (__int64)&unk_57C58, v24);
      goto LABEL_64;
    }
    v25 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_64;
    }
    v26 = 122;
LABEL_63:
    sub_11088(*(_QWORD *)&v25->AlignmentRequirement, v26, (__int64)&unk_57C58);
    goto LABEL_64;
  }
  if ( v33 > 4 )
  {
    if ( v33 > 7 )
    {
LABEL_34:
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x7Bu, (__int64)&unk_57C58);
      }
      v10 = 4;
      goto LABEL_44;
    }
LABEL_77:
    memmove(v16, a4, (unsigned int)MaxCount);
    goto LABEL_44;
  }
  if ( !a4 )
  {
    v25 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_64;
    }
    v26 = 120;
    goto LABEL_63;
  }
  if ( *a4 > (unsigned int)MaxCount )
  {
    v22 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_64;
    }
    v23 = 119;
    LODWORD(v24) = *a4;
    goto LABEL_58;
  }
  memmove(v16, a4 + 1, (unsigned int)*a4);
  if ( *a4 < (unsigned int)MaxCount )
  {
    v17 = (unsigned int)(MaxCount - *a4);
    v18 = &v16[*a4];
LABEL_43:
    memset(v18, 0, v17);
  }
LABEL_44:
  if ( a1 )
  {
    if ( !v10 )
    {
      v28 = v34;
      *((_DWORD *)v9 + (((a3 - 1) >> 5) & 7) + 1) |= 1 << ((a3 - 1) & 0x1F);
      v29 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, char *, _DWORD))(v7 + 24))(
              v28,
              a1,
              0i64,
              a3,
              v16,
              MaxCount);
      if ( v29 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_18658(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x7Du, (__int64)&unk_57C58, v29);
        }
        v10 = 8;
      }
    }
    sub_3D3DC((PFAST_MUTEX)((char *)qword_5D410 + 72));
  }
  else
  {
    sub_3CDFC((PERESOURCE)((char *)qword_5D410 + 216));
    KeLeaveCriticalRegion();
    if ( !v10 )
    {
      v19 = qword_5D410;
      v35[((a3 - 1) >> 5) & 7] |= 1 << ((a3 - 1) & 0x1F);
      v20 = (void (__fastcall *)(int *))v19[42];
      if ( v20 )
        v20(v35);
      v21 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, char *, _DWORD))(v7 + 24))(
              v34,
              0i64,
              0i64,
              a3,
              v16,
              MaxCount);
      if ( v21 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_33F1C(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x7Cu, (__int64)&unk_57C58, v21);
        }
        v10 = 8;
      }
    }
  }
  return v10;
}
// 4649C: conditional instruction was optimized away because of 'eax.4>=3'
// 463CE: variable 'v30' is possibly undefined
// 463CE: variable 'v31' is possibly undefined
// 4624C: using guessed type int var_48[8];

//----- (0000000000046844) ----------------------------------------------------
__int64 __fastcall sub_46844(__int64 a1, unsigned int a2, __int64 a3)
{
  unsigned int v5; // ebx
  PDEVICE_OBJECT v6; // rcx
  PDEVICE_OBJECT v7; // rcx
  int v8; // edx
  char *v9; // rbp
  unsigned int v10; // er8
  __int64 *v11; // r9
  unsigned int v12; // er12
  _DWORD *v13; // rsi
  unsigned __int16 v14; // dx
  int v15; // eax
  __int64 Dst; // [rsp+30h] [rbp-38h] BYREF
  unsigned int v18; // [rsp+38h] [rbp-30h] BYREF
  int v19; // [rsp+3Ch] [rbp-2Ch] BYREF
  size_t MaxCount; // [rsp+88h] [rbp+20h] BYREF

  v5 = 0;
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x7Eu, (__int64)&unk_57C58);
      v6 = off_5A148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v6->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0x7Fu, (__int64)&unk_57C58, a2);
    }
  }
  if ( !(*((unsigned __int8 (__fastcall **)(_QWORD, unsigned int *, size_t *, int *))qword_5D410 + 40))(
          a2,
          &v18,
          &MaxCount,
          &v19) )
  {
    v7 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x80u, (__int64)&unk_57C58, a2);
LABEL_46:
        v7 = off_5A148;
      }
LABEL_47:
      if ( v7 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&v7->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0x85u, (__int64)&unk_57C58);
      }
    }
LABEL_51:
    v8 = 17;
LABEL_52:
    v11 = 0i64;
    v5 = v8;
    v10 = 0;
    goto LABEL_53;
  }
  if ( !(_DWORD)MaxCount )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x81u, (__int64)&unk_57C58, a2);
    }
    v8 = 12;
    goto LABEL_52;
  }
  v9 = (char *)qword_5D410 + v18 + 352;
  if ( v19 < 0 )
  {
LABEL_41:
    v7 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      goto LABEL_51;
    if ( !_bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_47;
    }
    v14 = 132;
    goto LABEL_45;
  }
  if ( v19 <= 1 )
  {
LABEL_40:
    LODWORD(Dst) = 0;
    memmove(&Dst, (char *)qword_5D410 + v18 + 352, (unsigned int)MaxCount);
    v8 = 0;
    v10 = 4;
    v11 = &Dst;
    goto LABEL_53;
  }
  if ( v19 == 2 )
  {
    v12 = MaxCount + 4;
    v13 = sub_3C4EC(1, (int)MaxCount + 4, 0x66634E4Eu);
    if ( !v13 )
    {
      v7 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        goto LABEL_51;
      if ( !_bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_47;
      }
      v14 = 131;
      goto LABEL_45;
    }
    v15 = (unsigned int)MaxCount >> 1;
  }
  else
  {
    if ( v19 > 4 )
    {
      if ( v19 > 6 )
      {
        if ( v19 == 7 )
        {
          Dst = 0i64;
          memmove(&Dst, (char *)qword_5D410 + v18 + 352, (unsigned int)MaxCount);
          v8 = 0;
          v10 = 8;
          v11 = &Dst;
LABEL_53:
          sub_432F0(a3, v8, v10, v11);
          goto LABEL_54;
        }
        goto LABEL_41;
      }
      goto LABEL_40;
    }
    v12 = MaxCount + 4;
    v13 = sub_3C4EC(1, (int)MaxCount + 4, 0x66634E4Eu);
    if ( !v13 )
    {
      v7 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        goto LABEL_51;
      if ( !_bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
        || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_47;
      }
      v14 = 130;
LABEL_45:
      sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v14, (__int64)&unk_57C58);
      goto LABEL_46;
    }
    v15 = MaxCount;
  }
  *v13 = v15;
  memmove(v13 + 1, v9, (unsigned int)MaxCount);
  sub_432F0(a3, 0, v12, v13);
  sub_3C570(v13, 0x66634E4Eu);
LABEL_54:
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 8u)
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x86u, (__int64)&unk_57C58, v5);
  }
  return v5;
}
// 469C8: conditional instruction was optimized away because of 'eax.4>=3'

//----- (0000000000046C08) ----------------------------------------------------
__int64 __fastcall sub_46C08(int a1)
{
  unsigned int v1; // edi
  char *v4; // r10
  char *i; // rax
  char *v6; // rax
  _DWORD *v7; // rax
  _QWORD *v8; // rsi
  char *v9; // rbx
  _QWORD *v10; // rdx
  __int64 v11; // rcx

  v1 = 0;
  if ( !a1 )
    return 6i64;
  sub_3D310((PFAST_MUTEX)((char *)qword_5D410 + 72));
  v4 = (char *)qword_5D410;
  for ( i = (char *)*((_QWORD *)qword_5D410 + 7); i != (char *)qword_5D410 + 56; i = (char *)*((_QWORD *)v6 + 5) )
  {
    v6 = i - 40;
    if ( *(_DWORD *)v6 == a1 )
      goto LABEL_8;
  }
  v6 = 0i64;
LABEL_8:
  if ( v6 )
  {
    v1 = 6;
  }
  else
  {
    v7 = sub_3C4EC(1, *((_DWORD *)qword_5D410 + 1) + 56, 0x66634E4Eu);
    v8 = v7;
    if ( v7 )
    {
      *v7 = a1;
      memset(v7 + 1, 0, 0x20ui64);
      KeEnterCriticalRegion();
      sub_3CD24((PERESOURCE)((char *)qword_5D410 + 216));
      v9 = (char *)qword_5D410;
      memmove(v8 + 7, (char *)qword_5D410 + 352, *((unsigned int *)qword_5D410 + 1));
      sub_3CDFC((PERESOURCE)(v9 + 216));
      KeLeaveCriticalRegion();
      v4 = (char *)qword_5D410;
      v10 = (char *)qword_5D410 + 56;
      v11 = *((_QWORD *)qword_5D410 + 7);
      v8[6] = (char *)qword_5D410 + 56;
      v8[5] = v11;
      *(_QWORD *)(v11 + 8) = v8 + 5;
      *v10 = v8 + 5;
    }
    else
    {
      v4 = (char *)qword_5D410;
      v1 = 3;
    }
  }
  sub_3D3DC((PFAST_MUTEX)(v4 + 72));
  return v1;
}

//----- (0000000000046D64) ----------------------------------------------------
__int64 __fastcall sub_46D64(int a1)
{
  __int64 result; // rax
  char *v3; // r11
  _QWORD *i; // rax
  char *v5; // rdi
  __int64 v6; // rcx
  _QWORD *v7; // rax
  char *v8; // rbx
  void (__fastcall *v9)(char *); // rax

  if ( !a1 )
    return 6i64;
  sub_3D310((PFAST_MUTEX)((char *)qword_5D410 + 72));
  v3 = (char *)qword_5D410;
  for ( i = (_QWORD *)*((_QWORD *)qword_5D410 + 7); i != (_QWORD *)((char *)qword_5D410 + 56); i = (_QWORD *)*i )
  {
    v5 = (char *)(i - 5);
    if ( *((_DWORD *)i - 10) == a1 )
      goto LABEL_8;
  }
  v5 = 0i64;
LABEL_8:
  if ( v5 )
  {
    v6 = *((_QWORD *)v5 + 5);
    v7 = (_QWORD *)*((_QWORD *)v5 + 6);
    *v7 = v6;
    *(_QWORD *)(v6 + 8) = v7;
    sub_3D3DC((PFAST_MUTEX)(v3 + 72));
    KeEnterCriticalRegion();
    sub_3CC4C((PERESOURCE)((char *)qword_5D410 + 216));
    v8 = (char *)qword_5D410;
    memmove((char *)qword_5D410 + 352, v5 + 56, *((unsigned int *)qword_5D410 + 1));
    sub_3CDFC((PERESOURCE)(v8 + 216));
    KeLeaveCriticalRegion();
    v9 = (void (__fastcall *)(char *))*((_QWORD *)qword_5D410 + 42);
    if ( v9 )
      v9(v5 + 4);
    sub_3C570(v5, 0x66634E4Eu);
    result = 0i64;
  }
  else
  {
    sub_3D3DC((PFAST_MUTEX)((char *)qword_5D410 + 72));
    result = 5i64;
  }
  return result;
}

//----- (0000000000046E8C) ----------------------------------------------------
bool __fastcall sub_46E8C(__int64 a1)
{
  bool v3; // bl

  if ( !a1 )
    return 0;
  v3 = sub_3D01C((struct _KEVENT **)(a1 + 56), 1);
  sub_3D230(a1);
  *(_DWORD *)(a1 + 64) = 0;
  *(_DWORD *)(a1 + 68) = 0;
  *(_BYTE *)(a1 + 72) = 0;
  return v3;
}

//----- (0000000000046EF0) ----------------------------------------------------
char __fastcall sub_46EF0(PFAST_MUTEX FastMutex)
{
  char result; // al

  result = 0;
  if ( FastMutex && !LODWORD(FastMutex[1].Owner) && !LOBYTE(FastMutex[1].Contention) && !HIDWORD(FastMutex[1].Owner) )
  {
    sub_3D310(FastMutex);
    sub_3D0FC(*(PRKEVENT *)&FastMutex[1].Count);
    LOBYTE(FastMutex[1].Contention) = 1;
    sub_3D3DC(FastMutex);
    result = 1;
  }
  return result;
}

//----- (0000000000046F50) ----------------------------------------------------
char __fastcall sub_46F50(PFAST_MUTEX FastMutex)
{
  if ( !FastMutex )
    return 0;
  if ( LOBYTE(FastMutex[1].Contention) )
  {
    sub_3D310(FastMutex);
    LOBYTE(FastMutex[1].Contention) = 0;
    sub_3D3DC(FastMutex);
    sub_3D860(*(PVOID *)&FastMutex[1].Count);
  }
  return 1;
}

//----- (0000000000046FB0) ----------------------------------------------------
char __fastcall sub_46FB0(PFAST_MUTEX FastMutex)
{
  char v1; // di
  struct _KEVENT *v4; // rcx

  v1 = 0;
  if ( !FastMutex )
    return 0;
  sub_3D310(FastMutex);
  if ( LOBYTE(FastMutex[1].Contention) )
  {
    v4 = *(struct _KEVENT **)&FastMutex[1].Count;
    ++LODWORD(FastMutex[1].Owner);
    sub_3D164(v4);
    v1 = 1;
  }
  sub_3D3DC(FastMutex);
  return v1;
}

//----- (0000000000047018) ----------------------------------------------------
char __fastcall sub_47018(PFAST_MUTEX FastMutex)
{
  if ( !FastMutex || !*(_QWORD *)&FastMutex[1].Count || !LODWORD(FastMutex[1].Owner) )
    return 0;
  sub_3D310(FastMutex);
  if ( LODWORD(FastMutex[1].Owner)-- == 1 )
    sub_3D0FC(*(PRKEVENT *)&FastMutex[1].Count);
  sub_3D3DC(FastMutex);
  return 1;
}

//----- (000000000004707C) ----------------------------------------------------
__int64 __fastcall sub_4707C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57BD0, a2, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000470D8) ----------------------------------------------------
__int64 __fastcall sub_470D8(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57BD0, 189i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000047148) ----------------------------------------------------
__int64 __fastcall sub_47148(int a1, _QWORD *a2)
{
  PDEVICE_OBJECT v4; // rcx
  int v6; // ebx

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xAu, (__int64)&unk_57BD0);
    v4 = off_5A148;
  }
  if ( a2 )
  {
    if ( a1 )
    {
      v6 = a1 - 1;
      if ( !v6 )
      {
        if ( v4 != (PDEVICE_OBJECT)&off_5A148
          && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
          && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0xDu, (__int64)&unk_57BD0);
        }
        sub_3CEC8(a2);
        goto LABEL_28;
      }
      if ( v6 == 1 )
      {
        if ( v4 != (PDEVICE_OBJECT)&off_5A148
          && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
          && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0xEu, (__int64)&unk_57BD0);
        }
        sub_3D230((__int64)a2);
        goto LABEL_28;
      }
    }
    else
    {
      if ( v4 == (PDEVICE_OBJECT)&off_5A148 )
        return 0i64;
      if ( SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0xCu, (__int64)&unk_57BD0);
LABEL_28:
        v4 = off_5A148;
        goto LABEL_29;
      }
    }
LABEL_29:
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0xFu, (__int64)&unk_57BD0);
    }
    return 0i64;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0xBu, (__int64)&unk_57BD0);
  }
  return 3i64;
}

//----- (00000000000472EC) ----------------------------------------------------
__int64 __fastcall sub_472EC(int a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  int v6; // ebx
  unsigned __int16 v7; // dx

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x10u, (__int64)&unk_57BD0);
    v4 = off_5A148;
  }
  if ( a2 )
  {
    if ( a1 )
    {
      v6 = a1 - 1;
      if ( v6 )
      {
        if ( v6 != 1 )
          goto LABEL_27;
        if ( v4 != (PDEVICE_OBJECT)&off_5A148 )
        {
          if ( SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            v7 = 20;
LABEL_26:
            sub_11088(*(_QWORD *)&v4->AlignmentRequirement, v7, (__int64)&unk_57BD0);
            v4 = off_5A148;
            goto LABEL_27;
          }
          goto LABEL_27;
        }
      }
      else if ( v4 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          v7 = 19;
          goto LABEL_26;
        }
LABEL_27:
        if ( v4 != (PDEVICE_OBJECT)&off_5A148
          && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
          && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x15u, (__int64)&unk_57BD0);
        }
        return 0i64;
      }
    }
    else if ( v4 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        v7 = 18;
        goto LABEL_26;
      }
      goto LABEL_27;
    }
    return 0i64;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x11u, (__int64)&unk_57BD0);
  }
  return 3i64;
}

//----- (000000000004744C) ----------------------------------------------------
__int64 __fastcall sub_4744C(int a1, struct _FAST_MUTEX *a2, KIRQL *a3)
{
  PDEVICE_OBJECT v3; // rcx
  unsigned __int16 v4; // dx
  int v6; // ecx

  if ( !a2 )
  {
    v3 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v4 = 22;
LABEL_6:
    sub_11088(*(_QWORD *)&v3->AlignmentRequirement, v4, (__int64)&unk_57BD0);
    return 3i64;
  }
  if ( !a3 )
  {
    v3 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v4 = 23;
    goto LABEL_6;
  }
  v6 = a1 - 1;
  if ( v6 )
  {
    if ( v6 == 1 )
      sub_3D310(a2);
  }
  else
  {
    sub_3CF30((PKSPIN_LOCK)a2, a3);
  }
  return 0i64;
}

//----- (0000000000047510) ----------------------------------------------------
__int64 __fastcall sub_47510(int a1, struct _FAST_MUTEX *a2, KIRQL a3)
{
  __int64 result; // rax
  int v4; // ecx

  if ( a2 )
  {
    v4 = a1 - 1;
    if ( v4 )
    {
      if ( v4 == 1 )
        sub_3D3DC(a2);
    }
    else
    {
      sub_3CFA8((PKSPIN_LOCK)a2, a3);
    }
    result = 0i64;
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x18u, (__int64)&unk_57BD0);
    }
    result = 3i64;
  }
  return result;
}

//----- (00000000000475A4) ----------------------------------------------------
__int64 __fastcall sub_475A4(__int64 a1, __int64 a2, char a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x19u, (__int64)&unk_57BD0);
    v6 = off_5A148;
  }
  if ( !a1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 26;
LABEL_10:
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_57BD0);
    return 3i64;
  }
  if ( !a2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 27;
    goto LABEL_10;
  }
  *(_DWORD *)(a2 + 16) = 0;
  *(_QWORD *)(a2 + 8) = a2;
  *(_QWORD *)a2 = a2;
  if ( a3 )
    sub_47148(*(_DWORD *)(a1 + 24), (_QWORD *)(a2 + 24));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1Cu, (__int64)&unk_57BD0);
  }
  return 0i64;
}

//----- (00000000000476D0) ----------------------------------------------------
__int64 __fastcall sub_476D0(__int64 a1, __int64 a2, char a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1Du, (__int64)&unk_57BD0);
    v6 = off_5A148;
  }
  if ( !a1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 30;
LABEL_10:
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_57BD0);
    return 3i64;
  }
  if ( !a2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 31;
    goto LABEL_10;
  }
  if ( a3 )
  {
    sub_472EC(*(_DWORD *)(a1 + 24), a2 + 24);
    v6 = off_5A148;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x20u, (__int64)&unk_57BD0);
  }
  return 0i64;
}

//----- (00000000000477F4) ----------------------------------------------------
_DWORD *__fastcall sub_477F4(unsigned __int8 a1, __int64 a2, int a3, ULONG a4, __int64 a5, __int64 a6, __int64 a7, __int64 a8, __int64 a9, __int64 a10, _DWORD *a11)
{
  PDEVICE_OBJECT v14; // rcx
  int v16; // ebx
  int v17; // eax
  int v18; // esi
  _DWORD *v19; // rbx
  char *v20; // rax
  unsigned int i; // edi
  PDEVICE_OBJECT v22; // rcx

  v14 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x21u, (__int64)&unk_57BD0);
    v14 = off_5A148;
  }
  *a11 = 0;
  if ( a1 > 0x1Eu )
  {
    if ( v14 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v14->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v14->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_184C0(*(_QWORD *)&v14->AlignmentRequirement, 0x22u, (__int64)&unk_57BD0, a1);
    }
LABEL_10:
    *a11 = 3;
    return 0i64;
  }
  v16 = 1 << a1;
  v17 = sub_4A5D8(v16);
  v18 = v17;
  if ( !v17 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x23u, (__int64)&unk_57BD0, v16);
    }
    goto LABEL_10;
  }
  if ( a3 != 1 && a3 != 2 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_184C0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x24u, (__int64)&unk_57BD0, a3);
    }
    goto LABEL_10;
  }
  v19 = sub_3C4EC(2, 16 * (5 * v17 + 5), a4);
  if ( !v19 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x25u, (__int64)&unk_57BD0);
    }
LABEL_28:
    *a11 = 2;
    return 0i64;
  }
  v20 = sub_3C76C(a3, 0x38u, a4);
  *((_QWORD *)v19 + 9) = v20;
  if ( !v20 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x26u, (__int64)&unk_57BD0);
    }
    sub_3C570(v19, a4);
    goto LABEL_28;
  }
  v19[3] = a4;
  *((_QWORD *)v19 + 2) = 0i64;
  *v19 = 0;
  v19[1] = v18;
  v19[2] = 0;
  v19[6] = 2;
  for ( i = 0; i < v19[1]; ++i )
    sub_475A4((__int64)v19, (__int64)&v19[20 * i + 20], 1);
  *((_QWORD *)v19 + 5) = 0i64;
  *((_QWORD *)v19 + 6) = 0i64;
  *((_QWORD *)v19 + 7) = a9;
  *((_QWORD *)v19 + 8) = 0i64;
  v22 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_4707C(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x27u, (__int64)&unk_57BD0, v19[1]);
      v22 = off_5A148;
    }
    if ( v22 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v22->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v22->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v22->AlignmentRequirement, 0x28u, (__int64)&unk_57BD0);
    }
  }
  return v19;
}

//----- (0000000000047B3C) ----------------------------------------------------
__int64 __fastcall sub_47B3C(ULONG_PTR BugCheckParameter2)
{
  PDEVICE_OBJECT v2; // rcx
  __int64 v4; // rsi
  _QWORD **v5; // r12
  int v6; // ecx
  struct _FAST_MUTEX *v7; // r14
  _QWORD *v8; // rbp
  ULONG_PTR v9; // r13
  PDEVICE_OBJECT v10; // rcx
  ULONG_PTR v11; // rbx
  int v12; // eax
  int i; // ebx
  __int64 j; // rbx
  PDEVICE_OBJECT v15; // rcx
  __int64 v16; // [rsp+20h] [rbp-98h]
  __int64 v17; // [rsp+30h] [rbp-88h] BYREF
  _BYTE v18[72]; // [rsp+38h] [rbp-80h] BYREF
  KIRQL v19; // [rsp+C0h] [rbp+8h] BYREF
  unsigned int v20; // [rsp+D0h] [rbp+18h] BYREF
  union _LARGE_INTEGER Interval; // [rsp+D8h] [rbp+20h] BYREF

  v20 = 0;
  v17 = 0i64;
  memset(v18, 0, sizeof(v18));
  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x36u, (__int64)&unk_57BD0);
    v2 = off_5A148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v2 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v2->AlignmentRequirement, 0x37u, (__int64)&unk_57BD0);
    }
    return 3i64;
  }
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v2->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_4707C(*(_QWORD *)&v2->AlignmentRequirement, 0x38u, (__int64)&unk_57BD0, *(_DWORD *)(BugCheckParameter2 + 4));
  }
  _InterlockedAdd((volatile signed __int32 *)(BugCheckParameter2 + 28), 1u);
  v4 = 0i64;
  if ( !*(_DWORD *)(BugCheckParameter2 + 4) )
    goto LABEL_38;
  v5 = (_QWORD **)(BugCheckParameter2 + 80);
  do
  {
    v6 = *(_DWORD *)(BugCheckParameter2 + 24);
    v7 = (struct _FAST_MUTEX *)(BugCheckParameter2 + 80 * v4 + 104);
    Interval.QuadPart = (LONGLONG)v7;
    sub_4744C(v6, v7, &v19);
    v8 = *v5;
    v9 = BugCheckParameter2 + 80 * v4 + 80;
    if ( *v5 == (_QWORD *)v9 )
      goto LABEL_37;
    v10 = off_5A148;
    do
    {
      v11 = (ULONG_PTR)v8;
      v8 = (_QWORD *)*v8;
      if ( *(_BYTE *)(v11 + 44) )
      {
        if ( v10 != (PDEVICE_OBJECT)&off_5A148
          && SBYTE4(v10->DeviceQueue.DeviceListHead.Flink) < 0
          && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          LODWORD(v16) = *(_DWORD *)(v11 + 40);
          sub_4AC00(*(_QWORD *)&v10->AlignmentRequirement, 0x39u, (__int64)&unk_57BD0, *(_QWORD *)(v11 + 16), v16);
LABEL_34:
          v10 = off_5A148;
          continue;
        }
      }
      else
      {
        if ( !sub_4A2A0((_BYTE *)BugCheckParameter2, &v20) )
          v20 = sub_49FD8(BugCheckParameter2, v11, 1);
        if ( *(_DWORD *)(v11 + 40) )
        {
          *(_BYTE *)(v11 + 44) = 1;
          goto LABEL_34;
        }
        v20 = sub_4824C(BugCheckParameter2, v4, (__int64 *)v11);
        if ( !v20 )
        {
          sub_48448(BugCheckParameter2, (__int64)&v17, v11);
          goto LABEL_34;
        }
        v10 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
        {
          sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Au, (__int64)&unk_57BD0);
          goto LABEL_34;
        }
      }
    }
    while ( v8 != (_QWORD *)v9 );
    v7 = (struct _FAST_MUTEX *)Interval.QuadPart;
LABEL_37:
    sub_47510(*(_DWORD *)(BugCheckParameter2 + 24), v7, v19);
    v4 = (unsigned int)(v4 + 1);
    v5 += 10;
  }
  while ( (unsigned int)v4 < *(_DWORD *)(BugCheckParameter2 + 4) );
LABEL_38:
  sub_485C8(BugCheckParameter2, (__int64)&v17);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Bu, (__int64)&unk_57BD0);
  }
  v12 = sub_487F8(BugCheckParameter2, &v20);
  if ( v12 )
  {
    Interval.QuadPart = -5000000i64;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Cu, (__int64)&unk_57BD0, v12);
    }
    for ( i = 0; i < 10; ++i )
    {
      if ( !(unsigned int)sub_487F8(BugCheckParameter2, &v20) )
        break;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Du, (__int64)&unk_57BD0, i);
      }
      KeDelayExecutionThread(0, 0, &Interval);
    }
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Eu, (__int64)&unk_57BD0);
  }
  for ( j = 0i64; (unsigned int)j < *(_DWORD *)(BugCheckParameter2 + 4); j = (unsigned int)(j + 1) )
    sub_476D0(BugCheckParameter2, BugCheckParameter2 + 16 * (5 * j + 5), 1);
  sub_3C7F0(*(PVOID *)(BugCheckParameter2 + 72));
  sub_3C570((PVOID)BugCheckParameter2, *(_DWORD *)(BugCheckParameter2 + 12));
  v15 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Fu, (__int64)&unk_57BD0);
      v15 = off_5A148;
    }
    if ( v15 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v15->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v15->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v15->AlignmentRequirement, 0x40u, (__int64)&unk_57BD0);
    }
  }
  return v20;
}
// 47CD6: variable 'v16' is possibly undefined

//----- (0000000000047FC8) ----------------------------------------------------
unsigned __int64 __fastcall sub_47FC8(__int64 a1, unsigned __int64 a2, _DWORD *a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int64 result; // rax

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x5Au, (__int64)&unk_57BD0);
    v6 = off_5A148;
  }
  *a3 = 0;
  if ( a1 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x5Cu, (__int64)&unk_57BD0);
    }
    result = a2 % *(unsigned int *)(a1 + 4);
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x5Bu, (__int64)&unk_57BD0);
    }
    *a3 = 3;
    result = 0xFFFFFFFFi64;
  }
  return result;
}

//----- (00000000000480C4) ----------------------------------------------------
_DWORD *__fastcall sub_480C4(__int64 a1, __int64 a2, _DWORD *a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  _DWORD *v9; // rax
  _DWORD *v10; // rdi
  __int64 v11; // r11

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x5Du, (__int64)&unk_57BD0);
    v6 = off_5A148;
  }
  *a3 = 0;
  if ( !a1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v7 = 94;
LABEL_10:
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_57BD0);
LABEL_11:
    *a3 = 3;
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v7 = 95;
    goto LABEL_10;
  }
  v9 = sub_3C910(*(_QWORD *)(a1 + 72));
  v10 = v9;
  if ( !v9 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x60u, (__int64)&unk_57BD0);
    }
    *a3 = 2;
    return 0i64;
  }
  memset(v9, 0, 0x38ui64);
  v11 = *(_QWORD *)(a1 + 16);
  *((_QWORD *)v10 + 4) = a2;
  *((_QWORD *)v10 + 3) = v11;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x61u, (__int64)&unk_57BD0);
  }
  return v10;
}

//----- (000000000004824C) ----------------------------------------------------
__int64 __fastcall sub_4824C(__int64 a1, unsigned int a2, __int64 *a3)
{
  __int64 v4; // rsi
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  __int64 result; // rax
  _QWORD *v9; // rax
  __int64 v10; // rcx
  signed __int32 v11; // eax
  PDEVICE_OBJECT v12; // rcx
  __int64 v13; // [rsp+20h] [rbp-28h]
  unsigned int v14; // [rsp+50h] [rbp+8h] BYREF

  v14 = 0;
  v4 = a2;
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x62u, (__int64)&unk_57BD0);
    v6 = off_5A148;
  }
  if ( !a1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 99;
LABEL_10:
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_57BD0);
    return 3i64;
  }
  if ( !a3 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 100;
    goto LABEL_10;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_4AC00(*(_QWORD *)&v6->AlignmentRequirement, 0x65u, (__int64)&unk_57BD0, a3[2], *((_DWORD *)a3 + 10));
  }
  if ( sub_4A3EC((_BYTE *)a1, &v14) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x66u, (__int64)&unk_57BD0);
    }
    result = 12i64;
  }
  else
  {
    v9 = (_QWORD *)a3[1];
    v10 = *a3;
    *v9 = *a3;
    *(_QWORD *)(v10 + 8) = v9;
    --*(_DWORD *)(a1 + 80 * v4 + 96);
    v11 = _InterlockedDecrement((volatile signed __int32 *)(a1 + 8));
    v12 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        LODWORD(v13) = *(_DWORD *)(a1 + 80 * v4 + 96);
        sub_18284(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x67u, (__int64)&unk_57BD0, a3[2], v13, v11);
        v12 = off_5A148;
      }
      if ( v12 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(v12->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(v12->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v12->AlignmentRequirement, 0x68u, (__int64)&unk_57BD0);
      }
    }
    result = v14;
  }
  return result;
}
// 483F1: variable 'v13' is possibly undefined

//----- (0000000000048448) ----------------------------------------------------
__int64 __fastcall sub_48448(__int64 a1, __int64 a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  __int64 *v7; // rax
  __int64 result; // rax
  int v9; // [rsp+20h] [rbp-18h]

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x69u, (__int64)&unk_57BD0);
    v6 = off_5A148;
  }
  if ( a1 && a2 && a3 )
  {
    if ( !*(_DWORD *)(a2 + 16) )
    {
      sub_475A4(a1, a2, 0);
      v6 = off_5A148;
    }
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v9 = *(_DWORD *)(a3 + 40);
      sub_4AC00(*(_QWORD *)&v6->AlignmentRequirement, 0x6Bu, (__int64)&unk_57BD0, *(_QWORD *)(a3 + 16), v9);
    }
    v7 = *(__int64 **)(a2 + 8);
    *(_QWORD *)a3 = a2;
    *(_QWORD *)(a3 + 8) = v7;
    *v7 = a3;
    ++*(_DWORD *)(a2 + 16);
    *(_QWORD *)(a2 + 8) = a3;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Cu, (__int64)&unk_57BD0);
    }
    result = 0i64;
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_39144(*(_QWORD *)&v6->AlignmentRequirement, 0x6Au, (__int64)&unk_57BD0, a1, a2, a3);
    }
    result = 3i64;
  }
  return result;
}

//----- (00000000000485C8) ----------------------------------------------------
__int64 __fastcall sub_485C8(__int64 a1, __int64 a2)
{
  unsigned int v4; // edi
  PDEVICE_OBJECT v5; // rcx
  __int64 *v6; // r12
  __int64 *v7; // rsi
  __int64 v8; // rcx
  __int64 *v9; // rax
  __int64 v10; // rcx
  void (__fastcall *v11)(__int64); // rax
  __int64 result; // rax

  v4 = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Du, (__int64)&unk_57BD0);
    v5 = off_5A148;
  }
  if ( a1 && a2 )
  {
    if ( *(_DWORD *)(a2 + 16) )
    {
      v6 = *(__int64 **)a2;
      while ( *(_QWORD *)a2 != a2 )
      {
        v7 = v6;
        v6 = (__int64 *)*v6;
        v8 = *v7;
        v9 = (__int64 *)v7[1];
        *v9 = *v7;
        *(_QWORD *)(v8 + 8) = v9;
        --*(_DWORD *)(a2 + 16);
        v10 = v7[4];
        if ( v10 )
        {
          v11 = *(void (__fastcall **)(__int64))(a1 + 56);
          if ( v11 )
          {
            v11(v10);
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
              && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
            {
              sub_12D64(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x71u, (__int64)&unk_57BD0, v7[2]);
            }
            sub_3C978(*(_QWORD *)(a1 + 72), (__int64)v7);
          }
          else
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
              && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
            {
              sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x70u, (__int64)&unk_57BD0);
            }
            v4 = 5;
          }
        }
        else
        {
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
          {
            sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Fu, (__int64)&unk_57BD0);
          }
          v4 = 6;
        }
      }
    }
    else
    {
      v4 = 4;
    }
    sub_476D0(a1, a2, 0);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x72u, (__int64)&unk_57BD0);
    }
    result = v4;
  }
  else
  {
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EE0(*(_QWORD *)&v5->AlignmentRequirement, 0x6Eu, (__int64)&unk_57BD0, a1, a2);
    }
    result = 3i64;
  }
  return result;
}

//----- (00000000000487F8) ----------------------------------------------------
__int64 __fastcall sub_487F8(__int64 a1, _DWORD *a2)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  unsigned __int32 v6; // ebx

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x73u, (__int64)&unk_57BD0);
    v4 = off_5A148;
  }
  *a2 = 0;
  if ( a1 )
  {
    v6 = _InterlockedExchangeAdd((volatile signed __int32 *)(a1 + 8), 0);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x75u, (__int64)&unk_57BD0);
    }
    result = v6;
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x74u, (__int64)&unk_57BD0);
    }
    *a2 = 3;
    result = 0i64;
  }
  return result;
}

//----- (00000000000488F0) ----------------------------------------------------
__int64 __fastcall sub_488F0(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4)
{
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  __int64 result; // rax
  ULONG_PTR v11; // rax
  PDEVICE_OBJECT v12; // rcx
  unsigned int v13; // ebx
  __int64 v14; // [rsp+60h] [rbp+8h] BYREF

  LODWORD(v14) = 0;
  v8 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x86u, (__int64)&unk_57BD0);
    v8 = off_5A148;
  }
  if ( a4 )
  {
    *a4 = 0i64;
    v8 = off_5A148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v8->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v9 = 135;
LABEL_12:
    sub_11088(*(_QWORD *)&v8->AlignmentRequirement, v9, (__int64)&unk_57BD0);
    return 3i64;
  }
  if ( !a3 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v8->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v9 = 136;
    goto LABEL_12;
  }
  if ( _InterlockedCompareExchange((volatile signed __int32 *)(BugCheckParameter2 + 28), 0, 0) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x89u, (__int64)&unk_57BD0);
    }
    result = 9i64;
  }
  else
  {
    v11 = sub_493E8(BugCheckParameter2, a2, a3, a4, (__int64)&v14);
    if ( v11 )
    {
      if ( v11 == a3 )
      {
        v13 = v14;
        v12 = off_5A148;
      }
      else
      {
        if ( a4 )
          sub_49CF0(BugCheckParameter2, (ULONG_PTR)*a4);
        v12 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_12D64(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x8Bu, (__int64)&unk_57BD0, a2);
          v12 = off_5A148;
        }
        v13 = 7;
      }
      if ( v12 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(v12->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(v12->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v12->AlignmentRequirement, 0x8Cu, (__int64)&unk_57BD0);
      }
      result = v13;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x8Au, (__int64)&unk_57BD0, v14);
      }
      result = (unsigned int)v14;
    }
  }
  return result;
}

//----- (0000000000048B2C) ----------------------------------------------------
__int64 __fastcall sub_48B2C(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, _DWORD *a4)
{
  __int64 v4; // rbp
  PDEVICE_OBJECT v8; // rcx
  __int64 v10; // r14
  struct _FAST_MUTEX *v11; // r13
  _QWORD *v12; // rax
  __int64 v13; // rsi
  int v14; // eax
  __int64 v15; // [rsp+20h] [rbp-78h] BYREF
  _BYTE v16[72]; // [rsp+28h] [rbp-70h] BYREF
  KIRQL v17; // [rsp+A0h] [rbp+8h] BYREF

  v4 = 0i64;
  v15 = 0i64;
  memset(v16, 0, sizeof(v16));
  v8 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x93u, (__int64)&unk_57BD0);
    v8 = off_5A148;
  }
  *a4 = 0;
  if ( !BugCheckParameter2 )
  {
    if ( v8 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v8->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(v8->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v8->AlignmentRequirement, 0x94u, (__int64)&unk_57BD0);
    }
    *a4 = 3;
    return 0i64;
  }
  if ( sub_4A2A0((_BYTE *)BugCheckParameter2, a4) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x80) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x95u, (__int64)&unk_57BD0);
    }
    *a4 = 10;
    return 0i64;
  }
  v10 = (unsigned int)sub_47FC8(BugCheckParameter2, a2, a4);
  v11 = (struct _FAST_MUTEX *)(BugCheckParameter2 + 80 * v10 + 104);
  sub_4744C(*(_DWORD *)(BugCheckParameter2 + 24), v11, &v17);
  v12 = sub_49228(BugCheckParameter2, v10, a2, a4);
  v13 = (__int64)v12;
  if ( v12 )
  {
    if ( *a4 == 8 )
    {
      sub_47510(*(_DWORD *)(BugCheckParameter2 + 24), v11, v17);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x96u, (__int64)&unk_57BD0, a2, v15);
      }
      return 0i64;
    }
    sub_49FD8(BugCheckParameter2, (ULONG_PTR)v12, 0);
    v4 = *(_QWORD *)(v13 + 32);
    if ( *(_DWORD *)(v13 + 40) )
    {
      *(_BYTE *)(v13 + 44) = 1;
    }
    else
    {
      v14 = sub_4824C(BugCheckParameter2, v10, (__int64 *)v13);
      *a4 = v14;
      if ( !v14 )
        sub_48448(BugCheckParameter2, (__int64)&v15, v13);
    }
  }
  sub_47510(*(_DWORD *)(BugCheckParameter2 + 24), v11, v17);
  sub_485C8(BugCheckParameter2, (__int64)&v15);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x97u, (__int64)&unk_57BD0);
  }
  return v4;
}

//----- (0000000000048DB0) ----------------------------------------------------
__int64 __fastcall sub_48DB0(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, __int64 a3, _DWORD *a4)
{
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  __int64 v10; // r13
  struct _FAST_MUTEX *v11; // r12
  __int64 v12; // rbp
  int v13; // eax
  __int64 v14; // [rsp+20h] [rbp-68h] BYREF
  _BYTE v15[72]; // [rsp+28h] [rbp-60h] BYREF
  KIRQL v16; // [rsp+90h] [rbp+8h] BYREF

  v14 = 0i64;
  memset(v15, 0, sizeof(v15));
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x9Au, (__int64)&unk_57BD0);
    v7 = off_5A148;
  }
  *a4 = 0;
  if ( !BugCheckParameter2 )
  {
    if ( v7 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v7->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v8 = 155;
LABEL_10:
    sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_57BD0);
LABEL_11:
    *a4 = 3;
    return 0i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v7 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v7->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v8 = 156;
    goto LABEL_10;
  }
  if ( sub_4A2A0((_BYTE *)BugCheckParameter2, a4) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x9Du, (__int64)&unk_57BD0);
    }
    *a4 = 10;
    return 0i64;
  }
  v10 = (unsigned int)sub_47FC8(BugCheckParameter2, *(_QWORD *)(BugCheckParameter1 + 16), a4);
  v11 = (struct _FAST_MUTEX *)(BugCheckParameter2 + 80 * v10 + 104);
  sub_4744C(*(_DWORD *)(BugCheckParameter2 + 24), v11, &v16);
  if ( *(_BYTE *)(BugCheckParameter1 + 44) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
    {
      sub_12D64(
        *(_QWORD *)&off_5A148->AlignmentRequirement,
        0x9Eu,
        (__int64)&unk_57BD0,
        *(_QWORD *)(BugCheckParameter1 + 16),
        v14);
    }
    sub_47510(*(_DWORD *)(BugCheckParameter2 + 24), v11, v16);
    *a4 = 8;
    return 0i64;
  }
  sub_49FD8(BugCheckParameter2, BugCheckParameter1, 0);
  v12 = *(_QWORD *)(BugCheckParameter1 + 32);
  if ( *(_DWORD *)(BugCheckParameter1 + 40) )
  {
    *(_BYTE *)(BugCheckParameter1 + 44) = 1;
  }
  else
  {
    v13 = sub_4824C(BugCheckParameter2, v10, (__int64 *)BugCheckParameter1);
    *a4 = v13;
    if ( !v13 )
      sub_48448(BugCheckParameter2, (__int64)&v14, BugCheckParameter1);
  }
  sub_47510(*(_DWORD *)(BugCheckParameter2 + 24), v11, v16);
  sub_485C8(BugCheckParameter2, (__int64)&v14);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x9Fu, (__int64)&unk_57BD0);
  }
  return v12;
}

//----- (0000000000049034) ----------------------------------------------------
__int64 __fastcall sub_49034(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, _QWORD *a3, _DWORD *a4)
{
  __int64 v8; // r12
  PDEVICE_OBJECT v9; // rcx
  unsigned int v11; // ebx
  struct _FAST_MUTEX *v12; // r13
  _QWORD *v13; // rax
  _QWORD *v14; // rbx
  KIRQL v15; // [rsp+50h] [rbp+8h] BYREF

  v8 = 0i64;
  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xACu, (__int64)&unk_57BD0);
    v9 = off_5A148;
  }
  *a4 = 4;
  if ( a3 )
  {
    *a3 = 0i64;
    v9 = off_5A148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v9->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v9->AlignmentRequirement, 0xADu, (__int64)&unk_57BD0);
    }
    *a4 = 3;
    return 0i64;
  }
  v11 = sub_47FC8(BugCheckParameter2, a2, a4);
  v12 = (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v11 + 104);
  sub_4744C(*(_DWORD *)(BugCheckParameter2 + 24), v12, &v15);
  v13 = sub_49228(BugCheckParameter2, v11, a2, a4);
  v14 = v13;
  if ( v13 )
  {
    if ( *a4 == 8 )
    {
      sub_47510(*(_DWORD *)(BugCheckParameter2 + 24), v12, v15);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_12D64(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xAEu, (__int64)&unk_57BD0, a2);
      }
      return 0i64;
    }
    v8 = v13[4];
    if ( a3 )
    {
      sub_49E94(BugCheckParameter2, (ULONG_PTR)v13, 0);
      *a3 = v14;
    }
  }
  sub_47510(*(_DWORD *)(BugCheckParameter2 + 24), v12, v15);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xAFu, (__int64)&unk_57BD0);
  }
  return v8;
}

//----- (0000000000049228) ----------------------------------------------------
_QWORD *__fastcall sub_49228(__int64 a1, unsigned int a2, __int64 a3, _DWORD *a4)
{
  __int64 v6; // r12
  _QWORD *v8; // rsi
  PDEVICE_OBJECT v9; // rcx
  _QWORD *result; // rax
  _QWORD *v11; // rdx
  _QWORD *v12; // rbx

  v6 = a2;
  v8 = 0i64;
  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xB0u, (__int64)&unk_57BD0);
    v9 = off_5A148;
  }
  *a4 = 4;
  if ( a1 )
  {
    v11 = (_QWORD *)(a1 + 16 * (5 * v6 + 5));
    if ( (_QWORD *)*v11 != v11 )
    {
      v12 = (_QWORD *)*v11;
      while ( v12 != v11 )
      {
        v8 = v12;
        if ( v12[2] == a3 )
        {
          if ( v9 != (PDEVICE_OBJECT)&off_5A148
            && SBYTE4(v9->DeviceQueue.DeviceListHead.Flink) < 0
            && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 4u )
          {
            sub_17BF0(*(_QWORD *)&v9->AlignmentRequirement, 0xB2u, (__int64)&unk_57BD0, v6);
            v9 = off_5A148;
          }
          if ( *((_BYTE *)v12 + 44) )
          {
            if ( v9 != (PDEVICE_OBJECT)&off_5A148
              && SBYTE4(v9->DeviceQueue.DeviceListHead.Flink) < 0
              && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 4u )
            {
              sub_12D64(*(_QWORD *)&v9->AlignmentRequirement, 0xB3u, (__int64)&unk_57BD0, v12[2]);
              v9 = off_5A148;
            }
            *a4 = 8;
          }
          else
          {
            *a4 = 0;
          }
          break;
        }
        v12 = (_QWORD *)*v12;
        v8 = 0i64;
      }
    }
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v9->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v9->AlignmentRequirement, 0xB4u, (__int64)&unk_57BD0);
    }
    result = v8;
  }
  else
  {
    if ( v9 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v9->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v9->AlignmentRequirement, 0xB1u, (__int64)&unk_57BD0);
    }
    *a4 = 3;
    result = 0i64;
  }
  return result;
}

//----- (00000000000493E8) ----------------------------------------------------
ULONG_PTR __fastcall sub_493E8(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4, __int64 a5)
{
  ULONG_PTR v9; // r12
  unsigned int v10; // er14
  PDEVICE_OBJECT v11; // rcx
  _DWORD *v12; // rbp
  int v14; // ebx
  unsigned int v15; // edi
  __int64 v16; // r14
  ULONG_PTR *v17; // rax
  ULONG_PTR *v18; // rdi
  ULONG_PTR *v19; // rax
  ULONG_PTR v20; // rcx
  ULONG_PTR **v21; // rax
  ULONG_PTR v22; // [rsp+20h] [rbp-58h]
  int v23[4]; // [rsp+40h] [rbp-38h] BYREF
  int v24; // [rsp+80h] [rbp+8h]

  v9 = 0i64;
  v23[0] = 0;
  v10 = 0;
  v11 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xB5u, (__int64)&unk_57BD0);
    v11 = off_5A148;
  }
  v12 = (_DWORD *)a5;
  if ( !a5 )
  {
    if ( v11 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v11->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v11->AlignmentRequirement, 0xB6u, (__int64)&unk_57BD0);
    }
    return 0i64;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v11 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v11->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v11->AlignmentRequirement, 0xB7u, (__int64)&unk_57BD0);
    }
    *v12 = 3;
    return 0i64;
  }
  if ( !a3 )
  {
    if ( v11 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v11->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v11->AlignmentRequirement, 0xB8u, (__int64)&unk_57BD0);
    }
    v14 = 3;
    goto LABEL_37;
  }
  if ( _InterlockedCompareExchange((volatile signed __int32 *)(BugCheckParameter2 + 28), 0, 0) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xB9u, (__int64)&unk_57BD0);
    }
    *v12 = 9;
    return 0i64;
  }
  v15 = sub_47FC8(BugCheckParameter2, a2, v23);
  v24 = v15;
  v16 = 10i64 * v15;
  sub_4744C(
    *(_DWORD *)(BugCheckParameter2 + 24),
    (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v15 + 104),
    (KIRQL *)&a5);
  if ( sub_4A154((_BYTE *)BugCheckParameter2, v23)
    || (v17 = sub_49228(BugCheckParameter2, v15, a2, v23), (v18 = v17) == 0i64) )
  {
    v19 = (ULONG_PTR *)sub_480C4(BugCheckParameter2, a3, v23);
    v18 = v19;
    if ( !v19 )
    {
      v14 = 2;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xBCu, (__int64)&unk_57BD0);
      }
      goto LABEL_36;
    }
    v19[2] = a2;
    if ( !sub_4A2A0((_BYTE *)BugCheckParameter2, v23) )
      sub_49E94(BugCheckParameter2, (ULONG_PTR)v18, 1);
    v20 = BugCheckParameter2 + 8 * v16 + 80;
    v21 = *(ULONG_PTR ***)(BugCheckParameter2 + 8 * v16 + 88);
    *v18 = v20;
    v18[1] = (ULONG_PTR)v21;
    *v21 = v18;
    *(_QWORD *)(v20 + 8) = v18;
    ++*(_DWORD *)(BugCheckParameter2 + 8 * v16 + 96);
    _InterlockedIncrement((volatile signed __int32 *)(BugCheckParameter2 + 8));
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      v10 = v24;
      v22 = v18[2];
      sub_470D8(*(_QWORD *)&off_5A148->AlignmentRequirement, 189i64, (__int64)&unk_57BD0, v24);
      v14 = v23[0];
      goto LABEL_59;
    }
    v14 = v23[0];
LABEL_58:
    v10 = v24;
LABEL_59:
    v9 = v18[4];
    if ( a4 )
    {
      sub_49E94(BugCheckParameter2, (ULONG_PTR)v18, 1);
      *a4 = v18;
    }
    goto LABEL_37;
  }
  sub_4A708(BugCheckParameter2, (ULONG_PTR)v17);
  v14 = v23[0];
  if ( v23[0] != 8 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0 )
    {
      v10 = v24;
      if ( BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v22 = v18[2];
        sub_17BF0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xBBu, (__int64)&unk_57BD0, v24);
      }
      goto LABEL_59;
    }
    goto LABEL_58;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xBAu, (__int64)&unk_57BD0, a2);
  }
LABEL_36:
  v10 = v24;
LABEL_37:
  sub_47510(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v10 + 104), a5);
  *v12 = v14;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    LODWORD(v22) = v14;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xBEu, (__int64)&unk_57BD0, v9, v22);
  }
  return v9;
}
// 49699: variable 'v22' is possibly undefined

//----- (0000000000049870) ----------------------------------------------------
__int64 __fastcall sub_49870(ULONG_PTR BugCheckParameter2, ULONG_PTR *a2, _DWORD *a3)
{
  __int64 v6; // rdi
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  unsigned int v10; // ebp
  _QWORD **v11; // r13
  _QWORD *v12; // r11
  ULONG_PTR v13; // rbx
  KIRQL v14; // [rsp+50h] [rbp+8h] BYREF

  v6 = 0i64;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xBFu, (__int64)&unk_57BD0);
    v7 = off_5A148;
  }
  *a3 = 0;
  if ( !BugCheckParameter2 )
  {
    if ( v7 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v7->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v8 = 192;
LABEL_10:
    sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_57BD0);
LABEL_11:
    *a3 = 3;
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v7 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v7->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v8 = 193;
    goto LABEL_10;
  }
  *a2 = 0i64;
  v10 = 0;
  if ( *(_DWORD *)(BugCheckParameter2 + 4) )
  {
    v11 = (_QWORD **)(BugCheckParameter2 + 80);
LABEL_19:
    sub_4744C(
      *(_DWORD *)(BugCheckParameter2 + 24),
      (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v10 + 104),
      &v14);
    v12 = *v11;
    do
    {
      if ( v12 == (_QWORD *)(BugCheckParameter2 + 80i64 * v10 + 80) )
      {
        sub_47510(
          *(_DWORD *)(BugCheckParameter2 + 24),
          (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v10++ + 104),
          v14);
        v11 += 10;
        if ( v10 >= *(_DWORD *)(BugCheckParameter2 + 4) )
          goto LABEL_25;
        goto LABEL_19;
      }
      v13 = (ULONG_PTR)v12;
      v12 = (_QWORD *)*v12;
    }
    while ( *(_BYTE *)(v13 + 44) );
    *a2 = v13;
    sub_49E94(BugCheckParameter2, v13, 1);
    v6 = *(_QWORD *)(v13 + 32);
    sub_47510(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v10 + 104), v14);
LABEL_25:
    v7 = off_5A148;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v7->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0xC2u, (__int64)&unk_57BD0);
  }
  return v6;
}

//----- (0000000000049A3C) ----------------------------------------------------
__int64 __fastcall sub_49A3C(ULONG_PTR BugCheckParameter2, ULONG_PTR *a2, __int64 a3, _DWORD *a4)
{
  ULONG_PTR v4; // r14
  __int64 v5; // rdi
  PDEVICE_OBJECT v8; // rcx
  unsigned __int16 v9; // dx
  __int64 v11; // r12
  ULONG_PTR v12; // rsi
  struct _FAST_MUTEX *v13; // r15
  _QWORD *v14; // r13
  int v15; // eax
  int v16; // eax
  ULONG_PTR v17; // rbp
  ULONG_PTR v18; // r14
  __int64 v19; // [rsp+20h] [rbp-88h] BYREF
  char Dst[72]; // [rsp+28h] [rbp-80h] BYREF
  KIRQL v21; // [rsp+B0h] [rbp+8h] BYREF
  ULONG_PTR *v22; // [rsp+B8h] [rbp+10h]

  v22 = a2;
  v4 = *a2;
  v5 = 0i64;
  v19 = 0i64;
  memset(Dst, 0, sizeof(Dst));
  v8 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xC3u, (__int64)&unk_57BD0);
    v8 = off_5A148;
  }
  *a4 = 0;
  if ( !BugCheckParameter2 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v8->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v9 = 196;
LABEL_10:
    sub_11088(*(_QWORD *)&v8->AlignmentRequirement, v9, (__int64)&unk_57BD0);
LABEL_11:
    *a4 = 3;
    return 0i64;
  }
  if ( !v4 )
  {
    if ( v8 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v8->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v8->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_11;
    }
    v9 = 197;
    goto LABEL_10;
  }
  LODWORD(v11) = sub_47FC8(BugCheckParameter2, *(_QWORD *)(v4 + 16), a4);
  v12 = BugCheckParameter2 + 16 * (5i64 * (unsigned int)v11 + 5);
  v13 = (struct _FAST_MUTEX *)(v12 + 24);
  sub_4744C(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v12 + 24), &v21);
  v14 = *(_QWORD **)v4;
  v15 = sub_49FD8(BugCheckParameter2, v4, 1);
  *a4 = v15;
  if ( !v15 && !*(_DWORD *)(v4 + 40) )
  {
    v16 = sub_4824C(BugCheckParameter2, v11, (__int64 *)v4);
    *a4 = v16;
    if ( !v16 )
      sub_48448(BugCheckParameter2, (__int64)&v19, v4);
  }
  if ( v14 != (_QWORD *)v12 )
    goto LABEL_24;
  sub_47510(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v12 + 24), v21);
  v11 = (unsigned int)(v11 + 1);
  if ( (unsigned int)v11 < *(_DWORD *)(BugCheckParameter2 + 4) )
  {
    v12 = BugCheckParameter2 + 16 * (5 * v11 + 5);
    v13 = (struct _FAST_MUTEX *)(v12 + 24);
    sub_4744C(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v12 + 24), &v21);
    v14 = *(_QWORD **)v12;
LABEL_24:
    v17 = BugCheckParameter2 + 16 * (5i64 * (int)v11 + 5);
    do
    {
      while ( v14 == (_QWORD *)v12 )
      {
        sub_47510(*(_DWORD *)(BugCheckParameter2 + 24), v13, v21);
        LODWORD(v11) = v11 + 1;
        v17 += 80i64;
        if ( (unsigned int)v11 >= *(_DWORD *)(BugCheckParameter2 + 4) )
          goto LABEL_30;
        v13 = (struct _FAST_MUTEX *)(v17 + 24);
        v12 = v17;
        sub_4744C(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v17 + 24), &v21);
        v14 = *(_QWORD **)v17;
      }
      v18 = (ULONG_PTR)v14;
      v14 = (_QWORD *)*v14;
    }
    while ( *(_BYTE *)(v18 + 44) );
    *v22 = v18;
    sub_49E94(BugCheckParameter2, v18, 1);
    v5 = *(_QWORD *)(v18 + 32);
    sub_47510(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(v12 + 24), v21);
  }
LABEL_30:
  sub_485C8(BugCheckParameter2, (__int64)&v19);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xC6u, (__int64)&unk_57BD0);
  }
  return v5;
}

//----- (0000000000049CF0) ----------------------------------------------------
__int64 __fastcall sub_49CF0(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1)
{
  PDEVICE_OBJECT v4; // rcx
  __int64 result; // rax
  unsigned int v6; // ebx
  struct _FAST_MUTEX *v7; // rbp
  unsigned int v8; // ebx
  __int64 v9; // [rsp+20h] [rbp-68h] BYREF
  _BYTE v10[72]; // [rsp+28h] [rbp-60h] BYREF
  KIRQL v11; // [rsp+90h] [rbp+8h] BYREF
  unsigned int v12; // [rsp+98h] [rbp+10h] BYREF

  v12 = 0;
  v9 = 0i64;
  memset(v10, 0, sizeof(v10));
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xCFu, (__int64)&unk_57BD0);
    v4 = off_5A148;
  }
  if ( BugCheckParameter1 )
  {
    v6 = sub_47FC8(BugCheckParameter2, *(_QWORD *)(BugCheckParameter1 + 16), &v12);
    v7 = (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v6 + 104);
    sub_4744C(*(_DWORD *)(BugCheckParameter2 + 24), v7, &v11);
    sub_49FD8(BugCheckParameter2, BugCheckParameter1, 0);
    if ( *(_DWORD *)(BugCheckParameter1 + 40) )
    {
      v8 = v12;
    }
    else
    {
      v8 = sub_4824C(BugCheckParameter2, v6, (__int64 *)BugCheckParameter1);
      if ( !v8 )
        sub_48448(BugCheckParameter2, (__int64)&v9, BugCheckParameter1);
    }
    sub_47510(*(_DWORD *)(BugCheckParameter2 + 24), v7, v11);
    sub_485C8(BugCheckParameter2, (__int64)&v9);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xD1u, (__int64)&unk_57BD0);
    }
    result = v8;
  }
  else
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && SBYTE4(v4->DeviceQueue.DeviceListHead.Flink) < 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0xD0u, (__int64)&unk_57BD0);
    }
    result = 3i64;
  }
  return result;
}

//----- (0000000000049E94) ----------------------------------------------------
__int64 __fastcall sub_49E94(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xD6u, (__int64)&unk_57BD0);
    v6 = off_5A148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 215;
LABEL_10:
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_57BD0);
    return 3i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 216;
    goto LABEL_10;
  }
  if ( !a3 )
  {
    sub_4A708(BugCheckParameter2, BugCheckParameter1);
    v6 = off_5A148;
  }
  if ( !*(_BYTE *)(BugCheckParameter1 + 45) )
  {
    ++*(_DWORD *)(BugCheckParameter1 + 40);
    v6 = off_5A148;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_17BF0(*(_QWORD *)&v6->AlignmentRequirement, 0xD9u, (__int64)&unk_57BD0, *(_DWORD *)(BugCheckParameter1 + 40));
  }
  return 0i64;
}

//----- (0000000000049FD8) ----------------------------------------------------
__int64 __fastcall sub_49FD8(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  int v9; // eax
  __int64 v10; // rax
  int v11; // [rsp+40h] [rbp+8h] BYREF

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_12D64(
      *(_QWORD *)&off_5A148->AlignmentRequirement,
      0xDAu,
      (__int64)&unk_57BD0,
      *(_QWORD *)(BugCheckParameter1 + 16));
    v6 = off_5A148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 219;
LABEL_10:
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, v7, (__int64)&unk_57BD0);
    return 3i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || SBYTE4(v6->DeviceQueue.DeviceListHead.Flink) >= 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 3i64;
    }
    v7 = 220;
    goto LABEL_10;
  }
  if ( !a3 )
    sub_4A708(BugCheckParameter2, BugCheckParameter1);
  v9 = *(_DWORD *)(BugCheckParameter1 + 40);
  if ( v9 )
    *(_DWORD *)(BugCheckParameter1 + 40) = v9 - 1;
  v11 = 0;
  if ( sub_4A3EC((_BYTE *)BugCheckParameter2, &v11)
    && !*(_DWORD *)(BugCheckParameter1 + 40)
    && !*(_BYTE *)(BugCheckParameter1 + 45) )
  {
    v10 = MEMORY[0xFFFFF78000000014];
    *(_BYTE *)(BugCheckParameter1 + 45) = 1;
    *(_QWORD *)(BugCheckParameter1 + 48) = v10;
    ++*(_QWORD *)(BugCheckParameter2 + 32);
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_17BF0(
      *(_QWORD *)&off_5A148->AlignmentRequirement,
      0xDDu,
      (__int64)&unk_57BD0,
      *(_DWORD *)(BugCheckParameter1 + 40));
  }
  return 0i64;
}

//----- (000000000004A154) ----------------------------------------------------
char __fastcall sub_4A154(_BYTE *a1, _DWORD *a2)
{
  char v4; // bl
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v7; // dx

  v4 = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xDEu, (__int64)&unk_57BD0);
    v5 = off_5A148;
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 1) != 0 )
    {
      v4 = 1;
      if ( v5 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          v7 = 224;
LABEL_20:
          sub_11088(*(_QWORD *)&v5->AlignmentRequirement, v7, (__int64)&unk_57BD0);
          v5 = off_5A148;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else if ( v5 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v7 = 225;
        goto LABEL_20;
      }
LABEL_21:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v5->AlignmentRequirement, 0xE2u, (__int64)&unk_57BD0);
      }
      return v4;
    }
    return v4;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v5->AlignmentRequirement, 0xDFu, (__int64)&unk_57BD0);
  }
  *a2 = 3;
  return 0;
}

//----- (000000000004A2A0) ----------------------------------------------------
char __fastcall sub_4A2A0(_BYTE *a1, _DWORD *a2)
{
  char v4; // bl
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v7; // dx

  v4 = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xE3u, (__int64)&unk_57BD0);
    v5 = off_5A148;
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 2) != 0 )
    {
      v4 = 1;
      if ( v5 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          v7 = 229;
LABEL_20:
          sub_11088(*(_QWORD *)&v5->AlignmentRequirement, v7, (__int64)&unk_57BD0);
          v5 = off_5A148;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else if ( v5 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v7 = 230;
        goto LABEL_20;
      }
LABEL_21:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v5->AlignmentRequirement, 0xE7u, (__int64)&unk_57BD0);
      }
      return v4;
    }
    return v4;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v5->AlignmentRequirement, 0xE4u, (__int64)&unk_57BD0);
  }
  *a2 = 3;
  return 0;
}

//----- (000000000004A3EC) ----------------------------------------------------
char __fastcall sub_4A3EC(_BYTE *a1, _DWORD *a2)
{
  char v4; // bl
  PDEVICE_OBJECT v5; // rcx
  unsigned __int16 v7; // dx

  v4 = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xE8u, (__int64)&unk_57BD0);
    v5 = off_5A148;
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 4) != 0 )
    {
      v4 = 1;
      if ( v5 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
        {
          v7 = 234;
LABEL_20:
          sub_11088(*(_QWORD *)&v5->AlignmentRequirement, v7, (__int64)&unk_57BD0);
          v5 = off_5A148;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else if ( v5 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v7 = 235;
        goto LABEL_20;
      }
LABEL_21:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
        && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v5->AlignmentRequirement, 0xECu, (__int64)&unk_57BD0);
      }
      return v4;
    }
    return v4;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v5->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v5->AlignmentRequirement, 0xE9u, (__int64)&unk_57BD0);
  }
  *a2 = 3;
  return 0;
}

//----- (000000000004A538) ----------------------------------------------------
__int64 __fastcall sub_4A538(int a1)
{
  __int64 result; // rax
  int v3; // ebx
  int v4; // ebx
  int v5; // ebx
  int v6; // ebx
  int v7; // ebx
  int v8; // ebx
  int v9; // ebx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x108u, (__int64)&unk_57BD0);
  }
  if ( !a1 )
    return 0i64;
  result = 1i64;
  v3 = a1 - 1;
  if ( v3 )
  {
    v4 = v3 - 1;
    if ( v4 )
    {
      v5 = v4 - 1;
      if ( v5 )
      {
        v6 = v5 - 1;
        if ( v6 )
        {
          v7 = v6 - 1;
          if ( v7 )
          {
            v8 = v7 - 1;
            if ( !v8 || (v9 = v8 - 1) == 0 || v9 == 1 )
              result = 19i64;
          }
          else
          {
            result = 6i64;
          }
        }
        else
        {
          result = 5i64;
        }
      }
      else
      {
        result = 4i64;
      }
    }
    else
    {
      result = 3i64;
    }
  }
  return result;
}

//----- (000000000004A5D8) ----------------------------------------------------
__int64 __fastcall sub_4A5D8(unsigned int a1)
{
  PDEVICE_OBJECT v2; // rcx
  unsigned int v3; // ebx
  unsigned int *v4; // rax
  unsigned int v5; // edx

  v2 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x10Au, (__int64)&unk_57BD0);
    v2 = off_5A148;
  }
  v3 = 0;
  v4 = dword_57BE0;
  v5 = 0;
  while ( *v4 < a1 )
  {
    ++v5;
    ++v4;
    if ( v5 >= 0x1D )
    {
      if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
        return v3;
      if ( SBYTE4(v2->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_11088(*(_QWORD *)&v2->AlignmentRequirement, 0x10Bu, (__int64)&unk_57BD0);
LABEL_16:
        v2 = off_5A148;
        goto LABEL_17;
      }
      goto LABEL_17;
    }
  }
  v3 = dword_57BE0[v5];
  if ( v2 == (PDEVICE_OBJECT)&off_5A148 )
    return v3;
  if ( SBYTE4(v2->DeviceQueue.DeviceListHead.Flink) < 0 && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&v2->AlignmentRequirement, 0x10Cu, (__int64)&unk_57BD0, v3);
    goto LABEL_16;
  }
LABEL_17:
  if ( v2 != (PDEVICE_OBJECT)&off_5A148
    && SBYTE4(v2->DeviceQueue.DeviceListHead.Flink) < 0
    && BYTE1(v2->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v2->AlignmentRequirement, 0x10Du, (__int64)&unk_57BD0);
  }
  return v3;
}

//----- (000000000004A708) ----------------------------------------------------
char __fastcall sub_4A708(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1)
{
  char result; // al
  int v5; // [rsp+50h] [rbp+18h] BYREF

  v5 = 0;
  result = sub_4A3EC((_BYTE *)BugCheckParameter2, &v5);
  if ( result )
  {
    if ( *(_BYTE *)(BugCheckParameter1 + 45) )
      KeBugCheckEx(0xDEFECAu, BugCheckParameter1, BugCheckParameter2, 0i64, 0i64);
  }
  return result;
}

//----- (000000000004A760) ----------------------------------------------------
const char *__fastcall sub_4A760(int a1)
{
  const char *result; // rax

  if ( !(_WORD)a1 )
    return "UNKNOWN";
  switch ( (unsigned __int16)a1 )
  {
    case 1u:
      return "W_ALLOW";
    case 2u:
      return "W_DENY";
    case 3u:
      return "S_ALLOW";
  }
  if ( (unsigned __int16)a1 != 4 )
  {
    if ( (unsigned __int16)a1 == 5 )
      return "NOT_PROCESSED";
    return "UNKNOWN";
  }
  if ( _bittest(&a1, 0x1Eu) )
    result = "S_DENY_PENDING";
  else
    result = "S_DENY";
  return result;
}

//----- (000000000004A7C4) ----------------------------------------------------
const char *__fastcall sub_4A7C4(unsigned int a1)
{
  switch ( a1 )
  {
    case 0u:
      return "UNKNOWN";
    case 1u:
      return "ICMP";
    case 6u:
      return "TCP";
    case 0x11u:
      return "UDP";
    case 0x3Au:
      return "ICMPV6";
  }
  sub_53BB4(byte_5A5A8, 4ui64, "%d", a1);
  return byte_5A5A8;
}

//----- (000000000004A83C) ----------------------------------------------------
const char *__fastcall sub_4A83C(int a1)
{
  __int64 v1; // r9
  int v3; // ecx
  int v4; // ecx
  int v5; // ecx
  int v6; // ecx

  v1 = (unsigned int)a1;
  if ( a1 <= 5 )
  {
    switch ( a1 )
    {
      case 5:
        return "HTTPS";
      case 0:
        return "UNKNOWN";
      case 1:
        return "PENDING";
      case 2:
        return "DNS";
      case 3:
        return "DHCP";
      case 4:
        return "HTTP";
    }
    goto LABEL_19;
  }
  v3 = a1 - 7;
  if ( !v3 )
    return "SMTP";
  v4 = v3 - 1;
  if ( !v4 )
    return "FTP";
  v5 = v4 - 1;
  if ( !v5 )
    return "POP3";
  v6 = v5 - 1;
  if ( !v6 )
    return "PAP";
  if ( v6 != 1 )
  {
LABEL_19:
    sub_53BB4(byte_5A5A0, 4ui64, "%d", v1);
    return byte_5A5A0;
  }
  return "DHCPV6";
}

//----- (000000000004A914) ----------------------------------------------------
__int64 __fastcall sub_4A914(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+168h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57BC0, 119i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004AA58) ----------------------------------------------------
__int64 __fastcall sub_4AA58(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5, const char *a6)
{
  int v8; // [rsp+88h] [rbp+20h] BYREF

  v8 = a4;
  if ( a6 )
    strlen(a6);
  if ( a5 )
    strlen(a5);
  return qword_5A1B8(a1, 43i64, &unk_57BC0, 336i64, &v8);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004AB20) ----------------------------------------------------
__int64 __fastcall sub_4AB20(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57BC0, 10i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004AB78) ----------------------------------------------------
__int64 __fastcall sub_4AB78(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, const char *a5)
{
  int v7; // [rsp+78h] [rbp+20h] BYREF

  v7 = a4;
  if ( a5 )
    strlen(a5);
  return qword_5A1B8(a1, 43i64, &unk_57BC0, a2, &v7);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004AC00) ----------------------------------------------------
__int64 sub_4AC00(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, a3, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004AC4C) ----------------------------------------------------
__int64 sub_4AC4C(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+C8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57BC0, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004ACE4) ----------------------------------------------------
__int64 sub_4ACE4(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+A8h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57BC0, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004AD64) ----------------------------------------------------
__int64 sub_4AD64(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57BC0, 32i64, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004ADC8) ----------------------------------------------------
__int64 sub_4ADC8(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_5A1B8(a1, 43i64, &unk_57BC0, a2, (__int64 *)va);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000004AE28) ----------------------------------------------------
_BYTE *__fastcall sub_4AE28(__int64 a1, int a2)
{
  __int64 v2; // rbx
  unsigned __int16 v5; // dx
  _BYTE *v6; // rdi
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  int v12; // eax
  unsigned __int8 v13; // al
  __int64 v14; // rbx
  unsigned __int16 v15; // dx
  __int64 v16; // [rsp+30h] [rbp-78h] BYREF
  unsigned __int64 v17; // [rsp+38h] [rbp-70h] BYREF
  char Dst[40]; // [rsp+40h] [rbp-68h] BYREF
  unsigned __int8 v19; // [rsp+B8h] [rbp+10h] BYREF
  char v20; // [rsp+C0h] [rbp+18h] BYREF
  unsigned __int16 v21; // [rsp+C8h] [rbp+20h] BYREF

  v2 = 0i64;
  v20 = 0;
  v16 = 0i64;
  v19 = -1;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_4AB20(*(_QWORD *)&off_5A148->AlignmentRequirement, 10i64, (__int64)&unk_57BC0, a2);
  }
  sub_4BC10(a1, &v21);
  v5 = v21;
  v6 = (_BYTE *)(a1 + 14);
  if ( v21 == 2048 || v21 == 0x86DD )
  {
    sub_4BCD4(v6, &v20);
    v5 = v21;
    if ( v21 == 2048 && v20 != 4 || v21 == 0x86DD && v20 != 6 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_184C0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xDu, (__int64)&unk_57BC0, v21);
      }
      return 0i64;
    }
LABEL_20:
    switch ( a2 )
    {
      case 1:
        if ( v5 != 2048 )
        {
          v7 = off_5A148;
          if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
            || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
            || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
          {
            return 0i64;
          }
          v8 = 15;
          goto LABEL_119;
        }
        v9 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          v10 = 14;
LABEL_26:
          sub_11088(*(_QWORD *)&v9->AlignmentRequirement, v10, (__int64)&unk_57BC0);
          return v6;
        }
        return v6;
      case 2:
        if ( v5 != 0x86DD )
        {
          v7 = off_5A148;
          if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
            || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
            || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
          {
            return 0i64;
          }
          v8 = 17;
          goto LABEL_119;
        }
        v9 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          v10 = 16;
          goto LABEL_26;
        }
        return v6;
      case 7:
        if ( v5 != 2054 )
        {
          v7 = off_5A148;
          if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
            || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
            || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
          {
            return 0i64;
          }
          v8 = 19;
          goto LABEL_119;
        }
        v9 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          v10 = 18;
          goto LABEL_26;
        }
        return v6;
    }
    if ( v5 == 2048 )
    {
      if ( sub_4EB08((__int64)v6) )
      {
        v7 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
          || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
          || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 3u )
        {
          return 0i64;
        }
        v8 = 20;
        goto LABEL_119;
      }
      v14 = 4 * (*v6 & 0xF);
      v13 = v6[9];
      v19 = v13;
      v2 = (__int64)&v6[v14];
    }
    else
    {
      if ( v5 == 34525 )
      {
        v17 = 0i64;
        memset(Dst, 0, sizeof(Dst));
        if ( !(unsigned int)sub_4F1E4((__int64)v6, 0x2Cu, &v17) )
        {
          v7 = off_5A148;
          if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
            || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
            || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 3u )
          {
            return 0i64;
          }
          v8 = 21;
          goto LABEL_119;
        }
        v12 = sub_4C35C((__int64)v6, &v19, &v16);
        if ( v12 )
        {
          v7 = off_5A148;
          if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
            || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
            || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
          {
            v2 = v16;
            v13 = v19;
LABEL_74:
            if ( v13 != 6 && v13 != 17 && v13 != 1 && v13 != 58 )
            {
              if ( v7 == (PDEVICE_OBJECT)&off_5A148
                || (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
                || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
              {
                return 0i64;
              }
              v8 = 23;
              goto LABEL_119;
            }
            switch ( a2 )
            {
              case 3:
                if ( v13 != 6 )
                {
                  if ( v7 == (PDEVICE_OBJECT)&off_5A148
                    || (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
                    || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
                  {
                    return 0i64;
                  }
                  v8 = 25;
                  goto LABEL_119;
                }
                if ( v7 != (PDEVICE_OBJECT)&off_5A148
                  && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
                  && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
                {
                  v15 = 24;
LABEL_88:
                  sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v15, (__int64)&unk_57BC0);
                  return (_BYTE *)v2;
                }
                break;
              case 4:
                if ( v13 != 17 )
                {
                  if ( v7 == (PDEVICE_OBJECT)&off_5A148
                    || (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
                    || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
                  {
                    return 0i64;
                  }
                  v8 = 27;
                  goto LABEL_119;
                }
                if ( v7 != (PDEVICE_OBJECT)&off_5A148
                  && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
                  && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
                {
                  v15 = 26;
                  goto LABEL_88;
                }
                break;
              case 6:
                if ( v13 != 1 && v13 != 58 )
                {
                  if ( v7 == (PDEVICE_OBJECT)&off_5A148
                    || (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
                    || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
                  {
                    return 0i64;
                  }
                  v8 = 29;
                  goto LABEL_119;
                }
                if ( v7 != (PDEVICE_OBJECT)&off_5A148
                  && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
                  && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
                {
                  v15 = 28;
                  goto LABEL_88;
                }
                break;
              default:
                if ( v7 == (PDEVICE_OBJECT)&off_5A148
                  || (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
                  || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
                {
                  return 0i64;
                }
                v8 = 31;
                goto LABEL_119;
            }
            return (_BYTE *)v2;
          }
          sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x16u, (__int64)&unk_57BC0, v12);
        }
        v2 = v16;
      }
      v13 = v19;
    }
    v7 = off_5A148;
    goto LABEL_74;
  }
  if ( v21 == 2054 )
    goto LABEL_20;
  v7 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
    || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
    || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
  {
    return 0i64;
  }
  v8 = 12;
LABEL_119:
  sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_57BC0);
  return 0i64;
}

//----- (000000000004B3A0) ----------------------------------------------------
__int64 __fastcall sub_4B3A0(__int64 a1, unsigned int a2, __int64 *a3)
{
  __int64 result; // rax
  PDEVICE_OBJECT v7; // rcx
  unsigned __int16 v8; // dx
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  int v11; // eax
  __int64 v12; // rdx
  unsigned __int8 v13; // al
  _BYTE *v14; // rcx
  __int64 v15; // rdx
  __int64 v16; // rax
  unsigned __int16 v17[2]; // [rsp+30h] [rbp-68h] BYREF
  int v18; // [rsp+34h] [rbp-64h] BYREF
  __int64 v19; // [rsp+38h] [rbp-60h] BYREF
  unsigned __int64 v20; // [rsp+40h] [rbp-58h] BYREF
  char Dst[40]; // [rsp+48h] [rbp-50h] BYREF
  char v22; // [rsp+A8h] [rbp+10h] BYREF
  unsigned __int8 v23; // [rsp+B8h] [rbp+20h] BYREF

  v23 = -1;
  v19 = 0i64;
  v17[0] = 0;
  v18 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_4AD64(*(_QWORD *)&off_5A148->AlignmentRequirement, 32i64, (__int64)&unk_57BC0, a3, a2, a1);
  }
  result = (__int64)memset(a3, 0, 0x60ui64);
  if ( a2 < 0xE )
  {
    v7 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v8 = 33;
      return sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_57BC0);
    }
    return result;
  }
  *a3 = a1;
  result = sub_4BC10(a1, v17);
  if ( v17[0] == 2048 )
  {
    if ( a2 < 0x17 )
    {
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v8 = 34;
        return sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_57BC0);
      }
      return result;
    }
    result = sub_4BCD4((_BYTE *)(a1 + 14), &v22);
    if ( v22 != 4 )
    {
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v8 = 35;
        return sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_57BC0);
      }
      return result;
    }
    a3[2] = a1 + 14;
    if ( sub_4EB08(a1 + 14) )
    {
      *((_WORD *)a3 + 44) |= 1u;
      v9 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v10 = 36;
        goto LABEL_59;
      }
      goto LABEL_85;
    }
    v14 = (_BYTE *)a3[2];
    v15 = 4 * (*v14 & 0xF);
    v13 = v14[9];
    v23 = v13;
    v12 = (__int64)&v14[v15];
    goto LABEL_61;
  }
  if ( v17[0] == 2054 )
  {
    a3[1] = (__int64)sub_4AE28(a1, 7);
    goto LABEL_85;
  }
  if ( v17[0] != 34525 )
  {
    v9 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v10 = 42;
LABEL_59:
      sub_11088(*(_QWORD *)&v9->AlignmentRequirement, v10, (__int64)&unk_57BC0);
      goto LABEL_85;
    }
    goto LABEL_85;
  }
  if ( a2 >= 0x14 )
  {
    result = sub_4BCD4((_BYTE *)(a1 + 14), &v22);
    if ( v22 != 6 )
    {
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v8 = 38;
        return sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_57BC0);
      }
      return result;
    }
    result = sub_4C298(a1 + 14, &v18);
    if ( a2 < v18 + 14 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        result = sub_184C0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x27u, (__int64)&unk_57BC0, a2);
      }
      return result;
    }
    v20 = 0i64;
    a3[3] = a1 + 14;
    memset(Dst, 0, sizeof(Dst));
    if ( !(unsigned int)sub_4F1E4(a1 + 14, 0x2Cu, &v20) )
    {
      *((_WORD *)a3 + 44) |= 1u;
      v9 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v10 = 40;
        goto LABEL_59;
      }
      goto LABEL_85;
    }
    v11 = sub_4C35C(a3[3], &v23, &v19);
    if ( v11 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x29u, (__int64)&unk_57BC0, v11);
      }
      goto LABEL_85;
    }
    v12 = v19;
    v13 = v23;
LABEL_61:
    if ( a2 >= (int)v12 - (int)a1 )
    {
      if ( v13 == 1 )
      {
        a3[7] = v12;
        goto LABEL_85;
      }
      if ( v13 == 6 )
      {
        a3[4] = v12;
        result = (unsigned int)v12 + ((*(unsigned __int8 *)(v12 + 12) >> 2) & 0x3C) - (_DWORD)a1;
        if ( a2 < (unsigned int)result )
        {
          v7 = off_5A148;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            v8 = 45;
            return sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_57BC0);
          }
          return result;
        }
        v16 = v12 + (((unsigned __int64)*(unsigned __int8 *)(v12 + 12) >> 2) & 0x3C);
      }
      else
      {
        if ( v13 != 17 )
        {
          if ( v13 == 58 )
            a3[8] = v12;
          goto LABEL_85;
        }
        result = (unsigned int)(v12 - a1 + 8);
        a3[5] = v12;
        if ( a2 < (unsigned int)result )
        {
          v7 = off_5A148;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            v8 = 44;
            return sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_57BC0);
          }
          return result;
        }
        v16 = v12 + 8;
      }
      a3[6] = v16;
      goto LABEL_85;
    }
    v9 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v10 = 43;
      goto LABEL_59;
    }
LABEL_85:
    result = sub_4B914(a1, a2, (__int64)a3);
    v7 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v8 = 46;
      return sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_57BC0);
    }
    return result;
  }
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    v8 = 37;
    return sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v8, (__int64)&unk_57BC0);
  }
  return result;
}

//----- (000000000004B914) ----------------------------------------------------
__int64 __fastcall sub_4B914(__int64 a1, int a2, __int64 a3)
{
  _BYTE *v3; // rcx
  __int64 v5; // rcx
  int v6; // er11
  int v7; // eax
  int v8; // er11
  __int64 v9; // rcx
  __int64 v10; // rcx
  __int64 v11; // rcx
  PDEVICE_OBJECT v12; // rcx
  int v13; // edx
  unsigned int v14; // er9
  __int64 result; // rax
  unsigned __int16 v16; // [rsp+58h] [rbp+10h] BYREF
  int v17; // [rsp+60h] [rbp+18h] BYREF

  v3 = *(_BYTE **)(a3 + 16);
  *(_DWORD *)(a3 + 72) = a2;
  if ( v3 )
  {
    LOBYTE(v16) = 0;
    LOWORD(v17) = 0;
    sub_4BD84(v3, &v16);
    v5 = *(_QWORD *)(a3 + 16);
    LOBYTE(v16) = 4 * v16;
    sub_4BE34(v5, &v17);
    v6 = (unsigned __int16)v17;
    v7 = (unsigned __int8)v16;
    *(_DWORD *)(a3 + 76) = (unsigned __int16)v17;
    v8 = v6 - v7;
  }
  else
  {
    v9 = *(_QWORD *)(a3 + 24);
    if ( !v9 )
      goto LABEL_6;
    v17 = 0;
    v16 = 0;
    sub_4C7F4(v9, &v16);
    v10 = *(_QWORD *)(a3 + 24);
    *(_DWORD *)(a3 + 76) = v16 + 40;
    sub_4F544(v10, &v17);
    v8 = v16 - v17;
  }
  *(_DWORD *)(a3 + 80) = v8;
LABEL_6:
  v11 = *(_QWORD *)(a3 + 32);
  if ( v11 )
  {
    LOBYTE(v16) = 0;
    sub_4D33C(v11, &v16);
    *(_DWORD *)(a3 + 84) = *(_DWORD *)(a3 + 80) - (unsigned __int8)(4 * v16);
  }
  else if ( *(_QWORD *)(a3 + 40) )
  {
    *(_DWORD *)(a3 + 84) = *(_DWORD *)(a3 + 80) - 8;
  }
  v12 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_18658(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x2Fu, (__int64)&unk_57BC0, *(_DWORD *)(a3 + 72));
    v12 = off_5A148;
  }
  v13 = *(_DWORD *)(a3 + 76);
  v14 = *(_DWORD *)(a3 + 72);
  result = (unsigned int)(v13 + 14);
  if ( v14 > (unsigned int)result
    && v12 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v12->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v12->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    result = sub_13EA4(*(_QWORD *)&v12->AlignmentRequirement, 0x30u, (__int64)&unk_57BC0, v14 - v13 - 14);
  }
  return result;
}

//----- (000000000004BAA4) ----------------------------------------------------
__int64 __fastcall sub_4BAA4(__int64 a1, __int64 a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x31u, (__int64)&unk_57BC0, a1, a2);
  }
  *(_DWORD *)a2 = *(_DWORD *)(a1 + 6);
  *(_WORD *)(a2 + 4) = *(_WORD *)(a1 + 10);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x32u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004BB5C) ----------------------------------------------------
__int64 __fastcall sub_4BB5C(__int64 a1, __int64 a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x33u, (__int64)&unk_57BC0, a1, a2);
  }
  *(_DWORD *)a2 = *(_DWORD *)a1;
  *(_WORD *)(a2 + 4) = *(_WORD *)(a1 + 4);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x34u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004BC10) ----------------------------------------------------
__int64 __fastcall sub_4BC10(__int64 a1, _WORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x35u, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 12)) | ((unsigned __int8)*(_WORD *)(a1 + 12) << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x36u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004BCD4) ----------------------------------------------------
__int64 __fastcall sub_4BCD4(_BYTE *a1, _BYTE *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x37u, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = *a1 >> 4;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x38u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004BD84) ----------------------------------------------------
__int64 __fastcall sub_4BD84(_BYTE *a1, _BYTE *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x39u, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = *a1 & 0xF;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Au, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004BE34) ----------------------------------------------------
__int64 __fastcall sub_4BE34(__int64 a1, _WORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Du, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 2)) | ((unsigned __int8)*(_WORD *)(a1 + 2) << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Eu, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004BEF8) ----------------------------------------------------
__int64 __fastcall sub_4BEF8(__int64 a1, _WORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x3Fu, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 4)) | ((unsigned __int8)*(_WORD *)(a1 + 4) << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x40u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004BFBC) ----------------------------------------------------
__int64 __fastcall sub_4BFBC(__int64 a1, _BYTE *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x41u, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = *(_BYTE *)(a1 + 6) >> 5;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x42u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004C06C) ----------------------------------------------------
__int64 __fastcall sub_4C06C(__int64 a1, _WORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x43u, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = _byteswap_ushort(*(_WORD *)(a1 + 6)) & 0x1FFF;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x44u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004C138) ----------------------------------------------------
__int64 __fastcall sub_4C138(__int64 a1, _DWORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x4Bu, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = *(_DWORD *)(a1 + 12);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x4Cu, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004C1E8) ----------------------------------------------------
__int64 __fastcall sub_4C1E8(__int64 a1, _DWORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x4Du, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = *(_DWORD *)(a1 + 16);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x4Eu, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004C298) ----------------------------------------------------
__int64 __fastcall sub_4C298(__int64 a1, _DWORD *a2)
{
  unsigned __int16 v5; // [rsp+38h] [rbp+10h] BYREF

  v5 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x51u, (__int64)&unk_57BC0, a1);
  }
  sub_4C7F4(a1, &v5);
  *a2 = v5 + 40;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x52u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004C35C) ----------------------------------------------------
__int64 __fastcall sub_4C35C(__int64 a1, unsigned __int8 *a2, _QWORD *a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned int v7; // ebx
  unsigned __int8 v8; // si
  unsigned __int8 v9; // di
  unsigned __int64 v11; // [rsp+30h] [rbp-48h] BYREF
  _BYTE v12[40]; // [rsp+38h] [rbp-40h] BYREF
  char v13; // [rsp+80h] [rbp+8h]
  char v14; // [rsp+81h] [rbp+9h]
  char v15; // [rsp+82h] [rbp+Ah]

  v11 = 0i64;
  memset(v12, 0, sizeof(v12));
  v13 = 6;
  v14 = 17;
  v15 = 58;
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x53u, (__int64)&unk_57BC0);
    v6 = off_5A148;
  }
  if ( a1 && a2 )
  {
    *a2 = 0;
    if ( a3 )
      *a3 = 0i64;
    if ( sub_4C620(a1) )
    {
      v6 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x55u, (__int64)&unk_57BC0);
        v6 = off_5A148;
      }
      v7 = 18;
    }
    else
    {
      v6 = off_5A148;
      v8 = 0;
      while ( 1 )
      {
        v9 = *(&v13 + v8);
        if ( v6 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_13EA4(*(_QWORD *)&v6->AlignmentRequirement, 0x56u, (__int64)&unk_57BC0, v9);
        }
        v7 = sub_4F1E4(a1, v9, &v11);
        if ( !v7 )
          break;
        v6 = off_5A148;
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
        {
          sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x58u, (__int64)&unk_57BC0, v7);
          v6 = off_5A148;
        }
        if ( ++v8 >= 3u )
          goto LABEL_38;
      }
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x57u, (__int64)&unk_57BC0, v9);
      }
      *a2 = v9;
      v6 = off_5A148;
      if ( a3 )
        *a3 = v11;
    }
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_39144(*(_QWORD *)&v6->AlignmentRequirement, 0x54u, (__int64)&unk_57BC0, a1, a2, 0i64);
      v6 = off_5A148;
    }
    v7 = 4;
  }
LABEL_38:
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x59u, (__int64)&unk_57BC0);
  }
  return v7;
}

//----- (000000000004C620) ----------------------------------------------------
char __fastcall sub_4C620(__int64 a1)
{
  char v1; // bl
  PDEVICE_OBJECT v3; // rcx
  unsigned __int64 v5; // [rsp+20h] [rbp-38h] BYREF
  _BYTE v6[40]; // [rsp+28h] [rbp-30h] BYREF
  unsigned __int16 v7; // [rsp+60h] [rbp+8h] BYREF

  v1 = 0;
  v5 = 0i64;
  memset(v6, 0, sizeof(v6));
  v7 = 0;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x5Au, (__int64)&unk_57BC0);
    v3 = off_5A148;
  }
  if ( a1 )
  {
    sub_4C7F4(a1, &v7);
    if ( !(unsigned int)sub_4F1E4(a1, 0, &v5) )
    {
      v3 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x5Cu, (__int64)&unk_57BC0);
        v3 = off_5A148;
      }
      if ( !v7 )
      {
        if ( v3 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 3u )
        {
          sub_11088(*(_QWORD *)&v3->AlignmentRequirement, 0x5Du, (__int64)&unk_57BC0);
          v3 = off_5A148;
        }
        v1 = 1;
      }
      goto LABEL_26;
    }
    v3 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v1;
    if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
      goto LABEL_26;
    }
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x5Eu, (__int64)&unk_57BC0);
    goto LABEL_25;
  }
  if ( v3 == (PDEVICE_OBJECT)&off_5A148 )
    return v1;
  if ( (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0 && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_12D64(*(_QWORD *)&v3->AlignmentRequirement, 0x5Bu, (__int64)&unk_57BC0, 0i64, v5);
LABEL_25:
    v3 = off_5A148;
  }
LABEL_26:
  if ( v3 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v3->AlignmentRequirement, 0x5Fu, (__int64)&unk_57BC0);
  }
  return v1;
}

//----- (000000000004C7F4) ----------------------------------------------------
__int64 __fastcall sub_4C7F4(__int64 a1, unsigned __int16 *a2)
{
  unsigned __int16 v4; // dx

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x68u, (__int64)&unk_57BC0, a1, a2);
  }
  v4 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 4)) | ((unsigned __int8)*(_WORD *)(a1 + 4) << 8);
  *a2 = v4;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x69u, (__int64)&unk_57BC0, v4);
  }
  return 0i64;
}

//----- (000000000004C8BC) ----------------------------------------------------
__int64 __fastcall sub_4C8BC(__int64 a1, unsigned __int8 *a2)
{
  unsigned __int8 v4; // al

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Au, (__int64)&unk_57BC0, a1, a2);
  }
  v4 = *(_BYTE *)(a1 + 6);
  *a2 = v4;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Bu, (__int64)&unk_57BC0, v4);
  }
  return 0i64;
}

//----- (000000000004C970) ----------------------------------------------------
__int64 __fastcall sub_4C970(__int64 a1, __m128i *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Eu, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = _mm_loadu_si128((const __m128i *)(a1 + 8));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x6Fu, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004CA24) ----------------------------------------------------
__int64 __fastcall sub_4CA24(__int64 a1, __m128i *a2)
{
  int v4; // eax
  PDEVICE_OBJECT v5; // rcx
  unsigned __int64 v7; // [rsp+30h] [rbp-38h] BYREF
  _BYTE v8[40]; // [rsp+38h] [rbp-30h] BYREF

  v7 = 0i64;
  memset(v8, 0, sizeof(v8));
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x70u, (__int64)&unk_57BC0, a1, a2);
  }
  if ( (unsigned int)sub_4F1E4(a1, 0x2Bu, &v7) )
    goto LABEL_11;
  v4 = sub_4CB80(&v7, a2);
  if ( v4 )
  {
    v5 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    {
LABEL_16:
      *a2 = _mm_loadu_si128((const __m128i *)(a1 + 24));
      goto LABEL_17;
    }
    if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
LABEL_12:
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v5->AlignmentRequirement, 0x72u, (__int64)&unk_57BC0);
      }
      goto LABEL_16;
    }
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x71u, (__int64)&unk_57BC0, v4);
LABEL_11:
    v5 = off_5A148;
    goto LABEL_12;
  }
LABEL_17:
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x73u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004CB80) ----------------------------------------------------
__int64 __fastcall sub_4CB80(_BYTE *a1, __m128i *a2)
{
  __m128i *v2; // r12
  const __m128i *v4; // r15
  unsigned __int8 v5; // di
  PDEVICE_OBJECT v6; // rcx
  bool v7; // bp
  const char *v8; // r8
  __int64 v9; // rcx
  const char *v10; // rax
  unsigned int v11; // ebx
  unsigned __int8 v12; // di
  __int64 v13; // rax
  unsigned __int16 v14; // r9
  unsigned __int16 v15; // ax
  unsigned __int16 v17; // [rsp+F0h] [rbp+8h]
  __m128i *v18; // [rsp+F8h] [rbp+10h]
  const __m128i *v19; // [rsp+108h] [rbp+20h]

  v18 = a2;
  v2 = a2;
  v4 = 0i64;
  v19 = 0i64;
  v5 = -1;
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x74u, (__int64)&unk_57BC0);
    v6 = off_5A148;
  }
  v7 = 0;
  if ( *(_QWORD *)a1 )
  {
    v5 = *(_BYTE *)(*(_QWORD *)a1 + 2i64);
    if ( !v5 || v5 > 1u && v5 <= 3u )
      v7 = 1;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    if ( v5 )
    {
      switch ( v5 )
      {
        case 1u:
          v8 = "NIMROD";
          break;
        case 2u:
          v8 = "MOBILITY";
          break;
        case 3u:
          v8 = "RPL";
          break;
        case 4u:
          v8 = "SEGMENT";
          break;
        case 0xFDu:
          v8 = "EXP_1";
          break;
        case 0xFEu:
          v8 = "EXP_2";
          break;
        default:
          v8 = "UNKNOWN";
          break;
      }
    }
    else
    {
      v8 = "SOURCE_ROUTE";
    }
    v9 = *(_QWORD *)&v6->AlignmentRequirement;
    v10 = "NOT";
    if ( v7 )
      v10 = (const char *)&unk_57DAA;
    sub_4AA58(v9, 336i64, (__int64)&unk_57BC0, v5, v8, v10);
    v6 = off_5A148;
  }
  if ( v7 )
  {
    if ( *(_QWORD *)a1 && *(_BYTE *)(*(_QWORD *)a1 + 3i64) )
    {
      v12 = (unsigned __int8)(a1[24] - 8) >> 4;
      if ( v6 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x76u, (__int64)&unk_57BC0);
        v6 = off_5A148;
      }
      v13 = *(_QWORD *)a1;
      if ( *(_QWORD *)a1 )
      {
        v4 = (const __m128i *)(v13 + 8);
        v19 = (const __m128i *)(v13 + 8);
      }
      v14 = 0;
      v17 = 0;
      if ( v12 )
      {
        do
        {
          if ( v6 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            v4 = v19;
            sub_4A914(*(_QWORD *)&off_5A148->AlignmentRequirement, 119i64, (__int64)&unk_57BC0, v17);
            v6 = off_5A148;
            v14 = v17;
            v2 = v18;
          }
          ++v14;
          v15 = v12;
          v17 = v14;
          if ( v14 == v12 )
          {
            if ( v6 != (PDEVICE_OBJECT)&off_5A148
              && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
              && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
            {
              sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x78u, (__int64)&unk_57BC0);
              v14 = v17;
              v15 = v12;
            }
            *v2 = _mm_loadu_si128(v4);
          }
          else
          {
            v19 = ++v4;
          }
          v6 = off_5A148;
        }
        while ( v14 < v15 );
      }
      v11 = 0;
      *v2 = _mm_loadu_si128(v4);
    }
    else
    {
      if ( v6 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x75u, (__int64)&unk_57BC0);
      }
      v11 = 6;
    }
  }
  else
  {
    v11 = 18;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x79u, (__int64)&unk_57BC0);
  }
  return v11;
}

//----- (000000000004CFEC) ----------------------------------------------------
__int64 __fastcall sub_4CFEC(_WORD *a1, _WORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x7Au, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*a1) | ((unsigned __int8)*a1 << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x7Bu, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004D0B0) ----------------------------------------------------
__int64 __fastcall sub_4D0B0(__int64 a1, _WORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x7Cu, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 2)) | ((unsigned __int8)*(_WORD *)(a1 + 2) << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x7Du, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004D174) ----------------------------------------------------
__int64 __fastcall sub_4D174(__int64 a1, _DWORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x7Eu, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = ((unsigned __int8)HIBYTE(*(_DWORD *)(a1 + 4)) | (unsigned __int16)((unsigned __int8)BYTE2(*(_DWORD *)(a1 + 4)) << 8))
      + (((unsigned __int8)BYTE1(*(_DWORD *)(a1 + 4)) | (unsigned __int16)((unsigned __int8)*(_DWORD *)(a1 + 4) << 8)) << 16);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x7Fu, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004D258) ----------------------------------------------------
__int64 __fastcall sub_4D258(__int64 a1, _DWORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x80u, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = ((unsigned __int8)HIBYTE(*(_DWORD *)(a1 + 8)) | (unsigned __int16)((unsigned __int8)BYTE2(*(_DWORD *)(a1 + 8)) << 8))
      + (((unsigned __int8)BYTE1(*(_DWORD *)(a1 + 8)) | (unsigned __int16)((unsigned __int8)*(_DWORD *)(a1 + 8) << 8)) << 16);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x81u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004D33C) ----------------------------------------------------
__int64 __fastcall sub_4D33C(__int64 a1, _BYTE *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x82u, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = *(_BYTE *)(a1 + 12) >> 4;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x83u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004D3EC) ----------------------------------------------------
__int64 __fastcall sub_4D3EC(__int64 a1, _BYTE *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x84u, (__int64)&unk_57BC0);
  }
  sub_4D33C(a1, a2);
  *a2 = 4 * *a2 - 20;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x85u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004D4A8) ----------------------------------------------------
__int64 __fastcall sub_4D4A8(__int64 a1, _BYTE *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x86u, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = *(_BYTE *)(a1 + 13);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x87u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004D558) ----------------------------------------------------
__int64 __fastcall sub_4D558(__int64 a1, _WORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x88u, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 14)) | ((unsigned __int8)*(_WORD *)(a1 + 14) << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x89u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004D61C) ----------------------------------------------------
__int64 __fastcall sub_4D61C(__int64 a1, _WORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x8Au, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 16)) | ((unsigned __int8)*(_WORD *)(a1 + 16) << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x8Bu, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004D6E0) ----------------------------------------------------
__int64 __fastcall sub_4D6E0(__int64 a1, __int64 a2, _WORD *a3)
{
  PDEVICE_OBJECT v5; // rcx
  int v6; // eax
  unsigned int v7; // ebx
  __int64 v9[5]; // [rsp+30h] [rbp-28h] BYREF

  v9[0] = 0i64;
  v9[1] = 0i64;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x8Eu, (__int64)&unk_57BC0);
    v5 = off_5A148;
  }
  if ( !a2 || !a3 )
  {
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EE0(*(_QWORD *)&v5->AlignmentRequirement, 0x8Fu, (__int64)&unk_57BC0, a2, a3);
      v5 = off_5A148;
    }
    v7 = 4;
    goto LABEL_25;
  }
  v6 = sub_4DBC8(a2, 2u, (__int64)v9, 0i64);
  v7 = v6;
  if ( !v6 )
  {
    if ( *(_BYTE *)(v9[0] + 1) != 4 )
    {
      v5 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_184C0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x92u, (__int64)&unk_57BC0, 2);
        v5 = off_5A148;
      }
      v7 = 6;
      goto LABEL_25;
    }
    sub_53BD8(a3, 2ui64, (const void *)(v9[0] + 2), 2ui64);
    *a3 = _byteswap_ushort(*a3);
    goto LABEL_12;
  }
  v5 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v7;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x91u, (__int64)&unk_57BC0, v6);
LABEL_12:
    v5 = off_5A148;
  }
LABEL_25:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v5->AlignmentRequirement, 0x94u, (__int64)&unk_57BC0, v7);
  }
  return v7;
}

//----- (000000000004D8E4) ----------------------------------------------------
__int64 __fastcall sub_4D8E4(unsigned __int8 a1, __int64 a2)
{
  PDEVICE_OBJECT v4; // rcx
  unsigned int v5; // ebx
  unsigned int v6; // eax
  unsigned __int16 v7; // dx
  int v8; // er9
  __int64 v10; // [rsp+20h] [rbp-38h] BYREF
  __int64 v11; // [rsp+28h] [rbp-30h]
  __int64 v12; // [rsp+30h] [rbp-28h] BYREF
  __int64 v13; // [rsp+38h] [rbp-20h]
  unsigned __int16 v14; // [rsp+68h] [rbp+10h] BYREF

  v13 = 0i64;
  v11 = 0i64;
  v12 = 0i64;
  v10 = 0i64;
  v14 = 0;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x95u, (__int64)&unk_57BC0);
    v4 = off_5A148;
  }
  if ( !a2 )
  {
    if ( v4 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_12D64(*(_QWORD *)&v4->AlignmentRequirement, 0x96u, (__int64)&unk_57BC0, 0i64, v10, v11, v12, v13);
      v4 = off_5A148;
    }
    v5 = 4;
    goto LABEL_46;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&v4->AlignmentRequirement, 0x98u, (__int64)&unk_57BC0, a1);
  }
  v6 = sub_4DBC8(*(_QWORD *)(a2 + 32), a1, (__int64)&v12, (__int64)&v10);
  v5 = v6;
  if ( !v6 )
  {
    v6 = sub_4DEEC(*(_QWORD *)(a2 + 32), &v12, &v10);
    v5 = v6;
    if ( v6 )
    {
      v4 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return v5;
      if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
        || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_46;
      }
      v7 = 160;
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xA1u, (__int64)&unk_57BC0);
      }
      v6 = sub_50870(a2, 1, &v14);
      v5 = v6;
      if ( !v6 )
      {
        v4 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
          return v5;
        if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
          || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 4u )
        {
          goto LABEL_46;
        }
        v8 = v14;
        v7 = 163;
        goto LABEL_45;
      }
      v4 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return v5;
      if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
        || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
      {
        goto LABEL_46;
      }
      v7 = 162;
    }
LABEL_26:
    v8 = v6;
LABEL_45:
    sub_13EA4(*(_QWORD *)&v4->AlignmentRequirement, v7, (__int64)&unk_57BC0, v8);
    v4 = off_5A148;
    goto LABEL_46;
  }
  if ( v6 == 5 )
  {
    v4 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x9Eu, (__int64)&unk_57BC0, a1);
      v4 = off_5A148;
    }
    v5 = 0;
    goto LABEL_46;
  }
  v4 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v5;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    v7 = 159;
    goto LABEL_26;
  }
LABEL_46:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v4->AlignmentRequirement, 0xA4u, (__int64)&unk_57BC0, v5);
  }
  return v5;
}

//----- (000000000004DBC8) ----------------------------------------------------
__int64 __fastcall sub_4DBC8(__int64 a1, unsigned __int8 a2, __int64 a3, __int64 a4)
{
  unsigned int v4; // ebx
  PDEVICE_OBJECT v9; // rcx
  _BYTE *v10; // rdi
  unsigned __int8 v11; // dl
  unsigned __int16 v12; // cx
  char v13; // al
  unsigned __int16 v14; // dx
  unsigned __int8 v16; // [rsp+50h] [rbp+8h] BYREF

  v4 = 0;
  v16 = 0;
  v9 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xA5u, (__int64)&unk_57BC0);
    v9 = off_5A148;
  }
  if ( a1 && a3 )
  {
    if ( sub_512A0(a1) )
    {
      sub_4D3EC(a1, &v16);
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xA9u, (__int64)&unk_57BC0, v16);
      }
      v10 = (_BYTE *)(a1 + 20);
      *(_BYTE *)(a3 + 8) = 0;
      *(_QWORD *)a3 = 0i64;
      if ( a4 )
      {
        *(_BYTE *)(a4 + 8) = 0;
        *(_QWORD *)a4 = 0i64;
      }
      v11 = v16;
      if ( *(_BYTE *)(a3 + 8) >= v16 )
      {
LABEL_32:
        v9 = off_5A148;
      }
      else
      {
        while ( 1 )
        {
          if ( *v10 == a2 )
          {
            if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
              && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
              && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
            {
              sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xAAu, (__int64)&unk_57BC0, a2);
            }
            *(_QWORD *)a3 = v10;
            v9 = off_5A148;
            goto LABEL_56;
          }
          if ( *v10 == 1 )
          {
            v12 = 1;
          }
          else if ( *v10 )
          {
            if ( a4 )
            {
              v13 = *(_BYTE *)(a3 + 8);
              *(_QWORD *)a4 = v10;
              *(_BYTE *)(a4 + 8) = v13;
            }
            v12 = (unsigned __int8)v10[1];
          }
          else
          {
            v12 = 1;
          }
          if ( !*v10 )
            break;
          if ( !v12 )
          {
            v9 = off_5A148;
            if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
              goto LABEL_13;
            if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
              && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
            {
              v14 = 172;
LABEL_41:
              sub_11088(*(_QWORD *)&v9->AlignmentRequirement, v14, (__int64)&unk_57BC0);
              goto LABEL_32;
            }
            goto LABEL_33;
          }
          *(_BYTE *)(a3 + 8) += v12;
          v10 += v12;
          if ( *(_BYTE *)(a3 + 8) >= v11 )
            goto LABEL_32;
        }
        v9 = off_5A148;
        if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
          goto LABEL_13;
        if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          v14 = 171;
          goto LABEL_41;
        }
      }
LABEL_33:
      if ( v9 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(v9->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
        || BYTE1(v9->DeviceQueue.DeviceListHead.Flink) < 3u )
      {
        goto LABEL_13;
      }
      sub_13EA4(*(_QWORD *)&v9->AlignmentRequirement, 0xADu, (__int64)&unk_57BC0, a2);
    }
    else
    {
      v9 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
        || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 5u )
      {
        goto LABEL_13;
      }
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xA8u, (__int64)&unk_57BC0);
    }
    v9 = off_5A148;
LABEL_13:
    v4 = 5;
    goto LABEL_56;
  }
  if ( v9 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v9->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&v9->AlignmentRequirement, 0xA6u, (__int64)&unk_57BC0, a1, a3);
    v9 = off_5A148;
  }
  v4 = 4;
LABEL_56:
  if ( v9 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v9->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v9->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v9->AlignmentRequirement, 0xAEu, (__int64)&unk_57BC0, v4);
  }
  return v4;
}

//----- (000000000004DEEC) ----------------------------------------------------
__int64 __fastcall sub_4DEEC(__int64 a1, _BYTE *a2, _BYTE *a3)
{
  unsigned int v3; // ebx
  PDEVICE_OBJECT v7; // rcx
  __int64 v8; // rdi
  char v9; // cl
  unsigned __int8 v10; // r9
  char v11; // dl
  unsigned __int8 v12; // r8
  int v13; // esi
  unsigned __int8 v14; // dl
  int v15; // er11
  __int64 v16; // r10
  __int64 v17; // rdx
  __int64 v18; // rax
  unsigned __int8 v19; // r8
  unsigned __int8 v21; // [rsp+50h] [rbp+8h] BYREF

  v3 = 0;
  v21 = 0;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xAFu, (__int64)&unk_57BC0);
    v7 = off_5A148;
  }
  if ( a1 && a2 )
  {
    sub_4D3EC(a1, &v21);
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xB1u, (__int64)&unk_57BC0, v21);
    }
    v8 = a1 + 20;
    if ( *(_QWORD *)a3 )
      v9 = a2[8] - *(_BYTE *)(*(_QWORD *)a3 + 1i64) - a3[8];
    else
      v9 = 0;
    v10 = v21;
    v11 = *(_BYTE *)(*(_QWORD *)a2 + 1i64);
    v12 = a2[8] - v9;
    v13 = v21;
    v14 = v9 + v11;
    v15 = v14;
    if ( v14 + v12 < v21 )
    {
      v16 = v14;
      do
      {
        v17 = v12++;
        *(_BYTE *)(v17 + v8) = *(_BYTE *)(v17 + v16 + v8);
      }
      while ( v15 + v12 < v13 );
    }
    v18 = v12;
    v19 = v12 + 1;
    *(_BYTE *)(v18 + v8) = 0;
    if ( v19 < v10 )
      memset((void *)(v8 + v19), 0, (unsigned __int8)(v10 - v19));
    v7 = off_5A148;
  }
  else
  {
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EE0(*(_QWORD *)&v7->AlignmentRequirement, 0xB0u, (__int64)&unk_57BC0, a1, a2);
      v7 = off_5A148;
    }
    v3 = 4;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v7->AlignmentRequirement, 0xB2u, (__int64)&unk_57BC0, v3);
  }
  return v3;
}

//----- (000000000004E0CC) ----------------------------------------------------
__int64 __fastcall sub_4E0CC(_WORD *a1, _WORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xB3u, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*a1) | ((unsigned __int8)*a1 << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xB4u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004E190) ----------------------------------------------------
__int64 __fastcall sub_4E190(__int64 a1, _WORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xB5u, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 2)) | ((unsigned __int8)*(_WORD *)(a1 + 2) << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xB6u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004E254) ----------------------------------------------------
__int64 __fastcall sub_4E254(__int64 a1, _WORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xB9u, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 6)) | ((unsigned __int8)*(_WORD *)(a1 + 6) << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xBAu, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004E318) ----------------------------------------------------
__int64 __fastcall sub_4E318(__int64 a1, _WORD *a2)
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EE0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xC3u, (__int64)&unk_57BC0, a1, a2);
  }
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 6)) | ((unsigned __int8)*(_WORD *)(a1 + 6) << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xC4u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004E3DC) ----------------------------------------------------
__int64 __fastcall sub_4E3DC(__int64 a1, unsigned __int8 *a2)
{
  int v5; // [rsp+20h] [rbp-38h]
  int v6; // [rsp+28h] [rbp-30h]
  int v7; // [rsp+30h] [rbp-28h]
  int v8; // [rsp+38h] [rbp-20h]
  int v9; // [rsp+40h] [rbp-18h]
  int v10; // [rsp+48h] [rbp-10h]

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v10 = a2[5];
    v9 = a2[4];
    v8 = a2[3];
    v7 = a2[2];
    v6 = a2[1];
    v5 = *a2;
    sub_4AC4C(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xF3u, (__int64)&unk_57BC0, a1, v5, v6, v7, v8, v9, v10);
  }
  *(_DWORD *)(a1 + 6) = *(_DWORD *)a2;
  *(_WORD *)(a1 + 10) = *((_WORD *)a2 + 2);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xF4u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004E4D0) ----------------------------------------------------
__int64 __fastcall sub_4E4D0(__int64 a1, unsigned __int8 *a2)
{
  int v5; // [rsp+20h] [rbp-38h]
  int v6; // [rsp+28h] [rbp-30h]
  int v7; // [rsp+30h] [rbp-28h]
  int v8; // [rsp+38h] [rbp-20h]
  int v9; // [rsp+40h] [rbp-18h]
  int v10; // [rsp+48h] [rbp-10h]

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v10 = a2[5];
    v9 = a2[4];
    v8 = a2[3];
    v7 = a2[2];
    v6 = a2[1];
    v5 = *a2;
    sub_4AC4C(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xF5u, (__int64)&unk_57BC0, a1, v5, v6, v7, v8, v9, v10);
  }
  *(_DWORD *)a1 = *(_DWORD *)a2;
  *(_WORD *)(a1 + 4) = *((_WORD *)a2 + 2);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xF6u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004E5C0) ----------------------------------------------------
__int64 __fastcall sub_4E5C0(__int64 a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x102u, (__int64)&unk_57BC0, a1, v5);
  }
  *(_WORD *)(a1 + 2) = v6 | (v2 << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x103u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004E684) ----------------------------------------------------
__int64 __fastcall sub_4E684(__int64 a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x104u, (__int64)&unk_57BC0, a1, v5);
  }
  *(_WORD *)(a1 + 4) = v6 | (v2 << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x105u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004E748) ----------------------------------------------------
__int64 __fastcall sub_4E748(__int64 a1, unsigned __int8 a2)
{
  int v5; // [rsp+20h] [rbp-18h]

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x106u, (__int64)&unk_57BC0, a1, v5);
  }
  *(_BYTE *)(a1 + 6) &= 0x1Fu;
  *(_BYTE *)(a1 + 6) |= 32 * a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x107u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004E800) ----------------------------------------------------
__int64 __fastcall sub_4E800(__int64 a1)
{
  int v3; // [rsp+20h] [rbp-18h]

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v3 = 128;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x10Au, (__int64)&unk_57BC0, a1, v3);
  }
  *(_BYTE *)(a1 + 8) = 0x80;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x10Bu, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004E8A4) ----------------------------------------------------
__int64 __fastcall sub_4E8A4(__int64 a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x10Eu, (__int64)&unk_57BC0, a1, v5);
  }
  *(_WORD *)(a1 + 10) = v6 | (v2 << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x10Fu, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004E968) ----------------------------------------------------
__int64 __fastcall sub_4E968(__int64 a1, unsigned int a2)
{
  int v4; // [rsp+20h] [rbp-28h]
  int v5; // [rsp+28h] [rbp-20h]
  int v6; // [rsp+30h] [rbp-18h]
  unsigned int v7; // [rsp+38h] [rbp-10h]
  unsigned int v8; // [rsp+58h] [rbp+10h]

  v8 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v7 = HIBYTE(a2);
    v6 = BYTE2(a2);
    v5 = BYTE1(a2);
    v4 = (unsigned __int8)a2;
    sub_4ACE4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x110u, (__int64)&unk_57BC0, a1, v4, v5, v6, v7);
    a2 = v8;
  }
  *(_DWORD *)(a1 + 12) = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x111u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004EA38) ----------------------------------------------------
__int64 __fastcall sub_4EA38(__int64 a1, unsigned int a2)
{
  int v4; // [rsp+20h] [rbp-28h]
  int v5; // [rsp+28h] [rbp-20h]
  int v6; // [rsp+30h] [rbp-18h]
  unsigned int v7; // [rsp+38h] [rbp-10h]
  unsigned int v8; // [rsp+58h] [rbp+10h]

  v8 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v7 = HIBYTE(a2);
    v6 = BYTE2(a2);
    v5 = BYTE1(a2);
    v4 = (unsigned __int8)a2;
    sub_4ACE4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x112u, (__int64)&unk_57BC0, a1, v4, v5, v6, v7);
    a2 = v8;
  }
  *(_DWORD *)(a1 + 16) = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x113u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004EB08) ----------------------------------------------------
char __fastcall sub_4EB08(__int64 a1)
{
  PDEVICE_OBJECT v2; // rcx
  unsigned __int16 v3; // dx
  char v5; // [rsp+38h] [rbp+10h] BYREF
  __int16 v6; // [rsp+40h] [rbp+18h] BYREF

  v5 = 0;
  v6 = 0;
  sub_4BFBC(a1, &v5);
  if ( (v5 & 1) != 0 )
  {
    v2 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
      return 1;
    }
    v3 = 276;
LABEL_6:
    sub_11088(*(_QWORD *)&v2->AlignmentRequirement, v3, (__int64)&unk_57BC0);
    return 1;
  }
  sub_4C06C(a1, &v6);
  if ( v6 )
  {
    v2 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
      return 1;
    }
    v3 = 277;
    goto LABEL_6;
  }
  return 0;
}

//----- (000000000004EBC8) ----------------------------------------------------
__int64 __fastcall sub_4EBC8(__int64 a1, int a2, __int64 a3)
{
  PDEVICE_OBJECT v6; // rcx
  int v7; // eax
  unsigned int v8; // edi
  __int64 v9; // rax
  int v11; // [rsp+28h] [rbp-10h]

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x116u, (__int64)&unk_57BC0);
    v6 = off_5A148;
  }
  if ( a1 && a3 && a2 )
  {
    *(_QWORD *)a3 = a1 + 40;
    sub_4C8BC(a1, (unsigned __int8 *)(a3 + 8));
    v7 = sub_4EF74(a1, a2, a3);
    v8 = v7;
    if ( v7 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x118u, (__int64)&unk_57BC0, v7);
      }
      v8 = 0;
    }
    v9 = *(_QWORD *)a3;
    *(_QWORD *)(a3 + 32) = a1;
    *(_BYTE *)(a3 + 40) = -1;
    *(_QWORD *)(a3 + 16) = v9 + 2;
    sub_4F85C(a3);
    v6 = off_5A148;
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      v11 = a2;
      sub_4ADC8(*(_QWORD *)&v6->AlignmentRequirement, 0x117u, (__int64)&unk_57BC0, a1, a3, v11);
      v6 = off_5A148;
    }
    v8 = 4;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x119u, (__int64)&unk_57BC0);
  }
  return v8;
}

//----- (000000000004ED5C) ----------------------------------------------------
__int64 __fastcall sub_4ED5C(__int64 a1, unsigned int a2, unsigned __int16 *a3)
{
  __int64 v3; // rbx
  PDEVICE_OBJECT v6; // r10
  unsigned int v7; // ebx
  char v8; // al
  int v9; // eax
  int v11; // [rsp+28h] [rbp-40h]
  __int64 Src; // [rsp+30h] [rbp-38h] BYREF
  __int64 v13[5]; // [rsp+38h] [rbp-30h] BYREF

  Src = 0i64;
  v3 = a2;
  memset(v13, 0, sizeof(v13));
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x11Au, (__int64)&unk_57BC0);
    v6 = off_5A148;
  }
  if ( a1 && a3 && (_DWORD)v3 )
  {
    if ( *(_QWORD *)a3 + (unsigned __int64)a3[12] < v3 + a1 - 1 )
    {
      v8 = **(_BYTE **)a3;
      Src = *(_QWORD *)a3 + a3[12];
      LOBYTE(v13[0]) = v8;
      v9 = sub_4EF74(a1, v3, (__int64)&Src);
      v7 = v9;
      if ( v9 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
        {
          sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x11Du, (__int64)&unk_57BC0, v9);
        }
        v7 = 0;
      }
      v13[1] = Src + 2;
      v13[3] = *(_QWORD *)a3;
      LOBYTE(v13[4]) = *((_BYTE *)a3 + 8);
      memmove(a3, &Src, 0x30ui64);
      sub_4F85C((__int64)a3);
      v6 = off_5A148;
    }
    else
    {
      if ( v6 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x11Cu, (__int64)&unk_57BC0);
        v6 = off_5A148;
      }
      v7 = 10;
    }
  }
  else
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      v11 = v3;
      sub_4ADC8(*(_QWORD *)&v6->AlignmentRequirement, 0x11Bu, (__int64)&unk_57BC0, a1, a3, v11, Src);
      v6 = off_5A148;
    }
    v7 = 4;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x11Eu, (__int64)&unk_57BC0);
  }
  return v7;
}

//----- (000000000004EF74) ----------------------------------------------------
__int64 __fastcall sub_4EF74(__int64 a1, int a2, __int64 a3)
{
  unsigned int v5; // esi
  PDEVICE_OBJECT v7; // rcx
  __int16 v8; // cx

  v5 = 0;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x11Fu, (__int64)&unk_57BC0);
    v7 = off_5A148;
  }
  if ( !a1 || !a3 || !a2 )
  {
    if ( v7 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_4ADC8(*(_QWORD *)&v7->AlignmentRequirement, 0x120u, (__int64)&unk_57BC0, a1, a3, a2);
      v7 = off_5A148;
    }
    v5 = 4;
    goto LABEL_39;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(*(_QWORD *)&v7->AlignmentRequirement, 0x121u, (__int64)&unk_57BC0, *(unsigned __int8 *)(a3 + 8));
    v7 = off_5A148;
  }
  switch ( *(_BYTE *)(a3 + 8) )
  {
    case 0:
      goto LABEL_28;
    case 6:
    case 0x11:
LABEL_27:
      *(_WORD *)(a3 + 24) = a1 + a2 - *(_WORD *)a3;
      goto LABEL_30;
    case 0x2B:
LABEL_28:
      v8 = 8 * (*(unsigned __int8 *)(*(_QWORD *)a3 + 1i64) + 1);
      goto LABEL_29;
  }
  if ( *(_BYTE *)(a3 + 8) != 44 )
  {
    if ( *(_BYTE *)(a3 + 8) == 51 )
    {
      v8 = 4 * *(unsigned __int8 *)(*(_QWORD *)a3 + 1i64) + 2;
LABEL_29:
      *(_WORD *)(a3 + 24) = v8;
      goto LABEL_30;
    }
    if ( *(_BYTE *)(a3 + 8) != 58 )
    {
      if ( *(_BYTE *)(a3 + 8) != 60 )
      {
        if ( v7 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_13EA4(*(_QWORD *)&v7->AlignmentRequirement, 0x122u, (__int64)&unk_57BC0, *(unsigned __int8 *)(a3 + 8));
        }
        v5 = 5;
        *(_WORD *)(a3 + 24) = 0;
        goto LABEL_30;
      }
      goto LABEL_28;
    }
    goto LABEL_27;
  }
  *(_WORD *)(a3 + 24) = 8;
LABEL_30:
  *(_WORD *)(a3 + 26) = *(_WORD *)a3 - a1;
  v7 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v5;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_184C0(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x123u, (__int64)&unk_57BC0, *(unsigned __int16 *)(a3 + 24));
    v7 = off_5A148;
  }
LABEL_39:
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0x124u, (__int64)&unk_57BC0);
  }
  return v5;
}

//----- (000000000004F1E4) ----------------------------------------------------
__int64 __fastcall sub_4F1E4(__int64 a1, unsigned __int8 a2, unsigned __int64 *a3)
{
  unsigned int v3; // ebx
  PDEVICE_OBJECT v7; // r10
  const char *v8; // rax
  __int64 v9; // r10
  int v10; // eax
  unsigned __int16 v11; // dx
  unsigned __int8 v12; // cl
  unsigned __int64 v13; // rsi
  unsigned __int16 v14; // dx
  __int64 Src; // [rsp+30h] [rbp-48h] BYREF
  char v17[40]; // [rsp+38h] [rbp-40h] BYREF
  unsigned int v18; // [rsp+80h] [rbp+8h] BYREF

  v3 = 0;
  Src = 0i64;
  memset(v17, 0, sizeof(v17));
  v18 = 0;
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x125u, (__int64)&unk_57BC0);
    v7 = off_5A148;
  }
  if ( !a1 || !a3 )
  {
    if ( v7 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(v7->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_57;
    }
    sub_13EE0(*(_QWORD *)&v7->AlignmentRequirement, 0x126u, (__int64)&unk_57BC0, a1, a3);
    goto LABEL_56;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    v8 = sub_51DCC(a2);
    sub_4AB78(*(_QWORD *)(v9 + 152), 0x127u, (__int64)&unk_57BC0, a2, v8);
  }
  sub_4C298(a1, &v18);
  v10 = sub_4EBC8(a1, v18, (__int64)&Src);
  if ( v10 )
  {
    v7 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      goto LABEL_57;
    }
    v11 = 296;
LABEL_16:
    sub_13EA4(*(_QWORD *)&v7->AlignmentRequirement, v11, (__int64)&unk_57BC0, v10);
    goto LABEL_56;
  }
  v12 = v17[0];
  if ( v17[0] == 59 )
  {
LABEL_56:
    v7 = off_5A148;
    goto LABEL_57;
  }
  v13 = v18 + a1 - 1;
  while ( 1 )
  {
    if ( *a3 >= v13 )
    {
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v14 = 297;
        goto LABEL_38;
      }
      goto LABEL_57;
    }
    if ( a2 == v12 )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x12Au, (__int64)&unk_57BC0);
      }
      memmove(a3, &Src, 0x30ui64);
      v7 = off_5A148;
      goto LABEL_58;
    }
    if ( (v12 > 0x3Cu || v12 != 60 && v12 && (v12 <= 0x2Au || v12 > 0x2Cu && (v12 == 50 || v12 != 51)))
      && v12 != 6
      && v12 != 17
      && v12 != 58 )
    {
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
      {
        v14 = 299;
LABEL_38:
        sub_11088(*(_QWORD *)&v7->AlignmentRequirement, v14, (__int64)&unk_57BC0);
        goto LABEL_56;
      }
      goto LABEL_57;
    }
    v10 = sub_4ED5C(a1, v18, (unsigned __int16 *)&Src);
    if ( v10 )
      break;
    v12 = v17[0];
    if ( v17[0] == 59 )
      goto LABEL_56;
  }
  v7 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    v11 = 300;
    goto LABEL_16;
  }
LABEL_57:
  v3 = 5;
LABEL_58:
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0x12Du, (__int64)&unk_57BC0);
  }
  return v3;
}
// 4F29D: variable 'v9' is possibly undefined

//----- (000000000004F544) ----------------------------------------------------
__int64 __fastcall sub_4F544(__int64 a1, int *a2)
{
  int v4; // er12
  PDEVICE_OBJECT v5; // rcx
  unsigned int v6; // eax
  unsigned int v7; // ebx
  unsigned __int16 v8; // dx
  int v9; // er9
  int v10; // eax
  unsigned __int64 v12; // [rsp+30h] [rbp-48h] BYREF
  __int16 v13[20]; // [rsp+38h] [rbp-40h] BYREF
  unsigned int v14; // [rsp+80h] [rbp+8h] BYREF

  v12 = 0i64;
  memset(v13, 0, sizeof(v13));
  v4 = 0;
  v14 = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x12Eu, (__int64)&unk_57BC0);
    v5 = off_5A148;
  }
  if ( a1 && a2 )
  {
    sub_4C298(a1, &v14);
    v6 = sub_4EBC8(a1, v14, (__int64)&v12);
    v7 = v6;
    if ( v6 )
    {
      v5 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return v7;
      if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
      {
        v8 = 304;
        v9 = v6;
LABEL_12:
        sub_13EA4(*(_QWORD *)&v5->AlignmentRequirement, v8, (__int64)&unk_57BC0, v9);
        v5 = off_5A148;
      }
    }
    else
    {
      while ( LOBYTE(v13[0]) != 59 && LOBYTE(v13[0]) != 6 && LOBYTE(v13[0]) != 17 && LOBYTE(v13[0]) != 58 )
      {
        if ( v12 >= (unsigned __int64)v14 + a1 - 1 )
        {
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
          {
            sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x131u, (__int64)&unk_57BC0);
          }
          v7 = 10;
          break;
        }
        if ( LOBYTE(v13[0]) > 0x3Cu
          || LOBYTE(v13[0]) != 60
          && LOBYTE(v13[0])
          && (LOBYTE(v13[0]) <= 0x2Au || LOBYTE(v13[0]) > 0x2Cu && (LOBYTE(v13[0]) == 50 || LOBYTE(v13[0]) != 51)) )
        {
          v5 = off_5A148;
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
          {
            sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x132u, (__int64)&unk_57BC0);
            v5 = off_5A148;
          }
          v7 = 18;
          goto LABEL_49;
        }
        v4 += (unsigned __int16)v13[8];
        v10 = sub_4ED5C(a1, v14, (unsigned __int16 *)&v12);
        v7 = v10;
        if ( v10 )
        {
          if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
          {
            sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x133u, (__int64)&unk_57BC0, v10);
          }
          break;
        }
      }
      *a2 = v4;
      v5 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return v7;
      if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        v8 = 308;
        v9 = v4;
        goto LABEL_12;
      }
    }
  }
  else
  {
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EE0(*(_QWORD *)&v5->AlignmentRequirement, 0x12Fu, (__int64)&unk_57BC0, a1, a2);
      v5 = off_5A148;
    }
    v7 = 4;
  }
LABEL_49:
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v5->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v5->AlignmentRequirement, 0x135u, (__int64)&unk_57BC0);
  }
  return v7;
}

//----- (000000000004F85C) ----------------------------------------------------
__int64 __fastcall sub_4F85C(__int64 a1)
{
  unsigned int v1; // edi
  PDEVICE_OBJECT v3; // r10
  const char *v4; // rax
  __int64 v5; // r10
  int v6; // er9

  v1 = 0;
  if ( !a1 )
    return 4;
  v3 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x136u, (__int64)&unk_57BC0);
      v3 = off_5A148;
    }
    if ( v3 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_12D64(*(_QWORD *)&v3->AlignmentRequirement, 0x137u, (__int64)&unk_57BC0, *(_QWORD *)a1);
        v3 = off_5A148;
      }
      if ( v3 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          v4 = sub_51DCC(*(_BYTE *)(a1 + 8));
          sub_4AB78(*(_QWORD *)(v5 + 152), 0x138u, (__int64)&unk_57BC0, v6, v4);
          v3 = off_5A148;
        }
        if ( v3 != (PDEVICE_OBJECT)&off_5A148 )
        {
          if ( (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
            && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
          {
            sub_13EA4(*(_QWORD *)&v3->AlignmentRequirement, 0x139u, (__int64)&unk_57BC0, *(unsigned __int16 *)(a1 + 24));
            v3 = off_5A148;
          }
          if ( v3 != (PDEVICE_OBJECT)&off_5A148 )
          {
            if ( (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
              && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
            {
              sub_13EA4(
                *(_QWORD *)&v3->AlignmentRequirement,
                0x13Au,
                (__int64)&unk_57BC0,
                *(unsigned __int16 *)(a1 + 26));
              v3 = off_5A148;
            }
            if ( v3 != (PDEVICE_OBJECT)&off_5A148 )
            {
              if ( (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
                && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
              {
                sub_12D64(*(_QWORD *)&v3->AlignmentRequirement, 0x13Bu, (__int64)&unk_57BC0, *(_QWORD *)(a1 + 32));
                v3 = off_5A148;
              }
              if ( v3 != (PDEVICE_OBJECT)&off_5A148
                && (BYTE4(v3->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
                && BYTE1(v3->DeviceQueue.DeviceListHead.Flink) >= 5u )
              {
                sub_13EA4(
                  *(_QWORD *)&v3->AlignmentRequirement,
                  0x13Cu,
                  (__int64)&unk_57BC0,
                  *(unsigned __int8 *)(a1 + 40));
              }
            }
          }
        }
      }
    }
  }
  return v1;
}
// 4F931: variable 'v5' is possibly undefined
// 4F945: variable 'v6' is possibly undefined

//----- (000000000004FA5C) ----------------------------------------------------
__int64 __fastcall sub_4FA5C(_WORD *a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x151u, (__int64)&unk_57BC0, a1, v5);
  }
  *a1 = v6 | (v2 << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x152u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004FB20) ----------------------------------------------------
__int64 __fastcall sub_4FB20(__int64 a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x153u, (__int64)&unk_57BC0, a1, v5);
  }
  *(_WORD *)(a1 + 2) = v6 | (v2 << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x154u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004FBE4) ----------------------------------------------------
__int64 __fastcall sub_4FBE4(__int64 a1, int a2)
{
  int v2; // ebx
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = BYTE1(a2);
  v2 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x155u, (__int64)&unk_57BC0, a1, a2);
  }
  *(_DWORD *)(a1 + 4) = (HIBYTE(v2) | (unsigned __int16)(BYTE2(v2) << 8))
                      + ((v6 | (unsigned __int16)((unsigned __int8)v2 << 8)) << 16);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x156u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004FCC4) ----------------------------------------------------
__int64 __fastcall sub_4FCC4(__int64 a1, int a2)
{
  int v2; // ebx
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = BYTE1(a2);
  v2 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x157u, (__int64)&unk_57BC0, a1, a2);
  }
  *(_DWORD *)(a1 + 8) = (HIBYTE(v2) | (unsigned __int16)(BYTE2(v2) << 8))
                      + ((v6 | (unsigned __int16)((unsigned __int8)v2 << 8)) << 16);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x158u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004FDA4) ----------------------------------------------------
__int64 __fastcall sub_4FDA4(__int64 a1)
{
  int v3; // [rsp+20h] [rbp-18h]

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v3 = 5;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x159u, (__int64)&unk_57BC0, a1, v3);
  }
  *(_BYTE *)(a1 + 12) &= 0xFu;
  *(_BYTE *)(a1 + 12) |= 0x50u;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x15Au, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004FE4C) ----------------------------------------------------
__int64 __fastcall sub_4FE4C(__int64 a1, unsigned __int8 a2)
{
  int v5; // [rsp+20h] [rbp-18h]

  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x15Bu, (__int64)&unk_57BC0, a1, v5);
  }
  *(_BYTE *)(a1 + 13) = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x15Cu, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004FEF8) ----------------------------------------------------
__int64 __fastcall sub_4FEF8(__int64 a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x15Du, (__int64)&unk_57BC0, a1, v5);
  }
  *(_WORD *)(a1 + 14) = v6 | (v2 << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x15Eu, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (000000000004FFBC) ----------------------------------------------------
__int64 __fastcall sub_4FFBC(__int64 a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x15Fu, (__int64)&unk_57BC0, a1, v5);
  }
  *(_WORD *)(a1 + 16) = v6 | (v2 << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x160u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (0000000000050080) ----------------------------------------------------
__int64 __fastcall sub_50080(_WORD *a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x163u, (__int64)&unk_57BC0, a1, v5);
  }
  *a1 = v6 | (v2 << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x164u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (0000000000050144) ----------------------------------------------------
__int64 __fastcall sub_50144(__int64 a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x165u, (__int64)&unk_57BC0, a1, v5);
  }
  *(_WORD *)(a1 + 2) = v6 | (v2 << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x166u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (0000000000050208) ----------------------------------------------------
__int64 __fastcall sub_50208(__int64 a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x167u, (__int64)&unk_57BC0, a1, v5);
  }
  *(_WORD *)(a1 + 4) = v6 | (v2 << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x168u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (00000000000502CC) ----------------------------------------------------
__int64 __fastcall sub_502CC(__int64 a1, unsigned __int16 a2)
{
  unsigned __int8 v2; // bl
  int v5; // [rsp+20h] [rbp-18h]
  unsigned __int8 v6; // [rsp+49h] [rbp+11h]

  v6 = HIBYTE(a2);
  v2 = a2;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    v5 = a2;
    sub_4AC00(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x169u, (__int64)&unk_57BC0, a1, v5);
  }
  *(_WORD *)(a1 + 6) = v6 | (v2 << 8);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x16Au, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (0000000000050390) ----------------------------------------------------
__int16 __fastcall sub_50390(unsigned __int16 *a1)
{
  unsigned int v2; // ebx
  unsigned __int16 *v3; // rcx
  unsigned __int8 v4; // r11
  __int64 v5; // rdx
  int v6; // eax
  unsigned __int16 *v7; // rcx
  __int64 v8; // rdx
  int v9; // eax
  int v10; // ebx
  PDEVICE_OBJECT v11; // rcx
  char v13; // [rsp+38h] [rbp+10h] BYREF
  int v14; // [rsp+40h] [rbp+18h]

  v2 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_12D64(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x16Bu, (__int64)&unk_57BC0, a1);
  }
  sub_4BD84(a1, &v13);
  v3 = a1;
  v4 = 4 * v13;
  v5 = 5i64;
  v13 *= 4;
  do
  {
    v6 = *v3++;
    v2 += v6;
    --v5;
  }
  while ( v5 );
  if ( v4 > 0xCu )
  {
    v7 = a1 + 6;
    v8 = (unsigned __int8)(((unsigned __int8)(v4 - 13) >> 1) + 1);
    do
    {
      v9 = *v7++;
      v2 += v9;
      --v8;
    }
    while ( v8 );
  }
  while ( HIWORD(v2) )
    v2 = HIWORD(v2) + (unsigned __int16)v2;
  v10 = ~v2;
  v14 = v10;
  v11 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x16Cu, (__int64)&unk_57BC0, (unsigned __int16)v10);
      v11 = off_5A148;
    }
    if ( v11 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v11->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v11->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EA4(
        *(_QWORD *)&v11->AlignmentRequirement,
        0x16Du,
        (__int64)&unk_57BC0,
        BYTE1(v14) | (unsigned __int16)((unsigned __int8)v10 << 8));
    }
  }
  return BYTE1(v14) | ((unsigned __int8)v10 << 8);
}

//----- (0000000000050500) ----------------------------------------------------
__int64 __fastcall sub_50500(_BYTE *a1, bool *a2)
{
  PDEVICE_OBJECT v4; // rcx
  unsigned int v5; // ebx
  char v6; // r11
  __int64 v7; // rcx
  int v8; // eax
  int v9; // ebx
  PDEVICE_OBJECT v10; // r10
  bool v11; // al
  char v13; // [rsp+48h] [rbp+10h] BYREF
  int v14; // [rsp+50h] [rbp+18h]

  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x171u, (__int64)&unk_57BC0);
    v4 = off_5A148;
  }
  v5 = 0;
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x16Eu, (__int64)&unk_57BC0);
  }
  sub_4BD84(a1, &v13);
  v6 = 4 * v13;
  v13 = v6;
  if ( v6 )
  {
    v7 = (unsigned __int8)(((unsigned __int8)(v6 - 1) >> 1) + 1);
    do
    {
      v8 = *(unsigned __int16 *)a1;
      a1 += 2;
      v5 += v8;
      --v7;
    }
    while ( v7 );
  }
  while ( HIWORD(v5) )
    v5 = HIWORD(v5) + (unsigned __int16)v5;
  v9 = ~v5;
  v14 = v9;
  v10 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x16Fu, (__int64)&unk_57BC0, (unsigned __int16)v9);
      v10 = off_5A148;
    }
    if ( v10 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v10->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v10->AlignmentRequirement, 0x170u, (__int64)&unk_57BC0);
      v10 = off_5A148;
    }
  }
  v11 = (BYTE1(v14) | (unsigned __int16)((unsigned __int8)v9 << 8)) == 0;
  *a2 = v11;
  if ( !v11 )
  {
    if ( v10 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( (BYTE4(v10->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      sub_11088(*(_QWORD *)&v10->AlignmentRequirement, 0x172u, (__int64)&unk_57BC0);
      v10 = off_5A148;
    }
  }
  if ( v10 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v10->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v10->AlignmentRequirement, 0x173u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (00000000000506E8) ----------------------------------------------------
__int64 __fastcall sub_506E8(__int64 a1, bool *a2)
{
  int v4; // eax
  unsigned int v5; // ebx
  PDEVICE_OBJECT v6; // rcx
  unsigned __int16 v7; // dx
  unsigned __int16 v9; // [rsp+48h] [rbp+10h] BYREF

  v9 = 0;
  *a2 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x174u, (__int64)&unk_57BC0);
  }
  v4 = sub_50870(a1, 0, &v9);
  v5 = v4;
  if ( !v4 )
  {
    v7 = v9;
    *a2 = v9 == 0;
    v6 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x176u, (__int64)&unk_57BC0, v7);
      v6 = off_5A148;
    }
    if ( *a2 )
      goto LABEL_20;
    if ( v6 == (PDEVICE_OBJECT)&off_5A148 )
      return v5;
    if ( (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0 || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 5u )
      goto LABEL_20;
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x177u, (__int64)&unk_57BC0);
    goto LABEL_19;
  }
  v6 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v5;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x175u, (__int64)&unk_57BC0, v4);
LABEL_19:
    v6 = off_5A148;
  }
LABEL_20:
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x178u, (__int64)&unk_57BC0);
  }
  return v5;
}

//----- (0000000000050870) ----------------------------------------------------
__int64 __fastcall sub_50870(__int64 a1, char a2, unsigned __int16 *a3)
{
  PDEVICE_OBJECT v6; // rcx
  __int64 v8; // rdx
  unsigned __int16 v9; // dx
  __int64 v10; // r8
  __int64 v11; // rcx
  const char *v12; // rax
  const char *v13; // r9
  __int64 v14; // rcx
  unsigned __int8 v15; // bp
  unsigned __int16 *v16; // rdi
  __int16 v17; // si
  PDEVICE_OBJECT v18; // rcx
  unsigned __int16 v19; // dx
  __int64 v20; // rcx
  __int16 v21; // r8
  unsigned __int16 v22; // ax
  unsigned __int16 v23; // r11
  PDEVICE_OBJECT v24; // rcx
  __m128i v25; // [rsp+30h] [rbp-48h] BYREF
  __m128i v26; // [rsp+40h] [rbp-38h] BYREF
  unsigned __int16 v27; // [rsp+80h] [rbp+8h] BYREF

  v27 = 0;
  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x17Au, (__int64)&unk_57BC0);
    v6 = off_5A148;
  }
  if ( !a1 )
  {
    if ( v6 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_12D64(*(_QWORD *)&v6->AlignmentRequirement, 0x17Bu, (__int64)&unk_57BC0, 0i64);
    }
    return 4i64;
  }
  v8 = *(_QWORD *)(a1 + 16);
  if ( !v8 && !*(_QWORD *)(a1 + 24) )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 4i64;
    }
    v9 = 380;
LABEL_17:
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, v9, (__int64)&unk_57BC0);
    return 4i64;
  }
  v10 = *(_QWORD *)(a1 + 32);
  if ( !v10 && !*(_QWORD *)(a1 + 40) )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 2u )
    {
      return 4i64;
    }
    v9 = 381;
    goto LABEL_17;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    v11 = *(_QWORD *)&v6->AlignmentRequirement;
    v12 = "UDP";
    if ( v10 )
      v12 = "TCP";
    v13 = "v6";
    if ( v8 )
      v13 = "v4";
    sub_3B178(v11, 0x17Eu, (__int64)&unk_57BC0, v13, v12);
  }
  v14 = *(_QWORD *)(a1 + 16);
  if ( v14 )
  {
    sub_4C138(v14, &v26);
    sub_4C1E8(*(_QWORD *)(a1 + 16), &v25);
    v15 = 4;
  }
  else
  {
    sub_4C970(*(_QWORD *)(a1 + 24), &v26);
    sub_4CA24(*(_QWORD *)(a1 + 24), &v25);
    v15 = 16;
  }
  if ( *(_QWORD *)(a1 + 32) )
  {
    v16 = *(unsigned __int16 **)(a1 + 32);
    v17 = 6;
    sub_4D61C((__int64)v16, &v27);
    v18 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 4u )
    {
      goto LABEL_45;
    }
    v19 = 383;
  }
  else
  {
    v16 = *(unsigned __int16 **)(a1 + 40);
    v17 = 17;
    sub_4E254((__int64)v16, &v27);
    v18 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 4u )
    {
      goto LABEL_45;
    }
    v19 = 384;
  }
  sub_13EA4(*(_QWORD *)&v18->AlignmentRequirement, v19, (__int64)&unk_57BC0, v27);
LABEL_45:
  if ( a2 )
  {
    v20 = *(_QWORD *)(a1 + 32);
    if ( v20 )
      sub_4FFBC(v20, 0);
    else
      sub_502CC(*(_QWORD *)(a1 + 40), 0);
  }
  v21 = *(_WORD *)(a1 + 80);
  v27 = 0;
  v22 = sub_50CA0(v17, v16, v21, (unsigned __int16 *)&v26, (unsigned __int16 *)&v25, v15);
  v23 = v22;
  v27 = v22;
  v24 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x181u, (__int64)&unk_57BC0, v22);
    v23 = v27;
    v24 = off_5A148;
  }
  if ( a2 )
  {
    if ( v24 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v24->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(v24->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_11088(*(_QWORD *)&v24->AlignmentRequirement, 0x182u, (__int64)&unk_57BC0);
      v23 = v27;
      v24 = off_5A148;
    }
    if ( *(_QWORD *)(a1 + 32) )
    {
      sub_4FFBC(*(_QWORD *)(a1 + 32), v23);
    }
    else
    {
      if ( *(_QWORD *)(a1 + 24) && !v23 )
      {
        if ( v24 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(v24->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
          && BYTE1(v24->DeviceQueue.DeviceListHead.Flink) >= 5u )
        {
          sub_11088(*(_QWORD *)&v24->AlignmentRequirement, 0x183u, (__int64)&unk_57BC0);
        }
        v23 = -1;
        v27 = -1;
      }
      sub_502CC(*(_QWORD *)(a1 + 40), v23);
    }
    v24 = off_5A148;
    v23 = v27;
  }
  if ( a3 )
  {
    *a3 = v23;
    v24 = off_5A148;
  }
  if ( v24 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v24->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v24->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v24->AlignmentRequirement, 0x184u, (__int64)&unk_57BC0);
  }
  return 0i64;
}

//----- (0000000000050CA0) ----------------------------------------------------
unsigned __int16 __fastcall sub_50CA0(__int16 a1, unsigned __int16 *a2, __int16 a3, unsigned __int16 *a4, unsigned __int16 *a5, unsigned __int8 a6)
{
  unsigned __int16 *v7; // rsi
  int v9; // ebx
  __int16 v10; // r9
  char v11; // bp
  unsigned __int16 v12; // di
  __int64 v13; // r8
  int v14; // eax
  __int64 v15; // rdx
  int v16; // eax
  __int64 v18; // r8
  int v19; // eax
  unsigned int i; // ebx
  unsigned __int16 v21; // bx

  v7 = a2;
  v9 = 0;
  v10 = a3 & 1;
  v11 = a3 & 1;
  v12 = a3 - v10;
  if ( a3 != v10 )
  {
    v13 = (unsigned __int16)(((unsigned __int16)(v12 - 1) >> 1) + 1);
    do
    {
      v14 = *a2++;
      v9 += v14;
      --v13;
    }
    while ( v13 );
  }
  if ( v11 )
    v9 += *((unsigned __int8 *)v7 + v12);
  if ( a6 )
  {
    v15 = (unsigned __int16)(((unsigned __int16)(a6 - 1) >> 1) + 1);
    do
    {
      v16 = *a4++;
      v9 += v16;
      --v15;
    }
    while ( v15 );
    v18 = (unsigned __int16)(((unsigned __int16)(a6 - 1) >> 1) + 1);
    do
    {
      v19 = *a5++;
      v9 += v19;
      --v18;
    }
    while ( v18 );
  }
  for ( i = ((unsigned __int8)((unsigned __int16)(a3 + a1) >> 8) | (unsigned __int16)((unsigned __int8)(a3 + a1) << 8))
          + v9; HIWORD(i); i = HIWORD(i) + (unsigned __int16)i )
    ;
  v21 = ~(_WORD)i;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_13EA4(
      *(_QWORD *)&off_5A148->AlignmentRequirement,
      0x185u,
      (__int64)&unk_57BC0,
      HIBYTE(v21) | (unsigned __int16)((unsigned __int8)v21 << 8));
  }
  return _byteswap_ushort(v21);
}
// 50D54: conditional instruction was optimized away because of '%arg_28.1!=0'

//----- (0000000000050E34) ----------------------------------------------------
__int64 __fastcall sub_50E34(__int64 a1, _QWORD *a2, _WORD *a3)
{
  PDEVICE_OBJECT v6; // rcx
  unsigned int v7; // ebx
  _BYTE *v8; // rax
  _BYTE *v9; // rdi
  PDEVICE_OBJECT v10; // rcx
  int v11; // er9
  unsigned __int16 v12; // dx
  _BYTE *v13; // rax
  __int64 result; // rax
  bool v15; // zf
  PDEVICE_OBJECT v16; // rcx
  unsigned __int8 v17[4]; // [rsp+20h] [rbp-28h] BYREF
  unsigned __int16 v18; // [rsp+24h] [rbp-24h] BYREF
  __int16 v19[16]; // [rsp+28h] [rbp-20h] BYREF
  unsigned __int8 v20; // [rsp+68h] [rbp+20h] BYREF

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x186u, (__int64)&unk_57BC0);
    v6 = off_5A148;
  }
  v7 = 1;
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x189u, (__int64)&unk_57BC0);
  }
  v8 = sub_4AE28(a1, 1);
  v9 = v8;
  if ( v8 )
  {
    sub_4BE34((__int64)v8, v19);
    sub_4BD84(v9, &v20);
    v20 *= 4;
    v18 = v19[0] - v20;
    v10 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
      goto LABEL_20;
    }
    v11 = (unsigned __int16)(v19[0] - v20);
    v12 = 394;
LABEL_19:
    sub_13EA4(*(_QWORD *)&v10->AlignmentRequirement, v12, (__int64)&unk_57BC0, v11);
    v10 = off_5A148;
LABEL_20:
    v7 = 0;
    goto LABEL_25;
  }
  v13 = sub_4AE28(a1, 2);
  if ( v13 )
  {
    sub_4C7F4((__int64)v13, &v18);
    v10 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
      || (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 5u )
    {
      goto LABEL_20;
    }
    v11 = v18;
    v12 = 395;
    goto LABEL_19;
  }
  v10 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v7;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x18Cu, (__int64)&unk_57BC0);
    v10 = off_5A148;
  }
LABEL_25:
  if ( v10 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v10->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v10->AlignmentRequirement, 0x18Du, (__int64)&unk_57BC0);
  }
  if ( v7 )
    return v7;
  result = sub_510E8(a1, v17, a2);
  if ( !(_DWORD)result )
  {
    v15 = v18 == (unsigned __int16)v17[0];
    *a3 = v18 - v17[0];
    if ( v15 )
      *a2 = 0i64;
    v16 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
    {
      if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x187u, (__int64)&unk_57BC0, (unsigned __int16)*a3);
        v16 = off_5A148;
      }
      if ( v16 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v16->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(v16->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v16->AlignmentRequirement, 0x188u, (__int64)&unk_57BC0);
      }
    }
    result = 0i64;
  }
  return result;
}

//----- (00000000000510E8) ----------------------------------------------------
__int64 __fastcall sub_510E8(__int64 a1, unsigned __int8 *a2, _QWORD *a3)
{
  unsigned int v6; // ebx
  _BYTE *v7; // rax
  _BYTE *v8; // rsi
  unsigned __int8 v9; // r11
  PDEVICE_OBJECT v10; // rcx
  int v11; // er9
  unsigned __int16 v12; // dx

  v6 = 1;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x18Eu, (__int64)&unk_57BC0);
  }
  v7 = sub_4AE28(a1, 3);
  v8 = v7;
  if ( v7 )
  {
    sub_4D33C((__int64)v7, a2);
    v9 = 4 * *a2;
    *a2 = v9;
    v10 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v11 = v9;
      v12 = 399;
LABEL_15:
      sub_13EA4(*(_QWORD *)&v10->AlignmentRequirement, v12, (__int64)&unk_57BC0, v11);
      v10 = off_5A148;
      goto LABEL_16;
    }
    goto LABEL_16;
  }
  v8 = sub_4AE28(a1, 4);
  if ( v8 )
  {
    *a2 = 8;
    v10 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
    {
      v12 = 400;
      v11 = 8;
      goto LABEL_15;
    }
LABEL_16:
    v6 = 0;
    if ( a3 )
    {
      *a3 = &v8[*a2];
LABEL_22:
      v10 = off_5A148;
      goto LABEL_23;
    }
    goto LABEL_23;
  }
  v10 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v6;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 3u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x191u, (__int64)&unk_57BC0);
    goto LABEL_22;
  }
LABEL_23:
  if ( v10 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v10->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v10->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v10->AlignmentRequirement, 0x192u, (__int64)&unk_57BC0);
  }
  return v6;
}

//----- (00000000000512A0) ----------------------------------------------------
char __fastcall sub_512A0(__int64 a1)
{
  char v2; // bl
  unsigned __int8 v4; // [rsp+38h] [rbp+10h] BYREF

  v4 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x193u, (__int64)&unk_57BC0);
  }
  sub_4D33C(a1, &v4);
  v2 = 0;
  v4 *= 4;
  if ( v4 > 0x14u )
    v2 = 1;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x194u, (__int64)&unk_57BC0);
  }
  return v2;
}

//----- (0000000000051370) ----------------------------------------------------
__int64 __fastcall sub_51370(__int64 a1, _BYTE *a2)
{
  unsigned int v4; // esi
  _BYTE *v5; // rax
  int v6; // eax
  PDEVICE_OBJECT v7; // rcx
  char v9; // [rsp+48h] [rbp+10h] BYREF

  v4 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x195u, (__int64)&unk_57BC0);
  }
  *a2 = 0;
  v5 = sub_4AE28(a1, 3);
  if ( !v5 )
  {
    v7 = off_5A148;
    if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      return v4;
    if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) == 0
      || BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) < 4u )
    {
      goto LABEL_22;
    }
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x198u, (__int64)&unk_57BC0);
    goto LABEL_21;
  }
  v6 = sub_4D4A8((__int64)v5, &v9);
  v4 = v6;
  if ( !v6 )
  {
    if ( (v9 & 2) != 0 )
    {
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x196u, (__int64)&unk_57BC0);
        v7 = off_5A148;
      }
      *a2 = 1;
      goto LABEL_22;
    }
    goto LABEL_21;
  }
  v7 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v4;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x197u, (__int64)&unk_57BC0, v6);
LABEL_21:
    v7 = off_5A148;
  }
LABEL_22:
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v7->AlignmentRequirement, 0x199u, (__int64)&unk_57BC0);
  }
  return v4;
}

//----- (00000000000514FC) ----------------------------------------------------
char __fastcall sub_514FC(__int64 a1)
{
  char v2; // bl
  _BYTE *v3; // rax
  PDEVICE_OBJECT v4; // rcx
  char v6; // [rsp+38h] [rbp+10h] BYREF

  v2 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x19Au, (__int64)&unk_57BC0);
  }
  v3 = sub_4AE28(a1, 3);
  if ( v3 )
  {
    sub_4D4A8((__int64)v3, &v6);
    if ( (v6 & 2) != 0 && (v6 & 0x10) == 0 )
    {
      v4 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x19Bu, (__int64)&unk_57BC0);
        v4 = off_5A148;
      }
      v2 = 1;
      goto LABEL_18;
    }
    goto LABEL_17;
  }
  v4 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v2;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x19Cu, (__int64)&unk_57BC0);
LABEL_17:
    v4 = off_5A148;
  }
LABEL_18:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x19Du, (__int64)&unk_57BC0);
  }
  return v2;
}

//----- (0000000000051640) ----------------------------------------------------
char __fastcall sub_51640(__int64 a1)
{
  char v2; // bl
  _BYTE *v3; // rax
  PDEVICE_OBJECT v4; // rcx
  char v6; // [rsp+38h] [rbp+10h] BYREF

  v2 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x19Eu, (__int64)&unk_57BC0);
  }
  v3 = sub_4AE28(a1, 3);
  if ( v3 )
  {
    sub_4D4A8((__int64)v3, &v6);
    if ( (v6 & 0x10) != 0 && (v6 & 2) == 0 )
    {
      v4 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x19Fu, (__int64)&unk_57BC0);
        v4 = off_5A148;
      }
      v2 = 1;
      goto LABEL_18;
    }
    goto LABEL_17;
  }
  v4 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v2;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1A0u, (__int64)&unk_57BC0);
LABEL_17:
    v4 = off_5A148;
  }
LABEL_18:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x1A1u, (__int64)&unk_57BC0);
  }
  return v2;
}

//----- (0000000000051784) ----------------------------------------------------
char __fastcall sub_51784(__int64 a1)
{
  char v2; // bl
  _BYTE *v3; // rax
  PDEVICE_OBJECT v4; // rcx
  char v6; // [rsp+38h] [rbp+10h] BYREF

  v2 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1A2u, (__int64)&unk_57BC0);
  }
  v3 = sub_4AE28(a1, 3);
  if ( v3 )
  {
    sub_4D4A8((__int64)v3, &v6);
    if ( (v6 & 2) != 0 && (v6 & 0x10) != 0 )
    {
      v4 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1A3u, (__int64)&unk_57BC0);
        v4 = off_5A148;
      }
      v2 = 1;
      goto LABEL_18;
    }
    goto LABEL_17;
  }
  v4 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v2;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1A4u, (__int64)&unk_57BC0);
LABEL_17:
    v4 = off_5A148;
  }
LABEL_18:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x1A5u, (__int64)&unk_57BC0);
  }
  return v2;
}

//----- (00000000000518C8) ----------------------------------------------------
char __fastcall sub_518C8(__int64 a1)
{
  char v2; // bl
  _BYTE *v3; // rax
  PDEVICE_OBJECT v4; // rcx
  char v6; // [rsp+38h] [rbp+10h] BYREF

  v2 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1A6u, (__int64)&unk_57BC0);
  }
  v3 = sub_4AE28(a1, 3);
  if ( v3 )
  {
    sub_4D4A8((__int64)v3, &v6);
    if ( (v6 & 1) != 0 && (v6 & 0x10) != 0 )
    {
      v4 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1A7u, (__int64)&unk_57BC0);
        v4 = off_5A148;
      }
      v2 = 1;
      goto LABEL_18;
    }
    goto LABEL_17;
  }
  v4 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v2;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1A8u, (__int64)&unk_57BC0);
LABEL_17:
    v4 = off_5A148;
  }
LABEL_18:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x1A9u, (__int64)&unk_57BC0);
  }
  return v2;
}

//----- (0000000000051A0C) ----------------------------------------------------
char __fastcall sub_51A0C(__int64 a1)
{
  char v2; // bl
  _BYTE *v3; // rax
  PDEVICE_OBJECT v4; // rcx
  char v6; // [rsp+38h] [rbp+10h] BYREF

  v2 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1AAu, (__int64)&unk_57BC0);
  }
  v3 = sub_4AE28(a1, 3);
  if ( v3 )
  {
    sub_4D4A8((__int64)v3, &v6);
    if ( (v6 & 1) != 0 )
    {
      v4 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1ABu, (__int64)&unk_57BC0);
        v4 = off_5A148;
      }
      v2 = 1;
      goto LABEL_17;
    }
    goto LABEL_16;
  }
  v4 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v2;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1ACu, (__int64)&unk_57BC0);
LABEL_16:
    v4 = off_5A148;
  }
LABEL_17:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x1ADu, (__int64)&unk_57BC0);
  }
  return v2;
}

//----- (0000000000051B48) ----------------------------------------------------
char __fastcall sub_51B48(__int64 a1)
{
  char v2; // bl
  _BYTE *v3; // rax
  PDEVICE_OBJECT v4; // rcx
  char v6; // [rsp+38h] [rbp+10h] BYREF

  v2 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1AEu, (__int64)&unk_57BC0);
  }
  v3 = sub_4AE28(a1, 3);
  if ( v3 )
  {
    sub_4D4A8((__int64)v3, &v6);
    if ( (v6 & 4) != 0 )
    {
      v4 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
        && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
      {
        sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1AFu, (__int64)&unk_57BC0);
        v4 = off_5A148;
      }
      v2 = 1;
      goto LABEL_17;
    }
    goto LABEL_16;
  }
  v4 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v2;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1B0u, (__int64)&unk_57BC0);
LABEL_16:
    v4 = off_5A148;
  }
LABEL_17:
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v4->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&v4->AlignmentRequirement, 0x1B1u, (__int64)&unk_57BC0);
  }
  return v2;
}

//----- (0000000000051C84) ----------------------------------------------------
bool __fastcall sub_51C84(char a1, char *a2)
{
  bool v2; // bl
  char v3; // al
  char v4; // al
  char v5; // al
  bool v6; // zf
  PDEVICE_OBJECT v7; // rcx
  __int64 v8; // rcx
  const char *v9; // r9

  v2 = 0;
  if ( a1 == 4 )
  {
    v3 = *a2;
    if ( *a2 != 10
      && (v3 != -84 || (unsigned __int8)a2[1] < 0x10u || (unsigned __int8)a2[1] > 0x1Fu)
      && (v3 != -64 || a2[1] != -88) )
    {
      if ( v3 == -87 )
        v2 = a2[1] == -2;
      goto LABEL_32;
    }
    goto LABEL_8;
  }
  if ( a1 == 6 )
  {
    if ( *a2 != -4 && *a2 != -3 && (*a2 != -2 || a2[1] >= 0) )
    {
      if ( *a2 != -1 || (v4 = a2[1], (v4 & 0xC0) != 0) )
      {
        if ( *a2 != 1 )
          goto LABEL_32;
        v6 = a2[1] == 0;
LABEL_24:
        if ( !v6 )
          goto LABEL_32;
        goto LABEL_8;
      }
      v5 = v4 & 0xF;
      if ( v5 != 1 && v5 != 2 && v5 != 3 && v5 != 4 && v5 != 5 )
      {
        v6 = v5 == 8;
        goto LABEL_24;
      }
    }
LABEL_8:
    v2 = 1;
LABEL_32:
    v7 = off_5A148;
    goto LABEL_33;
  }
  v7 = off_5A148;
  if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
    return v2;
  if ( (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x1C3u, (__int64)&unk_57BC0);
    goto LABEL_32;
  }
LABEL_33:
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->DeviceQueue.DeviceListHead.Flink) & 0x20) != 0
    && BYTE1(v7->DeviceQueue.DeviceListHead.Flink) >= 4u )
  {
    v8 = *(_QWORD *)&v7->AlignmentRequirement;
    v9 = "PUBLIC";
    if ( v2 )
      v9 = "PRIVATE";
    sub_187E8(v8, 0x1C4u, (__int64)&unk_57BC0, v9);
  }
  return v2;
}

//----- (0000000000051DCC) ----------------------------------------------------
const char *__fastcall sub_51DCC(unsigned __int8 a1)
{
  if ( a1 <= 0x3Au )
  {
    switch ( a1 )
    {
      case 0x3Au:
        return "IPv6_ICMPV6_HEADER";
      case 0u:
        return "IPv6_HOP_BY_HOP_HEADER";
      case 4u:
        return "IPv6_IPV4_OVER_IPV6";
      case 6u:
        return "IPv6_TCP_HEADER";
      case 0x11u:
        return "IPv6_UDP_HEADER";
      case 0x2Bu:
        return "IPv6_ROUTING_HEADER";
      case 0x2Cu:
        return "IPv6_FRAGMENT_HEADER";
      case 0x32u:
        return "IPv6_IPSEC_ESP_HEADER";
      case 0x33u:
        return "IPv6_AH_HEADER";
    }
    return "UNKNOWN";
  }
  switch ( a1 )
  {
    case 0x3Bu:
      return "IPv6_NO_NEXT_HEADER";
    case 0x3Cu:
      return "IPv6_DESTINATION_OPTIONS_HEADER";
    case 0x87u:
      return "IPv6_MOBILITY_HEADER";
    case 0x8Bu:
      return "IPv6_HOST_IDENTITY_HEADER";
    case 0x8Cu:
      return "IPv6_SHIM6_HEADER";
    case 0xFDu:
      return "IPv6_EXPERIMENT_TESTING_1";
    case 0xFEu:
      return "IPv6_EXPERIMENT_TESTING_2";
  }
  if ( a1 != 255 )
    return "UNKNOWN";
  return "IPv6_HEADER";
}

//----- (0000000000051EBC) ----------------------------------------------------
__int64 __fastcall sub_51EBC(__int64 a1, const void *a2, size_t a3)
{
  PDEVICE_OBJECT v6; // rcx
  _DWORD *v7; // rdx
  int v8; // eax
  size_t v9; // rdx

  v6 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
    && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 5u )
  {
    sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x23u, (__int64)&unk_57BB0);
    v6 = off_5A148;
  }
  v7 = *(_DWORD **)(a1 + 132);
  if ( !v7 || (v8 = *(_DWORD *)(a1 + 140)) == 0 )
  {
    if ( v6 == (PDEVICE_OBJECT)&off_5A148 )
      return 0i64;
    if ( (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x40) == 0 || BYTE1(v6->DeviceQueue.DeviceListHead.Flink) < 4u )
    {
LABEL_19:
      if ( v6 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
        && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 5u )
      {
        sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x26u, (__int64)&unk_57BB0);
      }
      return 0i64;
    }
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x25u, (__int64)&unk_57BB0);
LABEL_18:
    v6 = off_5A148;
    goto LABEL_19;
  }
  v9 = (unsigned int)(v8 - *v7);
  if ( v9 > a3 )
  {
    sub_53BD8((void *)(**(unsigned int **)(a1 + 132) + *(_QWORD *)(a1 + 132) + 4i64), v9, a2, a3);
    **(_DWORD **)(a1 + 132) += a3;
    goto LABEL_18;
  }
  if ( v6 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v6->DeviceQueue.DeviceListHead.Flink) & 0x40) != 0
    && BYTE1(v6->DeviceQueue.DeviceListHead.Flink) >= 2u )
  {
    sub_11088(*(_QWORD *)&v6->AlignmentRequirement, 0x24u, (__int64)&unk_57BB0);
  }
  return 10i64;
}

//----- (000000000005201C) ----------------------------------------------------
__int64 __fastcall sub_5201C(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5)
{
  int v7; // [rsp+78h] [rbp+20h] BYREF

  v7 = a4;
  if ( a5 )
    strlen(a5);
  return qword_5A1B8(a1, 43i64, &unk_57BA0, 24i64, &v7);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000520A8) ----------------------------------------------------
__int64 __fastcall sub_520A8(__int64 a1, __int64 a2, __int64 a3, double a4)
{
  double v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57BA0, 12i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005211C) ----------------------------------------------------
__int64 __fastcall sub_5211C(__int64 a1, __int64 a2, __int64 a3, double a4)
{
  double v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_5A1B8(a1, 43i64, &unk_57BA0, 13i64, &v5);
}
// 5A1B8: using guessed type __int64 (__fastcall *qword_5A1B8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000052180) ----------------------------------------------------
char *__fastcall sub_52180(unsigned __int8 *a1, unsigned int a2)
{
  unsigned int v2; // ebx
  unsigned int v3; // edi
  unsigned int v5; // ebp
  char *v6; // rax
  char *v7; // rsi
  unsigned int i; // er12
  char v10; // [rsp+60h] [rbp+18h] BYREF
  __int16 v11; // [rsp+61h] [rbp+19h]
  char v12; // [rsp+63h] [rbp+1Bh]

  v2 = 0;
  v3 = 512;
  v10 = 0;
  v11 = 0;
  v12 = 0;
  if ( a2 <= 0x200 )
    v3 = a2;
  v5 = 4 * v3;
  v6 = (char *)sub_3C4EC(2, 4 * v3, 0x7368624Du);
  v7 = v6;
  if ( v6 )
  {
    memset(v6, 0, v5);
    for ( i = 0; i < v3; ++a1 )
    {
      if ( v2 > v5 )
        break;
      sub_53BB4(&v10, 4ui64, "%02X ", *a1);
      sub_53BD8(&v7[v2], 3ui64, &v10, 3ui64);
      ++i;
      v2 += 3;
    }
  }
  return v7;
}
// 521C0: conditional instruction was optimized away because of 'edx.4<201u'

//----- (000000000005226C) ----------------------------------------------------
__int64 __fastcall sub_5226C(double a1, int a2, double *a3)
{
  unsigned int v3; // esi
  double v6; // xmm6_8
  double v7; // xmm8_8

  v3 = 0;
  v6 = a1;
  v7 = *a3;
  if ( a2 )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0x15u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_520A8(*(_QWORD *)&off_5A148->AlignmentRequirement, 12i64, (__int64)&unk_57BA0, v7);
    }
    if ( a2 != 1 )
      v6 = (a1 - v7) / (double)a2 + v7;
    *a3 = v6;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0x15u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 4u )
    {
      sub_5211C(*(_QWORD *)&off_5A148->AlignmentRequirement, 13i64, (__int64)&unk_57BA0, v6);
    }
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0x15u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_13EA4(*(_QWORD *)&off_5A148->AlignmentRequirement, 0xBu, (__int64)&unk_57BA0, 0);
    }
    v3 = -2147483391;
  }
  return v3;
}

//----- (00000000000523D8) ----------------------------------------------------
__int64 __fastcall sub_523D8(__int64 a1, unsigned int a2)
{
  unsigned int v2; // edi
  size_t v3; // rbp
  char *v4; // rax
  char *v5; // rsi

  v2 = 0;
  v3 = a2;
  v4 = (char *)sub_3C4EC(2, a2 + 1, 0x6175624Eu);
  v5 = v4;
  if ( v4 )
  {
    sub_53BD8(v4, v3, 0i64, v3);
    v5[v3] = 0;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0x14u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_5201C(*(_QWORD *)&off_5A148->AlignmentRequirement, 24i64, (__int64)&unk_57BA0, v3, v5);
    }
    sub_3C570(v5, 0x6175624Eu);
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&off_5A148->DeviceQueue.DeviceListHead.Flink + 1, 0x14u)
      && BYTE1(off_5A148->DeviceQueue.DeviceListHead.Flink) >= 2u )
    {
      sub_11088(*(_QWORD *)&off_5A148->AlignmentRequirement, 0x17u, (__int64)&unk_57BA0);
    }
    v2 = 3;
  }
  return v2;
}

//----- (00000000000524E8) ----------------------------------------------------
__int64 sub_524E8()
{
  unsigned int v0; // ebx
  PDEVICE_OBJECT v1; // rcx
  int v2; // edi

  v0 = 0;
  v1 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 1) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xAu, (__int64)&unk_57B70);
      v1 = off_5A148;
    }
    if ( v1 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v1->Queue.Wcb.DeviceRoutine) & 1) != 0
      && BYTE1(v1->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_11088((__int64)v1->Queue.ListEntry.Blink, 0xAu, (__int64)&unk_57B60);
    }
  }
  v2 = 0;
  qword_5D4A8 = (PVOID)sub_3D4A8(1u);
  if ( !qword_5D4A8 )
    v2 = 3;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 1) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xBu, (__int64)&unk_57B60);
  }
  if ( v2 )
  {
    v0 = (unsigned __int16)v2 | 0xE0020000;
    sub_5261C();
  }
  else
  {
    sub_529D0();
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 1) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xBu, (__int64)&unk_57B70);
  }
  return v0;
}

//----- (000000000005261C) ----------------------------------------------------
void sub_5261C()
{
  PDEVICE_OBJECT v0; // rcx
  unsigned __int16 v1; // dx

  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 1) != 0 && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xCu, (__int64)&unk_57B70);
      v0 = off_5A148;
    }
    if ( v0 != (PDEVICE_OBJECT)&off_5A148
      && _bittest((const signed __int32 *)&v0->Timer + 1, 9u)
      && BYTE1(v0->Timer) >= 4u )
    {
      sub_11088((__int64)v0->AttachedDevice, 0x19u, (__int64)&unk_57B70);
      v0 = off_5A148;
    }
  }
  if ( !byte_5D44C )
  {
    if ( v0 == (PDEVICE_OBJECT)&off_5A148 )
      goto LABEL_26;
    if ( !_bittest((const signed __int32 *)&v0->Timer + 1, 9u) || BYTE1(v0->Timer) < 2u )
      goto LABEL_22;
    v1 = 26;
    goto LABEL_21;
  }
  if ( qword_5D434 && sub_46FB0(&stru_5D450) )
  {
    qword_5D434(10i64);
    sub_47018(&stru_5D450);
  }
  sub_46F50(&stru_5D450);
  memset(&dword_5D428, 0, 0x25ui64);
  byte_5D44C = 0;
  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( !_bittest((const signed __int32 *)&off_5A148->Timer + 1, 9u) || BYTE1(off_5A148->Timer) < 4u )
    {
LABEL_22:
      if ( v0 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v0->Queue.Wcb.DeviceRoutine) & 1) != 0
        && BYTE1(v0->Queue.Wcb.DeviceRoutine) >= 5u )
      {
        sub_11088((__int64)v0->Queue.ListEntry.Blink, 0xCu, (__int64)&unk_57B60);
        v0 = off_5A148;
      }
      goto LABEL_26;
    }
    v1 = 27;
LABEL_21:
    sub_11088((__int64)v0->AttachedDevice, v1, (__int64)&unk_57B70);
    v0 = off_5A148;
    goto LABEL_22;
  }
LABEL_26:
  if ( qword_5D4A8 )
  {
    sub_3D510(qword_5D4A8);
    v0 = off_5A148;
  }
  if ( v0 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v0->Queue.Wcb.DeviceRoutine) & 1) != 0
    && BYTE1(v0->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_11088((__int64)v0->Queue.ListEntry.Blink, 0xDu, (__int64)&unk_57B60);
    v0 = off_5A148;
  }
  dword_5D494 = 0;
  if ( qword_5D488 )
  {
    sub_3D094(qword_5D488);
    v0 = off_5A148;
  }
  if ( v0 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v0->Queue.Wcb.DeviceRoutine) & 1) != 0
    && BYTE1(v0->Queue.Wcb.DeviceRoutine) >= 4u )
  {
    sub_11088((__int64)v0->Queue.ListEntry.Blink, 0xDu, (__int64)&unk_57B70);
  }
}
// 5D428: using guessed type int dword_5D428;
// 5D434: using guessed type __int64 (__fastcall *qword_5D434)(_QWORD);
// 5D44C: using guessed type char byte_5D44C;
// 5D494: using guessed type int dword_5D494;

//----- (0000000000052828) ----------------------------------------------------
__int64 sub_52828()
{
  PDEVICE_OBJECT v0; // rcx
  unsigned __int16 v1; // dx

  v0 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->Timer + 1, 9u)
    && BYTE1(off_5A148->Timer) >= 5u )
  {
    sub_11088((__int64)off_5A148->AttachedDevice, 0x13u, (__int64)&unk_57B70);
    v0 = off_5A148;
  }
  if ( byte_5D44C )
  {
    if ( v0 == (PDEVICE_OBJECT)&off_5A148
      || !_bittest((const signed __int32 *)&v0->Timer + 1, 9u)
      || BYTE1(v0->Timer) < 2u )
    {
      return 0i64;
    }
    v1 = 20;
LABEL_33:
    sub_11088((__int64)v0->AttachedDevice, v1, (__int64)&unk_57B70);
    return 0i64;
  }
  if ( sub_46E8C((__int64)&stru_5D450) )
  {
    sub_46EF0(&stru_5D450);
    if ( sub_46FB0(&stru_5D450) )
    {
      if ( qword_5D43C && qword_5D444 )
        sub_47018(&stru_5D450);
    }
    else
    {
      v0 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
      {
LABEL_29:
        byte_5D44C = 1;
        if ( v0 == (PDEVICE_OBJECT)&off_5A148
          || !_bittest((const signed __int32 *)&v0->Timer + 1, 9u)
          || BYTE1(v0->Timer) < 5u )
        {
          return 0i64;
        }
        v1 = 24;
        goto LABEL_33;
      }
      if ( !_bittest((const signed __int32 *)&off_5A148->Timer + 1, 9u) || BYTE1(off_5A148->Timer) < 2u )
      {
LABEL_25:
        if ( v0 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v0->Timer + 1, 9u)
          && BYTE1(v0->Timer) >= 5u )
        {
          sub_13EE0((__int64)v0->AttachedDevice, 0x17u, (__int64)&unk_57B70, qword_5D43C, qword_5D444);
          v0 = off_5A148;
        }
        goto LABEL_29;
      }
      sub_11088((__int64)off_5A148->AttachedDevice, 0x16u, (__int64)&unk_57B70);
    }
    v0 = off_5A148;
    goto LABEL_25;
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->Timer + 1, 9u)
    && BYTE1(off_5A148->Timer) >= 2u )
  {
    sub_11088((__int64)off_5A148->AttachedDevice, 0x15u, (__int64)&unk_57B70);
  }
  return 3i64;
}
// 5D43C: using guessed type __int64 qword_5D43C;
// 5D444: using guessed type __int64 qword_5D444;
// 5D44C: using guessed type char byte_5D44C;

//----- (00000000000529D0) ----------------------------------------------------
__int64 sub_529D0()
{
  unsigned int v0; // ebx
  PDEVICE_OBJECT v1; // rcx
  int v3; // eax
  PDEVICE_OBJECT v4; // rcx
  int v5[2]; // [rsp+20h] [rbp-38h] BYREF
  int v6; // [rsp+28h] [rbp-30h]
  int v7; // [rsp+30h] [rbp-28h] BYREF
  char Dst[17]; // [rsp+34h] [rbp-24h] BYREF

  v0 = 0;
  v5[0] = 0;
  v7 = 0;
  v5[1] = 0;
  v6 = 0;
  memset(Dst, 0, sizeof(Dst));
  v1 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->Timer + 1, 9u)
    && BYTE1(off_5A148->Timer) >= 5u )
  {
    sub_11088((__int64)off_5A148->AttachedDevice, 0x1Cu, (__int64)&unk_57B70);
    v1 = off_5A148;
  }
  if ( byte_5D44C )
  {
    v7 = 10;
    *(_DWORD *)&Dst[1] = 2;
    Dst[0] = 0;
    v5[0] = 20;
    v6 = 21;
    if ( sub_46FB0(&stru_5D450) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && _bittest((const signed __int32 *)&off_5A148->Timer + 1, 9u)
        && BYTE1(off_5A148->Timer) >= 4u )
      {
        sub_11088((__int64)off_5A148->AttachedDevice, 0x1Eu, (__int64)&unk_57B70);
      }
      v3 = qword_5D42C(10i64, v5, &v7);
      v0 = v3;
      if ( v3 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&off_5A148->Timer + 1, 9u)
          && BYTE1(off_5A148->Timer) >= 2u )
        {
          sub_13EA4((__int64)off_5A148->AttachedDevice, 0x1Fu, (__int64)&unk_57B70, v3);
        }
      }
      else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
             && _bittest((const signed __int32 *)&off_5A148->Timer + 1, 9u)
             && BYTE1(off_5A148->Timer) >= 4u )
      {
        sub_11088((__int64)off_5A148->AttachedDevice, 0x20u, (__int64)&unk_57B70);
      }
      sub_47018(&stru_5D450);
    }
    else
    {
      v4 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148 )
        return v0;
      if ( !_bittest((const signed __int32 *)&off_5A148->Timer + 1, 9u) || BYTE1(off_5A148->Timer) < 2u )
      {
LABEL_31:
        if ( v4 != (PDEVICE_OBJECT)&off_5A148
          && _bittest((const signed __int32 *)&v4->Timer + 1, 9u)
          && BYTE1(v4->Timer) >= 5u )
        {
          sub_11088((__int64)v4->AttachedDevice, 0x22u, (__int64)&unk_57B70);
        }
        return v0;
      }
      sub_11088((__int64)off_5A148->AttachedDevice, 0x21u, (__int64)&unk_57B70);
    }
    v4 = off_5A148;
    goto LABEL_31;
  }
  if ( v1 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&v1->Timer + 1, 9u)
    && BYTE1(v1->Timer) >= 2u )
  {
    sub_11088((__int64)v1->AttachedDevice, 0x1Du, (__int64)&unk_57B70);
  }
  return 16i64;
}
// 5D42C: using guessed type __int64 (__fastcall *qword_5D42C)(_QWORD, _QWORD, _QWORD);
// 5D44C: using guessed type char byte_5D44C;

//----- (0000000000052BC8) ----------------------------------------------------
__int64 __fastcall sub_52BC8(_DWORD *a1, __int64 a2)
{
  unsigned int v4; // edi
  PDEVICE_OBJECT v5; // r10
  unsigned int v6; // eax
  PDEVICE_OBJECT v7; // rcx
  __int64 v9; // [rsp+20h] [rbp-28h]
  __int64 v10; // [rsp+30h] [rbp-18h] BYREF
  PVOID P; // [rsp+38h] [rbp-10h] BYREF

  v4 = 0;
  v5 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xEu, (__int64)&unk_57B60);
    v5 = off_5A148;
  }
  if ( a1 && a2 )
  {
    if ( *a1 != 1 )
    {
      if ( v5 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(v5->Queue.Wcb.DeviceRoutine) & 8) != 0
        && BYTE1(v5->Queue.Wcb.DeviceRoutine) >= 4u )
      {
        sub_11088((__int64)v5->Queue.ListEntry.Blink, 0x16u, (__int64)&unk_57B60);
        v5 = off_5A148;
      }
      v4 = 4;
      goto LABEL_45;
    }
    v10 = 0i64;
    P = 0i64;
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->Queue.Wcb.DeviceRoutine) & 8) != 0
      && BYTE1(v5->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_12D64((__int64)v5->Queue.ListEntry.Blink, 0x10u, (__int64)&unk_57B60, a2);
    }
    HIDWORD(v9) = 0;
    v10 = a2;
    if ( !sub_3D01C((struct _KEVENT **)&P, 0) )
    {
      v5 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
        && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 2u )
      {
        sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x11u, (__int64)&unk_57B60);
        v5 = off_5A148;
      }
      v4 = 3;
      goto LABEL_45;
    }
    if ( *(_DWORD *)(v10 + 24) || *(_BYTE *)(v10 + 32) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
        && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
      {
        sub_12D64((__int64)off_5A148->Queue.ListEntry.Blink, 0x12u, (__int64)&unk_57B60, &v10, 0i64, 0);
      }
      v6 = sub_52F2C((__int64)&v10);
      v4 = v6;
      if ( !v6 )
      {
        if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
          && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
          && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
        {
          sub_12D64((__int64)off_5A148->Queue.ListEntry.Blink, 0x13u, (__int64)&unk_57B60, &v10);
        }
        sub_3D860(P);
        goto LABEL_39;
      }
      v7 = off_5A148;
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
      {
        if ( (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) == 0 || BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) < 4u )
        {
LABEL_40:
          if ( v7 != (PDEVICE_OBJECT)&off_5A148
            && (BYTE4(v7->Queue.Wcb.DeviceRoutine) & 8) != 0
            && BYTE1(v7->Queue.Wcb.DeviceRoutine) >= 4u )
          {
            sub_12D64((__int64)v7->Queue.ListEntry.Blink, 0x15u, (__int64)&unk_57B60, &v10);
          }
          goto LABEL_44;
        }
        LODWORD(v9) = v6;
        sub_4AC00((__int64)off_5A148->Queue.ListEntry.Blink, 0x14u, (__int64)&unk_57B60, &v10, v9);
LABEL_39:
        v7 = off_5A148;
        goto LABEL_40;
      }
    }
LABEL_44:
    sub_3D094(P);
    v5 = off_5A148;
LABEL_45:
    if ( v5 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(v5->Queue.Wcb.DeviceRoutine) & 8) != 0
      && BYTE1(v5->Queue.Wcb.DeviceRoutine) >= 5u )
    {
      sub_11088((__int64)v5->Queue.ListEntry.Blink, 0x17u, (__int64)&unk_57B60);
    }
    return v4;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->Queue.Wcb.DeviceRoutine) & 8) != 0
    && BYTE1(v5->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_13EE0((__int64)v5->Queue.ListEntry.Blink, 0xFu, (__int64)&unk_57B60, a1, a2);
  }
  return 4i64;
}
// 52DC9: variable 'v9' is possibly undefined

//----- (0000000000052E90) ----------------------------------------------------
__int64 sub_52E90()
{
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->Timer + 1, 9u)
    && BYTE1(off_5A148->Timer) >= 5u )
  {
    sub_11088((__int64)off_5A148->AttachedDevice, 0x18u, (__int64)&unk_57B60);
  }
  sub_46F50(&stru_5D450);
  memset(&dword_5D428, 0, 0x25ui64);
  byte_5D44C = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && _bittest((const signed __int32 *)&off_5A148->Timer + 1, 9u)
    && BYTE1(off_5A148->Timer) >= 5u )
  {
    sub_11088((__int64)off_5A148->AttachedDevice, 0x19u, (__int64)&unk_57B60);
  }
  return 0i64;
}
// 5D428: using guessed type int dword_5D428;
// 5D44C: using guessed type char byte_5D44C;

//----- (0000000000052F2C) ----------------------------------------------------
__int64 __fastcall sub_52F2C(__int64 a1)
{
  unsigned int v2; // ebx
  __m128i *v3; // rax

  v2 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xAu, (__int64)&unk_57B50);
  }
  v3 = (__m128i *)sub_3D584((__int64)qword_5D4A8, 16, (__int64)sub_53044, 0i64);
  if ( v3 )
  {
    *v3 = _mm_loadu_si128((const __m128i *)a1);
    sub_3D780((__int64)v3);
  }
  else
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 4) != 0
      && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 2u )
    {
      sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xBu, (__int64)&unk_57B50);
    }
    v2 = 3;
    sub_3D0FC(*(PRKEVENT *)(a1 + 8));
  }
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0xCu, (__int64)&unk_57B50, v2);
  }
  return v2;
}

//----- (0000000000053044) ----------------------------------------------------
int __fastcall sub_53044(__int64 a1)
{
  void **v1; // rax
  int v2; // ebx
  PDEVICE_OBJECT v4; // rcx
  __int64 *v5; // rdx
  unsigned __int16 v6; // dx
  void *retaddr; // [rsp+28h] [rbp+0h] BYREF
  __int64 v9; // [rsp+30h] [rbp+8h] BYREF

  v1 = &retaddr;
  v2 = 0;
  v9 = 0i64;
  v4 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    LODWORD(v1) = sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xDu, (__int64)&unk_57B50);
    v4 = off_5A148;
  }
  if ( a1 )
  {
    v5 = *(__int64 **)a1;
    if ( *(_QWORD *)a1 )
    {
      if ( v5[1] )
      {
        sub_531B8(&v9, *v5, v5[1]);
        sub_5339C(v9, *(_QWORD *)(*(_QWORD *)a1 + 16i64), *(_DWORD *)(*(_QWORD *)a1 + 24i64));
        v2 = sub_53568(**(_QWORD **)a1, *(_QWORD *)(*(_QWORD *)a1 + 8i64), *(_QWORD *)(*(_QWORD *)a1 + 8i64), v9);
LABEL_22:
        LODWORD(v1) = sub_3D0FC(*(PRKEVENT *)(a1 + 8));
        goto LABEL_23;
      }
      if ( v4 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 4) == 0
        || BYTE1(v4->Queue.Wcb.DeviceRoutine) < 5u )
      {
        goto LABEL_22;
      }
      v6 = 16;
    }
    else
    {
      if ( v4 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 4) == 0
        || BYTE1(v4->Queue.Wcb.DeviceRoutine) < 2u )
      {
        goto LABEL_22;
      }
      v6 = 17;
    }
    sub_11088((__int64)v4->Queue.ListEntry.Blink, v6, (__int64)&unk_57B50);
    goto LABEL_22;
  }
  if ( v4 == (PDEVICE_OBJECT)&off_5A148 )
    return (int)v1;
  if ( (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 4) != 0 && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 2u )
  {
    LODWORD(v1) = sub_11088((__int64)v4->Queue.ListEntry.Blink, 0xEu, (__int64)&unk_57B50);
LABEL_23:
    v4 = off_5A148;
  }
  if ( v4 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v4->Queue.Wcb.DeviceRoutine) & 4) != 0
    && BYTE1(v4->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    LODWORD(v1) = sub_13EA4((__int64)v4->Queue.ListEntry.Blink, 0x12u, (__int64)&unk_57B50, v2);
  }
  return (int)v1;
}

//----- (00000000000531B8) ----------------------------------------------------
__int64 __fastcall sub_531B8(_QWORD *a1, __int64 a2, __int64 a3)
{
  unsigned int v4; // ebx
  PDEVICE_OBJECT v5; // rcx
  int v7[2]; // [rsp+20h] [rbp-58h] BYREF
  int v8; // [rsp+28h] [rbp-50h]
  __int64 v9[2]; // [rsp+30h] [rbp-48h] BYREF
  _BYTE v10[20]; // [rsp+40h] [rbp-38h]
  __int64 v11; // [rsp+88h] [rbp+10h]
  __int64 v12; // [rsp+90h] [rbp+18h]

  v12 = a3;
  v11 = a2;
  v7[0] = 0;
  v9[0] = 0i64;
  v9[1] = 0i64;
  *(_OWORD *)v10 = 0ui64;
  v7[1] = 0;
  v8 = 0;
  *(_DWORD *)&v10[16] = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xAu, (__int64)&unk_57B40);
    a3 = v12;
    a2 = v11;
  }
  *a1 = 0i64;
  v7[0] = 1;
  v8 = 36;
  *(_QWORD *)&v10[4] = a2;
  *(_QWORD *)&v10[12] = a3;
  *(_DWORD *)v10 = 10;
  if ( sub_46FB0(&stru_5D450) )
  {
    v4 = 11;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
      && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xBu, (__int64)&unk_57B40);
    }
    if ( (unsigned int)qword_5D42C(10i64, v7, v9) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
        && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 2u )
      {
        sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xCu, (__int64)&unk_57B40);
      }
    }
    else
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
        && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
      {
        sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xDu, (__int64)&unk_57B40);
      }
      v4 = 0;
      *a1 = v9[0];
    }
    sub_47018(&stru_5D450);
    v5 = off_5A148;
  }
  else
  {
    v5 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
      && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 2u )
    {
      sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0xEu, (__int64)&unk_57B40);
      v5 = off_5A148;
    }
    v4 = 9;
  }
  if ( v5 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v5->Queue.Wcb.DeviceRoutine) & 8) != 0
    && BYTE1(v5->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_11088((__int64)v5->Queue.ListEntry.Blink, 0xFu, (__int64)&unk_57B40);
  }
  return v4;
}
// 5D42C: using guessed type __int64 (__fastcall *qword_5D42C)(_QWORD, _QWORD, _QWORD);

//----- (000000000005339C) ----------------------------------------------------
__int64 __fastcall sub_5339C(__int64 a1, __int64 a2, int a3)
{
  unsigned int v3; // ebx
  PDEVICE_OBJECT v7; // rcx
  int v9[2]; // [rsp+20h] [rbp-48h] BYREF
  int v10; // [rsp+28h] [rbp-40h]
  __int64 v11; // [rsp+30h] [rbp-38h] BYREF
  __int64 v12; // [rsp+38h] [rbp-30h]
  int v13; // [rsp+40h] [rbp-28h]

  v3 = 0;
  v12 = 0i64;
  v11 = 0i64;
  v13 = 0;
  v9[0] = 0;
  v9[1] = 0;
  v10 = 0;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x10u, (__int64)&unk_57B40);
  }
  v13 = a3;
  v11 = a1;
  v12 = a2;
  v9[0] = 2;
  v10 = 20;
  if ( sub_46FB0(&stru_5D450) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
      && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x11u, (__int64)&unk_57B40);
    }
    if ( (unsigned int)qword_5D42C(10i64, v9, &v11) )
    {
      if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
        && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
        && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 2u )
      {
        sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x12u, (__int64)&unk_57B40);
      }
    }
    else if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
           && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
           && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_13EA4((__int64)off_5A148->Queue.ListEntry.Blink, 0x13u, (__int64)&unk_57B40, v13);
    }
    sub_47018(&stru_5D450);
    v7 = off_5A148;
  }
  else
  {
    v7 = off_5A148;
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
      && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 2u )
    {
      sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x14u, (__int64)&unk_57B40);
      v7 = off_5A148;
    }
    v3 = 9;
  }
  if ( v7 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v7->Queue.Wcb.DeviceRoutine) & 8) != 0
    && BYTE1(v7->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_11088((__int64)v7->Queue.ListEntry.Blink, 0x15u, (__int64)&unk_57B40);
  }
  return v3;
}
// 5D42C: using guessed type __int64 (__fastcall *qword_5D42C)(_QWORD, _QWORD, _QWORD);

//----- (0000000000053568) ----------------------------------------------------
__int64 __fastcall sub_53568(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  unsigned int v4; // ebp
  __int64 v5; // rbx
  __int64 v6; // rsi
  __int64 v7; // rdi
  PDEVICE_OBJECT v9; // rcx
  unsigned __int16 v10; // dx
  PDEVICE_OBJECT v11; // rcx
  __int64 v13; // [rsp+20h] [rbp-78h] BYREF
  __int64 v14; // [rsp+28h] [rbp-70h]
  __int64 Dst[13]; // [rsp+30h] [rbp-68h] BYREF
  __int64 v16; // [rsp+A0h] [rbp+8h]
  __int64 v17; // [rsp+A8h] [rbp+10h]
  __int64 v18; // [rsp+B0h] [rbp+18h]

  v18 = a3;
  v17 = a2;
  v16 = a1;
  v4 = 0;
  v5 = a3;
  v6 = a1;
  v13 = 0i64;
  v7 = a2;
  LODWORD(v14) = 0;
  LODWORD(Dst[0]) = 0;
  memset((char *)Dst + 4, 0, 0x1Dui64);
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_12D64((__int64)off_5A148->Queue.ListEntry.Blink, 0x16u, (__int64)&unk_57B40, a4, v13, v14);
    v5 = v18;
    v7 = v17;
    v6 = v16;
  }
  *(__int64 *)((char *)&Dst[3] + 1) = a4;
  Dst[0] = v6;
  Dst[1] = v7;
  Dst[2] = v5;
  LODWORD(v13) = 8;
  LODWORD(v14) = 33;
  if ( sub_46FB0(&stru_5D450) )
  {
    if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
      && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
      && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 4u )
    {
      sub_12D64((__int64)off_5A148->Queue.ListEntry.Blink, 0x17u, (__int64)&unk_57B40, a4, v13, v14);
    }
    if ( (unsigned int)qword_5D42C(10i64, &v13, Dst) )
    {
      v9 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) == 0
        || BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) < 2u )
      {
        goto LABEL_20;
      }
      v10 = 24;
    }
    else
    {
      v9 = off_5A148;
      if ( off_5A148 == (PDEVICE_OBJECT)&off_5A148
        || (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) == 0
        || BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) < 4u )
      {
        goto LABEL_20;
      }
      v10 = 25;
    }
    sub_11088((__int64)v9->Queue.ListEntry.Blink, v10, (__int64)&unk_57B40);
LABEL_20:
    sub_47018(&stru_5D450);
    v11 = off_5A148;
    goto LABEL_26;
  }
  v11 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(off_5A148->Queue.Wcb.DeviceRoutine) & 8) != 0
    && BYTE1(off_5A148->Queue.Wcb.DeviceRoutine) >= 2u )
  {
    sub_11088((__int64)off_5A148->Queue.ListEntry.Blink, 0x1Au, (__int64)&unk_57B40);
    v11 = off_5A148;
  }
  v4 = 9;
LABEL_26:
  if ( v11 != (PDEVICE_OBJECT)&off_5A148
    && (BYTE4(v11->Queue.Wcb.DeviceRoutine) & 8) != 0
    && BYTE1(v11->Queue.Wcb.DeviceRoutine) >= 5u )
  {
    sub_11088((__int64)v11->Queue.ListEntry.Blink, 0x1Bu, (__int64)&unk_57B40);
  }
  return v4;
}
// 5D42C: using guessed type __int64 (__fastcall *qword_5D42C)(_QWORD, _QWORD, _QWORD);

//----- (0000000000053750) ----------------------------------------------------
__int64 __fastcall sub_53750(_QWORD *a1, _QWORD *a2)
{
  char *v4; // rbx
  NTSTATUS v6; // edi
  IRP *v7; // rax
  struct _IO_STATUS_BLOCK IoStatusBlock; // [rsp+50h] [rbp-58h] BYREF
  _UNICODE_STRING DestinationString; // [rsp+60h] [rbp-48h] BYREF
  struct _KEVENT Event; // [rsp+70h] [rbp-38h] BYREF

  IoStatusBlock.Pointer = 0i64;
  Event.Header.Type = 0;
  IoStatusBlock.Information = 0i64;
  *(_OWORD *)((char *)&Event.Header.Lock + 1) = 0ui64;
  *(_DWORD *)((char *)&Event.Header.WaitListHead.Blink + 1) = 0;
  *(_WORD *)((char *)&Event.Header.WaitListHead.Blink + 5) = 0;
  HIBYTE(Event.Header.WaitListHead.Blink) = 0;
  v4 = (char *)sub_3C4EC(2, 0x18u, 0x41434E50u);
  if ( !v4 )
    return 1793i64;
  *(_QWORD *)v4 = 0i64;
  *((_QWORD *)v4 + 1) = 0i64;
  *((_QWORD *)v4 + 2) = 0i64;
  KeInitializeEvent(&Event, SynchronizationEvent, 0);
  RtlInitUnicodeString(&DestinationString, L"\\Device\\NANO\\KNC");
  v6 = IoGetDeviceObjectPointer(&DestinationString, 0x10000000u, (PFILE_OBJECT *)v4, (PDEVICE_OBJECT *)v4 + 1);
  if ( v6
    || (v7 = IoBuildDeviceIoControlRequest(
               0x8BC82004,
               *((PDEVICE_OBJECT *)v4 + 1),
               0i64,
               0,
               v4 + 16,
               8u,
               0,
               &Event,
               &IoStatusBlock),
        (v6 = IofCallDriver(*((PDEVICE_OBJECT *)v4 + 1), v7)) != 0) )
  {
    if ( *(_QWORD *)v4 )
      ObfDereferenceObject(*(PVOID *)v4);
    sub_3C570(v4, 0x41434E50u);
    v4 = 0i64;
  }
  else
  {
    *a2 = *((_QWORD *)v4 + 2);
  }
  KeClearEvent(&Event);
  *a1 = v4;
  return v6 != 0 ? 0xE8700002 : 0;
}

//----- (00000000000538D4) ----------------------------------------------------
void __fastcall sub_538D4(PVOID P)
{
  PVOID *v1; // rdi

  if ( P )
  {
    v1 = (PVOID *)*((_QWORD *)P + 6);
    *(_BYTE *)P = 0;
    if ( v1 )
    {
      if ( *v1 )
        ObfDereferenceObject(*v1);
      sub_3C570(v1, 0x41434E50u);
    }
    sub_3C570(P, 0x41434E50u);
  }
}

//----- (0000000000053944) ----------------------------------------------------
__int64 __fastcall sub_53944(__int64 a1, __int64 a2)
{
  if ( !a1 )
    return 1799i64;
  if ( a2 )
    return (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, char, _QWORD))(*(_QWORD *)(a1 + 24) + 16i64))(
             **(_QWORD **)(a1 + 24),
             a2,
             0i64,
             0i64,
             1,
             0i64);
  return 1796i64;
}

//----- (0000000000053988) ----------------------------------------------------
__int64 __fastcall sub_53988(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, void *Src)
{
  size_t v5; // rbx
  unsigned int v6; // er12
  PVOID v10; // rax
  void *v11; // r13
  unsigned int v12; // ebx

  v5 = a4;
  v6 = a3;
  if ( !a1 )
    return 1799i64;
  if ( !a2 )
    return 1796i64;
  if ( !a4 || !Src )
    return (unsigned int)(*(__int64 (__fastcall **)(_QWORD, __int64, __int64, _QWORD, _QWORD))(*(_QWORD *)(a1 + 24)
                                                                                             + 24i64))(
                           **(_QWORD **)(a1 + 24),
                           a2,
                           a3,
                           0i64,
                           0i64);
  v10 = sub_3C4EC(2, a4, 0x41434E50u);
  v11 = v10;
  if ( !v10 )
    return 1793;
  memmove(v10, Src, v5);
  v12 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, void *, _DWORD))(*(_QWORD *)(a1 + 24) + 24i64))(
          **(_QWORD **)(a1 + 24),
          a2,
          v6,
          (unsigned int)v5,
          v11,
          0);
  sub_3C570(v11, 0x41434E50u);
  return v12;
}

//----- (0000000000053AE8) ----------------------------------------------------
__int64 __fastcall sub_53AE8(char *a1, unsigned __int64 a2, unsigned __int16 *a3, int *a4)
{
  __int64 result; // rax

  if ( !a1 || !a2 || !a3 )
    goto LABEL_6;
  result = sub_546DC(a1, a2, a3, a4);
  if ( (int)result >= 0 )
    return result;
  *(_WORD *)a1 = 0;
  if ( (_DWORD)result == -2 )
LABEL_6:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
  return 0xFFFFFFFFi64;
}
// 553EC: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000053B40) ----------------------------------------------------
__int64 sub_53B40(char *a1, unsigned __int64 a2, unsigned __int16 *a3, ...)
{
  va_list va; // [rsp+48h] [rbp+20h] BYREF

  va_start(va, a3);
  return sub_53AE8(a1, a2, a3, (int *)va);
}

//----- (0000000000053B64) ----------------------------------------------------
__int64 __fastcall sub_53B64(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4)
{
  __int64 result; // rax

  if ( !a1 || !a2 || !a3 )
    goto LABEL_6;
  result = sub_551D8(a1, a2, a3, a4);
  if ( (int)result >= 0 )
    return result;
  *a1 = 0;
  if ( (_DWORD)result == -2 )
LABEL_6:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
  return 0xFFFFFFFFi64;
}
// 553EC: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000053BB4) ----------------------------------------------------
__int64 sub_53BB4(char *a1, unsigned __int64 a2, CHAR *a3, ...)
{
  va_list va; // [rsp+48h] [rbp+20h] BYREF

  va_start(va, a3);
  return sub_53B64(a1, a2, a3, (__int64)va);
}

//----- (0000000000053BD8) ----------------------------------------------------
__int64 __fastcall sub_53BD8(void *a1, size_t a2, const void *a3, size_t a4)
{
  unsigned int v8; // ebx

  if ( !a4 )
    return 0i64;
  if ( !a1 )
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 22i64;
  }
  if ( a3 && a2 >= a4 )
  {
    memmove(a1, a3, a4);
    return 0i64;
  }
  memset(a1, 0, a2);
  if ( a3 )
  {
    if ( a2 >= a4 )
      return 22i64;
    v8 = 34;
  }
  else
  {
    v8 = 22;
  }
  nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
  return v8;
}
// 553EC: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000053C7C) ----------------------------------------------------
__int64 __fastcall sub_53C7C(char *a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int16 *a4, int *a5)
{
  __int64 result; // rax

  if ( !a4 )
    goto LABEL_12;
  if ( a3 )
  {
    if ( !a1 )
    {
LABEL_12:
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return 0xFFFFFFFFi64;
    }
  }
  else if ( !a1 )
  {
    if ( !a2 )
      return 0i64;
    goto LABEL_12;
  }
  if ( !a2 )
    goto LABEL_12;
  if ( a2 > a3 )
  {
    result = sub_546DC(a1, a3 + 1, a4, a5);
    if ( (_DWORD)result == -2 )
      return 0xFFFFFFFFi64;
    goto LABEL_10;
  }
  result = sub_546DC(a1, a2, a4, a5);
  if ( (_DWORD)result != -2 )
  {
LABEL_10:
    if ( (int)result >= 0 )
      return result;
    goto LABEL_11;
  }
  if ( a3 == -1i64 )
    return 0xFFFFFFFFi64;
LABEL_11:
  *(_WORD *)a1 = 0;
  if ( (_DWORD)result == -2 )
    goto LABEL_12;
  return 0xFFFFFFFFi64;
}
// 553EC: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000053D24) ----------------------------------------------------
__int64 sub_53D24(char *a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int16 *a4, ...)
{
  va_list va; // [rsp+60h] [rbp+28h] BYREF

  va_start(va, a4);
  return sub_53C7C(a1, a2, a3, a4, (int *)va);
}

//----- (0000000000053D48) ----------------------------------------------------
_WORD *__fastcall sub_53D48(__int16 a1, __int64 a2, _DWORD *a3)
{
  _WORD *result; // rax
  __int16 v4; // r9
  bool v5; // sf

  result = (_WORD *)*(unsigned int *)(a2 + 24);
  v4 = a1;
  if ( (((unsigned __int8)result & 0x40) == 0 || *(_QWORD *)(a2 + 16))
    && ((v5 = *(_DWORD *)(a2 + 8) - 2 < 0, *(_DWORD *)(a2 + 8) -= 2, v5) ? (result = (_WORD *)((unsigned int)result | 0x20),
                                                                            v4 = -1,
                                                                            *(_DWORD *)(a2 + 24) = (_DWORD)result) : (result = *(_WORD **)a2, **(_WORD **)a2 = a1, *(_QWORD *)a2 += 2i64),
        v4 == -1 && (*(_BYTE *)(a2 + 24) & 0x20) != 0) )
  {
    *a3 = -1;
  }
  else
  {
    ++*a3;
  }
  return result;
}

//----- (0000000000053D98) ----------------------------------------------------
_WORD *__fastcall sub_53D98(__int16 *a1, int a2, __int64 a3, _DWORD *a4)
{
  _WORD *result; // rax
  int v8; // er10

  if ( (*(_BYTE *)(a3 + 24) & 0x40) == 0 || *(_QWORD *)(a3 + 16) )
  {
    if ( a2 > 0 )
    {
      do
        result = sub_53D48(*a1++, a3, a4);
      while ( *a4 != -1 && v8 > 0 );
    }
  }
  else
  {
    *a4 += a2;
  }
  return result;
}
// 53DD1: variable 'a4' is possibly undefined
// 53DE3: variable 'v8' is possibly undefined

//----- (0000000000053DF8) ----------------------------------------------------
__int64 __fastcall sub_53DF8(__int64 a1, unsigned __int16 *a2, int *a3)
{
  __int64 v4; // r12
  int v5; // esi
  int v6; // er11
  int v7; // er9
  int v8; // er10
  unsigned __int16 v10; // di
  int v11; // ebp
  int v12; // er13
  int v13; // er8
  wchar_t *v14; // rbx
  int v15; // ecx
  int v16; // er8
  __int64 v17; // rcx
  unsigned __int16 v18; // ax
  int v19; // ecx
  _BYTE *v20; // rax
  wchar_t v21; // ax
  int v22; // eax
  int v23; // eax
  _WORD *j; // rax
  __int64 v25; // rdi
  char v26; // r12
  char *v27; // rbx
  int v28; // ecx
  unsigned __int64 v29; // rdx
  char v30; // al
  int v31; // esp
  int v32; // eax
  unsigned __int8 v33; // cf
  __int16 v34; // ax
  int v35; // er12
  int v36; // edi
  __int64 v37; // rdx
  __int16 v38; // r10
  __int64 v39; // rdi
  int v40; // edi
  __int64 v41; // rdx
  const char *v42; // rbp
  int v43; // edi
  int v44; // er11
  int v45; // er10
  __int64 v46; // rdx
  __int64 v47; // r11
  bool i; // zf
  int v49; // [rsp+30h] [rbp-498h] BYREF
  int v50; // [rsp+34h] [rbp-494h]
  int v51; // [rsp+38h] [rbp-490h]
  int v52; // [rsp+3Ch] [rbp-48Ch]
  int v53; // [rsp+40h] [rbp-488h]
  __int16 v54[2]; // [rsp+44h] [rbp-484h] BYREF
  int v55; // [rsp+48h] [rbp-480h]
  char SrcCh[4]; // [rsp+4Ch] [rbp-47Ch] BYREF
  __int64 v57; // [rsp+50h] [rbp-478h]
  wchar_t v58; // [rsp+58h] [rbp-470h] BYREF
  wchar_t *v59; // [rsp+60h] [rbp-468h]
  int v60; // [rsp+68h] [rbp-460h]
  int v61; // [rsp+6Ch] [rbp-45Ch]
  int v62; // [rsp+70h] [rbp-458h]
  wchar_t DstCh[255]; // [rsp+80h] [rbp-448h] BYREF
  char v64; // [rsp+27Fh] [rbp-249h] BYREF

  v4 = a1;
  v57 = a1;
  v61 = 0;
  v5 = 0;
  v6 = 0;
  v52 = 0;
  v7 = 0;
  v51 = 0;
  v8 = 0;
  v50 = 0;
  v60 = 0;
  v53 = 0;
  if ( !a1 || !a2 )
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  v10 = *a2;
  v11 = 0;
  v49 = 0;
  v12 = 0;
  v13 = 0;
  if ( !v10 )
    return (unsigned int)v11;
  v14 = v59;
  do
  {
    v59 = ++a2;
    if ( v11 < 0 )
      break;
    if ( (unsigned __int16)(v10 - 32) > 0x58u )
      v15 = 0;
    else
      v15 = byte_57220[v10 - 32] & 0xF;
    v13 = byte_57220[9 * v15 + v13] >> 4;
    v55 = v13;
    switch ( v13 )
    {
      case 8:
        goto LABEL_197;
      case 0:
        goto LABEL_169;
      case 1:
        v7 = -1;
        v51 = -1;
        v60 = 0;
        v6 = 0;
        v52 = 0;
        v8 = 0;
        v50 = 0;
        v5 = 0;
        v53 = 0;
        break;
      case 2:
        switch ( v10 )
        {
          case ' ':
            v5 |= 2u;
            break;
          case '#':
            v5 |= 0x80u;
            break;
          case '+':
            v5 |= 1u;
            break;
          case '-':
            v5 |= 4u;
            break;
          case '0':
            v5 |= 8u;
            break;
        }
        break;
      case 3:
        if ( v10 != 42 )
        {
          v6 = v10 + 10 * v6 - 48;
          goto LABEL_185;
        }
        v6 = *a3;
        a3 += 2;
        v52 = v6;
        if ( v6 < 0 )
        {
          v5 |= 4u;
          v6 = -v6;
LABEL_185:
          v52 = v6;
          break;
        }
        break;
      case 4:
        v7 = 0;
        v51 = 0;
        break;
      case 5:
        if ( v10 == 42 )
        {
          v7 = *a3;
          a3 += 2;
          v51 = v7;
          if ( v7 < 0 )
          {
            v7 = -1;
            v51 = -1;
          }
        }
        else
        {
          v7 = v10 + 10 * v7 - 48;
          v51 = v7;
        }
        break;
      case 6:
        if ( v10 != 73 )
        {
          switch ( v10 )
          {
            case 'h':
              v5 |= 0x20u;
              break;
            case 'l':
              if ( *a2 == 108 )
              {
                ++a2;
                v5 |= 0x1000u;
              }
              else
              {
                v5 |= 0x10u;
              }
              break;
            case 'w':
              v5 |= 0x800u;
              break;
          }
          break;
        }
        v5 |= 0x8000u;
        if ( *a2 == 54 && a2[1] == 52 )
        {
          a2 += 2;
          v5 |= 0x8000u;
        }
        else
        {
          if ( *a2 != 51 || a2[1] != 50 )
          {
            if ( *a2 == 100 || *a2 == 105 || *a2 == 111 || *a2 == 117 || *a2 == 120 || *a2 == 88 )
              break;
            v55 = 0;
LABEL_169:
            v53 = 1;
            sub_53D48(v10, v4, &v49);
            v11 = v49;
LABEL_170:
            v7 = v51;
            a2 = v59;
LABEL_171:
            v13 = v55;
            break;
          }
          a2 += 2;
          v5 &= 0xFFFF7FFF;
        }
        break;
      case 7:
        if ( v10 > 0x69u )
        {
          switch ( v10 )
          {
            case 'n':
              goto LABEL_197;
            case 'o':
              v16 = 8;
              if ( (v5 & 0x80u) != 0 )
                v5 |= 0x200u;
              goto LABEL_76;
            case 'p':
              v7 = 16;
              v5 |= 0x8000u;
              goto LABEL_71;
          }
          if ( v10 != 115 )
          {
            if ( v10 != 117 )
            {
              if ( v10 != 120 )
                goto LABEL_107;
              v23 = 39;
              goto LABEL_72;
            }
LABEL_28:
            v16 = 10;
LABEL_76:
            if ( _bittest(&v5, 0xFu) || _bittest(&v5, 0xCu) )
            {
              v25 = *(_QWORD *)a3;
              a3 += 2;
            }
            else
            {
              a3 += 2;
              if ( (v5 & 0x20) != 0 )
              {
                if ( (v5 & 0x40) != 0 )
                  v25 = *((__int16 *)a3 - 4);
                else
                  v25 = *((unsigned __int16 *)a3 - 4);
              }
              else if ( (v5 & 0x40) != 0 )
              {
                v25 = *(a3 - 2);
              }
              else
              {
                v25 = (unsigned int)*(a3 - 2);
              }
            }
            if ( (v5 & 0x40) != 0 && v25 < 0 )
            {
              v25 = -v25;
              v5 |= 0x100u;
            }
            if ( !_bittest(&v5, 0xFu) && !_bittest(&v5, 0xCu) )
              v25 = (unsigned int)v25;
            if ( v7 >= 0 )
            {
              v5 &= 0xFFFFFFF7;
              if ( v7 > 512 )
                v7 = 512;
            }
            else
            {
              v7 = 1;
            }
            v26 = v61;
            v27 = &v64;
            v50 = v25 != 0 ? v8 : 0;
            while ( 1 )
            {
              v28 = v7--;
              if ( v28 <= 0 && !v25 )
                break;
              v29 = v25 % (unsigned __int64)v16;
              v25 /= (unsigned __int64)v16;
              v30 = v29 + 48;
              if ( (int)v29 + 48 > 57 )
                v30 += v26;
              *v27-- = v30;
            }
            v8 = v50;
            v4 = v57;
            v32 = v31 + 639 - (_DWORD)v27;
            v14 = (wchar_t *)(v27 + 1);
            v33 = _bittest(&v5, 9u);
            v12 = v32;
            v51 = v7;
            if ( v33 && (!v32 || *(_BYTE *)v14 != 48) )
            {
              v14 = (wchar_t *)((char *)v14 - 1);
              v12 = v32 + 1;
              *(_BYTE *)v14 = 48;
            }
            a2 = v59;
            goto LABEL_107;
          }
        }
        else
        {
          if ( v10 == 105 )
            goto LABEL_27;
          if ( v10 == 67 )
          {
            if ( (v5 & 0x830) == 0 )
              v5 |= 0x20u;
            goto LABEL_51;
          }
          if ( v10 != 83 )
          {
            if ( v10 != 88 )
            {
              if ( v10 == 90 )
              {
                v17 = *(_QWORD *)a3;
                a3 += 2;
                if ( v17 && (v14 = *(wchar_t **)(v17 + 8)) != 0i64 )
                {
                  v18 = *(_WORD *)v17;
                  if ( *(_WORD *)(v17 + 2) < *(_WORD *)v17 )
                    goto LABEL_197;
                  if ( _bittest(&v5, 0xBu) )
                  {
                    if ( (v18 & 1) != 0 || ((unsigned __int8)v14 & 1) != 0 )
                      goto LABEL_197;
                    v12 = v18 >> 1;
                    v53 = 1;
                  }
                  else
                  {
                    v53 = 0;
                    v12 = v18;
                  }
                }
                else
                {
                  v14 = (wchar_t *)::SrcCh;
                  v12 = strlen(::SrcCh);
                }
                goto LABEL_107;
              }
              if ( v10 != 99 )
              {
                if ( v10 == 100 )
                {
LABEL_27:
                  v5 |= 0x40u;
                  goto LABEL_28;
                }
LABEL_107:
                if ( v60 )
                  goto LABEL_171;
                if ( (v5 & 0x40) != 0 )
                {
                  if ( _bittest(&v5, 8u) )
                  {
                    v34 = 45;
                    goto LABEL_115;
                  }
                  if ( (v5 & 1) != 0 )
                  {
                    v34 = 43;
                    goto LABEL_115;
                  }
                  if ( (v5 & 2) != 0 )
                  {
                    v34 = 32;
LABEL_115:
                    v8 = 1;
                    v54[0] = v34;
                    v50 = 1;
                  }
                }
                v35 = v6 - v12 - v8;
                v62 = v35;
                if ( (v5 & 0xC) == 0 )
                {
                  v36 = v6 - v12 - v8;
                  if ( v35 > 0 )
                  {
                    v37 = v57;
                    v38 = 32;
                    do
                    {
                      --v36;
                      sub_53D48(v38, v37, &v49);
                    }
                    while ( v49 != -1 && v36 > 0 );
                    v8 = v50;
                  }
                }
                v39 = v57;
                sub_53D98(v54, v8, v57, &v49);
                if ( (v5 & 8) != 0 && (v5 & 4) == 0 )
                {
                  v40 = v35;
                  if ( v35 <= 0 )
                  {
                    v39 = v57;
                  }
                  else
                  {
                    v41 = v57;
                    do
                    {
                      --v40;
                      sub_53D48(48, v41, &v49);
                    }
                    while ( v49 != -1 && v40 > 0 );
                    v35 = v62;
                    v39 = v41;
                  }
                }
                if ( v53 || v12 <= 0 )
                {
                  sub_53D98((__int16 *)v14, v12, v39, &v49);
                  v45 = 0;
LABEL_140:
                  v11 = v49;
                }
                else
                {
                  v42 = (const char *)v14;
                  v43 = v12;
                  while ( 1 )
                  {
                    --v43;
                    v44 = mbtowc(&v58, v42, dword_5A120);
                    if ( v44 == 2 )
                      --v43;
                    v45 = 0;
                    if ( v44 <= 0 )
                      break;
                    sub_53D48(v58, v57, &v49);
                    v42 += v47;
                    if ( v43 <= v45 )
                    {
                      v39 = v46;
                      goto LABEL_140;
                    }
                  }
                  v39 = v57;
                  v11 = -1;
                  v49 = -1;
                }
                if ( v11 >= v45 )
                {
                  for ( i = (v5 & 4) == 0; !i && v35 > v45; i = v49 == -1 )
                  {
                    --v35;
                    sub_53D48(32, v39, &v49);
                    v11 = v49;
                  }
                }
                v8 = v50;
                v6 = v52;
                v4 = v57;
                goto LABEL_170;
              }
LABEL_51:
              v21 = *(_WORD *)a3;
              a3 += 2;
              v58 = v21;
              v53 = 1;
              if ( (v5 & 0x20) != 0 )
              {
                SrcCh[0] = v21;
                SrcCh[1] = 0;
                v22 = mbtowc(DstCh, SrcCh, dword_5A120);
                a2 = v59;
                v7 = v51;
                v8 = v50;
                v6 = v52;
                if ( v22 < 0 )
                  v60 = 1;
              }
              else
              {
                DstCh[0] = v21;
              }
              v14 = DstCh;
              v12 = 1;
              goto LABEL_107;
            }
LABEL_71:
            v23 = 7;
LABEL_72:
            v61 = v23;
            v16 = 16;
            if ( (v5 & 0x80u) != 0 )
            {
              v8 = 2;
              v54[0] = 48;
              v54[1] = v23 + 81;
            }
            goto LABEL_76;
          }
          if ( (v5 & 0x830) == 0 )
            v5 |= 0x20u;
        }
        v14 = *(wchar_t **)a3;
        v19 = v7;
        if ( v7 == -1 )
          v19 = 0x7FFFFFFF;
        a3 += 2;
        v12 = 0;
        if ( (v5 & 0x20) != 0 )
        {
          if ( !v14 )
            v14 = (wchar_t *)::SrcCh;
          v20 = v14;
          if ( v19 > 0 )
          {
            do
            {
              if ( !*v20 )
                break;
              ++v12;
              ++v20;
            }
            while ( v12 < v19 );
          }
        }
        else
        {
          v53 = 1;
          if ( !v14 )
            v14 = off_5A118;
          for ( j = v14; v19; ++j )
          {
            --v19;
            if ( !*j )
              break;
          }
          v12 = j - v14;
        }
        goto LABEL_107;
    }
    v10 = *a2;
  }
  while ( *a2 );
  if ( v13 && v13 != 7 )
  {
LABEL_197:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  return (unsigned int)v11;
}
// 54259: variable 'v8' is possibly undefined
// 54297: variable 'v31' is possibly undefined
// 54318: variable 'v6' is possibly undefined
// 54344: variable 'v38' is possibly undefined
// 54344: variable 'v37' is possibly undefined
// 5439C: variable 'v41' is possibly undefined
// 54409: variable 'v47' is possibly undefined
// 5440F: variable 'v45' is possibly undefined
// 54411: variable 'v46' is possibly undefined
// 553EC: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 5A118: using guessed type wchar_t *off_5A118;
// 5A120: using guessed type int dword_5A120;

//----- (00000000000546DC) ----------------------------------------------------
__int64 __fastcall sub_546DC(char *a1, unsigned __int64 a2, unsigned __int16 *a3, int *a4)
{
  __int64 result; // rax
  unsigned int v7; // ebp
  char *v8; // rax
  FILE File; // [rsp+30h] [rbp-38h] BYREF

  if ( a2 == -1i64 )
  {
    File._cnt = 0x7FFFFFFF;
  }
  else
  {
    if ( a2 > 0x3FFFFFFF )
    {
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return 0xFFFFFFFFi64;
    }
    File._cnt = 2 * a2;
  }
  File._base = a1;
  File._ptr = a1;
  File._flag = 66;
  result = sub_53DF8((__int64)&File, a3, a4);
  v7 = result;
  *(_WORD *)&a1[2 * a2 - 2] = 0;
  if ( (int)result >= 0 )
  {
    if ( --File._cnt < 0 )
    {
      if ( flsbuf(0, &File) == -1 )
        return 4294967294i64;
      v8 = File._ptr;
    }
    else
    {
      *File._ptr = 0;
      v8 = ++File._ptr;
    }
    if ( --File._cnt < 0 )
    {
      if ( flsbuf(0, &File) == -1 )
        return 4294967294i64;
    }
    else
    {
      *v8 = 0;
    }
    return v7;
  }
  if ( File._cnt < 0 )
    return 4294967294i64;
  if ( a1 )
  {
    if ( a2 )
      *(_WORD *)a1 = 0;
  }
  return result;
}
// 553EC: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000054898) ----------------------------------------------------
__int64 __fastcall sub_54898(_BYTE *a1, int a2, __int64 a3, _DWORD *a4)
{
  int v6; // ebx
  _BYTE *v7; // rbp
  __int64 result; // rax

  v6 = a2;
  v7 = a1;
  if ( (*(_BYTE *)(a3 + 24) & 0x40) == 0 || *(_QWORD *)(a3 + 16) )
  {
    if ( a2 > 0 )
    {
      do
      {
        LOBYTE(a1) = *v7;
        --v6;
        result = write_char(a1, a3, a4);
        ++v7;
      }
      while ( *a4 != -1 && v6 > 0 );
    }
  }
  else
  {
    *a4 += a2;
  }
  return result;
}
// 548D9: variable 'a1' is possibly undefined
// 547F0: using guessed type __int64 __fastcall write_char(_QWORD, _QWORD, _QWORD);

//----- (0000000000054908) ----------------------------------------------------
__int64 __fastcall sub_54908(__int64 a1, CHAR *a2, __int64 a3)
{
  int *v3; // r9
  __int64 v5; // r13
  int v6; // esi
  int v7; // er11
  int v8; // edx
  int v9; // er10
  int v10; // er8
  CHAR v12; // di
  int v13; // er14
  int v14; // er12
  CHAR *v15; // rbx
  int v16; // ecx
  __int64 v17; // rcx
  int v18; // eax
  char *i; // rcx
  __int64 v20; // r9
  int v21; // er8
  int v22; // eax
  _BYTE *j; // rcx
  __int64 v24; // rdi
  __int64 v25; // r9
  unsigned int v26; // er15
  char v27; // r13
  CHAR *v28; // rbx
  unsigned __int64 v29; // rdx
  CHAR v30; // al
  int v31; // esp
  int v32; // eax
  __int64 v33; // rdi
  unsigned int v34; // er13
  __int64 v35; // rcx
  WCHAR *v36; // rbp
  int v37; // er12
  int v38; // edi
  __int64 v39; // rcx
  int v40; // eax
  CHAR v41; // al
  __int64 v42; // rcx
  int v43; // [rsp+30h] [rbp-298h]
  unsigned int v44; // [rsp+34h] [rbp-294h] BYREF
  char v45[4]; // [rsp+38h] [rbp-290h] BYREF
  int v46; // [rsp+3Ch] [rbp-28Ch]
  int v47; // [rsp+40h] [rbp-288h]
  int v48; // [rsp+44h] [rbp-284h]
  WCHAR UnicodeString; // [rsp+48h] [rbp-280h] BYREF
  int v50; // [rsp+50h] [rbp-278h]
  int *v51; // [rsp+58h] [rbp-270h]
  __int64 v52; // [rsp+60h] [rbp-268h]
  int v53; // [rsp+68h] [rbp-260h]
  int v54; // [rsp+6Ch] [rbp-25Ch]
  ULONG BytesInMultiByteString; // [rsp+70h] [rbp-258h] BYREF
  ULONG v56; // [rsp+74h] [rbp-254h] BYREF
  CHAR *v57; // [rsp+78h] [rbp-250h]
  CHAR MultiByteString[512]; // [rsp+80h] [rbp-248h] BYREF
  CHAR v59[4]; // [rsp+280h] [rbp-48h] BYREF
  __int16 v60; // [rsp+284h] [rbp-44h]

  v3 = (int *)a3;
  v51 = (int *)a3;
  v5 = a1;
  v52 = a1;
  v53 = 0;
  v6 = 0;
  v7 = 0;
  v47 = 0;
  v8 = 0;
  v43 = 0;
  v9 = 0;
  v46 = 0;
  v10 = 0;
  v48 = 0;
  v50 = 0;
  if ( !a1 || !a2 )
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  v12 = *a2;
  v44 = 0;
  v13 = 0;
  v14 = 0;
  if ( !v12 )
    return v44;
  v15 = v57;
  while ( 1 )
  {
    v57 = ++a2;
    if ( (v44 & 0x80000000) != 0 )
      break;
    if ( (unsigned __int8)(v12 - 32) > 0x58u )
      v16 = 0;
    else
      v16 = byte_57220[v12 - 32] & 0xF;
    v14 = byte_57220[9 * v16 + v14] >> 4;
    v54 = v14;
    switch ( v14 )
    {
      case 8:
        goto LABEL_192;
      case 0:
        v42 = 0i64;
        goto LABEL_187;
      case 1:
        v8 = -1;
        v10 = 0;
        v48 = 0;
        v7 = 0;
        v47 = 0;
        v9 = 0;
        v46 = 0;
        v6 = 0;
        v43 = -1;
        v50 = 0;
        break;
      case 2:
        switch ( v12 )
        {
          case ' ':
            v6 |= 2u;
            break;
          case '#':
            v6 |= 0x80u;
            break;
          case '+':
            v6 |= 1u;
            break;
          case '-':
            v6 |= 4u;
            break;
          case '0':
            v6 |= 8u;
            break;
        }
        break;
      case 3:
        if ( v12 == 42 )
        {
          v7 = *v3;
          v51 = v3 + 2;
          v47 = v7;
          if ( v7 >= 0 )
            break;
          v6 |= 4u;
          v7 = -v7;
        }
        else
        {
          v7 = v12 + 10 * v7 - 48;
        }
        v47 = v7;
        break;
      case 4:
        v8 = 0;
LABEL_169:
        v43 = v8;
        break;
      case 5:
        if ( v12 == 42 )
        {
          v8 = *v3;
          v51 = v3 + 2;
          v43 = v8;
          if ( v8 >= 0 )
            break;
          v8 = -1;
        }
        else
        {
          v8 = v12 + 10 * v8 - 48;
        }
        goto LABEL_169;
      case 6:
        switch ( v12 )
        {
          case 'I':
            v41 = *a2;
            v6 |= 0x8000u;
            if ( *a2 == 54 && a2[1] == 52 )
            {
              a2 += 2;
              v6 |= 0x8000u;
              goto LABEL_190;
            }
            if ( v41 == 51 && a2[1] == 50 )
            {
              a2 += 2;
              v6 &= 0xFFFF7FFF;
              goto LABEL_190;
            }
            if ( v41 != 100 && v41 != 105 && v41 != 111 && v41 != 117 && v41 != 120 && v41 != 88 )
            {
              v42 = 0i64;
              v14 = 0;
LABEL_187:
              v50 = 0;
              LOBYTE(v42) = v12;
              write_char(v42, v5, &v44);
              goto LABEL_188;
            }
            break;
          case 'h':
            v6 |= 0x20u;
            break;
          case 'l':
            if ( *a2 == 108 )
            {
              ++a2;
              v6 |= 0x1000u;
            }
            else
            {
              v6 |= 0x10u;
            }
            break;
          case 'w':
            v6 |= 0x800u;
            break;
        }
        break;
      case 7:
        if ( v12 > 105 )
        {
          switch ( v12 )
          {
            case 'n':
              goto LABEL_192;
            case 'o':
              v21 = 8;
              if ( (v6 & 0x80u) != 0 )
                v6 |= 0x200u;
              goto LABEL_83;
            case 'p':
              v43 = 16;
              v6 |= 0x8000u;
              goto LABEL_78;
          }
          if ( v12 != 115 )
          {
            v17 = (unsigned int)(v12 - 117);
            if ( v12 == 117 )
              goto LABEL_57;
            if ( v12 != 120 )
              goto LABEL_27;
            v22 = 39;
            goto LABEL_79;
          }
        }
        else
        {
          if ( v12 == 105 )
            goto LABEL_56;
          v17 = (unsigned int)(v12 - 67);
          if ( v12 == 67 )
          {
            if ( (v6 & 0x830) == 0 )
              v6 |= 0x800u;
            goto LABEL_50;
          }
          if ( v12 != 83 )
          {
            if ( v12 != 88 )
            {
              if ( v12 == 90 )
              {
                v17 = *(_QWORD *)v3;
                v51 = v3 + 2;
                if ( v17 && (v15 = *(CHAR **)(v17 + 8)) != 0i64 )
                {
                  if ( *(_WORD *)(v17 + 2) < *(_WORD *)v17 )
                    goto LABEL_192;
                  v13 = *(unsigned __int16 *)v17;
                  if ( _bittest(&v6, 0xBu) )
                  {
                    if ( (v13 & 1) != 0 || ((unsigned __int8)v15 & 1) != 0 )
                      goto LABEL_192;
                    v13 = *(unsigned __int16 *)v17 >> 1;
                    v50 = 1;
                  }
                  else
                  {
                    v50 = 0;
                  }
                }
                else
                {
                  v15 = SrcCh;
                  v17 = strlen(SrcCh) + 1;
                  v13 = v17 - 1;
                }
                goto LABEL_27;
              }
              v17 = (unsigned int)(v12 - 99);
              if ( v12 != 99 )
              {
                if ( v12 != 100 )
                  goto LABEL_27;
LABEL_56:
                v6 |= 0x40u;
LABEL_57:
                v21 = 10;
LABEL_83:
                if ( _bittest(&v6, 0xFu) || _bittest(&v6, 0xCu) )
                {
                  v24 = *(_QWORD *)v3;
                  v25 = (__int64)(v3 + 2);
                }
                else
                {
                  v25 = (__int64)(v3 + 2);
                  if ( (v6 & 0x20) != 0 )
                  {
                    v51 = (int *)v25;
                    if ( (v6 & 0x40) != 0 )
                      v24 = *(__int16 *)(v25 - 8);
                    else
                      v24 = *(unsigned __int16 *)(v25 - 8);
LABEL_94:
                    if ( (v6 & 0x40) != 0 && v24 < 0 )
                    {
                      v24 = -v24;
                      v6 |= 0x100u;
                    }
                    if ( !_bittest(&v6, 0xFu) && !_bittest(&v6, 0xCu) )
                      v24 = (unsigned int)v24;
                    v26 = v43;
                    if ( v43 >= 0 )
                    {
                      v6 &= 0xFFFFFFF7;
                      if ( v43 > 512 )
                        v26 = 512;
                    }
                    else
                    {
                      v26 = 1;
                    }
                    v27 = v53;
                    v28 = &MultiByteString[511];
                    v9 &= -(v24 != 0);
                    v46 = v9;
                    while ( 1 )
                    {
                      v17 = v26--;
                      if ( (int)v17 <= 0 && !v24 )
                        break;
                      v29 = v24 % (unsigned __int64)v21;
                      v24 /= (unsigned __int64)v21;
                      v30 = v29 + 48;
                      if ( (int)v29 + 48 > 57 )
                        v30 += v27;
                      *v28-- = v30;
                    }
                    v5 = v52;
                    v43 = v26;
                    v32 = v31 + 639 - (_DWORD)v28;
                    v15 = v28 + 1;
                    v13 = v32;
                    if ( _bittest(&v6, 9u) && (!v32 || *v15 != 48) )
                    {
                      --v15;
                      v13 = v32 + 1;
                      *v15 = 48;
                    }
                    v10 = v48;
LABEL_27:
                    if ( !v10 )
                    {
                      if ( (v6 & 0x40) != 0 )
                      {
                        if ( _bittest(&v6, 8u) )
                        {
                          v45[0] = 45;
                          goto LABEL_119;
                        }
                        if ( (v6 & 1) != 0 )
                        {
                          v45[0] = 43;
                          goto LABEL_119;
                        }
                        if ( (v6 & 2) != 0 )
                        {
                          v45[0] = 32;
LABEL_119:
                          v9 = 1;
                          v46 = 1;
                        }
                      }
                      v33 = v52;
                      v34 = v7 - v13 - v9;
                      if ( (v6 & 0xC) == 0 )
                      {
                        LOBYTE(v17) = 32;
                        write_multi_char(v17, v34, v52, &v44);
                        v9 = v46;
                      }
                      sub_54898(v45, v9, v33, &v44);
                      if ( (v6 & 8) != 0 && (v6 & 4) == 0 )
                      {
                        LOBYTE(v35) = 48;
                        write_multi_char(v35, v34, v33, &v44);
                      }
                      if ( v50 && v13 > 0 )
                      {
                        v36 = (WCHAR *)v15;
                        v37 = v13;
                        while ( 1 )
                        {
                          --v37;
                          UnicodeString = *v36;
                          v38 = -1;
                          if ( RtlUnicodeToMultiByteN(v59, 6u, &v56, &UnicodeString, 2u) >= 0 )
                          {
                            v38 = v56;
                            v40 = 0;
                          }
                          else
                          {
                            *(_DWORD *)v59 = 0;
                            v60 = 0;
                            v40 = 42;
                          }
                          ++v36;
                          if ( v40 || !v38 )
                            break;
                          sub_54898(v59, v38, v52, &v44);
                          if ( !v37 )
                            goto LABEL_136;
                        }
                        v44 = -1;
LABEL_136:
                        a2 = v57;
                        v14 = v54;
                        v33 = v52;
                      }
                      else
                      {
                        sub_54898(v15, v13, v33, &v44);
                      }
                      if ( (v44 & 0x80000000) == 0 && (v6 & 4) != 0 )
                      {
                        LOBYTE(v39) = 32;
                        write_multi_char(v39, v34, v33, &v44);
                      }
                      v5 = v52;
LABEL_188:
                      v10 = v48;
                      v7 = v47;
                      v9 = v46;
                    }
                    v8 = v43;
                    break;
                  }
                  if ( (v6 & 0x40) != 0 )
                    v24 = *(int *)(v25 - 8);
                  else
                    v24 = *(unsigned int *)(v25 - 8);
                }
                v51 = (int *)v25;
                goto LABEL_94;
              }
LABEL_50:
              v20 = (__int64)(v3 + 2);
              v51 = (int *)v20;
              if ( (v6 & 0x810) != 0 )
              {
                UnicodeString = *(_WORD *)(v20 - 8);
                v13 = -1;
                if ( RtlUnicodeToMultiByteN(MultiByteString, 0x200u, &BytesInMultiByteString, &UnicodeString, 2u) >= 0 )
                {
                  v13 = BytesInMultiByteString;
                  v9 = v46;
                  v7 = v47;
                  v10 = v48;
                }
                else
                {
                  memset(MultiByteString, 0, sizeof(MultiByteString));
                  v9 = v46;
                  v7 = v47;
                  v10 = 1;
                  v48 = 1;
                }
              }
              else
              {
                v13 = 1;
                MultiByteString[0] = *(_BYTE *)(v20 - 8);
              }
              v15 = MultiByteString;
              goto LABEL_27;
            }
LABEL_78:
            v22 = 7;
LABEL_79:
            v53 = v22;
            v21 = 16;
            if ( (v6 & 0x80u) != 0 )
            {
              v45[0] = 48;
              v9 = 2;
              v45[1] = v22 + 81;
            }
            goto LABEL_83;
          }
          if ( (v6 & 0x830) == 0 )
            v6 |= 0x800u;
        }
        v15 = *(CHAR **)v3;
        v18 = v8;
        if ( v8 == -1 )
          v18 = 0x7FFFFFFF;
        v51 = v3 + 2;
        if ( (v6 & 0x810) != 0 )
        {
          v50 = 1;
          if ( !v15 )
            v15 = (CHAR *)off_5A118;
          for ( i = v15; v18; i += 2 )
          {
            --v18;
            if ( !*(_WORD *)i )
              break;
          }
          v17 = (i - v15) >> 1;
        }
        else
        {
          if ( !v15 )
            v15 = SrcCh;
          for ( j = v15; v18; ++j )
          {
            --v18;
            if ( !*j )
              break;
          }
          v17 = (unsigned int)((_DWORD)j - (_DWORD)v15);
        }
        v13 = v17;
        goto LABEL_27;
      default:
        break;
    }
LABEL_190:
    v12 = *a2;
    if ( !*a2 )
      break;
    v3 = v51;
  }
  if ( v14 && v14 != 7 )
  {
LABEL_192:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  return v44;
}
// 54DE9: variable 'v31' is possibly undefined
// 54E6B: variable 'v17' is possibly undefined
// 54EA3: variable 'v35' is possibly undefined
// 54F8E: variable 'v39' is possibly undefined
// 547F0: using guessed type __int64 __fastcall write_char(_QWORD, _QWORD, _QWORD);
// 54840: using guessed type __int64 __fastcall write_multi_char(_QWORD, _QWORD, _QWORD, _QWORD);
// 553EC: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 5A118: using guessed type wchar_t *off_5A118;

//----- (00000000000551D8) ----------------------------------------------------
__int64 __fastcall sub_551D8(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4)
{
  __int64 result; // rax
  unsigned int v7; // edi
  FILE File; // [rsp+30h] [rbp-38h] BYREF

  if ( a2 == -1i64 )
  {
    File._cnt = 0x7FFFFFFF;
  }
  else
  {
    if ( a2 > 0x7FFFFFFF )
    {
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return 0xFFFFFFFFi64;
    }
    File._cnt = a2;
  }
  File._base = a1;
  File._ptr = a1;
  File._flag = 66;
  result = sub_54908((__int64)&File, a3, a4);
  v7 = result;
  a1[a2 - 1] = 0;
  if ( (int)result >= 0 )
  {
    if ( --File._cnt < 0 )
    {
      if ( flsbuf(0, &File) == -1 )
        return 4294967294i64;
    }
    else
    {
      *File._ptr = 0;
    }
    return v7;
  }
  if ( File._cnt < 0 )
    return 4294967294i64;
  if ( a1 )
  {
    if ( a2 )
      *a1 = 0;
  }
  return result;
}
// 553EC: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000005649C) ----------------------------------------------------
__int64 __fastcall sub_5649C(_WORD *a1, __int64 a2, __int16 *a3)
{
  _WORD *v3; // r9
  unsigned int v4; // ebx
  __int16 v5; // ax
  __int64 result; // rax

  v3 = a1;
  if ( a1 && a2 )
  {
    if ( !a3 )
    {
      v4 = 22;
LABEL_9:
      *v3 = 0;
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return v4;
    }
    do
    {
      v5 = *a3++;
      *a1++ = v5;
      if ( !v5 )
        break;
      --a2;
    }
    while ( a2 );
    if ( !a2 )
    {
      v4 = 34;
      goto LABEL_9;
    }
    result = 0i64;
  }
  else
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    result = 22i64;
  }
  return result;
}
// 553EC: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000060008) ----------------------------------------------------
__int64 __fastcall sub_60008(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6)
{
  unsigned int *v6; // r13
  unsigned int v7; // er10
  __int64 v10; // rbp
  unsigned int v11; // ebx
  __int64 v12; // rax
  unsigned int v13; // ecx
  unsigned int v14; // eax
  const void **v15; // r14
  unsigned int v16; // er12
  unsigned int v17; // esi
  _WORD *v18; // rcx
  __m128i *v19; // rdi
  __int64 v20; // rcx
  __m128i v21; // xmm0
  __int64 v22; // rbx
  bool v23; // zf
  __int64 v25; // [rsp+30h] [rbp-38h]
  char v26; // [rsp+70h] [rbp+8h] BYREF

  v6 = a6;
  v7 = 0;
  *a6 = 0;
  if ( a1 <= 3u )
    return (unsigned int)-1073741808;
  if ( a1 <= 5u )
  {
    v22 = a5;
    if ( a5 )
    {
      if ( a3 < 0x30 )
        return (unsigned int)-1073741811;
      do
      {
        if ( RtlCompareMemory(*(const void **)(v22 + 8), a4 + 6, 0x10ui64) == 16 )
          break;
        v22 = *(_QWORD *)(v22 + 16);
      }
      while ( v22 );
      if ( v22 )
      {
        v7 = 0;
        if ( a1 == 5 )
        {
          *(_DWORD *)(v22 + 44) = 0;
          *(_QWORD *)(v22 + 24) = 0i64;
          *(_BYTE *)(v22 + 41) = 0;
        }
        else
        {
          v23 = dword_5A1D8 == 2;
          v25 = *((_QWORD *)a4 + 1);
          *(_QWORD *)(v22 + 24) = v25;
          if ( v23 )
          {
            if ( !(unsigned int)qword_5A1B0(3i64, &v26, 4i64, &a6, a4) )
              *(_BYTE *)(v22 + 41) = v26;
            v7 = qword_5A1B0(2i64, v22 + 44, 4i64, &a6, a4);
          }
          else
          {
            *(_DWORD *)(v22 + 44) = HIDWORD(v25);
            *(_BYTE *)(v22 + 41) = BYTE2(v25);
          }
        }
        return v7;
      }
    }
    return (unsigned int)-1073741163;
  }
  if ( a1 <= 7u )
    return v7;
  if ( a1 != 8 )
    return (unsigned int)-1073741808;
  v10 = a5;
  v11 = 0;
  v12 = a5;
  if ( dword_5A1D8 == 1 )
  {
    v13 = a4[4];
    if ( v13 > 1 )
    {
      v14 = 32 * v13 + 24;
      if ( v14 <= a3 )
      {
        *(__m128i *)&a4[8 * v13 - 2] = _mm_loadu_si128((const __m128i *)*(_QWORD *)(a5 + 8));
        a4[8 * a4[4] + 2] = 528384;
        *(_DWORD *)(v10 + 44) = 0;
        *(_BYTE *)(v10 + 41) = 0;
        return v7;
      }
      v7 = -1073741789;
      if ( a3 >= 4 )
      {
        *a4 = v14;
LABEL_10:
        *v6 = 4;
        return v7;
      }
      return v7;
    }
  }
  v15 = *(const void ***)(a5 + 32);
  do
  {
    v12 = *(_QWORD *)(v12 + 16);
    ++v11;
  }
  while ( v12 );
  if ( v11 > 0x3F )
    return (unsigned int)-1073741811;
  if ( v15 )
  {
    v16 = 32 * v11 + 24;
    v17 = *(unsigned __int16 *)v15 + v16 + 2;
  }
  else
  {
    v16 = 0;
    v17 = 32 * v11 + 24;
  }
  if ( v17 > a3 )
  {
    v7 = -1073741789;
    if ( a3 < 4 )
      return v7;
    *a4 = v17;
    goto LABEL_10;
  }
  memset(a4, 0, a3);
  *a4 = v17;
  a4[2] = v16;
  a4[4] = v11;
  if ( v15 )
  {
    v18 = (_WORD *)((char *)a4 + v16);
    *v18 = *(_WORD *)v15;
    memmove(v18 + 1, v15[1], *(unsigned __int16 *)v15);
  }
  if ( v11 )
  {
    v19 = (__m128i *)(a4 + 10);
    v20 = v11;
    do
    {
      v21 = _mm_loadu_si128((const __m128i *)*(_QWORD *)(v10 + 8));
      v19->m128i_i32[0] = 528384;
      v19 += 2;
      v19[-3] = v21;
      *(_DWORD *)(v10 + 44) = 0;
      --v20;
      *(_BYTE *)(v10 + 41) = 0;
      v10 = *(_QWORD *)(v10 + 16);
    }
    while ( v20 );
  }
  v7 = 0;
  *v6 = v17;
  return v7;
}
// 5A1B0: using guessed type __int64 (__fastcall *qword_5A1B0)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 5A1D8: using guessed type int dword_5A1D8;

//----- (00000000000602B4) ----------------------------------------------------
void __fastcall sub_602B4(struct _DEVICE_OBJECT *a1)
{
  PDEVICE_OBJECT v1; // rbx
  ULONG v2; // edx

  v1 = off_5A148;
  if ( off_5A148 != (PDEVICE_OBJECT)&off_5A148 )
  {
    if ( dword_5A1D8 == 4 )
    {
      while ( v1 )
      {
        if ( v1->Vpb )
          qword_5A1C0();
        v1 = v1->NextDevice;
      }
    }
    else
    {
      v2 = 2;
      if ( dword_5A1D8 == 2 )
      {
        v2 = -2147483646;
        a1 = off_5A148;
      }
      IoWMIRegistrationControl(a1, v2);
    }
    off_5A148 = (PDEVICE_OBJECT)&off_5A148;
  }
}
// 5A1C0: using guessed type __int64 (*qword_5A1C0)(void);
// 5A1D8: using guessed type int dword_5A1D8;

// nfuncs=637 queued=607 decompiled=607 lumina nreq=0 worse=0 better=0
// ALL OK, 607 function(s) have been successfully decompiled
