/* This file was generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2020 Hex-Rays <info@hex-rays.com>

   Detected compiler: Visual C++
*/

#include <windows.h>
#include <defs.h>

#include <stdarg.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall sub_11008(__int64 a1, unsigned __int16 a2, __int64 a3);
__int64 __fastcall sub_1102C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_11068(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4);
__int64 __fastcall sub_110E8(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_1113C(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_111B4(__int64 a1, __int64 a2, __int64 a3, __int16 a4, __int64 a5);
__int64 __fastcall sub_11308(__int64 a1, char a2, __int64 *a3, __int64 a4);
NTSTATUS __stdcall DriverEntry(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath);
void __fastcall sub_11814(PDEVICE_OBJECT DeviceObject);
__int64 __fastcall sub_11A74(__int64 a1, IRP *a2);
__int64 __fastcall sub_11A9C(__int64 a1, __int64 a2);
__int64 sub_11CB4();
void sub_11F18();
__int64 sub_11F68();
__int64 sub_12080();
__int64 sub_12344();
__int64 sub_12620();
__int64 sub_129B0();
__int64 sub_12D20();
__int64 sub_12FC4();
__int64 __fastcall sub_131EC(char a1);
char __fastcall sub_132AC(int a1, _DWORD *a2, _DWORD *a3, _DWORD *a4);
__int64 __fastcall sub_133F0(__int64 a1);
void __fastcall sub_134E4(const signed __int32 *a1);
__int64 sub_1369C();
__int64 __fastcall sub_139F8(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_13A40(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_13A94();
void sub_13D60();
__int64 __fastcall sub_13E40(__m128i *a1);
__int64 sub_13F38();
__int64 __fastcall sub_13FF0(int a1);
__int64 __fastcall sub_14198(__int64 a1, __int64 a2);
__int64 __fastcall sub_14340(int a1, __int64 a2, int a3);
__int64 __fastcall sub_14570(__int64 a1, int a2);
__int64 __fastcall sub_14728(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_147C8(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14804(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14860(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_14930(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_149BC(__int64 a1, __int64 a2, __int64 a3, const wchar_t *a4);
__int64 __fastcall sub_14A60(__int64 a1, __int64 a2, __int64 a3, const wchar_t *a4, char a5, char a6, char a7, const char *a8);
__int64 __fastcall sub_14B68(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_14BB4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_14C1C(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 sub_14C80(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14CC4(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_14D0C(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_14D60(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_14DC0(__int64 a1, __int64 a2, __int64 a3, const char *a4);
__int64 __fastcall sub_14E58(int a1, __int64 a2, __int64 a3, __int64 a4, int *a5);
__int64 __fastcall sub_15F84(__int64 a1, __int64 a2);
__int64 __fastcall sub_166E8(void *a1, __int64 a2, const void *a3);
__int64 __fastcall sub_16808(int a1, __int64 a2);
__int64 __fastcall sub_16928(unsigned __int64 *a1, char a2);
__int64 __fastcall sub_16B60(int a1, _QWORD *a2);
__int64 __fastcall sub_16C80(int a1, int *a2);
__int64 sub_16E04();
__int64 __fastcall sub_16F38(_QWORD *a1);
__int64 __fastcall sub_17250(int a1, __int64 a2);
__int64 __fastcall sub_17374(__int64 a1);
__int64 __fastcall sub_175D4(__int64 a1, _QWORD *a2);
__int64 __fastcall sub_1778C(__int64 a1, __m128i *a2);
__int64 __fastcall sub_178C8(__int64 a1, __m128i *a2, _BYTE *a3);
__int64 __fastcall sub_17B0C(__int64 a1, _WORD *a2, _BYTE *a3);
__int64 __fastcall sub_17D44(__int64 a1, __m128i *a2);
__int64 __fastcall sub_17E7C(__int64 a1, __m128i *a2, _BYTE *a3);
__int64 __fastcall sub_180C0(__int64 a1, _WORD *a2);
__int64 __fastcall sub_182E4(__int64 a1, __int64 a2, __int64 *a3);
void __fastcall sub_18600(__int64 a1);
__int64 __fastcall sub_18DBC(__int64 a1);
char __fastcall sub_19050(unsigned __int16 a1, __int16 a2, __int64 a3);
__int64 __fastcall sub_191F0(__int64 *a1, __int64 a2);
__int64 __fastcall sub_193D0(__int64 a1);
__int64 __fastcall sub_19598(unsigned __int16 *a1);
void __fastcall sub_197D4(__int64 a1);
__int64 sub_19C30(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_19D44();
__int64 sub_19F48();
__int64 __fastcall sub_19FF8(unsigned __int64 *a1, __int64 a2, ULONG_PTR **a3);
__int64 __fastcall sub_1A17C(unsigned __int64 *a1, __int64 *a2, _QWORD *a3);
void __fastcall sub_1A1D4(__int64 a1);
__int64 sub_1A204();
__int64 __fastcall sub_1A2D4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_1A328(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, const char *a5, const char *a6);
__int64 __fastcall sub_1A3F8(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5, const char *a6, PVOID a7, PVOID a8);
__int64 __fastcall sub_1A50C(__int64 a1, _QWORD *a2);
__int64 __fastcall sub_1A974(int *a1);
__int64 __fastcall sub_1AFB8(__int64 a1, unsigned __int16 a2);
PVOID __fastcall sub_1B038(int a1, unsigned int a2, ULONG a3);
void __fastcall sub_1B0BC(PVOID P, ULONG Tag);
PVOID __fastcall sub_1B130(__int64 a1, void *a2, unsigned int a3, unsigned int a4);
char *__fastcall sub_1B2A4(__int64 a1, unsigned int a2);
void __fastcall sub_1B458(PVOID P);
_DWORD *__fastcall sub_1B578(__int64 a1);
void __fastcall sub_1B5E0(__int64 a1, __int64 a2);
__int64 __fastcall sub_1B70C(PERESOURCE Resource); // idb
__int64 __fastcall sub_1B7E0(PERESOURCE Resource); // idb
BOOLEAN __fastcall sub_1B8B4(PERESOURCE Resource);
BOOLEAN __fastcall sub_1B98C(PERESOURCE Resource);
void __fastcall sub_1BA64(PERESOURCE Resource);
void __fastcall sub_1BB30(PKSPIN_LOCK SpinLock, KIRQL *a2);
void __fastcall sub_1BBA8(PKSPIN_LOCK SpinLock, KIRQL a2);
int __fastcall sub_1BC1C(PRKEVENT Event);
int __fastcall sub_1BC84(PRKEVENT Event);
void __fastcall sub_1BD50(__int64 a1);
void __fastcall sub_1BE30(PFAST_MUTEX FastMutex);
void __fastcall sub_1BEFC(PFAST_MUTEX FastMutex);
_QWORD *sub_1BFC8();
void __fastcall sub_1C134(__int64 a1);
__int64 __fastcall sub_1C1A0(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_1C230(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_1C2CC(__int64 a1, __int64 a2, __int64 a3, int a4);
PVOID __fastcall sub_1C35C(int a1, unsigned int a2, ULONG a3);
void __fastcall sub_1C478(PVOID P, ULONG Tag);
_DWORD *__fastcall sub_1C570(__int64 a1);
__int64 __fastcall sub_1C674(_QWORD *a1);
void __fastcall sub_1C6F8(PKSPIN_LOCK SpinLock, KIRQL *a2);
void __fastcall sub_1C7B0(PKSPIN_LOCK SpinLock, KIRQL a2);
bool __fastcall sub_1C854(struct _KEVENT **a1, char a2);
void __fastcall sub_1C93C(PVOID P);
int __fastcall sub_1C9D4(PRKEVENT Event);
void __fastcall HandleInformation(PVOID StartContext);
unsigned __int8 __fastcall sub_1CB00(PVOID *Object, __int64 a2, __int64 (__fastcall *a3)(void ***a1));
__int64 __fastcall sub_1CC68(PVOID Object); // idb
__int64 __fastcall sub_1CCFC(void ***a1);
__int64 __fastcall sub_1D008(unsigned int a1);
__int64 __fastcall sub_1D250(PVOID P); // idb
void __fastcall sub_1D5AC(__int64 a1, char a2);
void __fastcall sub_1D670(__int64 a1);
__int64 __fastcall sub_1D754(PVOID Object); // idb
__int64 __fastcall sub_1D7FC(ULONG Count, PVOID Object[]); // idb
void __fastcall DeferredRoutine(_KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2);
__int64 sub_1D93C();
__int64 __fastcall sub_1DA70(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6, int a7);
__int64 __fastcall sub_1DAE0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_1DB3C(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_1DBAC(__int64 a1, unsigned __int16 a2);
__int64 __fastcall sub_1DC14(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 sub_1DC74(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_1DCC0(__int64 a1, __int64 a2, _QWORD *a3);
__int64 sub_1E190();
__int64 (**sub_1E4D8())(void);
__int64 __fastcall sub_1E604(unsigned int a1);
__int64 sub_1E870();
char *sub_1EAD4();
__int64 __fastcall sub_1ECA4(__int64 a1);
__int64 sub_1F25C();
__int64 __fastcall sub_1F928(unsigned int a1, int a2, unsigned int a3, _DWORD *a4);
__int64 __fastcall sub_1FF20(__int64 a1, unsigned int a2, __int64 a3);
__int64 __fastcall sub_202E4(int a1);
__int64 __fastcall sub_20440(int a1);
__int64 __fastcall sub_20568(__int64 a1, __int64 a2, __int64 a3, const wchar_t *a4);
__int64 sub_20618(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_20684(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 sub_206F0(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_20778(__int16 *a1, int a2, unsigned int *a3);
__int64 __fastcall sub_2094C(char a1);
__int64 __fastcall sub_209E8(int a1, int a2);
__int64 sub_20BC8();
__int64 sub_20DB0();
__int64 __fastcall sub_20F70(int a1, const void *a2, unsigned int a3, __int64 a4, int *a5);
__int64 __fastcall sub_211B4(__int64 a1, void *a2, unsigned int a3, int a4, int *a5);
__int64 __fastcall sub_2136C(unsigned int a1, __int64 a2);
__int64 sub_214BC();
__int64 sub_2172C();
__int64 __fastcall sub_219B4(int a1);
__int64 sub_21D78();
__int64 sub_224DC();
__int64 __fastcall sub_2283C(int a1, const void *a2, unsigned int a3, __int64 a4, int *a5);
__int64 __fastcall sub_22B50(__int64 a1, void *a2, unsigned int a3, int a4, int *a5);
__int64 __fastcall sub_2309C(int a1, const void *a2, unsigned int a3, _DWORD *a4);
__int64 __fastcall sub_232F0(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_23548(unsigned int *a1);
__int64 __fastcall sub_236A4(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_23790(__int64 a1, int a2, unsigned int a3, void *a4);
__int64 __fastcall sub_2398C(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_23C00(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_23F18(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_240F8(int a1);
__int64 __fastcall sub_241E8(int a1, __int64 a2);
__int64 __fastcall sub_243E0(int a1, const void *a2, unsigned int a3);
__int64 __fastcall sub_246EC(__int64 a1, __int64 a2, __int64 a3);
__int64 sub_24890();
__int64 __fastcall sub_24988(__int64 a1, _QWORD *a2, unsigned int *a3);
__int64 __fastcall sub_24DCC(PVOID *a1);
__int64 __fastcall sub_24EDC(__int64 a1, _BYTE *a2);
__int64 __fastcall sub_24FB8(__int64 a1, _BYTE *a2);
bool __fastcall sub_25094(__int64 a1);
void __fastcall sub_25138(__int64 a1);
char __fastcall sub_251B0(PFAST_MUTEX FastMutex);
char __fastcall sub_25210(PFAST_MUTEX FastMutex);
char __fastcall sub_252B8(PFAST_MUTEX FastMutex);
char __fastcall sub_25320(PFAST_MUTEX FastMutex);
const char *__fastcall sub_25384(int a1);
const char *__fastcall sub_253E8(unsigned int a1);
const char *__fastcall sub_25460(int a1);
const char *__fastcall sub_25538(unsigned int a1);
const char *__fastcall sub_255BC(int a1);
__int64 __fastcall sub_25618(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_2575C(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5, const char *a6);
__int64 __fastcall sub_25824(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, const char *a5);
__int64 sub_258AC(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 __fastcall sub_2590C(_BYTE *a1, _BYTE *a2);
__int64 __fastcall sub_259BC(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_25A6C(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_25B1C(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_25BE0(__int64 a1, unsigned __int16 *a2);
__int64 __fastcall sub_25CA8(__int64 a1, unsigned __int8 *a2);
__int64 __fastcall sub_25D5C(__int64 a1, __m128i *a2);
__int64 __fastcall sub_25E10(__int64 a1, __m128i *a2);
__int64 __fastcall sub_25F6C(_BYTE *a1, __m128i *a2);
__int64 __fastcall sub_263D8(_WORD *a1, _WORD *a2);
__int64 __fastcall sub_2649C(__int64 a1, _WORD *a2);
__int64 __fastcall sub_26560(_WORD *a1, _WORD *a2);
__int64 __fastcall sub_26624(__int64 a1, _WORD *a2);
__int64 __fastcall sub_266E8(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_2687C(__int64 a1, unsigned int a2, unsigned __int16 *a3);
__int64 __fastcall sub_26A94(__int64 a1, int a2, __int64 a3);
__int64 __fastcall sub_26D04(__int64 a1, __int64 a2, unsigned __int64 *a3);
__int64 __fastcall sub_27050(__int64 a1);
bool __fastcall sub_27250(char a1, char *a2);
const char *__fastcall sub_27398(unsigned __int8 a1);
__int64 __fastcall sub_27488(__int64 a1, const void *a2, size_t a3);
_WORD *__fastcall sub_275E8(_WORD *a1, unsigned __int16 *a2);
__int64 sub_276A4(__int64 a1, unsigned __int16 a2, __int64 a3, ...);
__int64 sub_276F4(__int64 a1, __int64 a2, __int64 a3, ...);
__int64 __fastcall sub_27758(__int64 a1, unsigned __int16 a2, __int64 a3, int a4);
__int64 __fastcall sub_277B4(__int64 a1, __int64 a2, __int64 a3, int a4);
__int64 __fastcall sub_27824(int a1, _QWORD *a2);
__int64 __fastcall sub_27A08(int a1, __int64 a2);
__int64 __fastcall sub_27B68(int a1, struct _FAST_MUTEX *a2, KIRQL *a3);
__int64 __fastcall sub_27C2C(int a1, struct _FAST_MUTEX *a2, KIRQL a3);
__int64 __fastcall sub_27CC0(__int64 a1, __int64 a2, char a3);
__int64 __fastcall sub_27DEC(__int64 a1, __int64 a2, char a3);
_DWORD *__fastcall sub_27F10(unsigned __int8 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, int a6, int a7, int a8, int a9, int a10, _DWORD *a11);
__int64 __fastcall sub_281E0(__int64 a1, char a2);
__int64 __fastcall sub_28674(__int64 a1);
unsigned __int64 __fastcall sub_2895C(__int64 a1, unsigned __int64 a2, _DWORD *a3);
_DWORD *__fastcall sub_28A58(__int64 a1, __int64 a2, _DWORD *a3);
__int64 __fastcall sub_28BE0(__int64 a1, unsigned int a2, __int64 *a3);
__int64 __fastcall sub_28DDC(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall sub_28F5C(__int64 a1, __int64 a2, char a3);
__int64 __fastcall sub_291A8(__int64 a1, _DWORD *a2);
__int64 __fastcall sub_292A0(__int64 a1, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4);
__int64 __fastcall sub_294DC(__int64 a1, unsigned __int64 a2, __int64 a3, _DWORD *a4);
__int64 __fastcall sub_29768(__int64 a1, unsigned __int64 a2, _QWORD *a3, _DWORD *a4);
_QWORD *__fastcall sub_2995C(__int64 a1, unsigned int a2, __int64 a3, _DWORD *a4);
ULONG_PTR __fastcall sub_29B1C(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4, __int64 a5);
__int64 __fastcall sub_29FA4(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1); // idb
__int64 __fastcall sub_2A148(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3);
__int64 __fastcall sub_2A28C(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3);
char __fastcall sub_2A408(_BYTE *a1, _DWORD *a2);
char __fastcall sub_2A554(_BYTE *a1, _DWORD *a2);
char __fastcall sub_2A6A0(_BYTE *a1, _DWORD *a2);
__int64 __fastcall sub_2A7EC(__int64 a1);
__int64 __fastcall sub_2AC1C(__int64 a1, ULONG_PTR a2, __int64 a3);
__int64 __fastcall sub_2ADF4(unsigned int a1);
char __fastcall sub_2AF24(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1);
__int64 __fastcall sub_2AF7C(_QWORD *a1, _QWORD *a2);
void __fastcall sub_2B100(PVOID P);
__int64 __fastcall sub_2B170(__int64 a1, __int64 a2);
__int64 __fastcall sub_2B1B4(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, void *Src);
__int64 __fastcall sub_2B318(_WORD *a1, __int64 a2, __int16 *a3);
__int64 __fastcall sub_2B3C0(_WORD *a1, __int64 a2, __int16 *a3, __int64 a4);
__int64 __fastcall sub_2B4C8(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4);
__int64 sub_2B518(char *a1, unsigned __int64 a2, CHAR *a3, ...);
__int64 __fastcall sub_2B53C(char *a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int16 *a4, int *a5);
__int64 sub_2B5E4(char *a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int16 *a4, ...);
__int64 __fastcall sub_2B608(void *a1, size_t a2, const void *a3, size_t a4);
// __int64 __fastcall write_char(_QWORD, _QWORD, _QWORD); weak
// __int64 __fastcall write_multi_char(_QWORD, _QWORD, _QWORD, _QWORD); weak
__int64 __fastcall sub_2B754(_BYTE *a1, int a2, __int64 a3, _DWORD *a4);
// int __cdecl mbtowc(wchar_t *DstCh, const char *SrcCh, size_t SrcSizeInBytes);
__int64 __fastcall sub_2B81C(__int64 a1, CHAR *a2, __int64 a3);
__int64 __fastcall sub_2C0EC(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4);
_WORD *__fastcall sub_2C1BC(__int16 a1, __int64 a2, _DWORD *a3);
_WORD *__fastcall sub_2C20C(__int16 *a1, int a2, __int64 a3, _DWORD *a4);
__int64 __fastcall sub_2C26C(__int64 a1, unsigned __int16 *a2, int *a3);
__int64 __fastcall sub_2CB50(char *a1, unsigned __int64 a2, unsigned __int16 *a3, int *a4);
// int __cdecl flsbuf(int Ch, FILE *File);
__int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // weak
// void *__cdecl memmove(void *Dst, const void *Src, size_t MaxCount);
// void *__cdecl memset(void *Dst, int Val, size_t Size);
// NTSTATUS __stdcall RtlUnicodeToMultiByteN(PCHAR MultiByteString, ULONG MaxBytesInMultiByteString, PULONG BytesInMultiByteString, PCWCH UnicodeString, ULONG BytesInUnicodeString);
// int __cdecl tolower(int C);
__int64 __fastcall sub_2D184(_WORD *a1, __int64 a2, __int16 *a3);
// void __stdcall KeStallExecutionProcessor(ULONG MicroSeconds);
// LARGE_INTEGER __stdcall KeQueryPerformanceCounter(PLARGE_INTEGER PerformanceFrequency);
// void __stdcall ExFreePoolWithTag(PVOID P, ULONG Tag);
// NTSTATUS __stdcall IoWMIWriteEvent(PVOID WnodeEventItem);
// void KeLeaveCriticalRegion(void);
// void __stdcall RtlInitUnicodeString(PUNICODE_STRING DestinationString, PCWSTR SourceString);
// void __stdcall IoDeleteDevice(PDEVICE_OBJECT DeviceObject);
// PVOID __stdcall MmGetSystemRoutineAddress(PUNICODE_STRING SystemRoutineName);
// void __stdcall KeInitializeEvent(PRKEVENT Event, EVENT_TYPE Type, BOOLEAN State);
// void KeEnterCriticalRegion(void);
// NTSTATUS __stdcall IoGetDeviceObjectPointer(PUNICODE_STRING ObjectName, ACCESS_MASK DesiredAccess, PFILE_OBJECT *FileObject, PDEVICE_OBJECT *DeviceObject);
// NTSTATUS __stdcall ZwQueryValueKey(HANDLE KeyHandle, PUNICODE_STRING ValueName, KEY_VALUE_INFORMATION_CLASS KeyValueInformationClass, PVOID KeyValueInformation, ULONG Length, PULONG ResultLength);
// NTSTATUS __stdcall ZwClose(HANDLE Handle);
// void __stdcall IofCompleteRequest(PIRP Irp, CCHAR PriorityBoost);
// NTSTATUS __stdcall KeWaitForSingleObject(PVOID Object, KWAIT_REASON WaitReason, KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Timeout);
// SIZE_T __stdcall RtlCompareMemory(const void *Source1, const void *Source2, SIZE_T Length);
// LONG_PTR __stdcall ObfDereferenceObject(PVOID Object);
// NTSTATUS __stdcall IoCreateDevice(PDRIVER_OBJECT DriverObject, ULONG DeviceExtensionSize, PUNICODE_STRING DeviceName, ULONG DeviceType, ULONG DeviceCharacteristics, BOOLEAN Exclusive, PDEVICE_OBJECT *DeviceObject);
// NTSTATUS __stdcall IofCallDriver(PDEVICE_OBJECT DeviceObject, PIRP Irp);
// NTSTATUS __stdcall ZwOpenKey(PHANDLE KeyHandle, ACCESS_MASK DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes);
// NTSTATUS __stdcall RtlUnicodeStringToInteger(PCUNICODE_STRING String, ULONG Base, PULONG Value);
// int __cdecl wcsicmp(const wchar_t *Str1, const wchar_t *Str2);
// wchar_t *__cdecl wcsrchr(const wchar_t *Str, wchar_t Ch);
// void __stdcall __noreturn KeBugCheckEx(ULONG BugCheckCode, ULONG_PTR BugCheckParameter1, ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter3, ULONG_PTR BugCheckParameter4);
// BOOLEAN __stdcall ExAcquireResourceExclusiveLite(PERESOURCE Resource, BOOLEAN Wait);
// void __stdcall KeClearEvent(PRKEVENT Event);
// LONG __stdcall KeResetEvent(PRKEVENT Event);
// void __stdcall ExReleaseFastMutex(PFAST_MUTEX FastMutex);
// void __stdcall ExInitializeNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside, PALLOCATE_FUNCTION Allocate, PFREE_FUNCTION Free, ULONG Flags, SIZE_T Size, ULONG Tag, USHORT Depth);
// void __stdcall ExAcquireFastMutex(PFAST_MUTEX FastMutex);
// LONG __stdcall KeSetEvent(PRKEVENT Event, KPRIORITY Increment, BOOLEAN Wait);
// PSLIST_ENTRY __stdcall ExpInterlockedPushEntrySList(PSLIST_HEADER ListHead, PSLIST_ENTRY ListEntry);
// void __stdcall KeReleaseSpinLock(PKSPIN_LOCK SpinLock, KIRQL NewIrql);
// PIRP __stdcall IoBuildDeviceIoControlRequest(ULONG IoControlCode, PDEVICE_OBJECT DeviceObject, PVOID InputBuffer, ULONG InputBufferLength, PVOID OutputBuffer, ULONG OutputBufferLength, BOOLEAN InternalDeviceIoControl, PKEVENT Event, PIO_STATUS_BLOCK IoStatusBlock);
// void __stdcall KeReleaseSpinLockFromDpcLevel(PKSPIN_LOCK SpinLock);
// void __stdcall ExDeletePagedLookasideList(PPAGED_LOOKASIDE_LIST Lookaside);
// NTSTATUS __stdcall PsCreateSystemThread(PHANDLE ThreadHandle, ULONG DesiredAccess, POBJECT_ATTRIBUTES ObjectAttributes, HANDLE ProcessHandle, PCLIENT_ID ClientId, PKSTART_ROUTINE StartRoutine, PVOID StartContext);
// NTSTATUS __stdcall PsTerminateSystemThread(NTSTATUS ExitStatus);
// BOOLEAN __stdcall ExAcquireResourceSharedLite(PERESOURCE Resource, BOOLEAN Wait);
// void __stdcall ExReleaseResourceLite(PERESOURCE Resource);
// USHORT __stdcall ExQueryDepthSList(PSLIST_HEADER SListHead);
// NTSTATUS __stdcall ObReferenceObjectByHandle(HANDLE Handle, ACCESS_MASK DesiredAccess, POBJECT_TYPE ObjectType, KPROCESSOR_MODE AccessMode, PVOID *Object, POBJECT_HANDLE_INFORMATION HandleInformation);
// NTSTATUS __stdcall ExDeleteResourceLite(PERESOURCE Resource);
// void __stdcall ExInitializePagedLookasideList(PPAGED_LOOKASIDE_LIST Lookaside, PALLOCATE_FUNCTION Allocate, PFREE_FUNCTION Free, ULONG Flags, SIZE_T Size, ULONG Tag, USHORT Depth);
// NTSTATUS __stdcall ExInitializeResourceLite(PERESOURCE Resource);
// NTSTATUS __stdcall KeWaitForMultipleObjects(ULONG Count, PVOID Object[], WAIT_TYPE WaitType, KWAIT_REASON WaitReason, KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Timeout, PKWAIT_BLOCK WaitBlockArray);
// void __stdcall KeAcquireSpinLockAtDpcLevel(PKSPIN_LOCK SpinLock);
// void __stdcall ExDeleteNPagedLookasideList(PNPAGED_LOOKASIDE_LIST Lookaside);
// KIRQL __stdcall KeAcquireSpinLockRaiseToDpc(PKSPIN_LOCK SpinLock);
// void __stdcall KeInitializeDpc(PRKDPC Dpc, PKDEFERRED_ROUTINE DeferredRoutine, PVOID DeferredContext);
// void __stdcall KeInitializeTimer(PKTIMER Timer);
// BOOLEAN __stdcall KeSetTimer(PKTIMER Timer, LARGE_INTEGER DueTime, PKDPC Dpc);
// BOOLEAN __stdcall KeCancelTimer(PKTIMER);
// NTSTATUS __stdcall KeDelayExecutionThread(KPROCESSOR_MODE WaitMode, BOOLEAN Alertable, PLARGE_INTEGER Interval);
// NTSTATUS __stdcall IoWMIRegistrationControl(PDEVICE_OBJECT DeviceObject, ULONG Action);
// PSLIST_ENTRY __stdcall ExpInterlockedPopEntrySList(PSLIST_HEADER ListHead);
// PVOID __stdcall ExAllocatePoolWithTag(POOL_TYPE PoolType, SIZE_T NumberOfBytes, ULONG Tag);
__int64 __fastcall sub_35008(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6);

//-------------------------------------------------------------------------
// Data declarations

_UNKNOWN loc_1517E; // weak
_UNKNOWN loc_20017; // weak
__int64 qword_2D340[2] = { -3689348818177884068i64, -3689348814741910324i64 }; // weak
__int64 qword_2D460[2] = { -3689348814741910528i64, -3689348814741910324i64 }; // weak
__int64 qword_2D5F0[2] = { -3689348814741962752i64, -3689348814741910324i64 }; // weak
unsigned __int8 byte_2E230[352] =
{
  6u,
  128u,
  128u,
  134u,
  128u,
  129u,
  128u,
  0u,
  0u,
  16u,
  3u,
  134u,
  128u,
  134u,
  130u,
  128u,
  20u,
  5u,
  5u,
  69u,
  69u,
  69u,
  133u,
  133u,
  133u,
  5u,
  0u,
  0u,
  48u,
  48u,
  128u,
  80u,
  128u,
  128u,
  0u,
  8u,
  0u,
  32u,
  32u,
  48u,
  80u,
  87u,
  128u,
  0u,
  7u,
  0u,
  55u,
  48u,
  48u,
  80u,
  80u,
  136u,
  0u,
  0u,
  0u,
  32u,
  40u,
  128u,
  136u,
  128u,
  128u,
  0u,
  0u,
  0u,
  96u,
  96u,
  96u,
  104u,
  104u,
  96u,
  0u,
  0u,
  7u,
  120u,
  112u,
  112u,
  119u,
  112u,
  112u,
  8u,
  8u,
  0u,
  0u,
  8u,
  0u,
  8u,
  0u,
  7u,
  8u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u
}; // idb
_UNKNOWN unk_2EB00; // weak
_UNKNOWN unk_2EB10; // weak
_UNKNOWN unk_2EB20; // weak
_UNKNOWN unk_2EB30; // weak
_UNKNOWN unk_2EB40; // weak
_DWORD dword_2EB50[34] =
{
  1,
  11,
  23,
  53,
  97,
  193,
  389,
  769,
  1543,
  3079,
  6151,
  12289,
  24593,
  49157,
  98317,
  196613,
  393241,
  786433,
  1572869,
  3145739,
  6291469,
  12582917,
  25165843,
  50331653,
  100663319,
  201326611,
  402653189,
  805306457,
  1610612741,
  0,
  1084330466,
  1816461455,
  -1802566491,
  -1437030694
}; // idb
_UNKNOWN unk_2EBD8; // weak
_UNKNOWN unk_2EBE8; // weak
_UNKNOWN unk_2EBF8; // weak
_UNKNOWN unk_2EC08; // weak
_UNKNOWN unk_2EC18; // weak
_UNKNOWN unk_2EC38; // weak
_UNKNOWN unk_2EC48; // weak
_UNKNOWN unk_2EC58; // weak
_UNKNOWN unk_2EC68; // weak
_UNKNOWN unk_2EC78; // weak
_UNKNOWN unk_2EC88; // weak
_UNKNOWN unk_2EC98; // weak
_UNKNOWN unk_2ECA8; // weak
_UNKNOWN unk_2ECDA; // weak
char *SrcCh = "(null)"; // idb
wchar_t *off_30118 = L"(null)"; // weak
int dword_30120 = 1; // weak
void *off_30148 = &off_30148; // weak
char aUnknownModule[15] = "Unknown module"; // weak
wchar_t aPiccreceivedpa[20] = L"PICCReceivedPackets"; // weak
__int64 (__fastcall *qword_30390)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (*qword_303A0)(void) = NULL; // weak
__int64 (__fastcall *qword_303A8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
__int64 (__fastcall *qword_303B0)(_QWORD, _QWORD, _QWORD, _QWORD) = NULL; // weak
int dword_303B8 = 0; // weak
char byte_303C0[4] = { '\0', '\0', '\0', '\0' }; // idb
char byte_303C4[4] = { '\0', '\0', '\0', '\0' }; // idb
char byte_303C8[4] = { '\0', '\0', '\0', '\0' }; // idb
int dword_303CC = 0; // weak
PVOID qword_303D0 = NULL; // idb
__int64 qword_303D8 = 0i64; // weak
struct _ERESOURCE Resource = { { NULL, NULL }, NULL, 0, { 0u },  }; // idb
char byte_30448; // weak
char byte_30449; // weak
char byte_3044A; // weak
char byte_3044B; // weak
char byte_3044C; // weak
char byte_3044D; // weak
PVOID P; // idb
PVOID Timeout; // idb
_UNKNOWN unk_30460; // weak
__int16 word_3049C; // weak
int dword_304A0; // weak
int dword_304A4; // weak
ULONG_PTR qword_304A8; // idb
PVOID qword_304B0; // idb
PVOID qword_304B8; // idb
struct _ERESOURCE stru_304C0; // idb
PVOID qword_30528; // idb
struct _ERESOURCE stru_30530; // idb
PVOID qword_305B0; // idb
__int64 qword_305B8; // weak
union _LARGE_INTEGER PerformanceFrequency; // idb
PVOID qword_32BA8; // idb
PVOID qword_32BB0; // idb
__int64 qword_32BB8; // weak
PVOID qword_32BC0; // idb
__int64 qword_32BC8; // weak
_WORD word_32BD0[520]; // idb
int dword_32FE0; // weak
PVOID qword_32FE8; // idb
__int64 qword_32FF0; // weak
PVOID qword_32FF8; // idb
PVOID qword_33000; // idb
int dword_33008; // weak
int dword_3300C; // weak
char byte_33010; // weak
char byte_33011; // weak
char byte_33012; // weak
char byte_33013; // weak
char byte_33014; // weak
__int64 (__fastcall *qword_33018)(_QWORD); // weak
__int64 qword_33020; // weak
__int64 qword_33028; // weak
__int64 qword_33030; // weak
__int64 qword_33038; // weak
__int64 qword_33040; // weak
struct _FAST_MUTEX FastMutex; // idb
__int64 qword_33098; // weak
struct _KDPC Dpc; // idb
struct _KTIMER Timer; // idb
__int64 qword_33120; // weak
__int64 qword_33128; // weak
__int64 qword_33130; // weak
__int64 qword_33140; // weak
char byte_33148; // weak
char byte_33149; // weak
__int16 word_3314A; // weak
int dword_3314C; // weak
__int64 qword_33160; // weak
__int64 qword_33168; // weak
__int64 qword_33170; // weak
__int64 qword_33180; // weak
char byte_33188; // weak
char byte_33189; // weak
__int16 word_3318A; // weak
int dword_3318C; // weak
__int64 qword_331A0; // weak
__int64 qword_331A8; // weak
__int64 qword_331B0; // weak
__int64 qword_331C0; // weak
char byte_331C8; // weak
char byte_331C9; // weak
__int16 word_331CA; // weak
int dword_331CC; // weak
__int64 qword_331E0; // weak
__int64 qword_331E8; // weak
__int64 qword_331F0; // weak
__int64 qword_33200; // weak
char byte_33208; // weak
char byte_33209; // weak
__int16 word_3320A; // weak
int dword_3320C; // weak


//----- (0000000000011008) ----------------------------------------------------
__int64 __fastcall sub_11008(__int64 a1, unsigned __int16 a2, __int64 a3)
{
  return qword_30398(a1, 43i64, a3, a2, 0i64);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001102C) ----------------------------------------------------
__int64 __fastcall sub_1102C(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+68h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, a3, a2, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011068) ----------------------------------------------------
__int64 __fastcall sub_11068(__int64 a1, unsigned __int16 a2, __int64 a3, const wchar_t *a4)
{
  __int64 v5; // rcx
  const wchar_t *v6; // rdi
  bool v7; // zf

  if ( a4 && *a4 )
  {
    v5 = -1i64;
    v6 = a4;
    do
    {
      if ( !v5 )
        break;
      v7 = *v6++ == 0;
      --v5;
    }
    while ( !v7 );
  }
  if ( a4 )
  {
    if ( !*a4 )
      a4 = L"<NULL>";
  }
  else
  {
    a4 = L"NULL";
  }
  return qword_30398(a1, 43i64, a3, a2, a4);
}
// 2D210: using guessed type wchar_t aNull_3[7];
// 2D220: using guessed type wchar_t aNull[5];
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000110E8) ----------------------------------------------------
__int64 __fastcall sub_110E8(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, a3, a2, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001113C) ----------------------------------------------------
__int64 __fastcall sub_1113C(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_30398(a1, 43i64, a3, a2, v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000111B4) ----------------------------------------------------
__int64 __fastcall sub_111B4(__int64 a1, __int64 a2, __int64 a3, __int16 a4, __int64 a5)
{
  char *v7; // rsi
  __int64 *v8; // rax
  __int64 v9; // r8
  SIZE_T v10; // rbx
  unsigned __int64 v11; // rcx
  int *v12; // rdx
  __int64 v13; // r9
  char *v15; // rax
  __int64 v16; // rbp
  const void **i; // rdi
  size_t v18; // rbx
  unsigned int v19; // ebx
  __int64 WnodeEventItem[7]; // [rsp+30h] [rbp-D8h] BYREF
  int v21; // [rsp+68h] [rbp-A0h] BYREF
  char *v22; // [rsp+70h] [rbp-98h]
  int v23; // [rsp+78h] [rbp-90h]
  __int16 v24; // [rsp+128h] [rbp+20h] BYREF

  v24 = a4;
  v7 = 0i64;
  memset(WnodeEventItem, 0, 0x30ui64);
  WnodeEventItem[1] = a1;
  WnodeEventItem[6] = (__int64)&v24;
  v8 = &a5;
  WnodeEventItem[3] = a3;
  HIDWORD(WnodeEventItem[5]) = 1703936;
  BYTE4(WnodeEventItem[0]) = -1;
  v21 = 2;
  v9 = a5;
  v10 = 0i64;
  v11 = 0i64;
  if ( a5 )
  {
    v12 = &v21;
    do
    {
      v13 = v8[1];
      ++v11;
      v12 += 4;
      v10 += v13;
      if ( v11 <= 7 )
      {
        *((_QWORD *)v12 - 1) = v9;
        *v12 = v13;
      }
      v8 += 2;
      v9 = *v8;
    }
    while ( *v8 );
  }
  if ( v10 > 0x2000 )
    return 3221225473i64;
  if ( v11 <= 7 )
  {
    LOWORD(WnodeEventItem[0]) = 16 * (v11 + 4);
  }
  else
  {
    v15 = (char *)ExAllocatePoolWithTag(NonPagedPool, v10, 0x45435453u);
    v7 = v15;
    if ( !v15 )
      return 3221225495i64;
    v22 = v15;
    v23 = v10;
    v16 = 0i64;
    for ( i = (const void **)&a5; *i; i += 2 )
    {
      v18 = (size_t)i[1];
      memmove(&v7[v16], *i, v18);
      v16 += v18;
    }
    LOWORD(WnodeEventItem[0]) = 80;
  }
  v19 = IoWMIWriteEvent(WnodeEventItem);
  if ( v7 )
    ExFreePoolWithTag(v7, 0);
  return v19;
}

//----- (0000000000011308) ----------------------------------------------------
__int64 __fastcall sub_11308(__int64 a1, char a2, __int64 *a3, __int64 a4)
{
  __int64 result; // rax

  result = 0i64;
  if ( a2 == 1 || !a2 )
  {
    if ( a2 )
    {
      *(_DWORD *)(a4 + 44) = *((_DWORD *)a3 + 1);
      *(_BYTE *)(a4 + 41) = *((_BYTE *)a3 + 2);
      result = *a3;
    }
    else
    {
      *(_BYTE *)(a4 + 41) = 0;
      *(_DWORD *)(a4 + 44) = 0;
    }
    *(_QWORD *)(a4 + 24) = result;
  }
  return result;
}

//----- (0000000000011340) ----------------------------------------------------
NTSTATUS __stdcall DriverEntry(_DRIVER_OBJECT *DriverObject, PUNICODE_STRING RegistryPath)
{
  int v3; // eax
  void **v4; // rcx
  __int64 *v5; // rbx
  __int64 v6; // rcx
  ULONG v7; // edx
  struct _DEVICE_OBJECT *v8; // rcx
  int v9; // ebx
  int v10; // eax
  unsigned __int16 v11; // si
  struct _UNICODE_STRING SystemRoutineName; // [rsp+40h] [rbp-48h] BYREF
  struct _UNICODE_STRING DeviceName; // [rsp+50h] [rbp-38h] BYREF
  unsigned int v15; // [rsp+90h] [rbp+8h] BYREF
  PDEVICE_OBJECT DeviceObject; // [rsp+A0h] [rbp+18h] BYREF

  DeviceName.Length = 32;
  DeviceName.MaximumLength = 34;
  qword_33128 = (__int64)&unk_2EB00;
  qword_33130 = (__int64)&qword_33160;
  qword_33168 = (__int64)&unk_2EB10;
  DeviceName.Buffer = L"\\Device\\NNS_picc";
  qword_33170 = (__int64)&qword_331A0;
  DeviceObject = 0i64;
  qword_331A8 = (__int64)&unk_2EB20;
  qword_33120 = 0i64;
  qword_331B0 = (__int64)&qword_331E0;
  qword_33140 = 0i64;
  byte_33148 = 1;
  byte_33149 = 0;
  word_3314A = 0;
  qword_331E8 = (__int64)&unk_2EB30;
  dword_3314C = 0;
  qword_33160 = 0i64;
  qword_33180 = 0i64;
  byte_33188 = 1;
  byte_33189 = 0;
  word_3318A = 0;
  dword_3318C = 0;
  qword_331A0 = 0i64;
  qword_331C0 = 0i64;
  byte_331C8 = 1;
  byte_331C9 = 0;
  word_331CA = 0;
  dword_331CC = 0;
  qword_331E0 = 0i64;
  qword_331F0 = 0i64;
  qword_33200 = 0i64;
  byte_33208 = 1;
  byte_33209 = 0;
  word_3320A = 0;
  dword_3320C = 0;
  v15 = 0;
  RtlInitUnicodeString(&SystemRoutineName, L"PsGetVersion");
  qword_303B0 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
  RtlInitUnicodeString(&SystemRoutineName, L"WmiTraceMessage");
  qword_30398 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
  if ( !qword_30398 )
  {
    qword_30398 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))sub_111B4;
    v3 = 1;
LABEL_3:
    dword_303B8 = v3;
    goto LABEL_10;
  }
  RtlInitUnicodeString(&SystemRoutineName, L"WmiQueryTraceInformation");
  qword_30390 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
  v3 = 2;
  dword_303B8 = 2;
  if ( qword_303B0 )
  {
    qword_303B0(&v15, 0i64, 0i64, 0i64);
    v3 = dword_303B8;
  }
  if ( v15 >= 6 )
  {
    RtlInitUnicodeString(&SystemRoutineName, L"EtwRegisterClassicProvider");
    qword_303A8 = (__int64 (__fastcall *)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))MmGetSystemRoutineAddress(&SystemRoutineName);
    if ( qword_303A8 )
    {
      RtlInitUnicodeString(&SystemRoutineName, L"EtwUnregister");
      qword_303A0 = (__int64 (*)(void))MmGetSystemRoutineAddress(&SystemRoutineName);
      v3 = 4;
      goto LABEL_3;
    }
    v3 = dword_303B8;
  }
LABEL_10:
  v4 = (void **)off_30148;
  v5 = &qword_33120;
  qword_33140 = 0i64;
  if ( off_30148 != &qword_33120 )
  {
    off_30148 = &qword_33120;
    if ( v3 == 4 )
    {
      do
      {
        v6 = v5[1];
        v5[7] = 0i64;
        qword_303A8(v6, 0i64, sub_11308, v5, v5 + 7);
        v5 = (__int64 *)v5[2];
      }
      while ( v5 );
    }
    else
    {
      if ( v3 == 2 )
      {
        v7 = -2147418111;
        v8 = (struct _DEVICE_OBJECT *)&qword_33120;
        qword_33120 = (__int64)sub_35008;
      }
      else
      {
        qword_33120 = 0i64;
        v7 = 1;
        v8 = (struct _DEVICE_OBJECT *)DriverObject;
      }
      IoWMIRegistrationControl(v8, v7);
    }
    v4 = (void **)off_30148;
  }
  if ( v4 != &off_30148 && (*((_BYTE *)v4 + 236) & 1) != 0 && *((_BYTE *)v4 + 233) >= 5u )
    sub_11008((__int64)v4[27], 0xAu, (__int64)&unk_2ECA8);
  sub_1D93C();
  sub_1D93C();
  DriverObject->DriverUnload = (PDRIVER_UNLOAD)sub_11814;
  v9 = IoCreateDevice(DriverObject, 0, &DeviceName, 0x22u, 0, 0, &DeviceObject);
  if ( v9 )
  {
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
      sub_1113C(*((_QWORD *)off_30148 + 27), 0xCu, (__int64)&unk_2ECA8, (const char *)L"\\Device\\NNS_picc");
    v9 = -1073741823;
    goto LABEL_39;
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0xBu, (__int64)&unk_2ECA8);
  DriverObject->MajorFunction[0] = (PDRIVER_DISPATCH)sub_11A74;
  DriverObject->MajorFunction[2] = (PDRIVER_DISPATCH)sub_11A74;
  DriverObject->MajorFunction[15] = (PDRIVER_DISPATCH)sub_11A9C;
  v10 = sub_11F68();
  v11 = v10;
  if ( v10 )
  {
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
      sub_1102C(*((_QWORD *)off_30148 + 27), 0xDu, (__int64)&unk_2ECA8, v10);
    v9 = v11 | 0xE0020000;
LABEL_39:
    sub_11814((PDEVICE_OBJECT)DriverObject);
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_1102C(*((_QWORD *)off_30148 + 27), 0xEu, (__int64)&unk_2ECA8, v9);
  return v9;
}
// 2D240: using guessed type wchar_t aDeviceNnsPicc[17];
// 30148: using guessed type void *off_30148;
// 30390: using guessed type __int64 (__fastcall *qword_30390)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 303A0: using guessed type __int64 (*qword_303A0)(void);
// 303A8: using guessed type __int64 (__fastcall *qword_303A8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 303B0: using guessed type __int64 (__fastcall *qword_303B0)(_QWORD, _QWORD, _QWORD, _QWORD);
// 303B8: using guessed type int dword_303B8;
// 33120: using guessed type __int64 qword_33120;
// 33128: using guessed type __int64 qword_33128;
// 33130: using guessed type __int64 qword_33130;
// 33140: using guessed type __int64 qword_33140;
// 33148: using guessed type char byte_33148;
// 33149: using guessed type char byte_33149;
// 3314A: using guessed type __int16 word_3314A;
// 3314C: using guessed type int dword_3314C;
// 33160: using guessed type __int64 qword_33160;
// 33168: using guessed type __int64 qword_33168;
// 33170: using guessed type __int64 qword_33170;
// 33180: using guessed type __int64 qword_33180;
// 33188: using guessed type char byte_33188;
// 33189: using guessed type char byte_33189;
// 3318A: using guessed type __int16 word_3318A;
// 3318C: using guessed type int dword_3318C;
// 331A0: using guessed type __int64 qword_331A0;
// 331A8: using guessed type __int64 qword_331A8;
// 331B0: using guessed type __int64 qword_331B0;
// 331C0: using guessed type __int64 qword_331C0;
// 331C8: using guessed type char byte_331C8;
// 331C9: using guessed type char byte_331C9;
// 331CA: using guessed type __int16 word_331CA;
// 331CC: using guessed type int dword_331CC;
// 331E0: using guessed type __int64 qword_331E0;
// 331E8: using guessed type __int64 qword_331E8;
// 331F0: using guessed type __int64 qword_331F0;
// 33200: using guessed type __int64 qword_33200;
// 33208: using guessed type char byte_33208;
// 33209: using guessed type char byte_33209;
// 3320A: using guessed type __int16 word_3320A;
// 3320C: using guessed type int dword_3320C;

//----- (0000000000011814) ----------------------------------------------------
void __fastcall sub_11814(PDEVICE_OBJECT DeviceObject)
{
  void **v2; // rbx
  unsigned __int16 v3; // dx
  ULONG v4; // edx
  struct _DEVICE_OBJECT *v5; // rcx

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0xFu, (__int64)&unk_2ECA8);
  sub_12080();
  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x1Cu, (__int64)&unk_2ECA8);
    v2 = (void **)off_30148;
  }
  if ( !DeviceObject->DriverObject )
  {
    if ( v2 == &off_30148 )
      return;
    if ( (*((_BYTE *)v2 + 236) & 1) == 0 || *((_BYTE *)v2 + 233) < 3u )
      goto LABEL_25;
    v3 = 29;
    goto LABEL_24;
  }
  while ( 1 )
  {
    if ( v2 != &off_30148 && (*((_BYTE *)v2 + 236) & 1) != 0 && *((_BYTE *)v2 + 233) >= 4u )
      sub_11008((__int64)v2[27], 0x1Eu, (__int64)&unk_2ECA8);
    IoDeleteDevice((PDEVICE_OBJECT)DeviceObject->DriverObject);
    if ( !DeviceObject->DriverObject )
      break;
    v2 = (void **)off_30148;
  }
  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 236) & 1) == 0 || *((_BYTE *)off_30148 + 233) < 5u )
    {
LABEL_25:
      if ( v2 != &off_30148 )
      {
        if ( _bittest((const signed __int32 *)v2 + 43, 0x12u) && *((_BYTE *)v2 + 169) >= 5u )
        {
          sub_11008((__int64)v2[19], 0xDu, (__int64)&unk_2EC18);
          v2 = (void **)off_30148;
        }
        if ( v2 != &off_30148 )
        {
          if ( _bittest((const signed __int32 *)v2 + 43, 0x12u) && *((_BYTE *)v2 + 169) >= 5u )
          {
            sub_1102C((__int64)v2[19], 0xEu, (__int64)&unk_2EC18, 0);
            v2 = (void **)off_30148;
          }
          if ( v2 != &off_30148 )
          {
            if ( (*((_BYTE *)v2 + 236) & 1) != 0 && *((_BYTE *)v2 + 233) >= 5u )
            {
              sub_11008((__int64)v2[27], 0x10u, (__int64)&unk_2ECA8);
              v2 = (void **)off_30148;
            }
            if ( v2 != &off_30148 )
            {
              if ( dword_303B8 == 4 )
              {
                while ( v2 )
                {
                  if ( v2[7] )
                    qword_303A0();
                  v2 = (void **)v2[2];
                }
              }
              else
              {
                v4 = 2;
                if ( dword_303B8 == 2 )
                {
                  v4 = -2147483646;
                  v5 = (struct _DEVICE_OBJECT *)v2;
                }
                else
                {
                  v5 = DeviceObject;
                }
                IoWMIRegistrationControl(v5, v4);
              }
              off_30148 = &off_30148;
            }
          }
        }
      }
      return;
    }
    v3 = 31;
LABEL_24:
    sub_11008((__int64)v2[27], v3, (__int64)&unk_2ECA8);
    v2 = (void **)off_30148;
    goto LABEL_25;
  }
}
// 30148: using guessed type void *off_30148;
// 303A0: using guessed type __int64 (*qword_303A0)(void);
// 303B8: using guessed type int dword_303B8;

//----- (0000000000011A74) ----------------------------------------------------
__int64 __fastcall sub_11A74(__int64 a1, IRP *a2)
{
  a2->IoStatus.Status = 0;
  a2->IoStatus.Information = 0i64;
  IofCompleteRequest(a2, 0);
  return 0i64;
}

//----- (0000000000011A9C) ----------------------------------------------------
__int64 __fastcall sub_11A9C(__int64 a1, __int64 a2)
{
  unsigned int v3; // ebx
  _DWORD *v4; // rax
  int v5; // er9
  unsigned int v6; // er9
  int v7; // eax
  unsigned __int16 v8; // di
  _QWORD *v9; // rcx
  unsigned __int16 v10; // dx
  int v11; // eax

  v3 = 0;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 2) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0x11u, (__int64)&unk_2ECA8);
  v4 = *(_DWORD **)(a2 + 184);
  *(_QWORD *)(a2 + 56) = 0i64;
  v5 = v4[6];
  if ( v5 != 2248224 )
  {
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 2) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
      sub_1102C(*((_QWORD *)off_30148 + 27), 0x12u, (__int64)&unk_2ECA8, v5);
LABEL_29:
    v3 = -1073741811;
    goto LABEL_30;
  }
  v6 = v4[4];
  if ( v6 < 0x38 || v4[2] < 0x38u )
  {
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 2) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
      sub_110E8(*((_QWORD *)off_30148 + 27), 0x13u, (__int64)&unk_2ECA8, v6);
    goto LABEL_29;
  }
  v7 = sub_13E40(*(__m128i **)(a2 + 24));
  v8 = v7;
  if ( v7 )
  {
    v9 = off_30148;
    if ( off_30148 == &off_30148 || (*((_BYTE *)off_30148 + 236) & 2) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
      goto LABEL_18;
    v10 = 20;
    goto LABEL_17;
  }
  v11 = sub_1E604(0x2014001u);
  v7 = sub_13FF0(v11);
  v8 = v7;
  if ( !v7 )
  {
    *(_QWORD *)(a2 + 56) = 56i64;
    goto LABEL_30;
  }
  v9 = off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 2) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    v10 = 21;
LABEL_17:
    sub_1102C(v9[27], v10, (__int64)&unk_2ECA8, v7);
  }
LABEL_18:
  v3 = v8 | 0xE0020000;
LABEL_30:
  *(_DWORD *)(a2 + 48) = v3;
  IofCompleteRequest((PIRP)a2, 0);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 2) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_1102C(*((_QWORD *)off_30148 + 27), 0x16u, (__int64)&unk_2ECA8, v3);
  return v3;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000011CB4) ----------------------------------------------------
__int64 sub_11CB4()
{
  PVOID OutputBuffer; // rdi
  unsigned int v1; // ebx
  int v2; // eax
  void **v3; // rcx
  IRP *v4; // rax
  NTSTATUS v5; // eax
  struct _UNICODE_STRING ObjectName; // [rsp+50h] [rbp-58h] BYREF
  struct _IO_STATUS_BLOCK IoStatusBlock; // [rsp+60h] [rbp-48h] BYREF
  struct _KEVENT Event; // [rsp+70h] [rbp-38h] BYREF
  PDEVICE_OBJECT DeviceObject; // [rsp+B8h] [rbp+10h] BYREF
  PFILE_OBJECT FileObject; // [rsp+C0h] [rbp+18h] BYREF

  FileObject = 0i64;
  OutputBuffer = Timeout;
  v1 = 0;
  ObjectName.Length = 32;
  ObjectName.MaximumLength = 34;
  ObjectName.Buffer = L"\\Device\\NNS_pihs";
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_147C8(*((_QWORD *)off_30148 + 27), 0x17u, (__int64)&unk_2ECA8, Timeout);
  v2 = IoGetDeviceObjectPointer(&ObjectName, 0, &FileObject, &DeviceObject);
  if ( v2 < 0 )
  {
    v3 = (void **)off_30148;
    if ( off_30148 == &off_30148 || (*((_BYTE *)off_30148 + 236) & 1) == 0 || *((_BYTE *)off_30148 + 233) < 4u )
      goto LABEL_11;
    sub_1102C(*((_QWORD *)off_30148 + 27), 0x18u, (__int64)&unk_2ECA8, v2);
LABEL_10:
    v3 = (void **)off_30148;
LABEL_11:
    v1 = 1;
    goto LABEL_26;
  }
  KeInitializeEvent(&Event, NotificationEvent, 0);
  v4 = IoBuildDeviceIoControlRequest(
         0x224E20u,
         DeviceObject,
         OutputBuffer,
         0x38u,
         OutputBuffer,
         0x38u,
         1u,
         &Event,
         &IoStatusBlock);
  if ( v4 )
  {
    v5 = IofCallDriver(DeviceObject, v4);
    if ( v5 == 259 )
    {
      KeWaitForSingleObject(&Event, Executive, 0, 0, 0i64);
      v5 = IoStatusBlock.Status;
    }
    if ( v5 < 0 )
    {
      v3 = (void **)off_30148;
      if ( off_30148 == &off_30148 || (*((_BYTE *)off_30148 + 236) & 1) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
        goto LABEL_11;
      sub_11008(*((_QWORD *)off_30148 + 27), 0x1Au, (__int64)&unk_2ECA8);
      goto LABEL_10;
    }
    v3 = (void **)off_30148;
  }
  else
  {
    v3 = (void **)off_30148;
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
    {
      sub_11008(*((_QWORD *)off_30148 + 27), 0x19u, (__int64)&unk_2ECA8);
      v3 = (void **)off_30148;
    }
    v1 = 3;
  }
LABEL_26:
  if ( FileObject )
  {
    ObfDereferenceObject(FileObject);
    v3 = (void **)off_30148;
  }
  if ( v3 != &off_30148 && (*((_BYTE *)v3 + 236) & 1) != 0 && *((_BYTE *)v3 + 233) >= 5u )
    sub_1102C((__int64)v3[27], 0x1Bu, (__int64)&unk_2ECA8, v1);
  return v1;
}
// 2D270: using guessed type wchar_t aDeviceNnsPihs[17];
// 30148: using guessed type void *off_30148;

//----- (0000000000011F18) ----------------------------------------------------
void sub_11F18()
{
  _QWORD *v0; // rax

  v0 = sub_1BFC8();
  if ( v0 )
    sub_1C134((__int64)v0);
}

//----- (0000000000011F68) ----------------------------------------------------
__int64 sub_11F68()
{
  unsigned int v0; // ebx

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0x20u, (__int64)&unk_2ECA8);
  if ( (int)sub_1B70C(&Resource) < 0 )
  {
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
      sub_11008(*((_QWORD *)off_30148 + 27), 0x21u, (__int64)&unk_2ECA8);
  }
  else
  {
    byte_30448 = 1;
  }
  v0 = sub_12D20();
  if ( !v0 )
  {
    v0 = sub_12344();
    if ( v0 )
      sub_12FC4();
    else
      v0 = sub_131EC(1);
  }
  _InterlockedAdd(&dword_303CC, 1u);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_1102C(*((_QWORD *)off_30148 + 27), 0x22u, (__int64)&unk_2ECA8, v0);
  return v0;
}
// 30148: using guessed type void *off_30148;
// 303CC: using guessed type int dword_303CC;
// 30448: using guessed type char byte_30448;

//----- (0000000000012080) ----------------------------------------------------
__int64 sub_12080()
{
  void **v0; // rcx
  void **v1; // rcx
  void **v2; // rcx

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0x23u, (__int64)&unk_2ECA8);
  sub_131EC(0);
  _InterlockedAdd(&dword_303CC, 0xFFFFFFFF);
  if ( byte_30448 )
  {
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
      sub_11008(*((_QWORD *)off_30148 + 27), 0x24u, (__int64)&unk_2ECA8);
    KeEnterCriticalRegion();
    sub_1B8B4(&Resource);
    goto LABEL_15;
  }
  v0 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    goto LABEL_20;
  if ( (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x25u, (__int64)&unk_2ECA8);
LABEL_15:
    v0 = (void **)off_30148;
  }
  if ( v0 != &off_30148 && (*((_BYTE *)v0 + 236) & 1) != 0 && *((_BYTE *)v0 + 233) >= 5u )
    sub_11008((__int64)v0[27], 0x26u, (__int64)&unk_2ECA8);
LABEL_20:
  sub_12620();
  sub_12FC4();
  v1 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x27u, (__int64)&unk_2ECA8);
    v1 = (void **)off_30148;
  }
  if ( byte_30448 )
  {
    if ( v1 != &off_30148 && (*((_BYTE *)v1 + 236) & 1) != 0 && *((_BYTE *)v1 + 233) >= 5u )
      sub_11008((__int64)v1[27], 0x28u, (__int64)&unk_2ECA8);
    sub_1BA64(&Resource);
    KeLeaveCriticalRegion();
    v2 = (void **)off_30148;
    if ( off_30148 != &off_30148 )
    {
      if ( (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
      {
        sub_11008(*((_QWORD *)off_30148 + 27), 0x29u, (__int64)&unk_2ECA8);
        v2 = (void **)off_30148;
      }
      if ( v2 != &off_30148 && (*((_BYTE *)v2 + 236) & 1) != 0 && *((_BYTE *)v2 + 233) >= 5u )
        sub_11008((__int64)v2[27], 0x2Au, (__int64)&unk_2ECA8);
    }
    sub_1B7E0(&Resource);
    goto LABEL_42;
  }
  if ( v1 != &off_30148 && (*((_BYTE *)v1 + 236) & 1) != 0 && *((_BYTE *)v1 + 233) >= 5u )
  {
    sub_11008((__int64)v1[27], 0x2Bu, (__int64)&unk_2ECA8);
LABEL_42:
    v1 = (void **)off_30148;
  }
  if ( P )
  {
    sub_1B0BC(P, 0x52534950u);
    v1 = (void **)off_30148;
  }
  if ( v1 != &off_30148 && (*((_BYTE *)v1 + 236) & 1) != 0 && *((_BYTE *)v1 + 233) >= 5u )
    sub_11008((__int64)v1[27], 0x2Cu, (__int64)&unk_2ECA8);
  return 0i64;
}
// 30148: using guessed type void *off_30148;
// 303CC: using guessed type int dword_303CC;
// 30448: using guessed type char byte_30448;

//----- (0000000000012344) ----------------------------------------------------
__int64 sub_12344()
{
  PVOID v0; // rax
  int v1; // eax
  void **v2; // rcx
  unsigned int v3; // edi
  unsigned int v4; // ebx
  __int64 v5; // rbx

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0x2Du, (__int64)&unk_2ECA8);
  if ( !qword_305B0 )
  {
    dword_304A4 = 5;
    qword_33040 = (__int64)aPiccreceivedpa;
    v0 = sub_1B038(2, 0x14u, 0x72746E63u);
    qword_305B0 = v0;
    if ( v0 )
      memset(v0, 0, 0x14ui64);
  }
  sub_19D44();
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0xAu, (__int64)&unk_2EC58);
  qword_304B8 = 0i64;
  sub_1B70C(&stru_304C0);
  qword_30528 = 0i64;
  byte_3044B = 1;
  sub_1B70C(&stru_30530);
  byte_3044C = 1;
  if ( !(unsigned int)sub_1E604(0x201400Bu) )
    goto LABEL_18;
  v1 = sub_16E04();
  if ( !v1 )
    goto LABEL_18;
  v2 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    goto LABEL_23;
  if ( (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 27), 0xBu, (__int64)&unk_2EC58, v1);
LABEL_18:
    v2 = (void **)off_30148;
  }
  if ( v2 != &off_30148 && (*((_BYTE *)v2 + 236) & 1) != 0 && *((_BYTE *)v2 + 233) >= 5u )
    sub_11008((__int64)v2[27], 0xCu, (__int64)&unk_2EC58);
LABEL_23:
  sub_129B0();
  v3 = sub_13A94();
  if ( !v3 )
  {
    v4 = (unsigned __int16)sub_1E604(0x2014005u);
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 108) < 0 && *((_BYTE *)off_30148 + 105) >= 4u )
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x2Bu);
    qword_303D0 = (PVOID)sub_1D008(v4);
    if ( !qword_303D0 )
      v3 = 3;
    if ( !v3 )
    {
      v5 = sub_1E870();
      qword_303D8 = v5;
      KeInitializeDpc(&Dpc, (PKDEFERRED_ROUTINE)DeferredRoutine, sub_11F18);
      KeInitializeTimer(&Timer);
      qword_33098 = -10 * v5;
      KeSetTimer(&Timer, (LARGE_INTEGER)(-10 * v5), &Dpc);
    }
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_1102C(*((_QWORD *)off_30148 + 27), 0x2Eu, (__int64)&unk_2ECA8, v3);
  return v3;
}
// 30148: using guessed type void *off_30148;
// 30190: using guessed type wchar_t aPiccreceivedpa[20];
// 303D8: using guessed type __int64 qword_303D8;
// 3044B: using guessed type char byte_3044B;
// 3044C: using guessed type char byte_3044C;
// 304A4: using guessed type int dword_304A4;
// 33040: using guessed type __int64 qword_33040;
// 33098: using guessed type __int64 qword_33098;

//----- (0000000000012620) ----------------------------------------------------
__int64 sub_12620()
{
  void **v0; // rcx
  PVOID v1; // rdi
  int v2; // eax

  v0 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x2Fu, (__int64)&unk_2ECA8);
    v0 = (void **)off_30148;
  }
  if ( qword_303D8 )
  {
    KeCancelTimer(&Timer);
    v0 = (void **)off_30148;
  }
  if ( qword_303D0 )
  {
    sub_1E604(0x2014006u);
    v1 = qword_303D0;
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 108) < 0 && *((_BYTE *)off_30148 + 105) >= 4u )
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x2Du);
    sub_1D250(v1);
    v0 = (void **)off_30148;
    qword_303D0 = 0i64;
  }
  if ( v0 != &off_30148 && (*((_BYTE *)v0 + 236) & 1) != 0 && *((_BYTE *)v0 + 233) >= 5u )
  {
    sub_11008((__int64)v0[27], 0xEu, (__int64)&unk_2EC68);
    v0 = (void **)off_30148;
  }
  if ( qword_304A8 )
  {
    v2 = sub_281E0(qword_304A8, 1);
    if ( v2 )
    {
      v0 = (void **)off_30148;
      if ( off_30148 == &off_30148 )
        goto LABEL_35;
      if ( (*((_BYTE *)off_30148 + 236) & 1) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
        goto LABEL_31;
      sub_1102C(*((_QWORD *)off_30148 + 27), 0xFu, (__int64)&unk_2EC68, v2);
      goto LABEL_30;
    }
    v0 = (void **)off_30148;
    qword_304A8 = 0i64;
  }
  if ( qword_304B0 )
  {
    sub_1B458(qword_304B0);
    v0 = (void **)off_30148;
    qword_304B0 = 0i64;
  }
  byte_3044A = 0;
  if ( v0 != &off_30148 )
  {
    if ( (*((_BYTE *)v0 + 236) & 1) == 0 || *((_BYTE *)v0 + 233) < 5u )
    {
LABEL_31:
      if ( v0 != &off_30148 && (*((_BYTE *)v0 + 236) & 1) != 0 && *((_BYTE *)v0 + 233) >= 5u )
      {
        sub_11008((__int64)v0[27], 0xDu, (__int64)&unk_2EC58);
        v0 = (void **)off_30148;
      }
      goto LABEL_35;
    }
    sub_11008((__int64)v0[27], 0x10u, (__int64)&unk_2EC68);
LABEL_30:
    v0 = (void **)off_30148;
    goto LABEL_31;
  }
LABEL_35:
  if ( byte_3044B )
  {
    sub_1B7E0(&stru_304C0);
    v0 = (void **)off_30148;
    byte_3044B = 0;
  }
  if ( qword_304B8 )
  {
    sub_1B0BC(qword_304B8, 0x746D6C50u);
    v0 = (void **)off_30148;
    qword_304B8 = 0i64;
  }
  if ( byte_3044C )
  {
    sub_1B7E0(&stru_30530);
    v0 = (void **)off_30148;
    byte_3044C = 0;
  }
  if ( qword_30528 )
  {
    sub_1B0BC(qword_30528, 0x556D6C50u);
    v0 = (void **)off_30148;
    qword_30528 = 0i64;
  }
  if ( v0 != &off_30148 && (*((_BYTE *)v0 + 236) & 1) != 0 && *((_BYTE *)v0 + 233) >= 5u )
    sub_11008((__int64)v0[27], 0xEu, (__int64)&unk_2EC58);
  sub_13D60();
  if ( qword_305B0 )
  {
    sub_1B0BC(qword_305B0, 0x72746E63u);
    qword_305B0 = 0i64;
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0x30u, (__int64)&unk_2ECA8);
  return 0i64;
}
// 30148: using guessed type void *off_30148;
// 303D8: using guessed type __int64 qword_303D8;
// 3044A: using guessed type char byte_3044A;
// 3044B: using guessed type char byte_3044B;
// 3044C: using guessed type char byte_3044C;

//----- (00000000000129B0) ----------------------------------------------------
__int64 sub_129B0()
{
  unsigned int v0; // edi
  int v1; // eax
  _DWORD *v2; // rbp
  int v3; // er9
  size_t v4; // rbx
  _WORD *v5; // rax
  _WORD *v6; // r12
  _UNICODE_STRING DestinationString; // [rsp+30h] [rbp-68h] BYREF
  _UNICODE_STRING v9; // [rsp+40h] [rbp-58h] BYREF
  struct _OBJECT_ATTRIBUTES ObjectAttributes; // [rsp+50h] [rbp-48h] BYREF
  ULONG ResultLength; // [rsp+A0h] [rbp+8h] BYREF
  void *KeyHandle; // [rsp+A8h] [rbp+10h] BYREF

  v0 = 0;
  KeyHandle = 0i64;
  ResultLength = 24;
  RtlInitUnicodeString(&v9, L"\\Registry\\Machine\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion");
  ObjectAttributes.RootDirectory = 0i64;
  ObjectAttributes.SecurityDescriptor = 0i64;
  ObjectAttributes.SecurityQualityOfService = 0i64;
  ObjectAttributes.Length = 48;
  ObjectAttributes.Attributes = 576;
  ObjectAttributes.ObjectName = &v9;
  if ( ZwOpenKey(&KeyHandle, (ACCESS_MASK)&loc_20017 + 2, &ObjectAttributes) >= 0 )
  {
    RtlInitUnicodeString(&DestinationString, L"SystemRoot");
    v1 = ZwQueryValueKey(KeyHandle, &DestinationString, KeyValueFullInformation, 0i64, 8u, &ResultLength);
    if ( v1 == -2147483643 || v1 == -1073741789 )
    {
      v2 = sub_1B038(1, ResultLength, 0x47524950u);
      if ( v2 )
      {
        v3 = ZwQueryValueKey(KeyHandle, &DestinationString, KeyValueFullInformation, v2, ResultLength, &ResultLength);
        if ( v3 )
        {
          v0 = 12;
          if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
            sub_1102C(*((_QWORD *)off_30148 + 27), 0x34u, (__int64)&unk_2ECA8, v3);
        }
        else
        {
          v4 = (unsigned int)v2[3];
          if ( (unsigned int)v4 > 2 )
          {
            if ( v2[1] == 2 || v2[1] == 7 || v2[1] == 1 )
              v4 = (unsigned int)(v4 + 4);
            if ( !P )
            {
              v5 = sub_1B038(1, v4, 0x52534950u);
              v6 = v5;
              P = v5;
              if ( v5 )
              {
                memset(v5, 0, v4);
                memmove(v6, (char *)v2 + (unsigned int)v2[2], (unsigned int)v2[3]);
                sub_2B318(v6, v4, (__int16 *)qword_2D340);
                if ( off_30148 != &off_30148
                  && (*((_BYTE *)off_30148 + 236) & 1) != 0
                  && *((_BYTE *)off_30148 + 233) >= 4u )
                {
                  sub_11068(*((_QWORD *)off_30148 + 27), 0x33u, (__int64)&unk_2ECA8, (const wchar_t *)P);
                }
              }
            }
          }
          else
          {
            if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 3u )
              sub_11008(*((_QWORD *)off_30148 + 27), 0x32u, (__int64)&unk_2ECA8);
            v0 = 12;
          }
        }
        sub_1B0BC(v2, 0x47524950u);
      }
    }
    else
    {
      v0 = 12;
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
        sub_1102C(*((_QWORD *)off_30148 + 27), 0x35u, (__int64)&unk_2ECA8, v1);
    }
  }
  else
  {
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
      sub_11068(*((_QWORD *)off_30148 + 27), 0x31u, (__int64)&unk_2ECA8, L"SystemRoot");
    v0 = 12;
  }
  if ( KeyHandle )
    ZwClose(KeyHandle);
  return v0;
}
// 2D340: using guessed type __int64 qword_2D340[2];
// 30148: using guessed type void *off_30148;

//----- (0000000000012D20) ----------------------------------------------------
__int64 sub_12D20()
{
  unsigned int v0; // ebx
  __int64 v2[4]; // [rsp+20h] [rbp-C8h] BYREF
  int v3; // [rsp+40h] [rbp-A8h] BYREF
  char Dst[42]; // [rsp+44h] [rbp-A4h] BYREF
  char v5[86]; // [rsp+6Eh] [rbp-7Ah] BYREF
  int v6; // [rsp+C4h] [rbp-24h]
  char v7; // [rsp+C8h] [rbp-20h]

  v3 = 33636352;
  memmove(Dst, L"ProcessInfoColorizer", 0x2Aui64);
  memset(v5, 0, sizeof(v5));
  v2[0] = (__int64)sub_132AC;
  v6 = 1768967758;
  v2[1] = (__int64)sub_133F0;
  v7 = 15;
  v2[2] = (__int64)sub_134E4;
  v2[3] = 0i64;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0xAu, (__int64)&unk_2EC98);
  word_3049C = 0;
  dword_304A0 = 0;
  v0 = sub_1DCC0((__int64)&v3, 1080i64, v2);
  if ( v0 )
    goto LABEL_19;
  v0 = sub_20BC8();
  if ( v0 )
    goto LABEL_19;
  v0 = sub_209E8(40031, 1);
  if ( v0 )
    goto LABEL_19;
  v0 = sub_209E8(40032, 1);
  if ( v0 )
    goto LABEL_19;
  v0 = sub_209E8(40040, 1);
  if ( v0 )
    goto LABEL_19;
  v0 = sub_240F8(40037);
  if ( v0 )
    goto LABEL_19;
  v0 = sub_240F8(40042);
  if ( v0
    || (v0 = sub_241E8(40019, (__int64)sub_16808)) != 0
    || (v0 = sub_241E8(40038, (__int64)sub_16B60)) != 0
    || (v0 = sub_241E8(40041, (__int64)sub_16C80)) != 0
    || (v0 = sub_241E8(40036, (__int64)sub_17250)) != 0
    || (sub_2094C(0), (v0 = sub_20DB0()) != 0)
    || (v0 = sub_1E190()) != 0 )
  {
LABEL_19:
    sub_12FC4();
  }
  else
  {
    byte_30449 = 1;
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_1102C(*((_QWORD *)off_30148 + 27), 0xBu, (__int64)&unk_2EC98, v0);
  return v0;
}
// 2D350: using guessed type wchar_t aProcessinfocol[21];
// 30148: using guessed type void *off_30148;
// 30449: using guessed type char byte_30449;
// 3049C: using guessed type __int16 word_3049C;
// 304A0: using guessed type int dword_304A0;

//----- (0000000000012FC4) ----------------------------------------------------
__int64 sub_12FC4()
{
  void **v0; // rcx
  unsigned __int16 v1; // dx
  char *v2; // rcx
  _QWORD *v3; // rcx
  _QWORD *v4; // rax
  _QWORD **v5; // rdx

  v0 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0xCu, (__int64)&unk_2EC98);
    v0 = (void **)off_30148;
  }
  if ( byte_30449 )
  {
    sub_1E4D8();
    v0 = (void **)off_30148;
    byte_30449 = 0;
  }
  if ( v0 != &off_30148 && _bittest((const signed __int32 *)v0 + 43, 8u) && *((_BYTE *)v0 + 169) >= 5u )
  {
    sub_11008((__int64)v0[19], 0x1Fu, (__int64)&unk_2EC08);
    v0 = (void **)off_30148;
  }
  if ( qword_32BA8 )
  {
    sub_214BC();
    sub_25138((__int64)qword_32BA8 + 128);
    v2 = (char *)qword_32BA8;
    if ( !*((_QWORD *)qword_32BA8 + 26) )
      goto LABEL_24;
    v3 = (_QWORD *)*((_QWORD *)qword_32BA8 + 26);
    while ( 1 )
    {
      sub_1B0BC(v3, 0x66634E4Eu);
      v2 = (char *)qword_32BA8;
LABEL_24:
      v5 = (_QWORD **)(v2 + 56);
      if ( *v5 == v5 )
        break;
      v4 = (_QWORD *)**v5;
      v3 = *v5 - 5;
      *v5 = v4;
      v4[1] = v5;
    }
    sub_1B7E0((PERESOURCE)(v2 + 216));
    sub_1B0BC(qword_32BA8, 0x66634E4Eu);
    qword_32BA8 = 0i64;
    v0 = (void **)off_30148;
    if ( off_30148 != &off_30148 )
    {
      if ( _bittest((const signed __int32 *)off_30148 + 43, 8u) && *((_BYTE *)off_30148 + 169) >= 5u )
      {
        v1 = 34;
        goto LABEL_29;
      }
LABEL_30:
      if ( v0 != &off_30148 && (*((_BYTE *)v0 + 236) & 1) != 0 && *((_BYTE *)v0 + 233) >= 5u )
        sub_11008((__int64)v0[27], 0xDu, (__int64)&unk_2EC98);
      return 0i64;
    }
  }
  else if ( v0 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)v0 + 43, 8u) && *((_BYTE *)v0 + 169) >= 2u )
    {
      sub_11008((__int64)v0[19], 0x20u, (__int64)&unk_2EC08);
      v0 = (void **)off_30148;
    }
    if ( v0 != &off_30148 )
    {
      if ( _bittest((const signed __int32 *)v0 + 43, 8u) && *((_BYTE *)v0 + 169) >= 5u )
      {
        v1 = 33;
LABEL_29:
        sub_11008((__int64)v0[19], v1, (__int64)&unk_2EC08);
        v0 = (void **)off_30148;
        goto LABEL_30;
      }
      goto LABEL_30;
    }
  }
  return 0i64;
}
// 30148: using guessed type void *off_30148;
// 30449: using guessed type char byte_30449;

//----- (00000000000131EC) ----------------------------------------------------
__int64 __fastcall sub_131EC(char a1)
{
  unsigned int v2; // ebx
  void **v3; // rcx

  v2 = 0;
  v3 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0xEu, (__int64)&unk_2EC98);
    v3 = (void **)off_30148;
  }
  if ( byte_30449 )
  {
    sub_2094C(a1);
    v3 = (void **)off_30148;
  }
  else
  {
    v2 = 16;
  }
  if ( v3 != &off_30148 && (*((_BYTE *)v3 + 236) & 1) != 0 && *((_BYTE *)v3 + 233) >= 5u )
    sub_1102C((__int64)v3[27], 0xFu, (__int64)&unk_2EC98, v2);
  return v2;
}
// 30148: using guessed type void *off_30148;
// 30449: using guessed type char byte_30449;

//----- (00000000000132AC) ----------------------------------------------------
char __fastcall sub_132AC(int a1, _DWORD *a2, _DWORD *a3, _DWORD *a4)
{
  char v4; // r10

  v4 = 1;
  switch ( a1 )
  {
    case 33636353:
      *a2 = 0;
      goto LABEL_3;
    case 33636354:
      *a2 = 4;
      goto LABEL_5;
    case 33636355:
      *a2 = 8;
      goto LABEL_3;
    case 33636356:
      *a2 = 12;
      *a3 = 1;
      *a4 = 5;
      return v4;
    case 33636357:
      *a2 = 14;
      *a3 = 2;
      *a4 = 6;
      return v4;
    case 33636358:
      *a2 = 16;
      goto LABEL_3;
    case 33636359:
      *a2 = 24;
      *a3 = 8;
      *a4 = 7;
      return v4;
    case 33636360:
      *a2 = 32;
      goto LABEL_5;
    case 33636361:
      *a2 = 33;
      goto LABEL_5;
    case 33636362:
      *a2 = 34;
LABEL_5:
      *a3 = 1;
      *a4 = 1;
      return v4;
    case 33636363:
      *a2 = 36;
      goto LABEL_3;
    case 33636364:
      *a2 = 40;
      goto LABEL_3;
    case 33636365:
      *a2 = 44;
      goto LABEL_3;
    case 33636366:
      *a2 = 48;
LABEL_3:
      *a3 = 4;
      *a4 = 0;
      break;
    case 33636367:
      *a2 = 52;
      *a3 = 1024;
      *a4 = 2;
      break;
    default:
      v4 = 0;
      break;
  }
  return v4;
}

//----- (00000000000133F0) ----------------------------------------------------
__int64 __fastcall sub_133F0(__int64 a1)
{
  __int64 result; // rax

  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x10u, (__int64)&unk_2EC98);
  }
  *(_DWORD *)(a1 + 36) = 0;
  *(_DWORD *)a1 = 1;
  *(_BYTE *)(a1 + 4) = 1;
  *(_DWORD *)(a1 + 8) = (_DWORD)&loc_1517E + 2;
  *(_BYTE *)(a1 + 12) = 11;
  *(_WORD *)(a1 + 14) = 1;
  *(_DWORD *)(a1 + 16) = 10;
  *(_QWORD *)(a1 + 24) = 1000000i64;
  *(_WORD *)(a1 + 32) = 1;
  *(_BYTE *)(a1 + 34) = 1;
  *(_DWORD *)(a1 + 40) = 1000;
  *(_DWORD *)(a1 + 44) = 1;
  *(_DWORD *)(a1 + 48) = 2;
  result = sub_2B3C0((_WORD *)(a1 + 52), 512i64, L"1900|3389|445|139|5985", -1i64);
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    result = sub_11008(*((_QWORD *)off_30148 + 19), 0x11u, (__int64)&unk_2EC98);
  }
  return result;
}
// 2D380: using guessed type wchar_t a19003389445139[23];
// 30148: using guessed type void *off_30148;

//----- (00000000000134E4) ----------------------------------------------------
void __fastcall sub_134E4(const signed __int32 *a1)
{
  void **v2; // rcx
  int v3; // eax
  int v4; // eax
  int v5; // eax

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_147C8(*((_QWORD *)off_30148 + 19), 0x12u, (__int64)&unk_2EC98, a1);
    v2 = (void **)off_30148;
  }
  if ( (*(_BYTE *)a1 & 1) != 0 )
  {
    v3 = sub_1E604(0x2014001u);
    v4 = sub_13FF0(v3);
    if ( !v4 )
    {
LABEL_11:
      v2 = (void **)off_30148;
      goto LABEL_12;
    }
    v2 = (void **)off_30148;
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 8u)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x13u, (__int64)&unk_2EC98, v4);
      goto LABEL_11;
    }
  }
LABEL_12:
  if ( !_bittest(a1, 0xAu) )
    goto LABEL_27;
  if ( v2 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)v2 + 43, 8u) && *((_BYTE *)v2 + 169) >= 4u )
    {
      sub_11008((__int64)v2[19], 0x14u, (__int64)&unk_2EC98);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 && _bittest((const signed __int32 *)v2 + 43, 8u) && *((_BYTE *)v2 + 169) >= 4u )
      sub_11008((__int64)v2[19], 0x15u, (__int64)&unk_2EC98);
  }
  v5 = sub_19F48();
  if ( !v5 )
    goto LABEL_26;
  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 2u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x16u, (__int64)&unk_2EC98, v5);
LABEL_26:
    v2 = (void **)off_30148;
  }
LABEL_27:
  if ( _bittest(a1, 0xEu) )
  {
    sub_1369C();
    v2 = (void **)off_30148;
  }
  if ( v2 != &off_30148 && _bittest((const signed __int32 *)v2 + 43, 8u) && *((_BYTE *)v2 + 169) >= 5u )
    sub_11008((__int64)v2[19], 0x17u, (__int64)&unk_2EC98);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001369C) ----------------------------------------------------
__int64 sub_1369C()
{
  char v0; // r14
  char *v1; // rax
  char *v2; // r12
  _WORD *v3; // r13
  __int64 v4; // rsi
  __int64 v5; // rbp
  __int16 v6; // ax
  __int64 v7; // rcx
  _WORD *v8; // rdi
  bool v9; // zf
  __int16 v10; // r9
  void **v11; // rcx
  ULONG Value; // [rsp+20h] [rbp-58h] BYREF
  UNICODE_STRING String; // [rsp+28h] [rbp-50h] BYREF
  _BYTE v15[12]; // [rsp+38h] [rbp-40h] BYREF

  *(_WORD *)v15 = 0;
  *(_QWORD *)&v15[2] = 0i64;
  *(_WORD *)&v15[10] = 0;
  Value = 0;
  v0 = 1;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x18u, (__int64)&unk_2EC98);
  }
  v1 = sub_1EAD4();
  v2 = v1;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11068(*((_QWORD *)off_30148 + 19), 0x19u, (__int64)&unk_2EC98, (const wchar_t *)v1);
  }
  v3 = &unk_30460;
  _InterlockedExchange(&dword_304A0, 1);
  word_3049C = 0;
  memset(&unk_30460, 0, 0x3Cui64);
  v4 = 0i64;
  v5 = 0i64;
  do
  {
    while ( 1 )
    {
      v6 = *(_WORD *)&v2[2 * v4];
      if ( v6 == 124 || !v6 || v5 > 5 )
        break;
      *(_WORD *)&v15[2 * v5++] = v6;
      ++v4;
    }
    v7 = -1i64;
    v8 = v15;
    do
    {
      if ( !v7 )
        break;
      v9 = *v8++ == 0;
      --v7;
    }
    while ( !v9 );
    String.Buffer = (PWSTR)v15;
    String.Length = 2 * (-(__int16)v7 - 2);
    String.MaximumLength = String.Length;
    RtlUnicodeStringToInteger(&String, 0, &Value);
    v10 = Value;
    if ( Value - 1 > 0xFFFE )
    {
      v11 = (void **)off_30148;
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 43, 8u)
        && *((_BYTE *)off_30148 + 169) >= 2u )
      {
        sub_1102C(*((_QWORD *)off_30148 + 19), 0x1Bu, (__int64)&unk_2EC98, Value);
        v11 = (void **)off_30148;
      }
    }
    else
    {
      v11 = (void **)off_30148;
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 43, 8u)
        && *((_BYTE *)off_30148 + 169) >= 4u )
      {
        sub_1102C(*((_QWORD *)off_30148 + 19), 0x1Au, (__int64)&unk_2EC98, (unsigned __int16)Value);
        v10 = Value;
        v11 = (void **)off_30148;
      }
      *v3 = v10;
      ++word_3049C;
      ++v3;
    }
    if ( *(_WORD *)&v2[2 * v4] && v4 < 512 )
    {
      v5 = 0i64;
      ++v4;
      *(_QWORD *)v15 = 0i64;
      *(_DWORD *)&v15[8] = 0;
    }
    else
    {
      v0 = 0;
    }
  }
  while ( v0 );
  if ( v11 != &off_30148 && _bittest((const signed __int32 *)v11 + 43, 8u) && *((_BYTE *)v11 + 169) >= 5u )
  {
    sub_11008((__int64)v11[19], 0x58u, (__int64)&unk_2EC08);
    v11 = (void **)off_30148;
  }
  if ( qword_32BA8 )
  {
    sub_1BA64((PERESOURCE)((char *)qword_32BA8 + 216));
    KeLeaveCriticalRegion();
    goto LABEL_42;
  }
  if ( v11 == &off_30148 )
    goto LABEL_47;
  if ( _bittest((const signed __int32 *)v11 + 43, 8u) && *((_BYTE *)v11 + 169) >= 2u )
  {
    sub_11008((__int64)v11[19], 0x59u, (__int64)&unk_2EC08);
LABEL_42:
    v11 = (void **)off_30148;
  }
  if ( v11 != &off_30148 && _bittest((const signed __int32 *)v11 + 43, 8u) && *((_BYTE *)v11 + 169) >= 5u )
    sub_11008((__int64)v11[19], 0x5Au, (__int64)&unk_2EC08);
LABEL_47:
  _InterlockedExchange(&dword_304A0, 0);
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x1Cu, (__int64)&unk_2EC98);
  }
  return 0i64;
}
// 30148: using guessed type void *off_30148;
// 3049C: using guessed type __int16 word_3049C;
// 304A0: using guessed type int dword_304A0;

//----- (00000000000139F8) ----------------------------------------------------
__int64 __fastcall sub_139F8(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, a3, a2, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000013A40) ----------------------------------------------------
__int64 sub_13A40(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_30398(a1, 43i64, &unk_2EC88, a2, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000013A94) ----------------------------------------------------
__int64 sub_13A94()
{
  PVOID v0; // rax
  PVOID v1; // rbx
  unsigned int v2; // ebx
  _QWORD *v3; // rcx
  int v4; // eax
  void **v5; // rcx
  char v6; // al
  int v7; // eax
  int v8; // eax

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0xAu, (__int64)&unk_2EC88);
  v0 = sub_1B038(2, 0x90u, 0x74636370u);
  v1 = v0;
  Timeout = v0;
  if ( !v0 )
  {
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
      sub_1102C(*((_QWORD *)off_30148 + 27), 0xBu, (__int64)&unk_2EC88, 144);
    v2 = 3;
LABEL_40:
    sub_13D60();
    v5 = (void **)off_30148;
    goto LABEL_41;
  }
  memset(v0, 0, 0x90ui64);
  if ( !sub_25094((__int64)v1 + 56) )
  {
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
      sub_11008(*((_QWORD *)off_30148 + 27), 0xCu, (__int64)&unk_2EC88);
    v2 = 1;
    goto LABEL_40;
  }
  v3 = Timeout;
  *(_QWORD *)Timeout = sub_13F38;
  v3[1] = sub_14340;
  v4 = sub_11CB4();
  if ( v4 )
  {
    v5 = (void **)off_30148;
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 4u )
    {
      sub_1102C(*((_QWORD *)off_30148 + 27), 0xDu, (__int64)&unk_2EC88, v4);
      v5 = (void **)off_30148;
    }
    v2 = 0;
  }
  else
  {
    v6 = sub_251B0((PFAST_MUTEX)Timeout + 1);
    *((_BYTE *)Timeout + 136) = v6;
    if ( !v6 )
    {
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 4u )
        sub_11008(*((_QWORD *)off_30148 + 27), 0xEu, (__int64)&unk_2EC88);
      v2 = 6;
      goto LABEL_40;
    }
    v7 = sub_1E604(0x2014001u);
    v8 = sub_13FF0(v7);
    v2 = v8;
    if ( v8 )
    {
      v5 = (void **)off_30148;
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
      {
        sub_1102C(*((_QWORD *)off_30148 + 27), 0xFu, (__int64)&unk_2EC88, v8);
        v5 = (void **)off_30148;
      }
      v2 = (unsigned __int16)v2 | 0xE0020000;
    }
    else
    {
      v5 = (void **)off_30148;
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 4u )
      {
        sub_11008(*((_QWORD *)off_30148 + 27), 0x10u, (__int64)&unk_2EC88);
        v5 = (void **)off_30148;
      }
    }
    if ( v2 )
      goto LABEL_40;
  }
LABEL_41:
  if ( v5 != &off_30148 && (*((_BYTE *)v5 + 236) & 1) != 0 && *((_BYTE *)v5 + 233) >= 5u )
    sub_1102C((__int64)v5[27], 0x11u, (__int64)&unk_2EC88, v2);
  return v2;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000013D60) ----------------------------------------------------
void sub_13D60()
{
  void **v0; // rcx
  PVOID v1; // rax

  v0 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x12u, (__int64)&unk_2EC88);
    v0 = (void **)off_30148;
  }
  v1 = Timeout;
  if ( Timeout )
  {
    if ( *((_BYTE *)Timeout + 136) )
    {
      (*((void (**)(void))Timeout + 2))();
      sub_25210((PFAST_MUTEX)Timeout + 1);
      v1 = Timeout;
    }
    sub_25138((__int64)v1 + 56);
    sub_1B0BC(Timeout, 0x74636370u);
    v0 = (void **)off_30148;
  }
  if ( v0 != &off_30148 && (*((_BYTE *)v0 + 236) & 1) != 0 && *((_BYTE *)v0 + 233) >= 5u )
    sub_11008((__int64)v0[27], 0x13u, (__int64)&unk_2EC88);
}
// 30148: using guessed type void *off_30148;

//----- (0000000000013E40) ----------------------------------------------------
__int64 __fastcall sub_13E40(__m128i *a1)
{
  unsigned int v2; // ebx
  PVOID v3; // rdi

  v2 = 0;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 9u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x14u, (__int64)&unk_2EC88);
  }
  v3 = Timeout;
  memmove((char *)Timeout + 16, &a1[1], 0x28ui64);
  *a1 = _mm_loadu_si128((const __m128i *)v3);
  if ( !*((_BYTE *)v3 + 136) )
  {
    if ( sub_251B0((PFAST_MUTEX)v3 + 1) )
      *((_BYTE *)Timeout + 136) = 1;
    else
      v2 = 1;
  }
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 9u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x15u, (__int64)&unk_2EC88, v2);
  }
  return v2;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000013F38) ----------------------------------------------------
__int64 sub_13F38()
{
  char *v0; // rcx

  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 9u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x16u, (__int64)&unk_2EC88);
  }
  sub_25210((PFAST_MUTEX)Timeout + 1);
  v0 = (char *)Timeout;
  *((_BYTE *)Timeout + 136) = 0;
  memset(v0 + 16, 0, 0x28ui64);
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 9u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x17u, (__int64)&unk_2EC88);
  }
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000013FF0) ----------------------------------------------------
__int64 __fastcall sub_13FF0(int a1)
{
  unsigned int v2; // ebx
  void **v3; // rcx
  __int64 v4; // rcx
  __int64 (__fastcall *v5)(__int64); // rdx
  int v6; // eax

  v2 = 0;
  v3 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 9u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x18u, (__int64)&unk_2EC88);
    v3 = (void **)off_30148;
  }
  if ( Timeout )
  {
    if ( sub_252B8((PFAST_MUTEX)Timeout + 1) )
    {
      v5 = (__int64 (__fastcall *)(__int64))*((_QWORD *)Timeout + 3);
      if ( v5 )
      {
        LOBYTE(v4) = a1 != 0;
        v6 = v5(v4);
        v2 = v6;
        if ( v6 )
        {
          if ( off_30148 != &off_30148
            && _bittest((const signed __int32 *)off_30148 + 43, 9u)
            && *((_BYTE *)off_30148 + 169) >= 2u )
          {
            sub_1102C(*((_QWORD *)off_30148 + 19), 0x1Au, (__int64)&unk_2EC88, v6);
          }
        }
      }
      sub_25320((PFAST_MUTEX)Timeout + 1);
      v3 = (void **)off_30148;
    }
    else
    {
      v3 = (void **)off_30148;
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 43, 9u)
        && *((_BYTE *)off_30148 + 169) >= 2u )
      {
        sub_11008(*((_QWORD *)off_30148 + 19), 0x1Bu, (__int64)&unk_2EC88);
        v3 = (void **)off_30148;
      }
      v2 = 11;
    }
  }
  else
  {
    if ( v3 != &off_30148 && _bittest((const signed __int32 *)v3 + 43, 9u) && *((_BYTE *)v3 + 169) >= 2u )
    {
      sub_11008((__int64)v3[19], (_WORD)Timeout + 25, (__int64)&unk_2EC88);
      v3 = (void **)off_30148;
    }
    v2 = 6;
  }
  if ( v3 != &off_30148 && _bittest((const signed __int32 *)v3 + 43, 9u) && *((_BYTE *)v3 + 169) >= 5u )
    sub_11008((__int64)v3[19], 0x1Cu, (__int64)&unk_2EC88);
  return v2;
}
// 140B7: variable 'v4' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (0000000000014198) ----------------------------------------------------
__int64 __fastcall sub_14198(__int64 a1, __int64 a2)
{
  void **v4; // rcx
  unsigned int v5; // ebx
  int v6; // eax

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 9u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x1Du, (__int64)&unk_2EC88);
    v4 = (void **)off_30148;
  }
  if ( Timeout )
  {
    if ( sub_252B8((PFAST_MUTEX)Timeout + 1) )
    {
      v6 = (*((__int64 (__fastcall **)(__int64, __int64, __int64))Timeout + 4))(a1, a2, a2 + 8);
      v5 = v6;
      if ( v6
        && off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 43, 9u)
        && *((_BYTE *)off_30148 + 169) >= 2u )
      {
        sub_1102C(*((_QWORD *)off_30148 + 19), 0x1Fu, (__int64)&unk_2EC88, v6);
      }
      sub_25320((PFAST_MUTEX)Timeout + 1);
      v4 = (void **)off_30148;
    }
    else
    {
      v4 = (void **)off_30148;
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 43, 9u)
        && *((_BYTE *)off_30148 + 169) >= 2u )
      {
        sub_11008(*((_QWORD *)off_30148 + 19), 0x20u, (__int64)&unk_2EC88);
        v4 = (void **)off_30148;
      }
      v5 = 11;
    }
  }
  else
  {
    if ( v4 != &off_30148 && _bittest((const signed __int32 *)v4 + 43, 9u) && *((_BYTE *)v4 + 169) >= 2u )
    {
      sub_11008((__int64)v4[19], (_WORD)Timeout + 30, (__int64)&unk_2EC88);
      v4 = (void **)off_30148;
    }
    v5 = 6;
  }
  if ( v4 != &off_30148 && _bittest((const signed __int32 *)v4 + 43, 9u) && *((_BYTE *)v4 + 169) >= 5u )
    sub_11008((__int64)v4[19], 0x21u, (__int64)&unk_2EC88);
  return v5;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000014340) ----------------------------------------------------
__int64 __fastcall sub_14340(int a1, __int64 a2, int a3)
{
  unsigned int v6; // ebx
  void **v7; // rcx
  __int64 v8; // rcx
  const char *v9; // r9
  int v10; // eax

  v6 = 0;
  v7 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 9u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x2Cu, (__int64)&unk_2EC88);
    v7 = (void **)off_30148;
  }
  if ( !a2 || !a3 )
  {
    if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 9u) && *((_BYTE *)v7 + 169) >= 2u )
    {
      sub_13A40((__int64)v7[19], 0x2Du, (__int64)&unk_2EC88, a2, a3);
      v7 = (void **)off_30148;
    }
    v6 = 4;
    goto LABEL_35;
  }
  if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 9u) && *((_BYTE *)v7 + 169) >= 3u )
  {
    v8 = (__int64)v7[19];
    v9 = "UNKNOWN";
    if ( !a1 )
      v9 = "CMD_TO_CLI_PORT_LISTEN";
    sub_1113C(v8, 0x2Eu, (__int64)&unk_2EC88, v9);
    v7 = (void **)off_30148;
  }
  if ( !a1 )
  {
    if ( a3 != 64 )
    {
      if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 9u) && *((_BYTE *)v7 + 169) >= 2u )
      {
        sub_139F8((__int64)v7[19], 0x2Fu, (__int64)&unk_2EC88, a3);
        v7 = (void **)off_30148;
      }
      v6 = 6;
      goto LABEL_35;
    }
    v10 = sub_14570(a2, 64);
    v6 = v10;
    if ( v10 )
    {
      v7 = (void **)off_30148;
      if ( off_30148 == &off_30148 )
        return v6;
      if ( !_bittest((const signed __int32 *)off_30148 + 43, 9u) || *((_BYTE *)off_30148 + 169) < 2u )
        goto LABEL_35;
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x30u, (__int64)&unk_2EC88, v10);
    }
    goto LABEL_29;
  }
  if ( v7 == &off_30148 )
    return v6;
  if ( _bittest((const signed __int32 *)v7 + 43, 9u) && *((_BYTE *)v7 + 169) >= 3u )
  {
    sub_11008((__int64)v7[19], 0x31u, (__int64)&unk_2EC88);
LABEL_29:
    v7 = (void **)off_30148;
  }
LABEL_35:
  if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 9u) && *((_BYTE *)v7 + 169) >= 5u )
    sub_11008((__int64)v7[19], 0x32u, (__int64)&unk_2EC88);
  return v6;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000014570) ----------------------------------------------------
__int64 __fastcall sub_14570(__int64 a1, int a2)
{
  void **v4; // rcx
  int v5; // eax
  __m128i v6; // xmm0
  int v7; // eax
  int v8; // eax
  unsigned int v9; // ebx
  int v11; // [rsp+20h] [rbp-48h]
  __int64 v12; // [rsp+30h] [rbp-38h] BYREF
  __int64 v13[5]; // [rsp+38h] [rbp-30h] BYREF

  v12 = 0i64;
  memset(v13, 0, sizeof(v13));
  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 9u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x33u, (__int64)&unk_2EC88);
    v4 = (void **)off_30148;
  }
  if ( !a1 || !a2 )
  {
    if ( v4 != &off_30148 && _bittest((const signed __int32 *)v4 + 43, 9u) && *((_BYTE *)v4 + 169) >= 2u )
    {
      v11 = a2;
      sub_13A40((__int64)v4[19], 0x34u, (__int64)&unk_2EC88, a1, v11);
      v4 = (void **)off_30148;
    }
    v9 = 4;
    goto LABEL_23;
  }
  v12 = *(_QWORD *)a1;
  v13[0] = *(_QWORD *)(a1 + 8);
  if ( *(_BYTE *)(a1 + 16) == 4 )
  {
    v5 = 2048;
  }
  else
  {
    v5 = 34525;
    if ( *(_BYTE *)(a1 + 16) != 6 )
      v5 = 0;
  }
  v6 = _mm_loadu_si128((const __m128i *)(a1 + 24));
  LODWORD(v13[1]) = v5;
  HIDWORD(v13[1]) = *(unsigned __int8 *)(a1 + 17);
  v7 = *(_DWORD *)(a1 + 20);
  *(__m128i *)((char *)&v13[2] + 4) = v6;
  LODWORD(v13[2]) = v7;
  v8 = sub_19598((unsigned __int16 *)&v12);
  v9 = v8;
  if ( !v8 )
    goto LABEL_17;
  v4 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v9;
  if ( _bittest((const signed __int32 *)off_30148 + 43, 9u) && *((_BYTE *)off_30148 + 169) >= 2u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x35u, (__int64)&unk_2EC88, v8);
LABEL_17:
    v4 = (void **)off_30148;
  }
LABEL_23:
  if ( v4 != &off_30148 && _bittest((const signed __int32 *)v4 + 43, 9u) && *((_BYTE *)v4 + 169) >= 5u )
    sub_11008((__int64)v4[19], 0x36u, (__int64)&unk_2EC88);
  return v9;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000014728) ----------------------------------------------------
__int64 __fastcall sub_14728(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+D8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EC78, a2, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000147C8) ----------------------------------------------------
__int64 sub_147C8(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+68h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_30398(a1, 43i64, a3, a2, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014804) ----------------------------------------------------
__int64 sub_14804(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_30398(a1, 43i64, &unk_2EC78, a2, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014860) ----------------------------------------------------
__int64 sub_14860(__int64 a1, __int64 a2, __int64 a3, ...)
{
  __int64 v4; // rcx
  _WORD *v5; // rdi
  bool v6; // zf
  __int64 v8; // [rsp+98h] [rbp+20h] BYREF
  va_list va; // [rsp+98h] [rbp+20h]
  __int64 v10; // [rsp+A0h] [rbp+28h]
  __int64 v11; // [rsp+A8h] [rbp+30h]
  _WORD *v12; // [rsp+B0h] [rbp+38h]
  va_list va1; // [rsp+B8h] [rbp+40h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v8 = va_arg(va1, _QWORD);
  v10 = va_arg(va1, _QWORD);
  v11 = va_arg(va1, _QWORD);
  v12 = va_arg(va1, _WORD *);
  if ( v12 && *v12 )
  {
    v4 = -1i64;
    v5 = v12;
    do
    {
      if ( !v4 )
        break;
      v6 = *v5++ == 0;
      --v4;
    }
    while ( !v6 );
  }
  return qword_30398(a1, 43i64, &unk_2EC78, 20i64, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014930) ----------------------------------------------------
__int64 sub_14930(__int64 a1, __int64 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+78h] [rbp+20h] BYREF
  va_list va; // [rsp+78h] [rbp+20h]
  const char *v7; // [rsp+80h] [rbp+28h]
  va_list va1; // [rsp+88h] [rbp+30h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, const char *);
  if ( v7 )
    strlen(v7);
  return qword_30398(a1, 43i64, &unk_2EC78, 70i64, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000149BC) ----------------------------------------------------
__int64 __fastcall sub_149BC(__int64 a1, __int64 a2, __int64 a3, const wchar_t *a4)
{
  __int64 v5; // rcx
  const wchar_t *v6; // rdi
  bool v7; // zf

  if ( a4 && *a4 )
  {
    v5 = -1i64;
    v6 = a4;
    do
    {
      if ( !v5 )
        break;
      v7 = *v6++ == 0;
      --v5;
    }
    while ( !v7 );
  }
  if ( a4 )
  {
    if ( !*a4 )
      a4 = L"<NULL>";
  }
  else
  {
    a4 = L"NULL";
  }
  return qword_30398(a1, 43i64, &unk_2EC78, 47i64, a4);
}
// 2D210: using guessed type wchar_t aNull_3[7];
// 2D220: using guessed type wchar_t aNull[5];
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014A60) ----------------------------------------------------
__int64 __fastcall sub_14A60(__int64 a1, __int64 a2, __int64 a3, const wchar_t *a4, char a5, char a6, char a7, const char *a8)
{
  __int64 v9; // rcx
  const wchar_t *v10; // rdi
  bool v11; // zf

  if ( a8 )
    strlen(a8);
  if ( a4 && *a4 )
  {
    v9 = -1i64;
    v10 = a4;
    do
    {
      if ( !v9 )
        break;
      v11 = *v10++ == 0;
      --v9;
    }
    while ( !v11 );
  }
  if ( a4 )
  {
    if ( !*a4 )
      a4 = L"<NULL>";
  }
  else
  {
    a4 = L"NULL";
  }
  return qword_30398(a1, 43i64, &unk_2EC78, 37i64, a4);
}
// 2D210: using guessed type wchar_t aNull_3[7];
// 2D220: using guessed type wchar_t aNull[5];
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014B68) ----------------------------------------------------
__int64 __fastcall sub_14B68(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, a3, a2, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014BB4) ----------------------------------------------------
__int64 __fastcall sub_14BB4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EC78, a2, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014C1C) ----------------------------------------------------
__int64 __fastcall sub_14C1C(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EC78, 187i64, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014C80) ----------------------------------------------------
__int64 sub_14C80(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+68h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_30398(a1, 43i64, &unk_2EC78, a2, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014CC4) ----------------------------------------------------
__int64 sub_14CC4(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_30398(a1, 43i64, a3, a2, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014D0C) ----------------------------------------------------
__int64 sub_14D0C(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_30398(a1, 43i64, a3, a2, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014D60) ----------------------------------------------------
__int64 __fastcall sub_14D60(__int64 a1, unsigned __int16 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_30398(a1, 43i64, a3, a2, v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014DC0) ----------------------------------------------------
__int64 __fastcall sub_14DC0(__int64 a1, __int64 a2, __int64 a3, const char *a4)
{
  const char *v5; // rax

  if ( a4 )
    strlen(a4);
  v5 = "NULL";
  if ( a4 )
    v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EC78, 16i64, v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014E58) ----------------------------------------------------
__int64 __fastcall sub_14E58(int a1, __int64 a2, __int64 a3, __int64 a4, int *a5)
{
  char v6; // di
  unsigned int v7; // ebx
  void **v8; // rcx
  unsigned __int16 v9; // dx
  const char *v10; // r9
  __int64 v11; // rdi
  unsigned int v12; // eax
  int v13; // er9
  const char *v14; // rax
  int v15; // eax
  unsigned int v16; // eax
  int v17; // eax
  _QWORD *v18; // rsi
  void **v19; // rcx
  const char *v20; // rax
  __int64 v21; // r8
  int v22; // eax
  _QWORD *v23; // rcx
  unsigned __int16 v24; // dx
  _DWORD *v25; // rax
  int v26; // eax
  int v27; // eax
  int *v28; // rcx
  const char *v29; // rax
  __int64 v30; // r10
  const char *v31; // rbx
  int v32; // eax
  const char *v33; // rcx
  int v34; // eax
  int v35; // eax
  int v36; // er12
  int v37; // eax
  void **v38; // rcx
  const char *v39; // rax
  __int64 v40; // r8
  int v41; // ecx
  _QWORD *v42; // rdi
  const char *v43; // rax
  const char *v44; // rax
  int v45; // eax
  _QWORD *v46; // rcx
  unsigned __int16 v47; // dx
  int v48; // eax
  int v49; // eax
  int v50; // eax
  int v51; // eax
  int v52; // eax
  const char *v53; // rdi
  const char *v54; // r9
  const char *v55; // rax
  bool v56; // cc
  const char *v57; // rax
  int v58; // eax
  __int64 v60; // [rsp+20h] [rbp-518h]
  __int64 v61; // [rsp+30h] [rbp-508h]
  __int64 v62; // [rsp+38h] [rbp-500h]
  bool v63; // [rsp+51h] [rbp-4E7h]
  char v64[2]; // [rsp+52h] [rbp-4E6h] BYREF
  __int16 v65; // [rsp+54h] [rbp-4E4h] BYREF
  unsigned __int16 v66[2]; // [rsp+58h] [rbp-4E0h] BYREF
  char v67[4]; // [rsp+5Ch] [rbp-4DCh] BYREF
  _QWORD *v68; // [rsp+60h] [rbp-4D8h] BYREF
  int *v69; // [rsp+68h] [rbp-4D0h]
  __int64 v70; // [rsp+70h] [rbp-4C8h]
  ULONG_PTR BugCheckParameter1[3]; // [rsp+78h] [rbp-4C0h] BYREF
  char v72; // [rsp+90h] [rbp-4A8h] BYREF
  char Dst[149]; // [rsp+91h] [rbp-4A7h] BYREF
  char v74[160]; // [rsp+130h] [rbp-408h] BYREF
  char v75[160]; // [rsp+1D0h] [rbp-368h] BYREF
  char v76[160]; // [rsp+270h] [rbp-2C8h] BYREF
  char v77[160]; // [rsp+310h] [rbp-228h] BYREF
  char v78[160]; // [rsp+3B0h] [rbp-188h] BYREF
  char v79[160]; // [rsp+450h] [rbp-E8h] BYREF

  v69 = a5;
  v68 = 0i64;
  BugCheckParameter1[0] = 0i64;
  v63 = 0;
  v64[0] = 0;
  v70 = 0i64;
  v6 = 0;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_1102C(*((_QWORD *)off_30148 + 27), 0xAu, (__int64)&unk_2EC78, a1);
  *a5 = 1;
  if ( !(unsigned __int8)sub_1E604(0x2014002u) )
  {
    v7 = 0;
LABEL_226:
    v8 = (void **)off_30148;
    goto LABEL_227;
  }
  if ( a2 )
  {
    if ( !_InterlockedCompareExchange(&dword_303CC, 0, 0) )
    {
      v8 = (void **)off_30148;
      if ( off_30148 == &off_30148 || *((char *)off_30148 + 172) >= 0 || *((_BYTE *)off_30148 + 169) < 2u )
        goto LABEL_19;
      v9 = 12;
LABEL_18:
      sub_11008((__int64)v8[19], v9, (__int64)&unk_2EC78);
      v8 = (void **)off_30148;
LABEL_19:
      v7 = 0;
      goto LABEL_227;
    }
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
      sub_11008(*((_QWORD *)off_30148 + 27), 0xDu, (__int64)&unk_2EC78);
    KeEnterCriticalRegion();
    LODWORD(v60) = 0;
    sub_1B98C(&Resource);
    v6 = 1;
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
      sub_11008(*((_QWORD *)off_30148 + 27), 0xEu, (__int64)&unk_2EC78);
    if ( !_InterlockedCompareExchange(&dword_303CC, 0, 0) )
    {
      v8 = (void **)off_30148;
      if ( off_30148 == &off_30148 || *((char *)off_30148 + 172) >= 0 || *((_BYTE *)off_30148 + 169) < 2u )
        goto LABEL_19;
      v9 = 15;
      goto LABEL_18;
    }
    v8 = (void **)off_30148;
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    {
      v10 = "Original";
      v60 = *(_QWORD *)a2;
      if ( *(_DWORD *)(a2 + 128) == 2 )
        v10 = "Reinjected";
      sub_14DC0(*((_QWORD *)off_30148 + 27), 16i64, (__int64)&unk_2EC78, v10);
      v8 = (void **)off_30148;
    }
    if ( (*(_BYTE *)(a2 + 120) & 8) != 0 )
    {
      BugCheckParameter1[1] = 0i64;
      v11 = 0i64;
      v70 = 0i64;
    }
    else
    {
      v11 = v70;
    }
    v12 = dword_304A4;
    if ( dword_304A4 )
    {
      _InterlockedAdd((volatile signed __int32 *)qword_305B0, 1u);
      v11 = v70;
      v8 = (void **)off_30148;
      v12 = dword_304A4;
    }
    v13 = *(_DWORD *)(a2 + 128);
    if ( v13 != 1 && v13 != 2 )
    {
      if ( v8 != &off_30148 && (*((_BYTE *)v8 + 236) & 0x40) != 0 && *((_BYTE *)v8 + 233) >= 3u )
      {
        sub_14B68((__int64)v8[27], 0x11u, (__int64)&unk_2EC78, v13);
        v8 = (void **)off_30148;
      }
      v7 = 6;
LABEL_51:
      v6 = 1;
      goto LABEL_227;
    }
    if ( !*(_QWORD *)(a2 + 312) )
    {
      if ( v12 > 2 )
      {
        _InterlockedAdd((volatile signed __int32 *)qword_305B0 + 2, 1u);
        v11 = v70;
        v8 = (void **)off_30148;
      }
      if ( v8 != &off_30148 && (*((_BYTE *)v8 + 236) & 0x40) != 0 && *((_BYTE *)v8 + 233) >= 2u )
      {
        sub_11008((__int64)v8[27], 0x12u, (__int64)&unk_2EC78);
        v8 = (void **)off_30148;
      }
      if ( (*(_BYTE *)(a2 + 120) & 4) != 0 )
      {
        v14 = sub_25384(*a5);
        sub_2B518(v74, 0x96ui64, "|PICC-%I64u-%s-unable to get tlsc color|", v11, v14);
        sub_27488(a2, v74, strlen(v74));
        v8 = (void **)off_30148;
      }
      v7 = 0;
      goto LABEL_51;
    }
    if ( v12 > 1 )
    {
      _InterlockedAdd((volatile signed __int32 *)qword_305B0 + 1, 1u);
      v11 = v70;
    }
    sub_1BE30(&FastMutex);
    v15 = sub_1A17C((unsigned __int64 *)(a2 + 312), (__int64 *)&v68, BugCheckParameter1);
    if ( !v15 )
    {
      v63 = 1;
      v16 = sub_1E604(0x2014003u);
      v17 = sub_2AC1C(qword_304A8, BugCheckParameter1[0], v16);
      v18 = v68;
      if ( v17 )
      {
        v19 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          goto LABEL_75;
        if ( (*((_BYTE *)off_30148 + 236) & 0x40) == 0 || *((_BYTE *)off_30148 + 233) < 3u )
        {
LABEL_71:
          if ( v19 != &off_30148 && (*((_BYTE *)v19 + 236) & 0x40) != 0 && *((_BYTE *)v19 + 233) >= 4u )
            sub_14860((__int64)v19[27], 20i64, (__int64)&unk_2EC78, *(_QWORD *)(a2 + 312), *v18, v18[1], v18 + 2);
LABEL_75:
          if ( (*(_BYTE *)(a2 + 120) & 4) != 0 )
          {
            v20 = sub_25384(*v69);
            sub_2B518(
              v76,
              0x96ui64,
              "|PICC-%I64u-%s-pinfo cached: sessionid %I64u name: %ws pid: %I64u tid %I64u|",
              v11,
              v20,
              *(_QWORD *)(a2 + 312),
              v21,
              *v18,
              v18[1]);
            v22 = sub_27488(a2, v76, strlen(v76));
            if ( v22 )
            {
              v23 = off_30148;
              if ( off_30148 != &off_30148
                && (*((_BYTE *)off_30148 + 236) & 0x40) != 0
                && *((_BYTE *)off_30148 + 233) >= 2u )
              {
                v24 = 21;
LABEL_81:
                sub_1102C(v23[27], v24, (__int64)&unk_2EC78, v22);
                goto LABEL_164;
              }
            }
          }
          goto LABEL_164;
        }
        sub_14804(*((_QWORD *)off_30148 + 27), 0x13u, (__int64)&unk_2EC78, *(_QWORD *)(a2 + 312), *v68, v68[1]);
      }
      v19 = (void **)off_30148;
      goto LABEL_71;
    }
    if ( v15 == 5 )
    {
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 4u )
        sub_147C8(*((_QWORD *)off_30148 + 27), 0x16u, (__int64)&unk_2EC78, *(_QWORD *)(a2 + 312), v60);
      if ( *(char *)(a2 + 120) >= 0 )
      {
        v25 = sub_1B578((__int64)qword_304B0);
        v18 = v25;
        v68 = v25;
        if ( !v25 )
        {
LABEL_89:
          sub_1BEFC(&FastMutex);
LABEL_219:
          v7 = 0;
LABEL_220:
          if ( BugCheckParameter1[0] )
            sub_29FA4(qword_304A8, BugCheckParameter1[0]);
          if ( v18 && !v63 )
            sub_1A1D4((__int64)v18);
          v6 = 1;
          goto LABEL_226;
        }
        memset(v25, 0, 0x60ui64);
        v26 = sub_175D4(a2, v18);
        if ( v26 )
        {
          if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
            sub_1102C(*((_QWORD *)off_30148 + 27), 0x17u, (__int64)&unk_2EC78, v26);
          if ( (unsigned int)sub_1E604(0x201400Bu) )
          {
            v27 = sub_1E604(0x201400Eu);
            v28 = v69;
            *v69 = v27;
            if ( off_30148 == &off_30148
              || (*((_BYTE *)off_30148 + 236) & 0x40) == 0
              || *((_BYTE *)off_30148 + 233) < 2u )
            {
LABEL_101:
              if ( (*(_BYTE *)(a2 + 120) & 4) != 0 )
              {
                v31 = sub_25384(*v28);
                v32 = sub_1E604(0x201400Bu);
                v33 = (const char *)qword_2D460;
                if ( v32 )
                  v33 = "ISOLATION";
                sub_2B518(v78, 0x96ui64, "|PICC-%I64u-%s-%s-unable to get proc info|", v11, v33, v31);
                v34 = sub_27488(a2, v78, strlen(v78));
                if ( v34
                  && off_30148 != &off_30148
                  && (*((_BYTE *)off_30148 + 236) & 0x40) != 0
                  && *((_BYTE *)off_30148 + 233) >= 2u )
                {
                  sub_1102C(*((_QWORD *)off_30148 + 27), 0x19u, (__int64)&unk_2EC78, v34);
                }
              }
              goto LABEL_89;
            }
            v29 = sub_25384(v27);
            sub_14D60(*(_QWORD *)(v30 + 216), 0x18u, (__int64)&unk_2EC78, v29);
          }
          v28 = v69;
          goto LABEL_101;
        }
        if ( (unsigned int)sub_193D0((__int64)v18)
          && off_30148 != &off_30148
          && (*((_BYTE *)off_30148 + 236) & 0x40) != 0
          && *((_BYTE *)off_30148 + 233) >= 2u )
        {
          sub_14C80(*((_QWORD *)off_30148 + 27), 0x1Au, (__int64)&unk_2EC78, *v18);
        }
        v35 = sub_24EDC(*v18, v64);
        if ( v64[0] && !v35 )
        {
          if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
            sub_14C80(*((_QWORD *)off_30148 + 27), 0x1Bu, (__int64)&unk_2EC78, *v18);
          *((_DWORD *)v18 + 20) = 1;
        }
        v36 = sub_19FF8((unsigned __int64 *)(a2 + 312), (__int64)v18, (ULONG_PTR **)BugCheckParameter1);
        if ( v36
          && off_30148 != &off_30148
          && (*((_BYTE *)off_30148 + 236) & 0x40) != 0
          && *((_BYTE *)off_30148 + 233) >= 2u )
        {
          sub_1102C(*((_QWORD *)off_30148 + 27), 0x1Cu, (__int64)&unk_2EC78, v36);
        }
        if ( (unsigned int)sub_1E604(0x201400Bu) )
        {
          v37 = sub_15F84(a2, (__int64)v18);
          if ( v37 )
          {
            if ( off_30148 != &off_30148
              && _bittest((const signed __int32 *)off_30148 + 59, 8u)
              && *((_BYTE *)off_30148 + 233) >= 2u )
            {
              sub_1102C(*((_QWORD *)off_30148 + 27), 0x1Du, (__int64)&unk_2EC78, v37);
            }
          }
        }
        if ( !(unsigned int)sub_1E604(0x2014009u) || *((_DWORD *)v18 + 20) )
          goto LABEL_153;
        v66[0] = 0;
        v65 = 0;
        sub_17B0C(a2, v66, v67);
        sub_180C0(a2, &v65);
        if ( sub_19050(v66[0], v65, *v18) )
        {
          if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x20) != 0 && *((_BYTE *)off_30148 + 233) >= 4u )
            sub_14C80(*((_QWORD *)off_30148 + 27), 0x1Eu, (__int64)&unk_2EC78, *v18);
          *(_DWORD *)(a2 + 120) &= 0xFFFFFDFF;
          goto LABEL_153;
        }
        if ( _bittest((const signed __int32 *)(a2 + 120), 9u) )
        {
          v38 = (void **)off_30148;
          if ( off_30148 == &off_30148 || (*((_BYTE *)off_30148 + 236) & 0x20) == 0 || *((_BYTE *)off_30148 + 233) < 4u )
          {
LABEL_147:
            if ( _bittest((const signed __int32 *)(a2 + 120), 0xDu) )
            {
              if ( v38 == &off_30148 || (*((_BYTE *)v38 + 236) & 0x20) == 0 || *((_BYTE *)v38 + 233) < 4u )
              {
LABEL_154:
                v63 = v36 == 0;
                if ( v38 != &off_30148 && (*((_BYTE *)v38 + 236) & 0x40) != 0 && *((_BYTE *)v38 + 233) >= 4u )
                  sub_14804((__int64)v38[27], 0x21u, (__int64)&unk_2EC78, *(_QWORD *)(a2 + 312), *v18, v18[1]);
                if ( (*(_BYTE *)(a2 + 120) & 4) != 0 )
                {
                  v39 = sub_25384(*v69);
                  sub_2B518(
                    v75,
                    0x96ui64,
                    "|PICC-%I64u-%s-pinfo added: sessionid: %I64u name: %ws pid: %I64u tid %I64u|",
                    v11,
                    v39,
                    *(_QWORD *)(a2 + 312),
                    v40,
                    *v18,
                    v18[1]);
                  v22 = sub_27488(a2, v75, strlen(v75));
                  if ( v22 )
                  {
                    v23 = off_30148;
                    if ( off_30148 != &off_30148
                      && (*((_BYTE *)off_30148 + 236) & 0x40) != 0
                      && *((_BYTE *)off_30148 + 233) >= 2u )
                    {
                      v24 = 34;
                      goto LABEL_81;
                    }
                  }
                }
LABEL_164:
                sub_1BEFC(&FastMutex);
                v41 = *((_DWORD *)v18 + 20);
                if ( v41 )
                {
                  v42 = off_30148;
                  if ( off_30148 != &off_30148
                    && _bittest((const signed __int32 *)off_30148 + 59, 8u)
                    && *((_BYTE *)off_30148 + 233) >= 5u )
                  {
                    v43 = sub_255BC(v41);
                    sub_14A60(
                      v42[27],
                      37i64,
                      (__int64)&unk_2EC78,
                      (const wchar_t *)v18 + 8,
                      *v18,
                      v18[1],
                      *(_QWORD *)(a2 + 312),
                      v43);
                  }
                  if ( *((_DWORD *)v18 + 20) == 1 )
                  {
                    *(_DWORD *)(a2 + 120) |= 0x100u;
                  }
                  else if ( *((int *)v18 + 20) >= 2 && *((int *)v18 + 20) <= 5 )
                  {
                    *v69 = 3;
                  }
                  if ( (*(_BYTE *)(a2 + 120) & 4) == 0 )
                    goto LABEL_205;
                  v44 = sub_255BC(*((_DWORD *)v18 + 20));
                  sub_2B518(v77, 0x96ui64, "|PICC-Excluded: %s|", v44);
                  v45 = sub_27488(a2, v77, strlen(v77));
                  if ( !v45 )
                    goto LABEL_205;
                  v46 = off_30148;
                  if ( off_30148 == &off_30148
                    || (*((_BYTE *)off_30148 + 236) & 0x40) == 0
                    || *((_BYTE *)off_30148 + 233) < 2u )
                  {
                    goto LABEL_205;
                  }
                  v47 = 38;
                }
                else
                {
                  if ( !(unsigned int)sub_1E604(0x201400Bu) || (*(_BYTE *)(a2 + 120) & 4) == 0 )
                    goto LABEL_205;
                  v72 = 0;
                  memset(Dst, 0, sizeof(Dst));
                  v48 = *((_DWORD *)v18 + 21);
                  if ( v48 )
                  {
                    v49 = v48 - 1;
                    if ( v49 )
                    {
                      v50 = v49 - 1;
                      if ( v50 )
                      {
                        v51 = v50 - 1;
                        if ( v51 )
                        {
                          v52 = v51 - 1;
                          if ( v52 )
                          {
                            if ( v52 == 1 )
                              v53 = "DANGEROUS";
                            else
                              v53 = "NO STRING";
                          }
                          else
                          {
                            v53 = "HIGH";
                          }
                        }
                        else
                        {
                          v53 = "MEDIUM";
                        }
                      }
                      else
                      {
                        v53 = "LOW";
                      }
                    }
                    else
                    {
                      v53 = "SAFE";
                    }
                  }
                  else
                  {
                    v53 = "UNKNOWN";
                  }
                  v54 = "FALSE";
                  v55 = "FALSE";
                  if ( *((_BYTE *)v18 + 88) )
                    v55 = "TRUE";
                  if ( *((_BYTE *)v18 + 89) )
                    v54 = "TRUE";
                  LODWORD(v61) = *((unsigned __int8 *)v18 + 90);
                  LODWORD(v62) = *((unsigned __int8 *)v18 + 91);
                  sub_2B518(
                    &v72,
                    0x96ui64,
                    "|PICC-NotExcluded. Analyzed: %s PandaSigned: %s RiskLevel: %s MngStatus: %d MngIsolatStatus:%d|",
                    v54,
                    v55,
                    v53,
                    v61,
                    v62);
                  v45 = sub_27488(a2, &v72, strlen(&v72));
                  if ( !v45 )
                    goto LABEL_205;
                  v46 = off_30148;
                  if ( off_30148 == &off_30148
                    || (*((_BYTE *)off_30148 + 236) & 0x40) == 0
                    || *((_BYTE *)off_30148 + 233) < 2u )
                  {
                    goto LABEL_205;
                  }
                  v47 = 39;
                }
                sub_1102C(v46[27], v47, (__int64)&unk_2EC78, v45);
LABEL_205:
                v56 = (unsigned int)dword_304A4 <= 3;
                v7 = 0;
                *(_QWORD *)(a2 + 344) = *v18;
                *(_QWORD *)(a2 + 352) = v18[1];
                if ( !v56 )
                {
                  _InterlockedAdd((volatile signed __int32 *)qword_305B0 + 3, 1u);
                  v18 = v68;
                }
                goto LABEL_220;
              }
              sub_11008((__int64)v38[27], 0x20u, (__int64)&unk_2EC78);
            }
            else
            {
              sub_182E4(a2, a2 + 312, v18);
            }
LABEL_153:
            v38 = (void **)off_30148;
            goto LABEL_154;
          }
          sub_11008(*((_QWORD *)off_30148 + 27), 0x1Fu, (__int64)&unk_2EC78);
        }
        v38 = (void **)off_30148;
        goto LABEL_147;
      }
    }
    else
    {
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
      {
        LODWORD(v60) = v15;
        sub_1DC74(*((_QWORD *)off_30148 + 27), 0x23u, (__int64)&unk_2EC78, *(_QWORD *)(a2 + 312), v60);
      }
      if ( (*(_BYTE *)(a2 + 120) & 4) != 0 )
      {
        v57 = sub_25384(*a5);
        sub_2B518(v79, 0x96ui64, "|PICC-%I64u-%s-error retrieving proc info from cache|", v11, v57);
        v58 = sub_27488(a2, v79, strlen(v79));
        if ( v58 )
        {
          if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
            sub_1102C(*((_QWORD *)off_30148 + 27), 0x24u, (__int64)&unk_2EC78, v58);
        }
      }
    }
    sub_1BEFC(&FastMutex);
    v18 = v68;
    goto LABEL_219;
  }
  v8 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0xBu, (__int64)&unk_2EC78);
    v8 = (void **)off_30148;
  }
  v7 = 4;
LABEL_227:
  if ( *(char *)(a2 + 120) < 0 && *(_QWORD *)(a2 + 312) )
  {
    sub_16928((unsigned __int64 *)(a2 + 312), 0);
    v8 = (void **)off_30148;
  }
  if ( v8 != &off_30148 && (*((_BYTE *)v8 + 236) & 0x40) != 0 && *((_BYTE *)v8 + 233) >= 5u )
    sub_11008((__int64)v8[27], 0x2Au, (__int64)&unk_2EC78);
  if ( v6 )
    sub_1BA64(&Resource);
  KeLeaveCriticalRegion();
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_1102C(*((_QWORD *)off_30148 + 27), 0x2Bu, (__int64)&unk_2EC78, v7);
  return v7;
}
// 153DE: variable 'v21' is possibly undefined
// 154AA: variable 'v60' is possibly undefined
// 155A4: variable 'v30' is possibly undefined
// 159F1: variable 'v40' is possibly undefined
// 15C9A: variable 'v61' is possibly undefined
// 15C9A: variable 'v62' is possibly undefined
// 2D460: using guessed type __int64 qword_2D460[2];
// 30148: using guessed type void *off_30148;
// 303CC: using guessed type int dword_303CC;
// 304A4: using guessed type int dword_304A4;

//----- (0000000000015F84) ----------------------------------------------------
__int64 __fastcall sub_15F84(__int64 a1, __int64 a2)
{
  unsigned int v4; // er14
  _DWORD *v5; // r12
  char *v6; // r13
  void **v7; // rcx
  __int64 v8; // rcx
  int v9; // eax
  void **v10; // rdi
  unsigned __int16 v11; // dx
  void **v12; // rcx
  char *v13; // rax
  __int64 *v14; // rax
  void **v15; // r9
  unsigned __int16 v16; // dx
  __int64 v17; // rcx
  const wchar_t *v18; // rdi
  bool v19; // zf
  __int64 v20; // rcx
  unsigned int v22; // edi
  unsigned int v23; // ebp
  _DWORD *v24; // rax
  int v25; // eax
  int v26; // ecx
  const char *v27; // rax
  int v28; // eax
  unsigned int v29; // [rsp+70h] [rbp+8h] BYREF
  int v30; // [rsp+80h] [rbp+18h] BYREF
  const wchar_t **v31; // [rsp+88h] [rbp+20h] BYREF

  v4 = 4;
  v5 = 0i64;
  v31 = 0i64;
  v29 = 0;
  v6 = 0i64;
  v30 = 4;
  v7 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 59, 8u)
    && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x2Cu, (__int64)&unk_2EC78);
    v7 = (void **)off_30148;
  }
  if ( !a1 || !a2 )
  {
    if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 59, 8u) && *((_BYTE *)v7 + 233) >= 2u )
      sub_14CC4((__int64)v7[27], 0x2Du, (__int64)&unk_2EC78, a1, a2);
    return v4;
  }
  v8 = *(_QWORD *)a2;
  *(_DWORD *)(a2 + 80) = 0;
  *(_BYTE *)(a2 + 89) = 0;
  *(_DWORD *)(a2 + 84) = 0;
  *(_BYTE *)(a2 + 88) = 0;
  *(_BYTE *)(a2 + 90) = 0;
  *(_BYTE *)(a2 + 91) = 0;
  v9 = sub_24988(v8, &v31, &v29);
  v4 = v9;
  if ( v9 )
  {
    v10 = (void **)off_30148;
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 59, 8u)
      && *((_BYTE *)off_30148 + 233) >= 2u )
    {
      v11 = 46;
LABEL_12:
      sub_1102C((__int64)v10[27], v11, (__int64)&unk_2EC78, v9);
LABEL_13:
      v10 = (void **)off_30148;
      goto LABEL_79;
    }
    goto LABEL_79;
  }
  v12 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 59, 8u)
    && *((_BYTE *)off_30148 + 233) >= 4u )
  {
    sub_149BC(*((_QWORD *)off_30148 + 27), 47i64, (__int64)&unk_2EC78, v31[3]);
    v12 = (void **)off_30148;
  }
  if ( !_bittest((const signed __int32 *)(a1 + 120), 0xCu) )
  {
    if ( !wcsicmp(v31[3], L"System") )
    {
      v10 = (void **)off_30148;
      if ( off_30148 == &off_30148
        || !_bittest((const signed __int32 *)off_30148 + 59, 8u)
        || *((_BYTE *)off_30148 + 233) < 5u )
      {
        goto LABEL_79;
      }
      v16 = 53;
LABEL_47:
      sub_11008((__int64)v10[27], v16, (__int64)&unk_2EC78);
      goto LABEL_13;
    }
    goto LABEL_53;
  }
  if ( v12 != &off_30148 && _bittest((const signed __int32 *)v12 + 59, 8u) && *((_BYTE *)v12 + 233) >= 4u )
    sub_11068((__int64)v12[27], 0x30u, (__int64)&unk_2EC78, v31[3]);
  v13 = (char *)sub_1B038(1, 0x200u, 0x56534950u);
  v6 = v13;
  if ( v13 )
  {
    memset(v13, 0, 0x100ui64);
    v14 = qword_2D5F0;
    if ( P )
      v14 = (__int64 *)P;
    sub_2B5E4(v6, 0xFFui64, 0xFFui64, L"%sSystem32\\%s", v14, L"svchost.exe");
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 59, 8u)
      && *((_BYTE *)off_30148 + 233) >= 4u )
    {
      sub_11068(*((_QWORD *)off_30148 + 27), 0x31u, (__int64)&unk_2EC78, (const wchar_t *)v6);
    }
    if ( sub_275E8(v31[3], (unsigned __int16 *)v6) )
    {
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 59, 8u)
        && *((_BYTE *)off_30148 + 233) >= 5u )
      {
        sub_11008(*((_QWORD *)off_30148 + 27), 0x32u, (__int64)&unk_2EC78);
      }
      *(_DWORD *)(a2 + 80) = 2;
      goto LABEL_13;
    }
    goto LABEL_40;
  }
  v15 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 59, 8u)
    && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x33u, (__int64)&unk_2EC78);
LABEL_40:
    v15 = (void **)off_30148;
  }
  if ( *(_DWORD *)(a2 + 80) != 2 )
  {
    if ( !wcsicmp(v31[3], L"System") )
    {
      *(_DWORD *)(a2 + 80) = 2;
      v10 = (void **)off_30148;
      if ( off_30148 == &off_30148
        || !_bittest((const signed __int32 *)off_30148 + 59, 8u)
        || *((_BYTE *)off_30148 + 233) < 5u )
      {
        goto LABEL_79;
      }
      v16 = 52;
      goto LABEL_47;
    }
LABEL_53:
    v15 = (void **)off_30148;
  }
  v17 = -1i64;
  v18 = v31[3];
  do
  {
    if ( !v17 )
      break;
    v19 = *v18++ == 0;
    --v17;
  }
  while ( !v19 );
  v20 = -v17 - 2;
  if ( v20 )
  {
    v22 = 2 * v20;
    v23 = 2 * v20 + 18;
    v24 = sub_1B038(1, v23, 0x494D4950u);
    v5 = v24;
    if ( v24 )
    {
      memset(v24, 0, v23);
      v5[3] = v22;
      sub_2B608(v5 + 4, v22 + 1, v31[3], v22);
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 59, 8u)
        && *((_BYTE *)off_30148 + 233) >= 2u )
      {
        sub_11068(*((_QWORD *)off_30148 + 27), 0x38u, (__int64)&unk_2EC78, v31[3]);
      }
      v25 = sub_1E604(0x201400Cu);
      v9 = sub_211B4(40040i64, v5, v23, v25, &v30);
      v4 = v9;
      if ( v9 )
      {
        v10 = (void **)off_30148;
        if ( off_30148 != &off_30148
          && _bittest((const signed __int32 *)off_30148 + 59, 8u)
          && *((_BYTE *)off_30148 + 233) >= 2u )
        {
          v11 = 57;
          goto LABEL_12;
        }
LABEL_79:
        v26 = *(_DWORD *)(a2 + 80);
        if ( v26 )
        {
          if ( v10 != &off_30148 && _bittest((const signed __int32 *)v10 + 59, 8u) && *((_BYTE *)v10 + 233) >= 4u )
          {
            v27 = sub_255BC(v26);
            sub_14D60((__int64)v10[27], 0x3Au, (__int64)&unk_2EC78, v27);
LABEL_88:
            v10 = (void **)off_30148;
            goto LABEL_89;
          }
        }
        else if ( v10 != &off_30148 && _bittest((const signed __int32 *)v10 + 59, 8u) && *((_BYTE *)v10 + 233) >= 4u )
        {
          sub_11008((__int64)v10[27], 0x3Bu, (__int64)&unk_2EC78);
          goto LABEL_88;
        }
LABEL_89:
        if ( v5 )
        {
          sub_1B0BC(v5, 0x494D4950u);
          v10 = (void **)off_30148;
        }
        if ( !v31 )
          goto LABEL_98;
        v28 = sub_24DCC((PVOID *)&v31);
        if ( v28 )
        {
          v10 = (void **)off_30148;
          if ( off_30148 == &off_30148
            || !_bittest((const signed __int32 *)off_30148 + 59, 8u)
            || *((_BYTE *)off_30148 + 233) < 2u )
          {
            goto LABEL_98;
          }
          sub_1102C(*((_QWORD *)off_30148 + 27), 0x3Cu, (__int64)&unk_2EC78, v28);
        }
        v10 = (void **)off_30148;
LABEL_98:
        if ( v6 )
        {
          sub_1B0BC(v6, 0x56534950u);
          v10 = (void **)off_30148;
        }
        if ( v10 != &off_30148 && _bittest((const signed __int32 *)v10 + 59, 8u) && *((_BYTE *)v10 + 233) >= 5u )
          sub_11008((__int64)v10[27], 0x3Du, (__int64)&unk_2EC78);
        return v4;
      }
      *(_DWORD *)(a2 + 80) = *v5;
      *(_DWORD *)(a2 + 84) = v5[1];
      *(_BYTE *)(a2 + 88) = *((_BYTE *)v5 + 8);
      *(_BYTE *)(a2 + 89) = *((_BYTE *)v5 + 9);
      *(_BYTE *)(a2 + 90) = *((_BYTE *)v5 + 10);
      *(_BYTE *)(a2 + 91) = *((_BYTE *)v5 + 11);
    }
    else
    {
      v10 = (void **)off_30148;
      if ( off_30148 == &off_30148
        || !_bittest((const signed __int32 *)off_30148 + 59, 8u)
        || *((_BYTE *)off_30148 + 233) < 2u )
      {
        goto LABEL_79;
      }
      sub_1102C(*((_QWORD *)off_30148 + 27), 0x37u, (__int64)&unk_2EC78, v23);
    }
    v10 = (void **)off_30148;
    goto LABEL_79;
  }
  if ( v15 != &off_30148 && _bittest((const signed __int32 *)v15 + 59, 8u) && *((_BYTE *)v15 + 233) >= 2u )
    sub_11008((__int64)v15[27], 0x36u, (__int64)&unk_2EC78);
  return 4i64;
}
// 2D5D0: using guessed type wchar_t aSvchostExe[12];
// 2D5F0: using guessed type __int64 qword_2D5F0[2];
// 2D600: using guessed type wchar_t aSsystem32S[14];
// 30148: using guessed type void *off_30148;

//----- (00000000000166E8) ----------------------------------------------------
__int64 __fastcall sub_166E8(void *a1, __int64 a2, const void *a3)
{
  void **v6; // rcx
  __int64 result; // rax

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 59, 8u)
    && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x3Eu, (__int64)&unk_2EC78);
    v6 = (void **)off_30148;
  }
  if ( a1 && a2 && a3 )
  {
    sub_2B608(a1, 0x12ui64, a3, 0x12ui64);
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 59, 8u)
      && *((_BYTE *)off_30148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_30148 + 27), 0x40u, (__int64)&unk_2EC78);
    }
    result = 0i64;
  }
  else
  {
    if ( v6 != &off_30148 && _bittest((const signed __int32 *)v6 + 59, 8u) && *((_BYTE *)v6 + 233) >= 2u )
      sub_14D0C((__int64)v6[27], 0x3Fu, (__int64)&unk_2EC78, a1, a2, a3);
    result = 4i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000016808) ----------------------------------------------------
__int64 __fastcall sub_16808(int a1, __int64 a2)
{
  void **v4; // rcx

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_30148 + 27), 0x41u, (__int64)&unk_2EC78);
      v4 = (void **)off_30148;
    }
    if ( v4 != &off_30148 && (*((_BYTE *)v4 + 236) & 0x40) != 0 && *((_BYTE *)v4 + 233) >= 5u )
    {
      sub_1102C((__int64)v4[27], 0x42u, (__int64)&unk_2EC78, a1);
      v4 = (void **)off_30148;
    }
  }
  if ( a2 )
  {
    sub_16928((unsigned __int64 *)a2, *(_BYTE *)(a2 + 8));
LABEL_15:
    v4 = (void **)off_30148;
    goto LABEL_16;
  }
  if ( v4 == &off_30148 )
    return 0i64;
  if ( (*((_BYTE *)v4 + 236) & 0x40) != 0 && *((_BYTE *)v4 + 233) >= 2u )
  {
    sub_11008((__int64)v4[27], 0x43u, (__int64)&unk_2EC78);
    goto LABEL_15;
  }
LABEL_16:
  if ( v4 != &off_30148 && (*((_BYTE *)v4 + 236) & 0x40) != 0 && *((_BYTE *)v4 + 233) >= 5u )
    sub_11008((__int64)v4[27], 0x44u, (__int64)&unk_2EC78);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000016928) ----------------------------------------------------
__int64 __fastcall sub_16928(unsigned __int64 *a1, char a2)
{
  void **v4; // rcx
  __int64 v5; // rcx
  const char *v6; // rax
  int v7; // eax
  void **v8; // rcx
  unsigned __int16 v9; // dx
  ULONG_PTR v10; // rdx
  ULONG_PTR v11; // rcx
  __int64 v12; // r8
  unsigned __int16 v13; // dx
  unsigned __int64 v14; // rdx
  __int64 v16; // [rsp+20h] [rbp-28h]
  __int64 v17; // [rsp+60h] [rbp+18h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+68h] [rbp+20h] BYREF

  v17 = 0i64;
  BugCheckParameter1 = 0i64;
  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( *((char *)off_30148 + 236) < 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_30148 + 27), 0x45u, (__int64)&unk_2EC78);
      v4 = (void **)off_30148;
    }
    if ( v4 != &off_30148 && *((char *)v4 + 236) < 0 && *((_BYTE *)v4 + 233) >= 4u )
    {
      v5 = (__int64)v4[27];
      v6 = "FALSE";
      if ( a2 )
        v6 = "TRUE";
      sub_14930(v5, 70i64, (__int64)&unk_2EC78, *a1, v6);
    }
  }
  v7 = sub_1A17C(a1, &v17, &BugCheckParameter1);
  if ( !v7 )
  {
    v10 = BugCheckParameter1;
    v11 = qword_304A8;
    *(_BYTE *)(v17 + 92) = a2;
    sub_29FA4(v11, v10);
    if ( a2 )
    {
      v8 = (void **)off_30148;
      if ( off_30148 == &off_30148 )
        return 0i64;
      if ( (*((_BYTE *)off_30148 + 236) & 0x40) == 0 || *((_BYTE *)off_30148 + 233) < 5u )
        goto LABEL_33;
      v13 = 72;
    }
    else
    {
      v14 = *a1;
      LODWORD(v17) = 0;
      LOBYTE(v12) = 1;
      sub_294DC(qword_304A8, v14, v12, &v17);
      if ( (_DWORD)v17 )
      {
        v8 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          return 0i64;
        if ( *((char *)off_30148 + 236) >= 0 || *((_BYTE *)off_30148 + 233) < 2u )
          goto LABEL_33;
        v9 = 73;
        LODWORD(v16) = 1;
        goto LABEL_16;
      }
      v8 = (void **)off_30148;
      if ( off_30148 == &off_30148 )
        return 0i64;
      if ( *((char *)off_30148 + 236) >= 0 || *((_BYTE *)off_30148 + 233) < 4u )
        goto LABEL_33;
      v13 = 74;
    }
    sub_147C8((__int64)v8[27], v13, (__int64)&unk_2EC78, *a1);
    goto LABEL_32;
  }
  v8 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return 0i64;
  if ( *((char *)off_30148 + 236) < 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    v9 = 71;
    LODWORD(v16) = v7;
LABEL_16:
    sub_1DC74((__int64)v8[27], v9, (__int64)&unk_2EC78, *a1, v16);
LABEL_32:
    v8 = (void **)off_30148;
  }
LABEL_33:
  if ( v8 != &off_30148 && *((char *)v8 + 236) < 0 && *((_BYTE *)v8 + 233) >= 5u )
    sub_11008((__int64)v8[27], 0x4Bu, (__int64)&unk_2EC78);
  return 0i64;
}
// 16A2C: variable 'v16' is possibly undefined
// 16AA0: variable 'v12' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (0000000000016B60) ----------------------------------------------------
__int64 __fastcall sub_16B60(int a1, _QWORD *a2)
{
  void **v4; // rcx

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_30148 + 27), 0x4Cu, (__int64)&unk_2EC78);
      v4 = (void **)off_30148;
    }
    if ( v4 != &off_30148 && (*((_BYTE *)v4 + 236) & 0x40) != 0 && *((_BYTE *)v4 + 233) >= 5u )
    {
      sub_1102C((__int64)v4[27], 0x4Du, (__int64)&unk_2EC78, a1);
      v4 = (void **)off_30148;
    }
  }
  if ( a2 )
  {
    sub_16F38(a2);
LABEL_15:
    v4 = (void **)off_30148;
    goto LABEL_16;
  }
  if ( v4 == &off_30148 )
    return 0i64;
  if ( (*((_BYTE *)v4 + 236) & 0x40) != 0 && *((_BYTE *)v4 + 233) >= 2u )
  {
    sub_11008((__int64)v4[27], 0x4Eu, (__int64)&unk_2EC78);
    goto LABEL_15;
  }
LABEL_16:
  if ( v4 != &off_30148 && (*((_BYTE *)v4 + 236) & 0x40) != 0 && *((_BYTE *)v4 + 233) >= 5u )
    sub_11008((__int64)v4[27], 0x4Fu, (__int64)&unk_2EC78);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000016C80) ----------------------------------------------------
__int64 __fastcall sub_16C80(int a1, int *a2)
{
  void **v4; // rcx
  int v5; // eax
  unsigned __int16 v6; // dx

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_30148 + 27), 0x50u, (__int64)&unk_2EC78);
      v4 = (void **)off_30148;
    }
    if ( v4 != &off_30148 && (*((_BYTE *)v4 + 236) & 0x40) != 0 && *((_BYTE *)v4 + 233) >= 5u )
    {
      sub_1102C((__int64)v4[27], 0x51u, (__int64)&unk_2EC78, a1);
      v4 = (void **)off_30148;
    }
  }
  if ( !a2 )
  {
    if ( v4 == &off_30148 )
      return 0i64;
    if ( (*((_BYTE *)v4 + 236) & 0x40) == 0 || *((_BYTE *)v4 + 233) < 2u )
      goto LABEL_25;
    v6 = 84;
    goto LABEL_23;
  }
  v5 = sub_1A974(a2);
  if ( v5 )
  {
    v4 = (void **)off_30148;
    if ( off_30148 == &off_30148 )
      return 0i64;
    if ( (*((_BYTE *)off_30148 + 236) & 0x40) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
      goto LABEL_25;
    sub_1102C(*((_QWORD *)off_30148 + 27), 0x53u, (__int64)&unk_2EC78, v5);
    goto LABEL_24;
  }
  v4 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return 0i64;
  if ( (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 4u )
  {
    v6 = 82;
LABEL_23:
    sub_11008((__int64)v4[27], v6, (__int64)&unk_2EC78);
LABEL_24:
    v4 = (void **)off_30148;
  }
LABEL_25:
  if ( v4 != &off_30148 && (*((_BYTE *)v4 + 236) & 0x40) != 0 && *((_BYTE *)v4 + 233) >= 5u )
    sub_11008((__int64)v4[27], 0x55u, (__int64)&unk_2EC78);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000016E04) ----------------------------------------------------
__int64 sub_16E04()
{
  int v0; // eax
  unsigned int v1; // ebx
  void **v2; // rcx
  int v4; // [rsp+20h] [rbp-28h] BYREF
  char Dst[18]; // [rsp+24h] [rbp-24h] BYREF

  v4 = 0;
  memset(Dst, 0, sizeof(Dst));
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0x56u, (__int64)&unk_2EC78);
  v0 = sub_243E0(40042, &v4, 0x16u);
  v1 = v0;
  if ( v0 )
  {
    v2 = (void **)off_30148;
    if ( off_30148 == &off_30148 )
      return v1;
    if ( (*((_BYTE *)off_30148 + 236) & 1) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
      goto LABEL_15;
    sub_1102C(*((_QWORD *)off_30148 + 27), 0x58u, (__int64)&unk_2EC78, v0);
    goto LABEL_14;
  }
  v2 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v1;
  if ( (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 4u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x57u, (__int64)&unk_2EC78);
LABEL_14:
    v2 = (void **)off_30148;
  }
LABEL_15:
  if ( v2 != &off_30148 && (*((_BYTE *)v2 + 236) & 1) != 0 && *((_BYTE *)v2 + 233) >= 5u )
    sub_11008((__int64)v2[27], 0x59u, (__int64)&unk_2EC78);
  return v1;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000016F38) ----------------------------------------------------
__int64 __fastcall sub_16F38(_QWORD *a1)
{
  void **v2; // rcx
  int v3; // eax
  __int64 v4; // r8
  void **v5; // rcx
  __int64 *v6; // rdi
  unsigned __int16 v7; // cx
  __int16 v8; // dx
  void **v9; // rcx
  unsigned __int16 v10; // dx
  int v11; // eax
  unsigned __int64 v12; // rdx
  __int64 v14; // [rsp+20h] [rbp-28h]
  __int64 v15; // [rsp+58h] [rbp+10h] BYREF
  ULONG_PTR BugCheckParameter1; // [rsp+60h] [rbp+18h] BYREF

  v15 = 0i64;
  BugCheckParameter1 = 0i64;
  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)off_30148 + 59, 0xCu) && *((_BYTE *)off_30148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_30148 + 27), 0x5Au, (__int64)&unk_2EC78);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 && _bittest((const signed __int32 *)v2 + 59, 0xCu) && *((_BYTE *)v2 + 233) >= 4u )
      sub_147C8((__int64)v2[27], 0x5Bu, (__int64)&unk_2EC78, *a1);
  }
  v3 = sub_1A17C(a1, &v15, &BugCheckParameter1);
  if ( !v3 )
  {
    v6 = (__int64 *)v15;
    if ( *(_DWORD *)(v15 + 80) )
    {
      v9 = (void **)off_30148;
      if ( off_30148 == &off_30148
        || !_bittest((const signed __int32 *)off_30148 + 59, 0xCu)
        || *((_BYTE *)off_30148 + 233) < 5u )
      {
        goto LABEL_37;
      }
      v10 = 95;
    }
    else
    {
      if ( *((_DWORD *)a1 + 2) )
        v7 = *((_WORD *)a1 + 6);
      else
        v7 = *((_WORD *)a1 + 7);
      if ( *((_DWORD *)a1 + 2) == 1 )
        v8 = *((_WORD *)a1 + 7);
      else
        v8 = *((_WORD *)a1 + 6);
      if ( !sub_19050(v7, v8, *(_QWORD *)v15) )
      {
        v11 = sub_191F0(v6, (__int64)a1);
        if ( v11 )
        {
          v9 = (void **)off_30148;
          if ( off_30148 == &off_30148
            || !_bittest((const signed __int32 *)off_30148 + 59, 0xCu)
            || *((_BYTE *)off_30148 + 233) < 2u )
          {
            goto LABEL_37;
          }
          sub_1DC74(*((_QWORD *)off_30148 + 27), 0x5Eu, (__int64)&unk_2EC78, *a1, v11);
        }
        goto LABEL_36;
      }
      v9 = (void **)off_30148;
      if ( off_30148 == &off_30148
        || !_bittest((const signed __int32 *)off_30148 + 59, 0xCu)
        || *((_BYTE *)off_30148 + 233) < 4u )
      {
        goto LABEL_37;
      }
      v10 = 93;
    }
    sub_14C80((__int64)v9[27], v10, (__int64)&unk_2EC78, *v6);
LABEL_36:
    v9 = (void **)off_30148;
LABEL_37:
    if ( *((_BYTE *)v6 + 92) )
    {
      if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 59, 0xCu) && *((_BYTE *)v9 + 233) >= 4u )
        sub_147C8((__int64)v9[27], 0x60u, (__int64)&unk_2EC78, *a1);
      v12 = *a1;
      LODWORD(v15) = 0;
      LOBYTE(v4) = 1;
      sub_294DC(qword_304A8, v12, v4, &v15);
      if ( (_DWORD)v15 )
      {
        if ( off_30148 != &off_30148
          && _bittest((const signed __int32 *)off_30148 + 59, 0xCu)
          && *((_BYTE *)off_30148 + 233) >= 2u )
        {
          LODWORD(v14) = 1;
          sub_1DC74(*((_QWORD *)off_30148 + 27), 0x61u, (__int64)&unk_2EC78, *a1, v14);
        }
      }
      else if ( off_30148 != &off_30148
             && _bittest((const signed __int32 *)off_30148 + 59, 0xCu)
             && *((_BYTE *)off_30148 + 233) >= 4u )
      {
        sub_147C8(*((_QWORD *)off_30148 + 27), 0x62u, (__int64)&unk_2EC78, *a1);
      }
    }
    sub_29FA4(qword_304A8, BugCheckParameter1);
    goto LABEL_52;
  }
  v5 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return 0i64;
  if ( _bittest((const signed __int32 *)off_30148 + 59, 0xCu) && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    sub_1DC74(*((_QWORD *)off_30148 + 27), 0x5Cu, (__int64)&unk_2EC78, *a1, v3);
LABEL_52:
    v5 = (void **)off_30148;
  }
  if ( v5 != &off_30148 && _bittest((const signed __int32 *)v5 + 59, 0xCu) && *((_BYTE *)v5 + 233) >= 5u )
    sub_11008((__int64)v5[27], 0x63u, (__int64)&unk_2EC78);
  return 0i64;
}
// 17171: variable 'v4' is possibly undefined
// 171B6: variable 'v14' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (0000000000017250) ----------------------------------------------------
__int64 __fastcall sub_17250(int a1, __int64 a2)
{
  void **v4; // rcx

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)off_30148 + 43, 0xAu) && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      sub_11008(*((_QWORD *)off_30148 + 19), 0x64u, (__int64)&unk_2EC78);
      v4 = (void **)off_30148;
    }
    if ( v4 != &off_30148 && _bittest((const signed __int32 *)v4 + 43, 0xAu) && *((_BYTE *)v4 + 169) >= 5u )
    {
      sub_1102C((__int64)v4[19], 0x65u, (__int64)&unk_2EC78, a1);
      v4 = (void **)off_30148;
    }
  }
  if ( a2 )
  {
    sub_17374(a2);
LABEL_15:
    v4 = (void **)off_30148;
    goto LABEL_16;
  }
  if ( v4 == &off_30148 )
    return 0i64;
  if ( _bittest((const signed __int32 *)v4 + 43, 0xAu) && *((_BYTE *)v4 + 169) >= 2u )
  {
    sub_11008((__int64)v4[19], 0x66u, (__int64)&unk_2EC78);
    goto LABEL_15;
  }
LABEL_16:
  if ( v4 != &off_30148 && _bittest((const signed __int32 *)v4 + 43, 0xAu) && *((_BYTE *)v4 + 169) >= 5u )
    sub_11008((__int64)v4[19], 0x67u, (__int64)&unk_2EC78);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000017374) ----------------------------------------------------
__int64 __fastcall sub_17374(__int64 a1)
{
  void **v2; // rcx
  unsigned __int16 v3; // dx
  int v4; // eax

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)off_30148 + 43, 0xAu) && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      sub_11008(*((_QWORD *)off_30148 + 19), 0x68u, (__int64)&unk_2EC78);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 )
    {
      if ( _bittest((const signed __int32 *)v2 + 43, 0xAu) && *((_BYTE *)v2 + 169) >= 4u )
      {
        sub_11008((__int64)v2[19], 0x69u, (__int64)&unk_2EC78);
        v2 = (void **)off_30148;
      }
      if ( v2 != &off_30148 && _bittest((const signed __int32 *)v2 + 43, 9u) && *((_BYTE *)v2 + 169) >= 5u )
      {
        sub_11008((__int64)v2[19], 0x22u, (__int64)&unk_2EC88);
        v2 = (void **)off_30148;
      }
    }
  }
  if ( Timeout )
  {
    if ( sub_252B8((PFAST_MUTEX)Timeout + 1) )
    {
      v4 = (*((__int64 (__fastcall **)(__int64))Timeout + 5))(a1);
      if ( v4
        && off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 43, 9u)
        && *((_BYTE *)off_30148 + 169) >= 2u )
      {
        sub_1102C(*((_QWORD *)off_30148 + 19), 0x24u, (__int64)&unk_2EC88, v4);
      }
      sub_25320((PFAST_MUTEX)Timeout + 1);
      goto LABEL_30;
    }
    v2 = (void **)off_30148;
    if ( off_30148 == &off_30148 )
      return 0i64;
    if ( !_bittest((const signed __int32 *)off_30148 + 43, 9u) || *((_BYTE *)off_30148 + 169) < 2u )
      goto LABEL_31;
    v3 = 37;
LABEL_29:
    sub_11008((__int64)v2[19], v3, (__int64)&unk_2EC88);
LABEL_30:
    v2 = (void **)off_30148;
    goto LABEL_31;
  }
  if ( v2 == &off_30148 )
    return 0i64;
  if ( _bittest((const signed __int32 *)v2 + 43, 9u) && *((_BYTE *)v2 + 169) >= 2u )
  {
    v3 = (_WORD)Timeout + 35;
    goto LABEL_29;
  }
LABEL_31:
  if ( v2 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)v2 + 43, 9u) && *((_BYTE *)v2 + 169) >= 5u )
    {
      sub_11008((__int64)v2[19], 0x26u, (__int64)&unk_2EC88);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 )
    {
      if ( _bittest((const signed __int32 *)v2 + 43, 0xAu) && *((_BYTE *)v2 + 169) >= 4u )
      {
        sub_11008((__int64)v2[19], 0x6Bu, (__int64)&unk_2EC78);
        v2 = (void **)off_30148;
      }
      if ( v2 != &off_30148 && _bittest((const signed __int32 *)v2 + 43, 0xAu) && *((_BYTE *)v2 + 169) >= 5u )
        sub_11008((__int64)v2[19], 0x6Cu, (__int64)&unk_2EC78);
    }
  }
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000175D4) ----------------------------------------------------
__int64 __fastcall sub_175D4(__int64 a1, _QWORD *a2)
{
  int v4; // eax
  unsigned int v5; // ebx
  int v6; // eax
  int v7; // eax
  void **v8; // rcx
  __m128i v10[2]; // [rsp+20h] [rbp-28h] BYREF

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0x6Du, (__int64)&unk_2EC78);
  v4 = sub_1778C(a1, v10);
  v5 = v4;
  if ( v4 )
  {
    v8 = (void **)off_30148;
    if ( off_30148 == &off_30148 )
      return v5;
    if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
      goto LABEL_23;
    sub_1102C(*((_QWORD *)off_30148 + 27), 0x70u, (__int64)&unk_2EC78, v4);
    goto LABEL_22;
  }
  v6 = sub_14198((__int64)v10, (__int64)a2);
  v5 = v6;
  if ( !v6 )
    goto LABEL_22;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
    sub_1102C(*((_QWORD *)off_30148 + 27), 0x6Eu, (__int64)&unk_2EC78, v6);
  if ( !(unsigned int)sub_1E604(0x201400Bu)
    || !(unsigned int)sub_1E604(0x201400Du)
    || (v7 = sub_1A50C((__int64)v10, a2), (v5 = v7) == 0) )
  {
LABEL_22:
    v8 = (void **)off_30148;
    goto LABEL_23;
  }
  v8 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v5;
  if ( (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 27), 0x6Fu, (__int64)&unk_2EC78, v7);
    goto LABEL_22;
  }
LABEL_23:
  if ( v8 != &off_30148 && (*((_BYTE *)v8 + 236) & 8) != 0 && *((_BYTE *)v8 + 233) >= 5u )
    sub_11008((__int64)v8[27], 0x71u, (__int64)&unk_2EC78);
  return v5;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001778C) ----------------------------------------------------
__int64 __fastcall sub_1778C(__int64 a1, __m128i *a2)
{
  int v4; // eax
  unsigned int v5; // ebx
  void **v6; // rcx
  unsigned __int16 v7; // dx

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0x72u, (__int64)&unk_2EC78);
  v4 = sub_178C8(a1, a2, &a2[1].m128i_i8[2]);
  v5 = v4;
  if ( v4 )
  {
    v6 = (void **)off_30148;
    if ( off_30148 == &off_30148 )
      return v5;
    if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
      goto LABEL_17;
    v7 = 116;
    goto LABEL_15;
  }
  v4 = sub_17B0C(a1, (__m128i *)a2[1].m128i_i16, &a2[1].m128i_i8[3]);
  v5 = v4;
  if ( !v4 )
  {
LABEL_16:
    v6 = (void **)off_30148;
    goto LABEL_17;
  }
  v6 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v5;
  if ( (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    v7 = 115;
LABEL_15:
    sub_1102C((__int64)v6[27], v7, (__int64)&unk_2EC78, v4);
    goto LABEL_16;
  }
LABEL_17:
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 236) & 8) != 0 && *((_BYTE *)v6 + 233) >= 5u )
    sub_11008((__int64)v6[27], 0x75u, (__int64)&unk_2EC78);
  return v5;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000178C8) ----------------------------------------------------
__int64 __fastcall sub_178C8(__int64 a1, __m128i *a2, _BYTE *a3)
{
  void **v6; // rcx
  __int64 v7; // rbx
  int v8; // eax
  unsigned int v9; // ebx
  unsigned __int16 v10; // dx
  __int64 v11; // rbx

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x76u, (__int64)&unk_2EC78);
    v6 = (void **)off_30148;
  }
  v7 = *(_QWORD *)(a1 + 40);
  if ( !v7 )
  {
    v11 = *(_QWORD *)(a1 + 48);
    if ( !v11 )
    {
      if ( v6 != &off_30148 && (*((_BYTE *)v6 + 236) & 8) != 0 && *((_BYTE *)v6 + 233) >= 4u )
      {
        sub_11008((__int64)v6[27], 0x7Bu, (__int64)&unk_2EC78);
        v6 = (void **)off_30148;
      }
      v9 = 6;
      goto LABEL_36;
    }
    sub_2590C(*(_BYTE **)(a1 + 48), a3);
    if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
    {
      v8 = sub_25D5C(v11, a2);
      v9 = v8;
      if ( v8 )
      {
        v6 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          return v9;
        if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
          goto LABEL_36;
        v10 = 121;
        goto LABEL_29;
      }
    }
    else
    {
      v8 = sub_25E10(v11, a2);
      v9 = v8;
      if ( v8 )
      {
        v6 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          return v9;
        if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
          goto LABEL_36;
        v10 = 122;
        goto LABEL_29;
      }
    }
    goto LABEL_30;
  }
  sub_2590C(*(_BYTE **)(a1 + 40), a3);
  if ( (*(_BYTE *)(a1 + 120) & 0x10) == 0 )
  {
    v8 = sub_25A6C(v7, a2);
    v9 = v8;
    if ( v8 )
    {
      v6 = (void **)off_30148;
      if ( off_30148 == &off_30148 )
        return v9;
      if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
        goto LABEL_36;
      v10 = 120;
      goto LABEL_29;
    }
LABEL_30:
    v6 = (void **)off_30148;
    goto LABEL_36;
  }
  v8 = sub_259BC(v7, a2);
  v9 = v8;
  if ( !v8 )
    goto LABEL_30;
  v6 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v9;
  if ( (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    v10 = 119;
LABEL_29:
    sub_1102C((__int64)v6[27], v10, (__int64)&unk_2EC78, v8);
    goto LABEL_30;
  }
LABEL_36:
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 236) & 8) != 0 && *((_BYTE *)v6 + 233) >= 5u )
    sub_11008((__int64)v6[27], 0x7Cu, (__int64)&unk_2EC78);
  return v9;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000017B0C) ----------------------------------------------------
__int64 __fastcall sub_17B0C(__int64 a1, _WORD *a2, _BYTE *a3)
{
  void **v6; // rcx
  _WORD *v7; // rcx
  int v8; // eax
  unsigned int v9; // ebx
  unsigned __int16 v10; // dx
  _WORD *v11; // rax

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x7Du, (__int64)&unk_2EC78);
    v6 = (void **)off_30148;
  }
  if ( !*(_QWORD *)(a1 + 56) )
  {
    v11 = *(_WORD **)(a1 + 64);
    if ( !v11 )
    {
      if ( v6 != &off_30148 && (*((_BYTE *)v6 + 236) & 8) != 0 && *((_BYTE *)v6 + 233) >= 4u )
      {
        sub_11008((__int64)v6[27], 0x82u, (__int64)&unk_2EC78);
        v6 = (void **)off_30148;
      }
      v9 = 6;
      goto LABEL_36;
    }
    *a3 = 17;
    if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
    {
      v8 = sub_26560(v11, a2);
      v9 = v8;
      if ( v8 )
      {
        v6 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          return v9;
        if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
          goto LABEL_36;
        v10 = 128;
        goto LABEL_29;
      }
    }
    else
    {
      v8 = sub_26624((__int64)v11, a2);
      v9 = v8;
      if ( v8 )
      {
        v6 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          return v9;
        if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
          goto LABEL_36;
        v10 = 129;
        goto LABEL_29;
      }
    }
    goto LABEL_30;
  }
  v7 = *(_WORD **)(a1 + 56);
  *a3 = 6;
  if ( (*(_BYTE *)(a1 + 120) & 0x10) == 0 )
  {
    v8 = sub_2649C((__int64)v7, a2);
    v9 = v8;
    if ( v8 )
    {
      v6 = (void **)off_30148;
      if ( off_30148 == &off_30148 )
        return v9;
      if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
        goto LABEL_36;
      v10 = 127;
      goto LABEL_29;
    }
LABEL_30:
    v6 = (void **)off_30148;
    goto LABEL_36;
  }
  v8 = sub_263D8(v7, a2);
  v9 = v8;
  if ( !v8 )
    goto LABEL_30;
  v6 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v9;
  if ( (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    v10 = 126;
LABEL_29:
    sub_1102C((__int64)v6[27], v10, (__int64)&unk_2EC78, v8);
    goto LABEL_30;
  }
LABEL_36:
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 236) & 8) != 0 && *((_BYTE *)v6 + 233) >= 5u )
    sub_11008((__int64)v6[27], 0x83u, (__int64)&unk_2EC78);
  return v9;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000017D44) ----------------------------------------------------
__int64 __fastcall sub_17D44(__int64 a1, __m128i *a2)
{
  int v4; // eax
  unsigned int v5; // ebx
  void **v6; // rcx
  unsigned __int16 v7; // dx

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0x84u, (__int64)&unk_2EC78);
  v4 = sub_17E7C(a1, a2, &a2[1].m128i_i8[2]);
  v5 = v4;
  if ( v4 )
  {
    v6 = (void **)off_30148;
    if ( off_30148 == &off_30148 )
      return v5;
    if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
      goto LABEL_17;
    v7 = 134;
    goto LABEL_15;
  }
  v4 = sub_180C0(a1, (__m128i *)a2[1].m128i_i16);
  v5 = v4;
  if ( !v4 )
  {
LABEL_16:
    v6 = (void **)off_30148;
    goto LABEL_17;
  }
  v6 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v5;
  if ( (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    v7 = 133;
LABEL_15:
    sub_1102C((__int64)v6[27], v7, (__int64)&unk_2EC78, v4);
    goto LABEL_16;
  }
LABEL_17:
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 236) & 8) != 0 && *((_BYTE *)v6 + 233) >= 5u )
    sub_11008((__int64)v6[27], 0x87u, (__int64)&unk_2EC78);
  return v5;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000017E7C) ----------------------------------------------------
__int64 __fastcall sub_17E7C(__int64 a1, __m128i *a2, _BYTE *a3)
{
  void **v6; // rcx
  __int64 v7; // rbx
  int v8; // eax
  unsigned int v9; // ebx
  unsigned __int16 v10; // dx
  __int64 v11; // rbx

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x88u, (__int64)&unk_2EC78);
    v6 = (void **)off_30148;
  }
  v7 = *(_QWORD *)(a1 + 40);
  if ( !v7 )
  {
    v11 = *(_QWORD *)(a1 + 48);
    if ( !v11 )
    {
      if ( v6 != &off_30148 && (*((_BYTE *)v6 + 236) & 8) != 0 && *((_BYTE *)v6 + 233) >= 4u )
      {
        sub_11008((__int64)v6[27], 0x8Du, (__int64)&unk_2EC78);
        v6 = (void **)off_30148;
      }
      v9 = 6;
      goto LABEL_36;
    }
    sub_2590C(*(_BYTE **)(a1 + 48), a3);
    if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
    {
      v8 = sub_25E10(v11, a2);
      v9 = v8;
      if ( v8 )
      {
        v6 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          return v9;
        if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
          goto LABEL_36;
        v10 = 140;
        goto LABEL_29;
      }
    }
    else
    {
      v8 = sub_25D5C(v11, a2);
      v9 = v8;
      if ( v8 )
      {
        v6 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          return v9;
        if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
          goto LABEL_36;
        v10 = 139;
        goto LABEL_29;
      }
    }
    goto LABEL_30;
  }
  sub_2590C(*(_BYTE **)(a1 + 40), a3);
  if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
  {
    v8 = sub_25A6C(v7, a2);
    v9 = v8;
    if ( v8 )
    {
      v6 = (void **)off_30148;
      if ( off_30148 == &off_30148 )
        return v9;
      if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
        goto LABEL_36;
      v10 = 138;
      goto LABEL_29;
    }
LABEL_30:
    v6 = (void **)off_30148;
    goto LABEL_36;
  }
  v8 = sub_259BC(v7, a2);
  v9 = v8;
  if ( !v8 )
    goto LABEL_30;
  v6 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v9;
  if ( (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    v10 = 137;
LABEL_29:
    sub_1102C((__int64)v6[27], v10, (__int64)&unk_2EC78, v8);
    goto LABEL_30;
  }
LABEL_36:
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 236) & 8) != 0 && *((_BYTE *)v6 + 233) >= 5u )
    sub_11008((__int64)v6[27], 0x8Eu, (__int64)&unk_2EC78);
  return v9;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000180C0) ----------------------------------------------------
__int64 __fastcall sub_180C0(__int64 a1, _WORD *a2)
{
  void **v4; // rcx
  _WORD *v5; // rcx
  int v6; // eax
  unsigned int v7; // ebx
  unsigned __int16 v8; // dx
  _WORD *v9; // rcx

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x8Fu, (__int64)&unk_2EC78);
    v4 = (void **)off_30148;
  }
  if ( !*(_QWORD *)(a1 + 56) )
  {
    if ( !*(_QWORD *)(a1 + 64) )
    {
      if ( v4 != &off_30148 && (*((_BYTE *)v4 + 236) & 8) != 0 && *((_BYTE *)v4 + 233) >= 4u )
      {
        sub_11008((__int64)v4[27], 0x94u, (__int64)&unk_2EC78);
        v4 = (void **)off_30148;
      }
      v7 = 6;
      goto LABEL_36;
    }
    v9 = *(_WORD **)(a1 + 64);
    if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
    {
      v6 = sub_26624((__int64)v9, a2);
      v7 = v6;
      if ( v6 )
      {
        v4 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          return v7;
        if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
          goto LABEL_36;
        v8 = 147;
        goto LABEL_29;
      }
    }
    else
    {
      v6 = sub_26560(v9, a2);
      v7 = v6;
      if ( v6 )
      {
        v4 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          return v7;
        if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
          goto LABEL_36;
        v8 = 146;
        goto LABEL_29;
      }
    }
    goto LABEL_30;
  }
  v5 = *(_WORD **)(a1 + 56);
  if ( (*(_BYTE *)(a1 + 120) & 0x10) != 0 )
  {
    v6 = sub_2649C((__int64)v5, a2);
    v7 = v6;
    if ( v6 )
    {
      v4 = (void **)off_30148;
      if ( off_30148 == &off_30148 )
        return v7;
      if ( (*((_BYTE *)off_30148 + 236) & 8) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
        goto LABEL_36;
      v8 = 145;
      goto LABEL_29;
    }
LABEL_30:
    v4 = (void **)off_30148;
    goto LABEL_36;
  }
  v6 = sub_263D8(v5, a2);
  v7 = v6;
  if ( !v6 )
    goto LABEL_30;
  v4 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v7;
  if ( (*((_BYTE *)off_30148 + 236) & 8) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    v8 = 144;
LABEL_29:
    sub_1102C((__int64)v4[27], v8, (__int64)&unk_2EC78, v6);
    goto LABEL_30;
  }
LABEL_36:
  if ( v4 != &off_30148 && (*((_BYTE *)v4 + 236) & 8) != 0 && *((_BYTE *)v4 + 233) >= 5u )
    sub_11008((__int64)v4[27], 0x95u, (__int64)&unk_2EC78);
  return v7;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000182E4) ----------------------------------------------------
__int64 __fastcall sub_182E4(__int64 a1, __int64 a2, __int64 *a3)
{
  int v6; // eax
  unsigned int v7; // ebx
  void **v8; // rcx
  unsigned __int16 v9; // dx
  int v10; // er9
  int v11; // eax
  bool v12; // zf
  __m128i v13; // xmm0
  __m128i v14; // xmm1
  int v15; // eax
  __int64 v16; // rax
  int v17; // eax
  int v19; // [rsp+30h] [rbp-2C8h] BYREF
  char v20; // [rsp+38h] [rbp-2C0h] BYREF
  _BYTE v21[18]; // [rsp+39h] [rbp-2BFh]
  char v22; // [rsp+4Bh] [rbp-2ADh]
  char v23; // [rsp+50h] [rbp-2A8h] BYREF
  _BYTE v24[18]; // [rsp+51h] [rbp-2A7h]
  char v25; // [rsp+63h] [rbp-295h]
  __int64 v26; // [rsp+70h] [rbp-288h] BYREF
  __int64 Dst[73]; // [rsp+78h] [rbp-280h] BYREF

  v26 = 0i64;
  v20 = 0;
  *(_OWORD *)v21 = 0ui64;
  *(_WORD *)&v21[16] = 0;
  v22 = 0;
  v23 = 0;
  *(_OWORD *)v24 = 0ui64;
  *(_WORD *)&v24[16] = 0;
  v25 = 0;
  memset(Dst, 0, sizeof(Dst));
  v19 = 0;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x20) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0x96u, (__int64)&unk_2EC78);
  v6 = sub_1778C(a1, (__m128i *)&v23);
  v7 = v6;
  if ( !v6 )
  {
    v6 = sub_17D44(a1, (__m128i *)&v20);
    v7 = v6;
    if ( !v6 )
    {
      v11 = 34525;
      if ( v21[17] == 4 )
        v11 = 2048;
      v12 = (*(_BYTE *)(a1 + 120) & 0x10) == 0;
      LODWORD(Dst[1]) = v11;
      HIDWORD(Dst[1]) = *(_DWORD *)(a2 + 16);
      if ( v12 )
      {
        v13 = _mm_loadu_si128((const __m128i *)&v23);
        v14 = _mm_loadu_si128((const __m128i *)&v20);
        LODWORD(Dst[3]) = *(unsigned __int16 *)&v24[15];
        v15 = *(unsigned __int16 *)&v21[15];
        LODWORD(Dst[2]) = 1;
      }
      else
      {
        v13 = _mm_loadu_si128((const __m128i *)&v20);
        v14 = _mm_loadu_si128((const __m128i *)&v23);
        LODWORD(Dst[3]) = *(unsigned __int16 *)&v21[15];
        v15 = *(unsigned __int16 *)&v24[15];
        LODWORD(Dst[2]) = 2;
      }
      HIDWORD(Dst[2]) = v15;
      *(__m128i *)((char *)&Dst[3] + 4) = v14;
      *(__m128i *)((char *)&Dst[5] + 4) = v13;
      v12 = !sub_27250(v21[17], &v20);
      HIDWORD(Dst[72]) = *(_DWORD *)(a2 + 20);
      v16 = *a3;
      LOBYTE(Dst[8]) = v12;
      v26 = v16;
      Dst[0] = a3[1];
      sub_18600((__int64)&v26);
      v17 = sub_20F70(40031, &v26, 0x250u, 0i64, &v19);
      v7 = v17;
      if ( v17 )
      {
        v8 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          return v7;
        if ( (*((_BYTE *)off_30148 + 236) & 0x20) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
          goto LABEL_32;
        sub_1102C(*((_QWORD *)off_30148 + 27), 0x99u, (__int64)&unk_2EC78, v17);
        goto LABEL_31;
      }
      v8 = (void **)off_30148;
      if ( off_30148 == &off_30148 )
        return v7;
      if ( (*((_BYTE *)off_30148 + 236) & 0x20) == 0 || *((_BYTE *)off_30148 + 233) < 4u )
        goto LABEL_32;
      v10 = v19;
      v9 = 154;
LABEL_30:
      sub_1102C((__int64)v8[27], v9, (__int64)&unk_2EC78, v10);
LABEL_31:
      v8 = (void **)off_30148;
      goto LABEL_32;
    }
    v8 = (void **)off_30148;
    if ( off_30148 == &off_30148 )
      return v7;
    if ( (*((_BYTE *)off_30148 + 236) & 0x20) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
      goto LABEL_32;
    v9 = 152;
LABEL_10:
    v10 = v6;
    goto LABEL_30;
  }
  v8 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v7;
  if ( (*((_BYTE *)off_30148 + 236) & 0x20) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    v9 = 151;
    goto LABEL_10;
  }
LABEL_32:
  if ( v8 != &off_30148 && (*((_BYTE *)v8 + 236) & 0x20) != 0 && *((_BYTE *)v8 + 233) >= 5u )
    sub_11008((__int64)v8[27], 0x9Bu, (__int64)&unk_2EC78);
  return v7;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000018600) ----------------------------------------------------
void __fastcall sub_18600(__int64 a1)
{
  void **v2; // r14
  unsigned __int16 v3; // dx
  const char *v4; // rax
  const char *v5; // rax
  const char *v6; // r9
  const char *v7; // rax

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x20) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x9Cu, (__int64)&unk_2EC78);
    v2 = (void **)off_30148;
  }
  if ( !a1 )
  {
    if ( v2 != &off_30148 && (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 5u )
    {
      v3 = 157;
LABEL_89:
      sub_11008((__int64)v2[27], v3, (__int64)&unk_2EC78);
      return;
    }
    return;
  }
  if ( v2 != &off_30148 )
  {
    if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
    {
      sub_11008((__int64)v2[27], 0x9Eu, (__int64)&unk_2EC78);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 )
    {
      if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
      {
        sub_11008((__int64)v2[27], 0x9Fu, (__int64)&unk_2EC78);
        v2 = (void **)off_30148;
      }
      if ( v2 != &off_30148 )
      {
        if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
        {
          v4 = sub_25538(*(_DWORD *)(a1 + 16));
          sub_14D60(*((_QWORD *)off_30148 + 27), 0xA0u, (__int64)&unk_2EC78, v4);
          v2 = (void **)off_30148;
        }
        if ( v2 != &off_30148 )
        {
          if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
          {
            v5 = sub_253E8(*(_DWORD *)(a1 + 20));
            sub_14D60(*((_QWORD *)off_30148 + 27), 0xA1u, (__int64)&unk_2EC78, v5);
            v2 = (void **)off_30148;
          }
          if ( v2 != &off_30148 && (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
          {
            if ( *(_DWORD *)(a1 + 24) == 1 )
            {
              v6 = "INCOMING";
            }
            else if ( *(_DWORD *)(a1 + 24) == 2 )
            {
              v6 = "OUTGOING";
            }
            else
            {
              v6 = "UNKNOWN";
            }
            sub_14D60((__int64)v2[27], 0xA2u, (__int64)&unk_2EC78, v6);
            v2 = (void **)off_30148;
          }
        }
      }
    }
  }
  if ( *(_DWORD *)(a1 + 16) == 2048 )
  {
    if ( v2 == &off_30148 )
      return;
    if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
    {
      sub_14BB4((__int64)v2[27], 0xA3u, (__int64)&unk_2EC78, *(unsigned __int8 *)(a1 + 52));
      v2 = (void **)off_30148;
    }
    if ( v2 == &off_30148 )
      return;
    if ( (*((_BYTE *)v2 + 236) & 0x20) == 0 || *((_BYTE *)v2 + 233) < 4u )
      goto LABEL_53;
    sub_14BB4((__int64)v2[27], 0xA4u, (__int64)&unk_2EC78, *(unsigned __int8 *)(a1 + 36));
  }
  else
  {
    if ( v2 == &off_30148 )
      return;
    if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
    {
      sub_14728(
        (__int64)v2[27],
        0xA5u,
        (__int64)&unk_2EC78,
        (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 52)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 52) << 8));
      v2 = (void **)off_30148;
    }
    if ( v2 == &off_30148 )
      return;
    if ( (*((_BYTE *)v2 + 236) & 0x20) == 0 || *((_BYTE *)v2 + 233) < 4u )
      goto LABEL_53;
    sub_14728(
      (__int64)v2[27],
      0xA6u,
      (__int64)&unk_2EC78,
      (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 36)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 36) << 8));
  }
  v2 = (void **)off_30148;
LABEL_53:
  if ( v2 != &off_30148 )
  {
    if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
    {
      sub_1102C((__int64)v2[27], 0xA7u, (__int64)&unk_2EC78, *(_DWORD *)(a1 + 32));
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 )
    {
      if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
      {
        sub_1102C((__int64)v2[27], 0xA8u, (__int64)&unk_2EC78, *(_DWORD *)(a1 + 28));
        v2 = (void **)off_30148;
      }
      if ( v2 != &off_30148 )
      {
        if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
        {
          sub_14C80((__int64)v2[27], 0xA9u, (__int64)&unk_2EC78, *(_QWORD *)a1);
          v2 = (void **)off_30148;
        }
        if ( v2 != &off_30148 )
        {
          if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
          {
            sub_14C80((__int64)v2[27], 0xAAu, (__int64)&unk_2EC78, *(_QWORD *)(a1 + 8));
            v2 = (void **)off_30148;
          }
          if ( v2 != &off_30148 )
          {
            if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
            {
              sub_1102C((__int64)v2[27], 0xABu, (__int64)&unk_2EC78, *(unsigned __int8 *)(a1 + 72));
              v2 = (void **)off_30148;
            }
            if ( v2 != &off_30148 )
            {
              if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
              {
                sub_1102C((__int64)v2[27], 0xACu, (__int64)&unk_2EC78, *(unsigned __int8 *)(a1 + 73));
                v2 = (void **)off_30148;
              }
              if ( v2 != &off_30148 )
              {
                if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
                {
                  v7 = sub_25460(*(_DWORD *)(a1 + 588));
                  sub_14D60(*((_QWORD *)off_30148 + 27), 0xADu, (__int64)&unk_2EC78, v7);
                  v2 = (void **)off_30148;
                }
                if ( v2 != &off_30148 )
                {
                  if ( (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 4u )
                  {
                    sub_11068((__int64)v2[27], 0xAEu, (__int64)&unk_2EC78, (const wchar_t *)(a1 + 74));
                    v2 = (void **)off_30148;
                  }
                  if ( v2 != &off_30148 && (*((_BYTE *)v2 + 236) & 0x20) != 0 && *((_BYTE *)v2 + 233) >= 5u )
                  {
                    v3 = 175;
                    goto LABEL_89;
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
// 30148: using guessed type void *off_30148;

//----- (0000000000018DBC) ----------------------------------------------------
__int64 __fastcall sub_18DBC(__int64 a1)
{
  void **v2; // rcx
  __int64 result; // rax
  unsigned __int16 v4; // dx

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 236) < 0 && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    result = sub_11008(*((_QWORD *)off_30148 + 27), 0xB0u, (__int64)&unk_2EC78);
    v2 = (void **)off_30148;
  }
  if ( a1 )
  {
    if ( v2 != &off_30148 )
    {
      if ( *((char *)v2 + 236) < 0 && *((_BYTE *)v2 + 233) >= 4u )
      {
        result = sub_11008((__int64)v2[27], 0xB2u, (__int64)&unk_2EC78);
        v2 = (void **)off_30148;
      }
      if ( v2 != &off_30148 )
      {
        if ( *((char *)v2 + 236) < 0 && *((_BYTE *)v2 + 233) >= 4u )
        {
          result = sub_11008((__int64)v2[27], 0xB3u, (__int64)&unk_2EC78);
          v2 = (void **)off_30148;
        }
        if ( v2 != &off_30148 )
        {
          if ( *((char *)v2 + 236) < 0 && *((_BYTE *)v2 + 233) >= 4u )
          {
            result = sub_14C80((__int64)v2[27], 0xB4u, (__int64)&unk_2EC78, *(_QWORD *)a1);
            v2 = (void **)off_30148;
          }
          if ( v2 != &off_30148 )
          {
            if ( *((char *)v2 + 236) < 0 && *((_BYTE *)v2 + 233) >= 4u )
            {
              result = sub_14C80((__int64)v2[27], 0xB5u, (__int64)&unk_2EC78, *(_QWORD *)(a1 + 8));
              v2 = (void **)off_30148;
            }
            if ( v2 != &off_30148 )
            {
              if ( *((char *)v2 + 236) < 0 && *((_BYTE *)v2 + 233) >= 4u )
              {
                result = sub_1102C((__int64)v2[27], 0xB6u, (__int64)&unk_2EC78, *(unsigned __int16 *)(a1 + 20));
                v2 = (void **)off_30148;
              }
              if ( v2 != &off_30148 )
              {
                if ( *((char *)v2 + 236) < 0 && *((_BYTE *)v2 + 233) >= 4u )
                {
                  result = sub_1102C((__int64)v2[27], 0xB7u, (__int64)&unk_2EC78, *(unsigned __int16 *)(a1 + 22));
                  v2 = (void **)off_30148;
                }
                if ( v2 != &off_30148 )
                {
                  if ( *((char *)v2 + 236) < 0 && *((_BYTE *)v2 + 233) >= 4u )
                  {
                    result = sub_147C8((__int64)v2[27], 0xB8u, (__int64)&unk_2EC78, *(_QWORD *)(a1 + 24));
                    v2 = (void **)off_30148;
                  }
                  if ( v2 != &off_30148 )
                  {
                    if ( *((char *)v2 + 236) < 0 && *((_BYTE *)v2 + 233) >= 4u )
                    {
                      result = sub_147C8((__int64)v2[27], 0xB9u, (__int64)&unk_2EC78, *(_QWORD *)(a1 + 32));
                      v2 = (void **)off_30148;
                    }
                    if ( v2 != &off_30148 && *((char *)v2 + 236) < 0 && *((_BYTE *)v2 + 233) >= 5u )
                    {
                      v4 = 186;
                      return sub_11008((__int64)v2[27], v4, (__int64)&unk_2EC78);
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  else if ( v2 != &off_30148 && *((char *)v2 + 236) < 0 && *((_BYTE *)v2 + 233) >= 5u )
  {
    v4 = 177;
    return sub_11008((__int64)v2[27], v4, (__int64)&unk_2EC78);
  }
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000019050) ----------------------------------------------------
char __fastcall sub_19050(unsigned __int16 a1, __int16 a2, __int64 a3)
{
  char v5; // bl
  int v7; // esi
  unsigned __int16 v8; // dx
  void **v9; // rax
  _WORD *v10; // rdi
  char v12; // [rsp+78h] [rbp+20h] BYREF

  v5 = 0;
  v12 = 0;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 59, 0xBu)
    && *((_BYTE *)off_30148 + 233) >= 4u )
  {
    sub_14C1C(*((_QWORD *)off_30148 + 27), 187i64, (__int64)&unk_2EC78, a1);
  }
  if ( (unsigned int)sub_1E604(0x201400Au) )
  {
    sub_24FB8(a3, &v12);
    if ( v12 )
    {
      v5 = v12;
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 59, 0xBu)
        && *((_BYTE *)off_30148 + 233) >= 5u )
      {
        sub_11008(*((_QWORD *)off_30148 + 27), 0xBCu, (__int64)&unk_2EC78);
      }
      v7 = 0;
      if ( !_InterlockedCompareExchange(&dword_304A0, 1, 1) )
      {
        v8 = word_3049C;
        if ( word_3049C )
        {
          v9 = (void **)off_30148;
          v10 = &unk_30460;
          do
          {
            if ( v5 != 1 )
              break;
            if ( a1 == *v10 || a2 == *v10 )
            {
              if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 59, 0xBu) && *((_BYTE *)v9 + 233) >= 4u )
              {
                sub_11008((__int64)v9[27], 0xBDu, (__int64)&unk_2EC78);
                v9 = (void **)off_30148;
                v8 = word_3049C;
              }
              v5 = 0;
            }
            ++v7;
            ++v10;
          }
          while ( v7 < v8 );
        }
      }
    }
  }
  return v5;
}
// 30148: using guessed type void *off_30148;
// 3049C: using guessed type __int16 word_3049C;
// 304A0: using guessed type int dword_304A0;

//----- (00000000000191F0) ----------------------------------------------------
__int64 __fastcall sub_191F0(__int64 *a1, __int64 a2)
{
  unsigned int v2; // edi
  void **v5; // rcx
  unsigned __int16 v6; // dx
  __int64 v7; // rax
  int v8; // ecx
  int v9; // eax
  __int64 v11; // [rsp+20h] [rbp-38h] BYREF
  __int64 v12[4]; // [rsp+28h] [rbp-30h] BYREF

  v2 = 0;
  v11 = 0i64;
  memset(v12, 0, sizeof(v12));
  v5 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 236) < 0 && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0xBEu, (__int64)&unk_2EC78);
    v5 = (void **)off_30148;
  }
  if ( *(_QWORD *)(a2 + 16) || *(_QWORD *)(a2 + 24) )
  {
    v7 = *a1;
    v12[2] = *(_QWORD *)(a2 + 16);
    v11 = v7;
    v12[0] = a1[1];
    v8 = -(*(_DWORD *)(a2 + 8) != 0);
    HIDWORD(v12[1]) = *(_DWORD *)(a2 + 12);
    v12[3] = *(_QWORD *)(a2 + 24);
    LODWORD(v12[1]) = 1 - v8;
    sub_18DBC((__int64)&v11);
    v9 = sub_243E0(40037, &v11, 0x28u);
    v2 = v9;
    if ( v9 )
    {
      v5 = (void **)off_30148;
      if ( off_30148 == &off_30148 )
        return v2;
      if ( *((char *)off_30148 + 236) >= 0 || *((_BYTE *)off_30148 + 233) < 2u )
        goto LABEL_22;
      sub_1102C(*((_QWORD *)off_30148 + 27), 0xC0u, (__int64)&unk_2EC78, v9);
      goto LABEL_21;
    }
    v5 = (void **)off_30148;
    if ( off_30148 == &off_30148 )
      return v2;
    if ( *((char *)off_30148 + 236) >= 0 || *((_BYTE *)off_30148 + 233) < 4u )
      goto LABEL_22;
    v6 = 193;
LABEL_20:
    sub_11008((__int64)v5[27], v6, (__int64)&unk_2EC78);
LABEL_21:
    v5 = (void **)off_30148;
    goto LABEL_22;
  }
  if ( v5 == &off_30148 )
    return v2;
  if ( *((char *)v5 + 236) < 0 && *((_BYTE *)v5 + 233) >= 4u )
  {
    v6 = 191;
    goto LABEL_20;
  }
LABEL_22:
  if ( v5 != &off_30148 && *((char *)v5 + 236) < 0 && *((_BYTE *)v5 + 233) >= 5u )
    sub_11008((__int64)v5[27], 0xC2u, (__int64)&unk_2EC78);
  return v2;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000193D0) ----------------------------------------------------
__int64 __fastcall sub_193D0(__int64 a1)
{
  __int64 result; // rax
  int v3; // eax
  unsigned int v4; // esi
  wchar_t *v5; // rax
  wchar_t *v6; // rax
  int v7; // eax
  unsigned int v8; // [rsp+40h] [rbp+8h] BYREF
  const wchar_t **v9; // [rsp+48h] [rbp+10h] BYREF

  v9 = 0i64;
  v8 = 0;
  if ( a1 )
  {
    v3 = sub_24988(*(_QWORD *)a1, &v9, &v8);
    v4 = v3;
    if ( v3 )
    {
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
        sub_1102C(*((_QWORD *)off_30148 + 27), 0xC4u, (__int64)&unk_2EC78, v3);
    }
    else
    {
      if ( v9[3] )
      {
        v5 = wcsrchr(v9[3], 0x5Cu);
        if ( !v5 || (v6 = v5 + 1) == 0i64 )
          v6 = (wchar_t *)v9[3];
        sub_2B5E4((char *)(a1 + 16), 0x1Fui64, 0xFFFFFFFFFFFFFFFFui64, L"%s", v6);
      }
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
        sub_11068(*((_QWORD *)off_30148 + 27), 0xC5u, (__int64)&unk_2EC78, (const wchar_t *)(a1 + 16));
    }
    if ( v9 )
    {
      v7 = sub_24DCC((PVOID *)&v9);
      if ( v7 )
      {
        if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
          sub_1102C(*((_QWORD *)off_30148 + 27), 0xC6u, (__int64)&unk_2EC78, v7);
      }
    }
    result = v4;
  }
  else
  {
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x40) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
      sub_147C8(*((_QWORD *)off_30148 + 27), 0xC3u, (__int64)&unk_2EC78, 0i64);
    result = 4i64;
  }
  return result;
}
// 2D630: using guessed type wchar_t aS[3];
// 30148: using guessed type void *off_30148;

//----- (0000000000019598) ----------------------------------------------------
__int64 __fastcall sub_19598(unsigned __int16 *a1)
{
  unsigned int v1; // edi
  void **v3; // rcx
  unsigned __int16 v4; // dx
  int v5; // eax
  char v7; // [rsp+50h] [rbp+8h] BYREF
  int v8; // [rsp+58h] [rbp+10h] BYREF

  v1 = 0;
  v8 = 0;
  v7 = 0;
  v3 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 59, 0xAu)
    && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0xC7u, (__int64)&unk_2EC78);
    v3 = (void **)off_30148;
  }
  if ( !a1 )
  {
    if ( v3 != &off_30148 && _bittest((const signed __int32 *)v3 + 59, 0xAu) && *((_BYTE *)v3 + 233) >= 2u )
    {
      sub_147C8((__int64)v3[27], 0xC8u, (__int64)&unk_2EC78, 0i64);
      v3 = (void **)off_30148;
    }
    v1 = 4;
    goto LABEL_33;
  }
  if ( (unsigned int)sub_24EDC(*(_QWORD *)a1, &v7) || !v7 )
  {
    if ( !sub_19050(a1[12], 0, *(_QWORD *)a1) )
    {
      sub_197D4((__int64)a1);
      v5 = sub_20F70(40032, a1, 0x30u, 0i64, &v8);
      v1 = v5;
      if ( v5 )
      {
        v3 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          return v1;
        if ( !_bittest((const signed __int32 *)off_30148 + 59, 0xAu) || *((_BYTE *)off_30148 + 233) < 2u )
          goto LABEL_33;
        sub_1102C(*((_QWORD *)off_30148 + 27), 0xCBu, (__int64)&unk_2EC78, v5);
      }
      else
      {
        v3 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          return v1;
        if ( !_bittest((const signed __int32 *)off_30148 + 59, 0xAu) || *((_BYTE *)off_30148 + 233) < 4u )
          goto LABEL_33;
        sub_1102C(*((_QWORD *)off_30148 + 27), 0xCCu, (__int64)&unk_2EC78, v8);
      }
      goto LABEL_32;
    }
    v3 = (void **)off_30148;
    if ( off_30148 == &off_30148 )
      return v1;
    if ( !_bittest((const signed __int32 *)off_30148 + 59, 0xAu) || *((_BYTE *)off_30148 + 233) < 4u )
      goto LABEL_33;
    v4 = 202;
LABEL_17:
    sub_14C80((__int64)v3[27], v4, (__int64)&unk_2EC78, *(_QWORD *)a1);
LABEL_32:
    v3 = (void **)off_30148;
    goto LABEL_33;
  }
  v3 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v1;
  if ( _bittest((const signed __int32 *)off_30148 + 59, 0xAu) && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    v4 = 201;
    goto LABEL_17;
  }
LABEL_33:
  if ( v3 != &off_30148 && _bittest((const signed __int32 *)v3 + 59, 0xAu) && *((_BYTE *)v3 + 233) >= 5u )
    sub_11008((__int64)v3[27], 0xCDu, (__int64)&unk_2EC78);
  return v1;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000197D4) ----------------------------------------------------
void __fastcall sub_197D4(__int64 a1)
{
  void **v2; // r14
  unsigned __int16 v3; // dx
  const char *v4; // rax
  const char *v5; // rax

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 59, 0xAu)
    && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0xCEu, (__int64)&unk_2EC78);
    v2 = (void **)off_30148;
  }
  if ( !a1 )
  {
    if ( v2 != &off_30148 && _bittest((const signed __int32 *)v2 + 59, 0xAu) && *((_BYTE *)v2 + 233) >= 5u )
    {
      v3 = 207;
LABEL_52:
      sub_11008((__int64)v2[27], v3, (__int64)&unk_2EC78);
      return;
    }
    return;
  }
  if ( v2 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)v2 + 59, 0xAu) && *((_BYTE *)v2 + 233) >= 4u )
    {
      sub_11008((__int64)v2[27], 0xD0u, (__int64)&unk_2EC78);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 )
    {
      if ( _bittest((const signed __int32 *)v2 + 59, 0xAu) && *((_BYTE *)v2 + 233) >= 4u )
      {
        sub_11008((__int64)v2[27], 0xD1u, (__int64)&unk_2EC78);
        v2 = (void **)off_30148;
      }
      if ( v2 != &off_30148 )
      {
        if ( _bittest((const signed __int32 *)v2 + 59, 0xAu) && *((_BYTE *)v2 + 233) >= 4u )
        {
          sub_14C80((__int64)v2[27], 0xD2u, (__int64)&unk_2EC78, *(_QWORD *)a1);
          v2 = (void **)off_30148;
        }
        if ( v2 != &off_30148 )
        {
          if ( _bittest((const signed __int32 *)v2 + 59, 0xAu) && *((_BYTE *)v2 + 233) >= 4u )
          {
            sub_14C80((__int64)v2[27], 0xD3u, (__int64)&unk_2EC78, *(_QWORD *)(a1 + 8));
            v2 = (void **)off_30148;
          }
          if ( v2 != &off_30148 )
          {
            if ( _bittest((const signed __int32 *)v2 + 59, 0xAu) && *((_BYTE *)v2 + 233) >= 4u )
            {
              v4 = sub_25538(*(_DWORD *)(a1 + 16));
              sub_14D60(*((_QWORD *)off_30148 + 27), 0xD4u, (__int64)&unk_2EC78, v4);
              v2 = (void **)off_30148;
            }
            if ( v2 != &off_30148 )
            {
              if ( _bittest((const signed __int32 *)v2 + 59, 0xAu) && *((_BYTE *)v2 + 233) >= 4u )
              {
                v5 = sub_253E8(*(_DWORD *)(a1 + 20));
                sub_14D60(*((_QWORD *)off_30148 + 27), 0xD5u, (__int64)&unk_2EC78, v5);
                v2 = (void **)off_30148;
              }
              if ( v2 != &off_30148 && _bittest((const signed __int32 *)v2 + 59, 0xAu) && *((_BYTE *)v2 + 233) >= 4u )
              {
                sub_1102C((__int64)v2[27], 0xD6u, (__int64)&unk_2EC78, *(_DWORD *)(a1 + 24));
                v2 = (void **)off_30148;
              }
            }
          }
        }
      }
    }
  }
  if ( *(_DWORD *)(a1 + 16) == 2048 )
  {
    if ( v2 == &off_30148 )
      return;
    if ( _bittest((const signed __int32 *)v2 + 59, 0xAu) && *((_BYTE *)v2 + 233) >= 4u )
    {
      sub_14BB4((__int64)v2[27], 0xD7u, (__int64)&unk_2EC78, *(unsigned __int8 *)(a1 + 28));
LABEL_47:
      v2 = (void **)off_30148;
      goto LABEL_48;
    }
  }
  else
  {
    if ( v2 == &off_30148 )
      return;
    if ( _bittest((const signed __int32 *)v2 + 59, 0xAu) && *((_BYTE *)v2 + 233) >= 4u )
    {
      sub_14728(
        (__int64)v2[27],
        0xD8u,
        (__int64)&unk_2EC78,
        (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 28)) | (unsigned __int16)((unsigned __int8)*(_WORD *)(a1 + 28) << 8));
      goto LABEL_47;
    }
  }
LABEL_48:
  if ( v2 != &off_30148 && _bittest((const signed __int32 *)v2 + 59, 0xAu) && *((_BYTE *)v2 + 233) >= 5u )
  {
    v3 = 217;
    goto LABEL_52;
  }
}
// 30148: using guessed type void *off_30148;

//----- (0000000000019C30) ----------------------------------------------------
__int64 sub_19C30(__int64 a1, __int64 a2, __int64 a3, ...)
{
  __int64 v4; // rcx
  _WORD *v5; // rdi
  bool v6; // zf
  __int64 v8; // [rsp+A8h] [rbp+20h] BYREF
  va_list va; // [rsp+A8h] [rbp+20h]
  __int64 v10; // [rsp+B0h] [rbp+28h]
  __int64 v11; // [rsp+B8h] [rbp+30h]
  _WORD *v12; // [rsp+C0h] [rbp+38h]
  const char *v13; // [rsp+C8h] [rbp+40h]
  va_list va1; // [rsp+D0h] [rbp+48h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v8 = va_arg(va1, _QWORD);
  v10 = va_arg(va1, _QWORD);
  v11 = va_arg(va1, _QWORD);
  v12 = va_arg(va1, _WORD *);
  v13 = va_arg(va1, const char *);
  if ( v13 )
    strlen(v13);
  if ( v12 && *v12 )
  {
    v4 = -1i64;
    v5 = v12;
    do
    {
      if ( !v4 )
        break;
      v6 = *v5++ == 0;
      --v4;
    }
    while ( !v6 );
  }
  return qword_30398(a1, 43i64, &unk_2EC68, 20i64, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000019D44) ----------------------------------------------------
__int64 sub_19D44()
{
  __int64 v0; // rbx
  unsigned __int8 v1; // al
  int v3; // [rsp+70h] [rbp+8h] BYREF

  v3 = 0;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0xAu, (__int64)&unk_2EC68);
  v0 = (unsigned int)sub_1E604(0x2014003u);
  v1 = sub_1E604(0x2014004u);
  qword_304A8 = (ULONG_PTR)sub_27F10(v1, 0i64, 1i64, 1229998416i64, v0, 2, 0, 0, (int)sub_1A1D4, 0, &v3);
  if ( v3 )
  {
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
      sub_1102C(*((_QWORD *)off_30148 + 27), 0xBu, (__int64)&unk_2EC68, v3);
    goto LABEL_15;
  }
  qword_304B0 = sub_1B2A4(1i64, 0x60u);
  if ( !qword_304B0 )
  {
    if ( off_30148 == &off_30148 || (*((_BYTE *)off_30148 + 236) & 1) == 0 || *((_BYTE *)off_30148 + 233) < 2u )
    {
LABEL_17:
      if ( qword_304A8 )
      {
        sub_281E0(qword_304A8, 0);
        qword_304A8 = 0i64;
      }
      byte_3044A = 0;
      return 0i64;
    }
    sub_11008(*((_QWORD *)off_30148 + 27), 0xCu, (__int64)&unk_2EC68);
LABEL_15:
    if ( qword_304B0 )
    {
      sub_1B458(qword_304B0);
      qword_304B0 = 0i64;
    }
    goto LABEL_17;
  }
  sub_1BD50((__int64)&FastMutex);
  byte_3044A = 1;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 1) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0xDu, (__int64)&unk_2EC68);
  return 0i64;
}
// 30148: using guessed type void *off_30148;
// 3044A: using guessed type char byte_3044A;

//----- (0000000000019F48) ----------------------------------------------------
__int64 sub_19F48()
{
  int v0; // er9

  if ( !qword_304A8 )
    return 0i64;
  v0 = sub_28674(qword_304A8);
  if ( !v0 )
  {
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 4) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
      sub_11008(*((_QWORD *)off_30148 + 27), 0x12u, (__int64)&unk_2EC68);
    return 0i64;
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 4) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
    sub_1102C(*((_QWORD *)off_30148 + 27), 0x11u, (__int64)&unk_2EC68, v0);
  return 1i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000019FF8) ----------------------------------------------------
__int64 __fastcall sub_19FF8(unsigned __int64 *a1, __int64 a2, ULONG_PTR **a3)
{
  unsigned int v6; // ebx
  void **v7; // r10
  const char *v8; // rax
  __int64 v9; // r10
  int v10; // eax
  void **v11; // rcx
  __int64 v13; // [rsp+20h] [rbp-28h]

  v6 = 0;
  v7 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 236) & 4) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_30148 + 27), 0x13u, (__int64)&unk_2EC68);
      v7 = (void **)off_30148;
    }
    if ( v7 != &off_30148 && (*((_BYTE *)v7 + 236) & 4) != 0 && *((_BYTE *)v7 + 233) >= 5u )
    {
      v8 = sub_255BC(*(_DWORD *)(a2 + 80));
      sub_19C30(*(_QWORD *)(v9 + 216), 20i64, (__int64)&unk_2EC68, *a1, *(_QWORD *)a2, *(_QWORD *)(a2 + 8), a2 + 16, v8);
    }
  }
  v10 = sub_292A0(qword_304A8, *a1, a2, a3);
  if ( v10 )
  {
    v11 = (void **)off_30148;
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 4) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
    {
      LODWORD(v13) = v10;
      sub_1DC74(*((_QWORD *)off_30148 + 27), 0x15u, (__int64)&unk_2EC68, *a1, v13);
      v11 = (void **)off_30148;
    }
    v6 = 13;
  }
  else
  {
    v11 = (void **)off_30148;
  }
  if ( v11 != &off_30148 && (*((_BYTE *)v11 + 236) & 4) != 0 && *((_BYTE *)v11 + 233) >= 5u )
    sub_11008((__int64)v11[27], 0x16u, (__int64)&unk_2EC68);
  return v6;
}
// 1A09A: variable 'v9' is possibly undefined
// 1A110: variable 'v13' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (000000000001A17C) ----------------------------------------------------
__int64 __fastcall sub_1A17C(unsigned __int64 *a1, __int64 *a2, _QWORD *a3)
{
  __int64 result; // rax
  unsigned int v5; // [rsp+38h] [rbp+10h] BYREF

  *a2 = sub_29768(qword_304A8, *a1, a3, &v5);
  result = v5;
  if ( v5 )
  {
    if ( v5 == 4 )
    {
      *a3 = 0i64;
      result = 5i64;
    }
    else
    {
      result = 1i64;
    }
  }
  return result;
}

//----- (000000000001A1D4) ----------------------------------------------------
void __fastcall sub_1A1D4(__int64 a1)
{
  if ( a1 )
    sub_1B5E0((__int64)qword_304B0, a1);
}

//----- (000000000001A204) ----------------------------------------------------
__int64 sub_1A204()
{
  __int64 result; // rax
  void **v1; // rcx

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 236) & 0x10) != 0 && *((_BYTE *)off_30148 + 233) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 27), 0x17u, (__int64)&unk_2EC68);
  result = sub_2A7EC(qword_304A8);
  if ( !(_DWORD)result )
    goto LABEL_10;
  v1 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return result;
  if ( (*((_BYTE *)off_30148 + 236) & 0x10) != 0 && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    result = sub_1102C(*((_QWORD *)off_30148 + 27), 0x18u, (__int64)&unk_2EC68, result);
LABEL_10:
    v1 = (void **)off_30148;
  }
  if ( v1 != &off_30148 && (*((_BYTE *)v1 + 236) & 0x10) != 0 && *((_BYTE *)v1 + 233) >= 5u )
    result = sub_11008((__int64)v1[27], 0x19u, (__int64)&unk_2EC68);
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001A2D4) ----------------------------------------------------
__int64 __fastcall sub_1A2D4(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+78h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EC58, a2, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001A328) ----------------------------------------------------
__int64 __fastcall sub_1A328(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, const char *a5, const char *a6)
{
  int v9; // [rsp+88h] [rbp+20h] BYREF

  v9 = a4;
  if ( a6 )
    strlen(a6);
  if ( a5 )
    strlen(a5);
  return qword_30398(a1, 43i64, &unk_2EC58, a2, &v9);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001A3F8) ----------------------------------------------------
__int64 __fastcall sub_1A3F8(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5, const char *a6, PVOID a7, PVOID a8)
{
  int v10; // [rsp+A8h] [rbp+20h] BYREF

  v10 = a4;
  a8 = qword_30528;
  a7 = qword_304B8;
  if ( a6 )
    strlen(a6);
  if ( a5 )
    strlen(a5);
  return qword_30398(a1, 43i64, &unk_2EC58, 17i64, &v10);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001A50C) ----------------------------------------------------
__int64 __fastcall sub_1A50C(__int64 a1, _QWORD *a2)
{
  unsigned int v4; // er13
  void **v5; // rcx
  unsigned int v6; // er15
  unsigned int v7; // edi
  const char *v8; // rbx
  const char *v9; // rax
  unsigned int *v10; // r11
  unsigned int v11; // er12
  const signed __int32 *v12; // rcx
  __int64 v13; // rsi
  __int64 v14; // rdi
  const char *v15; // rbx
  const char *v16; // rax
  struct _ERESOURCE *v17; // rcx
  _DWORD *v18; // rdi
  unsigned int v19; // er12
  const signed __int32 *v20; // rcx
  __int64 v21; // rsi
  const char *v22; // rbx
  const char *v23; // rax
  __int64 result; // rax

  v4 = 5;
  v5 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 59, 9u)
    && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0xFu, (__int64)&unk_2EC58);
    v5 = (void **)off_30148;
  }
  if ( a1 && a2 )
  {
    v6 = 34525;
    v7 = 17;
    if ( *(_BYTE *)(a1 + 19) == 6 )
      v7 = 6;
    if ( *(_BYTE *)(a1 + 18) == 4 )
      v6 = 2048;
    if ( v5 != &off_30148 && _bittest((const signed __int32 *)v5 + 59, 9u) && *((_BYTE *)v5 + 233) >= 4u )
    {
      v8 = sub_253E8(v7);
      v9 = sub_25538(v6);
      sub_1A3F8(
        *((_QWORD *)off_30148 + 27),
        17i64,
        (__int64)&unk_2EC58,
        *(unsigned __int16 *)(a1 + 16),
        v9,
        v8,
        qword_304B8,
        qword_30528);
    }
    if ( v7 == 6 )
    {
      KeEnterCriticalRegion();
      sub_1B98C(&stru_304C0);
      v10 = (unsigned int *)qword_304B8;
      if ( qword_304B8 )
      {
        v11 = 0;
        if ( *(_DWORD *)qword_304B8 )
        {
          v12 = (const signed __int32 *)off_30148;
          v13 = 0i64;
          do
          {
            v14 = (__int64)v10 + v13 + 8;
            if ( v12 != (const signed __int32 *)&off_30148 && _bittest(v12 + 59, 9u) && *((_BYTE *)v12 + 233) >= 5u )
            {
              v15 = sub_253E8(*(unsigned int *)((char *)v10 + v13 + 12));
              v16 = sub_25538(*(_DWORD *)v14);
              sub_1A328(
                *((_QWORD *)off_30148 + 27),
                0x12u,
                (__int64)&unk_2EC58,
                *(unsigned __int16 *)(v14 + 8),
                v16,
                v15);
              v12 = (const signed __int32 *)off_30148;
              v10 = (unsigned int *)qword_304B8;
            }
            if ( *(_WORD *)(v14 + 8) == *(_WORD *)(a1 + 16) && *(_DWORD *)v14 == v6 && *(_DWORD *)(v14 + 4) == 6 )
            {
              *a2 = *(unsigned int *)((char *)v10 + v13 + 18);
              v12 = (const signed __int32 *)off_30148;
              if ( off_30148 != &off_30148
                && _bittest((const signed __int32 *)off_30148 + 59, 9u)
                && *((_BYTE *)off_30148 + 233) >= 4u )
              {
                sub_1A2D4(*((_QWORD *)off_30148 + 27), 0x13u, (__int64)&unk_2EC58, *(unsigned __int16 *)(a1 + 16));
                v12 = (const signed __int32 *)off_30148;
                v10 = (unsigned int *)qword_304B8;
              }
              v4 = 0;
            }
            ++v11;
            v13 += 14i64;
          }
          while ( v11 < *v10 );
        }
      }
      v17 = &stru_304C0;
    }
    else
    {
      KeEnterCriticalRegion();
      sub_1B98C(&stru_30530);
      v18 = qword_30528;
      if ( qword_30528 )
      {
        v19 = 0;
        if ( *((_DWORD *)qword_30528 + 1) )
        {
          v20 = (const signed __int32 *)off_30148;
          v21 = 0i64;
          do
          {
            if ( v20 != (const signed __int32 *)&off_30148 && _bittest(v20 + 59, 9u) && *((_BYTE *)v20 + 233) >= 5u )
            {
              v22 = sub_253E8(*(_DWORD *)((char *)v18 + v21 + 12));
              v23 = sub_25538(*(_DWORD *)((char *)v18 + v21 + 8));
              sub_1A328(
                *((_QWORD *)off_30148 + 27),
                0x14u,
                (__int64)&unk_2EC58,
                *(unsigned __int16 *)((char *)v18 + v21 + 16),
                v23,
                v22);
              v20 = (const signed __int32 *)off_30148;
              v18 = qword_30528;
            }
            if ( *(_WORD *)((char *)v18 + v21 + 16) == *(_WORD *)(a1 + 16)
              && *(_DWORD *)((char *)v18 + v21 + 8) == v6
              && *(_DWORD *)((char *)v18 + v21 + 12) == 17 )
            {
              *a2 = *(unsigned int *)((char *)v18 + v21 + 18);
              v20 = (const signed __int32 *)off_30148;
              if ( off_30148 != &off_30148
                && _bittest((const signed __int32 *)off_30148 + 59, 9u)
                && *((_BYTE *)off_30148 + 233) >= 4u )
              {
                sub_1A2D4(*((_QWORD *)off_30148 + 27), 0x15u, (__int64)&unk_2EC58, *(unsigned __int16 *)(a1 + 16));
                v20 = (const signed __int32 *)off_30148;
                v18 = qword_30528;
              }
              v4 = 0;
            }
            ++v19;
            v21 += 14i64;
          }
          while ( v19 < v18[1] );
        }
      }
      v17 = &stru_30530;
    }
    sub_1BA64(v17);
    KeLeaveCriticalRegion();
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 59, 9u)
      && *((_BYTE *)off_30148 + 233) >= 5u )
    {
      sub_11008(*((_QWORD *)off_30148 + 27), 0x16u, (__int64)&unk_2EC58);
    }
    result = v4;
  }
  else
  {
    if ( v5 != &off_30148 && _bittest((const signed __int32 *)v5 + 59, 9u) && *((_BYTE *)v5 + 233) >= 2u )
      sub_14CC4((__int64)v5[27], 0x10u, (__int64)&unk_2EC58, a1, a2);
    result = 4i64;
  }
  return result;
}
// 1A77D: conditional instruction was optimized away because of 'edi.4==11'
// 30148: using guessed type void *off_30148;

//----- (000000000001A974) ----------------------------------------------------
__int64 __fastcall sub_1A974(int *a1)
{
  unsigned int v1; // ebx
  void **v3; // rcx
  PVOID v5; // rax
  PVOID v6; // rax
  char *v7; // r13
  void **v8; // rcx
  unsigned __int16 v9; // dx
  char *v10; // r11
  int v11; // eax
  unsigned int v12; // esi
  int v13; // eax
  unsigned int v14; // er12
  _DWORD *v15; // rbx
  _DWORD *v16; // rbp
  char *v17; // r15
  char *v18; // r14
  int v19; // eax
  PVOID v20; // r11
  PVOID v21; // r11
  __int64 v22; // [rsp+20h] [rbp-48h]
  int v23; // [rsp+28h] [rbp-40h]
  int v24; // [rsp+70h] [rbp+8h]
  unsigned int v25; // [rsp+78h] [rbp+10h]
  char *v26; // [rsp+80h] [rbp+18h]

  v1 = 0;
  v24 = 0;
  v25 = 0;
  v3 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 59, 9u)
    && *((_BYTE *)off_30148 + 233) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 27), 0x17u, (__int64)&unk_2EC58);
    v3 = (void **)off_30148;
  }
  if ( !a1 )
  {
    if ( v3 != &off_30148 && _bittest((const signed __int32 *)v3 + 59, 9u) && *((_BYTE *)v3 + 233) >= 2u )
      sub_11008((__int64)v3[27], 0x18u, (__int64)&unk_2EC58);
    return 4i64;
  }
  if ( !*a1 && !a1[1] )
  {
    if ( v3 != &off_30148 && _bittest((const signed __int32 *)v3 + 59, 9u) && *((_BYTE *)v3 + 233) >= 2u )
    {
      sub_11008((__int64)v3[27], 0x19u, (__int64)&unk_2EC58);
      v3 = (void **)off_30148;
    }
    v5 = qword_304B8;
    if ( qword_304B8 )
    {
      if ( v3 != &off_30148 && _bittest((const signed __int32 *)v3 + 59, 9u) && *((_BYTE *)v3 + 233) >= 4u )
      {
        sub_147C8((__int64)v3[27], 0x1Au, (__int64)&unk_2EC58, qword_304B8);
        v5 = qword_304B8;
      }
      sub_1B0BC(v5, 0x746D6C50u);
      v3 = (void **)off_30148;
      qword_304B8 = 0i64;
    }
    v6 = qword_30528;
    if ( qword_30528 )
    {
      if ( v3 != &off_30148 && _bittest((const signed __int32 *)v3 + 59, 9u) && *((_BYTE *)v3 + 233) >= 4u )
      {
        sub_147C8((__int64)v3[27], 0x1Bu, (__int64)&unk_2EC58, qword_30528);
        v6 = qword_30528;
      }
      sub_1B0BC(v6, 0x556D6C50u);
      qword_30528 = 0i64;
    }
    return 5i64;
  }
  if ( v3 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)v3 + 59, 9u) && *((_BYTE *)v3 + 233) >= 4u )
    {
      sub_1102C((__int64)v3[27], 0x1Cu, (__int64)&unk_2EC58, *a1);
      v3 = (void **)off_30148;
    }
    if ( v3 != &off_30148 && _bittest((const signed __int32 *)v3 + 59, 9u) && *((_BYTE *)v3 + 233) >= 4u )
      sub_1102C((__int64)v3[27], 0x1Du, (__int64)&unk_2EC58, a1[1]);
  }
  v7 = (char *)sub_1B038(2, 14 * (*a1 - 1) + 22, 0x746D6C50u);
  if ( !v7 )
  {
    v8 = (void **)off_30148;
    if ( off_30148 == &off_30148
      || !_bittest((const signed __int32 *)off_30148 + 59, 9u)
      || *((_BYTE *)off_30148 + 233) < 2u )
    {
      goto LABEL_44;
    }
    v9 = 30;
    goto LABEL_43;
  }
  v23 = 0;
  HIDWORD(v22) = 0;
  v10 = (char *)sub_1B038(2, 14 * (a1[1] - 1) + 22, 0x556D6C50u);
  v26 = v10;
  if ( v10 )
  {
    v11 = *a1;
    *((_DWORD *)v7 + 1) = 0;
    v12 = 0;
    *(_DWORD *)v7 = v11;
    v13 = a1[1];
    *(_DWORD *)v10 = 0;
    *((_DWORD *)v10 + 1) = v13;
    v8 = (void **)off_30148;
    v14 = *a1 + a1[1];
    if ( v14 )
    {
      v15 = v10;
      v16 = a1 + 3;
      v17 = v7 + 18;
      v18 = v10 + 18;
      do
      {
        if ( *v16 == 6 )
        {
          sub_2B608(&v7[14 * v24 + 8], 0xEui64, (char *)a1 + 14 * v12 + 8, 0xEui64);
          v8 = (void **)off_30148;
          if ( off_30148 != &off_30148
            && _bittest((const signed __int32 *)off_30148 + 59, 9u)
            && *((_BYTE *)off_30148 + 233) >= 4u )
          {
            v23 = *(_DWORD *)(v17 - 10);
            sub_110E8(*((_QWORD *)off_30148 + 27), 0x20u, (__int64)&unk_2EC58, *((unsigned __int16 *)v17 - 1));
            v8 = (void **)off_30148;
          }
          v19 = v24 + 1;
          v17 += 14;
          ++v24;
        }
        else
        {
          if ( *v16 == 17 )
          {
            sub_2B608((char *)v15 + 14 * v25 + 8, 0xEui64, (char *)a1 + 14 * v12 + 8, 0xEui64);
            v8 = (void **)off_30148;
            if ( off_30148 != &off_30148
              && _bittest((const signed __int32 *)off_30148 + 59, 9u)
              && *((_BYTE *)off_30148 + 233) >= 4u )
            {
              v23 = *(_DWORD *)(v18 - 10);
              sub_110E8(*((_QWORD *)off_30148 + 27), 0x21u, (__int64)&unk_2EC58, *((unsigned __int16 *)v18 - 1));
              v8 = (void **)off_30148;
            }
            ++v25;
            v18 += 14;
          }
          v19 = v24;
        }
        ++v12;
        v16 = (_DWORD *)((char *)v16 + 14);
      }
      while ( v12 < v14 );
      v1 = 0;
      if ( v19 )
      {
        KeEnterCriticalRegion();
        LODWORD(v22) = 0;
        sub_1B98C(&stru_304C0);
        v20 = qword_304B8;
        if ( qword_304B8 )
        {
          if ( off_30148 != &off_30148
            && _bittest((const signed __int32 *)off_30148 + 59, 9u)
            && *((_BYTE *)off_30148 + 233) >= 4u )
          {
            sub_147C8(*((_QWORD *)off_30148 + 27), 0x22u, (__int64)&unk_2EC58, qword_304B8, v22, v23);
            v20 = qword_304B8;
          }
          sub_1B0BC(v20, 0x746D6C50u);
        }
        qword_304B8 = v7;
        sub_1BA64(&stru_304C0);
        KeLeaveCriticalRegion();
        v8 = (void **)off_30148;
      }
      if ( v25 )
      {
        KeEnterCriticalRegion();
        LODWORD(v22) = 0;
        sub_1B98C(&stru_30530);
        v21 = qword_30528;
        if ( qword_30528 )
        {
          if ( off_30148 != &off_30148
            && _bittest((const signed __int32 *)off_30148 + 59, 9u)
            && *((_BYTE *)off_30148 + 233) >= 4u )
          {
            sub_147C8(*((_QWORD *)off_30148 + 27), 0x23u, (__int64)&unk_2EC58, qword_30528, v22);
            v21 = qword_30528;
          }
          sub_1B0BC(v21, 0x556D6C50u);
        }
        qword_30528 = v26;
        sub_1BA64(&stru_30530);
        KeLeaveCriticalRegion();
        v8 = (void **)off_30148;
      }
    }
    goto LABEL_82;
  }
  v8 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 59, 9u)
    && *((_BYTE *)off_30148 + 233) >= 2u )
  {
    v9 = 31;
LABEL_43:
    sub_11008((__int64)v8[27], v9, (__int64)&unk_2EC58);
    v8 = (void **)off_30148;
  }
LABEL_44:
  v1 = 3;
LABEL_82:
  if ( v8 != &off_30148 && _bittest((const signed __int32 *)v8 + 59, 9u) && *((_BYTE *)v8 + 233) >= 5u )
    sub_11008((__int64)v8[27], 0x24u, (__int64)&unk_2EC58);
  return v1;
}
// 1AF00: variable 'v22' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (000000000001AFB8) ----------------------------------------------------
__int64 __fastcall sub_1AFB8(__int64 a1, unsigned __int16 a2)
{
  strlen(aUnknownModule);
  return qword_30398(a1, 43i64, &unk_2EC48, a2, aUnknownModule);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001B038) ----------------------------------------------------
PVOID __fastcall sub_1B038(int a1, unsigned int a2, ULONG a3)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 4) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1AFB8(*((_QWORD *)off_30148 + 11), 0xAu);
  return sub_1C35C(a1, a2, a3);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001B0BC) ----------------------------------------------------
void __fastcall sub_1B0BC(PVOID P, ULONG Tag)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 4) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1AFB8(*((_QWORD *)off_30148 + 11), 0xBu);
  sub_1C478(P, Tag);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001B130) ----------------------------------------------------
PVOID __fastcall sub_1B130(__int64 a1, void *a2, unsigned int a3, unsigned int a4)
{
  size_t v5; // rsi
  void **v7; // rcx
  PVOID v8; // rax
  PVOID v9; // rbx

  v5 = a3;
  v7 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 4) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0xCu);
      v7 = (void **)off_30148;
    }
    if ( v7 != &off_30148 )
    {
      if ( (*((_BYTE *)v7 + 108) & 2) != 0 && *((_BYTE *)v7 + 105) >= 4u )
      {
        sub_11008((__int64)v7[11], 0x10u, (__int64)&unk_2EC38);
        v7 = (void **)off_30148;
      }
      if ( v7 != &off_30148 && (*((_BYTE *)v7 + 108) & 4) != 0 && *((_BYTE *)v7 + 105) >= 6u )
        sub_1C230((__int64)v7[11], 17i64, (__int64)&unk_2EC38, (int)a2);
    }
  }
  v8 = sub_1C35C(1, a4, 0x706D744Eu);
  v9 = v8;
  if ( v8 && a2 )
  {
    memmove(v8, a2, v5);
    sub_1C478(a2, 0x706D744Eu);
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_30148 + 11), 0x12u, (__int64)&unk_2EC38, (int)v9);
  return v9;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001B2A4) ----------------------------------------------------
char *__fastcall sub_1B2A4(__int64 a1, unsigned int a2)
{
  __int64 v2; // rdi
  void **v3; // rcx
  char *v4; // rbx
  char *v5; // rax

  v2 = a2;
  v3 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 4) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
  {
    sub_1AFB8(*((_QWORD *)off_30148 + 11), 0xDu);
    v3 = (void **)off_30148;
  }
  v4 = 0i64;
  if ( v3 != &off_30148 && (*((_BYTE *)v3 + 108) & 2) != 0 && *((_BYTE *)v3 + 105) >= 4u )
  {
    sub_11008((__int64)v3[11], 0x13u, (__int64)&unk_2EC38);
    v3 = (void **)off_30148;
  }
  if ( (_DWORD)v2 )
  {
    v5 = (char *)sub_1C35C(2, 0xC0u, 0x49504950u);
    v4 = v5;
    if ( v5 )
    {
      memset(v5, 0, 0xC0ui64);
      *((_DWORD *)v4 + 1) = v2;
      *(_DWORD *)v4 = 1;
      *((_DWORD *)v4 + 2) = 1229998416;
      if ( off_30148 == &off_30148 || (*((_BYTE *)off_30148 + 108) & 4) == 0 || *((_BYTE *)off_30148 + 105) < 5u )
        goto LABEL_17;
      sub_11008(*((_QWORD *)off_30148 + 11), 0x14u, (__int64)&unk_2EC38);
      if ( *(_DWORD *)v4 == 2 )
        ExInitializeNPagedLookasideList((PNPAGED_LOOKASIDE_LIST)(v4 + 64), 0i64, 0i64, 0, v2 + 7, 0x49504950u, 0);
      if ( *(_DWORD *)v4 == 1 )
LABEL_17:
        ExInitializePagedLookasideList((PPAGED_LOOKASIDE_LIST)(v4 + 64), 0i64, 0i64, 0, v2 + 7, 0x49504950u, 0);
    }
    v3 = (void **)off_30148;
  }
  if ( v3 != &off_30148 && (*((_BYTE *)v3 + 108) & 2) != 0 && *((_BYTE *)v3 + 105) >= 4u )
    sub_1102C((__int64)v3[11], 0x15u, (__int64)&unk_2EC38, (int)v4);
  return v4;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001B458) ----------------------------------------------------
void __fastcall sub_1B458(PVOID P)
{
  void **v2; // rcx

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 4) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0xEu);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 )
    {
      if ( (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      {
        sub_11008((__int64)v2[11], 0x16u, (__int64)&unk_2EC38);
        v2 = (void **)off_30148;
      }
      if ( v2 != &off_30148 && (*((_BYTE *)v2 + 108) & 4) != 0 && *((_BYTE *)v2 + 105) >= 5u )
        sub_11008((__int64)v2[11], 0x17u, (__int64)&unk_2EC38);
    }
  }
  if ( *(_DWORD *)P == 2 )
  {
    ExDeleteNPagedLookasideList((PNPAGED_LOOKASIDE_LIST)((char *)P + 64));
  }
  else if ( *(_DWORD *)P == 1 )
  {
    ExDeletePagedLookasideList((PPAGED_LOOKASIDE_LIST)((char *)P + 64));
  }
  sub_1C478(P, *((_DWORD *)P + 2));
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x18u, (__int64)&unk_2EC38);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001B578) ----------------------------------------------------
_DWORD *__fastcall sub_1B578(__int64 a1)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 4) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1AFB8(*((_QWORD *)off_30148 + 11), 0xFu);
  return sub_1C570(a1);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001B5E0) ----------------------------------------------------
void __fastcall sub_1B5E0(__int64 a1, __int64 a2)
{
  void **v4; // rcx
  struct _SLIST_ENTRY *v5; // rdi

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 4) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x10u);
      v4 = (void **)off_30148;
    }
    if ( v4 != &off_30148 && (*((_BYTE *)v4 + 108) & 2) != 0 && *((_BYTE *)v4 + 105) >= 4u )
    {
      sub_11008((__int64)v4[11], 0x1Bu, (__int64)&unk_2EC38);
      v4 = (void **)off_30148;
    }
  }
  v5 = (struct _SLIST_ENTRY *)(a2 - 4);
  if ( LODWORD(v5->Next) )
  {
    if ( LODWORD(v5->Next) == 1 )
    {
      sub_1C478(v5, *(_DWORD *)(a1 + 8));
LABEL_18:
      v4 = (void **)off_30148;
      goto LABEL_19;
    }
  }
  else if ( *(_DWORD *)a1 == 2 || *(_DWORD *)a1 == 1 )
  {
    ++*(_DWORD *)(a1 + 92);
    if ( ExQueryDepthSList((PSLIST_HEADER)(a1 + 64)) < *(_WORD *)(a1 + 80) )
    {
      ExpInterlockedPushEntrySList((PSLIST_HEADER)(a1 + 64), v5);
    }
    else
    {
      ++*(_DWORD *)(a1 + 96);
      (*(void (__fastcall **)(struct _SLIST_ENTRY *))(a1 + 120))(v5);
    }
    goto LABEL_18;
  }
LABEL_19:
  if ( v4 != &off_30148 && (*((_BYTE *)v4 + 108) & 2) != 0 && *((_BYTE *)v4 + 105) >= 4u )
    sub_11008((__int64)v4[11], 0x1Cu, (__int64)&unk_2EC38);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001B70C) ----------------------------------------------------
__int64 __fastcall sub_1B70C(PERESOURCE Resource)
{
  void **v2; // rcx
  int v3; // eax
  unsigned int v4; // ebx

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x12u);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x1Fu, (__int64)&unk_2EC38);
  }
  v3 = ExInitializeResourceLite(Resource);
  v4 = v3;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_30148 + 11), 0x20u, (__int64)&unk_2EC38, v3);
  return v4;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001B7E0) ----------------------------------------------------
__int64 __fastcall sub_1B7E0(PERESOURCE Resource)
{
  void **v2; // rcx
  int v3; // eax
  unsigned int v4; // ebx

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x13u);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x21u, (__int64)&unk_2EC38);
  }
  v3 = ExDeleteResourceLite(Resource);
  v4 = v3;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_30148 + 11), 0x22u, (__int64)&unk_2EC38, v3);
  return v4;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001B8B4) ----------------------------------------------------
BOOLEAN __fastcall sub_1B8B4(PERESOURCE Resource)
{
  void **v2; // rcx
  BOOLEAN v3; // al
  BOOLEAN v4; // bl

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x15u);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x25u, (__int64)&unk_2EC38);
  }
  v3 = ExAcquireResourceExclusiveLite(Resource, 1u);
  v4 = v3;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_30148 + 11), 0x26u, (__int64)&unk_2EC38, v3);
  return v4;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001B98C) ----------------------------------------------------
BOOLEAN __fastcall sub_1B98C(PERESOURCE Resource)
{
  void **v2; // rcx
  BOOLEAN v3; // al
  BOOLEAN v4; // bl

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x16u);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x27u, (__int64)&unk_2EC38);
  }
  v3 = ExAcquireResourceSharedLite(Resource, 1u);
  v4 = v3;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_30148 + 11), 0x28u, (__int64)&unk_2EC38, v3);
  return v4;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001BA64) ----------------------------------------------------
void __fastcall sub_1BA64(PERESOURCE Resource)
{
  void **v2; // rcx

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x18u);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x2Bu, (__int64)&unk_2EC38);
  }
  ExReleaseResourceLite(Resource);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x2Cu, (__int64)&unk_2EC38);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001BB30) ----------------------------------------------------
void __fastcall sub_1BB30(PKSPIN_LOCK SpinLock, KIRQL *a2)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x1Bu);
  sub_1C6F8(SpinLock, a2);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001BBA8) ----------------------------------------------------
void __fastcall sub_1BBA8(PKSPIN_LOCK SpinLock, KIRQL a2)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x1Cu);
  sub_1C7B0(SpinLock, a2);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001BC1C) ----------------------------------------------------
int __fastcall sub_1BC1C(PRKEVENT Event)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x1Fu);
  return sub_1C9D4(Event);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001BC84) ----------------------------------------------------
int __fastcall sub_1BC84(PRKEVENT Event)
{
  void **v2; // rcx
  int result; // eax

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x20u);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x3Bu, (__int64)&unk_2EC38);
  }
  result = KeResetEvent(Event);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    result = sub_11008(*((_QWORD *)off_30148 + 11), 0x3Cu, (__int64)&unk_2EC38);
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001BD50) ----------------------------------------------------
void __fastcall sub_1BD50(__int64 a1)
{
  void **v2; // rcx

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x21u);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x3Du, (__int64)&unk_2EC38);
  }
  *(_QWORD *)(a1 + 8) = 0i64;
  *(_DWORD *)(a1 + 16) = 0;
  *(_DWORD *)a1 = 1;
  KeInitializeEvent((PRKEVENT)(a1 + 24), SynchronizationEvent, 0);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x3Eu, (__int64)&unk_2EC38);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001BE30) ----------------------------------------------------
void __fastcall sub_1BE30(PFAST_MUTEX FastMutex)
{
  void **v2; // rcx

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x22u);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x3Fu, (__int64)&unk_2EC38);
  }
  ExAcquireFastMutex(FastMutex);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x40u, (__int64)&unk_2EC38);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001BEFC) ----------------------------------------------------
void __fastcall sub_1BEFC(PFAST_MUTEX FastMutex)
{
  void **v2; // rcx

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x24u);
      v2 = (void **)off_30148;
    }
    if ( v2 != &off_30148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
      sub_11008((__int64)v2[11], 0x43u, (__int64)&unk_2EC38);
  }
  ExReleaseFastMutex(FastMutex);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x44u, (__int64)&unk_2EC38);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001BFC8) ----------------------------------------------------
_QWORD *sub_1BFC8()
{
  PVOID v0; // rsi
  void **v1; // rcx
  _QWORD *v2; // rbx
  _QWORD *v3; // rdi

  v0 = qword_303D0;
  v1 = (void **)off_30148;
  v2 = 0i64;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 108) < 0 && *((_BYTE *)off_30148 + 105) >= 4u )
  {
    sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x2Eu);
    v1 = (void **)off_30148;
  }
  v3 = 0i64;
  if ( v1 != &off_30148 && (*((_BYTE *)v1 + 108) & 2) != 0 && *((_BYTE *)v1 + 105) >= 4u )
  {
    sub_11008((__int64)v1[11], 0x68u, (__int64)&unk_2EC38);
    v1 = (void **)off_30148;
  }
  if ( v0 && sub_1A204 )
  {
    v3 = sub_1C35C(2, 0x2Cu, 0x6E635749u);
LABEL_16:
    if ( v3 )
    {
      memset(v3, 0, 0x2Cui64);
      v3[4] = 0i64;
      v2 = v3 + 5;
      v3[1] = v3;
      *v3 = v3;
      v3[3] = sub_1A204;
      v3[2] = v0;
    }
    v1 = (void **)off_30148;
    goto LABEL_19;
  }
  if ( v1 == &off_30148 )
    return v2;
  if ( *((char *)v1 + 108) < 0 && *((_BYTE *)v1 + 105) >= 3u )
  {
    sub_11008((__int64)v1[11], 0x69u, (__int64)&unk_2EC38);
    goto LABEL_16;
  }
LABEL_19:
  if ( v1 != &off_30148 && (*((_BYTE *)v1 + 108) & 2) != 0 && *((_BYTE *)v1 + 105) >= 4u )
    sub_1102C((__int64)v1[11], 0x6Au, (__int64)&unk_2EC38, (int)v2);
  return v2;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001C134) ----------------------------------------------------
void __fastcall sub_1C134(__int64 a1)
{
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 108) < 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x30u);
  sub_1D670(a1);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001C1A0) ----------------------------------------------------
__int64 __fastcall sub_1C1A0(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+B8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EC38, 14i64, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001C230) ----------------------------------------------------
__int64 __fastcall sub_1C230(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+C8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EC38, 17i64, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001C2CC) ----------------------------------------------------
__int64 __fastcall sub_1C2CC(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+B8h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EC38, 11i64, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001C35C) ----------------------------------------------------
PVOID __fastcall sub_1C35C(int a1, unsigned int a2, ULONG a3)
{
  SIZE_T v4; // rdi
  void **v6; // rcx
  PVOID v7; // rax
  PVOID v8; // rbx

  v4 = a2;
  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_11008(*((_QWORD *)off_30148 + 11), 0xAu, (__int64)&unk_2EC38);
      v6 = (void **)off_30148;
    }
    if ( v6 != &off_30148 && (*((_BYTE *)v6 + 108) & 4) != 0 && *((_BYTE *)v6 + 105) >= 6u )
      sub_1C2CC((__int64)v6[11], 11i64, (__int64)&unk_2EC38, v4);
  }
  v7 = ExAllocatePoolWithTag((POOL_TYPE)(a1 != 2), v4, a3);
  v8 = v7;
  if ( v7 )
    memset(v7, 0, v4);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_30148 + 11), 0xCu, (__int64)&unk_2EC38, (int)v8);
  return v8;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001C478) ----------------------------------------------------
void __fastcall sub_1C478(PVOID P, ULONG Tag)
{
  void **v4; // rcx

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    {
      sub_11008(*((_QWORD *)off_30148 + 11), 0xDu, (__int64)&unk_2EC38);
      v4 = (void **)off_30148;
    }
    if ( v4 != &off_30148 && (*((_BYTE *)v4 + 108) & 4) != 0 && *((_BYTE *)v4 + 105) >= 6u )
    {
      sub_1C1A0((__int64)v4[11], 14i64, (__int64)&unk_2EC38, (int)P);
      v4 = (void **)off_30148;
    }
  }
  if ( P )
  {
    ExFreePoolWithTag(P, Tag);
    v4 = (void **)off_30148;
  }
  if ( v4 != &off_30148 && (*((_BYTE *)v4 + 108) & 2) != 0 && *((_BYTE *)v4 + 105) >= 4u )
    sub_11008((__int64)v4[11], 0xFu, (__int64)&unk_2EC38);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001C570) ----------------------------------------------------
_DWORD *__fastcall sub_1C570(__int64 a1)
{
  _DWORD *v2; // rbx
  _DWORD *v3; // rax

  v2 = 0i64;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x19u, (__int64)&unk_2EC38);
  if ( (*(_DWORD *)a1 == 2 || *(_DWORD *)a1 == 1)
    && ((++*(_DWORD *)(a1 + 84), (v3 = ExpInterlockedPopEntrySList((PSLIST_HEADER)(a1 + 64))) != 0i64)
     || (++*(_DWORD *)(a1 + 88),
         (v3 = (_DWORD *)(*(__int64 (__fastcall **)(_QWORD, _QWORD, _QWORD))(a1 + 112))(
                           *(unsigned int *)(a1 + 100),
                           *(unsigned int *)(a1 + 108),
                           *(unsigned int *)(a1 + 104))) != 0i64)) )
  {
    *v3 = 0;
  }
  else
  {
    v3 = sub_1C35C(*(_DWORD *)a1, *(_DWORD *)(a1 + 4) + 7, *(_DWORD *)(a1 + 8));
    if ( !v3 )
      goto LABEL_14;
    *v3 = 1;
  }
  v2 = v3 + 1;
  if ( v3 != (_DWORD *)-4i64 )
    memset(v3 + 1, 0, *(unsigned int *)(a1 + 4));
LABEL_14:
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_30148 + 11), 0x1Au, (__int64)&unk_2EC38, (int)v2);
  return v2;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001C674) ----------------------------------------------------
__int64 __fastcall sub_1C674(_QWORD *a1)
{
  __int64 result; // rax

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    result = sub_11008(*((_QWORD *)off_30148 + 11), 0x2Fu, (__int64)&unk_2EC38);
  *a1 = 0i64;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    result = sub_11008(*((_QWORD *)off_30148 + 11), 0x30u, (__int64)&unk_2EC38);
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001C6F8) ----------------------------------------------------
void __fastcall sub_1C6F8(PKSPIN_LOCK SpinLock, KIRQL *a2)
{
  unsigned __int8 v4; // si

  v4 = KeGetCurrentIrql();
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x31u, (__int64)&unk_2EC38);
  if ( v4 == 2 )
  {
    *a2 = 2;
    KeAcquireSpinLockAtDpcLevel(SpinLock);
  }
  else
  {
    *a2 = KeAcquireSpinLockRaiseToDpc(SpinLock);
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x32u, (__int64)&unk_2EC38);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001C7B0) ----------------------------------------------------
void __fastcall sub_1C7B0(PKSPIN_LOCK SpinLock, KIRQL a2)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x33u, (__int64)&unk_2EC38);
  if ( a2 == 2 )
    KeReleaseSpinLockFromDpcLevel(SpinLock);
  else
    KeReleaseSpinLock(SpinLock, a2);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x34u, (__int64)&unk_2EC38);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001C854) ----------------------------------------------------
bool __fastcall sub_1C854(struct _KEVENT **a1, char a2)
{
  struct _KEVENT *v4; // rax
  struct _KEVENT *v5; // rdi

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x35u, (__int64)&unk_2EC38);
  *a1 = 0i64;
  v4 = (struct _KEVENT *)sub_1C35C(2, 0x18u, 0x6E634556u);
  v5 = v4;
  if ( v4 )
  {
    KeInitializeEvent(v4, (EVENT_TYPE)(a2 == 0), 0);
    *a1 = v5;
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_30148 + 11), 0x36u, (__int64)&unk_2EC38, v5 != 0i64);
  return v5 != 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001C93C) ----------------------------------------------------
void __fastcall sub_1C93C(PVOID P)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x37u, (__int64)&unk_2EC38);
  KeClearEvent((PRKEVENT)P);
  sub_1C478(P, 0x6E634556u);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x38u, (__int64)&unk_2EC38);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001C9D4) ----------------------------------------------------
int __fastcall sub_1C9D4(PRKEVENT Event)
{
  int result; // eax

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x39u, (__int64)&unk_2EC38);
  result = KeSetEvent(Event, 0, 0);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    result = sub_11008(*((_QWORD *)off_30148 + 11), 0x3Au, (__int64)&unk_2EC38);
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001CA64) ----------------------------------------------------
void __fastcall HandleInformation(PVOID StartContext)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x49u, (__int64)&unk_2EC38);
  (*(void (__fastcall **)(_QWORD))StartContext)(*((_QWORD *)StartContext + 1));
  sub_1C478(StartContext, 0x6E635448u);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x4Au, (__int64)&unk_2EC38);
  PsTerminateSystemThread(0);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001CB00) ----------------------------------------------------
unsigned __int8 __fastcall sub_1CB00(PVOID *Object, __int64 a2, __int64 (__fastcall *a3)(void ***a1))
{
  unsigned __int8 v5; // bl
  __int64 (__fastcall **v6)(void ***); // rax
  __int64 (__fastcall **StartContext)(void ***); // rsi
  struct _OBJECT_ATTRIBUTES ObjectAttributes; // [rsp+40h] [rbp-48h] BYREF
  void *ThreadHandle; // [rsp+90h] [rbp+8h] BYREF

  v5 = 1;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x4Bu, (__int64)&unk_2EC38);
  v6 = (__int64 (__fastcall **)(void ***))sub_1C35C(2, 0x10u, 0x6E635448u);
  *Object = 0i64;
  StartContext = v6;
  if ( !v6 )
    goto LABEL_10;
  memset(&ObjectAttributes.RootDirectory, 0, 0x28ui64);
  ThreadHandle = 0i64;
  *StartContext = sub_1CCFC;
  ObjectAttributes.Length = 48;
  StartContext[1] = a3;
  if ( !PsCreateSystemThread(
          &ThreadHandle,
          0x1F03FFu,
          &ObjectAttributes,
          0i64,
          0i64,
          (PKSTART_ROUTINE)HandleInformation,
          StartContext) )
  {
    ObReferenceObjectByHandle(ThreadHandle, 0, 0i64, 0, Object, 0i64);
    ZwClose(ThreadHandle);
  }
  if ( !*Object )
  {
    sub_1C478(StartContext, 0x6E635448u);
LABEL_10:
    v5 = 0;
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_30148 + 11), 0x4Cu, (__int64)&unk_2EC38, v5);
  return v5;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001CC68) ----------------------------------------------------
__int64 __fastcall sub_1CC68(PVOID Object)
{
  void **v2; // rcx
  __int64 result; // rax

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
  {
    result = sub_11008(*((_QWORD *)off_30148 + 11), 0x4Du, (__int64)&unk_2EC38);
    v2 = (void **)off_30148;
  }
  if ( Object )
  {
    result = ObfDereferenceObject(Object);
    v2 = (void **)off_30148;
  }
  if ( v2 != &off_30148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
    result = sub_11008((__int64)v2[11], 0x4Eu, (__int64)&unk_2EC38);
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001CCFC) ----------------------------------------------------
__int64 __fastcall sub_1CCFC(void ***a1)
{
  void **v1; // r12
  __int64 v2; // rdi
  void *v4; // rax
  ULONG v5; // er14
  void *v6; // rdx
  void **v7; // r10
  unsigned int v8; // ebp
  __int64 v9; // rsi
  __int64 v10; // r13
  __int64 v11; // rsi
  _QWORD **v12; // rcx
  _QWORD *v13; // rbx
  _QWORD *v14; // rax
  char *v15; // rcx
  void (__fastcall *v16)(_QWORD *); // rax
  __int64 result; // rax
  void **v18; // rcx
  PVOID v19[2]; // [rsp+30h] [rbp-48h] BYREF
  __int64 v20; // [rsp+40h] [rbp-38h]
  KIRQL v21; // [rsp+80h] [rbp+8h] BYREF

  v1 = *a1;
  v2 = *((int *)a1 + 2);
  v4 = **a1;
  v5 = 2;
  v21 = 0;
  v19[0] = v4;
  v6 = (void *)*((_QWORD *)v1[3] + 3);
  v20 = 0i64;
  v19[1] = v6;
  v7 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
  {
    sub_11008(*((_QWORD *)off_30148 + 11), 0x53u, (__int64)&unk_2EC38);
    v7 = (void **)off_30148;
  }
  if ( *((_BYTE *)v1 + 12) )
  {
    v5 = 3;
    v20 = *((_QWORD *)v1[3] + 4 * (unsigned int)v2 + 3);
  }
  if ( a1[2] )
  {
    if ( v7 != &off_30148 && *((char *)v7 + 108) < 0 && *((_BYTE *)v7 + 105) >= 5u )
      sub_1102C((__int64)v7[11], 0x54u, (__int64)&unk_2EC38, v2);
    sub_1C9D4((PRKEVENT)a1[2]);
  }
  while ( 1 )
  {
    result = sub_1D7FC(v5, v19);
    if ( !(_DWORD)result )
      break;
    v8 = 0;
    v9 = 0i64;
    if ( (_DWORD)result == 2 )
    {
      v8 = v2;
      v9 = v2;
    }
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 108) < 0 && *((_BYTE *)off_30148 + 105) >= 5u )
      sub_1102C(*((_QWORD *)off_30148 + 11), 0x56u, (__int64)&unk_2EC38, v2);
    v10 = 32i64 * v8;
    sub_1C6F8((PKSPIN_LOCK)((char *)v1[3] + v10), &v21);
    v11 = 32 * v9;
    v12 = (_QWORD **)((char *)v1[3] + v11 + 8);
    v13 = 0i64;
    if ( *v12 != v12 )
    {
      v13 = *v12;
      v14 = (_QWORD *)**v12;
      *v12 = v14;
      v14[1] = v12;
      if ( off_30148 != &off_30148 && *((char *)off_30148 + 108) < 0 && *((_BYTE *)off_30148 + 105) >= 5u )
        sub_139F8(*((_QWORD *)off_30148 + 11), 0x57u, (__int64)&unk_2EC38, v2);
      v15 = (char *)v1[3];
      if ( *(char **)&v15[v11 + 8] != &v15[v11 + 8] )
        sub_1C9D4(*(PRKEVENT *)&v15[v11 + 24]);
    }
    sub_1C7B0((PKSPIN_LOCK)((char *)v1[3] + v10), v21);
    if ( v13 )
    {
      if ( off_30148 != &off_30148 && *((char *)off_30148 + 108) < 0 && *((_BYTE *)off_30148 + 105) >= 5u )
        sub_139F8(*((_QWORD *)off_30148 + 11), 0x58u, (__int64)&unk_2EC38, v2);
      v16 = (void (__fastcall *)(_QWORD *))v13[3];
      if ( v16 )
        v16(v13 + 5);
      sub_1D5AC((__int64)(v13 + 5), 0);
      if ( off_30148 != &off_30148 && *((char *)off_30148 + 108) < 0 && *((_BYTE *)off_30148 + 105) >= 5u )
        sub_139F8(*((_QWORD *)off_30148 + 11), 0x59u, (__int64)&unk_2EC38, v2);
    }
  }
  v18 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( *((char *)off_30148 + 108) < 0 && *((_BYTE *)off_30148 + 105) >= 5u )
    {
      result = sub_1102C(*((_QWORD *)off_30148 + 11), 0x55u, (__int64)&unk_2EC38, v2);
      v18 = (void **)off_30148;
    }
    if ( v18 != &off_30148 && (*((_BYTE *)v18 + 108) & 2) != 0 && *((_BYTE *)v18 + 105) >= 4u )
      result = sub_11008((__int64)v18[11], 0x5Au, (__int64)&unk_2EC38);
  }
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001D008) ----------------------------------------------------
__int64 __fastcall sub_1D008(unsigned int a1)
{
  __int64 v1; // r12
  int v2; // edi
  PVOID v3; // rax
  __int64 v4; // rbx
  PVOID v5; // rax
  unsigned int v6; // esi
  _QWORD *v7; // r11
  __int64 v8; // rbp
  unsigned int v9; // er13
  PVOID *v10; // rcx
  __int64 v12; // [rsp+30h] [rbp-38h] BYREF
  unsigned int v13; // [rsp+38h] [rbp-30h]
  PVOID P; // [rsp+40h] [rbp-28h] BYREF

  v1 = a1;
  v2 = 0;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x5Bu, (__int64)&unk_2EC38);
  v3 = sub_1C35C(2, 0x20u, 0x6E635450u);
  v4 = (__int64)v3;
  if ( v3
    && (memset(v3, 0, 0x20ui64),
        sub_1C854((struct _KEVENT **)v4, 1),
        *(_DWORD *)(v4 + 8) = v1,
        *(_BYTE *)(v4 + 12) = 0,
        *(_QWORD *)(v4 + 16) = sub_1C35C(2, 8 * (int)v1, 0x6E635450u),
        v5 = sub_1C35C(2, 0x20u, 0x6E635450u),
        *(_QWORD *)(v4 + 24) = v5,
        *(_QWORD *)(v4 + 16))
    && v5 )
  {
    v12 = v4;
    sub_1C854((struct _KEVENT **)&P, 0);
    memset(*(void **)(v4 + 16), 0, 8 * v1);
    memset(*(void **)(v4 + 24), 0, 0x20ui64);
    sub_1C674(*(_QWORD **)(v4 + 24));
    sub_1C854((struct _KEVENT **)(*(_QWORD *)(v4 + 24) + 24i64), 0);
    v6 = 0;
    v7 = (_QWORD *)(*(_QWORD *)(v4 + 24) + 8i64);
    v7[1] = v7;
    *v7 = v7;
    if ( (_DWORD)v1 )
    {
      v8 = 0i64;
      while ( 1 )
      {
        if ( off_30148 != &off_30148 && *((char *)off_30148 + 108) < 0 && *((_BYTE *)off_30148 + 105) >= 5u )
          sub_139F8(*((_QWORD *)off_30148 + 11), 0x5Cu, (__int64)&unk_2EC38, v6 + 1);
        v9 = v6 + 1;
        v10 = (PVOID *)(*(_QWORD *)(v4 + 16) + 8i64 * v6);
        v13 = v6 + 1;
        sub_1CB00(v10, (__int64)sub_1CCFC, (__int64 (__fastcall *)(void ***))&v12);
        if ( !*(_QWORD *)(*(_QWORD *)(v4 + 16) + v8) )
          break;
        sub_1D754(P);
        v8 += 8i64;
        ++v6;
        if ( v9 >= (unsigned int)v1 )
          goto LABEL_18;
      }
      v2 = -16777213;
    }
LABEL_18:
    sub_1C93C(P);
  }
  else
  {
    v2 = -16777213;
  }
  if ( v2 && v4 )
  {
    sub_1D250((PVOID)v4);
    v4 = 0i64;
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_30148 + 11), 0x5Du, (__int64)&unk_2EC38, v4);
  return v4;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001D250) ----------------------------------------------------
__int64 __fastcall sub_1D250(PVOID P)
{
  void **v2; // rcx
  unsigned int v3; // eax
  __int64 v4; // rsi
  __int64 v5; // rbp
  __int64 v6; // r12
  void **v7; // rcx
  __int64 v8; // rdx
  _QWORD **v9; // rcx
  _QWORD *v10; // rdi
  _QWORD *v11; // rax
  unsigned int v12; // esi
  __int64 v13; // rdi
  __int64 v14; // rbp
  KIRQL v16; // [rsp+50h] [rbp+8h] BYREF

  v16 = 0;
  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
  {
    sub_11008(*((_QWORD *)off_30148 + 11), 0x5Eu, (__int64)&unk_2EC38);
    v2 = (void **)off_30148;
  }
  if ( *((_BYTE *)P + 12) )
    v3 = *((_DWORD *)P + 2) + 1;
  else
    v3 = 1;
  if ( v3 )
  {
    v4 = 0i64;
    v5 = 0i64;
    v6 = v3;
    do
    {
      sub_1C6F8((PKSPIN_LOCK)(v5 + *((_QWORD *)P + 3)), &v16);
      v7 = (void **)off_30148;
      if ( off_30148 != &off_30148 && *((char *)off_30148 + 108) < 0 && *((_BYTE *)off_30148 + 105) >= 5u )
      {
        sub_11008(*((_QWORD *)off_30148 + 11), 0x5Fu, (__int64)&unk_2EC38);
        v7 = (void **)off_30148;
      }
      v8 = *((_QWORD *)P + 3);
      if ( *(_QWORD *)(v4 + v8 + 8) != v4 + v8 + 8 )
      {
        do
        {
          v9 = (_QWORD **)(v4 + v8 + 8);
          v10 = *v9;
          v11 = (_QWORD *)**v9;
          *v9 = v11;
          v11[1] = v9;
          if ( off_30148 != &off_30148 && *((char *)off_30148 + 108) < 0 && *((_BYTE *)off_30148 + 105) >= 5u )
            sub_1102C(*((_QWORD *)off_30148 + 11), 0x60u, (__int64)&unk_2EC38, (int)v10);
          sub_1D5AC((__int64)(v10 + 5), 1);
          v8 = *((_QWORD *)P + 3);
        }
        while ( *(_QWORD *)(v4 + v8 + 8) != v4 + v8 + 8 );
        v7 = (void **)off_30148;
      }
      if ( v7 != &off_30148 && *((char *)v7 + 108) < 0 && *((_BYTE *)v7 + 105) >= 5u )
        sub_11008((__int64)v7[11], 0x61u, (__int64)&unk_2EC38);
      sub_1C7B0((PKSPIN_LOCK)(v5 + *((_QWORD *)P + 3)), v16);
      v5 += 32i64;
      v4 += 32i64;
      --v6;
    }
    while ( v6 );
    v2 = (void **)off_30148;
  }
  if ( *(_QWORD *)P )
  {
    if ( v2 != &off_30148 && *((char *)v2 + 108) < 0 && *((_BYTE *)v2 + 105) >= 5u )
      sub_11008((__int64)v2[11], 0x62u, (__int64)&unk_2EC38);
    sub_1C9D4(*(PRKEVENT *)P);
    v2 = (void **)off_30148;
  }
  if ( v2 != &off_30148 && *((char *)v2 + 108) < 0 && *((_BYTE *)v2 + 105) >= 5u )
  {
    sub_1102C((__int64)v2[11], 0x63u, (__int64)&unk_2EC38, *((_DWORD *)P + 2));
    v2 = (void **)off_30148;
  }
  v12 = 0;
  if ( *((_DWORD *)P + 2) )
  {
    v13 = 0i64;
    v14 = 32i64;
    do
    {
      if ( *(_QWORD *)(v13 + *((_QWORD *)P + 2)) )
      {
        if ( v2 != &off_30148 && *((char *)v2 + 108) < 0 && *((_BYTE *)v2 + 105) >= 5u )
          sub_1102C((__int64)v2[11], 0x64u, (__int64)&unk_2EC38, v12);
        sub_1D754(*(PVOID *)(v13 + *((_QWORD *)P + 2)));
        if ( off_30148 != &off_30148 && *((char *)off_30148 + 108) < 0 && *((_BYTE *)off_30148 + 105) >= 5u )
          sub_1102C(*((_QWORD *)off_30148 + 11), 0x65u, (__int64)&unk_2EC38, v12);
        sub_1CC68(*(PVOID *)(v13 + *((_QWORD *)P + 2)));
        *(_QWORD *)(v13 + *((_QWORD *)P + 2)) = 0i64;
        if ( *((_BYTE *)P + 12) )
          sub_1C93C(*(PVOID *)(*((_QWORD *)P + 3) + v14 + 24));
        v2 = (void **)off_30148;
      }
      ++v12;
      v14 += 32i64;
      v13 += 8i64;
    }
    while ( v12 < *((_DWORD *)P + 2) );
  }
  if ( v2 != &off_30148 && *((char *)v2 + 108) < 0 && *((_BYTE *)v2 + 105) >= 5u )
    sub_11008((__int64)v2[11], 0x66u, (__int64)&unk_2EC38);
  sub_1C93C(*(PVOID *)(*((_QWORD *)P + 3) + 24i64));
  sub_1C93C(*(PVOID *)P);
  sub_1C478(*((PVOID *)P + 2), 0x6E635450u);
  sub_1C478(*((PVOID *)P + 3), 0x6E635450u);
  sub_1C478(P, 0x6E635450u);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x67u, (__int64)&unk_2EC38);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001D5AC) ----------------------------------------------------
void __fastcall sub_1D5AC(__int64 a1, char a2)
{
  void **v4; // rcx
  void (__fastcall *v5)(__int64); // rax

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
  {
    sub_11008(*((_QWORD *)off_30148 + 11), 0x6Bu, (__int64)&unk_2EC38);
    v4 = (void **)off_30148;
  }
  if ( a1 )
  {
    if ( a2 )
    {
      v5 = *(void (__fastcall **)(__int64))(a1 - 8);
      if ( v5 )
        v5(a1);
    }
    sub_1C478((PVOID)(a1 - 40), 0x6E635749u);
    v4 = (void **)off_30148;
  }
  if ( v4 != &off_30148 && (*((_BYTE *)v4 + 108) & 2) != 0 && *((_BYTE *)v4 + 105) >= 4u )
    sub_11008((__int64)v4[11], 0x6Cu, (__int64)&unk_2EC38);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001D670) ----------------------------------------------------
void __fastcall sub_1D670(__int64 a1)
{
  void **v2; // rcx
  __int64 v3; // rdi
  _QWORD *v4; // rbx
  KSPIN_LOCK *v5; // rcx
  __int64 v6; // r11
  _QWORD *v7; // rax
  KIRQL v8; // [rsp+30h] [rbp+8h] BYREF

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
  {
    sub_11008(*((_QWORD *)off_30148 + 11), 0x6Du, (__int64)&unk_2EC38);
    v2 = (void **)off_30148;
  }
  if ( a1 )
  {
    v3 = *(_QWORD *)(a1 - 24);
    v4 = (_QWORD *)(a1 - 40);
    v5 = *(KSPIN_LOCK **)(v3 + 24);
    v8 = 0;
    sub_1C6F8(v5, &v8);
    v6 = *(_QWORD *)(v3 + 24);
    v7 = *(_QWORD **)(v6 + 16);
    v6 += 8i64;
    v4[1] = v7;
    *v4 = v6;
    *v7 = v4;
    *(_QWORD *)(v6 + 8) = v4;
    sub_1C9D4(*(PRKEVENT *)(*(_QWORD *)(v3 + 24) + 24i64));
    sub_1C7B0(*(PKSPIN_LOCK *)(v3 + 24), v8);
    v2 = (void **)off_30148;
  }
  if ( v2 != &off_30148 && (*((_BYTE *)v2 + 108) & 2) != 0 && *((_BYTE *)v2 + 105) >= 4u )
    sub_11008((__int64)v2[11], 0x6Eu, (__int64)&unk_2EC38);
}
// 30148: using guessed type void *off_30148;

//----- (000000000001D754) ----------------------------------------------------
__int64 __fastcall sub_1D754(PVOID Object)
{
  int v2; // eax
  unsigned int v3; // ebx

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x6Fu, (__int64)&unk_2EC38);
  v2 = KeWaitForSingleObject(Object, Executive, 0, 0, 0i64);
  v3 = v2;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_30148 + 11), 0x70u, (__int64)&unk_2EC38, v2);
  return v3;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001D7FC) ----------------------------------------------------
__int64 __fastcall sub_1D7FC(ULONG Count, PVOID Object[])
{
  struct _KWAIT_BLOCK *WaitBlockArray; // rdi
  unsigned int v6; // ebx

  WaitBlockArray = 0i64;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 11), 0x71u, (__int64)&unk_2EC38);
  if ( Count > 3 )
  {
    WaitBlockArray = (struct _KWAIT_BLOCK *)sub_1C35C(2, 48 * Count, 0x6E635742u);
    if ( !WaitBlockArray )
      return 4278190083i64;
  }
  v6 = KeWaitForMultipleObjects(Count, Object, WaitAny, Executive, 0, 0, 0i64, WaitBlockArray);
  if ( WaitBlockArray )
    sub_1C478(WaitBlockArray, 0x6E635742u);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 2) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1102C(*((_QWORD *)off_30148 + 11), 0x72u, (__int64)&unk_2EC38, v6);
  return v6;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001D908) ----------------------------------------------------
void __fastcall DeferredRoutine(_KDPC *Dpc, PVOID DeferredContext, PVOID SystemArgument1, PVOID SystemArgument2)
{
  if ( DeferredContext )
    ((void (__fastcall *)(_KDPC *, PVOID, PVOID, PVOID))DeferredContext)(
      Dpc,
      DeferredContext,
      SystemArgument1,
      SystemArgument2);
  KeSetTimer(&Timer, (LARGE_INTEGER)qword_33098, &::Dpc);
}
// 33098: using guessed type __int64 qword_33098;

//----- (000000000001D93C) ----------------------------------------------------
__int64 sub_1D93C()
{
  unsigned __int8 v0; // bl
  unsigned __int8 v2; // [rsp+48h] [rbp+10h]
  unsigned __int8 v3; // [rsp+50h] [rbp+18h]

  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0x12u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0xAu, (__int64)&unk_2EC18, 1);
  }
  v0 = KeGetCurrentIrql();
  __writecr8(2ui64);
  v3 = 0;
  KeStallExecutionProcessor(1u);
  v2 = 0;
  __writecr8(v0);
  qword_305B8 = v2 - (unsigned __int64)v3;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0x12u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_14B68(*((_QWORD *)off_30148 + 19), 0xBu, (__int64)&unk_2EC18, 1);
  }
  KeQueryPerformanceCounter(&PerformanceFrequency);
  byte_3044D = 1;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0x12u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0xCu, (__int64)&unk_2EC18, 0);
  }
  return 0i64;
}
// 30148: using guessed type void *off_30148;
// 3044D: using guessed type char byte_3044D;
// 305B8: using guessed type __int64 qword_305B8;

//----- (000000000001DA70) ----------------------------------------------------
__int64 __fastcall sub_1DA70(__int64 a1, __int64 a2, __int64 a3, int a4, __int64 a5, __int64 a6, int a7)
{
  int v8; // [rsp+98h] [rbp+20h] BYREF

  v8 = a4;
  a7 = 0;
  return qword_30398(a1, 43i64, &unk_2EC08, 125i64, &v8);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001DAE0) ----------------------------------------------------
__int64 __fastcall sub_1DAE0(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EC08, a2, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001DB3C) ----------------------------------------------------
__int64 __fastcall sub_1DB3C(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EC08, 115i64, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001DBAC) ----------------------------------------------------
__int64 __fastcall sub_1DBAC(__int64 a1, unsigned __int16 a2)
{
  int v3; // [rsp+88h] [rbp+20h] BYREF

  v3 = 33636359;
  return qword_30398(a1, 43i64, &unk_2EC08, a2, &v3);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001DC14) ----------------------------------------------------
__int64 __fastcall sub_1DC14(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EBF8, a2, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001DC74) ----------------------------------------------------
__int64 sub_1DC74(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_30398(a1, 43i64, a3, a2, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001DCC0) ----------------------------------------------------
__int64 __fastcall sub_1DCC0(__int64 a1, __int64 a2, _QWORD *a3)
{
  bool v5; // r12
  void **v6; // rcx
  unsigned __int16 v7; // dx
  unsigned int v8; // edi
  int v9; // er9
  unsigned int v10; // eax
  _WORD *v11; // rdx
  char *v12; // rax
  char *v13; // rbx
  PVOID v14; // rax
  unsigned int v15; // edx
  __int64 v16; // r8
  _QWORD *v17; // rax
  char *v18; // rcx
  unsigned int *v19; // rbx
  unsigned int v20; // eax
  void *v21; // rcx

  v5 = 0;
  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xAu, (__int64)&unk_2EC08);
    v6 = (void **)off_30148;
  }
  if ( !a1 )
  {
    if ( v6 == &off_30148 || !_bittest((const signed __int32 *)v6 + 43, 8u) || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_12;
    v7 = 11;
    goto LABEL_10;
  }
  v9 = *(_DWORD *)a1;
  if ( (*(_DWORD *)a1 & 0xFF000000) != 0x2000000 || (v9 & 0xFFFF00) == 0 || (_BYTE)v9 )
  {
    if ( v6 != &off_30148 && _bittest((const signed __int32 *)v6 + 43, 8u) && *((_BYTE *)v6 + 169) >= 2u )
    {
      sub_1102C((__int64)v6[19], 0xCu, (__int64)&unk_2EC08, v9);
      v6 = (void **)off_30148;
    }
    v8 = 4;
LABEL_57:
    if ( !v8 )
      goto LABEL_66;
    goto LABEL_58;
  }
  v10 = 0;
  v11 = (_WORD *)(a1 + 4);
  do
  {
    if ( !*v11 )
      break;
    ++v10;
    ++v11;
  }
  while ( v10 < 0x40 );
  if ( v10 >= 0x40 )
  {
    if ( v6 == &off_30148 || !_bittest((const signed __int32 *)v6 + 43, 8u) || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_12;
    v7 = 13;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_2EC08);
LABEL_11:
    v6 = (void **)off_30148;
LABEL_12:
    v8 = 4;
    goto LABEL_61;
  }
  if ( !a3 || !*a3 )
  {
    if ( v6 == &off_30148 || !_bittest((const signed __int32 *)v6 + 43, 8u) || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_12;
    sub_147C8((__int64)v6[19], 0xEu, (__int64)&unk_2EC08, a3);
    goto LABEL_11;
  }
  v12 = (char *)sub_1B038(2, 0x598u, 0x66634E4Eu);
  v13 = v12;
  qword_32BA8 = v12;
  if ( !v12 )
  {
    v6 = (void **)off_30148;
    if ( off_30148 != &off_30148 && _bittest((const signed __int32 *)off_30148 + 43, 8u) && *((_BYTE *)off_30148 + 169) )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0xFu, (__int64)&unk_2EC08, 1080);
      v6 = (void **)off_30148;
      v13 = (char *)qword_32BA8;
    }
    v8 = 3;
    goto LABEL_62;
  }
  memset(v12, 0, 0x598ui64);
  v5 = sub_25094((__int64)(v13 + 128));
  if ( v5 )
  {
    v14 = sub_1B038(1, 4 * (unsigned int)*(unsigned __int8 *)(a1 + 136), 0x66634E4Eu);
    v13 = (char *)qword_32BA8;
    *((_QWORD *)qword_32BA8 + 26) = v14;
    if ( !v14 )
    {
      v6 = (void **)off_30148;
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 43, 8u)
        && *((_BYTE *)off_30148 + 169) )
      {
        sub_1102C(*((_QWORD *)off_30148 + 19), 0x11u, (__int64)&unk_2EC08, 4 * *(unsigned __int8 *)(a1 + 136));
        v6 = (void **)off_30148;
        v13 = (char *)qword_32BA8;
      }
      v8 = 3;
      goto LABEL_59;
    }
    v15 = 0;
    if ( *(_BYTE *)(a1 + 136) )
    {
      v16 = 0i64;
      do
      {
        *(_DWORD *)(v16 + *((_QWORD *)v13 + 26)) = *(_DWORD *)a1 | ++v15;
        v16 += 4i64;
      }
      while ( v15 < *(unsigned __int8 *)(a1 + 136) );
    }
    *(_DWORD *)v13 = 2;
    *((_DWORD *)v13 + 1) = 1080;
    v13[8] = 0;
    *((_DWORD *)v13 + 4) = *(_DWORD *)a1;
    v13[20] = *(_BYTE *)(a1 + 136);
    *((_QWORD *)v13 + 3) = *((_QWORD *)v13 + 26);
    *((_QWORD *)v13 + 4) = sub_1ECA4;
    sub_1B70C((PERESOURCE)(v13 + 216));
    v17 = (char *)qword_32BA8 + 56;
    v18 = (char *)qword_32BA8 + 72;
    *((_QWORD *)qword_32BA8 + 8) = (char *)qword_32BA8 + 56;
    *v17 = v17;
    sub_1BD50((__int64)v18);
    v19 = (unsigned int *)qword_32BA8;
    memmove((char *)qword_32BA8 + 320, a3, 0x20ui64);
    v20 = sub_20778((__int16 *)(a1 + 4), *(_DWORD *)(a1 + 132), v19 + 4);
    v6 = (void **)off_30148;
    v8 = v20;
    goto LABEL_57;
  }
  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && _bittest((const signed __int32 *)off_30148 + 43, 8u) && *((_BYTE *)off_30148 + 169) )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x10u, (__int64)&unk_2EC08);
    v6 = (void **)off_30148;
  }
  v8 = 9;
LABEL_58:
  v13 = (char *)qword_32BA8;
LABEL_59:
  if ( !v5 )
    goto LABEL_62;
  sub_25138((__int64)(v13 + 128));
  v6 = (void **)off_30148;
LABEL_61:
  v13 = (char *)qword_32BA8;
LABEL_62:
  if ( v13 )
  {
    v21 = (void *)*((_QWORD *)v13 + 26);
    if ( v21 )
    {
      sub_1B0BC(v21, 0x66634E4Eu);
      v13 = (char *)qword_32BA8;
    }
    sub_1B0BC(v13, 0x66634E4Eu);
    v6 = (void **)off_30148;
    qword_32BA8 = 0i64;
  }
LABEL_66:
  if ( v6 != &off_30148 && _bittest((const signed __int32 *)v6 + 43, 8u) && *((_BYTE *)v6 + 169) >= 5u )
    sub_1102C((__int64)v6[19], 0x12u, (__int64)&unk_2EC08, v8);
  return v8;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001E190) ----------------------------------------------------
__int64 sub_1E190()
{
  char v0; // di
  void **v1; // rcx
  PVOID v2; // rdx
  unsigned int v3; // ebx
  void *v4; // rcx
  int v5; // eax
  _QWORD *v6; // rax
  unsigned int v7; // eax
  int v8; // eax

  v0 = 0;
  v1 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x13u, (__int64)&unk_2EC08);
    v1 = (void **)off_30148;
  }
  v2 = qword_32BA8;
  if ( !qword_32BA8 )
  {
    if ( v1 != &off_30148 && _bittest((const signed __int32 *)v1 + 43, 8u) && *((_BYTE *)v1 + 169) >= 2u )
    {
      sub_11008((__int64)v1[19], 0x14u, (__int64)&unk_2EC08);
      v1 = (void **)off_30148;
    }
    v3 = 16;
    goto LABEL_59;
  }
  if ( *((_QWORD *)qword_32BA8 + 5) )
  {
    if ( v1 != &off_30148 && _bittest((const signed __int32 *)v1 + 43, 8u) && *((_BYTE *)v1 + 169) >= 2u )
    {
      sub_11008((__int64)v1[19], 0x15u, (__int64)&unk_2EC08);
      v1 = (void **)off_30148;
    }
    v3 = 6;
    goto LABEL_59;
  }
  v4 = (void *)*((_QWORD *)qword_32BA8 + 26);
  if ( v4 )
  {
    sub_1B0BC(v4, 0x66634E4Eu);
    v2 = qword_32BA8;
    *((_QWORD *)qword_32BA8 + 26) = 0i64;
  }
  v5 = sub_2136C(6u, (__int64)v2 + 40);
  v3 = v5;
  if ( v5 )
  {
    v1 = (void **)off_30148;
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 8u)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x16u, (__int64)&unk_2EC08, v5);
      v1 = (void **)off_30148;
    }
    goto LABEL_55;
  }
  v6 = (_QWORD *)*((_QWORD *)qword_32BA8 + 5);
  if ( !v6 || !*v6 || !v6[1] || !v6[2] || !v6[3] || !v6[4] || !v6[5] || !v6[6] || !v6[7] || !v6[8] || !v6[9] || !v6[10] )
  {
    v3 = 2;
    goto LABEL_58;
  }
  v7 = ((__int64 (__fastcall *)(_QWORD, char *))*v6)(*((unsigned int *)qword_32BA8 + 4), (char *)qword_32BA8 + 48);
  if ( v7 < 0x700 )
  {
    v0 = sub_251B0((PFAST_MUTEX)((char *)qword_32BA8 + 128));
    if ( !v0 )
    {
      v1 = (void **)off_30148;
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 43, 8u)
        && *((_BYTE *)off_30148 + 169) >= 2u )
      {
        sub_11008(*((_QWORD *)off_30148 + 19), 0x18u, (__int64)&unk_2EC08);
        v1 = (void **)off_30148;
      }
      v3 = 9;
LABEL_56:
      if ( !v0 )
        goto LABEL_59;
      sub_25210((PFAST_MUTEX)((char *)qword_32BA8 + 128));
LABEL_58:
      v1 = (void **)off_30148;
      goto LABEL_59;
    }
    v8 = sub_1F25C();
    v3 = v8;
    if ( !v8 )
      goto LABEL_58;
    v1 = (void **)off_30148;
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 8u)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x19u, (__int64)&unk_2EC08, v8);
      v1 = (void **)off_30148;
    }
    v3 = 0;
LABEL_55:
    if ( !v3 )
      goto LABEL_59;
    goto LABEL_56;
  }
  v1 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 2u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x17u, (__int64)&unk_2EC08, v7);
    v1 = (void **)off_30148;
  }
  v3 = 8;
LABEL_59:
  if ( v1 != &off_30148 && _bittest((const signed __int32 *)v1 + 43, 8u) && *((_BYTE *)v1 + 169) >= 5u )
    sub_1102C((__int64)v1[19], 0x1Au, (__int64)&unk_2EC08, v3);
  return v3;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001E4D8) ----------------------------------------------------
__int64 (**sub_1E4D8())(void)
{
  void **v0; // rcx
  __int64 (**result)(void); // rax
  unsigned __int16 v2; // dx

  v0 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x1Bu, (__int64)&unk_2EC08);
    v0 = (void **)off_30148;
  }
  result = (__int64 (**)(void))qword_32BA8;
  if ( qword_32BA8 )
  {
    sub_25210((PFAST_MUTEX)((char *)qword_32BA8 + 128));
    result = (__int64 (**)(void))*((_QWORD *)qword_32BA8 + 5);
    if ( result && *((_QWORD *)qword_32BA8 + 6) )
    {
      result = (__int64 (**)(void))result[1]();
      *((_QWORD *)qword_32BA8 + 6) = 0i64;
    }
    v0 = (void **)off_30148;
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 8u)
      && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      v2 = 30;
      return (__int64 (**)(void))sub_11008((__int64)v0[19], v2, (__int64)&unk_2EC08);
    }
  }
  else if ( v0 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)v0 + 43, 8u) && *((_BYTE *)v0 + 169) >= 2u )
    {
      result = (__int64 (**)(void))sub_11008((__int64)v0[19], (unsigned __int16)qword_32BA8 + 28, (__int64)&unk_2EC08);
      v0 = (void **)off_30148;
    }
    if ( v0 != &off_30148 && _bittest((const signed __int32 *)v0 + 43, 8u) && *((_BYTE *)v0 + 169) >= 5u )
    {
      v2 = 29;
      return (__int64 (**)(void))sub_11008((__int64)v0[19], v2, (__int64)&unk_2EC08);
    }
  }
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001E604) ----------------------------------------------------
__int64 __fastcall sub_1E604(unsigned int a1)
{
  void **v2; // r10
  unsigned __int16 v3; // dx
  unsigned __int8 (__fastcall *v5)(_QWORD, unsigned int *, size_t *, char *); // r11
  __int64 v6; // rcx
  unsigned __int16 v7; // dx
  char *v8; // rbx
  char v9[40]; // [rsp+30h] [rbp-28h] BYREF
  unsigned int Dst; // [rsp+68h] [rbp+10h] BYREF
  size_t MaxCount; // [rsp+70h] [rbp+18h] BYREF
  unsigned int v12; // [rsp+78h] [rbp+20h] BYREF

  Dst = 0;
  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x2Cu, (__int64)&unk_2EC08, a1);
    v2 = (void **)off_30148;
  }
  if ( !qword_32BA8 )
  {
    if ( v2 == &off_30148 || !_bittest((const signed __int32 *)v2 + 43, 8u) || *((_BYTE *)v2 + 169) < 2u )
      return 0i64;
    v3 = (_WORD)qword_32BA8 + 45;
    goto LABEL_10;
  }
  v5 = (unsigned __int8 (__fastcall *)(_QWORD, unsigned int *, size_t *, char *))*((_QWORD *)qword_32BA8 + 40);
  if ( !v5 )
  {
    if ( v2 == &off_30148 || !_bittest((const signed __int32 *)v2 + 43, 8u) || *((_BYTE *)v2 + 169) < 2u )
      return 0i64;
    v3 = 46;
LABEL_10:
    sub_11008((__int64)v2[19], v3, (__int64)&unk_2EC08);
    return 0i64;
  }
  if ( (unsigned __int8)(a1 - 1) >= (unsigned int)*((unsigned __int8 *)qword_32BA8 + 20) )
  {
    if ( v2 == &off_30148 || !_bittest((const signed __int32 *)v2 + 43, 8u) || *((_BYTE *)v2 + 169) < 2u )
      return 0i64;
    v6 = (__int64)v2[19];
    v7 = 47;
    goto LABEL_22;
  }
  if ( !v5(a1, &v12, &MaxCount, v9) )
  {
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 8u)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_139F8(*((_QWORD *)off_30148 + 19), 0x30u, (__int64)&unk_2EC08, a1);
    }
    return 0i64;
  }
  if ( (unsigned int)MaxCount > 4 )
  {
    if ( off_30148 == &off_30148
      || !_bittest((const signed __int32 *)off_30148 + 43, 8u)
      || *((_BYTE *)off_30148 + 169) < 2u )
    {
      return 0i64;
    }
    v6 = *((_QWORD *)off_30148 + 19);
    v7 = 49;
LABEL_22:
    sub_1DAE0(v6, v7, (__int64)&unk_2EC08, a1);
    return 0i64;
  }
  KeEnterCriticalRegion();
  sub_1B98C((PERESOURCE)((char *)qword_32BA8 + 216));
  v8 = (char *)qword_32BA8;
  memmove(&Dst, (char *)qword_32BA8 + v12 + 352, (unsigned int)MaxCount);
  sub_1BA64((PERESOURCE)(v8 + 216));
  KeLeaveCriticalRegion();
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x32u, (__int64)&unk_2EC08, Dst);
  }
  return Dst;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001E870) ----------------------------------------------------
__int64 sub_1E870()
{
  void **v0; // rcx
  unsigned __int16 v1; // dx
  unsigned __int8 (__fastcall *v3)(__int64, unsigned int *, size_t *, char *); // r10
  unsigned __int16 v4; // dx
  char *v5; // rbx
  __int64 Dst[5]; // [rsp+30h] [rbp-28h] BYREF
  size_t MaxCount; // [rsp+68h] [rbp+10h] BYREF
  unsigned int v8; // [rsp+70h] [rbp+18h] BYREF
  char v9; // [rsp+78h] [rbp+20h] BYREF

  Dst[0] = 0i64;
  v0 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x33u, (__int64)&unk_2EC08, 33636359);
    v0 = (void **)off_30148;
  }
  if ( !qword_32BA8 )
  {
    if ( v0 == &off_30148 || !_bittest((const signed __int32 *)v0 + 43, 8u) || *((_BYTE *)v0 + 169) < 2u )
      return 0i64;
    v1 = 52;
    goto LABEL_10;
  }
  v3 = (unsigned __int8 (__fastcall *)(__int64, unsigned int *, size_t *, char *))*((_QWORD *)qword_32BA8 + 40);
  if ( !v3 )
  {
    if ( v0 == &off_30148 || !_bittest((const signed __int32 *)v0 + 43, 8u) || *((_BYTE *)v0 + 169) < 2u )
      return 0i64;
    v1 = 53;
LABEL_10:
    sub_11008((__int64)v0[19], v1, (__int64)&unk_2EC08);
    return 0i64;
  }
  if ( *((_BYTE *)qword_32BA8 + 20) <= 6u )
  {
    if ( v0 == &off_30148 || !_bittest((const signed __int32 *)v0 + 43, 8u) || *((_BYTE *)v0 + 169) < 2u )
      return 0i64;
    v4 = 54;
    goto LABEL_22;
  }
  if ( !v3(33636359i64, &v8, &MaxCount, &v9) )
  {
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 8u)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_14B68(*((_QWORD *)off_30148 + 19), 0x37u, (__int64)&unk_2EC08, 33636359);
    }
    return 0i64;
  }
  if ( (unsigned int)MaxCount > 8 )
  {
    v0 = (void **)off_30148;
    if ( off_30148 == &off_30148
      || !_bittest((const signed __int32 *)off_30148 + 43, 8u)
      || *((_BYTE *)off_30148 + 169) < 2u )
    {
      return 0i64;
    }
    v4 = 56;
LABEL_22:
    sub_1DBAC((__int64)v0[19], v4);
    return 0i64;
  }
  KeEnterCriticalRegion();
  sub_1B98C((PERESOURCE)((char *)qword_32BA8 + 216));
  v5 = (char *)qword_32BA8;
  memmove(Dst, (char *)qword_32BA8 + v8 + 352, (unsigned int)MaxCount);
  sub_1BA64((PERESOURCE)(v5 + 216));
  KeLeaveCriticalRegion();
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_147C8(*((_QWORD *)off_30148 + 19), 0x39u, (__int64)&unk_2EC08, Dst[0], 0);
  }
  return Dst[0];
}
// 30148: using guessed type void *off_30148;

//----- (000000000001EAD4) ----------------------------------------------------
char *sub_1EAD4()
{
  char *v0; // rbx
  void **v1; // rcx
  unsigned int v3; // [rsp+58h] [rbp+10h] BYREF
  char v4; // [rsp+60h] [rbp+18h] BYREF
  char v5; // [rsp+68h] [rbp+20h] BYREF

  v0 = 0i64;
  v1 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x53u, (__int64)&unk_2EC08, 33636367);
    v1 = (void **)off_30148;
  }
  if ( qword_32BA8 )
  {
    if ( *((_BYTE *)qword_32BA8 + 20) > 0xEu )
    {
      if ( (*((unsigned __int8 (__fastcall **)(__int64, unsigned int *, char *, char *))qword_32BA8 + 40))(
             33636367i64,
             &v3,
             &v5,
             &v4) )
      {
        KeEnterCriticalRegion();
        sub_1B98C((PERESOURCE)((char *)qword_32BA8 + 216));
        v0 = (char *)qword_32BA8 + v3 + 352;
      }
      else
      {
        v1 = (void **)off_30148;
        if ( off_30148 == &off_30148 )
          return v0;
        if ( !_bittest((const signed __int32 *)off_30148 + 43, 8u) || *((_BYTE *)off_30148 + 169) < 2u )
          goto LABEL_22;
        sub_1102C(*((_QWORD *)off_30148 + 19), 0x56u, (__int64)&unk_2EC08, 33636367);
      }
    }
    else
    {
      if ( v1 == &off_30148 )
        return v0;
      if ( !_bittest((const signed __int32 *)v1 + 43, 8u) || *((_BYTE *)v1 + 169) < 2u )
        goto LABEL_22;
      sub_139F8((__int64)v1[19], 0x55u, (__int64)&unk_2EC08, 33636367);
    }
    goto LABEL_21;
  }
  if ( v1 == &off_30148 )
    return v0;
  if ( _bittest((const signed __int32 *)v1 + 43, 8u) && *((_BYTE *)v1 + 169) >= 2u )
  {
    sub_11008((__int64)v1[19], 0x54u, (__int64)&unk_2EC08);
LABEL_21:
    v1 = (void **)off_30148;
  }
LABEL_22:
  if ( v1 != &off_30148 && _bittest((const signed __int32 *)v1 + 43, 8u) && *((_BYTE *)v1 + 169) >= 5u )
    sub_147C8((__int64)v1[19], 0x57u, (__int64)&unk_2EC08, v0);
  return v0;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001ECA4) ----------------------------------------------------
__int64 __fastcall sub_1ECA4(__int64 a1)
{
  char *v1; // r8
  unsigned int v2; // ebx
  __int64 (__fastcall **v4)(_QWORD, _QWORD); // r13
  __int64 v5; // r14
  int v6; // ebp
  void **v7; // rcx
  _DWORD *v8; // rdi
  unsigned __int16 v10; // dx
  unsigned __int16 v11; // dx
  int v12; // edx
  int *v13; // rdi
  int *v14; // rbp
  int v15; // edi
  int *v16; // rbp
  int v17; // edi

  v1 = (char *)qword_32BA8;
  v2 = 0;
  v4 = (__int64 (__fastcall **)(_QWORD, _QWORD))*((_QWORD *)qword_32BA8 + 5);
  v5 = *((_QWORD *)qword_32BA8 + 6);
  v6 = 0;
  v7 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x5Bu, (__int64)&unk_2EC08);
    v1 = (char *)qword_32BA8;
    v7 = (void **)off_30148;
  }
  if ( !a1 )
    goto LABEL_6;
  v8 = *(_DWORD **)(a1 + 56);
  if ( !v8 )
    goto LABEL_6;
  switch ( *v8 )
  {
    case 0:
      v16 = v8 + 1;
      if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 4u )
      {
        sub_11008((__int64)v7[19], 0x5Cu, (__int64)&unk_2EC08);
        v1 = (char *)qword_32BA8;
        v7 = (void **)off_30148;
      }
      if ( v8 != (_DWORD *)-4i64 )
      {
        if ( !sub_252B8((PFAST_MUTEX)(v1 + 128)) )
          goto LABEL_26;
        v2 = sub_202E4(*v16);
        if ( v2 )
          goto LABEL_65;
        v17 = v4[9](v5, (unsigned int)*v16);
        if ( off_30148 != &off_30148
          && _bittest((const signed __int32 *)off_30148 + 43, 8u)
          && *((_BYTE *)off_30148 + 169) >= 4u )
        {
          sub_139F8(*((_QWORD *)off_30148 + 19), v2 + 93, (__int64)&unk_2EC08, *v16);
        }
        sub_25320((PFAST_MUTEX)((char *)qword_32BA8 + 128));
        if ( !v17 )
          goto LABEL_26;
        v2 = 8;
        v7 = (void **)off_30148;
        if ( off_30148 != &off_30148 )
        {
          if ( _bittest((const signed __int32 *)off_30148 + 43, 8u) && *((_BYTE *)off_30148 + 169) >= 2u )
          {
            v10 = 94;
            goto LABEL_91;
          }
          goto LABEL_93;
        }
        goto LABEL_53;
      }
LABEL_6:
      v2 = 2;
      goto LABEL_93;
    case 1:
      v14 = v8 + 1;
      if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 4u )
      {
        sub_11008((__int64)v7[19], 0x5Fu, (__int64)&unk_2EC08);
        v1 = (char *)qword_32BA8;
        v7 = (void **)off_30148;
      }
      if ( v8 != (_DWORD *)-4i64 )
      {
        if ( !sub_252B8((PFAST_MUTEX)(v1 + 128)) )
          goto LABEL_26;
        v2 = sub_20440(*v14);
        if ( v2 )
        {
LABEL_65:
          sub_25320((PFAST_MUTEX)((char *)qword_32BA8 + 128));
LABEL_92:
          v7 = (void **)off_30148;
          goto LABEL_93;
        }
        v15 = v4[10](v5, (unsigned int)*v14);
        if ( off_30148 != &off_30148
          && _bittest((const signed __int32 *)off_30148 + 43, 8u)
          && *((_BYTE *)off_30148 + 169) >= 4u )
        {
          sub_139F8(*((_QWORD *)off_30148 + 19), 0x60u, (__int64)&unk_2EC08, *v14);
        }
        sub_25320((PFAST_MUTEX)((char *)qword_32BA8 + 128));
        if ( !v15 )
          goto LABEL_26;
        v2 = 8;
        v7 = (void **)off_30148;
        if ( off_30148 != &off_30148 )
        {
          if ( _bittest((const signed __int32 *)off_30148 + 43, 8u) && *((_BYTE *)off_30148 + 169) >= 2u )
          {
            v10 = 97;
            goto LABEL_91;
          }
LABEL_93:
          if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 2u )
            sub_11008((__int64)v7[19], 0x68u, (__int64)&unk_2EC08);
          if ( v2 )
            goto LABEL_53;
          goto LABEL_98;
        }
LABEL_53:
        v12 = v2;
        goto LABEL_27;
      }
      goto LABEL_6;
    case 2:
      if ( sub_252B8((PFAST_MUTEX)(v1 + 128)) )
      {
        v2 = sub_1F928(v8[1], v8[2], v8[3], v8 + 4);
        sub_25320((PFAST_MUTEX)((char *)qword_32BA8 + 128));
      }
      goto LABEL_53;
    case 3:
      if ( sub_252B8((PFAST_MUTEX)(v1 + 128)) )
      {
        v2 = sub_1FF20((unsigned int)v8[1], v8[2], a1);
        sub_25320((PFAST_MUTEX)((char *)qword_32BA8 + 128));
      }
      goto LABEL_28;
    case 4:
      v13 = v8 + 1;
      if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 4u )
      {
        sub_11008((__int64)v7[19], 0x62u, (__int64)&unk_2EC08);
        v1 = (char *)qword_32BA8;
      }
      if ( sub_252B8((PFAST_MUTEX)(v1 + 128)) )
      {
        if ( v13 )
        {
          v6 = v4[8](v5, (unsigned int)*v13);
          if ( off_30148 != &off_30148
            && _bittest((const signed __int32 *)off_30148 + 43, 8u)
            && *((_BYTE *)off_30148 + 169) >= 4u )
          {
            sub_139F8(*((_QWORD *)off_30148 + 19), 0x63u, (__int64)&unk_2EC08, *v13);
          }
        }
        sub_25320((PFAST_MUTEX)((char *)qword_32BA8 + 128));
        if ( !v13 || v6 )
        {
          v2 = 8;
          if ( off_30148 != &off_30148
            && _bittest((const signed __int32 *)off_30148 + 43, 8u)
            && *((_BYTE *)off_30148 + 169) >= 2u )
          {
            sub_11008(*((_QWORD *)off_30148 + 19), 0x64u, (__int64)&unk_2EC08);
          }
        }
      }
      goto LABEL_53;
    case 5:
      if ( v7 == &off_30148 || !_bittest((const signed __int32 *)v7 + 43, 8u) || *((_BYTE *)v7 + 169) < 4u )
        goto LABEL_26;
      v11 = 101;
      goto LABEL_25;
  }
  if ( *v8 != 6 )
  {
    if ( *((_QWORD *)v1 + 43) )
      return (*((__int64 (__fastcall **)(__int64, _QWORD, char *, void *))v1 + 43))(
               a1,
               (unsigned int)(*v8 - 5),
               v1,
               &unk_2EC08);
    if ( v7 == &off_30148 )
    {
LABEL_98:
      v2 = 17;
      goto LABEL_53;
    }
    if ( _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 3u )
    {
      v10 = 103;
LABEL_91:
      sub_11008((__int64)v7[19], v10, (__int64)&unk_2EC08);
      goto LABEL_92;
    }
    goto LABEL_93;
  }
  if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 4u )
  {
    v11 = 102;
LABEL_25:
    sub_11008((__int64)v7[19], v11, (__int64)&unk_2EC08);
  }
LABEL_26:
  v12 = 0;
LABEL_27:
  sub_23790(a1, v12, 0, 0i64);
LABEL_28:
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x69u, (__int64)&unk_2EC08, v2);
  }
  return v2;
}
// 30148: using guessed type void *off_30148;

//----- (000000000001F25C) ----------------------------------------------------
__int64 sub_1F25C()
{
  __int64 v0; // rsi
  __int64 v1; // r15
  unsigned int v2; // er13
  int v3; // eax
  void *v4; // rbp
  void **v5; // r14
  unsigned int v6; // er12
  void (__fastcall *v7)(char *); // rax
  int v8; // eax
  void **v9; // r10
  _DWORD *v10; // r11
  unsigned int i; // er9
  void (__fastcall *v12)(int *); // rax
  PVOID v13; // r11
  int v14; // esi
  unsigned int v15; // eax
  unsigned int v16; // esi
  PVOID v17; // rax
  char *v18; // rbx
  int v19; // eax
  int v20; // ebx
  unsigned int v21; // eax
  unsigned int v22; // ebx
  int v23; // eax
  char *v24; // rsi
  size_t v25; // r8
  void (__fastcall *v26)(int *); // rax
  __int64 v28; // [rsp+20h] [rbp-A8h]
  __int64 v29; // [rsp+28h] [rbp-A0h]
  __int64 v30; // [rsp+30h] [rbp-98h]
  int v31; // [rsp+38h] [rbp-90h]
  char v32[8]; // [rsp+40h] [rbp-88h] BYREF
  void *Src; // [rsp+48h] [rbp-80h] BYREF
  __int64 v34; // [rsp+50h] [rbp-78h]
  int v35[28]; // [rsp+58h] [rbp-70h] BYREF
  _BYTE v36[28]; // [rsp+5Ch] [rbp-6Ch] BYREF
  char v37; // [rsp+D0h] [rbp+8h] BYREF
  size_t MaxCount; // [rsp+D8h] [rbp+10h] BYREF
  unsigned int v39; // [rsp+E0h] [rbp+18h] BYREF
  size_t v40; // [rsp+E8h] [rbp+20h] BYREF

  v0 = *((_QWORD *)qword_32BA8 + 6);
  v1 = *((_QWORD *)qword_32BA8 + 5);
  v34 = v0;
  v2 = 0;
  v37 = 0;
  v35[0] = 0;
  memset(v36, 0, sizeof(v36));
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x6Au, (__int64)&unk_2EC08);
  }
  v3 = (*(__int64 (__fastcall **)(__int64, _QWORD, char *))(v1 + 40))(v0, 0i64, &v37);
  if ( !v3 )
  {
    v13 = qword_32BA8;
    v20 = *((_DWORD *)qword_32BA8 + 4);
    v21 = v20 | *((char *)qword_32BA8 + 20);
    v22 = v20 | 1;
    if ( v22 > v21 )
    {
LABEL_73:
      v9 = (void **)off_30148;
      goto LABEL_74;
    }
    while ( 1 )
    {
      Src = 0i64;
      LODWORD(MaxCount) = 0;
      if ( (*((unsigned __int8 (__fastcall **)(_QWORD, unsigned int *, size_t *, char *, _DWORD))v13 + 40))(
             v22,
             &v39,
             &v40,
             v32,
             v28) )
      {
        v23 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, void **, size_t *))(v1 + 16))(
                v0,
                0i64,
                v22,
                &Src,
                &MaxCount);
        if ( v23 || !Src )
        {
          v9 = (void **)off_30148;
          if ( off_30148 != &off_30148
            && _bittest((const signed __int32 *)off_30148 + 43, 8u)
            && *((_BYTE *)off_30148 + 169) >= 2u )
          {
            LODWORD(v28) = v22;
            sub_139F8(*((_QWORD *)off_30148 + 19), 0x70u, (__int64)&unk_2EC08, v23);
            v9 = (void **)off_30148;
          }
          v2 = 8;
          goto LABEL_66;
        }
        if ( off_30148 != &off_30148
          && _bittest((const signed __int32 *)off_30148 + 43, 8u)
          && *((_BYTE *)off_30148 + 169) >= 4u )
        {
          sub_1102C(*((_QWORD *)off_30148 + 19), 0x71u, (__int64)&unk_2EC08, v22);
        }
        KeEnterCriticalRegion();
        LODWORD(v28) = 0;
        sub_1B8B4((PERESOURCE)((char *)qword_32BA8 + 216));
        v24 = (char *)qword_32BA8;
        v25 = (unsigned int)MaxCount;
        if ( (unsigned int)MaxCount >= (unsigned int)v40 )
          v25 = (unsigned int)v40;
        memmove((char *)qword_32BA8 + v39 + 352, Src, v25);
        sub_1BA64((PERESOURCE)(v24 + 216));
        KeLeaveCriticalRegion();
        v0 = v34;
        (*(void (__fastcall **)(__int64, void *))(v1 + 32))(v34, Src);
        v35[(unsigned __int8)(v22 - 1) >> 5] |= 1 << ((v22 - 1) & 0x1F);
      }
      v9 = (void **)off_30148;
LABEL_66:
      v13 = qword_32BA8;
      if ( ++v22 > (*((_DWORD *)qword_32BA8 + 4) | (unsigned int)*((char *)qword_32BA8 + 20)) )
        goto LABEL_74;
    }
  }
  v4 = 0i64;
  v5 = 0i64;
  v6 = 0;
  if ( v3 == 1879048199 || v3 == 1879048193 )
  {
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 8u)
      && *((_BYTE *)off_30148 + 169) >= 3u )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x6Bu, (__int64)&unk_2EC08, 0);
    }
  }
  else if ( off_30148 != &off_30148
         && _bittest((const signed __int32 *)off_30148 + 43, 8u)
         && *((_BYTE *)off_30148 + 169) >= 3u )
  {
    LODWORD(v28) = 0;
    sub_139F8(*((_QWORD *)off_30148 + 19), 0x6Cu, (__int64)&unk_2EC08, v3);
  }
  v7 = (void (__fastcall *)(char *))*((_QWORD *)qword_32BA8 + 41);
  if ( v7 )
    v7((char *)qword_32BA8 + 352);
  v8 = (*(__int64 (__fastcall **)(__int64, _QWORD))(v1 + 64))(v0, 0i64);
  if ( v8 )
  {
    v9 = (void **)off_30148;
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 8u)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x6Du, (__int64)&unk_2EC08, v8);
      v9 = (void **)off_30148;
    }
    v10 = qword_32BA8;
    for ( i = *((_DWORD *)qword_32BA8 + 4) | 1; i <= (v10[4] | (unsigned int)*((char *)v10 + 20)); ++i )
      v35[(unsigned __int8)(i - 1) >> 5] |= 1 << ((i - 1) & 0x1F);
    v12 = (void (__fastcall *)(int *))*((_QWORD *)v10 + 42);
    if ( v12 )
    {
      v12(v35);
      v9 = (void **)off_30148;
    }
    v2 = 8;
    goto LABEL_76;
  }
  v9 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 4u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x6Eu, (__int64)&unk_2EC08, 0);
    v9 = (void **)off_30148;
  }
  v13 = qword_32BA8;
  v14 = *((_DWORD *)qword_32BA8 + 4);
  v15 = v14 | *((char *)qword_32BA8 + 20);
  v16 = v14 | 1;
  if ( v16 > v15 )
    goto LABEL_74;
  do
  {
    if ( !(*((unsigned __int8 (__fastcall **)(_QWORD, unsigned int *, size_t *, size_t *, __int64, __int64))v13 + 40))(
            v16,
            &v39,
            &MaxCount,
            &v40,
            v28,
            v29) )
      goto LABEL_44;
    if ( (unsigned int)MaxCount > v6 )
    {
      if ( (unsigned int)MaxCount > 8 )
      {
        if ( v4 )
        {
          v31 = 0;
          v30 = 0i64;
          v29 = 0i64;
          LODWORD(v28) = 1886221390;
          v17 = sub_1B130(1i64, v4, v6, MaxCount);
        }
        else
        {
          LODWORD(v29) = 0;
          v28 = 0i64;
          v17 = sub_1B038(1, MaxCount, 0x706D744Eu);
        }
        v4 = v17;
        v5 = (void **)v17;
        v6 = v17 != 0i64 ? MaxCount : 0;
      }
      else
      {
        v5 = &Src;
        v6 = 8;
      }
    }
    v35[(unsigned __int8)(v16 - 1) >> 5] |= 1 << ((v16 - 1) & 0x1F);
    if ( !v5 )
    {
      v2 = 3;
LABEL_44:
      v9 = (void **)off_30148;
      goto LABEL_45;
    }
    KeEnterCriticalRegion();
    sub_1B98C((PERESOURCE)((char *)qword_32BA8 + 216));
    v18 = (char *)qword_32BA8;
    memmove(v5, (char *)qword_32BA8 + v39 + 352, (unsigned int)MaxCount);
    sub_1BA64((PERESOURCE)(v18 + 216));
    KeLeaveCriticalRegion();
    LODWORD(v29) = MaxCount;
    v19 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, void **, __int64, __int64, int))(v1 + 24))(
            v34,
            0i64,
            0i64,
            v16,
            v5,
            v29,
            v30,
            v31);
    if ( !v19 )
      goto LABEL_44;
    v9 = (void **)off_30148;
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 8u)
      && *((_BYTE *)off_30148 + 169) >= 4u )
    {
      LODWORD(v28) = v16;
      sub_139F8(*((_QWORD *)off_30148 + 19), 0x6Fu, (__int64)&unk_2EC08, v19);
      v9 = (void **)off_30148;
    }
    v2 = 8;
LABEL_45:
    v13 = qword_32BA8;
    ++v16;
  }
  while ( v16 <= (*((_DWORD *)qword_32BA8 + 4) | (unsigned int)*((char *)qword_32BA8 + 20)) );
  if ( v4 )
  {
    sub_1B0BC(v4, 0x706D744Eu);
    v13 = qword_32BA8;
    goto LABEL_73;
  }
LABEL_74:
  v26 = (void (__fastcall *)(int *))*((_QWORD *)v13 + 42);
  if ( v26 )
  {
    v26(v35);
    v9 = (void **)off_30148;
  }
LABEL_76:
  if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 43, 8u) && *((_BYTE *)v9 + 169) >= 5u )
    sub_1102C((__int64)v9[19], 0x72u, (__int64)&unk_2EC08, v2);
  return v2;
}
// 1F4E2: variable 'v28' is possibly undefined
// 1F4E2: variable 'v29' is possibly undefined
// 1F65F: variable 'v30' is possibly undefined
// 1F65F: variable 'v31' is possibly undefined
// 30148: using guessed type void *off_30148;
// 1F25C: using guessed type int var_70[28];

//----- (000000000001F928) ----------------------------------------------------
__int64 __fastcall sub_1F928(unsigned int a1, int a2, unsigned int a3, _DWORD *a4)
{
  _QWORD *v4; // rsi
  __int64 v6; // rax
  __int64 v7; // r15
  _QWORD *v9; // r14
  unsigned int v10; // ebx
  void **v13; // rcx
  _QWORD *i; // rax
  char *v16; // rsi
  size_t v17; // r8
  char *v18; // rcx
  _QWORD *v19; // rax
  void (__fastcall *v20)(int *); // rdx
  int v21; // eax
  _QWORD *v22; // rcx
  unsigned __int16 v23; // dx
  __int64 v24; // r9
  _QWORD *v25; // rcx
  unsigned __int16 v26; // dx
  unsigned __int64 v27; // r11
  __int64 v28; // rcx
  int v29; // eax
  int v30; // [rsp+20h] [rbp-78h]
  __int64 v31; // [rsp+20h] [rbp-78h]
  unsigned int v32; // [rsp+28h] [rbp-70h]
  __int64 v33; // [rsp+28h] [rbp-70h]
  _DWORD *v34; // [rsp+30h] [rbp-68h]
  unsigned int v35; // [rsp+40h] [rbp-58h] BYREF
  int v36; // [rsp+44h] [rbp-54h] BYREF
  __int64 v37; // [rsp+48h] [rbp-50h]
  int v38[8]; // [rsp+50h] [rbp-48h] BYREF
  _BYTE v39[28]; // [rsp+54h] [rbp-44h] BYREF
  size_t MaxCount; // [rsp+A0h] [rbp+8h] BYREF

  v4 = qword_32BA8;
  v6 = *((_QWORD *)qword_32BA8 + 6);
  v7 = *((_QWORD *)qword_32BA8 + 5);
  v9 = 0i64;
  v10 = 0;
  v35 = 0;
  LODWORD(MaxCount) = 0;
  v38[0] = 0;
  v37 = v6;
  memset(v39, 0, sizeof(v39));
  v13 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)off_30148 + 43, 8u) && *((_BYTE *)off_30148 + 169) >= 4u )
    {
      v34 = a4;
      v32 = a3;
      v30 = a2;
      sub_1DB3C(*((_QWORD *)off_30148 + 19), 115i64, (__int64)&unk_2EC08, a1);
      v4 = qword_32BA8;
      v13 = (void **)off_30148;
    }
    if ( v13 != &off_30148 && _bittest((const signed __int32 *)v13 + 43, 8u) && *((_BYTE *)v13 + 169) >= 4u )
    {
      sub_11008((__int64)v13[19], 0x74u, (__int64)&unk_2EC08);
      v4 = qword_32BA8;
      v13 = (void **)off_30148;
    }
  }
  if ( a1 )
  {
    for ( i = (_QWORD *)v4[7]; i != v4 + 7; i = (_QWORD *)*i )
    {
      v9 = i - 5;
      if ( *((_DWORD *)i - 10) == a1 )
        goto LABEL_15;
    }
    v9 = 0i64;
LABEL_15:
    if ( !v9 )
    {
      if ( v13 != &off_30148 && _bittest((const signed __int32 *)v13 + 43, 8u) && *((_BYTE *)v13 + 169) >= 2u )
        sub_1102C((__int64)v13[19], 0x75u, (__int64)&unk_2EC08, a1);
      return 4i64;
    }
  }
  if ( !((unsigned __int8 (__fastcall *)(_QWORD, unsigned int *, size_t *, int *, int, unsigned int))v4[40])(
          a3,
          &v35,
          &MaxCount,
          &v36,
          v30,
          v32) )
  {
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 8u)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x76u, (__int64)&unk_2EC08, a3);
    }
    return 4i64;
  }
  if ( a1 )
  {
    v16 = (char *)v9 + v35 + 56;
    sub_1BE30((PFAST_MUTEX)((char *)qword_32BA8 + 72));
  }
  else
  {
    v16 = (char *)qword_32BA8 + v35 + 352;
    KeEnterCriticalRegion();
    sub_1B8B4((PERESOURCE)((char *)qword_32BA8 + 216));
  }
  if ( v36 < 0 )
    goto LABEL_34;
  if ( v36 <= 1 )
    goto LABEL_77;
  if ( v36 == 2 )
  {
    if ( a4 )
    {
      v24 = (unsigned int)*a4;
      if ( 2 * v24 <= (unsigned __int64)(unsigned int)MaxCount )
      {
        memmove(v16, a4 + 1, 2 * v24);
        v27 = 2i64 * (unsigned int)*a4;
        if ( v27 >= (unsigned int)MaxCount )
          goto LABEL_44;
        v17 = (unsigned int)MaxCount - v27;
        v18 = &v16[v27];
        goto LABEL_43;
      }
      v22 = off_30148;
      if ( off_30148 == &off_30148
        || !_bittest((const signed __int32 *)off_30148 + 43, 8u)
        || *((_BYTE *)off_30148 + 169) < 2u )
      {
LABEL_64:
        v10 = 6;
        goto LABEL_44;
      }
      v23 = 121;
LABEL_58:
      sub_110E8(v22[19], v23, (__int64)&unk_2EC08, v24);
      goto LABEL_64;
    }
    v25 = off_30148;
    if ( off_30148 == &off_30148
      || !_bittest((const signed __int32 *)off_30148 + 43, 8u)
      || *((_BYTE *)off_30148 + 169) < 2u )
    {
      goto LABEL_64;
    }
    v26 = 122;
LABEL_63:
    sub_11008(v25[19], v26, (__int64)&unk_2EC08);
    goto LABEL_64;
  }
  if ( v36 > 4 )
  {
    if ( v36 > 7 )
    {
LABEL_34:
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 43, 8u)
        && *((_BYTE *)off_30148 + 169) >= 2u )
      {
        sub_11008(*((_QWORD *)off_30148 + 19), 0x7Bu, (__int64)&unk_2EC08);
      }
      v10 = 4;
      goto LABEL_44;
    }
LABEL_77:
    memmove(v16, a4, (unsigned int)MaxCount);
    goto LABEL_44;
  }
  if ( !a4 )
  {
    v25 = off_30148;
    if ( off_30148 == &off_30148
      || !_bittest((const signed __int32 *)off_30148 + 43, 8u)
      || *((_BYTE *)off_30148 + 169) < 2u )
    {
      goto LABEL_64;
    }
    v26 = 120;
    goto LABEL_63;
  }
  if ( *a4 > (unsigned int)MaxCount )
  {
    v22 = off_30148;
    if ( off_30148 == &off_30148
      || !_bittest((const signed __int32 *)off_30148 + 43, 8u)
      || *((_BYTE *)off_30148 + 169) < 2u )
    {
      goto LABEL_64;
    }
    v23 = 119;
    LODWORD(v24) = *a4;
    goto LABEL_58;
  }
  memmove(v16, a4 + 1, (unsigned int)*a4);
  if ( *a4 < (unsigned int)MaxCount )
  {
    v17 = (unsigned int)(MaxCount - *a4);
    v18 = &v16[*a4];
LABEL_43:
    memset(v18, 0, v17);
  }
LABEL_44:
  if ( a1 )
  {
    if ( !v10 )
    {
      v28 = v37;
      *((_DWORD *)v9 + (((a3 - 1) >> 5) & 7) + 1) |= 1 << ((a3 - 1) & 0x1F);
      v29 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, char *, _DWORD))(v7 + 24))(
              v28,
              a1,
              0i64,
              a3,
              v16,
              MaxCount);
      if ( v29 )
      {
        if ( off_30148 != &off_30148
          && _bittest((const signed __int32 *)off_30148 + 43, 8u)
          && *((_BYTE *)off_30148 + 169) >= 2u )
        {
          LODWORD(v33) = a3;
          LODWORD(v31) = a1;
          sub_1DA70(*((_QWORD *)off_30148 + 19), 125i64, (__int64)&unk_2EC08, v29, v31, v33, 0);
        }
        v10 = 8;
      }
    }
    sub_1BEFC((PFAST_MUTEX)((char *)qword_32BA8 + 72));
  }
  else
  {
    sub_1BA64((PERESOURCE)((char *)qword_32BA8 + 216));
    KeLeaveCriticalRegion();
    if ( !v10 )
    {
      v19 = qword_32BA8;
      v38[((a3 - 1) >> 5) & 7] |= 1 << ((a3 - 1) & 0x1F);
      v20 = (void (__fastcall *)(int *))v19[42];
      if ( v20 )
        v20(v38);
      v21 = (*(__int64 (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, char *, _DWORD, _DWORD *))(v7 + 24))(
              v37,
              0i64,
              0i64,
              a3,
              v16,
              MaxCount,
              v34);
      if ( v21 )
      {
        if ( off_30148 != &off_30148
          && _bittest((const signed __int32 *)off_30148 + 43, 8u)
          && *((_BYTE *)off_30148 + 169) >= 2u )
        {
          sub_110E8(*((_QWORD *)off_30148 + 19), 0x7Cu, (__int64)&unk_2EC08, v21);
        }
        v10 = 8;
      }
    }
  }
  return v10;
}
// 1FB78: conditional instruction was optimized away because of 'eax.4>=3'
// 1FAAA: variable 'v30' is possibly undefined
// 1FAAA: variable 'v32' is possibly undefined
// 1FC99: variable 'v34' is possibly undefined
// 1FED7: variable 'v31' is possibly undefined
// 1FED7: variable 'v33' is possibly undefined
// 30148: using guessed type void *off_30148;
// 1F928: using guessed type int var_48[8];

//----- (000000000001FF20) ----------------------------------------------------
__int64 __fastcall sub_1FF20(__int64 a1, unsigned int a2, __int64 a3)
{
  unsigned int v5; // ebx
  void **v6; // rcx
  void **v7; // rcx
  int v8; // edx
  char *v9; // rbp
  unsigned int v10; // er8
  __int64 *v11; // r9
  unsigned int v12; // er12
  _DWORD *v13; // rsi
  unsigned __int16 v14; // dx
  int v15; // eax
  __int64 Dst; // [rsp+30h] [rbp-38h] BYREF
  unsigned int v18; // [rsp+38h] [rbp-30h] BYREF
  int v19; // [rsp+3Ch] [rbp-2Ch] BYREF
  size_t MaxCount; // [rsp+88h] [rbp+20h] BYREF

  v5 = 0;
  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)off_30148 + 43, 8u) && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      sub_11008(*((_QWORD *)off_30148 + 19), 0x7Eu, (__int64)&unk_2EC08);
      v6 = (void **)off_30148;
    }
    if ( v6 != &off_30148 && _bittest((const signed __int32 *)v6 + 43, 8u) && *((_BYTE *)v6 + 169) >= 4u )
      sub_1102C((__int64)v6[19], 0x7Fu, (__int64)&unk_2EC08, a2);
  }
  if ( !(*((unsigned __int8 (__fastcall **)(_QWORD, unsigned int *, size_t *, int *))qword_32BA8 + 40))(
          a2,
          &v18,
          &MaxCount,
          &v19) )
  {
    v7 = (void **)off_30148;
    if ( off_30148 != &off_30148 )
    {
      if ( _bittest((const signed __int32 *)off_30148 + 43, 8u) && *((_BYTE *)off_30148 + 169) >= 2u )
      {
        sub_1102C(*((_QWORD *)off_30148 + 19), 0x80u, (__int64)&unk_2EC08, a2);
LABEL_46:
        v7 = (void **)off_30148;
      }
LABEL_47:
      if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 8u) && *((_BYTE *)v7 + 169) >= 2u )
        sub_11008((__int64)v7[19], 0x85u, (__int64)&unk_2EC08);
    }
LABEL_51:
    v8 = 17;
LABEL_52:
    v11 = 0i64;
    v5 = v8;
    v10 = 0;
    goto LABEL_53;
  }
  if ( !(_DWORD)MaxCount )
  {
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 8u)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x81u, (__int64)&unk_2EC08, a2);
    }
    v8 = 12;
    goto LABEL_52;
  }
  v9 = (char *)qword_32BA8 + v18 + 352;
  if ( v19 < 0 )
  {
LABEL_41:
    v7 = (void **)off_30148;
    if ( off_30148 == &off_30148 )
      goto LABEL_51;
    if ( !_bittest((const signed __int32 *)off_30148 + 43, 8u) || *((_BYTE *)off_30148 + 169) < 2u )
      goto LABEL_47;
    v14 = 132;
    goto LABEL_45;
  }
  if ( v19 <= 1 )
  {
LABEL_40:
    LODWORD(Dst) = 0;
    memmove(&Dst, (char *)qword_32BA8 + v18 + 352, (unsigned int)MaxCount);
    v8 = 0;
    v10 = 4;
    v11 = &Dst;
    goto LABEL_53;
  }
  if ( v19 == 2 )
  {
    v12 = MaxCount + 4;
    v13 = sub_1B038(1, (int)MaxCount + 4, 0x66634E4Eu);
    if ( !v13 )
    {
      v7 = (void **)off_30148;
      if ( off_30148 == &off_30148 )
        goto LABEL_51;
      if ( !_bittest((const signed __int32 *)off_30148 + 43, 8u) || *((_BYTE *)off_30148 + 169) < 2u )
        goto LABEL_47;
      v14 = 131;
      goto LABEL_45;
    }
    v15 = (unsigned int)MaxCount >> 1;
  }
  else
  {
    if ( v19 > 4 )
    {
      if ( v19 > 6 )
      {
        if ( v19 == 7 )
        {
          Dst = 0i64;
          memmove(&Dst, (char *)qword_32BA8 + v18 + 352, (unsigned int)MaxCount);
          v8 = 0;
          v10 = 8;
          v11 = &Dst;
LABEL_53:
          sub_23790(a3, v8, v10, v11);
          goto LABEL_54;
        }
        goto LABEL_41;
      }
      goto LABEL_40;
    }
    v12 = MaxCount + 4;
    v13 = sub_1B038(1, (int)MaxCount + 4, 0x66634E4Eu);
    if ( !v13 )
    {
      v7 = (void **)off_30148;
      if ( off_30148 == &off_30148 )
        goto LABEL_51;
      if ( !_bittest((const signed __int32 *)off_30148 + 43, 8u) || *((_BYTE *)off_30148 + 169) < 2u )
        goto LABEL_47;
      v14 = 130;
LABEL_45:
      sub_11008((__int64)v7[19], v14, (__int64)&unk_2EC08);
      goto LABEL_46;
    }
    v15 = MaxCount;
  }
  *v13 = v15;
  memmove(v13 + 1, v9, (unsigned int)MaxCount);
  sub_23790(a3, 0, v12, v13);
  sub_1B0BC(v13, 0x66634E4Eu);
LABEL_54:
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x86u, (__int64)&unk_2EC08, v5);
  }
  return v5;
}
// 200A4: conditional instruction was optimized away because of 'eax.4>=3'
// 30148: using guessed type void *off_30148;

//----- (00000000000202E4) ----------------------------------------------------
__int64 __fastcall sub_202E4(int a1)
{
  unsigned int v1; // edi
  char *v4; // r10
  char *i; // rax
  char *v6; // rax
  _DWORD *v7; // rax
  _QWORD *v8; // rsi
  char *v9; // rbx
  _QWORD *v10; // rdx
  __int64 v11; // rcx

  v1 = 0;
  if ( !a1 )
    return 6i64;
  sub_1BE30((PFAST_MUTEX)((char *)qword_32BA8 + 72));
  v4 = (char *)qword_32BA8;
  for ( i = (char *)*((_QWORD *)qword_32BA8 + 7); i != (char *)qword_32BA8 + 56; i = (char *)*((_QWORD *)v6 + 5) )
  {
    v6 = i - 40;
    if ( *(_DWORD *)v6 == a1 )
      goto LABEL_8;
  }
  v6 = 0i64;
LABEL_8:
  if ( v6 )
  {
    v1 = 6;
  }
  else
  {
    v7 = sub_1B038(1, *((_DWORD *)qword_32BA8 + 1) + 56, 0x66634E4Eu);
    v8 = v7;
    if ( v7 )
    {
      *v7 = a1;
      memset(v7 + 1, 0, 0x20ui64);
      KeEnterCriticalRegion();
      sub_1B98C((PERESOURCE)((char *)qword_32BA8 + 216));
      v9 = (char *)qword_32BA8;
      memmove(v8 + 7, (char *)qword_32BA8 + 352, *((unsigned int *)qword_32BA8 + 1));
      sub_1BA64((PERESOURCE)(v9 + 216));
      KeLeaveCriticalRegion();
      v4 = (char *)qword_32BA8;
      v10 = (char *)qword_32BA8 + 56;
      v11 = *((_QWORD *)qword_32BA8 + 7);
      v8[6] = (char *)qword_32BA8 + 56;
      v8[5] = v11;
      *(_QWORD *)(v11 + 8) = v8 + 5;
      *v10 = v8 + 5;
    }
    else
    {
      v4 = (char *)qword_32BA8;
      v1 = 3;
    }
  }
  sub_1BEFC((PFAST_MUTEX)(v4 + 72));
  return v1;
}

//----- (0000000000020440) ----------------------------------------------------
__int64 __fastcall sub_20440(int a1)
{
  __int64 result; // rax
  char *v3; // r11
  _QWORD *i; // rax
  char *v5; // rdi
  __int64 v6; // rcx
  _QWORD *v7; // rax
  char *v8; // rbx
  void (__fastcall *v9)(char *); // rax

  if ( !a1 )
    return 6i64;
  sub_1BE30((PFAST_MUTEX)((char *)qword_32BA8 + 72));
  v3 = (char *)qword_32BA8;
  for ( i = (_QWORD *)*((_QWORD *)qword_32BA8 + 7); i != (_QWORD *)((char *)qword_32BA8 + 56); i = (_QWORD *)*i )
  {
    v5 = (char *)(i - 5);
    if ( *((_DWORD *)i - 10) == a1 )
      goto LABEL_8;
  }
  v5 = 0i64;
LABEL_8:
  if ( v5 )
  {
    v6 = *((_QWORD *)v5 + 5);
    v7 = (_QWORD *)*((_QWORD *)v5 + 6);
    *v7 = v6;
    *(_QWORD *)(v6 + 8) = v7;
    sub_1BEFC((PFAST_MUTEX)(v3 + 72));
    KeEnterCriticalRegion();
    sub_1B8B4((PERESOURCE)((char *)qword_32BA8 + 216));
    v8 = (char *)qword_32BA8;
    memmove((char *)qword_32BA8 + 352, v5 + 56, *((unsigned int *)qword_32BA8 + 1));
    sub_1BA64((PERESOURCE)(v8 + 216));
    KeLeaveCriticalRegion();
    v9 = (void (__fastcall *)(char *))*((_QWORD *)qword_32BA8 + 42);
    if ( v9 )
      v9(v5 + 4);
    sub_1B0BC(v5, 0x66634E4Eu);
    result = 0i64;
  }
  else
  {
    sub_1BEFC((PFAST_MUTEX)((char *)qword_32BA8 + 72));
    result = 5i64;
  }
  return result;
}

//----- (0000000000020568) ----------------------------------------------------
__int64 __fastcall sub_20568(__int64 a1, __int64 a2, __int64 a3, const wchar_t *a4)
{
  __int64 v5; // rcx
  const wchar_t *v6; // rdi
  bool v7; // zf

  if ( a4 && *a4 )
  {
    v5 = -1i64;
    v6 = a4;
    do
    {
      if ( !v5 )
        break;
      v7 = *v6++ == 0;
      --v5;
    }
    while ( !v7 );
  }
  if ( a4 )
  {
    if ( !*a4 )
      a4 = L"<NULL>";
  }
  else
  {
    a4 = L"NULL";
  }
  return qword_30398(a1, 43i64, &unk_2EBF8, 71i64, a4);
}
// 2ECC0: using guessed type wchar_t aNull_1[7];
// 2ECD0: using guessed type wchar_t aNull_2[5];
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000020618) ----------------------------------------------------
__int64 sub_20618(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_30398(a1, 43i64, &unk_2EBF8, a2, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000020684) ----------------------------------------------------
__int64 sub_20684(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+98h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_30398(a1, 43i64, &unk_2EBF8, 134i64, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000206F0) ----------------------------------------------------
__int64 sub_206F0(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  __int64 v5; // [rsp+78h] [rbp+20h] BYREF
  va_list va; // [rsp+78h] [rbp+20h]
  const char *v7; // [rsp+80h] [rbp+28h]
  va_list va1; // [rsp+88h] [rbp+30h] BYREF

  va_start(va1, a3);
  va_start(va, a3);
  v5 = va_arg(va1, _QWORD);
  v7 = va_arg(va1, const char *);
  if ( v7 )
    strlen(v7);
  return qword_30398(a1, 43i64, &unk_2EBF8, a2, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000020778) ----------------------------------------------------
__int64 __fastcall sub_20778(__int16 *a1, int a2, unsigned int *a3)
{
  void **v6; // rbx
  __int64 v7; // rcx
  unsigned __int16 v8; // dx

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xAu, (__int64)&unk_2EBF8);
    v6 = (void **)off_30148;
  }
  if ( !byte_33012 )
  {
    memset(&qword_32BB0, 0, 0x470ui64);
    if ( a3 )
    {
      if ( !(unsigned int)sub_23548(a3) )
      {
        dword_33008 = 0;
        dword_3300C = 0;
        byte_33013 = 0;
        byte_33010 = 0;
        byte_33011 = 0;
        sub_2D184(word_32BD0, 520i64, a1);
        dword_32FE0 = a2;
        byte_33012 = 1;
        sub_2094C(1);
        if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
          sub_1102C(*((_QWORD *)off_30148 + 19), 0xEu, (__int64)&unk_2EBF8, 0);
        return 0i64;
      }
      if ( off_30148 == &off_30148 || (*((_BYTE *)off_30148 + 172) & 1) == 0 || *((_BYTE *)off_30148 + 169) < 2u )
        return 264i64;
      v7 = *((_QWORD *)off_30148 + 19);
      v8 = 13;
    }
    else
    {
      if ( v6 == &off_30148 || (*((_BYTE *)v6 + 172) & 1) == 0 || *((_BYTE *)v6 + 169) < 2u )
        return 264i64;
      v7 = (__int64)v6[19];
      v8 = 12;
    }
    sub_11008(v7, v8, (__int64)&unk_2EBF8);
    return 264i64;
  }
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 1) != 0 && *((_BYTE *)v6 + 169) >= 2u )
    sub_11008((__int64)v6[19], 0xBu, (__int64)&unk_2EBF8);
  return 0i64;
}
// 30148: using guessed type void *off_30148;
// 32FE0: using guessed type int dword_32FE0;
// 33008: using guessed type int dword_33008;
// 3300C: using guessed type int dword_3300C;
// 33010: using guessed type char byte_33010;
// 33011: using guessed type char byte_33011;
// 33012: using guessed type char byte_33012;
// 33013: using guessed type char byte_33013;

//----- (000000000002094C) ----------------------------------------------------
__int64 __fastcall sub_2094C(char a1)
{
  void **v2; // rcx

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xFu, (__int64)&unk_2EBF8);
    v2 = (void **)off_30148;
  }
  byte_33014 = a1;
  if ( v2 != &off_30148 && (*((_BYTE *)v2 + 172) & 1) != 0 && *((_BYTE *)v2 + 169) >= 5u )
    sub_1102C((__int64)v2[19], 0x10u, (__int64)&unk_2EBF8, 0);
  return 0i64;
}
// 30148: using guessed type void *off_30148;
// 33014: using guessed type char byte_33014;

//----- (00000000000209E8) ----------------------------------------------------
__int64 __fastcall sub_209E8(int a1, int a2)
{
  void **v4; // rcx
  __int64 result; // rax
  _QWORD *v6; // rax
  _QWORD *v7; // rcx
  void **v8; // rcx

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x11u, (__int64)&unk_2EBF8);
    v4 = (void **)off_30148;
  }
  if ( byte_33012 )
  {
    if ( !dword_33008 )
    {
      qword_32BB8 = (__int64)&qword_32BB0;
      qword_32BB0 = &qword_32BB0;
    }
    v6 = sub_1B038(2, 0x28u, 0x74785072u);
    if ( v6 )
    {
      v6[4] = 0i64;
      *((_DWORD *)v6 + 4) = a1;
      *((_DWORD *)v6 + 6) = a2;
      *((_DWORD *)v6 + 7) = 2;
      v7 = (_QWORD *)qword_32BB8;
      *v6 = &qword_32BB0;
      v6[1] = v7;
      *v7 = v6;
      ++dword_33008;
      qword_32BB8 = (__int64)v6;
      v8 = (void **)off_30148;
      if ( off_30148 != &off_30148 )
      {
        if ( (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
        {
          sub_1102C(*((_QWORD *)off_30148 + 19), 0x14u, (__int64)&unk_2EBF8, a1);
          v8 = (void **)off_30148;
        }
        if ( v8 != &off_30148 && (*((_BYTE *)v8 + 172) & 1) != 0 && *((_BYTE *)v8 + 169) >= 5u )
          sub_1102C((__int64)v8[19], 0x15u, (__int64)&unk_2EBF8, 0);
      }
      result = 0i64;
    }
    else
    {
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 2u )
        sub_11008(*((_QWORD *)off_30148 + 19), 0x13u, (__int64)&unk_2EBF8);
      result = 3i64;
    }
  }
  else
  {
    if ( v4 != &off_30148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) >= 2u )
      sub_11008((__int64)v4[19], 0x12u, (__int64)&unk_2EBF8);
    result = 258i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;
// 32BB8: using guessed type __int64 qword_32BB8;
// 33008: using guessed type int dword_33008;
// 33012: using guessed type char byte_33012;

//----- (0000000000020BC8) ----------------------------------------------------
__int64 sub_20BC8()
{
  void **v0; // rcx
  __int64 result; // rax
  _QWORD *v2; // rax
  _QWORD *v3; // rcx
  void **v4; // rcx

  v0 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x16u, (__int64)&unk_2EBF8);
    v0 = (void **)off_30148;
  }
  if ( byte_33012 )
  {
    if ( !dword_3300C )
    {
      qword_32BC8 = (__int64)&qword_32BC0;
      qword_32BC0 = &qword_32BC0;
    }
    v2 = sub_1B038(2, 0x48u, 0x746D436Eu);
    if ( v2 )
    {
      v2[6] = 0i64;
      *((_DWORD *)v2 + 6) = 1;
      *((_DWORD *)v2 + 7) = 4;
      v2[4] = sub_14E58;
      *((_DWORD *)v2 + 4) = 40000;
      v2[8] = &qword_32BB0;
      v3 = (_QWORD *)qword_32BC8;
      *v2 = &qword_32BC0;
      v2[1] = v3;
      *v3 = v2;
      ++dword_3300C;
      qword_32BC8 = (__int64)v2;
      v4 = (void **)off_30148;
      if ( off_30148 != &off_30148 )
      {
        if ( (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
        {
          sub_1102C(*((_QWORD *)off_30148 + 19), 0x19u, (__int64)&unk_2EBF8, 40000);
          v4 = (void **)off_30148;
        }
        if ( v4 != &off_30148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) >= 5u )
          sub_1102C((__int64)v4[19], 0x1Au, (__int64)&unk_2EBF8, 0);
      }
      result = 0i64;
    }
    else
    {
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 2u )
        sub_11008(*((_QWORD *)off_30148 + 19), 0x18u, (__int64)&unk_2EBF8);
      result = 3i64;
    }
  }
  else
  {
    if ( v0 != &off_30148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 2u )
      sub_11008((__int64)v0[19], 0x17u, (__int64)&unk_2EBF8);
    result = 258i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;
// 32BC8: using guessed type __int64 qword_32BC8;
// 3300C: using guessed type int dword_3300C;
// 33012: using guessed type char byte_33012;

//----- (0000000000020DB0) ----------------------------------------------------
__int64 sub_20DB0()
{
  void **v0; // rcx
  _QWORD *v2; // rcx
  unsigned __int16 v3; // dx

  v0 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x1Bu, (__int64)&unk_2EBF8);
    v0 = (void **)off_30148;
  }
  if ( !byte_33012 )
  {
    if ( v0 != &off_30148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 2u )
      sub_11008((__int64)v0[19], 0x1Cu, (__int64)&unk_2EBF8);
    return 258i64;
  }
  if ( !dword_33008 && !dword_3300C && v0 != &off_30148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 2u )
    sub_11008((__int64)v0[19], 0x1Du, (__int64)&unk_2EBF8);
  if ( (unsigned int)sub_2172C() )
  {
    v2 = off_30148;
    if ( off_30148 == &off_30148 || (*((_BYTE *)off_30148 + 172) & 1) == 0 || *((_BYTE *)off_30148 + 169) < 2u )
      return 257i64;
    v3 = 30;
LABEL_22:
    sub_11008(v2[19], v3, (__int64)&unk_2EBF8);
    return 257i64;
  }
  if ( (unsigned int)sub_21D78() )
  {
    v2 = off_30148;
    if ( off_30148 == &off_30148 || (*((_BYTE *)off_30148 + 172) & 1) == 0 || *((_BYTE *)off_30148 + 169) < 2u )
      return 257i64;
    v3 = 31;
    goto LABEL_22;
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x20u, (__int64)&unk_2EBF8);
  sub_24890();
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x21u, (__int64)&unk_2EBF8, 0);
  return 0i64;
}
// 30148: using guessed type void *off_30148;
// 33008: using guessed type int dword_33008;
// 3300C: using guessed type int dword_3300C;
// 33012: using guessed type char byte_33012;

//----- (0000000000020F70) ----------------------------------------------------
__int64 __fastcall sub_20F70(int a1, const void *a2, unsigned int a3, __int64 a4, int *a5)
{
  unsigned int v8; // ebx
  void **v9; // rcx
  void **v11; // rcx

  v8 = 0;
  v9 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x22u, (__int64)&unk_2EBF8);
    v9 = (void **)off_30148;
  }
  if ( !byte_33013 )
  {
    if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 43, 0xAu) && *((_BYTE *)v9 + 169) >= 2u )
      sub_11008((__int64)v9[19], 0x23u, (__int64)&unk_2EBF8);
    return 260i64;
  }
  if ( (unsigned int)(a1 - 40000) > 0x4D )
  {
    if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 43, 0xAu) && *((_BYTE *)v9 + 169) >= 2u )
      sub_11008((__int64)v9[19], 0x24u, (__int64)&unk_2EBF8);
    return 261i64;
  }
  if ( !a2 )
  {
    if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 43, 0xAu) && *((_BYTE *)v9 + 169) >= 2u )
      sub_11008((__int64)v9[19], 0x25u, (__int64)&unk_2EBF8);
    return 4i64;
  }
  if ( *((_QWORD *)qword_32FF8 + 8 * (unsigned __int64)(unsigned int)(a1 - 40000) + 4) )
  {
    if ( (unsigned int)sub_2309C(a1, a2, a3, a5) )
    {
      v11 = (void **)off_30148;
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
        && *((_BYTE *)off_30148 + 169) >= 2u )
      {
        sub_11008(*((_QWORD *)off_30148 + 19), 0x27u, (__int64)&unk_2EBF8);
        v11 = (void **)off_30148;
      }
      v8 = 262;
      goto LABEL_37;
    }
  }
  else if ( (unsigned int)sub_2283C(a1, a2, a3, 0i64, a5) )
  {
    v11 = (void **)off_30148;
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_11008(*((_QWORD *)off_30148 + 19), 0x26u, (__int64)&unk_2EBF8);
      v11 = (void **)off_30148;
    }
    v8 = 263;
    goto LABEL_37;
  }
  v11 = (void **)off_30148;
LABEL_37:
  if ( v11 != &off_30148 && _bittest((const signed __int32 *)v11 + 43, 0xAu) && *((_BYTE *)v11 + 169) >= 5u )
    sub_1102C((__int64)v11[19], 0x28u, (__int64)&unk_2EBF8, v8);
  return v8;
}
// 30148: using guessed type void *off_30148;
// 33013: using guessed type char byte_33013;

//----- (00000000000211B4) ----------------------------------------------------
__int64 __fastcall sub_211B4(__int64 a1, void *a2, unsigned int a3, int a4, int *a5)
{
  unsigned int v8; // ebx
  void **v9; // rcx
  __int64 result; // rax

  v8 = 0;
  v9 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x29u, (__int64)&unk_2EBF8);
    v9 = (void **)off_30148;
  }
  if ( byte_33013 )
  {
    if ( a2 )
    {
      if ( !*((_QWORD *)qword_32FF8 + 324) )
      {
        if ( (unsigned int)sub_22B50(40040i64, a2, a3, a4, a5) )
        {
          v9 = (void **)off_30148;
          if ( off_30148 != &off_30148
            && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
            && *((_BYTE *)off_30148 + 169) >= 2u )
          {
            sub_11008(*((_QWORD *)off_30148 + 19), 0x2Du, (__int64)&unk_2EBF8);
            v9 = (void **)off_30148;
          }
          v8 = 263;
        }
        else
        {
          v9 = (void **)off_30148;
        }
      }
      if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 43, 0xAu) && *((_BYTE *)v9 + 169) >= 5u )
        sub_1102C((__int64)v9[19], 0x2Eu, (__int64)&unk_2EBF8, v8);
      result = v8;
    }
    else
    {
      if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 43, 0xAu) && *((_BYTE *)v9 + 169) >= 2u )
        sub_11008((__int64)v9[19], 0x2Cu, (__int64)&unk_2EBF8);
      result = 4i64;
    }
  }
  else
  {
    if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 43, 0xAu) && *((_BYTE *)v9 + 169) >= 2u )
      sub_11008((__int64)v9[19], 0x2Au, (__int64)&unk_2EBF8);
    result = 260i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;
// 33013: using guessed type char byte_33013;

//----- (000000000002136C) ----------------------------------------------------
__int64 __fastcall sub_2136C(unsigned int a1, __int64 a2)
{
  void **v4; // rcx
  __int64 result; // rax
  int v6; // eax

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x35u, (__int64)&unk_2EBF8);
    v4 = (void **)off_30148;
  }
  if ( byte_33013 )
  {
    if ( qword_32FE8 && a2 )
    {
      v6 = (*(__int64 (__fastcall **)(_QWORD, _QWORD, __int64))(*((_QWORD *)qword_32FE8 + 1) + 8i64))(
             **((_QWORD **)qword_32FE8 + 1),
             a1,
             a2);
      v4 = (void **)off_30148;
    }
    else
    {
      v6 = 1796;
    }
    if ( v6 )
    {
      if ( v4 != &off_30148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) >= 2u )
        sub_1102C((__int64)v4[19], 0x37u, (__int64)&unk_2EBF8, v6);
      result = 257i64;
    }
    else
    {
      if ( v4 != &off_30148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) >= 5u )
        sub_1102C((__int64)v4[19], 0x38u, (__int64)&unk_2EBF8, 0);
      result = 0i64;
    }
  }
  else
  {
    if ( v4 != &off_30148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) >= 2u )
      sub_11008((__int64)v4[19], 0x36u, (__int64)&unk_2EBF8);
    result = 260i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;
// 33013: using guessed type char byte_33013;

//----- (00000000000214BC) ----------------------------------------------------
__int64 sub_214BC()
{
  void **v0; // rcx
  int v2; // eax
  unsigned int v3; // edi
  void **v4; // rbx
  PVOID *v5; // rcx
  PVOID *v6; // rcx

  v0 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x39u, (__int64)&unk_2EBF8);
    v0 = (void **)off_30148;
  }
  if ( byte_33012 )
  {
    v2 = sub_224DC();
    v3 = v2;
    if ( v2 )
    {
      v4 = (void **)off_30148;
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 2u )
      {
        sub_1102C(*((_QWORD *)off_30148 + 19), 0x3Bu, (__int64)&unk_2EBF8, v2);
        v4 = (void **)off_30148;
      }
      if ( v3 != 260 )
        return v3;
    }
    else
    {
      v4 = (void **)off_30148;
    }
    if ( dword_33008 )
    {
      v5 = (PVOID *)qword_32BB0;
      if ( qword_32BB0 != &qword_32BB0 )
      {
        do
        {
          qword_32BB0 = *v5;
          *((_QWORD *)qword_32BB0 + 1) = &qword_32BB0;
          sub_1B0BC(v5, 0x74785072u);
          v5 = (PVOID *)qword_32BB0;
        }
        while ( qword_32BB0 != &qword_32BB0 );
        v4 = (void **)off_30148;
      }
    }
    if ( dword_3300C )
    {
      v6 = (PVOID *)qword_32BC0;
      if ( qword_32BC0 != &qword_32BC0 )
      {
        do
        {
          qword_32BC0 = *v6;
          *((_QWORD *)qword_32BC0 + 1) = &qword_32BC0;
          sub_1B0BC(v6, 0x746D436Eu);
          v6 = (PVOID *)qword_32BC0;
        }
        while ( qword_32BC0 != &qword_32BC0 );
        v4 = (void **)off_30148;
      }
    }
    if ( qword_32FF8 && byte_33010 == 1 )
    {
      sub_1B0BC(qword_32FF8, 0x74785072u);
      qword_32FF8 = 0i64;
      v4 = (void **)off_30148;
    }
    if ( qword_33000 && byte_33011 == 1 )
    {
      sub_1B0BC(qword_33000, 0x746D436Eu);
      v4 = (void **)off_30148;
    }
    memset(&qword_32BB0, 0, 0x470ui64);
    if ( v4 != &off_30148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) >= 5u )
      sub_1102C((__int64)v4[19], 0x3Cu, (__int64)&unk_2EBF8, v3);
    return v3;
  }
  if ( v0 != &off_30148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 2u )
    sub_11008((__int64)v0[19], 0x3Au, (__int64)&unk_2EBF8);
  return 0i64;
}
// 30148: using guessed type void *off_30148;
// 33008: using guessed type int dword_33008;
// 3300C: using guessed type int dword_3300C;
// 33010: using guessed type char byte_33010;
// 33011: using guessed type char byte_33011;
// 33012: using guessed type char byte_33012;

//----- (000000000002172C) ----------------------------------------------------
__int64 sub_2172C()
{
  void **v0; // rcx
  PVOID v1; // rax
  PVOID v3; // rax

  v0 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x3Du, (__int64)&unk_2EBF8);
    v0 = (void **)off_30148;
  }
  if ( dword_33008 )
  {
    v1 = sub_1B038(2, 0x1340u, 0x74785072u);
    qword_32FF8 = v1;
    if ( !v1 )
      return 3i64;
    memset(v1, 0, 0x1340ui64);
    if ( (unsigned int)sub_219B4(0) )
    {
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
        sub_11008(*((_QWORD *)off_30148 + 19), 0x3Eu, (__int64)&unk_2EBF8);
      sub_1B0BC(qword_32FF8, 0x74785072u);
      qword_32FF8 = 0i64;
      return 1i64;
    }
    v0 = (void **)off_30148;
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
    {
      sub_11008(*((_QWORD *)off_30148 + 19), 0x3Fu, (__int64)&unk_2EBF8);
      v0 = (void **)off_30148;
    }
    byte_33010 = 1;
  }
  if ( dword_3300C )
  {
    v3 = sub_1B038(2, 0x9A0u, 0x746D436Eu);
    qword_33000 = v3;
    if ( v3 )
    {
      memset(v3, 0, 0x9A0ui64);
      if ( (unsigned int)sub_219B4(1) )
      {
        if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
          sub_11008(*((_QWORD *)off_30148 + 19), 0x40u, (__int64)&unk_2EBF8);
        sub_1B0BC(qword_33000, 0x746D436Eu);
        qword_33000 = 0i64;
        return 1i64;
      }
      v0 = (void **)off_30148;
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
      {
        sub_11008(*((_QWORD *)off_30148 + 19), 0x41u, (__int64)&unk_2EBF8);
        v0 = (void **)off_30148;
      }
      byte_33011 = 1;
      goto LABEL_33;
    }
    return 3i64;
  }
LABEL_33:
  if ( v0 != &off_30148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 5u )
    sub_1102C((__int64)v0[19], 0x42u, (__int64)&unk_2EBF8, 0);
  return 0i64;
}
// 30148: using guessed type void *off_30148;
// 33008: using guessed type int dword_33008;
// 3300C: using guessed type int dword_3300C;
// 33010: using guessed type char byte_33010;
// 33011: using guessed type char byte_33011;

//----- (00000000000219B4) ----------------------------------------------------
__int64 __fastcall sub_219B4(int a1)
{
  unsigned int v2; // edi
  void **v3; // rcx
  PVOID *j; // rbx
  int v5; // edx
  unsigned int v6; // er9
  unsigned __int64 v7; // r8
  PVOID *i; // rbx
  unsigned int v9; // er9
  __int64 v10; // r8
  __int64 (__fastcall *v11)(__int64, __int64, __int64); // rcx
  int v12; // eax

  v2 = 0;
  v3 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x43u, (__int64)&unk_2EBF8);
    v3 = (void **)off_30148;
  }
  if ( a1 )
  {
    for ( i = (PVOID *)qword_32BC0; i != &qword_32BC0; i = (PVOID *)*i )
    {
      v9 = *((_DWORD *)i + 4) - 40000;
      if ( v9 >= 0x4D )
      {
        if ( v3 != &off_30148 && (*((_BYTE *)v3 + 172) & 1) != 0 && *((_BYTE *)v3 + 169) >= 2u )
        {
          sub_1102C((__int64)v3[19], 0x45u, (__int64)&unk_2EBF8, v9);
          v3 = (void **)off_30148;
        }
        v2 = 1;
      }
      else
      {
        v10 = 32i64 * v9;
        *(_DWORD *)((char *)qword_33000 + v10) = *((_DWORD *)i + 4);
        *(_DWORD *)((char *)qword_33000 + v10 + 4) = -1;
        *(_DWORD *)((char *)qword_33000 + v10 + 8) = *((_DWORD *)i + 6);
        *(_DWORD *)((char *)qword_33000 + v10 + 12) = *((_DWORD *)i + 7);
        *(_QWORD *)((char *)qword_33000 + v10 + 24) = i + 3;
        if ( *((_DWORD *)i + 4) == 40005 )
        {
          v11 = sub_23F18;
        }
        else
        {
          v12 = *((_DWORD *)i + 4);
          if ( v12 == 40015
            || v12 == 40016
            || v12 == 40017
            || v12 == 40018
            || v12 == 40019
            || v12 == 40020
            || v12 == 40021
            || v12 == 40023
            || v12 == 40022
            || v12 == 40039
            || v12 == 40044
            || v12 == 40024
            || v12 == 40036
            || v12 == 40012
            || v12 == 40037
            || v12 == 40014
            || v12 == 40041
            || v12 == 40042
            || v12 == 40013
            || v12 == 40038
            || v12 == 40025 )
          {
            v11 = sub_246EC;
          }
          else if ( v12 == 40011
                 || v12 == 40053
                 || v12 == 40050
                 || v12 == 40051
                 || v12 == 40052
                 || v12 == 40045
                 || v12 == 40003 )
          {
            v11 = sub_23C00;
          }
          else
          {
            v11 = sub_2398C;
          }
        }
        *(_QWORD *)((char *)qword_33000 + v10 + 16) = v11;
        v3 = (void **)off_30148;
      }
    }
  }
  else
  {
    for ( j = (PVOID *)qword_32BB0; j != &qword_32BB0; j = (PVOID *)*j )
    {
      v5 = *((_DWORD *)j + 4);
      v6 = v5 - 40000;
      if ( (unsigned int)(v5 - 40000) >= 0x4D )
      {
        if ( v3 != &off_30148 && (*((_BYTE *)v3 + 172) & 1) != 0 && *((_BYTE *)v3 + 169) >= 2u )
        {
          sub_1102C((__int64)v3[19], 0x44u, (__int64)&unk_2EBF8, v6);
          v3 = (void **)off_30148;
        }
        v2 = 1;
      }
      else
      {
        v7 = (unsigned __int64)v6 << 6;
        *(_DWORD *)((char *)qword_32FF8 + v7) = v5;
        *(_DWORD *)((char *)qword_32FF8 + v7 + 4) = *((_DWORD *)j + 6);
        *(_DWORD *)((char *)qword_32FF8 + v7 + 8) = -1;
        *(_QWORD *)((char *)qword_32FF8 + v7 + 16) = 0i64;
        *(_DWORD *)((char *)qword_32FF8 + v7 + 24) = *((_DWORD *)j + 7);
        *(_QWORD *)((char *)qword_32FF8 + v7 + 32) = (unsigned __int64)sub_232F0 & -(__int64)(j[4] != 0i64);
        *(_QWORD *)((char *)qword_32FF8 + v7 + 40) = j + 3;
        *(_DWORD *)((char *)qword_32FF8 + v7 + 48) = 0;
        *(_QWORD *)((char *)qword_32FF8 + v7 + 56) = 0i64;
        v3 = (void **)off_30148;
      }
    }
  }
  if ( v3 != &off_30148 && (*((_BYTE *)v3 + 172) & 1) != 0 && *((_BYTE *)v3 + 169) >= 5u )
    sub_1102C((__int64)v3[19], 0x46u, (__int64)&unk_2EBF8, v2);
  return v2;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000021D78) ----------------------------------------------------
__int64 sub_21D78()
{
  void **v0; // rcx
  _QWORD *v1; // rax
  _QWORD *v2; // rbx
  int v3; // edi
  void **v4; // rcx
  unsigned __int16 v5; // dx
  int v6; // er9
  unsigned int v7; // esi
  __int64 v8; // rdi
  _QWORD *v9; // rbp
  int v10; // er12
  int v11; // eax
  __int64 v12; // rax
  int v13; // eax
  __int64 v14; // r9
  __int64 v15; // r8
  __int64 v16; // rcx
  void **v18; // r10
  unsigned int v19; // ebx
  __int64 v20; // rdi
  int v21; // er9
  __int64 v22; // rax
  unsigned int v23; // ebx
  __int64 v24; // rdi
  __int64 v25; // rax
  __int64 v26; // rax
  unsigned __int16 v27; // dx
  __int64 (__fastcall **v28)(_QWORD *, _QWORD, _WORD *); // [rsp+60h] [rbp+8h] BYREF

  v0 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_20568(*((_QWORD *)off_30148 + 19), 71i64, (__int64)&unk_2EBF8, word_32BD0);
    v0 = (void **)off_30148;
  }
  if ( byte_33010 || byte_33011 )
    goto LABEL_11;
  if ( v0 != &off_30148 )
  {
    if ( (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 2u )
    {
      sub_11008((__int64)v0[19], 0x48u, (__int64)&unk_2EBF8);
      v0 = (void **)off_30148;
    }
LABEL_11:
    if ( v0 != &off_30148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 4u )
      sub_147C8((__int64)v0[19], 0x49u, (__int64)&unk_2EBF8, &qword_32FE8);
  }
  qword_32FE8 = 0i64;
  v1 = sub_1B038(2, 0x38u, 0x41434E50u);
  v2 = v1;
  if ( !v1 )
  {
    v3 = 1793;
LABEL_25:
    v4 = (void **)off_30148;
    if ( off_30148 == &off_30148 || (*((_BYTE *)off_30148 + 172) & 1) == 0 || !*((_BYTE *)off_30148 + 169) )
      return 260i64;
    v5 = 74;
    v6 = v3;
LABEL_53:
    v16 = (__int64)v4[19];
    goto LABEL_54;
  }
  memset(v1, 0, 0x38ui64);
  v3 = sub_2AF7C(v2 + 6, v2 + 1);
  if ( v3
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531842i64,
               v2 + 2)) != 0
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531845i64,
               v2 + 5)) != 0
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531843i64,
               v2 + 4)) != 0
    || (v3 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD *))(v2[1] + 8i64))(
               *(_QWORD *)v2[1],
               4026531844i64,
               v2 + 3)) != 0 )
  {
    sub_2B100(v2);
    v2 = qword_32FE8;
  }
  else
  {
    *(_BYTE *)v2 = 1;
    qword_32FE8 = v2;
  }
  if ( v3 )
    goto LABEL_25;
  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
  {
    sub_147C8(*((_QWORD *)off_30148 + 19), 0x4Bu, (__int64)&unk_2EBF8, &qword_32FE8, 0i64, 0);
    v4 = (void **)off_30148;
    v2 = qword_32FE8;
  }
  v7 = dword_32FE0;
  v8 = 0i64;
  v9 = v2;
  v10 = 1796;
  if ( v2 )
  {
    v11 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(v2[1] + 8i64))(*(_QWORD *)v2[1], 1i64, &v28);
    v4 = (void **)off_30148;
    v2 = qword_32FE8;
    if ( !v11 )
    {
      v12 = (*v28)(v9, v7, word_32BD0);
      v4 = (void **)off_30148;
      v2 = qword_32FE8;
      v8 = v12;
    }
  }
  qword_32FF0 = v8;
  if ( !v8 )
  {
    if ( v4 != &off_30148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) )
      sub_11008((__int64)v4[19], 0x4Cu, (__int64)&unk_2EBF8);
    return 260i64;
  }
  if ( v4 != &off_30148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) >= 4u )
  {
    sub_14D0C((__int64)v4[19], 0x4Du, (__int64)&unk_2EBF8, v2, v8, &qword_33020);
    v4 = (void **)off_30148;
    v8 = qword_32FF0;
    v2 = qword_32FE8;
  }
  v13 = 1796;
  if ( !v8 || (v14 = *(_QWORD *)(v8 + 1112)) == 0 )
  {
LABEL_49:
    if ( v4 == &off_30148 || (*((_BYTE *)v4 + 172) & 1) == 0 || !*((_BYTE *)v4 + 169) )
      return 260i64;
    v5 = 78;
    v6 = v13;
    goto LABEL_53;
  }
  v13 = (*(__int64 (__fastcall **)(_QWORD *, __int64, __int64 *))(v14 + 112))(v2, v8, &qword_33020);
  if ( v13 )
  {
    v4 = (void **)off_30148;
    goto LABEL_49;
  }
  v18 = (void **)off_30148;
  if ( !dword_33008 )
  {
LABEL_71:
    if ( dword_3300C )
    {
      v23 = 0;
      v24 = 0i64;
      do
      {
        if ( v18 != &off_30148 && (*((_BYTE *)v18 + 172) & 1) != 0 && *((_BYTE *)v18 + 169) >= 4u )
        {
          sub_14D0C(
            (__int64)v18[19],
            0x52u,
            (__int64)&unk_2EBF8,
            qword_32FE8,
            qword_32FF0,
            (char *)qword_33000 + 32 * v23);
          v18 = (void **)off_30148;
        }
        if ( *(_DWORD *)((char *)qword_33000 + v24) )
        {
          v21 = 1796;
          if ( !qword_32FF0 )
            goto LABEL_105;
          v25 = *(_QWORD *)(qword_32FF0 + 1112);
          if ( !v25 )
            goto LABEL_105;
          v21 = (*(__int64 (__fastcall **)(__int64, char *, __int64, __int64))(v25 + 40))(
                  qword_32FF0,
                  (char *)qword_33000 + 32 * v23,
                  v15,
                  1796i64);
          if ( v21 )
          {
            v18 = (void **)off_30148;
LABEL_105:
            if ( v18 != &off_30148 && (*((_BYTE *)v18 + 172) & 1) != 0 && *((_BYTE *)v18 + 169) )
            {
              v27 = 83;
LABEL_103:
              sub_139F8((__int64)v18[19], v27, (__int64)&unk_2EBF8, v21);
            }
            return 260i64;
          }
          v18 = (void **)off_30148;
          if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) )
          {
            sub_1102C(*((_QWORD *)off_30148 + 19), 0x54u, (__int64)&unk_2EBF8, v23);
            v18 = (void **)off_30148;
          }
        }
        ++v23;
        v24 += 32i64;
      }
      while ( v23 < 0x4D );
    }
    if ( v18 != &off_30148 && (*((_BYTE *)v18 + 172) & 1) != 0 && *((_BYTE *)v18 + 169) >= 4u )
    {
      sub_14CC4((__int64)v18[19], 0x55u, (__int64)&unk_2EBF8, qword_32FE8, qword_32FF0);
      v18 = (void **)off_30148;
    }
    if ( qword_32FF0 )
    {
      v26 = *(_QWORD *)(qword_32FF0 + 1112);
      if ( v26 )
      {
        v10 = (*(__int64 (__fastcall **)(PVOID))(v26 + 8))(qword_32FE8);
        if ( !v10 )
        {
          byte_33013 = 1;
          if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
            sub_1102C(*((_QWORD *)off_30148 + 19), 0x57u, (__int64)&unk_2EBF8, 0);
          return 0i64;
        }
        v18 = (void **)off_30148;
      }
    }
    if ( v18 == &off_30148 || (*((_BYTE *)v18 + 172) & 1) == 0 || !*((_BYTE *)v18 + 169) )
      return 260i64;
    v16 = (__int64)v18[19];
    v5 = 86;
    v6 = v10;
LABEL_54:
    sub_1102C(v16, v5, (__int64)&unk_2EBF8, v6);
    return 260i64;
  }
  v19 = 0;
  v20 = 0i64;
  while ( 1 )
  {
    if ( v18 != &off_30148 && (*((_BYTE *)v18 + 172) & 1) != 0 && *((_BYTE *)v18 + 169) >= 4u )
    {
      sub_14D0C(
        (__int64)v18[19],
        0x4Fu,
        (__int64)&unk_2EBF8,
        qword_32FE8,
        qword_32FF0,
        (char *)qword_32FF8 + 64 * (unsigned __int64)v19);
      v18 = (void **)off_30148;
    }
    if ( !*(_DWORD *)((char *)qword_32FF8 + v20) )
      goto LABEL_70;
    v21 = 1796;
    if ( !qword_32FF0 )
      goto LABEL_99;
    v22 = *(_QWORD *)(qword_32FF0 + 1112);
    if ( !v22 )
      goto LABEL_99;
    v21 = (*(__int64 (__fastcall **)(__int64, char *, __int64, __int64))(v22 + 64))(
            qword_32FF0,
            (char *)qword_32FF8 + 64 * (unsigned __int64)v19,
            v15,
            1796i64);
    if ( v21 )
      break;
    v18 = (void **)off_30148;
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x51u, (__int64)&unk_2EBF8, v19);
      v18 = (void **)off_30148;
    }
LABEL_70:
    ++v19;
    v20 += 64i64;
    if ( v19 >= 0x4D )
      goto LABEL_71;
  }
  v18 = (void **)off_30148;
LABEL_99:
  if ( v18 != &off_30148 && (*((_BYTE *)v18 + 172) & 1) != 0 && *((_BYTE *)v18 + 169) )
  {
    v27 = 80;
    goto LABEL_103;
  }
  return 260i64;
}
// 221F5: variable 'v15' is possibly undefined
// 30148: using guessed type void *off_30148;
// 32FE0: using guessed type int dword_32FE0;
// 32FF0: using guessed type __int64 qword_32FF0;
// 33008: using guessed type int dword_33008;
// 3300C: using guessed type int dword_3300C;
// 33010: using guessed type char byte_33010;
// 33011: using guessed type char byte_33011;
// 33013: using guessed type char byte_33013;
// 33020: using guessed type __int64 qword_33020;

//----- (00000000000224DC) ----------------------------------------------------
__int64 sub_224DC()
{
  void **v0; // rcx
  unsigned int v2; // ebx
  __int64 v3; // rdx
  unsigned int v4; // eax
  PVOID v5; // rdi
  __int64 v6; // rax
  int v7; // esi
  int v8; // eax
  int v9; // er11
  char v10; // al
  __int64 v11; // rax
  __int64 v12; // r8
  int v13; // eax
  __int64 v14; // rdx
  __int64 v15; // [rsp+20h] [rbp-28h]
  __int64 v16; // [rsp+50h] [rbp+8h] BYREF

  v0 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x58u, (__int64)&unk_2EBF8);
    v0 = (void **)off_30148;
  }
  if ( !byte_33013 )
  {
    if ( v0 != &off_30148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 2u )
      sub_11008((__int64)v0[19], 0x59u, (__int64)&unk_2EBF8);
    return 260i64;
  }
  if ( v0 != &off_30148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 4u )
  {
    sub_147C8((__int64)v0[19], 0x5Au, (__int64)&unk_2EBF8, qword_32FF0);
    v0 = (void **)off_30148;
  }
  v2 = 0;
  if ( qword_32FF0 )
  {
    v3 = *(_QWORD *)(qword_32FF0 + 1112);
    if ( v3 )
    {
      v4 = (*(__int64 (__fastcall **)(__int64))(v3 + 88))(qword_32FF0);
      v0 = (void **)off_30148;
      v2 = v4;
    }
  }
  if ( v0 != &off_30148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 4u )
  {
    sub_1DC74((__int64)v0[19], 0x5Bu, (__int64)&unk_2EBF8, qword_32FE8, v2);
    v0 = (void **)off_30148;
  }
  v5 = qword_32FE8;
  v6 = 0i64;
  v7 = 1796;
  v16 = 0i64;
  if ( qword_32FE8 )
  {
    v8 = (*(__int64 (__fastcall **)(_QWORD, __int64, __int64 *))(*((_QWORD *)qword_32FE8 + 1) + 8i64))(
           **((_QWORD **)qword_32FE8 + 1),
           1i64,
           &v16);
    v0 = (void **)off_30148;
    v9 = v8;
    v6 = v16;
  }
  else
  {
    v9 = 1796;
  }
  if ( !v9 )
  {
    v10 = (*(__int64 (__fastcall **)(PVOID, _QWORD))(v6 + 80))(v5, v2);
    v0 = (void **)off_30148;
    if ( v10 )
    {
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
      {
        LODWORD(v15) = v2;
        sub_1DC74(*((_QWORD *)off_30148 + 19), 0x5Du, (__int64)&unk_2EBF8, qword_32FE8, v15);
        v0 = (void **)off_30148;
      }
      v11 = qword_32FF0;
      if ( qword_32FF0 )
      {
        v12 = *(_QWORD *)(qword_32FF0 + 1112);
        if ( v12 )
        {
          v13 = (*(__int64 (__fastcall **)(PVOID, __int64))(v12 + 16))(qword_32FE8, qword_32FF0);
          v0 = (void **)off_30148;
          v7 = v13;
          v11 = qword_32FF0;
        }
      }
      if ( v7 )
      {
        if ( v0 != &off_30148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 2u )
          sub_1102C((__int64)v0[19], 0x5Eu, (__int64)&unk_2EBF8, v7 != 0);
        return 257i64;
      }
      if ( v0 != &off_30148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 4u )
      {
        sub_11008((__int64)v0[19], 0x5Fu, (__int64)&unk_2EBF8);
        v0 = (void **)off_30148;
        v11 = qword_32FF0;
      }
      if ( !v11 )
        goto LABEL_52;
      v14 = *(_QWORD *)(v11 + 1112);
      if ( !v14 )
        goto LABEL_52;
      (*(void (__fastcall **)(__int64))(v14 + 32))(v11);
      goto LABEL_51;
    }
  }
  if ( v0 != &off_30148 )
  {
    if ( (*((_BYTE *)v0 + 172) & 1) == 0 || *((_BYTE *)v0 + 169) < 2u )
    {
LABEL_52:
      if ( v0 != &off_30148 && (*((_BYTE *)v0 + 172) & 1) != 0 && *((_BYTE *)v0 + 169) >= 4u )
        sub_147C8((__int64)v0[19], 0x60u, (__int64)&unk_2EBF8, qword_32FE8);
      goto LABEL_56;
    }
    sub_11008((__int64)v0[19], 0x5Cu, (__int64)&unk_2EBF8);
LABEL_51:
    v0 = (void **)off_30148;
    goto LABEL_52;
  }
LABEL_56:
  sub_2B100(qword_32FE8);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x61u, (__int64)&unk_2EBF8, 0);
  return 0i64;
}
// 226A4: variable 'v15' is possibly undefined
// 30148: using guessed type void *off_30148;
// 32FF0: using guessed type __int64 qword_32FF0;
// 33013: using guessed type char byte_33013;

//----- (000000000002283C) ----------------------------------------------------
__int64 __fastcall sub_2283C(int a1, const void *a2, unsigned int a3, __int64 a4, int *a5)
{
  unsigned int v5; // edi
  size_t v6; // rsi
  void **v9; // r10
  __int64 v10; // rdx
  int v11; // er9
  __int64 v12; // rax
  int v14; // eax
  void **v15; // rcx
  __int64 v16; // rdx
  int *v17; // rbx
  void **v18; // rcx
  char v19[8]; // [rsp+40h] [rbp-28h] BYREF
  __int64 v20; // [rsp+48h] [rbp-20h] BYREF
  int v21; // [rsp+70h] [rbp+8h] BYREF

  v5 = 0;
  v6 = a3;
  v20 = 0i64;
  v21 = 0;
  v9 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)off_30148 + 43, 0xAu) && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      sub_1DC14(*((_QWORD *)off_30148 + 19), 0x62u, (__int64)&unk_2EBF8, a1);
      v9 = (void **)off_30148;
    }
    if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 43, 0xAu) && *((_BYTE *)v9 + 169) >= 4u )
    {
      sub_20618((__int64)v9[19], 0x63u, (__int64)&unk_2EBF8, qword_32FE8, &unk_32BD0, v6, &v20);
      v9 = (void **)off_30148;
    }
  }
  v10 = *((_QWORD *)qword_32FF8 + 8 * (unsigned __int64)(unsigned int)(a1 - 40000) + 2);
  v20 = 0i64;
  if ( !qword_32FE8 )
  {
    v11 = 1799;
    goto LABEL_15;
  }
  if ( !v10 )
  {
    v11 = 1796;
    goto LABEL_15;
  }
  v12 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(*((_QWORD *)qword_32FE8 + 5) + 16i64))(
          **((_QWORD **)qword_32FE8 + 5),
          v10,
          (unsigned int)v6);
  v20 = v12;
  if ( !v12 )
  {
    v9 = (void **)off_30148;
    v11 = 1798;
LABEL_15:
    if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 43, 0xAu) && *((_BYTE *)v9 + 169) >= 2u )
      sub_1102C((__int64)v9[19], 0x64u, (__int64)&unk_2EBF8, v11);
    return 1i64;
  }
  memmove(*(void **)(v12 + 56), a2, v6);
  v14 = sub_2B170((__int64)qword_32FE8, v20);
  if ( v14 )
  {
    v15 = (void **)off_30148;
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x66u, (__int64)&unk_2EBF8, v14);
      v15 = (void **)off_30148;
    }
    v5 = 263;
  }
  else
  {
    v15 = (void **)off_30148;
  }
  v16 = v20;
  if ( qword_32FE8 && v20 )
  {
    v17 = a5;
    (*(void (__fastcall **)(_QWORD, __int64, int *, int *, char *, _QWORD))(*((_QWORD *)qword_32FE8 + 5) + 32i64))(
      **((_QWORD **)qword_32FE8 + 5),
      v20,
      &v21,
      a5,
      v19,
      0i64);
    v16 = v20;
  }
  else
  {
    if ( v15 != &off_30148 && _bittest((const signed __int32 *)v15 + 43, 0xAu) && *((_BYTE *)v15 + 169) >= 4u )
    {
      sub_11008((__int64)v15[19], 0x67u, (__int64)&unk_2EBF8);
      v16 = v20;
    }
    v17 = a5;
    *a5 = 0;
  }
  v18 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
    && *((_BYTE *)off_30148 + 169) >= 4u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x68u, (__int64)&unk_2EBF8, *v17);
    v16 = v20;
    v18 = (void **)off_30148;
  }
  if ( v16 && qword_32FE8 )
  {
    (*(void (__fastcall **)(_QWORD))(*((_QWORD *)qword_32FE8 + 5) + 24i64))(**((_QWORD **)qword_32FE8 + 5));
    v18 = (void **)off_30148;
  }
  if ( v18 != &off_30148 && _bittest((const signed __int32 *)v18 + 43, 0xAu) && *((_BYTE *)v18 + 169) >= 5u )
    sub_1102C((__int64)v18[19], 0x69u, (__int64)&unk_2EBF8, v5);
  return v5;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000022B50) ----------------------------------------------------
__int64 __fastcall sub_22B50(__int64 a1, void *a2, unsigned int a3, int a4, int *a5)
{
  size_t v6; // rdi
  unsigned int v7; // ebp
  PVOID v8; // rsi
  void *v9; // r12
  void **v10; // rcx
  __int64 v11; // rdx
  int v12; // er9
  __int64 v13; // rax
  int v15; // eax
  __int64 v16; // r8
  int *v17; // rbx
  void **v18; // rcx
  __int64 v19; // r9
  unsigned __int16 v20; // dx
  void *v21; // [rsp+20h] [rbp-58h]
  unsigned int v22; // [rsp+28h] [rbp-50h]
  int v23; // [rsp+40h] [rbp-38h] BYREF
  __int64 v24; // [rsp+48h] [rbp-30h] BYREF
  unsigned int v25; // [rsp+80h] [rbp+8h] BYREF

  v6 = a3;
  v7 = 0;
  v24 = 0i64;
  v23 = 0;
  v25 = 0;
  v8 = 0i64;
  v9 = a2;
  v10 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)off_30148 + 43, 0xAu) && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      v22 = a3;
      v21 = a2;
      sub_1DC14(*((_QWORD *)off_30148 + 19), 0x6Au, (__int64)&unk_2EBF8, 40040);
      v10 = (void **)off_30148;
    }
    if ( v10 != &off_30148 && _bittest((const signed __int32 *)v10 + 43, 0xAu) && *((_BYTE *)v10 + 169) >= 4u )
    {
      sub_20618((__int64)v10[19], 0x6Bu, (__int64)&unk_2EBF8, qword_32FE8, &unk_32BD0, v6, &v24);
      v10 = (void **)off_30148;
    }
  }
  v11 = *((_QWORD *)qword_32FF8 + 322);
  v24 = 0i64;
  if ( !qword_32FE8 )
  {
    v12 = 1799;
    goto LABEL_15;
  }
  if ( !v11 )
  {
    v12 = 1796;
    goto LABEL_15;
  }
  v13 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(*((_QWORD *)qword_32FE8 + 5) + 16i64))(
          **((_QWORD **)qword_32FE8 + 5),
          v11,
          (unsigned int)v6);
  v24 = v13;
  if ( !v13 )
  {
    v10 = (void **)off_30148;
    v12 = 1798;
LABEL_15:
    if ( v10 != &off_30148 && _bittest((const signed __int32 *)v10 + 43, 0xAu) && *((_BYTE *)v10 + 169) >= 2u )
      sub_1102C((__int64)v10[19], 0x6Cu, (__int64)&unk_2EBF8, v12);
    return 1i64;
  }
  if ( a4 )
  {
    *(_DWORD *)(v13 + 32) = a4;
    v13 = v24;
  }
  memmove(*(void **)(v13 + 56), v9, v6);
  v15 = sub_2B170((__int64)qword_32FE8, v24);
  if ( v15 )
  {
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x6Eu, (__int64)&unk_2EBF8, v15);
    }
    v7 = 263;
  }
  if ( qword_32FE8 && v24 )
  {
    v17 = a5;
    (*(void (__fastcall **)(_QWORD, __int64, int *, int *, unsigned int *, _QWORD))(*((_QWORD *)qword_32FE8 + 5) + 32i64))(
      **((_QWORD **)qword_32FE8 + 5),
      v24,
      &v23,
      a5,
      &v25,
      0i64);
  }
  else
  {
    v17 = a5;
    *a5 = 0;
  }
  v18 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
    && *((_BYTE *)off_30148 + 169) >= 4u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x6Fu, (__int64)&unk_2EBF8, *v17);
    v18 = (void **)off_30148;
  }
  if ( !qword_32FE8 )
  {
    v19 = 1799i64;
    goto LABEL_64;
  }
  if ( !v24 )
  {
    v19 = 1796i64;
    goto LABEL_64;
  }
  (*(void (__fastcall **)(_QWORD, __int64, int *, int *, unsigned int *, _QWORD))(*((_QWORD *)qword_32FE8 + 5) + 32i64))(
    **((_QWORD **)qword_32FE8 + 5),
    v24,
    &v23,
    v17,
    &v25,
    0i64);
  v19 = 0i64;
  if ( v25 )
  {
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
      && *((_BYTE *)off_30148 + 169) >= 4u )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x70u, (__int64)&unk_2EBF8, v25);
    }
    v22 = 0;
    v21 = 0i64;
    v8 = sub_1B038(2, v25, 0x726D624Eu);
    if ( v8 )
    {
      if ( !qword_32FE8 )
      {
        v19 = 1799i64;
        goto LABEL_50;
      }
      if ( !v24 )
      {
        v19 = 1796i64;
LABEL_50:
        v18 = (void **)off_30148;
        if ( off_30148 == &off_30148
          || !_bittest((const signed __int32 *)off_30148 + 43, 0xAu)
          || *((_BYTE *)off_30148 + 169) < 2u )
        {
          goto LABEL_69;
        }
        sub_1102C(*((_QWORD *)off_30148 + 19), 0x72u, (__int64)&unk_2EBF8, v19);
        goto LABEL_68;
      }
      (*(void (__fastcall **)(_QWORD, __int64, int *, int *, unsigned int *, PVOID))(*((_QWORD *)qword_32FE8 + 5) + 32i64))(
        **((_QWORD **)qword_32FE8 + 5),
        v24,
        &v23,
        v17,
        &v25,
        v8);
      v18 = (void **)off_30148;
      if ( off_30148 == &off_30148
        || !_bittest((const signed __int32 *)off_30148 + 43, 0xAu)
        || *((_BYTE *)off_30148 + 169) < 4u )
      {
        goto LABEL_69;
      }
      v20 = 113;
    }
    else
    {
      v18 = (void **)off_30148;
      if ( off_30148 == &off_30148
        || !_bittest((const signed __int32 *)off_30148 + 43, 0xAu)
        || *((_BYTE *)off_30148 + 169) < 2u )
      {
        goto LABEL_69;
      }
      v20 = 115;
    }
    sub_11008((__int64)v18[19], v20, (__int64)&unk_2EBF8);
    goto LABEL_68;
  }
  v18 = (void **)off_30148;
LABEL_64:
  if ( v18 == &off_30148 || !_bittest((const signed __int32 *)v18 + 43, 0xAu) || *((_BYTE *)v18 + 169) < 2u )
    goto LABEL_69;
  LODWORD(v21) = v25;
  sub_139F8((__int64)v18[19], 0x74u, (__int64)&unk_2EBF8, v19);
LABEL_68:
  v18 = (void **)off_30148;
LABEL_69:
  if ( sub_166E8 )
  {
    sub_166E8(v9, *(_QWORD *)(v24 + 56), v8);
    v18 = (void **)off_30148;
  }
  if ( v8 )
  {
    LODWORD(v21) = 0;
    sub_1B0BC(v8, 0x726D624Eu);
    v18 = (void **)off_30148;
  }
  if ( v24 && qword_32FE8 )
  {
    (*(void (__fastcall **)(_QWORD, __int64, __int64, __int64, void *, unsigned int))(*((_QWORD *)qword_32FE8 + 5)
                                                                                    + 24i64))(
      **((_QWORD **)qword_32FE8 + 5),
      v24,
      v16,
      v19,
      v21,
      v22);
    v18 = (void **)off_30148;
  }
  if ( v18 != &off_30148 && _bittest((const signed __int32 *)v18 + 43, 0xAu) && *((_BYTE *)v18 + 169) >= 5u )
    sub_1102C((__int64)v18[19], 0x75u, (__int64)&unk_2EBF8, v7);
  return v7;
}
// 2303D: variable 'v16' is possibly undefined
// 2303D: variable 'v19' is possibly undefined
// 2303D: variable 'v21' is possibly undefined
// 2303D: variable 'v22' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (000000000002309C) ----------------------------------------------------
__int64 __fastcall sub_2309C(int a1, const void *a2, unsigned int a3, _DWORD *a4)
{
  size_t v5; // rdi
  const void *v6; // rsi
  __int64 v8; // rdx
  int v9; // eax
  __int64 v10; // rax
  __int64 v11; // rbx
  void **v13; // rcx
  _QWORD *v14; // rdx
  int v15; // eax
  const void *v16; // [rsp+20h] [rbp-28h]

  v5 = a3;
  v6 = a2;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    v16 = a2;
    sub_1DC14(*((_QWORD *)off_30148 + 19), 0x7Eu, (__int64)&unk_2EBF8, a1);
  }
  *a4 = 0;
  v8 = *((_QWORD *)qword_32FF8 + 8 * (unsigned __int64)(unsigned int)(a1 - 40000) + 2);
  if ( !qword_32FE8 )
  {
    v9 = 1799;
LABEL_11:
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x7Fu, (__int64)&unk_2EBF8, v9);
    }
    return 1i64;
  }
  if ( !v8 )
  {
    v9 = 1796;
    goto LABEL_11;
  }
  v10 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(*((_QWORD *)qword_32FE8 + 5) + 16i64))(
          **((_QWORD **)qword_32FE8 + 5),
          v8,
          (unsigned int)v5);
  v11 = v10;
  if ( !v10 )
  {
    v9 = 1798;
    goto LABEL_11;
  }
  memmove(*(void **)(v10 + 56), v6, v5);
  v13 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
    && *((_BYTE *)off_30148 + 169) >= 4u )
  {
    sub_14D0C(*((_QWORD *)off_30148 + 19), 0x81u, (__int64)&unk_2EBF8, qword_32FE8, v11, sub_232F0);
    v13 = (void **)off_30148;
  }
  v14 = qword_32FE8;
  if ( !qword_32FE8 )
  {
    v15 = 1799;
LABEL_26:
    if ( v13 != &off_30148 && _bittest((const signed __int32 *)v13 + 43, 0xAu) && *((_BYTE *)v13 + 169) >= 2u )
    {
      sub_1102C((__int64)v13[19], 0x82u, (__int64)&unk_2EBF8, v15);
      v14 = qword_32FE8;
    }
    if ( v14 )
      (*(void (__fastcall **)(_QWORD, __int64))(v14[5] + 24i64))(*(_QWORD *)v14[5], v11);
    return 1i64;
  }
  if ( sub_232F0 )
  {
    LOBYTE(v16) = 0;
    v15 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, const void *, __int64 (__fastcall *)(__int64, __int64, __int64)))(*((_QWORD *)qword_32FE8 + 3) + 16i64))(
            **((_QWORD **)qword_32FE8 + 3),
            v11,
            0i64,
            0i64,
            v16,
            sub_232F0);
    v13 = (void **)off_30148;
    v14 = qword_32FE8;
  }
  else
  {
    v15 = 1796;
  }
  if ( v15 )
    goto LABEL_26;
  if ( v13 != &off_30148 && _bittest((const signed __int32 *)v13 + 43, 0xAu) && *((_BYTE *)v13 + 169) >= 5u )
    sub_1102C((__int64)v13[19], 0x83u, (__int64)&unk_2EBF8, 0);
  return 0i64;
}
// 23230: variable 'v16' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (00000000000232F0) ----------------------------------------------------
__int64 __fastcall sub_232F0(__int64 a1, __int64 a2, __int64 a3)
{
  unsigned int v3; // esi
  void **v7; // rcx
  void (__fastcall *v9)(_QWORD, _QWORD, _QWORD, int *); // rdi
  unsigned __int16 v10; // dx
  char v11[40]; // [rsp+40h] [rbp-28h] BYREF
  int v12; // [rsp+80h] [rbp+18h] BYREF
  char v13; // [rsp+88h] [rbp+20h] BYREF

  v3 = 0;
  v12 = 0;
  v7 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_14D0C(*((_QWORD *)off_30148 + 19), 0x84u, (__int64)&unk_2EBF8, a1, a2, a3);
    v7 = (void **)off_30148;
  }
  if ( a3 )
  {
    if ( a2 )
    {
      v9 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, int *))(a2 + 8);
      if ( v9 )
      {
        if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 0xAu) && *((_BYTE *)v7 + 169) >= 4u )
        {
          sub_20684((__int64)v7[19], 134i64, (__int64)&unk_2EBF8, qword_32FE8, a3, &v13, &v12);
          v7 = (void **)off_30148;
        }
        if ( qword_32FE8 )
        {
          (*(void (__fastcall **)(_QWORD, __int64, char *, int *, char *, _QWORD))(*((_QWORD *)qword_32FE8 + 5) + 32i64))(
            **((_QWORD **)qword_32FE8 + 5),
            a3,
            &v13,
            &v12,
            v11,
            0i64);
        }
        else
        {
          v3 = 1799;
          if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 0xAu) && *((_BYTE *)v7 + 169) >= 2u )
            sub_1102C((__int64)v7[19], 0x87u, (__int64)&unk_2EBF8, 1799);
        }
        v9(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), &v12);
        if ( qword_32FE8 )
          (*(void (__fastcall **)(_QWORD, __int64))(*((_QWORD *)qword_32FE8 + 5) + 24i64))(
            **((_QWORD **)qword_32FE8 + 5),
            a3);
        goto LABEL_34;
      }
      if ( v7 != &off_30148 )
      {
        if ( _bittest((const signed __int32 *)v7 + 43, 0xAu) && *((_BYTE *)v7 + 169) >= 2u )
        {
          v10 = 136;
LABEL_33:
          sub_11008((__int64)v7[19], v10, (__int64)&unk_2EBF8);
LABEL_34:
          v7 = (void **)off_30148;
          goto LABEL_35;
        }
        goto LABEL_35;
      }
    }
    else if ( v7 != &off_30148 )
    {
      if ( _bittest((const signed __int32 *)v7 + 43, 0xAu) && *((_BYTE *)v7 + 169) >= 2u )
      {
        v10 = 137;
        goto LABEL_33;
      }
LABEL_35:
      if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 0xAu) && *((_BYTE *)v7 + 169) >= 5u )
        sub_1102C((__int64)v7[19], 0x8Au, (__int64)&unk_2EBF8, v3);
      return v3;
    }
    return v3;
  }
  if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 0xAu) && *((_BYTE *)v7 + 169) >= 2u )
    sub_11008((__int64)v7[19], 0x85u, (__int64)&unk_2EBF8);
  return 3899654172i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000023548) ----------------------------------------------------
__int64 __fastcall sub_23548(unsigned int *a1)
{
  void **v2; // rcx
  __int64 result; // rax

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x8Bu, (__int64)&unk_2EBF8);
    v2 = (void **)off_30148;
  }
  qword_33020 = 0i64;
  qword_33028 = 0i64;
  qword_33030 = 0i64;
  qword_33020 = *a1;
  HIDWORD(qword_33020) = *((unsigned __int8 *)a1 + 4);
  qword_33028 = *((_QWORD *)a1 + 1);
  if ( *((_QWORD *)a1 + 2) )
  {
    qword_33030 = (__int64)sub_236A4;
    qword_33018 = (__int64 (__fastcall *)(_QWORD))*((_QWORD *)a1 + 2);
    if ( v2 != &off_30148 )
    {
      if ( (*((_BYTE *)v2 + 172) & 1) != 0 && *((_BYTE *)v2 + 169) >= 4u )
      {
        sub_11008((__int64)v2[19], 0x8Cu, (__int64)&unk_2EBF8);
        v2 = (void **)off_30148;
      }
      if ( v2 != &off_30148 && (*((_BYTE *)v2 + 172) & 1) != 0 && *((_BYTE *)v2 + 169) >= 5u )
        sub_1102C((__int64)v2[19], 0x8Eu, (__int64)&unk_2EBF8, 0);
    }
    result = 0i64;
  }
  else
  {
    if ( v2 != &off_30148 && (*((_BYTE *)v2 + 172) & 1) != 0 && *((_BYTE *)v2 + 169) >= 2u )
      sub_11008((__int64)v2[19], 0x8Du, (__int64)&unk_2EBF8);
    result = 264i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;
// 33018: using guessed type __int64 (__fastcall *qword_33018)(_QWORD);
// 33020: using guessed type __int64 qword_33020;
// 33028: using guessed type __int64 qword_33028;
// 33030: using guessed type __int64 qword_33030;

//----- (00000000000236A4) ----------------------------------------------------
__int64 __fastcall sub_236A4(__int64 a1, __int64 a2, __int64 a3)
{
  void **v4; // rcx

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)off_30148 + 43, 8u) && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      sub_11008(*((_QWORD *)off_30148 + 19), 0x8Fu, (__int64)&unk_2EBF8);
      v4 = (void **)off_30148;
    }
    if ( v4 != &off_30148 && _bittest((const signed __int32 *)v4 + 43, 8u) && *((_BYTE *)v4 + 169) >= 4u )
    {
      sub_147C8((__int64)v4[19], 0x90u, (__int64)&unk_2EBF8, a3);
      v4 = (void **)off_30148;
    }
  }
  if ( qword_33018 )
  {
    qword_33018(a3);
    v4 = (void **)off_30148;
  }
  if ( v4 != &off_30148 && _bittest((const signed __int32 *)v4 + 43, 8u) && *((_BYTE *)v4 + 169) >= 5u )
    sub_1102C((__int64)v4[19], 0x91u, (__int64)&unk_2EBF8, 0);
  return 0i64;
}
// 30148: using guessed type void *off_30148;
// 33018: using guessed type __int64 (__fastcall *qword_33018)(_QWORD);

//----- (0000000000023790) ----------------------------------------------------
__int64 __fastcall sub_23790(__int64 a1, int a2, unsigned int a3, void *a4)
{
  unsigned int v8; // ebx
  void **v9; // rcx
  _DWORD *v11; // rdi
  __int64 v12; // r8
  int v13; // eax

  v8 = 6;
  v9 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 8u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_139F8(*((_QWORD *)off_30148 + 19), 0x92u, (__int64)&unk_2EBF8, a2);
    v9 = (void **)off_30148;
  }
  if ( !byte_33013 )
  {
    if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 43, 8u) && *((_BYTE *)v9 + 169) >= 2u )
      sub_11008((__int64)v9[19], 0x93u, (__int64)&unk_2EBF8);
    return 260i64;
  }
  v11 = *(_DWORD **)(a1 + 56);
  if ( v11 )
  {
    if ( a2 && v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 43, 8u) && *((_BYTE *)v9 + 169) >= 3u )
    {
      sub_1102C((__int64)v9[19], 0x94u, (__int64)&unk_2EBF8, a2);
      v9 = (void **)off_30148;
    }
    v12 = a2 != 0 ? 0x80000000 : 0;
    if ( *v11 == 3 || *v11 == 8 )
    {
      v13 = sub_2B1B4((__int64)qword_32FE8, a1, v12, a3, a4);
    }
    else
    {
      if ( !qword_32FE8 )
      {
        v13 = 1799;
        goto LABEL_24;
      }
      v13 = (*(__int64 (__fastcall **)(_QWORD, __int64, __int64, _QWORD, _QWORD))(*((_QWORD *)qword_32FE8 + 3) + 24i64))(
              **((_QWORD **)qword_32FE8 + 3),
              a1,
              v12,
              0i64,
              0i64);
    }
    v9 = (void **)off_30148;
LABEL_24:
    if ( v13 )
    {
      if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 43, 8u) && *((_BYTE *)v9 + 169) >= 2u )
      {
        sub_1102C((__int64)v9[19], 0x95u, (__int64)&unk_2EBF8, v13);
        v9 = (void **)off_30148;
      }
      v8 = 273;
    }
    else
    {
      v8 = 0;
    }
  }
  if ( v9 != &off_30148 && _bittest((const signed __int32 *)v9 + 43, 8u) && *((_BYTE *)v9 + 169) >= 5u )
    sub_1102C((__int64)v9[19], 0x96u, (__int64)&unk_2EBF8, v8);
  return v8;
}
// 30148: using guessed type void *off_30148;
// 33013: using guessed type char byte_33013;

//----- (000000000002398C) ----------------------------------------------------
__int64 __fastcall sub_2398C(__int64 a1, __int64 a2, __int64 a3)
{
  void **v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, _QWORD, __int64, unsigned int *); // rax
  unsigned int v8; // ebx
  unsigned int v9; // eax
  unsigned __int16 v11; // dx
  unsigned int v12; // [rsp+58h] [rbp+20h] BYREF

  v12 = 3;
  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)off_30148 + 43, 0xAu) && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      sub_14D0C(*((_QWORD *)off_30148 + 19), 0x97u, (__int64)&unk_2EBF8, a1, a2, a3);
      v6 = (void **)off_30148;
    }
    if ( v6 != &off_30148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 4u )
    {
      sub_1102C((__int64)v6[19], 0x98u, (__int64)&unk_2EBF8, *(_DWORD *)a3);
      v6 = (void **)off_30148;
    }
  }
  if ( !byte_33014 )
  {
    if ( v6 != &off_30148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 3u )
      sub_11008((__int64)v6[19], 0x99u, (__int64)&unk_2EBF8);
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 != &off_30148 )
    {
      if ( !_bittest((const signed __int32 *)v6 + 43, 0xAu) || *((_BYTE *)v6 + 169) < 2u )
        goto LABEL_37;
      v11 = 157;
LABEL_36:
      sub_11008((__int64)v6[19], v11, (__int64)&unk_2EBF8);
      v6 = (void **)off_30148;
      goto LABEL_37;
    }
    return 0i64;
  }
  v7 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, __int64, unsigned int *))(a2 + 8);
  if ( !v7 )
  {
    if ( v6 != &off_30148 )
    {
      if ( !_bittest((const signed __int32 *)v6 + 43, 0xAu) || *((_BYTE *)v6 + 169) < 2u )
        goto LABEL_37;
      v11 = 156;
      goto LABEL_36;
    }
    return 0i64;
  }
  v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), a3, &v12);
  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
    && *((_BYTE *)off_30148 + 169) >= 4u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x9Au, (__int64)&unk_2EBF8, v12);
    v6 = (void **)off_30148;
  }
  if ( !qword_32FE8 )
  {
    v8 = 1799;
    goto LABEL_23;
  }
  v9 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, _QWORD))(*((_QWORD *)qword_32FE8 + 3) + 24i64))(
         **((_QWORD **)qword_32FE8 + 3),
         a3,
         v12,
         0i64,
         0i64);
  v6 = (void **)off_30148;
  v8 = v9;
  if ( !v9 )
  {
LABEL_37:
    if ( v6 != &off_30148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 5u )
      sub_1102C((__int64)v6[19], 0x9Eu, (__int64)&unk_2EBF8, 0);
    return 0i64;
  }
LABEL_23:
  if ( v6 != &off_30148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 2u )
    sub_1102C((__int64)v6[19], 0x9Bu, (__int64)&unk_2EBF8, v8);
  return v8;
}
// 30148: using guessed type void *off_30148;
// 33014: using guessed type char byte_33014;

//----- (0000000000023C00) ----------------------------------------------------
__int64 __fastcall sub_23C00(__int64 a1, __int64 a2, __int64 a3)
{
  void **v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, _QWORD, unsigned int *, PVOID *, __int64 *); // rax
  void **v8; // rcx
  int v9; // eax
  unsigned int v10; // ebx
  unsigned __int16 v12; // dx
  __int64 v13; // [rsp+20h] [rbp-28h]
  __int64 Tag; // [rsp+30h] [rbp-18h] BYREF
  PVOID P[2]; // [rsp+38h] [rbp-10h] BYREF
  unsigned int v16; // [rsp+68h] [rbp+20h] BYREF

  P[0] = 0i64;
  v16 = 0;
  LODWORD(Tag) = 0;
  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)off_30148 + 43, 0xAu) && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      sub_14D0C(*((_QWORD *)off_30148 + 19), 0x9Fu, (__int64)&unk_2EBF8, a1, a2, a3, Tag);
      v6 = (void **)off_30148;
    }
    if ( v6 != &off_30148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 4u )
    {
      sub_1102C((__int64)v6[19], 0xA0u, (__int64)&unk_2EBF8, *(_DWORD *)a3);
      v6 = (void **)off_30148;
    }
  }
  if ( !byte_33014 )
  {
    if ( v6 != &off_30148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 3u )
      sub_11008((__int64)v6[19], 0xA1u, (__int64)&unk_2EBF8);
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 == &off_30148 )
      return 0i64;
    if ( !_bittest((const signed __int32 *)v6 + 43, 0xAu) || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_46;
    v12 = 167;
    goto LABEL_44;
  }
  v7 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, unsigned int *, PVOID *, __int64 *))(a2 + 16);
  if ( !v7 )
  {
    if ( v6 == &off_30148 )
      return 0i64;
    if ( !_bittest((const signed __int32 *)v6 + 43, 0xAu) || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_46;
    v12 = 166;
LABEL_44:
    sub_11008((__int64)v6[19], v12, (__int64)&unk_2EBF8);
    goto LABEL_45;
  }
  v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), &v16, P, &Tag);
  v8 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( _bittest((const signed __int32 *)off_30148 + 43, 0xAu) && *((_BYTE *)off_30148 + 169) >= 4u )
    {
      sub_1102C(*((_QWORD *)off_30148 + 19), 0xA2u, (__int64)&unk_2EBF8, 5);
      v8 = (void **)off_30148;
    }
    if ( v8 != &off_30148 && _bittest((const signed __int32 *)v8 + 43, 0xAu) && *((_BYTE *)v8 + 169) >= 4u )
      sub_1102C((__int64)v8[19], 0xA3u, (__int64)&unk_2EBF8, v16);
  }
  v9 = sub_2B1B4((__int64)qword_32FE8, a3, 5i64, v16, P[0]);
  v10 = v9;
  if ( !v9 )
  {
    if ( !P[0] || !v16 )
      goto LABEL_45;
    LODWORD(v13) = 0;
    sub_1B0BC(P[0], Tag);
    v6 = (void **)off_30148;
    if ( off_30148 != &off_30148 )
    {
      if ( _bittest((const signed __int32 *)off_30148 + 43, 0xAu) && *((_BYTE *)off_30148 + 169) >= 4u )
      {
        sub_147C8(*((_QWORD *)off_30148 + 19), 0xA5u, (__int64)&unk_2EBF8, P[0], v13);
LABEL_45:
        v6 = (void **)off_30148;
      }
LABEL_46:
      if ( v6 != &off_30148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 5u )
        sub_1102C((__int64)v6[19], 0xA8u, (__int64)&unk_2EBF8, 0);
    }
    return 0i64;
  }
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0xAu)
    && *((_BYTE *)off_30148 + 169) >= 2u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0xA4u, (__int64)&unk_2EBF8, v9);
  }
  return v10;
}
// 23E6F: variable 'v13' is possibly undefined
// 30148: using guessed type void *off_30148;
// 33014: using guessed type char byte_33014;

//----- (0000000000023F18) ----------------------------------------------------
__int64 __fastcall sub_23F18(__int64 a1, __int64 a2, __int64 a3)
{
  void **v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, __int64, __int64); // rax
  unsigned __int16 v8; // dx

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      sub_14D0C(*((_QWORD *)off_30148 + 19), 0xF7u, (__int64)&unk_2EBF8, a1, a2, a3);
      v6 = (void **)off_30148;
    }
    if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 1) != 0 && *((_BYTE *)v6 + 169) >= 4u )
    {
      sub_1102C((__int64)v6[19], 0xF8u, (__int64)&unk_2EBF8, *(_DWORD *)a3);
      v6 = (void **)off_30148;
    }
  }
  if ( !byte_33014 )
  {
    if ( v6 != &off_30148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 3u )
      sub_11008((__int64)v6[19], 0xF9u, (__int64)&unk_2EBF8);
    return 0i64;
  }
  if ( a2 )
  {
    v7 = *(void (__fastcall **)(_QWORD, _QWORD, __int64, __int64))(a2 + 24);
    if ( v7 )
    {
      v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), 1024i64, a1);
      v6 = (void **)off_30148;
      if ( off_30148 == &off_30148 )
        return 0i64;
      if ( (*((_BYTE *)off_30148 + 172) & 1) == 0 || *((_BYTE *)off_30148 + 169) < 4u )
        goto LABEL_30;
      sub_1102C(*((_QWORD *)off_30148 + 19), 0xFAu, (__int64)&unk_2EBF8, 3);
      goto LABEL_29;
    }
    if ( v6 == &off_30148 )
      return 0i64;
    if ( (*((_BYTE *)v6 + 172) & 1) == 0 || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_30;
    v8 = 251;
  }
  else
  {
    if ( v6 == &off_30148 )
      return 0i64;
    if ( (*((_BYTE *)v6 + 172) & 1) == 0 || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_30;
    v8 = 252;
  }
  sub_11008((__int64)v6[19], v8, (__int64)&unk_2EBF8);
LABEL_29:
  v6 = (void **)off_30148;
LABEL_30:
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 1) != 0 && *((_BYTE *)v6 + 169) >= 5u )
    sub_1102C((__int64)v6[19], 0xFDu, (__int64)&unk_2EBF8, 0);
  return 0i64;
}
// 2401B: variable 'a1' is possibly undefined
// 30148: using guessed type void *off_30148;
// 33014: using guessed type char byte_33014;

//----- (00000000000240F8) ----------------------------------------------------
__int64 __fastcall sub_240F8(int a1)
{
  void **v2; // rcx
  __int64 result; // rax
  int v4; // eax
  unsigned int v5; // ebx

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xFEu, (__int64)&unk_2EBF8);
    v2 = (void **)off_30148;
  }
  if ( byte_33012 )
  {
    v4 = sub_209E8(a1, 2);
    v5 = v4;
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x100u, (__int64)&unk_2EBF8, v4);
    result = v5;
  }
  else
  {
    if ( v2 != &off_30148 && (*((_BYTE *)v2 + 172) & 1) != 0 && *((_BYTE *)v2 + 169) >= 2u )
      sub_11008((__int64)v2[19], 0xFFu, (__int64)&unk_2EBF8);
    result = 258i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;
// 33012: using guessed type char byte_33012;

//----- (00000000000241E8) ----------------------------------------------------
__int64 __fastcall sub_241E8(int a1, __int64 a2)
{
  void **v4; // rcx
  __int64 result; // rax
  _QWORD *v6; // rax
  _QWORD *v7; // rcx
  void **v8; // rcx

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x101u, (__int64)&unk_2EBF8);
    v4 = (void **)off_30148;
  }
  if ( byte_33012 )
  {
    if ( !dword_3300C )
    {
      qword_32BC8 = (__int64)&qword_32BC0;
      qword_32BC0 = &qword_32BC0;
    }
    v6 = sub_1B038(2, 0x48u, 0x746D436Eu);
    if ( v6 )
    {
      v6[4] = 0i64;
      v6[6] = 0i64;
      *((_DWORD *)v6 + 4) = a1;
      v6[7] = a2;
      *((_DWORD *)v6 + 6) = 1;
      *((_DWORD *)v6 + 7) = 4;
      v6[8] = &qword_32BB0;
      v7 = (_QWORD *)qword_32BC8;
      *v6 = &qword_32BC0;
      v6[1] = v7;
      *v7 = v6;
      ++dword_3300C;
      qword_32BC8 = (__int64)v6;
      v8 = (void **)off_30148;
      if ( off_30148 != &off_30148 )
      {
        if ( (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
        {
          sub_1102C(*((_QWORD *)off_30148 + 19), 0x104u, (__int64)&unk_2EBF8, a1);
          v8 = (void **)off_30148;
        }
        if ( v8 != &off_30148 && (*((_BYTE *)v8 + 172) & 1) != 0 && *((_BYTE *)v8 + 169) >= 5u )
          sub_1102C((__int64)v8[19], 0x105u, (__int64)&unk_2EBF8, 0);
      }
      result = 0i64;
    }
    else
    {
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 2u )
        sub_11008(*((_QWORD *)off_30148 + 19), 0x103u, (__int64)&unk_2EBF8);
      result = 3i64;
    }
  }
  else
  {
    if ( v4 != &off_30148 && (*((_BYTE *)v4 + 172) & 1) != 0 && *((_BYTE *)v4 + 169) >= 2u )
      sub_11008((__int64)v4[19], 0x102u, (__int64)&unk_2EBF8);
    result = 258i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;
// 32BC8: using guessed type __int64 qword_32BC8;
// 3300C: using guessed type int dword_3300C;
// 33012: using guessed type char byte_33012;

//----- (00000000000243E0) ----------------------------------------------------
__int64 __fastcall sub_243E0(int a1, const void *a2, unsigned int a3)
{
  unsigned int v3; // ebx
  size_t v4; // rsi
  void **v7; // r10
  unsigned int v9; // edi
  __int64 v10; // rdx
  __int64 v11; // rax
  __int64 v12; // rcx
  unsigned __int16 v13; // dx
  int v14; // eax
  void **v15; // rcx
  __int64 v16; // [rsp+78h] [rbp+20h] BYREF

  v3 = 0;
  v4 = a3;
  v16 = 0i64;
  v7 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0xDu)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x10Bu, (__int64)&unk_2EBF8);
    v7 = (void **)off_30148;
  }
  if ( !byte_33013 )
  {
    if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 0xDu) && *((_BYTE *)v7 + 169) >= 2u )
      sub_11008((__int64)v7[19], 0x10Cu, (__int64)&unk_2EBF8);
    return 260i64;
  }
  v9 = a1 - 40000;
  if ( v9 <= 0x4D )
  {
    if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 0xDu) && *((_BYTE *)v7 + 169) >= 4u )
    {
      sub_20618((__int64)v7[19], 0x10Eu, (__int64)&unk_2EBF8, qword_32FE8, &unk_32BD0, v4, &v16);
      v7 = (void **)off_30148;
    }
    v10 = *((_QWORD *)qword_32FF8 + 8 * (unsigned __int64)v9 + 2);
    v16 = 0i64;
    if ( qword_32FE8 )
    {
      if ( v10 )
      {
        v11 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD))(*((_QWORD *)qword_32FE8 + 5) + 16i64))(
                **((_QWORD **)qword_32FE8 + 5),
                v10,
                (unsigned int)v4);
        v16 = v11;
        if ( v11 )
        {
          memmove(*(void **)(v11 + 56), a2, v4);
          if ( off_30148 != &off_30148
            && _bittest((const signed __int32 *)off_30148 + 43, 0xDu)
            && *((_BYTE *)off_30148 + 169) >= 4u )
          {
            sub_14CC4(*((_QWORD *)off_30148 + 19), 0x111u, (__int64)&unk_2EBF8, qword_32FE8, v16);
          }
          v14 = sub_2B170((__int64)qword_32FE8, v16);
          if ( v14 )
          {
            v15 = (void **)off_30148;
            if ( off_30148 != &off_30148
              && _bittest((const signed __int32 *)off_30148 + 43, 0xDu)
              && *((_BYTE *)off_30148 + 169) >= 2u )
            {
              sub_1102C(*((_QWORD *)off_30148 + 19), 0x112u, (__int64)&unk_2EBF8, v14);
              v15 = (void **)off_30148;
            }
            v3 = 263;
          }
          else
          {
            v15 = (void **)off_30148;
          }
          if ( v16 )
          {
            if ( qword_32FE8 )
            {
              (*(void (__fastcall **)(_QWORD))(*((_QWORD *)qword_32FE8 + 5) + 24i64))(**((_QWORD **)qword_32FE8 + 5));
              v15 = (void **)off_30148;
            }
            v16 = 0i64;
          }
          if ( v15 == &off_30148 || !_bittest((const signed __int32 *)v15 + 43, 0xDu) || *((_BYTE *)v15 + 169) < 5u )
            return v3;
          v12 = (__int64)v15[19];
          v13 = 275;
          goto LABEL_50;
        }
        v7 = (void **)off_30148;
        v3 = 1798;
      }
      else
      {
        v3 = 1796;
      }
    }
    else
    {
      v3 = 1799;
    }
    if ( v7 == &off_30148 || !_bittest((const signed __int32 *)v7 + 43, 0xDu) || *((_BYTE *)v7 + 169) < 2u )
      return v3;
    v12 = (__int64)v7[19];
    v13 = 271;
LABEL_50:
    sub_1102C(v12, v13, (__int64)&unk_2EBF8, v3);
    return v3;
  }
  if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 0xDu) && *((_BYTE *)v7 + 169) >= 2u )
    sub_11008((__int64)v7[19], 0x10Du, (__int64)&unk_2EBF8);
  return 261i64;
}
// 30148: using guessed type void *off_30148;
// 33013: using guessed type char byte_33013;

//----- (00000000000246EC) ----------------------------------------------------
__int64 __fastcall sub_246EC(__int64 a1, __int64 a2, __int64 a3)
{
  void **v6; // rcx
  void (__fastcall *v7)(_QWORD, _QWORD, _QWORD, __int64); // rax
  unsigned __int16 v8; // dx

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      sub_14D0C(*((_QWORD *)off_30148 + 19), 0x114u, (__int64)&unk_2EBF8, a1, a2, a3);
      v6 = (void **)off_30148;
    }
    if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 1) != 0 && *((_BYTE *)v6 + 169) >= 4u )
    {
      sub_1102C((__int64)v6[19], 0x115u, (__int64)&unk_2EBF8, *(_DWORD *)a3);
      v6 = (void **)off_30148;
    }
  }
  if ( !byte_33014 )
  {
    if ( v6 != &off_30148 && _bittest((const signed __int32 *)v6 + 43, 0xAu) && *((_BYTE *)v6 + 169) >= 3u )
      sub_11008((__int64)v6[19], 0x116u, (__int64)&unk_2EBF8);
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 == &off_30148 )
      return 0i64;
    if ( (*((_BYTE *)v6 + 172) & 1) == 0 || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_27;
    v8 = 280;
    goto LABEL_25;
  }
  v7 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, __int64))(a2 + 32);
  if ( !v7 )
  {
    if ( v6 == &off_30148 )
      return 0i64;
    if ( (*((_BYTE *)v6 + 172) & 1) == 0 || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_27;
    v8 = 279;
LABEL_25:
    sub_11008((__int64)v6[19], v8, (__int64)&unk_2EBF8);
    goto LABEL_26;
  }
  v7(*(unsigned int *)(a3 + 8), *(_QWORD *)(a3 + 56), *(unsigned int *)(a3 + 28), a1);
LABEL_26:
  v6 = (void **)off_30148;
LABEL_27:
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 1) != 0 && *((_BYTE *)v6 + 169) >= 5u )
    sub_1102C((__int64)v6[19], 0x119u, (__int64)&unk_2EBF8, 0);
  return 0i64;
}
// 247ED: variable 'a1' is possibly undefined
// 30148: using guessed type void *off_30148;
// 33014: using guessed type char byte_33014;

//----- (0000000000024890) ----------------------------------------------------
__int64 sub_24890()
{
  unsigned int v0; // ebx
  void **v1; // rcx
  int v2; // eax

  v0 = 0;
  v1 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x11Au, (__int64)&unk_2EBF8);
    v1 = (void **)off_30148;
  }
  if ( qword_33038 )
    goto LABEL_12;
  v2 = sub_2136C(9u, (__int64)&qword_33038);
  v0 = v2;
  if ( !v2 )
    goto LABEL_11;
  v1 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v0;
  if ( (*((_BYTE *)off_30148 + 172) & 1) != 0 && *((_BYTE *)off_30148 + 169) >= 2u )
  {
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x11Bu, (__int64)&unk_2EBF8, v2);
LABEL_11:
    v1 = (void **)off_30148;
  }
LABEL_12:
  if ( v1 != &off_30148 && (*((_BYTE *)v1 + 172) & 1) != 0 && *((_BYTE *)v1 + 169) >= 5u )
    sub_1102C((__int64)v1[19], 0x11Cu, (__int64)&unk_2EBF8, v0);
  return v0;
}
// 30148: using guessed type void *off_30148;
// 33038: using guessed type __int64 qword_33038;

//----- (0000000000024988) ----------------------------------------------------
__int64 __fastcall sub_24988(__int64 a1, _QWORD *a2, unsigned int *a3)
{
  unsigned int v6; // ebx
  void **v7; // rcx
  int v8; // eax
  char v9; // di
  void **v10; // rcx
  PVOID v11; // rax
  int v12; // eax

  v6 = 0;
  v7 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0x13u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x122u, (__int64)&unk_2EBF8);
    v7 = (void **)off_30148;
  }
  if ( a2 && a3 )
  {
    *a2 = 0i64;
    *a3 = 0;
    if ( !qword_33038 )
    {
      v7 = (void **)off_30148;
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 43, 0x13u)
        && *((_BYTE *)off_30148 + 169) >= 2u )
      {
        sub_11008(*((_QWORD *)off_30148 + 19), 0x124u, (__int64)&unk_2EBF8);
        v7 = (void **)off_30148;
      }
      v6 = 258;
      goto LABEL_74;
    }
    v8 = (*(__int64 (__fastcall **)(__int64, _QWORD, unsigned int *))qword_33038)(a1, 0i64, a3);
    if ( v8 && v8 != 1800 )
    {
      v7 = (void **)off_30148;
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 43, 0x13u)
        && *((_BYTE *)off_30148 + 169) >= 2u )
      {
        sub_1102C(*((_QWORD *)off_30148 + 19), 0x125u, (__int64)&unk_2EBF8, v8);
        v7 = (void **)off_30148;
      }
      v6 = 276;
      goto LABEL_74;
    }
    v9 = (*(__int64 (__fastcall **)(__int64))(qword_33038 + 8))(a1);
    if ( (v9 & 1) != 0 )
    {
      v10 = (void **)off_30148;
      if ( off_30148 == &off_30148
        || !_bittest((const signed __int32 *)off_30148 + 43, 0x13u)
        || *((_BYTE *)off_30148 + 169) < 5u )
      {
        goto LABEL_26;
      }
      sub_11008(*((_QWORD *)off_30148 + 19), 0x126u, (__int64)&unk_2EBF8);
    }
    v10 = (void **)off_30148;
LABEL_26:
    if ( (v9 & 2) != 0
      && v10 != &off_30148
      && _bittest((const signed __int32 *)v10 + 43, 0x13u)
      && *((_BYTE *)v10 + 169) >= 5u )
    {
      sub_11008((__int64)v10[19], 0x127u, (__int64)&unk_2EBF8);
      v10 = (void **)off_30148;
    }
    if ( (v9 & 4) != 0
      && v10 != &off_30148
      && _bittest((const signed __int32 *)v10 + 43, 0x13u)
      && *((_BYTE *)v10 + 169) >= 5u )
    {
      sub_11008((__int64)v10[19], 0x128u, (__int64)&unk_2EBF8);
      v10 = (void **)off_30148;
    }
    if ( (v9 & 8) != 0
      && v10 != &off_30148
      && _bittest((const signed __int32 *)v10 + 43, 0x13u)
      && *((_BYTE *)v10 + 169) >= 5u )
    {
      sub_11008((__int64)v10[19], 0x129u, (__int64)&unk_2EBF8);
      v10 = (void **)off_30148;
    }
    if ( (v9 & 0x10) != 0
      && v10 != &off_30148
      && _bittest((const signed __int32 *)v10 + 43, 0x13u)
      && *((_BYTE *)v10 + 169) >= 5u )
    {
      sub_11008((__int64)v10[19], 0x12Au, (__int64)&unk_2EBF8);
      v10 = (void **)off_30148;
    }
    if ( (v9 & 0x20) != 0
      && v10 != &off_30148
      && _bittest((const signed __int32 *)v10 + 43, 0x13u)
      && *((_BYTE *)v10 + 169) >= 5u )
    {
      sub_11008((__int64)v10[19], 0x12Bu, (__int64)&unk_2EBF8);
      v10 = (void **)off_30148;
    }
    if ( (v9 & 0x40) != 0
      && v10 != &off_30148
      && _bittest((const signed __int32 *)v10 + 43, 0x13u)
      && *((_BYTE *)v10 + 169) >= 5u )
    {
      sub_11008((__int64)v10[19], 0x12Cu, (__int64)&unk_2EBF8);
    }
    v11 = sub_1B038(1, *a3, 0x666E4950u);
    *a2 = v11;
    if ( v11 )
    {
      memset(v11, 0, *a3);
      v12 = (*(__int64 (__fastcall **)(__int64, _QWORD, unsigned int *))qword_33038)(a1, *a2, a3);
      if ( v12 )
      {
        v7 = (void **)off_30148;
        if ( off_30148 != &off_30148
          && _bittest((const signed __int32 *)off_30148 + 43, 0x13u)
          && *((_BYTE *)off_30148 + 169) >= 2u )
        {
          sub_1102C(*((_QWORD *)off_30148 + 19), 0x12Eu, (__int64)&unk_2EBF8, v12);
          v7 = (void **)off_30148;
        }
        v6 = 275;
      }
      else
      {
        v7 = (void **)off_30148;
      }
    }
    else
    {
      v7 = (void **)off_30148;
      if ( off_30148 != &off_30148
        && _bittest((const signed __int32 *)off_30148 + 43, 0x13u)
        && *((_BYTE *)off_30148 + 169) >= 2u )
      {
        sub_11008(*((_QWORD *)off_30148 + 19), 0x12Du, (__int64)&unk_2EBF8);
        v7 = (void **)off_30148;
      }
      v6 = 3;
    }
    goto LABEL_74;
  }
  if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 0x13u) && *((_BYTE *)v7 + 169) >= 2u )
  {
    sub_14CC4((__int64)v7[19], 0x123u, (__int64)&unk_2EBF8, a2, a3);
    v7 = (void **)off_30148;
  }
  v6 = 4;
LABEL_74:
  if ( v7 != &off_30148 && _bittest((const signed __int32 *)v7 + 43, 0x13u) && *((_BYTE *)v7 + 169) >= 5u )
    sub_1102C((__int64)v7[19], 0x12Fu, (__int64)&unk_2EBF8, v6);
  return v6;
}
// 30148: using guessed type void *off_30148;
// 33038: using guessed type __int64 qword_33038;

//----- (0000000000024DCC) ----------------------------------------------------
__int64 __fastcall sub_24DCC(PVOID *a1)
{
  unsigned int v2; // ebx
  void **v3; // rcx

  v2 = 0;
  v3 = (void **)off_30148;
  if ( off_30148 != &off_30148
    && _bittest((const signed __int32 *)off_30148 + 43, 0x13u)
    && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x130u, (__int64)&unk_2EBF8);
    v3 = (void **)off_30148;
  }
  if ( a1 && *a1 )
  {
    sub_1B0BC(*a1, 0x666E4950u);
    *a1 = 0i64;
    v3 = (void **)off_30148;
  }
  else
  {
    if ( v3 != &off_30148 && _bittest((const signed __int32 *)v3 + 43, 0x13u) && *((_BYTE *)v3 + 169) >= 2u )
    {
      sub_147C8((__int64)v3[19], 0x131u, (__int64)&unk_2EBF8, a1);
      v3 = (void **)off_30148;
    }
    v2 = 4;
  }
  if ( v3 != &off_30148 && _bittest((const signed __int32 *)v3 + 43, 0x13u) && *((_BYTE *)v3 + 169) >= 5u )
    sub_1102C((__int64)v3[19], 0x132u, (__int64)&unk_2EBF8, v2);
  return v2;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000024EDC) ----------------------------------------------------
__int64 __fastcall sub_24EDC(__int64 a1, _BYTE *a2)
{
  __int64 v2; // rax
  __int64 result; // rax
  const char *v6; // rax

  v2 = qword_33038;
  if ( qword_33038 )
  {
    *a2 = 0;
    if ( ((*(__int64 (**)(void))(v2 + 8))() & 3) != 0 )
      *a2 = 1;
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 0x13u)
      && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      v6 = "not";
      if ( *a2 )
        v6 = (const char *)&unk_2ECDA;
      sub_206F0(*((_QWORD *)off_30148 + 19), 0x134u, (__int64)&unk_2EBF8, a1, v6);
    }
    result = 0i64;
  }
  else
  {
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 0x13u)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_11008(*((_QWORD *)off_30148 + 19), 0x133u, (__int64)&unk_2EBF8);
    }
    result = 258i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;
// 33038: using guessed type __int64 qword_33038;

//----- (0000000000024FB8) ----------------------------------------------------
__int64 __fastcall sub_24FB8(__int64 a1, _BYTE *a2)
{
  __int64 v2; // rax
  __int64 result; // rax
  const char *v6; // rax

  v2 = qword_33038;
  if ( qword_33038 )
  {
    *a2 = 0;
    if ( ((*(__int64 (**)(void))(v2 + 8))() & 0x40) != 0 )
      *a2 = 1;
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 0x13u)
      && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      v6 = "not";
      if ( *a2 )
        v6 = (const char *)&unk_2ECDA;
      sub_206F0(*((_QWORD *)off_30148 + 19), 0x136u, (__int64)&unk_2EBF8, a1, v6);
    }
    result = 0i64;
  }
  else
  {
    if ( off_30148 != &off_30148
      && _bittest((const signed __int32 *)off_30148 + 43, 0x13u)
      && *((_BYTE *)off_30148 + 169) >= 2u )
    {
      sub_11008(*((_QWORD *)off_30148 + 19), 0x135u, (__int64)&unk_2EBF8);
    }
    result = 258i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;
// 33038: using guessed type __int64 qword_33038;

//----- (0000000000025094) ----------------------------------------------------
bool __fastcall sub_25094(__int64 a1)
{
  bool v3; // bl

  if ( !a1 )
    return 0;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
    sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x1Du);
  v3 = sub_1C854((struct _KEVENT **)(a1 + 56), 1);
  sub_1BD50(a1);
  *(_DWORD *)(a1 + 64) = 0;
  *(_DWORD *)(a1 + 68) = 0;
  *(_BYTE *)(a1 + 72) = 0;
  return v3;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000025138) ----------------------------------------------------
void __fastcall sub_25138(__int64 a1)
{
  void *v1; // rbx

  if ( a1 )
  {
    v1 = *(void **)(a1 + 56);
    *(_DWORD *)(a1 + 68) = 0;
    if ( v1 )
    {
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
        sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x1Eu);
      sub_1C93C(v1);
    }
  }
}
// 30148: using guessed type void *off_30148;

//----- (00000000000251B0) ----------------------------------------------------
char __fastcall sub_251B0(PFAST_MUTEX FastMutex)
{
  char result; // al

  result = 0;
  if ( FastMutex && !LODWORD(FastMutex[1].Owner) && !LOBYTE(FastMutex[1].Contention) && !HIDWORD(FastMutex[1].Owner) )
  {
    sub_1BE30(FastMutex);
    sub_1BC1C(*(PRKEVENT *)&FastMutex[1].Count);
    LOBYTE(FastMutex[1].Contention) = 1;
    sub_1BEFC(FastMutex);
    result = 1;
  }
  return result;
}

//----- (0000000000025210) ----------------------------------------------------
char __fastcall sub_25210(PFAST_MUTEX FastMutex)
{
  void *v3; // rbx

  if ( !FastMutex )
    return 0;
  if ( LOBYTE(FastMutex[1].Contention) )
  {
    sub_1BE30(FastMutex);
    LOBYTE(FastMutex[1].Contention) = 0;
    sub_1BEFC(FastMutex);
    v3 = *(void **)&FastMutex[1].Count;
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 108) & 0x20) != 0 && *((_BYTE *)off_30148 + 105) >= 4u )
      sub_1AFB8(*((_QWORD *)off_30148 + 11), 0x32u);
    sub_1D754(v3);
  }
  return 1;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000252B8) ----------------------------------------------------
char __fastcall sub_252B8(PFAST_MUTEX FastMutex)
{
  char v1; // di
  struct _KEVENT *v4; // rcx

  v1 = 0;
  if ( !FastMutex )
    return 0;
  sub_1BE30(FastMutex);
  if ( LOBYTE(FastMutex[1].Contention) )
  {
    v4 = *(struct _KEVENT **)&FastMutex[1].Count;
    ++LODWORD(FastMutex[1].Owner);
    sub_1BC84(v4);
    v1 = 1;
  }
  sub_1BEFC(FastMutex);
  return v1;
}

//----- (0000000000025320) ----------------------------------------------------
char __fastcall sub_25320(PFAST_MUTEX FastMutex)
{
  if ( !FastMutex || !*(_QWORD *)&FastMutex[1].Count || !LODWORD(FastMutex[1].Owner) )
    return 0;
  sub_1BE30(FastMutex);
  if ( LODWORD(FastMutex[1].Owner)-- == 1 )
    sub_1BC1C(*(PRKEVENT *)&FastMutex[1].Count);
  sub_1BEFC(FastMutex);
  return 1;
}

//----- (0000000000025384) ----------------------------------------------------
const char *__fastcall sub_25384(int a1)
{
  const char *result; // rax

  if ( !(_WORD)a1 )
    return "UNKNOWN";
  switch ( (unsigned __int16)a1 )
  {
    case 1u:
      return "W_ALLOW";
    case 2u:
      return "W_DENY";
    case 3u:
      return "S_ALLOW";
  }
  if ( (unsigned __int16)a1 != 4 )
  {
    if ( (unsigned __int16)a1 == 5 )
      return "NOT_PROCESSED";
    return "UNKNOWN";
  }
  if ( _bittest(&a1, 0x1Eu) )
    result = "S_DENY_PENDING";
  else
    result = "S_DENY";
  return result;
}

//----- (00000000000253E8) ----------------------------------------------------
const char *__fastcall sub_253E8(unsigned int a1)
{
  switch ( a1 )
  {
    case 0u:
      return "UNKNOWN";
    case 1u:
      return "ICMP";
    case 6u:
      return "TCP";
    case 0x11u:
      return "UDP";
    case 0x3Au:
      return "ICMPV6";
  }
  sub_2B518(byte_303C8, 4ui64, "%d", a1);
  return byte_303C8;
}

//----- (0000000000025460) ----------------------------------------------------
const char *__fastcall sub_25460(int a1)
{
  __int64 v1; // r9
  int v3; // ecx
  int v4; // ecx
  int v5; // ecx
  int v6; // ecx

  v1 = (unsigned int)a1;
  if ( a1 <= 5 )
  {
    switch ( a1 )
    {
      case 5:
        return "HTTPS";
      case 0:
        return "UNKNOWN";
      case 1:
        return "PENDING";
      case 2:
        return "DNS";
      case 3:
        return "DHCP";
      case 4:
        return "HTTP";
    }
    goto LABEL_19;
  }
  v3 = a1 - 7;
  if ( !v3 )
    return "SMTP";
  v4 = v3 - 1;
  if ( !v4 )
    return "FTP";
  v5 = v4 - 1;
  if ( !v5 )
    return "POP3";
  v6 = v5 - 1;
  if ( !v6 )
    return "PAP";
  if ( v6 != 1 )
  {
LABEL_19:
    sub_2B518(byte_303C0, 4ui64, "%d", v1);
    return byte_303C0;
  }
  return "DHCPV6";
}

//----- (0000000000025538) ----------------------------------------------------
const char *__fastcall sub_25538(unsigned int a1)
{
  switch ( a1 )
  {
    case 0u:
      return "UNKNOWN";
    case 0x800u:
      return "IPv4";
    case 0x806u:
      return "ARP";
    case 0x8035u:
      return "RARP";
    case 0x86DDu:
      return "IPv6";
  }
  sub_2B518(byte_303C4, 4ui64, "%d", a1);
  return byte_303C4;
}

//----- (00000000000255BC) ----------------------------------------------------
const char *__fastcall sub_255BC(int a1)
{
  int v1; // ecx
  int v2; // ecx
  int v3; // ecx
  int v4; // ecx

  if ( !a1 )
    return "NONE";
  v1 = a1 - 1;
  if ( !v1 )
    return "PROCESS";
  v2 = v1 - 1;
  if ( !v2 )
    return "ISOLATION_SYSTEM";
  v3 = v2 - 1;
  if ( !v3 )
    return "ISOLATION_PANDA";
  v4 = v3 - 1;
  if ( !v4 )
    return "ISOLATION_PANDA_FRIEND";
  if ( v4 == 1 )
    return "ISOLATION_CLIENT";
  return "UNKNOWN";
}

//----- (0000000000025618) ----------------------------------------------------
__int64 __fastcall sub_25618(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+168h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EBE8, 119i64, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002575C) ----------------------------------------------------
__int64 __fastcall sub_2575C(__int64 a1, __int64 a2, __int64 a3, int a4, const char *a5, const char *a6)
{
  int v8; // [rsp+88h] [rbp+20h] BYREF

  v8 = a4;
  if ( a6 )
    strlen(a6);
  if ( a5 )
    strlen(a5);
  return qword_30398(a1, 43i64, &unk_2EBE8, 336i64, &v8);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000025824) ----------------------------------------------------
__int64 __fastcall sub_25824(__int64 a1, unsigned __int16 a2, __int64 a3, int a4, const char *a5)
{
  int v7; // [rsp+78h] [rbp+20h] BYREF

  v7 = a4;
  if ( a5 )
    strlen(a5);
  return qword_30398(a1, 43i64, &unk_2EBE8, a2, &v7);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000258AC) ----------------------------------------------------
__int64 sub_258AC(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_30398(a1, 43i64, &unk_2EBE8, a2, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002590C) ----------------------------------------------------
__int64 __fastcall sub_2590C(_BYTE *a1, _BYTE *a2)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_14CC4(*((_QWORD *)off_30148 + 19), 0x37u, (__int64)&unk_2EBE8, a1, a2);
  *a2 = *a1 >> 4;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x38u, (__int64)&unk_2EBE8);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000259BC) ----------------------------------------------------
__int64 __fastcall sub_259BC(__int64 a1, _DWORD *a2)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_14CC4(*((_QWORD *)off_30148 + 19), 0x4Bu, (__int64)&unk_2EBE8, a1, a2);
  *a2 = *(_DWORD *)(a1 + 12);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x4Cu, (__int64)&unk_2EBE8);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000025A6C) ----------------------------------------------------
__int64 __fastcall sub_25A6C(__int64 a1, _DWORD *a2)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_14CC4(*((_QWORD *)off_30148 + 19), 0x4Du, (__int64)&unk_2EBE8, a1, a2);
  *a2 = *(_DWORD *)(a1 + 16);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x4Eu, (__int64)&unk_2EBE8);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000025B1C) ----------------------------------------------------
__int64 __fastcall sub_25B1C(__int64 a1, _DWORD *a2)
{
  unsigned __int16 v5; // [rsp+38h] [rbp+10h] BYREF

  v5 = 0;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_147C8(*((_QWORD *)off_30148 + 19), 0x51u, (__int64)&unk_2EBE8, a1);
  sub_25BE0(a1, &v5);
  *a2 = v5 + 40;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x52u, (__int64)&unk_2EBE8);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000025BE0) ----------------------------------------------------
__int64 __fastcall sub_25BE0(__int64 a1, unsigned __int16 *a2)
{
  unsigned __int16 v4; // dx

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_14CC4(*((_QWORD *)off_30148 + 19), 0x68u, (__int64)&unk_2EBE8, a1, a2);
  v4 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 4)) | ((unsigned __int8)*(_WORD *)(a1 + 4) << 8);
  *a2 = v4;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x69u, (__int64)&unk_2EBE8, v4);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000025CA8) ----------------------------------------------------
__int64 __fastcall sub_25CA8(__int64 a1, unsigned __int8 *a2)
{
  unsigned __int8 v4; // al

  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_14CC4(*((_QWORD *)off_30148 + 19), 0x6Au, (__int64)&unk_2EBE8, a1, a2);
  v4 = *(_BYTE *)(a1 + 6);
  *a2 = v4;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x6Bu, (__int64)&unk_2EBE8, v4);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000025D5C) ----------------------------------------------------
__int64 __fastcall sub_25D5C(__int64 a1, __m128i *a2)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_14CC4(*((_QWORD *)off_30148 + 19), 0x6Eu, (__int64)&unk_2EBE8, a1, a2);
  *a2 = _mm_loadu_si128((const __m128i *)(a1 + 8));
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x6Fu, (__int64)&unk_2EBE8);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000025E10) ----------------------------------------------------
__int64 __fastcall sub_25E10(__int64 a1, __m128i *a2)
{
  __int64 v4; // rdx
  int v5; // eax
  void **v6; // rcx
  unsigned __int64 v8; // [rsp+30h] [rbp-38h] BYREF
  _BYTE v9[40]; // [rsp+38h] [rbp-30h] BYREF

  v8 = 0i64;
  memset(v9, 0, sizeof(v9));
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_14CC4(*((_QWORD *)off_30148 + 19), 0x70u, (__int64)&unk_2EBE8, a1, a2);
  LOBYTE(v4) = 43;
  if ( (unsigned int)sub_26D04(a1, v4, &v8) )
    goto LABEL_11;
  v5 = sub_25F6C(&v8, a2);
  if ( v5 )
  {
    v6 = (void **)off_30148;
    if ( off_30148 == &off_30148 )
    {
LABEL_16:
      *a2 = _mm_loadu_si128((const __m128i *)(a1 + 24));
      goto LABEL_17;
    }
    if ( (*((_BYTE *)off_30148 + 172) & 0x20) == 0 || *((_BYTE *)off_30148 + 169) < 5u )
    {
LABEL_12:
      if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x20) != 0 && *((_BYTE *)v6 + 169) >= 5u )
        sub_11008((__int64)v6[19], 0x72u, (__int64)&unk_2EBE8);
      goto LABEL_16;
    }
    sub_1102C(*((_QWORD *)off_30148 + 19), 0x71u, (__int64)&unk_2EBE8, v5);
LABEL_11:
    v6 = (void **)off_30148;
    goto LABEL_12;
  }
LABEL_17:
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x73u, (__int64)&unk_2EBE8);
  return 0i64;
}
// 25E8A: variable 'v4' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (0000000000025F6C) ----------------------------------------------------
__int64 __fastcall sub_25F6C(_BYTE *a1, __m128i *a2)
{
  __m128i *v2; // r12
  const __m128i *v4; // r15
  unsigned __int8 v5; // di
  void **v6; // rcx
  bool v7; // bp
  const char *v8; // r8
  __int64 v9; // rcx
  const char *v10; // rax
  unsigned int v11; // ebx
  unsigned __int8 v12; // di
  __int64 v13; // rax
  unsigned __int16 v14; // r9
  unsigned __int16 v15; // ax
  unsigned __int16 v17; // [rsp+F0h] [rbp+8h]
  __m128i *v18; // [rsp+F8h] [rbp+10h]
  const __m128i *v19; // [rsp+108h] [rbp+20h]

  v18 = a2;
  v2 = a2;
  v4 = 0i64;
  v19 = 0i64;
  v5 = -1;
  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x74u, (__int64)&unk_2EBE8);
    v6 = (void **)off_30148;
  }
  v7 = 0;
  if ( *(_QWORD *)a1 )
  {
    v5 = *(_BYTE *)(*(_QWORD *)a1 + 2i64);
    if ( !v5 || v5 > 1u && v5 <= 3u )
      v7 = 1;
  }
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x20) != 0 && *((_BYTE *)v6 + 169) >= 5u )
  {
    if ( v5 )
    {
      switch ( v5 )
      {
        case 1u:
          v8 = "NIMROD";
          break;
        case 2u:
          v8 = "MOBILITY";
          break;
        case 3u:
          v8 = "RPL";
          break;
        case 4u:
          v8 = "SEGMENT";
          break;
        case 0xFDu:
          v8 = "EXP_1";
          break;
        case 0xFEu:
          v8 = "EXP_2";
          break;
        default:
          v8 = "UNKNOWN";
          break;
      }
    }
    else
    {
      v8 = "SOURCE_ROUTE";
    }
    v9 = (__int64)v6[19];
    v10 = "NOT";
    if ( v7 )
      v10 = (const char *)&unk_2ECDA;
    sub_2575C(v9, 336i64, (__int64)&unk_2EBE8, v5, v8, v10);
    v6 = (void **)off_30148;
  }
  if ( v7 )
  {
    if ( *(_QWORD *)a1 && *(_BYTE *)(*(_QWORD *)a1 + 3i64) )
    {
      v12 = (unsigned __int8)(a1[24] - 8) >> 4;
      if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x20) != 0 && *((_BYTE *)v6 + 169) >= 5u )
      {
        sub_11008((__int64)v6[19], 0x76u, (__int64)&unk_2EBE8);
        v6 = (void **)off_30148;
      }
      v13 = *(_QWORD *)a1;
      if ( *(_QWORD *)a1 )
      {
        v4 = (const __m128i *)(v13 + 8);
        v19 = (const __m128i *)(v13 + 8);
      }
      v14 = 0;
      v17 = 0;
      if ( v12 )
      {
        do
        {
          if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x20) != 0 && *((_BYTE *)v6 + 169) >= 5u )
          {
            v4 = v19;
            sub_25618(*((_QWORD *)off_30148 + 19), 119i64, (__int64)&unk_2EBE8, v17);
            v6 = (void **)off_30148;
            v14 = v17;
            v2 = v18;
          }
          ++v14;
          v15 = v12;
          v17 = v14;
          if ( v14 == v12 )
          {
            if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x20) != 0 && *((_BYTE *)v6 + 169) >= 5u )
            {
              sub_11008((__int64)v6[19], 0x78u, (__int64)&unk_2EBE8);
              v14 = v17;
              v15 = v12;
            }
            *v2 = _mm_loadu_si128(v4);
          }
          else
          {
            v19 = ++v4;
          }
          v6 = (void **)off_30148;
        }
        while ( v14 < v15 );
      }
      v11 = 0;
      *v2 = _mm_loadu_si128(v4);
    }
    else
    {
      if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x20) != 0 && *((_BYTE *)v6 + 169) >= 5u )
        sub_11008((__int64)v6[19], 0x75u, (__int64)&unk_2EBE8);
      v11 = 6;
    }
  }
  else
  {
    v11 = 18;
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x79u, (__int64)&unk_2EBE8);
  return v11;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000263D8) ----------------------------------------------------
__int64 __fastcall sub_263D8(_WORD *a1, _WORD *a2)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_14CC4(*((_QWORD *)off_30148 + 19), 0x7Au, (__int64)&unk_2EBE8, a1, a2);
  *a2 = (unsigned __int8)HIBYTE(*a1) | ((unsigned __int8)*a1 << 8);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x7Bu, (__int64)&unk_2EBE8);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (000000000002649C) ----------------------------------------------------
__int64 __fastcall sub_2649C(__int64 a1, _WORD *a2)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_14CC4(*((_QWORD *)off_30148 + 19), 0x7Cu, (__int64)&unk_2EBE8, a1, a2);
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 2)) | ((unsigned __int8)*(_WORD *)(a1 + 2) << 8);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x7Du, (__int64)&unk_2EBE8);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000026560) ----------------------------------------------------
__int64 __fastcall sub_26560(_WORD *a1, _WORD *a2)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_14CC4(*((_QWORD *)off_30148 + 19), 0xB3u, (__int64)&unk_2EBE8, a1, a2);
  *a2 = (unsigned __int8)HIBYTE(*a1) | ((unsigned __int8)*a1 << 8);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0xB4u, (__int64)&unk_2EBE8);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000026624) ----------------------------------------------------
__int64 __fastcall sub_26624(__int64 a1, _WORD *a2)
{
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_14CC4(*((_QWORD *)off_30148 + 19), 0xB5u, (__int64)&unk_2EBE8, a1, a2);
  *a2 = (unsigned __int8)HIBYTE(*(_WORD *)(a1 + 2)) | ((unsigned __int8)*(_WORD *)(a1 + 2) << 8);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0xB6u, (__int64)&unk_2EBE8);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000266E8) ----------------------------------------------------
__int64 __fastcall sub_266E8(__int64 a1, int a2, __int64 a3)
{
  void **v6; // rcx
  int v7; // eax
  unsigned int v8; // edi
  __int64 v9; // rax
  int v11; // [rsp+28h] [rbp-10h]

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x116u, (__int64)&unk_2EBE8);
    v6 = (void **)off_30148;
  }
  if ( a1 && a3 && a2 )
  {
    *(_QWORD *)a3 = a1 + 40;
    sub_25CA8(a1, (unsigned __int8 *)(a3 + 8));
    v7 = sub_26A94(a1, a2, a3);
    v8 = v7;
    if ( v7 )
    {
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 2u )
        sub_1102C(*((_QWORD *)off_30148 + 19), 0x118u, (__int64)&unk_2EBE8, v7);
      v8 = 0;
    }
    v9 = *(_QWORD *)a3;
    *(_QWORD *)(a3 + 32) = a1;
    *(_BYTE *)(a3 + 40) = -1;
    *(_QWORD *)(a3 + 16) = v9 + 2;
    sub_27050(a3);
    v6 = (void **)off_30148;
  }
  else
  {
    if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x20) != 0 && *((_BYTE *)v6 + 169) >= 2u )
    {
      v11 = a2;
      sub_258AC((__int64)v6[19], 0x117u, (__int64)&unk_2EBE8, a1, a3, v11);
      v6 = (void **)off_30148;
    }
    v8 = 4;
  }
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x20) != 0 && *((_BYTE *)v6 + 169) >= 5u )
    sub_11008((__int64)v6[19], 0x119u, (__int64)&unk_2EBE8);
  return v8;
}
// 30148: using guessed type void *off_30148;

//----- (000000000002687C) ----------------------------------------------------
__int64 __fastcall sub_2687C(__int64 a1, unsigned int a2, unsigned __int16 *a3)
{
  __int64 v3; // rbx
  void **v6; // r10
  unsigned int v7; // ebx
  char v8; // al
  int v9; // eax
  int v11; // [rsp+28h] [rbp-40h]
  __int64 Src; // [rsp+30h] [rbp-38h] BYREF
  __int64 v13[5]; // [rsp+38h] [rbp-30h] BYREF

  Src = 0i64;
  v3 = a2;
  memset(v13, 0, sizeof(v13));
  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x11Au, (__int64)&unk_2EBE8);
    v6 = (void **)off_30148;
  }
  if ( a1 && a3 && (_DWORD)v3 )
  {
    if ( *(_QWORD *)a3 + (unsigned __int64)a3[12] < v3 + a1 - 1 )
    {
      v8 = **(_BYTE **)a3;
      Src = *(_QWORD *)a3 + a3[12];
      LOBYTE(v13[0]) = v8;
      v9 = sub_26A94(a1, v3, (__int64)&Src);
      v7 = v9;
      if ( v9 )
      {
        if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 3u )
          sub_1102C(*((_QWORD *)off_30148 + 19), 0x11Du, (__int64)&unk_2EBE8, v9);
        v7 = 0;
      }
      v13[1] = Src + 2;
      v13[3] = *(_QWORD *)a3;
      LOBYTE(v13[4]) = *((_BYTE *)a3 + 8);
      memmove(a3, &Src, 0x30ui64);
      sub_27050((__int64)a3);
      v6 = (void **)off_30148;
    }
    else
    {
      if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x20) != 0 && *((_BYTE *)v6 + 169) >= 3u )
      {
        sub_11008((__int64)v6[19], 0x11Cu, (__int64)&unk_2EBE8);
        v6 = (void **)off_30148;
      }
      v7 = 10;
    }
  }
  else
  {
    if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x20) != 0 && *((_BYTE *)v6 + 169) >= 2u )
    {
      v11 = v3;
      sub_258AC((__int64)v6[19], 0x11Bu, (__int64)&unk_2EBE8, a1, a3, v11, Src);
      v6 = (void **)off_30148;
    }
    v7 = 4;
  }
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x20) != 0 && *((_BYTE *)v6 + 169) >= 5u )
    sub_11008((__int64)v6[19], 0x11Eu, (__int64)&unk_2EBE8);
  return v7;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000026A94) ----------------------------------------------------
__int64 __fastcall sub_26A94(__int64 a1, int a2, __int64 a3)
{
  unsigned int v5; // esi
  void **v7; // rcx
  __int16 v8; // cx

  v5 = 0;
  v7 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x11Fu, (__int64)&unk_2EBE8);
    v7 = (void **)off_30148;
  }
  if ( !a1 || !a3 || !a2 )
  {
    if ( v7 != &off_30148 && (*((_BYTE *)v7 + 172) & 0x20) != 0 && *((_BYTE *)v7 + 169) >= 2u )
    {
      sub_258AC((__int64)v7[19], 0x120u, (__int64)&unk_2EBE8, a1, a3, a2);
      v7 = (void **)off_30148;
    }
    v5 = 4;
    goto LABEL_39;
  }
  if ( v7 != &off_30148 && (*((_BYTE *)v7 + 172) & 0x20) != 0 && *((_BYTE *)v7 + 169) >= 5u )
  {
    sub_1102C((__int64)v7[19], 0x121u, (__int64)&unk_2EBE8, *(unsigned __int8 *)(a3 + 8));
    v7 = (void **)off_30148;
  }
  switch ( *(_BYTE *)(a3 + 8) )
  {
    case 0:
      goto LABEL_28;
    case 6:
    case 0x11:
LABEL_27:
      *(_WORD *)(a3 + 24) = a1 + a2 - *(_WORD *)a3;
      goto LABEL_30;
    case 0x2B:
LABEL_28:
      v8 = 8 * (*(unsigned __int8 *)(*(_QWORD *)a3 + 1i64) + 1);
      goto LABEL_29;
  }
  if ( *(_BYTE *)(a3 + 8) != 44 )
  {
    if ( *(_BYTE *)(a3 + 8) == 51 )
    {
      v8 = 4 * *(unsigned __int8 *)(*(_QWORD *)a3 + 1i64) + 2;
LABEL_29:
      *(_WORD *)(a3 + 24) = v8;
      goto LABEL_30;
    }
    if ( *(_BYTE *)(a3 + 8) != 58 )
    {
      if ( *(_BYTE *)(a3 + 8) != 60 )
      {
        if ( v7 != &off_30148 && (*((_BYTE *)v7 + 172) & 0x20) != 0 && *((_BYTE *)v7 + 169) >= 5u )
          sub_1102C((__int64)v7[19], 0x122u, (__int64)&unk_2EBE8, *(unsigned __int8 *)(a3 + 8));
        v5 = 5;
        *(_WORD *)(a3 + 24) = 0;
        goto LABEL_30;
      }
      goto LABEL_28;
    }
    goto LABEL_27;
  }
  *(_WORD *)(a3 + 24) = 8;
LABEL_30:
  *(_WORD *)(a3 + 26) = *(_WORD *)a3 - a1;
  v7 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v5;
  if ( (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_139F8(*((_QWORD *)off_30148 + 19), 0x123u, (__int64)&unk_2EBE8, *(unsigned __int16 *)(a3 + 24));
    v7 = (void **)off_30148;
  }
LABEL_39:
  if ( v7 != &off_30148 && (*((_BYTE *)v7 + 172) & 0x20) != 0 && *((_BYTE *)v7 + 169) >= 5u )
    sub_11008((__int64)v7[19], 0x124u, (__int64)&unk_2EBE8);
  return v5;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000026D04) ----------------------------------------------------
__int64 __fastcall sub_26D04(__int64 a1, __int64 a2, unsigned __int64 *a3)
{
  unsigned int v3; // ebx
  void **v6; // r10
  const char *v7; // rax
  __int64 v8; // r10
  int v9; // eax
  unsigned __int16 v10; // dx
  unsigned __int8 v11; // cl
  unsigned __int64 v12; // rbp
  unsigned __int16 v13; // dx
  __int64 Src; // [rsp+30h] [rbp-48h] BYREF
  char v16[40]; // [rsp+38h] [rbp-40h] BYREF
  unsigned int v17; // [rsp+80h] [rbp+8h] BYREF

  v3 = 0;
  Src = 0i64;
  memset(v16, 0, sizeof(v16));
  v17 = 0;
  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x125u, (__int64)&unk_2EBE8);
    v6 = (void **)off_30148;
  }
  if ( !a1 || !a3 )
  {
    if ( v6 == &off_30148 || (*((_BYTE *)v6 + 172) & 0x20) == 0 || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_57;
    sub_14CC4((__int64)v6[19], 0x126u, (__int64)&unk_2EBE8, a1, a3);
    goto LABEL_56;
  }
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x20) != 0 && *((_BYTE *)v6 + 169) >= 4u )
  {
    v7 = sub_27398(0x2Bu);
    sub_25824(*(_QWORD *)(v8 + 152), 0x127u, (__int64)&unk_2EBE8, 43, v7);
  }
  sub_25B1C(a1, &v17);
  v9 = sub_266E8(a1, v17, (__int64)&Src);
  if ( v9 )
  {
    v6 = (void **)off_30148;
    if ( off_30148 == &off_30148 || (*((_BYTE *)off_30148 + 172) & 0x20) == 0 || *((_BYTE *)off_30148 + 169) < 2u )
      goto LABEL_57;
    v10 = 296;
LABEL_16:
    sub_1102C((__int64)v6[19], v10, (__int64)&unk_2EBE8, v9);
    goto LABEL_56;
  }
  v11 = v16[0];
  if ( v16[0] == 59 )
  {
LABEL_56:
    v6 = (void **)off_30148;
    goto LABEL_57;
  }
  v12 = v17 + a1 - 1;
  while ( 1 )
  {
    if ( *a3 >= v12 )
    {
      v6 = (void **)off_30148;
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 3u )
      {
        v13 = 297;
        goto LABEL_38;
      }
      goto LABEL_57;
    }
    if ( v11 == 43 )
    {
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
        sub_11008(*((_QWORD *)off_30148 + 19), 0x12Au, (__int64)&unk_2EBE8);
      memmove(a3, &Src, 0x30ui64);
      v6 = (void **)off_30148;
      goto LABEL_58;
    }
    if ( (v11 > 0x3Cu || v11 != 60 && v11 && (v11 <= 0x2Au || v11 > 0x2Cu && (v11 == 50 || v11 != 51)))
      && v11 != 6
      && v11 != 17
      && v11 != 58 )
    {
      v6 = (void **)off_30148;
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 3u )
      {
        v13 = 299;
LABEL_38:
        sub_11008((__int64)v6[19], v13, (__int64)&unk_2EBE8);
        goto LABEL_56;
      }
      goto LABEL_57;
    }
    v9 = sub_2687C(a1, v17, (unsigned __int16 *)&Src);
    if ( v9 )
      break;
    v11 = v16[0];
    if ( v16[0] == 59 )
      goto LABEL_56;
  }
  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
  {
    v10 = 300;
    goto LABEL_16;
  }
LABEL_57:
  v3 = 5;
LABEL_58:
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x20) != 0 && *((_BYTE *)v6 + 169) >= 5u )
    sub_11008((__int64)v6[19], 0x12Du, (__int64)&unk_2EBE8);
  return v3;
}
// 26DB9: variable 'v8' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (0000000000027050) ----------------------------------------------------
__int64 __fastcall sub_27050(__int64 a1)
{
  unsigned int v1; // edi
  void **v3; // r10
  const char *v4; // rax
  __int64 v5; // r10
  int v6; // er9

  v1 = 0;
  if ( !a1 )
    return 4;
  v3 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    {
      sub_11008(*((_QWORD *)off_30148 + 19), 0x136u, (__int64)&unk_2EBE8);
      v3 = (void **)off_30148;
    }
    if ( v3 != &off_30148 )
    {
      if ( (*((_BYTE *)v3 + 172) & 0x20) != 0 && *((_BYTE *)v3 + 169) >= 5u )
      {
        sub_147C8((__int64)v3[19], 0x137u, (__int64)&unk_2EBE8, *(_QWORD *)a1);
        v3 = (void **)off_30148;
      }
      if ( v3 != &off_30148 )
      {
        if ( (*((_BYTE *)v3 + 172) & 0x20) != 0 && *((_BYTE *)v3 + 169) >= 5u )
        {
          v4 = sub_27398(*(_BYTE *)(a1 + 8));
          sub_25824(*(_QWORD *)(v5 + 152), 0x138u, (__int64)&unk_2EBE8, v6, v4);
          v3 = (void **)off_30148;
        }
        if ( v3 != &off_30148 )
        {
          if ( (*((_BYTE *)v3 + 172) & 0x20) != 0 && *((_BYTE *)v3 + 169) >= 5u )
          {
            sub_1102C((__int64)v3[19], 0x139u, (__int64)&unk_2EBE8, *(unsigned __int16 *)(a1 + 24));
            v3 = (void **)off_30148;
          }
          if ( v3 != &off_30148 )
          {
            if ( (*((_BYTE *)v3 + 172) & 0x20) != 0 && *((_BYTE *)v3 + 169) >= 5u )
            {
              sub_1102C((__int64)v3[19], 0x13Au, (__int64)&unk_2EBE8, *(unsigned __int16 *)(a1 + 26));
              v3 = (void **)off_30148;
            }
            if ( v3 != &off_30148 )
            {
              if ( (*((_BYTE *)v3 + 172) & 0x20) != 0 && *((_BYTE *)v3 + 169) >= 5u )
              {
                sub_147C8((__int64)v3[19], 0x13Bu, (__int64)&unk_2EBE8, *(_QWORD *)(a1 + 32));
                v3 = (void **)off_30148;
              }
              if ( v3 != &off_30148 && (*((_BYTE *)v3 + 172) & 0x20) != 0 && *((_BYTE *)v3 + 169) >= 5u )
                sub_1102C((__int64)v3[19], 0x13Cu, (__int64)&unk_2EBE8, *(unsigned __int8 *)(a1 + 40));
            }
          }
        }
      }
    }
  }
  return v1;
}
// 27125: variable 'v5' is possibly undefined
// 27139: variable 'v6' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (0000000000027250) ----------------------------------------------------
bool __fastcall sub_27250(char a1, char *a2)
{
  bool v2; // bl
  char v3; // al
  char v4; // al
  char v5; // al
  bool v6; // zf
  void **v7; // rcx
  __int64 v8; // rcx
  const char *v9; // r9

  v2 = 0;
  if ( a1 == 4 )
  {
    v3 = *a2;
    if ( *a2 != 10
      && (v3 != -84 || (unsigned __int8)a2[1] < 0x10u || (unsigned __int8)a2[1] > 0x1Fu)
      && (v3 != -64 || a2[1] != -88) )
    {
      if ( v3 == -87 )
        v2 = a2[1] == -2;
      goto LABEL_32;
    }
    goto LABEL_8;
  }
  if ( a1 == 6 )
  {
    if ( *a2 != -4 && *a2 != -3 && (*a2 != -2 || a2[1] >= 0) )
    {
      if ( *a2 != -1 || (v4 = a2[1], (v4 & 0xC0) != 0) )
      {
        if ( *a2 != 1 )
          goto LABEL_32;
        v6 = a2[1] == 0;
LABEL_24:
        if ( !v6 )
          goto LABEL_32;
        goto LABEL_8;
      }
      v5 = v4 & 0xF;
      if ( v5 != 1 && v5 != 2 && v5 != 3 && v5 != 4 && v5 != 5 )
      {
        v6 = v5 == 8;
        goto LABEL_24;
      }
    }
LABEL_8:
    v2 = 1;
LABEL_32:
    v7 = (void **)off_30148;
    goto LABEL_33;
  }
  v7 = (void **)off_30148;
  if ( off_30148 == &off_30148 )
    return v2;
  if ( (*((_BYTE *)off_30148 + 172) & 0x20) != 0 && *((_BYTE *)off_30148 + 169) >= 2u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x1C3u, (__int64)&unk_2EBE8);
    goto LABEL_32;
  }
LABEL_33:
  if ( v7 != &off_30148 && (*((_BYTE *)v7 + 172) & 0x20) != 0 && *((_BYTE *)v7 + 169) >= 4u )
  {
    v8 = (__int64)v7[19];
    v9 = "PUBLIC";
    if ( v2 )
      v9 = "PRIVATE";
    sub_14D60(v8, 0x1C4u, (__int64)&unk_2EBE8, v9);
  }
  return v2;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000027398) ----------------------------------------------------
const char *__fastcall sub_27398(unsigned __int8 a1)
{
  if ( a1 <= 0x3Au )
  {
    switch ( a1 )
    {
      case 0x3Au:
        return "IPv6_ICMPV6_HEADER";
      case 0u:
        return "IPv6_HOP_BY_HOP_HEADER";
      case 4u:
        return "IPv6_IPV4_OVER_IPV6";
      case 6u:
        return "IPv6_TCP_HEADER";
      case 0x11u:
        return "IPv6_UDP_HEADER";
      case 0x2Bu:
        return "IPv6_ROUTING_HEADER";
      case 0x2Cu:
        return "IPv6_FRAGMENT_HEADER";
      case 0x32u:
        return "IPv6_IPSEC_ESP_HEADER";
      case 0x33u:
        return "IPv6_AH_HEADER";
    }
    return "UNKNOWN";
  }
  switch ( a1 )
  {
    case 0x3Bu:
      return "IPv6_NO_NEXT_HEADER";
    case 0x3Cu:
      return "IPv6_DESTINATION_OPTIONS_HEADER";
    case 0x87u:
      return "IPv6_MOBILITY_HEADER";
    case 0x8Bu:
      return "IPv6_HOST_IDENTITY_HEADER";
    case 0x8Cu:
      return "IPv6_SHIM6_HEADER";
    case 0xFDu:
      return "IPv6_EXPERIMENT_TESTING_1";
    case 0xFEu:
      return "IPv6_EXPERIMENT_TESTING_2";
  }
  if ( a1 != 255 )
    return "UNKNOWN";
  return "IPv6_HEADER";
}

//----- (0000000000027488) ----------------------------------------------------
__int64 __fastcall sub_27488(__int64 a1, const void *a2, size_t a3)
{
  void **v6; // rcx
  _DWORD *v7; // rdx
  int v8; // eax
  size_t v9; // rdx

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x40) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x23u, (__int64)&unk_2EBD8);
    v6 = (void **)off_30148;
  }
  v7 = *(_DWORD **)(a1 + 132);
  if ( !v7 || (v8 = *(_DWORD *)(a1 + 140)) == 0 )
  {
    if ( v6 == &off_30148 )
      return 0i64;
    if ( (*((_BYTE *)v6 + 172) & 0x40) == 0 || *((_BYTE *)v6 + 169) < 4u )
    {
LABEL_19:
      if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x40) != 0 && *((_BYTE *)v6 + 169) >= 5u )
        sub_11008((__int64)v6[19], 0x26u, (__int64)&unk_2EBD8);
      return 0i64;
    }
    sub_11008((__int64)v6[19], 0x25u, (__int64)&unk_2EBD8);
LABEL_18:
    v6 = (void **)off_30148;
    goto LABEL_19;
  }
  v9 = (unsigned int)(v8 - *v7);
  if ( v9 > a3 )
  {
    sub_2B608((void *)(**(unsigned int **)(a1 + 132) + *(_QWORD *)(a1 + 132) + 4i64), v9, a2, a3);
    **(_DWORD **)(a1 + 132) += a3;
    goto LABEL_18;
  }
  if ( v6 != &off_30148 && (*((_BYTE *)v6 + 172) & 0x40) != 0 && *((_BYTE *)v6 + 169) >= 2u )
    sub_11008((__int64)v6[19], 0x24u, (__int64)&unk_2EBD8);
  return 10i64;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000275E8) ----------------------------------------------------
_WORD *__fastcall sub_275E8(_WORD *a1, unsigned __int16 *a2)
{
  _WORD *v2; // rdi
  unsigned __int16 *v3; // r13
  _WORD *v4; // rbp
  _WORD *v5; // rsi
  unsigned __int16 *v6; // r12
  bool v7; // zf
  int v8; // ebx
  int v9; // ebx

  v2 = 0i64;
  v3 = a2;
  v4 = a1;
  v5 = 0i64;
  v6 = a2;
  if ( !*a2 )
    v5 = a1;
  if ( *a1 )
  {
    while ( 1 )
    {
      v7 = *v6 == 0;
      if ( !*v6 )
        break;
      v8 = tolower((unsigned __int16)*v4);
      if ( v8 == tolower(*v6) )
      {
        if ( !v5 )
          v5 = v4;
        ++v6;
      }
      else
      {
        v6 = v3;
        v9 = tolower((unsigned __int16)*v4);
        if ( v9 == tolower(*v3) )
        {
          v5 = v4;
          v6 = v3 + 1;
        }
        else
        {
          v5 = 0i64;
        }
      }
      if ( !*++v4 )
        goto LABEL_13;
    }
  }
  else
  {
LABEL_13:
    v7 = *v6 == 0;
  }
  if ( v7 )
    v2 = v5;
  return v2;
}

//----- (00000000000276A4) ----------------------------------------------------
__int64 sub_276A4(__int64 a1, unsigned __int16 a2, __int64 a3, ...)
{
  va_list va; // [rsp+78h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_30398(a1, 43i64, &unk_2EB40, a2, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000276F4) ----------------------------------------------------
__int64 sub_276F4(__int64 a1, __int64 a2, __int64 a3, ...)
{
  va_list va; // [rsp+88h] [rbp+20h] BYREF

  va_start(va, a3);
  return qword_30398(a1, 43i64, &unk_2EB40, 103i64, (__int64 *)va);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000027758) ----------------------------------------------------
__int64 __fastcall sub_27758(__int64 a1, unsigned __int16 a2, __int64 a3, int a4)
{
  int v5; // [rsp+88h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EB40, a2, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000277B4) ----------------------------------------------------
__int64 __fastcall sub_277B4(__int64 a1, __int64 a2, __int64 a3, int a4)
{
  int v5; // [rsp+98h] [rbp+20h] BYREF

  v5 = a4;
  return qword_30398(a1, 43i64, &unk_2EB40, 189i64, &v5);
}
// 30398: using guessed type __int64 (__fastcall *qword_30398)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000027824) ----------------------------------------------------
__int64 __fastcall sub_27824(int a1, _QWORD *a2)
{
  void **v4; // rcx
  int v6; // ebx

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xAu, (__int64)&unk_2EB40);
    v4 = (void **)off_30148;
  }
  if ( a2 )
  {
    if ( a1 )
    {
      v6 = a1 - 1;
      if ( !v6 )
      {
        if ( v4 != &off_30148 )
        {
          if ( *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
          {
            sub_11008((__int64)v4[19], 0xDu, (__int64)&unk_2EB40);
            v4 = (void **)off_30148;
          }
          if ( v4 != &off_30148 && (*((_BYTE *)v4 + 108) & 0x20) != 0 && *((_BYTE *)v4 + 105) >= 4u )
            sub_1AFB8((__int64)v4[11], 0x1Au);
        }
        sub_1C674(a2);
        goto LABEL_32;
      }
      if ( v6 == 1 )
      {
        if ( v4 != &off_30148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
          sub_11008((__int64)v4[19], 0xEu, (__int64)&unk_2EB40);
        sub_1BD50((__int64)a2);
        goto LABEL_32;
      }
    }
    else
    {
      if ( v4 == &off_30148 )
        return 0i64;
      if ( *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
      {
        sub_11008((__int64)v4[19], 0xCu, (__int64)&unk_2EB40);
LABEL_32:
        v4 = (void **)off_30148;
        goto LABEL_33;
      }
    }
LABEL_33:
    if ( v4 != &off_30148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
      sub_11008((__int64)v4[19], 0xFu, (__int64)&unk_2EB40);
    return 0i64;
  }
  if ( v4 != &off_30148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 2u )
    sub_11008((__int64)v4[19], 0xBu, (__int64)&unk_2EB40);
  return 3i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000027A08) ----------------------------------------------------
__int64 __fastcall sub_27A08(int a1, __int64 a2)
{
  void **v4; // rcx
  int v6; // ebx
  unsigned __int16 v7; // dx

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x10u, (__int64)&unk_2EB40);
    v4 = (void **)off_30148;
  }
  if ( a2 )
  {
    if ( a1 )
    {
      v6 = a1 - 1;
      if ( v6 )
      {
        if ( v6 != 1 )
          goto LABEL_27;
        if ( v4 != &off_30148 )
        {
          if ( *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
          {
            v7 = 20;
LABEL_26:
            sub_11008((__int64)v4[19], v7, (__int64)&unk_2EB40);
            v4 = (void **)off_30148;
            goto LABEL_27;
          }
          goto LABEL_27;
        }
      }
      else if ( v4 != &off_30148 )
      {
        if ( *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
        {
          v7 = 19;
          goto LABEL_26;
        }
LABEL_27:
        if ( v4 != &off_30148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
          sub_11008((__int64)v4[19], 0x15u, (__int64)&unk_2EB40);
        return 0i64;
      }
    }
    else if ( v4 != &off_30148 )
    {
      if ( *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 5u )
      {
        v7 = 18;
        goto LABEL_26;
      }
      goto LABEL_27;
    }
    return 0i64;
  }
  if ( v4 != &off_30148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 2u )
    sub_11008((__int64)v4[19], 0x11u, (__int64)&unk_2EB40);
  return 3i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000027B68) ----------------------------------------------------
__int64 __fastcall sub_27B68(int a1, struct _FAST_MUTEX *a2, KIRQL *a3)
{
  _QWORD *v3; // rcx
  unsigned __int16 v4; // dx
  int v6; // ecx

  if ( !a2 )
  {
    v3 = off_30148;
    if ( off_30148 == &off_30148 || *((char *)off_30148 + 172) >= 0 || *((_BYTE *)off_30148 + 169) < 2u )
      return 3i64;
    v4 = 22;
LABEL_6:
    sub_11008(v3[19], v4, (__int64)&unk_2EB40);
    return 3i64;
  }
  if ( !a3 )
  {
    v3 = off_30148;
    if ( off_30148 == &off_30148 || *((char *)off_30148 + 172) >= 0 || *((_BYTE *)off_30148 + 169) < 2u )
      return 3i64;
    v4 = 23;
    goto LABEL_6;
  }
  v6 = a1 - 1;
  if ( v6 )
  {
    if ( v6 == 1 )
      sub_1BE30(a2);
  }
  else
  {
    sub_1BB30((PKSPIN_LOCK)a2, a3);
  }
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000027C2C) ----------------------------------------------------
__int64 __fastcall sub_27C2C(int a1, struct _FAST_MUTEX *a2, KIRQL a3)
{
  __int64 result; // rax
  int v4; // ecx

  if ( a2 )
  {
    v4 = a1 - 1;
    if ( v4 )
    {
      if ( v4 == 1 )
        sub_1BEFC(a2);
    }
    else
    {
      sub_1BBA8((PKSPIN_LOCK)a2, a3);
    }
    result = 0i64;
  }
  else
  {
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_30148 + 19), 0x18u, (__int64)&unk_2EB40);
    result = 3i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000027CC0) ----------------------------------------------------
__int64 __fastcall sub_27CC0(__int64 a1, __int64 a2, char a3)
{
  void **v6; // rcx
  unsigned __int16 v7; // dx

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x19u, (__int64)&unk_2EB40);
    v6 = (void **)off_30148;
  }
  if ( !a1 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 26;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_2EB40);
    return 3i64;
  }
  if ( !a2 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 27;
    goto LABEL_10;
  }
  *(_DWORD *)(a2 + 16) = 0;
  *(_QWORD *)(a2 + 8) = a2;
  *(_QWORD *)a2 = a2;
  if ( a3 )
    sub_27824(*(_DWORD *)(a1 + 24), (_QWORD *)(a2 + 24));
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x1Cu, (__int64)&unk_2EB40);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000027DEC) ----------------------------------------------------
__int64 __fastcall sub_27DEC(__int64 a1, __int64 a2, char a3)
{
  void **v6; // rcx
  unsigned __int16 v7; // dx

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x1Du, (__int64)&unk_2EB40);
    v6 = (void **)off_30148;
  }
  if ( !a1 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 30;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_2EB40);
    return 3i64;
  }
  if ( !a2 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 31;
    goto LABEL_10;
  }
  if ( a3 )
  {
    sub_27A08(*(_DWORD *)(a1 + 24), a2 + 24);
    v6 = (void **)off_30148;
  }
  if ( v6 != &off_30148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 5u )
    sub_11008((__int64)v6[19], 0x20u, (__int64)&unk_2EB40);
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000027F10) ----------------------------------------------------
_DWORD *__fastcall sub_27F10(unsigned __int8 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, int a6, int a7, int a8, int a9, int a10, _DWORD *a11)
{
  void **v12; // rcx
  int v14; // ebx
  int v15; // eax
  int v16; // ebp
  _DWORD *v17; // rbx
  char *v18; // rax
  __int64 v19; // rdi
  void **v20; // rcx

  v12 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x21u, (__int64)&unk_2EB40);
    v12 = (void **)off_30148;
  }
  *a11 = 0;
  if ( a1 > 0x1Eu )
  {
    if ( v12 != &off_30148 && *((char *)v12 + 172) < 0 && *((_BYTE *)v12 + 169) >= 2u )
      sub_139F8((__int64)v12[19], 0x22u, (__int64)&unk_2EB40, a1);
LABEL_10:
    *a11 = 3;
    return 0i64;
  }
  v14 = 1 << a1;
  v15 = sub_2ADF4(v14);
  v16 = v15;
  if ( !v15 )
  {
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 2u )
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x23u, (__int64)&unk_2EB40, v14);
    goto LABEL_10;
  }
  v17 = sub_1B038(2, 16 * (5 * v15 + 5), 0x49504950u);
  if ( !v17 )
  {
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_30148 + 19), 0x25u, (__int64)&unk_2EB40);
LABEL_22:
    *a11 = 2;
    return 0i64;
  }
  v18 = sub_1B2A4(1i64, 0x38u);
  *((_QWORD *)v17 + 9) = v18;
  if ( !v18 )
  {
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_30148 + 19), 0x26u, (__int64)&unk_2EB40);
    sub_1B0BC(v17, 0x49504950u);
    goto LABEL_22;
  }
  *v17 = 0;
  v17[2] = 0;
  v17[6] = 2;
  v19 = 0i64;
  *((_QWORD *)v17 + 2) = a5;
  v17[3] = 1229998416;
  for ( v17[1] = v16; (unsigned int)v19 < v17[1]; v19 = (unsigned int)(v19 + 1) )
    sub_27CC0((__int64)v17, (__int64)&v17[20 * v19 + 20], 1);
  *((_QWORD *)v17 + 5) = 0i64;
  *((_QWORD *)v17 + 6) = 0i64;
  *((_QWORD *)v17 + 8) = 0i64;
  *((_QWORD *)v17 + 7) = sub_1A1D4;
  v20 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 4u )
    {
      sub_27758(*((_QWORD *)off_30148 + 19), 0x27u, (__int64)&unk_2EB40, v17[1]);
      v20 = (void **)off_30148;
    }
    if ( v20 != &off_30148 && *((char *)v20 + 172) < 0 && *((_BYTE *)v20 + 169) >= 5u )
      sub_11008((__int64)v20[19], 0x28u, (__int64)&unk_2EB40);
  }
  return v17;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000281E0) ----------------------------------------------------
__int64 __fastcall sub_281E0(__int64 a1, char a2)
{
  ULONG_PTR v2; // rdi
  char v3; // r15
  void **v4; // rcx
  unsigned int v6; // esi
  _QWORD **v7; // r12
  _QWORD *v8; // rbp
  __int64 v9; // r13
  void **v10; // rcx
  ULONG_PTR v11; // rbx
  int v12; // eax
  int i; // ebx
  unsigned int j; // ebx
  void **v15; // rcx
  __int64 v16; // [rsp+20h] [rbp-A8h]
  __int64 v17; // [rsp+30h] [rbp-98h] BYREF
  char Dst[72]; // [rsp+38h] [rbp-90h] BYREF
  __int64 v19; // [rsp+D0h] [rbp+8h] BYREF
  char v20; // [rsp+D8h] [rbp+10h]
  unsigned int v21; // [rsp+E0h] [rbp+18h] BYREF
  union _LARGE_INTEGER Interval; // [rsp+E8h] [rbp+20h] BYREF

  v20 = a2;
  v19 = a1;
  v2 = qword_304A8;
  v3 = a2;
  v21 = 0;
  v17 = 0i64;
  memset(Dst, 0, sizeof(Dst));
  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x80) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x36u, (__int64)&unk_2EB40);
    v4 = (void **)off_30148;
  }
  if ( !v2 )
  {
    if ( v4 != &off_30148 && (*((_BYTE *)v4 + 172) & 0x80) != 0 && *((_BYTE *)v4 + 169) >= 2u )
      sub_11008((__int64)v4[19], 0x37u, (__int64)&unk_2EB40);
    return 3i64;
  }
  if ( v4 != &off_30148 && (*((_BYTE *)v4 + 172) & 0x80) != 0 && *((_BYTE *)v4 + 169) >= 4u )
    sub_27758((__int64)v4[19], 0x38u, (__int64)&unk_2EB40, *(_DWORD *)(v2 + 4));
  _InterlockedAdd((volatile signed __int32 *)(v2 + 28), 1u);
  v6 = 0;
  if ( *(_DWORD *)(v2 + 4) )
  {
    v7 = (_QWORD **)(v2 + 80);
    while ( 1 )
    {
      sub_27B68(*(_DWORD *)(v2 + 24), (struct _FAST_MUTEX *)(v2 + 80i64 * v6 + 104), (KIRQL *)&v19);
      v8 = *v7;
      v9 = v2 + 80i64 * v6 + 80;
      if ( *v7 != (_QWORD *)v9 )
        break;
LABEL_36:
      sub_27C2C(*(_DWORD *)(v2 + 24), (struct _FAST_MUTEX *)(v2 + 80i64 * v6++ + 104), v19);
      v7 += 10;
      if ( v6 >= *(_DWORD *)(v2 + 4) )
      {
        v3 = v20;
        goto LABEL_38;
      }
    }
    v10 = (void **)off_30148;
    while ( 1 )
    {
      v11 = (ULONG_PTR)v8;
      v8 = (_QWORD *)*v8;
      if ( *(_BYTE *)(v11 + 44) )
      {
        if ( v10 == &off_30148 || *((char *)v10 + 172) >= 0 || *((_BYTE *)v10 + 169) < 4u )
          goto LABEL_35;
        LODWORD(v16) = *(_DWORD *)(v11 + 40);
        sub_1DC74((__int64)v10[19], 0x39u, (__int64)&unk_2EB40, *(_QWORD *)(v11 + 16), v16);
      }
      else
      {
        if ( !sub_2A554((_BYTE *)v2, &v21) )
          v21 = sub_2A28C(v2, v11, 1);
        if ( *(_DWORD *)(v11 + 40) )
        {
          *(_BYTE *)(v11 + 44) = 1;
        }
        else
        {
          v21 = sub_28BE0(v2, v6, (__int64 *)v11);
          if ( v21 )
          {
            v10 = (void **)off_30148;
            if ( off_30148 == &off_30148 || *((char *)off_30148 + 172) >= 0 || *((_BYTE *)off_30148 + 169) < 3u )
              goto LABEL_35;
            sub_11008(*((_QWORD *)off_30148 + 19), 0x3Au, (__int64)&unk_2EB40);
          }
          else
          {
            sub_28DDC(v2, (__int64)&v17, v11);
          }
        }
      }
      v10 = (void **)off_30148;
LABEL_35:
      if ( v8 == (_QWORD *)v9 )
        goto LABEL_36;
    }
  }
LABEL_38:
  sub_28F5C(v2, (__int64)&v17, v3);
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x80) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x3Bu, (__int64)&unk_2EB40);
  v12 = sub_291A8(v2, &v21);
  if ( v12 )
  {
    Interval.QuadPart = -5000000i64;
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x80) != 0 && *((_BYTE *)off_30148 + 169) >= 3u )
      sub_1102C(*((_QWORD *)off_30148 + 19), 0x3Cu, (__int64)&unk_2EB40, v12);
    for ( i = 0; i < 10; ++i )
    {
      if ( !(unsigned int)sub_291A8(v2, &v21) )
        break;
      if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x80) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
        sub_1102C(*((_QWORD *)off_30148 + 19), 0x3Du, (__int64)&unk_2EB40, i);
      KeDelayExecutionThread(0, 0, &Interval);
    }
  }
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x80) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x3Eu, (__int64)&unk_2EB40);
  for ( j = 0; j < *(_DWORD *)(v2 + 4); ++j )
    sub_27DEC(v2, v2 + 16 * (5i64 * j + 5), 1);
  sub_1B458(*(PVOID *)(v2 + 72));
  sub_1B0BC((PVOID)v2, *(_DWORD *)(v2 + 12));
  v15 = (void **)off_30148;
  if ( off_30148 != &off_30148 )
  {
    if ( (*((_BYTE *)off_30148 + 172) & 0x80) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
    {
      sub_11008(*((_QWORD *)off_30148 + 19), 0x3Fu, (__int64)&unk_2EB40);
      v15 = (void **)off_30148;
    }
    if ( v15 != &off_30148 && (*((_BYTE *)v15 + 172) & 0x80) != 0 && *((_BYTE *)v15 + 169) >= 5u )
      sub_11008((__int64)v15[19], 0x40u, (__int64)&unk_2EB40);
  }
  return v21;
}
// 28382: variable 'v16' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (0000000000028674) ----------------------------------------------------
__int64 __fastcall sub_28674(__int64 a1)
{
  ULONG_PTR v1; // rdi
  unsigned int v2; // esi
  void **v3; // rcx
  __int64 result; // rax
  __int64 v5; // rbp
  _QWORD **v6; // r13
  int v7; // ecx
  struct _FAST_MUTEX *v8; // r15
  _QWORD *v9; // r12
  __int64 v10; // r14
  ULONG_PTR v11; // rbx
  void **v12; // rcx
  __int64 v13; // [rsp+20h] [rbp-98h]
  __int64 v14; // [rsp+30h] [rbp-88h] BYREF
  _BYTE v15[72]; // [rsp+38h] [rbp-80h] BYREF
  __int64 v16; // [rsp+C0h] [rbp+8h] BYREF
  unsigned int v17; // [rsp+D0h] [rbp+18h] BYREF
  struct _FAST_MUTEX *v18; // [rsp+D8h] [rbp+20h]

  v16 = a1;
  v1 = qword_304A8;
  v2 = 0;
  v14 = 0i64;
  v17 = 0;
  memset(v15, 0, sizeof(v15));
  v3 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x80) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x4Bu, (__int64)&unk_2EB40);
    v3 = (void **)off_30148;
  }
  if ( v1 )
  {
    if ( v3 != &off_30148 && (*((_BYTE *)v3 + 172) & 0x80) != 0 && *((_BYTE *)v3 + 169) >= 4u )
      sub_27758((__int64)v3[19], 0x4Du, (__int64)&unk_2EB40, *(_DWORD *)(v1 + 4));
    v5 = 0i64;
    if ( *(_DWORD *)(v1 + 4) )
    {
      v6 = (_QWORD **)(v1 + 80);
      do
      {
        v7 = *(_DWORD *)(v1 + 24);
        v8 = (struct _FAST_MUTEX *)(80 * v5 + v1 + 104);
        v18 = v8;
        sub_27B68(v7, v8, (KIRQL *)&v16);
        v9 = *v6;
        v10 = 80 * v5 + v1 + 80;
        if ( *v6 != (_QWORD *)v10 )
        {
          do
          {
            v11 = (ULONG_PTR)v9;
            v9 = (_QWORD *)*v9;
            if ( *(_BYTE *)(v11 + 44) )
            {
              if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 4u )
              {
                LODWORD(v13) = *(_DWORD *)(v11 + 40);
                sub_1DC74(*((_QWORD *)off_30148 + 19), 0x4Eu, (__int64)&unk_2EB40, *(_QWORD *)(v11 + 16), v13);
              }
            }
            else
            {
              if ( sub_2A554((_BYTE *)v1, &v17) )
              {
                v2 = v17;
              }
              else
              {
                v2 = sub_2A28C(v1, v11, 1);
                v17 = v2;
              }
              if ( *(_DWORD *)(v11 + 40) )
              {
                *(_BYTE *)(v11 + 44) = 1;
              }
              else
              {
                v2 = sub_28BE0(v1, v5, (__int64 *)v11);
                v17 = v2;
                if ( !v2 )
                  sub_28DDC(v1, (__int64)&v14, v11);
              }
            }
          }
          while ( v9 != (_QWORD *)v10 );
          v8 = v18;
        }
        sub_27C2C(*(_DWORD *)(v1 + 24), v8, v16);
        v5 = (unsigned int)(v5 + 1);
        v6 += 10;
      }
      while ( (unsigned int)v5 < *(_DWORD *)(v1 + 4) );
    }
    sub_28F5C(v1, (__int64)&v14, 1);
    v12 = (void **)off_30148;
    if ( off_30148 != &off_30148 )
    {
      if ( (*((_BYTE *)off_30148 + 172) & 0x80) != 0 && *((_BYTE *)off_30148 + 169) >= 4u )
      {
        sub_11008(*((_QWORD *)off_30148 + 19), 0x4Fu, (__int64)&unk_2EB40);
        v12 = (void **)off_30148;
      }
      if ( v12 != &off_30148 && (*((_BYTE *)v12 + 172) & 0x80) != 0 && *((_BYTE *)v12 + 169) >= 5u )
        sub_11008((__int64)v12[19], 0x50u, (__int64)&unk_2EB40);
    }
    result = v2;
  }
  else
  {
    if ( v3 != &off_30148 && (*((_BYTE *)v3 + 172) & 0x80) != 0 && *((_BYTE *)v3 + 169) >= 2u )
      sub_11008((__int64)v3[19], 0x4Cu, (__int64)&unk_2EB40);
    result = 3i64;
  }
  return result;
}
// 2880F: variable 'v13' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (000000000002895C) ----------------------------------------------------
unsigned __int64 __fastcall sub_2895C(__int64 a1, unsigned __int64 a2, _DWORD *a3)
{
  void **v6; // rcx
  unsigned __int64 result; // rax

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x5Au, (__int64)&unk_2EB40);
    v6 = (void **)off_30148;
  }
  *a3 = 0;
  if ( a1 )
  {
    if ( v6 != &off_30148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 5u )
      sub_11008((__int64)v6[19], 0x5Cu, (__int64)&unk_2EB40);
    result = a2 % *(unsigned int *)(a1 + 4);
  }
  else
  {
    if ( v6 != &off_30148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 2u )
      sub_11008((__int64)v6[19], 0x5Bu, (__int64)&unk_2EB40);
    *a3 = 3;
    result = 0xFFFFFFFFi64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000028A58) ----------------------------------------------------
_DWORD *__fastcall sub_28A58(__int64 a1, __int64 a2, _DWORD *a3)
{
  void **v6; // rcx
  unsigned __int16 v7; // dx
  _DWORD *v9; // rax
  _DWORD *v10; // rdi
  __int64 v11; // r11

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x5Du, (__int64)&unk_2EB40);
    v6 = (void **)off_30148;
  }
  *a3 = 0;
  if ( !a1 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_11;
    v7 = 94;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_2EB40);
LABEL_11:
    *a3 = 3;
    return 0i64;
  }
  if ( !a2 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      goto LABEL_11;
    v7 = 95;
    goto LABEL_10;
  }
  v9 = sub_1B578(*(_QWORD *)(a1 + 72));
  v10 = v9;
  if ( !v9 )
  {
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_30148 + 19), 0x60u, (__int64)&unk_2EB40);
    *a3 = 2;
    return 0i64;
  }
  memset(v9, 0, 0x38ui64);
  v11 = *(_QWORD *)(a1 + 16);
  *((_QWORD *)v10 + 4) = a2;
  *((_QWORD *)v10 + 3) = v11;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x61u, (__int64)&unk_2EB40);
  return v10;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000028BE0) ----------------------------------------------------
__int64 __fastcall sub_28BE0(__int64 a1, unsigned int a2, __int64 *a3)
{
  __int64 v4; // rsi
  void **v6; // rcx
  unsigned __int16 v7; // dx
  __int64 result; // rax
  _QWORD *v9; // rax
  __int64 v10; // rcx
  signed __int32 v11; // eax
  void **v12; // rcx
  __int64 v13; // [rsp+20h] [rbp-28h]
  unsigned int v14; // [rsp+50h] [rbp+8h] BYREF

  v14 = 0;
  v4 = a2;
  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x62u, (__int64)&unk_2EB40);
    v6 = (void **)off_30148;
  }
  if ( !a1 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 99;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_2EB40);
    return 3i64;
  }
  if ( !a3 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 100;
    goto LABEL_10;
  }
  if ( v6 != &off_30148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 5u )
    sub_1DC74((__int64)v6[19], 0x65u, (__int64)&unk_2EB40, a3[2], *((_DWORD *)a3 + 10));
  if ( sub_2A6A0((_BYTE *)a1, &v14) )
  {
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 4u )
      sub_11008(*((_QWORD *)off_30148 + 19), 0x66u, (__int64)&unk_2EB40);
    result = 12i64;
  }
  else
  {
    v9 = (_QWORD *)a3[1];
    v10 = *a3;
    *v9 = *a3;
    *(_QWORD *)(v10 + 8) = v9;
    --*(_DWORD *)(a1 + 80 * v4 + 96);
    v11 = _InterlockedDecrement((volatile signed __int32 *)(a1 + 8));
    v12 = (void **)off_30148;
    if ( off_30148 != &off_30148 )
    {
      if ( *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 4u )
      {
        LODWORD(v13) = *(_DWORD *)(a1 + 80 * v4 + 96);
        sub_276F4(*((_QWORD *)off_30148 + 19), 103i64, (__int64)&unk_2EB40, a3[2], v13, v11);
        v12 = (void **)off_30148;
      }
      if ( v12 != &off_30148 && *((char *)v12 + 172) < 0 && *((_BYTE *)v12 + 169) >= 5u )
        sub_11008((__int64)v12[19], 0x68u, (__int64)&unk_2EB40);
    }
    result = v14;
  }
  return result;
}
// 28D85: variable 'v13' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (0000000000028DDC) ----------------------------------------------------
__int64 __fastcall sub_28DDC(__int64 a1, __int64 a2, __int64 a3)
{
  void **v6; // rcx
  __int64 *v7; // rax
  __int64 result; // rax
  int v9; // [rsp+20h] [rbp-18h]

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x69u, (__int64)&unk_2EB40);
    v6 = (void **)off_30148;
  }
  if ( a1 && a2 && a3 )
  {
    if ( !*(_DWORD *)(a2 + 16) )
    {
      sub_27CC0(a1, a2, 0);
      v6 = (void **)off_30148;
    }
    if ( v6 != &off_30148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 5u )
    {
      v9 = *(_DWORD *)(a3 + 40);
      sub_1DC74((__int64)v6[19], 0x6Bu, (__int64)&unk_2EB40, *(_QWORD *)(a3 + 16), v9);
    }
    v7 = *(__int64 **)(a2 + 8);
    *(_QWORD *)a3 = a2;
    *(_QWORD *)(a3 + 8) = v7;
    *v7 = a3;
    ++*(_DWORD *)(a2 + 16);
    *(_QWORD *)(a2 + 8) = a3;
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
      sub_11008(*((_QWORD *)off_30148 + 19), 0x6Cu, (__int64)&unk_2EB40);
    result = 0i64;
  }
  else
  {
    if ( v6 != &off_30148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 2u )
      sub_14D0C((__int64)v6[19], 0x6Au, (__int64)&unk_2EB40, a1, a2, a3);
    result = 3i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000028F5C) ----------------------------------------------------
__int64 __fastcall sub_28F5C(__int64 a1, __int64 a2, char a3)
{
  unsigned int v6; // edi
  void **v7; // rcx
  __int64 *v8; // r12
  __int64 *v9; // rsi
  __int64 *v10; // rax
  __int64 v11; // rcx
  __int64 v12; // rcx
  void (__fastcall *v13)(__int64); // rax

  v6 = 0;
  v7 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x6Du, (__int64)&unk_2EB40);
    v7 = (void **)off_30148;
  }
  if ( a1 && a2 )
  {
    if ( !*(_DWORD *)(a2 + 16) )
    {
      v6 = 4;
      goto LABEL_30;
    }
    v8 = *(__int64 **)a2;
    if ( *(_QWORD *)a2 == a2 )
    {
LABEL_30:
      sub_27DEC(a1, a2, 0);
      if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
        sub_11008(*((_QWORD *)off_30148 + 19), 0x72u, (__int64)&unk_2EB40);
      return v6;
    }
    while ( 1 )
    {
      v9 = v8;
      v8 = (__int64 *)*v8;
      v10 = (__int64 *)v9[1];
      v11 = *v9;
      *v10 = *v9;
      *(_QWORD *)(v11 + 8) = v10;
      --*(_DWORD *)(a2 + 16);
      if ( !a3 )
        goto LABEL_24;
      v12 = v9[4];
      if ( v12 )
      {
        v13 = *(void (__fastcall **)(__int64))(a1 + 56);
        if ( v13 )
        {
          v13(v12);
LABEL_24:
          if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
            sub_147C8(*((_QWORD *)off_30148 + 19), 0x71u, (__int64)&unk_2EB40, v9[2]);
          sub_1B5E0(*(_QWORD *)(a1 + 72), (__int64)v9);
          goto LABEL_29;
        }
        if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 2u )
          sub_11008(*((_QWORD *)off_30148 + 19), 0x70u, (__int64)&unk_2EB40);
        v6 = 5;
      }
      else
      {
        if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 2u )
          sub_11008(*((_QWORD *)off_30148 + 19), 0x6Fu, (__int64)&unk_2EB40);
        v6 = 6;
      }
LABEL_29:
      if ( *(_QWORD *)a2 == a2 )
        goto LABEL_30;
    }
  }
  if ( v7 != &off_30148 && *((char *)v7 + 172) < 0 && *((_BYTE *)v7 + 169) >= 2u )
    sub_14CC4((__int64)v7[19], 0x6Eu, (__int64)&unk_2EB40, a1, a2);
  return 3i64;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000291A8) ----------------------------------------------------
__int64 __fastcall sub_291A8(__int64 a1, _DWORD *a2)
{
  void **v4; // rcx
  __int64 result; // rax
  unsigned __int32 v6; // ebx

  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x73u, (__int64)&unk_2EB40);
    v4 = (void **)off_30148;
  }
  *a2 = 0;
  if ( a1 )
  {
    v6 = _InterlockedExchangeAdd((volatile signed __int32 *)(a1 + 8), 0);
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
      sub_11008(*((_QWORD *)off_30148 + 19), 0x75u, (__int64)&unk_2EB40);
    result = v6;
  }
  else
  {
    if ( v4 != &off_30148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 2u )
      sub_11008((__int64)v4[19], 0x74u, (__int64)&unk_2EB40);
    *a2 = 3;
    result = 0i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000292A0) ----------------------------------------------------
__int64 __fastcall sub_292A0(__int64 a1, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4)
{
  ULONG_PTR v4; // rdi
  void **v8; // rcx
  unsigned __int16 v9; // dx
  __int64 result; // rax
  ULONG_PTR v11; // rax
  void **v12; // rcx
  unsigned int v13; // ebx
  __int64 v14; // [rsp+60h] [rbp+8h] BYREF

  HIDWORD(v14) = HIDWORD(a1);
  v4 = qword_304A8;
  LODWORD(v14) = 0;
  v8 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x86u, (__int64)&unk_2EB40);
    v8 = (void **)off_30148;
  }
  if ( a4 )
    *a4 = 0i64;
  if ( !v4 )
  {
    if ( v8 == &off_30148 || *((char *)v8 + 172) >= 0 || *((_BYTE *)v8 + 169) < 2u )
      return 3i64;
    v9 = 135;
LABEL_12:
    sub_11008((__int64)v8[19], v9, (__int64)&unk_2EB40);
    return 3i64;
  }
  if ( !a3 )
  {
    if ( v8 == &off_30148 || *((char *)v8 + 172) >= 0 || *((_BYTE *)v8 + 169) < 2u )
      return 3i64;
    v9 = 136;
    goto LABEL_12;
  }
  if ( _InterlockedCompareExchange((volatile signed __int32 *)(v4 + 28), 0, 0) )
  {
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_30148 + 19), 0x89u, (__int64)&unk_2EB40);
    result = 9i64;
  }
  else
  {
    v11 = sub_29B1C(v4, a2, a3, a4, (__int64)&v14);
    if ( v11 )
    {
      if ( v11 == a3 )
      {
        v13 = v14;
        v12 = (void **)off_30148;
      }
      else
      {
        if ( a4 )
          sub_29FA4(v4, (ULONG_PTR)*a4);
        v12 = (void **)off_30148;
        if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 2u )
        {
          sub_147C8(*((_QWORD *)off_30148 + 19), 0x8Bu, (__int64)&unk_2EB40, a2);
          v12 = (void **)off_30148;
        }
        v13 = 7;
      }
      if ( v12 != &off_30148 && *((char *)v12 + 172) < 0 && *((_BYTE *)v12 + 169) >= 5u )
        sub_11008((__int64)v12[19], 0x8Cu, (__int64)&unk_2EB40);
      result = v13;
    }
    else
    {
      if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 2u )
        sub_1102C(*((_QWORD *)off_30148 + 19), 0x8Au, (__int64)&unk_2EB40, v14);
      result = (unsigned int)v14;
    }
  }
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (00000000000294DC) ----------------------------------------------------
__int64 __fastcall sub_294DC(__int64 a1, unsigned __int64 a2, __int64 a3, _DWORD *a4)
{
  ULONG_PTR v4; // rbx
  __int64 v5; // rbp
  void **v8; // rcx
  __int64 v10; // r14
  struct _FAST_MUTEX *v11; // r13
  _QWORD *v12; // rax
  __int64 v13; // rsi
  int v14; // eax
  __int64 v15; // [rsp+20h] [rbp-78h] BYREF
  _BYTE v16[72]; // [rsp+28h] [rbp-70h] BYREF
  __int64 v17; // [rsp+A0h] [rbp+8h] BYREF

  v17 = a1;
  v4 = qword_304A8;
  v5 = 0i64;
  v15 = 0i64;
  memset(v16, 0, sizeof(v16));
  v8 = (void **)off_30148;
  if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x80) != 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x93u, (__int64)&unk_2EB40);
    v8 = (void **)off_30148;
  }
  *a4 = 0;
  if ( !v4 )
  {
    if ( v8 != &off_30148 && (*((_BYTE *)v8 + 172) & 0x80) != 0 && *((_BYTE *)v8 + 169) >= 2u )
      sub_11008((__int64)v8[19], 0x94u, (__int64)&unk_2EB40);
    *a4 = 3;
    return 0i64;
  }
  if ( sub_2A554((_BYTE *)v4, a4) )
  {
    if ( off_30148 != &off_30148 && (*((_BYTE *)off_30148 + 172) & 0x80) != 0 && *((_BYTE *)off_30148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_30148 + 19), 0x95u, (__int64)&unk_2EB40);
    *a4 = 10;
    return 0i64;
  }
  v10 = (unsigned int)sub_2895C(v4, a2, a4);
  v11 = (struct _FAST_MUTEX *)(v4 + 80 * v10 + 104);
  sub_27B68(*(_DWORD *)(v4 + 24), v11, (KIRQL *)&v17);
  v12 = sub_2995C(v4, v10, a2, a4);
  v13 = (__int64)v12;
  if ( v12 )
  {
    if ( *a4 == 8 )
    {
      sub_27C2C(*(_DWORD *)(v4 + 24), v11, v17);
      if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 3u )
        sub_147C8(*((_QWORD *)off_30148 + 19), 0x96u, (__int64)&unk_2EB40, a2, v15);
      return 0i64;
    }
    sub_2A28C(v4, (ULONG_PTR)v12, 0);
    v5 = *(_QWORD *)(v13 + 32);
    if ( *(_DWORD *)(v13 + 40) )
    {
      *(_BYTE *)(v13 + 44) = 1;
    }
    else
    {
      v14 = sub_28BE0(v4, v10, (__int64 *)v13);
      *a4 = v14;
      if ( !v14 )
        sub_28DDC(v4, (__int64)&v15, v13);
    }
  }
  sub_27C2C(*(_DWORD *)(v4 + 24), v11, v17);
  sub_28F5C(v4, (__int64)&v15, 1);
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x97u, (__int64)&unk_2EB40);
  return v5;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000029768) ----------------------------------------------------
__int64 __fastcall sub_29768(__int64 a1, unsigned __int64 a2, _QWORD *a3, _DWORD *a4)
{
  ULONG_PTR v4; // rdi
  __int64 v8; // r12
  void **v9; // rcx
  unsigned int v11; // ebx
  struct _FAST_MUTEX *v12; // r13
  _QWORD *v13; // rax
  _QWORD *v14; // rbx
  __int64 v15; // [rsp+50h] [rbp+8h] BYREF

  v15 = a1;
  v4 = qword_304A8;
  v8 = 0i64;
  v9 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xACu, (__int64)&unk_2EB40);
    v9 = (void **)off_30148;
  }
  *a4 = 4;
  if ( a3 )
    *a3 = 0i64;
  if ( !v4 )
  {
    if ( v9 != &off_30148 && *((char *)v9 + 172) < 0 && *((_BYTE *)v9 + 169) >= 2u )
      sub_11008((__int64)v9[19], 0xADu, (__int64)&unk_2EB40);
    *a4 = 3;
    return 0i64;
  }
  v11 = sub_2895C(v4, a2, a4);
  v12 = (struct _FAST_MUTEX *)(v4 + 80i64 * v11 + 104);
  sub_27B68(*(_DWORD *)(v4 + 24), v12, (KIRQL *)&v15);
  v13 = sub_2995C(v4, v11, a2, a4);
  v14 = v13;
  if ( v13 )
  {
    if ( *a4 == 8 )
    {
      sub_27C2C(*(_DWORD *)(v4 + 24), v12, v15);
      if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 3u )
        sub_147C8(*((_QWORD *)off_30148 + 19), 0xAEu, (__int64)&unk_2EB40, a2);
      return 0i64;
    }
    v8 = v13[4];
    if ( a3 )
    {
      sub_2A148(v4, (ULONG_PTR)v13, 0);
      *a3 = v14;
    }
  }
  sub_27C2C(*(_DWORD *)(v4 + 24), v12, v15);
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0xAFu, (__int64)&unk_2EB40);
  return v8;
}
// 30148: using guessed type void *off_30148;

//----- (000000000002995C) ----------------------------------------------------
_QWORD *__fastcall sub_2995C(__int64 a1, unsigned int a2, __int64 a3, _DWORD *a4)
{
  __int64 v6; // r12
  _QWORD *v8; // rsi
  void **v9; // rcx
  _QWORD *result; // rax
  _QWORD *v11; // rdx
  _QWORD *v12; // rbx

  v6 = a2;
  v8 = 0i64;
  v9 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xB0u, (__int64)&unk_2EB40);
    v9 = (void **)off_30148;
  }
  *a4 = 4;
  if ( a1 )
  {
    v11 = (_QWORD *)(a1 + 16 * (5 * v6 + 5));
    if ( (_QWORD *)*v11 != v11 )
    {
      v12 = (_QWORD *)*v11;
      while ( v12 != v11 )
      {
        v8 = v12;
        if ( v12[2] == a3 )
        {
          if ( v9 != &off_30148 && *((char *)v9 + 172) < 0 && *((_BYTE *)v9 + 169) >= 4u )
          {
            sub_14B68((__int64)v9[19], 0xB2u, (__int64)&unk_2EB40, v6);
            v9 = (void **)off_30148;
          }
          if ( *((_BYTE *)v12 + 44) )
          {
            if ( v9 != &off_30148 && *((char *)v9 + 172) < 0 && *((_BYTE *)v9 + 169) >= 4u )
            {
              sub_147C8((__int64)v9[19], 0xB3u, (__int64)&unk_2EB40, v12[2]);
              v9 = (void **)off_30148;
            }
            *a4 = 8;
          }
          else
          {
            *a4 = 0;
          }
          break;
        }
        v12 = (_QWORD *)*v12;
        v8 = 0i64;
      }
    }
    if ( v9 != &off_30148 && *((char *)v9 + 172) < 0 && *((_BYTE *)v9 + 169) >= 5u )
      sub_11008((__int64)v9[19], 0xB4u, (__int64)&unk_2EB40);
    result = v8;
  }
  else
  {
    if ( v9 != &off_30148 && *((char *)v9 + 172) < 0 && *((_BYTE *)v9 + 169) >= 2u )
      sub_11008((__int64)v9[19], 0xB1u, (__int64)&unk_2EB40);
    *a4 = 3;
    result = 0i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (0000000000029B1C) ----------------------------------------------------
ULONG_PTR __fastcall sub_29B1C(ULONG_PTR BugCheckParameter2, unsigned __int64 a2, __int64 a3, ULONG_PTR **a4, __int64 a5)
{
  ULONG_PTR v9; // r12
  unsigned int v10; // er14
  void **v11; // rcx
  _DWORD *v12; // rbp
  int v14; // ebx
  unsigned int v15; // edi
  __int64 v16; // r14
  ULONG_PTR *v17; // rax
  ULONG_PTR *v18; // rdi
  ULONG_PTR *v19; // rax
  ULONG_PTR v20; // rcx
  ULONG_PTR **v21; // rax
  ULONG_PTR v22; // [rsp+20h] [rbp-58h]
  int v23[4]; // [rsp+40h] [rbp-38h] BYREF
  int v24; // [rsp+80h] [rbp+8h]

  v9 = 0i64;
  v23[0] = 0;
  v10 = 0;
  v11 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xB5u, (__int64)&unk_2EB40);
    v11 = (void **)off_30148;
  }
  v12 = (_DWORD *)a5;
  if ( !a5 )
  {
    if ( v11 != &off_30148 && *((char *)v11 + 172) < 0 && *((_BYTE *)v11 + 169) >= 2u )
      sub_11008((__int64)v11[19], 0xB6u, (__int64)&unk_2EB40);
    return 0i64;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v11 != &off_30148 && *((char *)v11 + 172) < 0 && *((_BYTE *)v11 + 169) >= 2u )
      sub_11008((__int64)v11[19], 0xB7u, (__int64)&unk_2EB40);
    *v12 = 3;
    return 0i64;
  }
  if ( !a3 )
  {
    if ( v11 != &off_30148 && *((char *)v11 + 172) < 0 && *((_BYTE *)v11 + 169) >= 2u )
      sub_11008((__int64)v11[19], 0xB8u, (__int64)&unk_2EB40);
    v14 = 3;
    goto LABEL_37;
  }
  if ( _InterlockedCompareExchange((volatile signed __int32 *)(BugCheckParameter2 + 28), 0, 0) )
  {
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 2u )
      sub_11008(*((_QWORD *)off_30148 + 19), 0xB9u, (__int64)&unk_2EB40);
    *v12 = 9;
    return 0i64;
  }
  v15 = sub_2895C(BugCheckParameter2, a2, v23);
  v24 = v15;
  v16 = 10i64 * v15;
  sub_27B68(
    *(_DWORD *)(BugCheckParameter2 + 24),
    (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v15 + 104),
    (KIRQL *)&a5);
  if ( sub_2A408((_BYTE *)BugCheckParameter2, v23)
    || (v17 = sub_2995C(BugCheckParameter2, v15, a2, v23), (v18 = v17) == 0i64) )
  {
    v19 = (ULONG_PTR *)sub_28A58(BugCheckParameter2, a3, v23);
    v18 = v19;
    if ( !v19 )
    {
      v14 = 2;
      if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 2u )
        sub_11008(*((_QWORD *)off_30148 + 19), 0xBCu, (__int64)&unk_2EB40);
      goto LABEL_36;
    }
    v19[2] = a2;
    if ( !sub_2A554((_BYTE *)BugCheckParameter2, v23) )
      sub_2A148(BugCheckParameter2, (ULONG_PTR)v18, 1);
    v20 = BugCheckParameter2 + 8 * v16 + 80;
    v21 = *(ULONG_PTR ***)(BugCheckParameter2 + 8 * v16 + 88);
    *v18 = v20;
    v18[1] = (ULONG_PTR)v21;
    *v21 = v18;
    *(_QWORD *)(v20 + 8) = v18;
    ++*(_DWORD *)(BugCheckParameter2 + 8 * v16 + 96);
    _InterlockedIncrement((volatile signed __int32 *)(BugCheckParameter2 + 8));
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 4u )
    {
      v10 = v24;
      v22 = v18[2];
      sub_277B4(*((_QWORD *)off_30148 + 19), 189i64, (__int64)&unk_2EB40, v24);
      v14 = v23[0];
      goto LABEL_59;
    }
    v14 = v23[0];
LABEL_58:
    v10 = v24;
LABEL_59:
    v9 = v18[4];
    if ( a4 )
    {
      sub_2A148(BugCheckParameter2, (ULONG_PTR)v18, 1);
      *a4 = v18;
    }
    goto LABEL_37;
  }
  sub_2AF24(BugCheckParameter2, (ULONG_PTR)v17);
  v14 = v23[0];
  if ( v23[0] != 8 )
  {
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 )
    {
      v10 = v24;
      if ( *((_BYTE *)off_30148 + 169) >= 4u )
      {
        v22 = v18[2];
        sub_14B68(*((_QWORD *)off_30148 + 19), 0xBBu, (__int64)&unk_2EB40, v24);
      }
      goto LABEL_59;
    }
    goto LABEL_58;
  }
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 3u )
    sub_147C8(*((_QWORD *)off_30148 + 19), 0xBAu, (__int64)&unk_2EB40, a2);
LABEL_36:
  v10 = v24;
LABEL_37:
  sub_27C2C(*(_DWORD *)(BugCheckParameter2 + 24), (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v10 + 104), a5);
  *v12 = v14;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    LODWORD(v22) = v14;
    sub_1DC74(*((_QWORD *)off_30148 + 19), 0xBEu, (__int64)&unk_2EB40, v9, v22);
  }
  return v9;
}
// 29DCD: variable 'v22' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (0000000000029FA4) ----------------------------------------------------
__int64 __fastcall sub_29FA4(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1)
{
  void **v4; // rcx
  __int64 result; // rax
  unsigned int v6; // ebx
  struct _FAST_MUTEX *v7; // rbp
  unsigned int v8; // ebx
  __int64 v9; // [rsp+20h] [rbp-68h] BYREF
  _BYTE v10[72]; // [rsp+28h] [rbp-60h] BYREF
  KIRQL v11; // [rsp+90h] [rbp+8h] BYREF
  unsigned int v12; // [rsp+98h] [rbp+10h] BYREF

  v12 = 0;
  v9 = 0i64;
  memset(v10, 0, sizeof(v10));
  v4 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xCFu, (__int64)&unk_2EB40);
    v4 = (void **)off_30148;
  }
  if ( BugCheckParameter1 )
  {
    v6 = sub_2895C(BugCheckParameter2, *(_QWORD *)(BugCheckParameter1 + 16), &v12);
    v7 = (struct _FAST_MUTEX *)(BugCheckParameter2 + 80i64 * v6 + 104);
    sub_27B68(*(_DWORD *)(BugCheckParameter2 + 24), v7, &v11);
    sub_2A28C(BugCheckParameter2, BugCheckParameter1, 0);
    if ( *(_DWORD *)(BugCheckParameter1 + 40) )
    {
      v8 = v12;
    }
    else
    {
      v8 = sub_28BE0(BugCheckParameter2, v6, (__int64 *)BugCheckParameter1);
      if ( !v8 )
        sub_28DDC(BugCheckParameter2, (__int64)&v9, BugCheckParameter1);
    }
    sub_27C2C(*(_DWORD *)(BugCheckParameter2 + 24), v7, v11);
    sub_28F5C(BugCheckParameter2, (__int64)&v9, 1);
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
      sub_11008(*((_QWORD *)off_30148 + 19), 0xD1u, (__int64)&unk_2EB40);
    result = v8;
  }
  else
  {
    if ( v4 != &off_30148 && *((char *)v4 + 172) < 0 && *((_BYTE *)v4 + 169) >= 2u )
      sub_11008((__int64)v4[19], 0xD0u, (__int64)&unk_2EB40);
    result = 3i64;
  }
  return result;
}
// 30148: using guessed type void *off_30148;

//----- (000000000002A148) ----------------------------------------------------
__int64 __fastcall sub_2A148(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3)
{
  void **v6; // rcx
  unsigned __int16 v7; // dx

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xD6u, (__int64)&unk_2EB40);
    v6 = (void **)off_30148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 215;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_2EB40);
    return 3i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 216;
    goto LABEL_10;
  }
  if ( !a3 )
  {
    sub_2AF24(BugCheckParameter2, BugCheckParameter1);
    v6 = (void **)off_30148;
  }
  if ( !*(_BYTE *)(BugCheckParameter1 + 45) )
  {
    ++*(_DWORD *)(BugCheckParameter1 + 40);
    v6 = (void **)off_30148;
  }
  if ( v6 != &off_30148 && *((char *)v6 + 172) < 0 && *((_BYTE *)v6 + 169) >= 5u )
    sub_14B68((__int64)v6[19], 0xD9u, (__int64)&unk_2EB40, *(_DWORD *)(BugCheckParameter1 + 40));
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (000000000002A28C) ----------------------------------------------------
__int64 __fastcall sub_2A28C(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1, char a3)
{
  void **v6; // rcx
  unsigned __int16 v7; // dx
  int v9; // eax
  __int64 v10; // rax
  int v11; // [rsp+40h] [rbp+8h] BYREF

  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_147C8(*((_QWORD *)off_30148 + 19), 0xDAu, (__int64)&unk_2EB40, *(_QWORD *)(BugCheckParameter1 + 16));
    v6 = (void **)off_30148;
  }
  if ( !BugCheckParameter2 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 219;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_2EB40);
    return 3i64;
  }
  if ( !BugCheckParameter1 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 220;
    goto LABEL_10;
  }
  if ( !a3 )
    sub_2AF24(BugCheckParameter2, BugCheckParameter1);
  v9 = *(_DWORD *)(BugCheckParameter1 + 40);
  if ( v9 )
    *(_DWORD *)(BugCheckParameter1 + 40) = v9 - 1;
  v11 = 0;
  if ( sub_2A6A0((_BYTE *)BugCheckParameter2, &v11)
    && !*(_DWORD *)(BugCheckParameter1 + 40)
    && !*(_BYTE *)(BugCheckParameter1 + 45) )
  {
    v10 = MEMORY[0xFFFFF78000000014];
    *(_BYTE *)(BugCheckParameter1 + 45) = 1;
    *(_QWORD *)(BugCheckParameter1 + 48) = v10;
    ++*(_QWORD *)(BugCheckParameter2 + 32);
  }
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_14B68(*((_QWORD *)off_30148 + 19), 0xDDu, (__int64)&unk_2EB40, *(_DWORD *)(BugCheckParameter1 + 40));
  return 0i64;
}
// 30148: using guessed type void *off_30148;

//----- (000000000002A408) ----------------------------------------------------
char __fastcall sub_2A408(_BYTE *a1, _DWORD *a2)
{
  char v4; // bl
  void **v5; // rcx
  unsigned __int16 v7; // dx

  v4 = 0;
  v5 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xDEu, (__int64)&unk_2EB40);
    v5 = (void **)off_30148;
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 1) != 0 )
    {
      v4 = 1;
      if ( v5 != &off_30148 )
      {
        if ( *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 4u )
        {
          v7 = 224;
LABEL_20:
          sub_11008((__int64)v5[19], v7, (__int64)&unk_2EB40);
          v5 = (void **)off_30148;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else if ( v5 != &off_30148 )
    {
      if ( *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 4u )
      {
        v7 = 225;
        goto LABEL_20;
      }
LABEL_21:
      if ( v5 != &off_30148 && *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 5u )
        sub_11008((__int64)v5[19], 0xE2u, (__int64)&unk_2EB40);
      return v4;
    }
    return v4;
  }
  if ( v5 != &off_30148 && *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 2u )
    sub_11008((__int64)v5[19], 0xDFu, (__int64)&unk_2EB40);
  *a2 = 3;
  return 0;
}
// 30148: using guessed type void *off_30148;

//----- (000000000002A554) ----------------------------------------------------
char __fastcall sub_2A554(_BYTE *a1, _DWORD *a2)
{
  char v4; // bl
  void **v5; // rcx
  unsigned __int16 v7; // dx

  v4 = 0;
  v5 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xE3u, (__int64)&unk_2EB40);
    v5 = (void **)off_30148;
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 2) != 0 )
    {
      v4 = 1;
      if ( v5 != &off_30148 )
      {
        if ( *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 4u )
        {
          v7 = 229;
LABEL_20:
          sub_11008((__int64)v5[19], v7, (__int64)&unk_2EB40);
          v5 = (void **)off_30148;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else if ( v5 != &off_30148 )
    {
      if ( *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 4u )
      {
        v7 = 230;
        goto LABEL_20;
      }
LABEL_21:
      if ( v5 != &off_30148 && *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 5u )
        sub_11008((__int64)v5[19], 0xE7u, (__int64)&unk_2EB40);
      return v4;
    }
    return v4;
  }
  if ( v5 != &off_30148 && *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 2u )
    sub_11008((__int64)v5[19], 0xE4u, (__int64)&unk_2EB40);
  *a2 = 3;
  return 0;
}
// 30148: using guessed type void *off_30148;

//----- (000000000002A6A0) ----------------------------------------------------
char __fastcall sub_2A6A0(_BYTE *a1, _DWORD *a2)
{
  char v4; // bl
  void **v5; // rcx
  unsigned __int16 v7; // dx

  v4 = 0;
  v5 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xE8u, (__int64)&unk_2EB40);
    v5 = (void **)off_30148;
  }
  *a2 = 0;
  if ( a1 )
  {
    if ( (*a1 & 4) != 0 )
    {
      v4 = 1;
      if ( v5 != &off_30148 )
      {
        if ( *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 4u )
        {
          v7 = 234;
LABEL_20:
          sub_11008((__int64)v5[19], v7, (__int64)&unk_2EB40);
          v5 = (void **)off_30148;
          goto LABEL_21;
        }
        goto LABEL_21;
      }
    }
    else if ( v5 != &off_30148 )
    {
      if ( *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 4u )
      {
        v7 = 235;
        goto LABEL_20;
      }
LABEL_21:
      if ( v5 != &off_30148 && *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 5u )
        sub_11008((__int64)v5[19], 0xECu, (__int64)&unk_2EB40);
      return v4;
    }
    return v4;
  }
  if ( v5 != &off_30148 && *((char *)v5 + 172) < 0 && *((_BYTE *)v5 + 169) >= 2u )
    sub_11008((__int64)v5[19], 0xE9u, (__int64)&unk_2EB40);
  *a2 = 3;
  return 0;
}
// 30148: using guessed type void *off_30148;

//----- (000000000002A7EC) ----------------------------------------------------
__int64 __fastcall sub_2A7EC(__int64 a1)
{
  ULONG_PTR v1; // rdi
  unsigned int v2; // ebp
  void **v3; // rcx
  __int64 v5; // r12
  _QWORD **v6; // r14
  int v7; // ecx
  _QWORD *v8; // r13
  __int64 v9; // r15
  void **v10; // rcx
  ULONG_PTR v11; // rbx
  __int64 v12; // rax
  __int64 v13; // rax
  __int64 v14; // rsi
  __int64 v15; // [rsp+20h] [rbp-98h]
  __int64 v16; // [rsp+30h] [rbp-88h] BYREF
  _BYTE v17[72]; // [rsp+38h] [rbp-80h] BYREF
  __int64 v18; // [rsp+C0h] [rbp+8h] BYREF
  unsigned int v19; // [rsp+D0h] [rbp+18h] BYREF
  struct _FAST_MUTEX *v20; // [rsp+D8h] [rbp+20h]

  v18 = a1;
  v1 = qword_304A8;
  v2 = 0;
  v16 = 0i64;
  v19 = 0;
  memset(v17, 0, sizeof(v17));
  v3 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0xEDu, (__int64)&unk_2EB40);
    v3 = (void **)off_30148;
  }
  if ( !v1 )
  {
    if ( v3 != &off_30148 && *((char *)v3 + 172) < 0 && *((_BYTE *)v3 + 169) >= 2u )
      sub_11008((__int64)v3[19], 0xEEu, (__int64)&unk_2EB40);
    return 3i64;
  }
  if ( !*(_QWORD *)(v1 + 56) )
  {
    if ( v3 != &off_30148 && *((char *)v3 + 172) < 0 && *((_BYTE *)v3 + 169) >= 2u )
      sub_11008((__int64)v3[19], 0xEFu, (__int64)&unk_2EB40);
    return 5i64;
  }
  v5 = 0i64;
  if ( *(_DWORD *)(v1 + 4) )
  {
    v6 = (_QWORD **)(v1 + 80);
    while ( 1 )
    {
      v7 = *(_DWORD *)(v1 + 24);
      v20 = (struct _FAST_MUTEX *)(v1 + 80 * v5 + 104);
      sub_27B68(v7, v20, (KIRQL *)&v18);
      v8 = *v6;
      v9 = v1 + 80 * v5 + 80;
      if ( *v6 != (_QWORD *)v9 )
        break;
LABEL_46:
      sub_27C2C(*(_DWORD *)(v1 + 24), v20, v18);
      v5 = (unsigned int)(v5 + 1);
      v6 += 10;
      if ( (unsigned int)v5 >= *(_DWORD *)(v1 + 4) )
        goto LABEL_47;
    }
    v10 = (void **)off_30148;
    while ( 1 )
    {
      v11 = (ULONG_PTR)v8;
      v8 = (_QWORD *)*v8;
      if ( *(_BYTE *)(v11 + 44) )
      {
        if ( v10 == &off_30148 || *((char *)v10 + 172) >= 0 || *((_BYTE *)v10 + 169) < 4u )
          goto LABEL_45;
        LODWORD(v15) = *(_DWORD *)(v11 + 40);
        sub_1DC74((__int64)v10[19], 0xF0u, (__int64)&unk_2EB40, *(_QWORD *)(v11 + 16), v15);
      }
      else
      {
        v12 = *(_QWORD *)(v11 + 24);
        if ( v12 )
        {
          v13 = v12 - 1;
          *(_QWORD *)(v11 + 24) = v13;
          if ( v13 )
          {
            v10 = (void **)off_30148;
            if ( off_30148 == &off_30148 || *((char *)off_30148 + 172) >= 0 || *((_BYTE *)off_30148 + 169) < 4u )
              goto LABEL_45;
            sub_276A4(*((_QWORD *)off_30148 + 19), 0xF4u, (__int64)&unk_2EB40, *(_QWORD *)(v11 + 16), v13);
          }
          else
          {
            *(_BYTE *)(v11 + 44) = 1;
            if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 4u )
            {
              LODWORD(v15) = *(_DWORD *)(v11 + 40);
              sub_1DC74(*((_QWORD *)off_30148 + 19), 0xF1u, (__int64)&unk_2EB40, *(_QWORD *)(v11 + 16), v15);
            }
            if ( !sub_2A554((_BYTE *)v1, &v19) )
              sub_2A28C(v1, v11, 1);
            if ( !*(_DWORD *)(v11 + 40) )
            {
              v14 = *(_QWORD *)(v11 + 16);
              if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 4u )
                sub_147C8(*((_QWORD *)off_30148 + 19), 0xF2u, (__int64)&unk_2EB40, *(_QWORD *)(v11 + 16));
              v2 = sub_28BE0(v1, v5, (__int64 *)v11);
              v19 = v2;
              if ( !v2 )
                sub_28DDC(v1, (__int64)&v16, v11);
              v10 = (void **)off_30148;
              if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 4u )
              {
                LODWORD(v15) = v2;
                sub_1DC74(*((_QWORD *)off_30148 + 19), 0xF3u, (__int64)&unk_2EB40, v14, v15);
                v10 = (void **)off_30148;
              }
              goto LABEL_45;
            }
            v2 = v19;
          }
        }
        else
        {
          if ( v10 == &off_30148 || *((char *)v10 + 172) >= 0 || *((_BYTE *)v10 + 169) < 4u )
            goto LABEL_45;
          sub_147C8((__int64)v10[19], 0xF5u, (__int64)&unk_2EB40, *(_QWORD *)(v11 + 16));
        }
      }
      v10 = (void **)off_30148;
LABEL_45:
      if ( v8 == (_QWORD *)v9 )
        goto LABEL_46;
    }
  }
LABEL_47:
  sub_28F5C(v1, (__int64)&v16, 1);
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0xF6u, (__int64)&unk_2EB40);
  return v2;
}
// 2A987: variable 'v15' is possibly undefined
// 30148: using guessed type void *off_30148;

//----- (000000000002AC1C) ----------------------------------------------------
__int64 __fastcall sub_2AC1C(__int64 a1, ULONG_PTR a2, __int64 a3)
{
  ULONG_PTR v3; // rdi
  void **v6; // rcx
  unsigned __int16 v7; // dx
  struct _FAST_MUTEX *v9; // rbp
  __int64 v10; // rax
  __int64 v11; // [rsp+60h] [rbp+8h] BYREF
  unsigned int v12; // [rsp+68h] [rbp+10h] BYREF

  v11 = a1;
  v12 = 0;
  v3 = qword_304A8;
  v6 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x102u, (__int64)&unk_2EB40);
    v6 = (void **)off_30148;
  }
  if ( !v3 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 259;
LABEL_10:
    sub_11008((__int64)v6[19], v7, (__int64)&unk_2EB40);
    return 3i64;
  }
  if ( !a2 )
  {
    if ( v6 == &off_30148 || *((char *)v6 + 172) >= 0 || *((_BYTE *)v6 + 169) < 2u )
      return 3i64;
    v7 = 260;
    goto LABEL_10;
  }
  v9 = (struct _FAST_MUTEX *)(v3 + 80i64 * (unsigned int)sub_2895C(v3, *(_QWORD *)(a2 + 16), &v12) + 104);
  sub_27B68(*(_DWORD *)(v3 + 24), v9, (KIRQL *)&v11);
  sub_2AF24(v3, a2);
  if ( a3 )
  {
    *(_QWORD *)(a2 + 24) = a3;
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 4u )
      sub_276A4(*((_QWORD *)off_30148 + 19), 0x105u, (__int64)&unk_2EB40, *(_QWORD *)(a2 + 16), a3);
  }
  else
  {
    v10 = *(_QWORD *)(v3 + 16);
    *(_QWORD *)(a2 + 24) = v10;
    if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 4u )
      sub_276A4(*((_QWORD *)off_30148 + 19), 0x106u, (__int64)&unk_2EB40, *(_QWORD *)(a2 + 16), v10);
  }
  sub_27C2C(*(_DWORD *)(v3 + 24), v9, v11);
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
    sub_11008(*((_QWORD *)off_30148 + 19), 0x107u, (__int64)&unk_2EB40);
  return v12;
}
// 30148: using guessed type void *off_30148;

//----- (000000000002ADF4) ----------------------------------------------------
__int64 __fastcall sub_2ADF4(unsigned int a1)
{
  void **v2; // rcx
  unsigned int v3; // ebx
  unsigned int *v4; // rax
  unsigned int v5; // edx

  v2 = (void **)off_30148;
  if ( off_30148 != &off_30148 && *((char *)off_30148 + 172) < 0 && *((_BYTE *)off_30148 + 169) >= 5u )
  {
    sub_11008(*((_QWORD *)off_30148 + 19), 0x10Au, (__int64)&unk_2EB40);
    v2 = (void **)off_30148;
  }
  v3 = 0;
  v4 = dword_2EB50;
  v5 = 0;
  while ( *v4 < a1 )
  {
    ++v5;
    ++v4;
    if ( v5 >= 0x1D )
    {
      if ( v2 == &off_30148 )
        return v3;
      if ( *((char *)v2 + 172) < 0 && *((_BYTE *)v2 + 169) >= 2u )
      {
        sub_11008((__int64)v2[19], 0x10Bu, (__int64)&unk_2EB40);
LABEL_16:
        v2 = (void **)off_30148;
        goto LABEL_17;
      }
      goto LABEL_17;
    }
  }
  v3 = dword_2EB50[v5];
  if ( v2 == &off_30148 )
    return v3;
  if ( *((char *)v2 + 172) < 0 && *((_BYTE *)v2 + 169) >= 4u )
  {
    sub_1102C((__int64)v2[19], 0x10Cu, (__int64)&unk_2EB40, v3);
    goto LABEL_16;
  }
LABEL_17:
  if ( v2 != &off_30148 && *((char *)v2 + 172) < 0 && *((_BYTE *)v2 + 169) >= 5u )
    sub_11008((__int64)v2[19], 0x10Du, (__int64)&unk_2EB40);
  return v3;
}
// 30148: using guessed type void *off_30148;

//----- (000000000002AF24) ----------------------------------------------------
char __fastcall sub_2AF24(ULONG_PTR BugCheckParameter2, ULONG_PTR BugCheckParameter1)
{
  char result; // al
  int v5; // [rsp+50h] [rbp+18h] BYREF

  v5 = 0;
  result = sub_2A6A0((_BYTE *)BugCheckParameter2, &v5);
  if ( result )
  {
    if ( *(_BYTE *)(BugCheckParameter1 + 45) )
      KeBugCheckEx(0xDEFECAu, BugCheckParameter1, BugCheckParameter2, 0i64, 0i64);
  }
  return result;
}

//----- (000000000002AF7C) ----------------------------------------------------
__int64 __fastcall sub_2AF7C(_QWORD *a1, _QWORD *a2)
{
  char *v4; // rbx
  NTSTATUS v6; // edi
  IRP *v7; // rax
  struct _IO_STATUS_BLOCK IoStatusBlock; // [rsp+50h] [rbp-58h] BYREF
  _UNICODE_STRING DestinationString; // [rsp+60h] [rbp-48h] BYREF
  struct _KEVENT Event; // [rsp+70h] [rbp-38h] BYREF

  IoStatusBlock.Pointer = 0i64;
  Event.Header.Type = 0;
  IoStatusBlock.Information = 0i64;
  *(_OWORD *)((char *)&Event.Header.Lock + 1) = 0ui64;
  *(_DWORD *)((char *)&Event.Header.WaitListHead.Blink + 1) = 0;
  *(_WORD *)((char *)&Event.Header.WaitListHead.Blink + 5) = 0;
  HIBYTE(Event.Header.WaitListHead.Blink) = 0;
  v4 = (char *)sub_1B038(2, 0x18u, 0x41434E50u);
  if ( !v4 )
    return 1793i64;
  *(_QWORD *)v4 = 0i64;
  *((_QWORD *)v4 + 1) = 0i64;
  *((_QWORD *)v4 + 2) = 0i64;
  KeInitializeEvent(&Event, SynchronizationEvent, 0);
  RtlInitUnicodeString(&DestinationString, L"\\Device\\NANO\\KNC");
  v6 = IoGetDeviceObjectPointer(&DestinationString, 0x10000000u, (PFILE_OBJECT *)v4, (PDEVICE_OBJECT *)v4 + 1);
  if ( v6
    || (v7 = IoBuildDeviceIoControlRequest(
               0x8BC82004,
               *((PDEVICE_OBJECT *)v4 + 1),
               0i64,
               0,
               v4 + 16,
               8u,
               0,
               &Event,
               &IoStatusBlock),
        (v6 = IofCallDriver(*((PDEVICE_OBJECT *)v4 + 1), v7)) != 0) )
  {
    if ( *(_QWORD *)v4 )
      ObfDereferenceObject(*(PVOID *)v4);
    sub_1B0BC(v4, 0x41434E50u);
    v4 = 0i64;
  }
  else
  {
    *a2 = *((_QWORD *)v4 + 2);
  }
  KeClearEvent(&Event);
  *a1 = v4;
  return v6 != 0 ? 0xE8700002 : 0;
}

//----- (000000000002B100) ----------------------------------------------------
void __fastcall sub_2B100(PVOID P)
{
  PVOID *v1; // rdi

  if ( P )
  {
    v1 = (PVOID *)*((_QWORD *)P + 6);
    *(_BYTE *)P = 0;
    if ( v1 )
    {
      if ( *v1 )
        ObfDereferenceObject(*v1);
      sub_1B0BC(v1, 0x41434E50u);
    }
    sub_1B0BC(P, 0x41434E50u);
  }
}

//----- (000000000002B170) ----------------------------------------------------
__int64 __fastcall sub_2B170(__int64 a1, __int64 a2)
{
  if ( !a1 )
    return 1799i64;
  if ( a2 )
    return (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, char, _QWORD))(*(_QWORD *)(a1 + 24) + 16i64))(
             **(_QWORD **)(a1 + 24),
             a2,
             0i64,
             0i64,
             1,
             0i64);
  return 1796i64;
}

//----- (000000000002B1B4) ----------------------------------------------------
__int64 __fastcall sub_2B1B4(__int64 a1, __int64 a2, __int64 a3, unsigned int a4, void *Src)
{
  size_t v5; // rbx
  unsigned int v6; // er12
  PVOID v10; // rax
  void *v11; // r13
  unsigned int v12; // ebx

  v5 = a4;
  v6 = a3;
  if ( !a1 )
    return 1799i64;
  if ( !a2 )
    return 1796i64;
  if ( !a4 || !Src )
    return (unsigned int)(*(__int64 (__fastcall **)(_QWORD, __int64, __int64, _QWORD, _QWORD))(*(_QWORD *)(a1 + 24)
                                                                                             + 24i64))(
                           **(_QWORD **)(a1 + 24),
                           a2,
                           a3,
                           0i64,
                           0i64);
  v10 = sub_1B038(2, a4, 0x41434E50u);
  v11 = v10;
  if ( !v10 )
    return 1793;
  memmove(v10, Src, v5);
  v12 = (*(__int64 (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD, void *, _DWORD))(*(_QWORD *)(a1 + 24) + 24i64))(
          **(_QWORD **)(a1 + 24),
          a2,
          v6,
          (unsigned int)v5,
          v11,
          0);
  sub_1B0BC(v11, 0x41434E50u);
  return v12;
}

//----- (000000000002B318) ----------------------------------------------------
__int64 __fastcall sub_2B318(_WORD *a1, __int64 a2, __int16 *a3)
{
  _WORD *v3; // r9
  unsigned int v5; // ebx
  __int16 v6; // ax

  v3 = a1;
  if ( !a1 || !a2 )
    goto LABEL_5;
  if ( !a3 )
  {
    *a1 = 0;
LABEL_5:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 22i64;
  }
  do
  {
    if ( !*a1 )
      break;
    ++a1;
    --a2;
  }
  while ( a2 );
  if ( !a2 )
  {
    v5 = 22;
LABEL_14:
    *v3 = 0;
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return v5;
  }
  do
  {
    v6 = *a3++;
    *a1++ = v6;
    if ( !v6 )
      break;
    --a2;
  }
  while ( a2 );
  if ( !a2 )
  {
    v5 = 34;
    goto LABEL_14;
  }
  return 0i64;
}
// 2CC74: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002B3C0) ----------------------------------------------------
__int64 __fastcall sub_2B3C0(_WORD *a1, __int64 a2, __int16 *a3, __int64 a4)
{
  __int16 *v4; // r11
  unsigned int v6; // ebx
  _WORD *v7; // r10
  __int64 v8; // r8
  __int16 v9; // ax
  __int16 v10; // ax

  v4 = a3;
  if ( a4 )
  {
    if ( !a1 )
    {
LABEL_25:
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return 22i64;
    }
  }
  else if ( !a1 )
  {
    if ( !a2 )
      return 0i64;
    goto LABEL_25;
  }
  if ( !a2 )
    goto LABEL_25;
  if ( !a4 )
  {
    *a1 = 0;
    return 0i64;
  }
  if ( a3 )
  {
    v7 = a1;
    v8 = a2;
    if ( a4 == -1 )
    {
      do
      {
        v9 = *v4++;
        *v7++ = v9;
        if ( !v9 )
          break;
        --v8;
      }
      while ( v8 );
    }
    else
    {
      do
      {
        v10 = *v4++;
        *v7++ = v10;
        if ( !v10 )
          break;
        if ( !--v8 )
          break;
        --a4;
      }
      while ( a4 );
      if ( !a4 )
        *v7 = 0;
    }
    if ( v8 )
      return 0i64;
    if ( a4 == -1 )
    {
      a1[a2 - 1] = 0;
      return 80i64;
    }
    v6 = 34;
  }
  else
  {
    v6 = 22;
  }
  *a1 = 0;
  nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
  return v6;
}
// 2CC74: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002B4C8) ----------------------------------------------------
__int64 __fastcall sub_2B4C8(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4)
{
  __int64 result; // rax

  if ( !a1 || !a2 || !a3 )
    goto LABEL_6;
  result = sub_2C0EC(a1, a2, a3, a4);
  if ( (int)result >= 0 )
    return result;
  *a1 = 0;
  if ( (_DWORD)result == -2 )
LABEL_6:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
  return 0xFFFFFFFFi64;
}
// 2CC74: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002B518) ----------------------------------------------------
__int64 sub_2B518(char *a1, unsigned __int64 a2, CHAR *a3, ...)
{
  va_list va; // [rsp+48h] [rbp+20h] BYREF

  va_start(va, a3);
  return sub_2B4C8(a1, a2, a3, (__int64)va);
}

//----- (000000000002B53C) ----------------------------------------------------
__int64 __fastcall sub_2B53C(char *a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int16 *a4, int *a5)
{
  __int64 result; // rax

  if ( !a4 )
    goto LABEL_12;
  if ( a3 )
  {
    if ( !a1 )
    {
LABEL_12:
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return 0xFFFFFFFFi64;
    }
  }
  else if ( !a1 )
  {
    if ( !a2 )
      return 0i64;
    goto LABEL_12;
  }
  if ( !a2 )
    goto LABEL_12;
  if ( a2 > a3 )
  {
    result = sub_2CB50(a1, a3 + 1, a4, a5);
    if ( (_DWORD)result == -2 )
      return 0xFFFFFFFFi64;
    goto LABEL_10;
  }
  result = sub_2CB50(a1, a2, a4, a5);
  if ( (_DWORD)result != -2 )
  {
LABEL_10:
    if ( (int)result >= 0 )
      return result;
    goto LABEL_11;
  }
  if ( a3 == -1i64 )
    return 0xFFFFFFFFi64;
LABEL_11:
  *(_WORD *)a1 = 0;
  if ( (_DWORD)result == -2 )
    goto LABEL_12;
  return 0xFFFFFFFFi64;
}
// 2CC74: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002B5E4) ----------------------------------------------------
__int64 sub_2B5E4(char *a1, unsigned __int64 a2, unsigned __int64 a3, unsigned __int16 *a4, ...)
{
  va_list va; // [rsp+60h] [rbp+28h] BYREF

  va_start(va, a4);
  return sub_2B53C(a1, a2, a3, a4, (int *)va);
}

//----- (000000000002B608) ----------------------------------------------------
__int64 __fastcall sub_2B608(void *a1, size_t a2, const void *a3, size_t a4)
{
  unsigned int v8; // ebx

  if ( !a4 )
    return 0i64;
  if ( !a1 )
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 22i64;
  }
  if ( a3 && a2 >= a4 )
  {
    memmove(a1, a3, a4);
    return 0i64;
  }
  memset(a1, 0, a2);
  if ( a3 )
  {
    if ( a2 >= a4 )
      return 22i64;
    v8 = 34;
  }
  else
  {
    v8 = 22;
  }
  nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
  return v8;
}
// 2CC74: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002B754) ----------------------------------------------------
__int64 __fastcall sub_2B754(_BYTE *a1, int a2, __int64 a3, _DWORD *a4)
{
  int v6; // ebx
  _BYTE *v7; // rbp
  __int64 result; // rax

  v6 = a2;
  v7 = a1;
  if ( (*(_BYTE *)(a3 + 24) & 0x40) == 0 || *(_QWORD *)(a3 + 16) )
  {
    if ( a2 > 0 )
    {
      do
      {
        LOBYTE(a1) = *v7;
        --v6;
        result = write_char(a1, a3, a4);
        ++v7;
      }
      while ( *a4 != -1 && v6 > 0 );
    }
  }
  else
  {
    *a4 += a2;
  }
  return result;
}
// 2B795: variable 'a1' is possibly undefined
// 2B6AC: using guessed type __int64 __fastcall write_char(_QWORD, _QWORD, _QWORD);

//----- (000000000002B81C) ----------------------------------------------------
__int64 __fastcall sub_2B81C(__int64 a1, CHAR *a2, __int64 a3)
{
  int *v3; // r9
  __int64 v5; // r13
  int v6; // esi
  int v7; // er11
  int v8; // edx
  int v9; // er10
  int v10; // er8
  CHAR v12; // di
  int v13; // er14
  int v14; // er12
  CHAR *v15; // rbx
  int v16; // ecx
  __int64 v17; // rcx
  int v18; // eax
  char *i; // rcx
  __int64 v20; // r9
  int v21; // er8
  int v22; // eax
  _BYTE *j; // rcx
  __int64 v24; // rdi
  __int64 v25; // r9
  unsigned int v26; // er15
  char v27; // r13
  CHAR *v28; // rbx
  unsigned __int64 v29; // rdx
  CHAR v30; // al
  int v31; // esp
  int v32; // eax
  __int64 v33; // rdi
  unsigned int v34; // er13
  __int64 v35; // rcx
  WCHAR *v36; // rbp
  int v37; // er12
  int v38; // edi
  __int64 v39; // rcx
  int v40; // eax
  CHAR v41; // al
  __int64 v42; // rcx
  int v43; // [rsp+30h] [rbp-298h]
  unsigned int v44; // [rsp+34h] [rbp-294h] BYREF
  char v45[4]; // [rsp+38h] [rbp-290h] BYREF
  int v46; // [rsp+3Ch] [rbp-28Ch]
  int v47; // [rsp+40h] [rbp-288h]
  int v48; // [rsp+44h] [rbp-284h]
  WCHAR UnicodeString; // [rsp+48h] [rbp-280h] BYREF
  int v50; // [rsp+50h] [rbp-278h]
  int *v51; // [rsp+58h] [rbp-270h]
  __int64 v52; // [rsp+60h] [rbp-268h]
  int v53; // [rsp+68h] [rbp-260h]
  int v54; // [rsp+6Ch] [rbp-25Ch]
  ULONG BytesInMultiByteString; // [rsp+70h] [rbp-258h] BYREF
  ULONG v56; // [rsp+74h] [rbp-254h] BYREF
  CHAR *v57; // [rsp+78h] [rbp-250h]
  CHAR MultiByteString[512]; // [rsp+80h] [rbp-248h] BYREF
  CHAR v59[4]; // [rsp+280h] [rbp-48h] BYREF
  __int16 v60; // [rsp+284h] [rbp-44h]

  v3 = (int *)a3;
  v51 = (int *)a3;
  v5 = a1;
  v52 = a1;
  v53 = 0;
  v6 = 0;
  v7 = 0;
  v47 = 0;
  v8 = 0;
  v43 = 0;
  v9 = 0;
  v46 = 0;
  v10 = 0;
  v48 = 0;
  v50 = 0;
  if ( !a1 || !a2 )
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  v12 = *a2;
  v44 = 0;
  v13 = 0;
  v14 = 0;
  if ( !v12 )
    return v44;
  v15 = v57;
  while ( 1 )
  {
    v57 = ++a2;
    if ( (v44 & 0x80000000) != 0 )
      break;
    if ( (unsigned __int8)(v12 - 32) > 0x58u )
      v16 = 0;
    else
      v16 = byte_2E230[v12 - 32] & 0xF;
    v14 = byte_2E230[9 * v16 + v14] >> 4;
    v54 = v14;
    switch ( v14 )
    {
      case 8:
        goto LABEL_192;
      case 0:
        v42 = 0i64;
        goto LABEL_187;
      case 1:
        v8 = -1;
        v10 = 0;
        v48 = 0;
        v7 = 0;
        v47 = 0;
        v9 = 0;
        v46 = 0;
        v6 = 0;
        v43 = -1;
        v50 = 0;
        break;
      case 2:
        switch ( v12 )
        {
          case ' ':
            v6 |= 2u;
            break;
          case '#':
            v6 |= 0x80u;
            break;
          case '+':
            v6 |= 1u;
            break;
          case '-':
            v6 |= 4u;
            break;
          case '0':
            v6 |= 8u;
            break;
        }
        break;
      case 3:
        if ( v12 == 42 )
        {
          v7 = *v3;
          v51 = v3 + 2;
          v47 = v7;
          if ( v7 >= 0 )
            break;
          v6 |= 4u;
          v7 = -v7;
        }
        else
        {
          v7 = v12 + 10 * v7 - 48;
        }
        v47 = v7;
        break;
      case 4:
        v8 = 0;
LABEL_169:
        v43 = v8;
        break;
      case 5:
        if ( v12 == 42 )
        {
          v8 = *v3;
          v51 = v3 + 2;
          v43 = v8;
          if ( v8 >= 0 )
            break;
          v8 = -1;
        }
        else
        {
          v8 = v12 + 10 * v8 - 48;
        }
        goto LABEL_169;
      case 6:
        switch ( v12 )
        {
          case 'I':
            v41 = *a2;
            v6 |= 0x8000u;
            if ( *a2 == 54 && a2[1] == 52 )
            {
              a2 += 2;
              v6 |= 0x8000u;
              goto LABEL_190;
            }
            if ( v41 == 51 && a2[1] == 50 )
            {
              a2 += 2;
              v6 &= 0xFFFF7FFF;
              goto LABEL_190;
            }
            if ( v41 != 100 && v41 != 105 && v41 != 111 && v41 != 117 && v41 != 120 && v41 != 88 )
            {
              v42 = 0i64;
              v14 = 0;
LABEL_187:
              v50 = 0;
              LOBYTE(v42) = v12;
              write_char(v42, v5, &v44);
              goto LABEL_188;
            }
            break;
          case 'h':
            v6 |= 0x20u;
            break;
          case 'l':
            if ( *a2 == 108 )
            {
              ++a2;
              v6 |= 0x1000u;
            }
            else
            {
              v6 |= 0x10u;
            }
            break;
          case 'w':
            v6 |= 0x800u;
            break;
        }
        break;
      case 7:
        if ( v12 > 105 )
        {
          switch ( v12 )
          {
            case 'n':
              goto LABEL_192;
            case 'o':
              v21 = 8;
              if ( (v6 & 0x80u) != 0 )
                v6 |= 0x200u;
              goto LABEL_83;
            case 'p':
              v43 = 16;
              v6 |= 0x8000u;
              goto LABEL_78;
          }
          if ( v12 != 115 )
          {
            v17 = (unsigned int)(v12 - 117);
            if ( v12 == 117 )
              goto LABEL_57;
            if ( v12 != 120 )
              goto LABEL_27;
            v22 = 39;
            goto LABEL_79;
          }
        }
        else
        {
          if ( v12 == 105 )
            goto LABEL_56;
          v17 = (unsigned int)(v12 - 67);
          if ( v12 == 67 )
          {
            if ( (v6 & 0x830) == 0 )
              v6 |= 0x800u;
            goto LABEL_50;
          }
          if ( v12 != 83 )
          {
            if ( v12 != 88 )
            {
              if ( v12 == 90 )
              {
                v17 = *(_QWORD *)v3;
                v51 = v3 + 2;
                if ( v17 && (v15 = *(CHAR **)(v17 + 8)) != 0i64 )
                {
                  if ( *(_WORD *)(v17 + 2) < *(_WORD *)v17 )
                    goto LABEL_192;
                  v13 = *(unsigned __int16 *)v17;
                  if ( _bittest(&v6, 0xBu) )
                  {
                    if ( (v13 & 1) != 0 || ((unsigned __int8)v15 & 1) != 0 )
                      goto LABEL_192;
                    v13 = *(unsigned __int16 *)v17 >> 1;
                    v50 = 1;
                  }
                  else
                  {
                    v50 = 0;
                  }
                }
                else
                {
                  v15 = SrcCh;
                  v17 = strlen(SrcCh) + 1;
                  v13 = v17 - 1;
                }
                goto LABEL_27;
              }
              v17 = (unsigned int)(v12 - 99);
              if ( v12 != 99 )
              {
                if ( v12 != 100 )
                  goto LABEL_27;
LABEL_56:
                v6 |= 0x40u;
LABEL_57:
                v21 = 10;
LABEL_83:
                if ( _bittest(&v6, 0xFu) || _bittest(&v6, 0xCu) )
                {
                  v24 = *(_QWORD *)v3;
                  v25 = (__int64)(v3 + 2);
                }
                else
                {
                  v25 = (__int64)(v3 + 2);
                  if ( (v6 & 0x20) != 0 )
                  {
                    v51 = (int *)v25;
                    if ( (v6 & 0x40) != 0 )
                      v24 = *(__int16 *)(v25 - 8);
                    else
                      v24 = *(unsigned __int16 *)(v25 - 8);
LABEL_94:
                    if ( (v6 & 0x40) != 0 && v24 < 0 )
                    {
                      v24 = -v24;
                      v6 |= 0x100u;
                    }
                    if ( !_bittest(&v6, 0xFu) && !_bittest(&v6, 0xCu) )
                      v24 = (unsigned int)v24;
                    v26 = v43;
                    if ( v43 >= 0 )
                    {
                      v6 &= 0xFFFFFFF7;
                      if ( v43 > 512 )
                        v26 = 512;
                    }
                    else
                    {
                      v26 = 1;
                    }
                    v27 = v53;
                    v28 = &MultiByteString[511];
                    v9 &= -(v24 != 0);
                    v46 = v9;
                    while ( 1 )
                    {
                      v17 = v26--;
                      if ( (int)v17 <= 0 && !v24 )
                        break;
                      v29 = v24 % (unsigned __int64)v21;
                      v24 /= (unsigned __int64)v21;
                      v30 = v29 + 48;
                      if ( (int)v29 + 48 > 57 )
                        v30 += v27;
                      *v28-- = v30;
                    }
                    v5 = v52;
                    v43 = v26;
                    v32 = v31 + 639 - (_DWORD)v28;
                    v15 = v28 + 1;
                    v13 = v32;
                    if ( _bittest(&v6, 9u) && (!v32 || *v15 != 48) )
                    {
                      --v15;
                      v13 = v32 + 1;
                      *v15 = 48;
                    }
                    v10 = v48;
LABEL_27:
                    if ( !v10 )
                    {
                      if ( (v6 & 0x40) != 0 )
                      {
                        if ( _bittest(&v6, 8u) )
                        {
                          v45[0] = 45;
                          goto LABEL_119;
                        }
                        if ( (v6 & 1) != 0 )
                        {
                          v45[0] = 43;
                          goto LABEL_119;
                        }
                        if ( (v6 & 2) != 0 )
                        {
                          v45[0] = 32;
LABEL_119:
                          v9 = 1;
                          v46 = 1;
                        }
                      }
                      v33 = v52;
                      v34 = v7 - v13 - v9;
                      if ( (v6 & 0xC) == 0 )
                      {
                        LOBYTE(v17) = 32;
                        write_multi_char(v17, v34, v52, &v44);
                        v9 = v46;
                      }
                      sub_2B754(v45, v9, v33, &v44);
                      if ( (v6 & 8) != 0 && (v6 & 4) == 0 )
                      {
                        LOBYTE(v35) = 48;
                        write_multi_char(v35, v34, v33, &v44);
                      }
                      if ( v50 && v13 > 0 )
                      {
                        v36 = (WCHAR *)v15;
                        v37 = v13;
                        while ( 1 )
                        {
                          --v37;
                          UnicodeString = *v36;
                          v38 = -1;
                          if ( RtlUnicodeToMultiByteN(v59, 6u, &v56, &UnicodeString, 2u) >= 0 )
                          {
                            v38 = v56;
                            v40 = 0;
                          }
                          else
                          {
                            *(_DWORD *)v59 = 0;
                            v60 = 0;
                            v40 = 42;
                          }
                          ++v36;
                          if ( v40 || !v38 )
                            break;
                          sub_2B754(v59, v38, v52, &v44);
                          if ( !v37 )
                            goto LABEL_136;
                        }
                        v44 = -1;
LABEL_136:
                        a2 = v57;
                        v14 = v54;
                        v33 = v52;
                      }
                      else
                      {
                        sub_2B754(v15, v13, v33, &v44);
                      }
                      if ( (v44 & 0x80000000) == 0 && (v6 & 4) != 0 )
                      {
                        LOBYTE(v39) = 32;
                        write_multi_char(v39, v34, v33, &v44);
                      }
                      v5 = v52;
LABEL_188:
                      v10 = v48;
                      v7 = v47;
                      v9 = v46;
                    }
                    v8 = v43;
                    break;
                  }
                  if ( (v6 & 0x40) != 0 )
                    v24 = *(int *)(v25 - 8);
                  else
                    v24 = *(unsigned int *)(v25 - 8);
                }
                v51 = (int *)v25;
                goto LABEL_94;
              }
LABEL_50:
              v20 = (__int64)(v3 + 2);
              v51 = (int *)v20;
              if ( (v6 & 0x810) != 0 )
              {
                UnicodeString = *(_WORD *)(v20 - 8);
                v13 = -1;
                if ( RtlUnicodeToMultiByteN(MultiByteString, 0x200u, &BytesInMultiByteString, &UnicodeString, 2u) >= 0 )
                {
                  v13 = BytesInMultiByteString;
                  v9 = v46;
                  v7 = v47;
                  v10 = v48;
                }
                else
                {
                  memset(MultiByteString, 0, sizeof(MultiByteString));
                  v9 = v46;
                  v7 = v47;
                  v10 = 1;
                  v48 = 1;
                }
              }
              else
              {
                v13 = 1;
                MultiByteString[0] = *(_BYTE *)(v20 - 8);
              }
              v15 = MultiByteString;
              goto LABEL_27;
            }
LABEL_78:
            v22 = 7;
LABEL_79:
            v53 = v22;
            v21 = 16;
            if ( (v6 & 0x80u) != 0 )
            {
              v45[0] = 48;
              v9 = 2;
              v45[1] = v22 + 81;
            }
            goto LABEL_83;
          }
          if ( (v6 & 0x830) == 0 )
            v6 |= 0x800u;
        }
        v15 = *(CHAR **)v3;
        v18 = v8;
        if ( v8 == -1 )
          v18 = 0x7FFFFFFF;
        v51 = v3 + 2;
        if ( (v6 & 0x810) != 0 )
        {
          v50 = 1;
          if ( !v15 )
            v15 = (CHAR *)off_30118;
          for ( i = v15; v18; i += 2 )
          {
            --v18;
            if ( !*(_WORD *)i )
              break;
          }
          v17 = (i - v15) >> 1;
        }
        else
        {
          if ( !v15 )
            v15 = SrcCh;
          for ( j = v15; v18; ++j )
          {
            --v18;
            if ( !*j )
              break;
          }
          v17 = (unsigned int)((_DWORD)j - (_DWORD)v15);
        }
        v13 = v17;
        goto LABEL_27;
      default:
        break;
    }
LABEL_190:
    v12 = *a2;
    if ( !*a2 )
      break;
    v3 = v51;
  }
  if ( v14 && v14 != 7 )
  {
LABEL_192:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  return v44;
}
// 2BCFD: variable 'v31' is possibly undefined
// 2BD7F: variable 'v17' is possibly undefined
// 2BDB7: variable 'v35' is possibly undefined
// 2BEA2: variable 'v39' is possibly undefined
// 2B6AC: using guessed type __int64 __fastcall write_char(_QWORD, _QWORD, _QWORD);
// 2B6FC: using guessed type __int64 __fastcall write_multi_char(_QWORD, _QWORD, _QWORD, _QWORD);
// 2CC74: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 30118: using guessed type wchar_t *off_30118;

//----- (000000000002C0EC) ----------------------------------------------------
__int64 __fastcall sub_2C0EC(char *a1, unsigned __int64 a2, CHAR *a3, __int64 a4)
{
  __int64 result; // rax
  unsigned int v7; // edi
  FILE File; // [rsp+30h] [rbp-38h] BYREF

  if ( a2 == -1i64 )
  {
    File._cnt = 0x7FFFFFFF;
  }
  else
  {
    if ( a2 > 0x7FFFFFFF )
    {
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return 0xFFFFFFFFi64;
    }
    File._cnt = a2;
  }
  File._base = a1;
  File._ptr = a1;
  File._flag = 66;
  result = sub_2B81C((__int64)&File, a3, a4);
  v7 = result;
  a1[a2 - 1] = 0;
  if ( (int)result >= 0 )
  {
    if ( --File._cnt < 0 )
    {
      if ( flsbuf(0, &File) == -1 )
        return 4294967294i64;
    }
    else
    {
      *File._ptr = 0;
    }
    return v7;
  }
  if ( File._cnt < 0 )
    return 4294967294i64;
  if ( a1 )
  {
    if ( a2 )
      *a1 = 0;
  }
  return result;
}
// 2CC74: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002C1BC) ----------------------------------------------------
_WORD *__fastcall sub_2C1BC(__int16 a1, __int64 a2, _DWORD *a3)
{
  _WORD *result; // rax
  __int16 v4; // r9
  bool v5; // sf

  result = (_WORD *)*(unsigned int *)(a2 + 24);
  v4 = a1;
  if ( (((unsigned __int8)result & 0x40) == 0 || *(_QWORD *)(a2 + 16))
    && ((v5 = *(_DWORD *)(a2 + 8) - 2 < 0, *(_DWORD *)(a2 + 8) -= 2, v5) ? (result = (_WORD *)((unsigned int)result | 0x20),
                                                                            v4 = -1,
                                                                            *(_DWORD *)(a2 + 24) = (_DWORD)result) : (result = *(_WORD **)a2, **(_WORD **)a2 = a1, *(_QWORD *)a2 += 2i64),
        v4 == -1 && (*(_BYTE *)(a2 + 24) & 0x20) != 0) )
  {
    *a3 = -1;
  }
  else
  {
    ++*a3;
  }
  return result;
}

//----- (000000000002C20C) ----------------------------------------------------
_WORD *__fastcall sub_2C20C(__int16 *a1, int a2, __int64 a3, _DWORD *a4)
{
  _WORD *result; // rax
  int v8; // er10

  if ( (*(_BYTE *)(a3 + 24) & 0x40) == 0 || *(_QWORD *)(a3 + 16) )
  {
    if ( a2 > 0 )
    {
      do
        result = sub_2C1BC(*a1++, a3, a4);
      while ( *a4 != -1 && v8 > 0 );
    }
  }
  else
  {
    *a4 += a2;
  }
  return result;
}
// 2C245: variable 'a4' is possibly undefined
// 2C257: variable 'v8' is possibly undefined

//----- (000000000002C26C) ----------------------------------------------------
__int64 __fastcall sub_2C26C(__int64 a1, unsigned __int16 *a2, int *a3)
{
  __int64 v4; // r12
  int v5; // esi
  int v6; // er11
  int v7; // er9
  int v8; // er10
  unsigned __int16 v10; // di
  int v11; // ebp
  int v12; // er13
  int v13; // er8
  wchar_t *v14; // rbx
  int v15; // ecx
  int v16; // er8
  __int64 v17; // rcx
  unsigned __int16 v18; // ax
  int v19; // ecx
  _BYTE *v20; // rax
  wchar_t v21; // ax
  int v22; // eax
  int v23; // eax
  _WORD *j; // rax
  __int64 v25; // rdi
  char v26; // r12
  char *v27; // rbx
  int v28; // ecx
  unsigned __int64 v29; // rdx
  char v30; // al
  int v31; // esp
  int v32; // eax
  unsigned __int8 v33; // cf
  __int16 v34; // ax
  int v35; // er12
  int v36; // edi
  __int64 v37; // rdx
  __int16 v38; // r10
  __int64 v39; // rdi
  int v40; // edi
  __int64 v41; // rdx
  const char *v42; // rbp
  int v43; // edi
  int v44; // er11
  int v45; // er10
  __int64 v46; // rdx
  __int64 v47; // r11
  bool i; // zf
  int v49; // [rsp+30h] [rbp-498h] BYREF
  int v50; // [rsp+34h] [rbp-494h]
  int v51; // [rsp+38h] [rbp-490h]
  int v52; // [rsp+3Ch] [rbp-48Ch]
  int v53; // [rsp+40h] [rbp-488h]
  __int16 v54[2]; // [rsp+44h] [rbp-484h] BYREF
  int v55; // [rsp+48h] [rbp-480h]
  char SrcCh[4]; // [rsp+4Ch] [rbp-47Ch] BYREF
  __int64 v57; // [rsp+50h] [rbp-478h]
  wchar_t v58; // [rsp+58h] [rbp-470h] BYREF
  wchar_t *v59; // [rsp+60h] [rbp-468h]
  int v60; // [rsp+68h] [rbp-460h]
  int v61; // [rsp+6Ch] [rbp-45Ch]
  int v62; // [rsp+70h] [rbp-458h]
  wchar_t DstCh[255]; // [rsp+80h] [rbp-448h] BYREF
  char v64; // [rsp+27Fh] [rbp-249h] BYREF

  v4 = a1;
  v57 = a1;
  v61 = 0;
  v5 = 0;
  v6 = 0;
  v52 = 0;
  v7 = 0;
  v51 = 0;
  v8 = 0;
  v50 = 0;
  v60 = 0;
  v53 = 0;
  if ( !a1 || !a2 )
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  v10 = *a2;
  v11 = 0;
  v49 = 0;
  v12 = 0;
  v13 = 0;
  if ( !v10 )
    return (unsigned int)v11;
  v14 = v59;
  do
  {
    v59 = ++a2;
    if ( v11 < 0 )
      break;
    if ( (unsigned __int16)(v10 - 32) > 0x58u )
      v15 = 0;
    else
      v15 = byte_2E230[v10 - 32] & 0xF;
    v13 = byte_2E230[9 * v15 + v13] >> 4;
    v55 = v13;
    switch ( v13 )
    {
      case 8:
        goto LABEL_197;
      case 0:
        goto LABEL_169;
      case 1:
        v7 = -1;
        v51 = -1;
        v60 = 0;
        v6 = 0;
        v52 = 0;
        v8 = 0;
        v50 = 0;
        v5 = 0;
        v53 = 0;
        break;
      case 2:
        switch ( v10 )
        {
          case ' ':
            v5 |= 2u;
            break;
          case '#':
            v5 |= 0x80u;
            break;
          case '+':
            v5 |= 1u;
            break;
          case '-':
            v5 |= 4u;
            break;
          case '0':
            v5 |= 8u;
            break;
        }
        break;
      case 3:
        if ( v10 != 42 )
        {
          v6 = v10 + 10 * v6 - 48;
          goto LABEL_185;
        }
        v6 = *a3;
        a3 += 2;
        v52 = v6;
        if ( v6 < 0 )
        {
          v5 |= 4u;
          v6 = -v6;
LABEL_185:
          v52 = v6;
          break;
        }
        break;
      case 4:
        v7 = 0;
        v51 = 0;
        break;
      case 5:
        if ( v10 == 42 )
        {
          v7 = *a3;
          a3 += 2;
          v51 = v7;
          if ( v7 < 0 )
          {
            v7 = -1;
            v51 = -1;
          }
        }
        else
        {
          v7 = v10 + 10 * v7 - 48;
          v51 = v7;
        }
        break;
      case 6:
        if ( v10 != 73 )
        {
          switch ( v10 )
          {
            case 'h':
              v5 |= 0x20u;
              break;
            case 'l':
              if ( *a2 == 108 )
              {
                ++a2;
                v5 |= 0x1000u;
              }
              else
              {
                v5 |= 0x10u;
              }
              break;
            case 'w':
              v5 |= 0x800u;
              break;
          }
          break;
        }
        v5 |= 0x8000u;
        if ( *a2 == 54 && a2[1] == 52 )
        {
          a2 += 2;
          v5 |= 0x8000u;
        }
        else
        {
          if ( *a2 != 51 || a2[1] != 50 )
          {
            if ( *a2 == 100 || *a2 == 105 || *a2 == 111 || *a2 == 117 || *a2 == 120 || *a2 == 88 )
              break;
            v55 = 0;
LABEL_169:
            v53 = 1;
            sub_2C1BC(v10, v4, &v49);
            v11 = v49;
LABEL_170:
            v7 = v51;
            a2 = v59;
LABEL_171:
            v13 = v55;
            break;
          }
          a2 += 2;
          v5 &= 0xFFFF7FFF;
        }
        break;
      case 7:
        if ( v10 > 0x69u )
        {
          switch ( v10 )
          {
            case 'n':
              goto LABEL_197;
            case 'o':
              v16 = 8;
              if ( (v5 & 0x80u) != 0 )
                v5 |= 0x200u;
              goto LABEL_76;
            case 'p':
              v7 = 16;
              v5 |= 0x8000u;
              goto LABEL_71;
          }
          if ( v10 != 115 )
          {
            if ( v10 != 117 )
            {
              if ( v10 != 120 )
                goto LABEL_107;
              v23 = 39;
              goto LABEL_72;
            }
LABEL_28:
            v16 = 10;
LABEL_76:
            if ( _bittest(&v5, 0xFu) || _bittest(&v5, 0xCu) )
            {
              v25 = *(_QWORD *)a3;
              a3 += 2;
            }
            else
            {
              a3 += 2;
              if ( (v5 & 0x20) != 0 )
              {
                if ( (v5 & 0x40) != 0 )
                  v25 = *((__int16 *)a3 - 4);
                else
                  v25 = *((unsigned __int16 *)a3 - 4);
              }
              else if ( (v5 & 0x40) != 0 )
              {
                v25 = *(a3 - 2);
              }
              else
              {
                v25 = (unsigned int)*(a3 - 2);
              }
            }
            if ( (v5 & 0x40) != 0 && v25 < 0 )
            {
              v25 = -v25;
              v5 |= 0x100u;
            }
            if ( !_bittest(&v5, 0xFu) && !_bittest(&v5, 0xCu) )
              v25 = (unsigned int)v25;
            if ( v7 >= 0 )
            {
              v5 &= 0xFFFFFFF7;
              if ( v7 > 512 )
                v7 = 512;
            }
            else
            {
              v7 = 1;
            }
            v26 = v61;
            v27 = &v64;
            v50 = v25 != 0 ? v8 : 0;
            while ( 1 )
            {
              v28 = v7--;
              if ( v28 <= 0 && !v25 )
                break;
              v29 = v25 % (unsigned __int64)v16;
              v25 /= (unsigned __int64)v16;
              v30 = v29 + 48;
              if ( (int)v29 + 48 > 57 )
                v30 += v26;
              *v27-- = v30;
            }
            v8 = v50;
            v4 = v57;
            v32 = v31 + 639 - (_DWORD)v27;
            v14 = (wchar_t *)(v27 + 1);
            v33 = _bittest(&v5, 9u);
            v12 = v32;
            v51 = v7;
            if ( v33 && (!v32 || *(_BYTE *)v14 != 48) )
            {
              v14 = (wchar_t *)((char *)v14 - 1);
              v12 = v32 + 1;
              *(_BYTE *)v14 = 48;
            }
            a2 = v59;
            goto LABEL_107;
          }
        }
        else
        {
          if ( v10 == 105 )
            goto LABEL_27;
          if ( v10 == 67 )
          {
            if ( (v5 & 0x830) == 0 )
              v5 |= 0x20u;
            goto LABEL_51;
          }
          if ( v10 != 83 )
          {
            if ( v10 != 88 )
            {
              if ( v10 == 90 )
              {
                v17 = *(_QWORD *)a3;
                a3 += 2;
                if ( v17 && (v14 = *(wchar_t **)(v17 + 8)) != 0i64 )
                {
                  v18 = *(_WORD *)v17;
                  if ( *(_WORD *)(v17 + 2) < *(_WORD *)v17 )
                    goto LABEL_197;
                  if ( _bittest(&v5, 0xBu) )
                  {
                    if ( (v18 & 1) != 0 || ((unsigned __int8)v14 & 1) != 0 )
                      goto LABEL_197;
                    v12 = v18 >> 1;
                    v53 = 1;
                  }
                  else
                  {
                    v53 = 0;
                    v12 = v18;
                  }
                }
                else
                {
                  v14 = (wchar_t *)::SrcCh;
                  v12 = strlen(::SrcCh);
                }
                goto LABEL_107;
              }
              if ( v10 != 99 )
              {
                if ( v10 == 100 )
                {
LABEL_27:
                  v5 |= 0x40u;
                  goto LABEL_28;
                }
LABEL_107:
                if ( v60 )
                  goto LABEL_171;
                if ( (v5 & 0x40) != 0 )
                {
                  if ( _bittest(&v5, 8u) )
                  {
                    v34 = 45;
                    goto LABEL_115;
                  }
                  if ( (v5 & 1) != 0 )
                  {
                    v34 = 43;
                    goto LABEL_115;
                  }
                  if ( (v5 & 2) != 0 )
                  {
                    v34 = 32;
LABEL_115:
                    v8 = 1;
                    v54[0] = v34;
                    v50 = 1;
                  }
                }
                v35 = v6 - v12 - v8;
                v62 = v35;
                if ( (v5 & 0xC) == 0 )
                {
                  v36 = v6 - v12 - v8;
                  if ( v35 > 0 )
                  {
                    v37 = v57;
                    v38 = 32;
                    do
                    {
                      --v36;
                      sub_2C1BC(v38, v37, &v49);
                    }
                    while ( v49 != -1 && v36 > 0 );
                    v8 = v50;
                  }
                }
                v39 = v57;
                sub_2C20C(v54, v8, v57, &v49);
                if ( (v5 & 8) != 0 && (v5 & 4) == 0 )
                {
                  v40 = v35;
                  if ( v35 <= 0 )
                  {
                    v39 = v57;
                  }
                  else
                  {
                    v41 = v57;
                    do
                    {
                      --v40;
                      sub_2C1BC(48, v41, &v49);
                    }
                    while ( v49 != -1 && v40 > 0 );
                    v35 = v62;
                    v39 = v41;
                  }
                }
                if ( v53 || v12 <= 0 )
                {
                  sub_2C20C((__int16 *)v14, v12, v39, &v49);
                  v45 = 0;
LABEL_140:
                  v11 = v49;
                }
                else
                {
                  v42 = (const char *)v14;
                  v43 = v12;
                  while ( 1 )
                  {
                    --v43;
                    v44 = mbtowc(&v58, v42, dword_30120);
                    if ( v44 == 2 )
                      --v43;
                    v45 = 0;
                    if ( v44 <= 0 )
                      break;
                    sub_2C1BC(v58, v57, &v49);
                    v42 += v47;
                    if ( v43 <= v45 )
                    {
                      v39 = v46;
                      goto LABEL_140;
                    }
                  }
                  v39 = v57;
                  v11 = -1;
                  v49 = -1;
                }
                if ( v11 >= v45 )
                {
                  for ( i = (v5 & 4) == 0; !i && v35 > v45; i = v49 == -1 )
                  {
                    --v35;
                    sub_2C1BC(32, v39, &v49);
                    v11 = v49;
                  }
                }
                v8 = v50;
                v6 = v52;
                v4 = v57;
                goto LABEL_170;
              }
LABEL_51:
              v21 = *(_WORD *)a3;
              a3 += 2;
              v58 = v21;
              v53 = 1;
              if ( (v5 & 0x20) != 0 )
              {
                SrcCh[0] = v21;
                SrcCh[1] = 0;
                v22 = mbtowc(DstCh, SrcCh, dword_30120);
                a2 = v59;
                v7 = v51;
                v8 = v50;
                v6 = v52;
                if ( v22 < 0 )
                  v60 = 1;
              }
              else
              {
                DstCh[0] = v21;
              }
              v14 = DstCh;
              v12 = 1;
              goto LABEL_107;
            }
LABEL_71:
            v23 = 7;
LABEL_72:
            v61 = v23;
            v16 = 16;
            if ( (v5 & 0x80u) != 0 )
            {
              v8 = 2;
              v54[0] = 48;
              v54[1] = v23 + 81;
            }
            goto LABEL_76;
          }
          if ( (v5 & 0x830) == 0 )
            v5 |= 0x20u;
        }
        v14 = *(wchar_t **)a3;
        v19 = v7;
        if ( v7 == -1 )
          v19 = 0x7FFFFFFF;
        a3 += 2;
        v12 = 0;
        if ( (v5 & 0x20) != 0 )
        {
          if ( !v14 )
            v14 = (wchar_t *)::SrcCh;
          v20 = v14;
          if ( v19 > 0 )
          {
            do
            {
              if ( !*v20 )
                break;
              ++v12;
              ++v20;
            }
            while ( v12 < v19 );
          }
        }
        else
        {
          v53 = 1;
          if ( !v14 )
            v14 = off_30118;
          for ( j = v14; v19; ++j )
          {
            --v19;
            if ( !*j )
              break;
          }
          v12 = j - v14;
        }
        goto LABEL_107;
    }
    v10 = *a2;
  }
  while ( *a2 );
  if ( v13 && v13 != 7 )
  {
LABEL_197:
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    return 0xFFFFFFFFi64;
  }
  return (unsigned int)v11;
}
// 2C6CD: variable 'v8' is possibly undefined
// 2C70B: variable 'v31' is possibly undefined
// 2C78C: variable 'v6' is possibly undefined
// 2C7B8: variable 'v38' is possibly undefined
// 2C7B8: variable 'v37' is possibly undefined
// 2C810: variable 'v41' is possibly undefined
// 2C87D: variable 'v47' is possibly undefined
// 2C883: variable 'v45' is possibly undefined
// 2C885: variable 'v46' is possibly undefined
// 2CC74: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 30118: using guessed type wchar_t *off_30118;
// 30120: using guessed type int dword_30120;

//----- (000000000002CB50) ----------------------------------------------------
__int64 __fastcall sub_2CB50(char *a1, unsigned __int64 a2, unsigned __int16 *a3, int *a4)
{
  __int64 result; // rax
  unsigned int v7; // ebp
  char *v8; // rax
  FILE File; // [rsp+30h] [rbp-38h] BYREF

  if ( a2 == -1i64 )
  {
    File._cnt = 0x7FFFFFFF;
  }
  else
  {
    if ( a2 > 0x3FFFFFFF )
    {
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return 0xFFFFFFFFi64;
    }
    File._cnt = 2 * a2;
  }
  File._base = a1;
  File._ptr = a1;
  File._flag = 66;
  result = sub_2C26C((__int64)&File, a3, a4);
  v7 = result;
  *(_WORD *)&a1[2 * a2 - 2] = 0;
  if ( (int)result >= 0 )
  {
    if ( --File._cnt < 0 )
    {
      if ( flsbuf(0, &File) == -1 )
        return 4294967294i64;
      v8 = File._ptr;
    }
    else
    {
      *File._ptr = 0;
      v8 = ++File._ptr;
    }
    if ( --File._cnt < 0 )
    {
      if ( flsbuf(0, &File) == -1 )
        return 4294967294i64;
    }
    else
    {
      *v8 = 0;
    }
    return v7;
  }
  if ( File._cnt < 0 )
    return 4294967294i64;
  if ( a1 )
  {
    if ( a2 )
      *(_WORD *)a1 = 0;
  }
  return result;
}
// 2CC74: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002D184) ----------------------------------------------------
__int64 __fastcall sub_2D184(_WORD *a1, __int64 a2, __int16 *a3)
{
  _WORD *v3; // r9
  unsigned int v4; // ebx
  __int16 v5; // ax
  __int64 result; // rax

  v3 = a1;
  if ( a1 && a2 )
  {
    if ( !a3 )
    {
      v4 = 22;
LABEL_9:
      *v3 = 0;
      nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
      return v4;
    }
    do
    {
      v5 = *a3++;
      *a1++ = v5;
      if ( !v5 )
        break;
      --a2;
    }
    while ( a2 );
    if ( !a2 )
    {
      v4 = 34;
      goto LABEL_9;
    }
    result = 0i64;
  }
  else
  {
    nullsub_1(0i64, 0i64, 0i64, 0i64, 0i64);
    result = 22i64;
  }
  return result;
}
// 2CC74: using guessed type __int64 __fastcall nullsub_1(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000035008) ----------------------------------------------------
__int64 __fastcall sub_35008(unsigned __int8 a1, __int64 a2, unsigned int a3, unsigned int *a4, __int64 a5, unsigned int *a6)
{
  unsigned int *v6; // r13
  unsigned int v7; // er10
  __int64 v10; // rbp
  unsigned int v11; // ebx
  __int64 v12; // rax
  unsigned int v13; // ecx
  unsigned int v14; // eax
  const void **v15; // r14
  unsigned int v16; // er12
  unsigned int v17; // esi
  _WORD *v18; // rcx
  __m128i *v19; // rdi
  __int64 v20; // rcx
  __m128i v21; // xmm0
  __int64 v22; // rbx
  bool v23; // zf
  __int64 v25; // [rsp+30h] [rbp-38h]
  char v26; // [rsp+70h] [rbp+8h] BYREF

  v6 = a6;
  v7 = 0;
  *a6 = 0;
  if ( a1 <= 3u )
    return (unsigned int)-1073741808;
  if ( a1 <= 5u )
  {
    v22 = a5;
    if ( a5 )
    {
      if ( a3 < 0x30 )
        return (unsigned int)-1073741811;
      do
      {
        if ( RtlCompareMemory(*(const void **)(v22 + 8), a4 + 6, 0x10ui64) == 16 )
          break;
        v22 = *(_QWORD *)(v22 + 16);
      }
      while ( v22 );
      if ( v22 )
      {
        v7 = 0;
        if ( a1 == 5 )
        {
          *(_DWORD *)(v22 + 44) = 0;
          *(_QWORD *)(v22 + 24) = 0i64;
          *(_BYTE *)(v22 + 41) = 0;
        }
        else
        {
          v23 = dword_303B8 == 2;
          v25 = *((_QWORD *)a4 + 1);
          *(_QWORD *)(v22 + 24) = v25;
          if ( v23 )
          {
            if ( !(unsigned int)qword_30390(3i64, &v26, 4i64, &a6, a4) )
              *(_BYTE *)(v22 + 41) = v26;
            v7 = qword_30390(2i64, v22 + 44, 4i64, &a6, a4);
          }
          else
          {
            *(_DWORD *)(v22 + 44) = HIDWORD(v25);
            *(_BYTE *)(v22 + 41) = BYTE2(v25);
          }
        }
        return v7;
      }
    }
    return (unsigned int)-1073741163;
  }
  if ( a1 <= 7u )
    return v7;
  if ( a1 != 8 )
    return (unsigned int)-1073741808;
  v10 = a5;
  v11 = 0;
  v12 = a5;
  if ( dword_303B8 == 1 )
  {
    v13 = a4[4];
    if ( v13 > 1 )
    {
      v14 = 32 * v13 + 24;
      if ( v14 <= a3 )
      {
        *(__m128i *)&a4[8 * v13 - 2] = _mm_loadu_si128((const __m128i *)*(_QWORD *)(a5 + 8));
        a4[8 * a4[4] + 2] = 528384;
        *(_DWORD *)(v10 + 44) = 0;
        *(_BYTE *)(v10 + 41) = 0;
        return v7;
      }
      v7 = -1073741789;
      if ( a3 >= 4 )
      {
        *a4 = v14;
LABEL_10:
        *v6 = 4;
        return v7;
      }
      return v7;
    }
  }
  v15 = *(const void ***)(a5 + 32);
  do
  {
    v12 = *(_QWORD *)(v12 + 16);
    ++v11;
  }
  while ( v12 );
  if ( v11 > 0x3F )
    return (unsigned int)-1073741811;
  if ( v15 )
  {
    v16 = 32 * v11 + 24;
    v17 = *(unsigned __int16 *)v15 + v16 + 2;
  }
  else
  {
    v16 = 0;
    v17 = 32 * v11 + 24;
  }
  if ( v17 > a3 )
  {
    v7 = -1073741789;
    if ( a3 < 4 )
      return v7;
    *a4 = v17;
    goto LABEL_10;
  }
  memset(a4, 0, a3);
  *a4 = v17;
  a4[2] = v16;
  a4[4] = v11;
  if ( v15 )
  {
    v18 = (_WORD *)((char *)a4 + v16);
    *v18 = *(_WORD *)v15;
    memmove(v18 + 1, v15[1], *(unsigned __int16 *)v15);
  }
  if ( v11 )
  {
    v19 = (__m128i *)(a4 + 10);
    v20 = v11;
    do
    {
      v21 = _mm_loadu_si128((const __m128i *)*(_QWORD *)(v10 + 8));
      v19->m128i_i32[0] = 528384;
      v19 += 2;
      v19[-3] = v21;
      *(_DWORD *)(v10 + 44) = 0;
      --v20;
      *(_BYTE *)(v10 + 41) = 0;
      v10 = *(_QWORD *)(v10 + 16);
    }
    while ( v20 );
  }
  v7 = 0;
  *v6 = v17;
  return v7;
}
// 30390: using guessed type __int64 (__fastcall *qword_30390)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 303B8: using guessed type int dword_303B8;

// nfuncs=295 queued=279 decompiled=279 lumina nreq=0 worse=0 better=0
// ALL OK, 279 function(s) have been successfully decompiled
